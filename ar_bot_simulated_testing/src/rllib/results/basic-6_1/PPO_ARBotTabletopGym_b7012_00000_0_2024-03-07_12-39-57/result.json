{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 8.220618704506146, "policy_loss": 0.004654070783045984, "vf_loss": 8.214391091305723, "vf_explained_var": 0.04184877045692936, "kl": 0.007867848989022161, "entropy": 1.0908338057097569, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 465.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000}, "sampler_results": {"episode_reward_max": -8.399999999999983, "episode_reward_min": -57.40000000000028, "episode_reward_mean": -43.55000000000021, "episode_len_mean": 319.875, "episode_media": {}, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-17.99999999999998, -56.00000000000038, -57.40000000000028, -53.40000000000022, -50.80000000000033, -8.399999999999983, -57.30000000000034, -47.10000000000016], "episode_lengths": [156, 400, 400, 400, 400, 95, 399, 309]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23025657564688173, "mean_inference_ms": 0.7311375899904522, "mean_action_processing_ms": 0.07784857752421845, "mean_env_wait_ms": 6.32226705380717, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008347630500793457, "StateBufferConnector_ms": 0.004041194915771484, "ViewRequirementAgentConnector_ms": 0.09436905384063721}}, "episode_reward_max": -8.399999999999983, "episode_reward_min": -57.40000000000028, "episode_reward_mean": -43.55000000000021, "episode_len_mean": 319.875, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-17.99999999999998, -56.00000000000038, -57.40000000000028, -53.40000000000022, -50.80000000000033, -8.399999999999983, -57.30000000000034, -47.10000000000016], "episode_lengths": [156, 400, 400, 400, 400, 95, 399, 309]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23025657564688173, "mean_inference_ms": 0.7311375899904522, "mean_action_processing_ms": 0.07784857752421845, "mean_env_wait_ms": 6.32226705380717, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008347630500793457, "StateBufferConnector_ms": 0.004041194915771484, "ViewRequirementAgentConnector_ms": 0.09436905384063721}, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 449.77965316556003, "num_env_steps_trained_throughput_per_sec": 449.77965316556003, "timesteps_total": 4000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 4000, "timers": {"training_iteration_time_ms": 8893.182, "sample_time_ms": 5036.833, "load_time_ms": 0.94, "load_throughput": 4254936.85, "learn_time_ms": 3852.242, "learn_throughput": 1038.356, "synch_weights_time_ms": 2.339}, "counters": {"num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000}, "done": false, "episodes_total": 8, "training_iteration": 1, "trial_id": "b7012_00000", "date": "2024-03-07_12-40-13", "timestamp": 1709833213, "time_this_iter_s": 8.895391464233398, "time_total_s": 8.895391464233398, "pid": 109767, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4d85689f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 8.895391464233398, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 25.650000000000002, "ram_util_percent": 47.76666666666667, "gpu_util_percent0": 0.10916666666666668, "vram_util_percent0": 0.12843153211805555}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 5.141851581248545, "policy_loss": -0.006067621901190729, "vf_loss": 5.146333422035139, "vf_explained_var": -0.01769173638795012, "kl": 0.007928813398856554, "entropy": 1.0824071808527875, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 1395.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000}, "sampler_results": {"episode_reward_max": -8.399999999999983, "episode_reward_min": -72.60000000000042, "episode_reward_mean": -46.65000000000025, "episode_len_mean": 339.85, "episode_media": {}, "episodes_this_iter": 12, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-17.99999999999998, -56.00000000000038, -57.40000000000028, -53.40000000000022, -50.80000000000033, -8.399999999999983, -57.30000000000034, -47.10000000000016, -45.20000000000026, -10.499999999999975, -52.90000000000031, -55.400000000000354, -72.60000000000042, -15.799999999999962, -58.500000000000284, -56.500000000000384, -66.40000000000042, -50.40000000000036, -54.000000000000384, -46.40000000000024], "episode_lengths": [156, 400, 400, 400, 400, 95, 399, 309, 400, 106, 400, 400, 400, 145, 400, 400, 400, 400, 387, 400]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23089924133950693, "mean_inference_ms": 0.7305267341628324, "mean_action_processing_ms": 0.07764990563609545, "mean_env_wait_ms": 6.360675017915405, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00798940658569336, "StateBufferConnector_ms": 0.003865957260131836, "ViewRequirementAgentConnector_ms": 0.09187579154968262}}, "episode_reward_max": -8.399999999999983, "episode_reward_min": -72.60000000000042, "episode_reward_mean": -46.65000000000025, "episode_len_mean": 339.85, "episodes_this_iter": 12, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-17.99999999999998, -56.00000000000038, -57.40000000000028, -53.40000000000022, -50.80000000000033, -8.399999999999983, -57.30000000000034, -47.10000000000016, -45.20000000000026, -10.499999999999975, -52.90000000000031, -55.400000000000354, -72.60000000000042, -15.799999999999962, -58.500000000000284, -56.500000000000384, -66.40000000000042, -50.40000000000036, -54.000000000000384, -46.40000000000024], "episode_lengths": [156, 400, 400, 400, 400, 95, 399, 309, 400, 106, 400, 400, 400, 145, 400, 400, 400, 400, 387, 400]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23089924133950693, "mean_inference_ms": 0.7305267341628324, "mean_action_processing_ms": 0.07764990563609545, "mean_env_wait_ms": 6.360675017915405, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00798940658569336, "StateBufferConnector_ms": 0.003865957260131836, "ViewRequirementAgentConnector_ms": 0.09187579154968262}, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 454.42955307183735, "num_env_steps_trained_throughput_per_sec": 454.42955307183735, "timesteps_total": 8000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 8000, "timers": {"training_iteration_time_ms": 8847.696, "sample_time_ms": 5070.665, "load_time_ms": 0.946, "load_throughput": 4227596.321, "learn_time_ms": 3772.951, "learn_throughput": 1060.178, "synch_weights_time_ms": 2.364}, "counters": {"num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000}, "done": false, "episodes_total": 20, "training_iteration": 2, "trial_id": "b7012_00000", "date": "2024-03-07_12-40-22", "timestamp": 1709833222, "time_this_iter_s": 8.804303407669067, "time_total_s": 17.699694871902466, "pid": 109767, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4d85689f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 17.699694871902466, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 28.03636363636364, "ram_util_percent": 48.0, "gpu_util_percent0": 0.09545454545454546, "vram_util_percent0": 0.1289950284090909}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 5.094319299055684, "policy_loss": 0.009834336673700681, "vf_loss": 5.083228009578682, "vf_explained_var": -0.07961019662118728, "kl": 0.006284675152389301, "entropy": 1.0775075911193766, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 2325.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000}, "sampler_results": {"episode_reward_max": -8.399999999999983, "episode_reward_min": -72.60000000000042, "episode_reward_mean": -46.490909090909334, "episode_len_mean": 330.6363636363636, "episode_media": {}, "episodes_this_iter": 13, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-17.99999999999998, -56.00000000000038, -57.40000000000028, -53.40000000000022, -50.80000000000033, -8.399999999999983, -57.30000000000034, -47.10000000000016, -45.20000000000026, -10.499999999999975, -52.90000000000031, -55.400000000000354, -72.60000000000042, -15.799999999999962, -58.500000000000284, -56.500000000000384, -66.40000000000042, -50.40000000000036, -54.000000000000384, -46.40000000000024, -65.4000000000004, -65.90000000000042, -66.40000000000042, -20.499999999999986, -58.70000000000033, -11.399999999999972, -45.90000000000019, -17.599999999999994, -47.90000000000029, -62.50000000000038, -65.30000000000032, -64.7000000000004, -8.999999999999984], "episode_lengths": [156, 400, 400, 400, 400, 95, 399, 309, 400, 106, 400, 400, 400, 145, 400, 400, 400, 400, 387, 400, 400, 400, 400, 194, 400, 116, 343, 163, 400, 400, 400, 400, 98]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2322027857398921, "mean_inference_ms": 0.7299002440926452, "mean_action_processing_ms": 0.07754440487061187, "mean_env_wait_ms": 6.368005408679666, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0077926751339074335, "StateBufferConnector_ms": 0.0038053050185694838, "ViewRequirementAgentConnector_ms": 0.09117776697332208}}, "episode_reward_max": -8.399999999999983, "episode_reward_min": -72.60000000000042, "episode_reward_mean": -46.490909090909334, "episode_len_mean": 330.6363636363636, "episodes_this_iter": 13, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-17.99999999999998, -56.00000000000038, -57.40000000000028, -53.40000000000022, -50.80000000000033, -8.399999999999983, -57.30000000000034, -47.10000000000016, -45.20000000000026, -10.499999999999975, -52.90000000000031, -55.400000000000354, -72.60000000000042, -15.799999999999962, -58.500000000000284, -56.500000000000384, -66.40000000000042, -50.40000000000036, -54.000000000000384, -46.40000000000024, -65.4000000000004, -65.90000000000042, -66.40000000000042, -20.499999999999986, -58.70000000000033, -11.399999999999972, -45.90000000000019, -17.599999999999994, -47.90000000000029, -62.50000000000038, -65.30000000000032, -64.7000000000004, -8.999999999999984], "episode_lengths": [156, 400, 400, 400, 400, 95, 399, 309, 400, 106, 400, 400, 400, 145, 400, 400, 400, 400, 387, 400, 400, 400, 400, 194, 400, 116, 343, 163, 400, 400, 400, 400, 98]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2322027857398921, "mean_inference_ms": 0.7299002440926452, "mean_action_processing_ms": 0.07754440487061187, "mean_env_wait_ms": 6.368005408679666, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0077926751339074335, "StateBufferConnector_ms": 0.0038053050185694838, "ViewRequirementAgentConnector_ms": 0.09117776697332208}, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 458.6012778237852, "num_env_steps_trained_throughput_per_sec": 458.6012778237852, "timesteps_total": 12000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 12000, "timers": {"training_iteration_time_ms": 8805.842, "sample_time_ms": 5050.285, "load_time_ms": 0.943, "load_throughput": 4240597.186, "learn_time_ms": 3751.571, "learn_throughput": 1066.22, "synch_weights_time_ms": 2.302}, "counters": {"num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000}, "done": false, "episodes_total": 33, "training_iteration": 3, "trial_id": "b7012_00000", "date": "2024-03-07_12-40-31", "timestamp": 1709833231, "time_this_iter_s": 8.724393606185913, "time_total_s": 26.42408847808838, "pid": 109767, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4d85689f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 26.42408847808838, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 26.475000000000005, "ram_util_percent": 47.94166666666666, "gpu_util_percent0": 0.11416666666666668, "vram_util_percent0": 0.12890625}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 5.204414682490851, "policy_loss": -0.012957132207129591, "vf_loss": 5.215919147435856, "vf_explained_var": -0.11686995926723685, "kl": 0.0072633837968597015, "entropy": 1.0603732988398562, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 3255.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000}, "sampler_results": {"episode_reward_max": -6.699999999999989, "episode_reward_min": -72.60000000000042, "episode_reward_mean": -42.35957446808533, "episode_len_mean": 314.63829787234044, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-17.99999999999998, -56.00000000000038, -57.40000000000028, -53.40000000000022, -50.80000000000033, -8.399999999999983, -57.30000000000034, -47.10000000000016, -45.20000000000026, -10.499999999999975, -52.90000000000031, -55.400000000000354, -72.60000000000042, -15.799999999999962, -58.500000000000284, -56.500000000000384, -66.40000000000042, -50.40000000000036, -54.000000000000384, -46.40000000000024, -65.4000000000004, -65.90000000000042, -66.40000000000042, -20.499999999999986, -58.70000000000033, -11.399999999999972, -45.90000000000019, -17.599999999999994, -47.90000000000029, -62.50000000000038, -65.30000000000032, -64.7000000000004, -8.999999999999984, -63.40000000000038, -8.299999999999983, -29.100000000000165, -48.30000000000034, -6.699999999999989, -45.900000000000226, -7.2999999999999865, -45.40000000000033, -44.700000000000195, -45.90000000000035, -10.399999999999979, -49.800000000000274, -36.600000000000065, -14.899999999999961], "episode_lengths": [156, 400, 400, 400, 400, 95, 399, 309, 400, 106, 400, 400, 400, 145, 400, 400, 400, 400, 387, 400, 400, 400, 400, 194, 400, 116, 343, 163, 400, 400, 400, 400, 98, 400, 94, 290, 400, 78, 400, 84, 400, 400, 400, 110, 400, 292, 129]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23238179082886745, "mean_inference_ms": 0.7297395962494418, "mean_action_processing_ms": 0.07740711093842015, "mean_env_wait_ms": 6.3669584062241915, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007543665297487949, "StateBufferConnector_ms": 0.003752809889773105, "ViewRequirementAgentConnector_ms": 0.09033730689515458}}, "episode_reward_max": -6.699999999999989, "episode_reward_min": -72.60000000000042, "episode_reward_mean": -42.35957446808533, "episode_len_mean": 314.63829787234044, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-17.99999999999998, -56.00000000000038, -57.40000000000028, -53.40000000000022, -50.80000000000033, -8.399999999999983, -57.30000000000034, -47.10000000000016, -45.20000000000026, -10.499999999999975, -52.90000000000031, -55.400000000000354, -72.60000000000042, -15.799999999999962, -58.500000000000284, -56.500000000000384, -66.40000000000042, -50.40000000000036, -54.000000000000384, -46.40000000000024, -65.4000000000004, -65.90000000000042, -66.40000000000042, -20.499999999999986, -58.70000000000033, -11.399999999999972, -45.90000000000019, -17.599999999999994, -47.90000000000029, -62.50000000000038, -65.30000000000032, -64.7000000000004, -8.999999999999984, -63.40000000000038, -8.299999999999983, -29.100000000000165, -48.30000000000034, -6.699999999999989, -45.900000000000226, -7.2999999999999865, -45.40000000000033, -44.700000000000195, -45.90000000000035, -10.399999999999979, -49.800000000000274, -36.600000000000065, -14.899999999999961], "episode_lengths": [156, 400, 400, 400, 400, 95, 399, 309, 400, 106, 400, 400, 400, 145, 400, 400, 400, 400, 387, 400, 400, 400, 400, 194, 400, 116, 343, 163, 400, 400, 400, 400, 98, 400, 94, 290, 400, 78, 400, 84, 400, 400, 400, 110, 400, 292, 129]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23238179082886745, "mean_inference_ms": 0.7297395962494418, "mean_action_processing_ms": 0.07740711093842015, "mean_env_wait_ms": 6.3669584062241915, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007543665297487949, "StateBufferConnector_ms": 0.003752809889773105, "ViewRequirementAgentConnector_ms": 0.09033730689515458}, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 442.3635202053667, "num_env_steps_trained_throughput_per_sec": 442.3635202053667, "timesteps_total": 16000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 16000, "timers": {"training_iteration_time_ms": 8864.956, "sample_time_ms": 5038.866, "load_time_ms": 0.97, "load_throughput": 4124699.693, "learn_time_ms": 3822.171, "learn_throughput": 1046.526, "synch_weights_time_ms": 2.233}, "counters": {"num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000}, "done": false, "episodes_total": 47, "training_iteration": 4, "trial_id": "b7012_00000", "date": "2024-03-07_12-40-40", "timestamp": 1709833240, "time_this_iter_s": 9.04454255104065, "time_total_s": 35.46863102912903, "pid": 109767, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4d85689f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 35.46863102912903, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 29.0, "ram_util_percent": 47.90909090909091, "gpu_util_percent0": 0.13090909090909092, "vram_util_percent0": 0.12884706439393942}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 5.138627332256687, "policy_loss": -0.01608424785757257, "vf_loss": 5.153536319187892, "vf_explained_var": -0.20686033034837373, "kl": 0.005876279857053863, "entropy": 1.0368767904978926, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 4185.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 20000}, "sampler_results": {"episode_reward_max": -5.8999999999999915, "episode_reward_min": -72.60000000000042, "episode_reward_mean": -40.93225806451634, "episode_len_mean": 308.741935483871, "episode_media": {}, "episodes_this_iter": 15, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-17.99999999999998, -56.00000000000038, -57.40000000000028, -53.40000000000022, -50.80000000000033, -8.399999999999983, -57.30000000000034, -47.10000000000016, -45.20000000000026, -10.499999999999975, -52.90000000000031, -55.400000000000354, -72.60000000000042, -15.799999999999962, -58.500000000000284, -56.500000000000384, -66.40000000000042, -50.40000000000036, -54.000000000000384, -46.40000000000024, -65.4000000000004, -65.90000000000042, -66.40000000000042, -20.499999999999986, -58.70000000000033, -11.399999999999972, -45.90000000000019, -17.599999999999994, -47.90000000000029, -62.50000000000038, -65.30000000000032, -64.7000000000004, -8.999999999999984, -63.40000000000038, -8.299999999999983, -29.100000000000165, -48.30000000000034, -6.699999999999989, -45.900000000000226, -7.2999999999999865, -45.40000000000033, -44.700000000000195, -45.90000000000035, -10.399999999999979, -49.800000000000274, -36.600000000000065, -14.899999999999961, -65.70000000000041, -39.40000000000023, -14.099999999999962, -45.00000000000027, -7.799999999999985, -62.80000000000048, -47.60000000000019, -69.10000000000042, -46.300000000000246, -24.60000000000011, -48.3000000000002, -16.59999999999998, -34.600000000000215, -5.8999999999999915, -19.099999999999994], "episode_lengths": [156, 400, 400, 400, 400, 95, 399, 309, 400, 106, 400, 400, 400, 145, 400, 400, 400, 400, 387, 400, 400, 400, 400, 194, 400, 116, 343, 163, 400, 400, 400, 400, 98, 400, 94, 290, 400, 78, 400, 84, 400, 400, 400, 110, 400, 292, 129, 400, 369, 129, 400, 89, 400, 400, 400, 400, 196, 400, 169, 341, 70, 191]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23317064309660002, "mean_inference_ms": 0.7308047536206557, "mean_action_processing_ms": 0.07738995198561925, "mean_env_wait_ms": 6.374366049760965, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007431737838252898, "StateBufferConnector_ms": 0.0037539389825636343, "ViewRequirementAgentConnector_ms": 0.0908740105167512}}, "episode_reward_max": -5.8999999999999915, "episode_reward_min": -72.60000000000042, "episode_reward_mean": -40.93225806451634, "episode_len_mean": 308.741935483871, "episodes_this_iter": 15, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-17.99999999999998, -56.00000000000038, -57.40000000000028, -53.40000000000022, -50.80000000000033, -8.399999999999983, -57.30000000000034, -47.10000000000016, -45.20000000000026, -10.499999999999975, -52.90000000000031, -55.400000000000354, -72.60000000000042, -15.799999999999962, -58.500000000000284, -56.500000000000384, -66.40000000000042, -50.40000000000036, -54.000000000000384, -46.40000000000024, -65.4000000000004, -65.90000000000042, -66.40000000000042, -20.499999999999986, -58.70000000000033, -11.399999999999972, -45.90000000000019, -17.599999999999994, -47.90000000000029, -62.50000000000038, -65.30000000000032, -64.7000000000004, -8.999999999999984, -63.40000000000038, -8.299999999999983, -29.100000000000165, -48.30000000000034, -6.699999999999989, -45.900000000000226, -7.2999999999999865, -45.40000000000033, -44.700000000000195, -45.90000000000035, -10.399999999999979, -49.800000000000274, -36.600000000000065, -14.899999999999961, -65.70000000000041, -39.40000000000023, -14.099999999999962, -45.00000000000027, -7.799999999999985, -62.80000000000048, -47.60000000000019, -69.10000000000042, -46.300000000000246, -24.60000000000011, -48.3000000000002, -16.59999999999998, -34.600000000000215, -5.8999999999999915, -19.099999999999994], "episode_lengths": [156, 400, 400, 400, 400, 95, 399, 309, 400, 106, 400, 400, 400, 145, 400, 400, 400, 400, 387, 400, 400, 400, 400, 194, 400, 116, 343, 163, 400, 400, 400, 400, 98, 400, 94, 290, 400, 78, 400, 84, 400, 400, 400, 110, 400, 292, 129, 400, 369, 129, 400, 89, 400, 400, 400, 400, 196, 400, 169, 341, 70, 191]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23317064309660002, "mean_inference_ms": 0.7308047536206557, "mean_action_processing_ms": 0.07738995198561925, "mean_env_wait_ms": 6.374366049760965, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007431737838252898, "StateBufferConnector_ms": 0.0037539389825636343, "ViewRequirementAgentConnector_ms": 0.0908740105167512}, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 20000, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 428.4917471130814, "num_env_steps_trained_throughput_per_sec": 428.4917471130814, "timesteps_total": 20000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 20000, "timers": {"training_iteration_time_ms": 8958.963, "sample_time_ms": 5081.005, "load_time_ms": 1.072, "load_throughput": 3732749.522, "learn_time_ms": 3871.255, "learn_throughput": 1033.257, "synch_weights_time_ms": 4.861}, "counters": {"num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 20000}, "done": false, "episodes_total": 62, "training_iteration": 5, "trial_id": "b7012_00000", "date": "2024-03-07_12-40-49", "timestamp": 1709833249, "time_this_iter_s": 9.337984323501587, "time_total_s": 44.806615352630615, "pid": 109767, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4d85689f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 44.806615352630615, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 29.515384615384605, "ram_util_percent": 48.37692307692308, "gpu_util_percent0": 0.15076923076923077, "vram_util_percent0": 0.12854942908653846}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 4.188583752544977, "policy_loss": -0.015174708146882314, "vf_loss": 4.202325601811691, "vf_explained_var": -0.1677179192343066, "kl": 0.007164229172015101, "entropy": 1.036059825330652, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 5115.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000}, "sampler_results": {"episode_reward_max": -5.8999999999999915, "episode_reward_min": -72.60000000000042, "episode_reward_mean": -39.5671052631581, "episode_len_mean": 307.55263157894734, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-17.99999999999998, -56.00000000000038, -57.40000000000028, -53.40000000000022, -50.80000000000033, -8.399999999999983, -57.30000000000034, -47.10000000000016, -45.20000000000026, -10.499999999999975, -52.90000000000031, -55.400000000000354, -72.60000000000042, -15.799999999999962, -58.500000000000284, -56.500000000000384, -66.40000000000042, -50.40000000000036, -54.000000000000384, -46.40000000000024, -65.4000000000004, -65.90000000000042, -66.40000000000042, -20.499999999999986, -58.70000000000033, -11.399999999999972, -45.90000000000019, -17.599999999999994, -47.90000000000029, -62.50000000000038, -65.30000000000032, -64.7000000000004, -8.999999999999984, -63.40000000000038, -8.299999999999983, -29.100000000000165, -48.30000000000034, -6.699999999999989, -45.900000000000226, -7.2999999999999865, -45.40000000000033, -44.700000000000195, -45.90000000000035, -10.399999999999979, -49.800000000000274, -36.600000000000065, -14.899999999999961, -65.70000000000041, -39.40000000000023, -14.099999999999962, -45.00000000000027, -7.799999999999985, -62.80000000000048, -47.60000000000019, -69.10000000000042, -46.300000000000246, -24.60000000000011, -48.3000000000002, -16.59999999999998, -34.600000000000215, -5.8999999999999915, -19.099999999999994, -42.000000000000284, -11.89999999999997, -40.500000000000306, -39.800000000000246, -38.7000000000002, -43.1000000000003, -6.999999999999988, -22.799999999999976, -46.90000000000027, -26.70000000000007, -43.10000000000028, -56.800000000000374, -6.099999999999991, -43.900000000000325], "episode_lengths": [156, 400, 400, 400, 400, 95, 399, 309, 400, 106, 400, 400, 400, 145, 400, 400, 400, 400, 387, 400, 400, 400, 400, 194, 400, 116, 343, 163, 400, 400, 400, 400, 98, 400, 94, 290, 400, 78, 400, 84, 400, 400, 400, 110, 400, 292, 129, 400, 369, 129, 400, 89, 400, 400, 400, 400, 196, 400, 169, 341, 70, 191, 400, 130, 400, 365, 354, 397, 81, 207, 400, 226, 400, 400, 72, 400]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2342019755267417, "mean_inference_ms": 0.733084474993413, "mean_action_processing_ms": 0.07757453845137179, "mean_env_wait_ms": 6.384919610566138, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007460305565281918, "StateBufferConnector_ms": 0.0038178343521921257, "ViewRequirementAgentConnector_ms": 0.09244492179469059}}, "episode_reward_max": -5.8999999999999915, "episode_reward_min": -72.60000000000042, "episode_reward_mean": -39.5671052631581, "episode_len_mean": 307.55263157894734, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-17.99999999999998, -56.00000000000038, -57.40000000000028, -53.40000000000022, -50.80000000000033, -8.399999999999983, -57.30000000000034, -47.10000000000016, -45.20000000000026, -10.499999999999975, -52.90000000000031, -55.400000000000354, -72.60000000000042, -15.799999999999962, -58.500000000000284, -56.500000000000384, -66.40000000000042, -50.40000000000036, -54.000000000000384, -46.40000000000024, -65.4000000000004, -65.90000000000042, -66.40000000000042, -20.499999999999986, -58.70000000000033, -11.399999999999972, -45.90000000000019, -17.599999999999994, -47.90000000000029, -62.50000000000038, -65.30000000000032, -64.7000000000004, -8.999999999999984, -63.40000000000038, -8.299999999999983, -29.100000000000165, -48.30000000000034, -6.699999999999989, -45.900000000000226, -7.2999999999999865, -45.40000000000033, -44.700000000000195, -45.90000000000035, -10.399999999999979, -49.800000000000274, -36.600000000000065, -14.899999999999961, -65.70000000000041, -39.40000000000023, -14.099999999999962, -45.00000000000027, -7.799999999999985, -62.80000000000048, -47.60000000000019, -69.10000000000042, -46.300000000000246, -24.60000000000011, -48.3000000000002, -16.59999999999998, -34.600000000000215, -5.8999999999999915, -19.099999999999994, -42.000000000000284, -11.89999999999997, -40.500000000000306, -39.800000000000246, -38.7000000000002, -43.1000000000003, -6.999999999999988, -22.799999999999976, -46.90000000000027, -26.70000000000007, -43.10000000000028, -56.800000000000374, -6.099999999999991, -43.900000000000325], "episode_lengths": [156, 400, 400, 400, 400, 95, 399, 309, 400, 106, 400, 400, 400, 145, 400, 400, 400, 400, 387, 400, 400, 400, 400, 194, 400, 116, 343, 163, 400, 400, 400, 400, 98, 400, 94, 290, 400, 78, 400, 84, 400, 400, 400, 110, 400, 292, 129, 400, 369, 129, 400, 89, 400, 400, 400, 400, 196, 400, 169, 341, 70, 191, 400, 130, 400, 365, 354, 397, 81, 207, 400, 226, 400, 400, 72, 400]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2342019755267417, "mean_inference_ms": 0.733084474993413, "mean_action_processing_ms": 0.07757453845137179, "mean_env_wait_ms": 6.384919610566138, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007460305565281918, "StateBufferConnector_ms": 0.0038178343521921257, "ViewRequirementAgentConnector_ms": 0.09244492179469059}, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 431.4922036121119, "num_env_steps_trained_throughput_per_sec": 431.4922036121119, "timesteps_total": 24000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 24000, "timers": {"training_iteration_time_ms": 9010.816, "sample_time_ms": 5119.053, "load_time_ms": 1.05, "load_throughput": 3807955.211, "learn_time_ms": 3883.435, "learn_throughput": 1030.016, "synch_weights_time_ms": 6.456}, "counters": {"num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000}, "done": false, "episodes_total": 76, "training_iteration": 6, "trial_id": "b7012_00000", "date": "2024-03-07_12-40-58", "timestamp": 1709833258, "time_this_iter_s": 9.273047924041748, "time_total_s": 54.07966327667236, "pid": 109767, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4d85689f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 54.07966327667236, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 31.49166666666667, "ram_util_percent": 48.91666666666666, "gpu_util_percent0": 0.13416666666666666, "vram_util_percent0": 0.13014729817708334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 4.323385207947864, "policy_loss": -0.014358938998112114, "vf_loss": 4.3367002219162, "vf_explained_var": -0.1814726734033195, "kl": 0.005219649847773541, "entropy": 1.0365839340353524, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 6045.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 28000}, "sampler_results": {"episode_reward_max": -4.999999999999995, "episode_reward_min": -72.60000000000042, "episode_reward_mean": -37.2911111111113, "episode_len_mean": 297.1333333333333, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-17.99999999999998, -56.00000000000038, -57.40000000000028, -53.40000000000022, -50.80000000000033, -8.399999999999983, -57.30000000000034, -47.10000000000016, -45.20000000000026, -10.499999999999975, -52.90000000000031, -55.400000000000354, -72.60000000000042, -15.799999999999962, -58.500000000000284, -56.500000000000384, -66.40000000000042, -50.40000000000036, -54.000000000000384, -46.40000000000024, -65.4000000000004, -65.90000000000042, -66.40000000000042, -20.499999999999986, -58.70000000000033, -11.399999999999972, -45.90000000000019, -17.599999999999994, -47.90000000000029, -62.50000000000038, -65.30000000000032, -64.7000000000004, -8.999999999999984, -63.40000000000038, -8.299999999999983, -29.100000000000165, -48.30000000000034, -6.699999999999989, -45.900000000000226, -7.2999999999999865, -45.40000000000033, -44.700000000000195, -45.90000000000035, -10.399999999999979, -49.800000000000274, -36.600000000000065, -14.899999999999961, -65.70000000000041, -39.40000000000023, -14.099999999999962, -45.00000000000027, -7.799999999999985, -62.80000000000048, -47.60000000000019, -69.10000000000042, -46.300000000000246, -24.60000000000011, -48.3000000000002, -16.59999999999998, -34.600000000000215, -5.8999999999999915, -19.099999999999994, -42.000000000000284, -11.89999999999997, -40.500000000000306, -39.800000000000246, -38.7000000000002, -43.1000000000003, -6.999999999999988, -22.799999999999976, -46.90000000000027, -26.70000000000007, -43.10000000000028, -56.800000000000374, -6.099999999999991, -43.900000000000325, -43.40000000000033, -12.299999999999969, -33.30000000000018, -43.00000000000031, -11.499999999999972, -27.800000000000036, -25.70000000000007, -23.800000000000033, -11.69999999999997, -43.80000000000028, -4.999999999999995, -18.99999999999999, -9.19999999999998, -39.60000000000031], "episode_lengths": [156, 400, 400, 400, 400, 95, 399, 309, 400, 106, 400, 400, 400, 145, 400, 400, 400, 400, 387, 400, 400, 400, 400, 194, 400, 116, 343, 163, 400, 400, 400, 400, 98, 400, 94, 290, 400, 78, 400, 84, 400, 400, 400, 110, 400, 292, 129, 400, 369, 129, 400, 89, 400, 400, 400, 400, 196, 400, 169, 341, 70, 191, 400, 130, 400, 365, 354, 397, 81, 207, 400, 226, 400, 400, 72, 400, 387, 130, 333, 400, 119, 250, 257, 228, 128, 400, 61, 194, 102, 379]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23489451125224262, "mean_inference_ms": 0.7346845427758736, "mean_action_processing_ms": 0.07765013661994491, "mean_env_wait_ms": 6.384715517877767, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007325808207194011, "StateBufferConnector_ms": 0.0038046307033962673, "ViewRequirementAgentConnector_ms": 0.09223646587795681}}, "episode_reward_max": -4.999999999999995, "episode_reward_min": -72.60000000000042, "episode_reward_mean": -37.2911111111113, "episode_len_mean": 297.1333333333333, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-17.99999999999998, -56.00000000000038, -57.40000000000028, -53.40000000000022, -50.80000000000033, -8.399999999999983, -57.30000000000034, -47.10000000000016, -45.20000000000026, -10.499999999999975, -52.90000000000031, -55.400000000000354, -72.60000000000042, -15.799999999999962, -58.500000000000284, -56.500000000000384, -66.40000000000042, -50.40000000000036, -54.000000000000384, -46.40000000000024, -65.4000000000004, -65.90000000000042, -66.40000000000042, -20.499999999999986, -58.70000000000033, -11.399999999999972, -45.90000000000019, -17.599999999999994, -47.90000000000029, -62.50000000000038, -65.30000000000032, -64.7000000000004, -8.999999999999984, -63.40000000000038, -8.299999999999983, -29.100000000000165, -48.30000000000034, -6.699999999999989, -45.900000000000226, -7.2999999999999865, -45.40000000000033, -44.700000000000195, -45.90000000000035, -10.399999999999979, -49.800000000000274, -36.600000000000065, -14.899999999999961, -65.70000000000041, -39.40000000000023, -14.099999999999962, -45.00000000000027, -7.799999999999985, -62.80000000000048, -47.60000000000019, -69.10000000000042, -46.300000000000246, -24.60000000000011, -48.3000000000002, -16.59999999999998, -34.600000000000215, -5.8999999999999915, -19.099999999999994, -42.000000000000284, -11.89999999999997, -40.500000000000306, -39.800000000000246, -38.7000000000002, -43.1000000000003, -6.999999999999988, -22.799999999999976, -46.90000000000027, -26.70000000000007, -43.10000000000028, -56.800000000000374, -6.099999999999991, -43.900000000000325, -43.40000000000033, -12.299999999999969, -33.30000000000018, -43.00000000000031, -11.499999999999972, -27.800000000000036, -25.70000000000007, -23.800000000000033, -11.69999999999997, -43.80000000000028, -4.999999999999995, -18.99999999999999, -9.19999999999998, -39.60000000000031], "episode_lengths": [156, 400, 400, 400, 400, 95, 399, 309, 400, 106, 400, 400, 400, 145, 400, 400, 400, 400, 387, 400, 400, 400, 400, 194, 400, 116, 343, 163, 400, 400, 400, 400, 98, 400, 94, 290, 400, 78, 400, 84, 400, 400, 400, 110, 400, 292, 129, 400, 369, 129, 400, 89, 400, 400, 400, 400, 196, 400, 169, 341, 70, 191, 400, 130, 400, 365, 354, 397, 81, 207, 400, 226, 400, 400, 72, 400, 387, 130, 333, 400, 119, 250, 257, 228, 128, 400, 61, 194, 102, 379]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23489451125224262, "mean_inference_ms": 0.7346845427758736, "mean_action_processing_ms": 0.07765013661994491, "mean_env_wait_ms": 6.384715517877767, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007325808207194011, "StateBufferConnector_ms": 0.0038046307033962673, "ViewRequirementAgentConnector_ms": 0.09223646587795681}, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 28000, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 453.3184226807929, "num_env_steps_trained_throughput_per_sec": 453.3184226807929, "timesteps_total": 28000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 28000, "timers": {"training_iteration_time_ms": 8984.098, "sample_time_ms": 5099.528, "load_time_ms": 1.057, "load_throughput": 3783277.882, "learn_time_ms": 3876.916, "learn_throughput": 1031.748, "synch_weights_time_ms": 5.807}, "counters": {"num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 28000}, "done": false, "episodes_total": 90, "training_iteration": 7, "trial_id": "b7012_00000", "date": "2024-03-07_12-41-07", "timestamp": 1709833267, "time_this_iter_s": 8.825957536697388, "time_total_s": 62.90562081336975, "pid": 109767, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4d85689f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 62.90562081336975, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 28.318181818181813, "ram_util_percent": 48.8, "gpu_util_percent0": 0.1209090909090909, "vram_util_percent0": 0.12931315104166669}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 6.884149061319649, "policy_loss": -0.0019334016147480215, "vf_loss": 6.884818585265068, "vf_explained_var": -0.18854680548432054, "kl": 0.006319479737556263, "entropy": 1.026698197152025, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 6975.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000}, "sampler_results": {"episode_reward_max": -4.999999999999995, "episode_reward_min": -72.60000000000042, "episode_reward_mean": -34.49800000000018, "episode_len_mean": 281.87, "episode_media": {}, "episodes_this_iter": 19, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10.499999999999975, -52.90000000000031, -55.400000000000354, -72.60000000000042, -15.799999999999962, -58.500000000000284, -56.500000000000384, -66.40000000000042, -50.40000000000036, -54.000000000000384, -46.40000000000024, -65.4000000000004, -65.90000000000042, -66.40000000000042, -20.499999999999986, -58.70000000000033, -11.399999999999972, -45.90000000000019, -17.599999999999994, -47.90000000000029, -62.50000000000038, -65.30000000000032, -64.7000000000004, -8.999999999999984, -63.40000000000038, -8.299999999999983, -29.100000000000165, -48.30000000000034, -6.699999999999989, -45.900000000000226, -7.2999999999999865, -45.40000000000033, -44.700000000000195, -45.90000000000035, -10.399999999999979, -49.800000000000274, -36.600000000000065, -14.899999999999961, -65.70000000000041, -39.40000000000023, -14.099999999999962, -45.00000000000027, -7.799999999999985, -62.80000000000048, -47.60000000000019, -69.10000000000042, -46.300000000000246, -24.60000000000011, -48.3000000000002, -16.59999999999998, -34.600000000000215, -5.8999999999999915, -19.099999999999994, -42.000000000000284, -11.89999999999997, -40.500000000000306, -39.800000000000246, -38.7000000000002, -43.1000000000003, -6.999999999999988, -22.799999999999976, -46.90000000000027, -26.70000000000007, -43.10000000000028, -56.800000000000374, -6.099999999999991, -43.900000000000325, -43.40000000000033, -12.299999999999969, -33.30000000000018, -43.00000000000031, -11.499999999999972, -27.800000000000036, -25.70000000000007, -23.800000000000033, -11.69999999999997, -43.80000000000028, -4.999999999999995, -18.99999999999999, -9.19999999999998, -39.60000000000031, -43.80000000000034, -8.99999999999998, -42.400000000000276, -10.499999999999975, -54.10000000000028, -15.299999999999962, -8.199999999999989, -6.899999999999991, -13.999999999999963, -6.999999999999988, -42.00000000000033, -7.399999999999986, -15.39999999999997, -26.900000000000126, -7.099999999999987, -45.500000000000284, -43.40000000000033, -24.80000000000009, -63.500000000000355], "episode_lengths": [106, 400, 400, 400, 145, 400, 400, 400, 400, 387, 400, 400, 400, 400, 194, 400, 116, 343, 163, 400, 400, 400, 400, 98, 400, 94, 290, 400, 78, 400, 84, 400, 400, 400, 110, 400, 292, 129, 400, 369, 129, 400, 89, 400, 400, 400, 400, 196, 400, 169, 341, 70, 191, 400, 130, 400, 365, 354, 397, 81, 207, 400, 226, 400, 400, 72, 400, 387, 130, 333, 400, 119, 250, 257, 228, 128, 400, 61, 194, 102, 379, 400, 101, 400, 116, 400, 164, 87, 77, 144, 81, 400, 85, 138, 275, 82, 400, 400, 254, 400]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23636228306609003, "mean_inference_ms": 0.7360543158630675, "mean_action_processing_ms": 0.0778037131614687, "mean_env_wait_ms": 6.388553889556891, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007122516632080078, "StateBufferConnector_ms": 0.00376129150390625, "ViewRequirementAgentConnector_ms": 0.09181594848632812}}, "episode_reward_max": -4.999999999999995, "episode_reward_min": -72.60000000000042, "episode_reward_mean": -34.49800000000018, "episode_len_mean": 281.87, "episodes_this_iter": 19, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10.499999999999975, -52.90000000000031, -55.400000000000354, -72.60000000000042, -15.799999999999962, -58.500000000000284, -56.500000000000384, -66.40000000000042, -50.40000000000036, -54.000000000000384, -46.40000000000024, -65.4000000000004, -65.90000000000042, -66.40000000000042, -20.499999999999986, -58.70000000000033, -11.399999999999972, -45.90000000000019, -17.599999999999994, -47.90000000000029, -62.50000000000038, -65.30000000000032, -64.7000000000004, -8.999999999999984, -63.40000000000038, -8.299999999999983, -29.100000000000165, -48.30000000000034, -6.699999999999989, -45.900000000000226, -7.2999999999999865, -45.40000000000033, -44.700000000000195, -45.90000000000035, -10.399999999999979, -49.800000000000274, -36.600000000000065, -14.899999999999961, -65.70000000000041, -39.40000000000023, -14.099999999999962, -45.00000000000027, -7.799999999999985, -62.80000000000048, -47.60000000000019, -69.10000000000042, -46.300000000000246, -24.60000000000011, -48.3000000000002, -16.59999999999998, -34.600000000000215, -5.8999999999999915, -19.099999999999994, -42.000000000000284, -11.89999999999997, -40.500000000000306, -39.800000000000246, -38.7000000000002, -43.1000000000003, -6.999999999999988, -22.799999999999976, -46.90000000000027, -26.70000000000007, -43.10000000000028, -56.800000000000374, -6.099999999999991, -43.900000000000325, -43.40000000000033, -12.299999999999969, -33.30000000000018, -43.00000000000031, -11.499999999999972, -27.800000000000036, -25.70000000000007, -23.800000000000033, -11.69999999999997, -43.80000000000028, -4.999999999999995, -18.99999999999999, -9.19999999999998, -39.60000000000031, -43.80000000000034, -8.99999999999998, -42.400000000000276, -10.499999999999975, -54.10000000000028, -15.299999999999962, -8.199999999999989, -6.899999999999991, -13.999999999999963, -6.999999999999988, -42.00000000000033, -7.399999999999986, -15.39999999999997, -26.900000000000126, -7.099999999999987, -45.500000000000284, -43.40000000000033, -24.80000000000009, -63.500000000000355], "episode_lengths": [106, 400, 400, 400, 145, 400, 400, 400, 400, 387, 400, 400, 400, 400, 194, 400, 116, 343, 163, 400, 400, 400, 400, 98, 400, 94, 290, 400, 78, 400, 84, 400, 400, 400, 110, 400, 292, 129, 400, 369, 129, 400, 89, 400, 400, 400, 400, 196, 400, 169, 341, 70, 191, 400, 130, 400, 365, 354, 397, 81, 207, 400, 226, 400, 400, 72, 400, 387, 130, 333, 400, 119, 250, 257, 228, 128, 400, 61, 194, 102, 379, 400, 101, 400, 116, 400, 164, 87, 77, 144, 81, 400, 85, 138, 275, 82, 400, 400, 254, 400]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23636228306609003, "mean_inference_ms": 0.7360543158630675, "mean_action_processing_ms": 0.0778037131614687, "mean_env_wait_ms": 6.388553889556891, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007122516632080078, "StateBufferConnector_ms": 0.00376129150390625, "ViewRequirementAgentConnector_ms": 0.09181594848632812}, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 460.7045522746435, "num_env_steps_trained_throughput_per_sec": 460.7045522746435, "timesteps_total": 32000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 32000, "timers": {"training_iteration_time_ms": 8946.376, "sample_time_ms": 5086.066, "load_time_ms": 1.081, "load_throughput": 3701945.278, "learn_time_ms": 3853.06, "learn_throughput": 1038.136, "synch_weights_time_ms": 5.384}, "counters": {"num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000}, "done": false, "episodes_total": 109, "training_iteration": 8, "trial_id": "b7012_00000", "date": "2024-03-07_12-41-16", "timestamp": 1709833276, "time_this_iter_s": 8.684615850448608, "time_total_s": 71.59023666381836, "pid": 109767, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4d85689f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 71.59023666381836, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 27.50909090909091, "ram_util_percent": 48.71818181818182, "gpu_util_percent0": 0.09818181818181819, "vram_util_percent0": 0.12931315104166669}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 5.087905485142944, "policy_loss": -0.01317494849684418, "vf_loss": 5.09998293262656, "vf_explained_var": -0.3320033105470801, "kl": 0.005487513757824207, "entropy": 1.0090817543768114, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 7905.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000}, "sampler_results": {"episode_reward_max": -4.999999999999995, "episode_reward_min": -69.10000000000042, "episode_reward_mean": -30.854000000000138, "episode_len_mean": 264.72, "episode_media": {}, "episodes_this_iter": 17, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-45.90000000000019, -17.599999999999994, -47.90000000000029, -62.50000000000038, -65.30000000000032, -64.7000000000004, -8.999999999999984, -63.40000000000038, -8.299999999999983, -29.100000000000165, -48.30000000000034, -6.699999999999989, -45.900000000000226, -7.2999999999999865, -45.40000000000033, -44.700000000000195, -45.90000000000035, -10.399999999999979, -49.800000000000274, -36.600000000000065, -14.899999999999961, -65.70000000000041, -39.40000000000023, -14.099999999999962, -45.00000000000027, -7.799999999999985, -62.80000000000048, -47.60000000000019, -69.10000000000042, -46.300000000000246, -24.60000000000011, -48.3000000000002, -16.59999999999998, -34.600000000000215, -5.8999999999999915, -19.099999999999994, -42.000000000000284, -11.89999999999997, -40.500000000000306, -39.800000000000246, -38.7000000000002, -43.1000000000003, -6.999999999999988, -22.799999999999976, -46.90000000000027, -26.70000000000007, -43.10000000000028, -56.800000000000374, -6.099999999999991, -43.900000000000325, -43.40000000000033, -12.299999999999969, -33.30000000000018, -43.00000000000031, -11.499999999999972, -27.800000000000036, -25.70000000000007, -23.800000000000033, -11.69999999999997, -43.80000000000028, -4.999999999999995, -18.99999999999999, -9.19999999999998, -39.60000000000031, -43.80000000000034, -8.99999999999998, -42.400000000000276, -10.499999999999975, -54.10000000000028, -15.299999999999962, -8.199999999999989, -6.899999999999991, -13.999999999999963, -6.999999999999988, -42.00000000000033, -7.399999999999986, -15.39999999999997, -26.900000000000126, -7.099999999999987, -45.500000000000284, -43.40000000000033, -24.80000000000009, -63.500000000000355, -42.40000000000028, -12.199999999999969, -31.90000000000004, -46.50000000000027, -60.400000000000325, -21.900000000000045, -14.89999999999996, -5.999999999999991, -7.199999999999989, -11.99999999999997, -6.599999999999991, -43.1000000000003, -67.1000000000004, -41.80000000000027, -11.69999999999997, -12.199999999999969, -25.400000000000098], "episode_lengths": [343, 163, 400, 400, 400, 400, 98, 400, 94, 290, 400, 78, 400, 84, 400, 400, 400, 110, 400, 292, 129, 400, 369, 129, 400, 89, 400, 400, 400, 400, 196, 400, 169, 341, 70, 191, 400, 130, 400, 365, 354, 397, 81, 207, 400, 226, 400, 400, 72, 400, 387, 130, 333, 400, 119, 250, 257, 228, 128, 400, 61, 194, 102, 379, 400, 101, 400, 116, 400, 164, 87, 77, 144, 81, 400, 85, 138, 275, 82, 400, 400, 254, 400, 400, 123, 286, 400, 400, 217, 160, 71, 79, 116, 75, 400, 400, 400, 121, 131, 254]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23775778374893833, "mean_inference_ms": 0.7377646321614777, "mean_action_processing_ms": 0.07792991222108558, "mean_env_wait_ms": 6.385506109466364, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006971836090087891, "StateBufferConnector_ms": 0.0037386417388916016, "ViewRequirementAgentConnector_ms": 0.09159040451049805}}, "episode_reward_max": -4.999999999999995, "episode_reward_min": -69.10000000000042, "episode_reward_mean": -30.854000000000138, "episode_len_mean": 264.72, "episodes_this_iter": 17, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-45.90000000000019, -17.599999999999994, -47.90000000000029, -62.50000000000038, -65.30000000000032, -64.7000000000004, -8.999999999999984, -63.40000000000038, -8.299999999999983, -29.100000000000165, -48.30000000000034, -6.699999999999989, -45.900000000000226, -7.2999999999999865, -45.40000000000033, -44.700000000000195, -45.90000000000035, -10.399999999999979, -49.800000000000274, -36.600000000000065, -14.899999999999961, -65.70000000000041, -39.40000000000023, -14.099999999999962, -45.00000000000027, -7.799999999999985, -62.80000000000048, -47.60000000000019, -69.10000000000042, -46.300000000000246, -24.60000000000011, -48.3000000000002, -16.59999999999998, -34.600000000000215, -5.8999999999999915, -19.099999999999994, -42.000000000000284, -11.89999999999997, -40.500000000000306, -39.800000000000246, -38.7000000000002, -43.1000000000003, -6.999999999999988, -22.799999999999976, -46.90000000000027, -26.70000000000007, -43.10000000000028, -56.800000000000374, -6.099999999999991, -43.900000000000325, -43.40000000000033, -12.299999999999969, -33.30000000000018, -43.00000000000031, -11.499999999999972, -27.800000000000036, -25.70000000000007, -23.800000000000033, -11.69999999999997, -43.80000000000028, -4.999999999999995, -18.99999999999999, -9.19999999999998, -39.60000000000031, -43.80000000000034, -8.99999999999998, -42.400000000000276, -10.499999999999975, -54.10000000000028, -15.299999999999962, -8.199999999999989, -6.899999999999991, -13.999999999999963, -6.999999999999988, -42.00000000000033, -7.399999999999986, -15.39999999999997, -26.900000000000126, -7.099999999999987, -45.500000000000284, -43.40000000000033, -24.80000000000009, -63.500000000000355, -42.40000000000028, -12.199999999999969, -31.90000000000004, -46.50000000000027, -60.400000000000325, -21.900000000000045, -14.89999999999996, -5.999999999999991, -7.199999999999989, -11.99999999999997, -6.599999999999991, -43.1000000000003, -67.1000000000004, -41.80000000000027, -11.69999999999997, -12.199999999999969, -25.400000000000098], "episode_lengths": [343, 163, 400, 400, 400, 400, 98, 400, 94, 290, 400, 78, 400, 84, 400, 400, 400, 110, 400, 292, 129, 400, 369, 129, 400, 89, 400, 400, 400, 400, 196, 400, 169, 341, 70, 191, 400, 130, 400, 365, 354, 397, 81, 207, 400, 226, 400, 400, 72, 400, 387, 130, 333, 400, 119, 250, 257, 228, 128, 400, 61, 194, 102, 379, 400, 101, 400, 116, 400, 164, 87, 77, 144, 81, 400, 85, 138, 275, 82, 400, 400, 254, 400, 400, 123, 286, 400, 400, 217, 160, 71, 79, 116, 75, 400, 400, 400, 121, 131, 254]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23775778374893833, "mean_inference_ms": 0.7377646321614777, "mean_action_processing_ms": 0.07792991222108558, "mean_env_wait_ms": 6.385506109466364, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006971836090087891, "StateBufferConnector_ms": 0.0037386417388916016, "ViewRequirementAgentConnector_ms": 0.09159040451049805}, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 459.6449932655492, "num_env_steps_trained_throughput_per_sec": 459.6449932655492, "timesteps_total": 36000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 36000, "timers": {"training_iteration_time_ms": 8919.261, "sample_time_ms": 5074.414, "load_time_ms": 1.073, "load_throughput": 3726338.047, "learn_time_ms": 3837.897, "learn_throughput": 1042.237, "synch_weights_time_ms": 5.09}, "counters": {"num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000}, "done": false, "episodes_total": 126, "training_iteration": 9, "trial_id": "b7012_00000", "date": "2024-03-07_12-41-25", "timestamp": 1709833285, "time_this_iter_s": 8.704628229141235, "time_total_s": 80.2948648929596, "pid": 109767, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4d85689f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 80.2948648929596, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 26.124999999999996, "ram_util_percent": 48.70000000000001, "gpu_util_percent0": 0.11583333333333333, "vram_util_percent0": 0.12940809461805558}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 4.738402230508866, "policy_loss": 0.004499360305126957, "vf_loss": 4.7325715421428605, "vf_explained_var": -0.20584793193365938, "kl": 0.006656614846242461, "entropy": 1.02619347341599, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 8835.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000}, "sampler_results": {"episode_reward_max": -3.8999999999999986, "episode_reward_min": -69.10000000000042, "episode_reward_mean": -27.715000000000128, "episode_len_mean": 247.6, "episode_media": {}, "episodes_this_iter": 19, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-36.600000000000065, -14.899999999999961, -65.70000000000041, -39.40000000000023, -14.099999999999962, -45.00000000000027, -7.799999999999985, -62.80000000000048, -47.60000000000019, -69.10000000000042, -46.300000000000246, -24.60000000000011, -48.3000000000002, -16.59999999999998, -34.600000000000215, -5.8999999999999915, -19.099999999999994, -42.000000000000284, -11.89999999999997, -40.500000000000306, -39.800000000000246, -38.7000000000002, -43.1000000000003, -6.999999999999988, -22.799999999999976, -46.90000000000027, -26.70000000000007, -43.10000000000028, -56.800000000000374, -6.099999999999991, -43.900000000000325, -43.40000000000033, -12.299999999999969, -33.30000000000018, -43.00000000000031, -11.499999999999972, -27.800000000000036, -25.70000000000007, -23.800000000000033, -11.69999999999997, -43.80000000000028, -4.999999999999995, -18.99999999999999, -9.19999999999998, -39.60000000000031, -43.80000000000034, -8.99999999999998, -42.400000000000276, -10.499999999999975, -54.10000000000028, -15.299999999999962, -8.199999999999989, -6.899999999999991, -13.999999999999963, -6.999999999999988, -42.00000000000033, -7.399999999999986, -15.39999999999997, -26.900000000000126, -7.099999999999987, -45.500000000000284, -43.40000000000033, -24.80000000000009, -63.500000000000355, -42.40000000000028, -12.199999999999969, -31.90000000000004, -46.50000000000027, -60.400000000000325, -21.900000000000045, -14.89999999999996, -5.999999999999991, -7.199999999999989, -11.99999999999997, -6.599999999999991, -43.1000000000003, -67.1000000000004, -41.80000000000027, -11.69999999999997, -12.199999999999969, -25.400000000000098, -50.900000000000354, -40.10000000000029, -17.99999999999998, -39.6000000000003, -18.200000000000003, -24.800000000000097, -17.199999999999985, -8.599999999999984, -41.10000000000031, -3.8999999999999986, -7.2999999999999865, -8.89999999999998, -16.799999999999983, -8.199999999999983, -5.199999999999994, -39.6000000000003, -42.300000000000246, -6.6999999999999895, -6.799999999999988], "episode_lengths": [292, 129, 400, 369, 129, 400, 89, 400, 400, 400, 400, 196, 400, 169, 341, 70, 191, 400, 130, 400, 365, 354, 397, 81, 207, 400, 226, 400, 400, 72, 400, 387, 130, 333, 400, 119, 250, 257, 228, 128, 400, 61, 194, 102, 379, 400, 101, 400, 116, 400, 164, 87, 77, 144, 81, 400, 85, 138, 275, 82, 400, 400, 254, 400, 400, 123, 286, 400, 400, 217, 160, 71, 79, 116, 75, 400, 400, 400, 121, 131, 254, 400, 400, 172, 390, 187, 259, 155, 92, 400, 50, 84, 94, 164, 88, 63, 394, 400, 77, 79]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23926489847108884, "mean_inference_ms": 0.7396851171903839, "mean_action_processing_ms": 0.07799849541761295, "mean_env_wait_ms": 6.38498392504927, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006963491439819336, "StateBufferConnector_ms": 0.003780364990234375, "ViewRequirementAgentConnector_ms": 0.09217023849487305}}, "episode_reward_max": -3.8999999999999986, "episode_reward_min": -69.10000000000042, "episode_reward_mean": -27.715000000000128, "episode_len_mean": 247.6, "episodes_this_iter": 19, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-36.600000000000065, -14.899999999999961, -65.70000000000041, -39.40000000000023, -14.099999999999962, -45.00000000000027, -7.799999999999985, -62.80000000000048, -47.60000000000019, -69.10000000000042, -46.300000000000246, -24.60000000000011, -48.3000000000002, -16.59999999999998, -34.600000000000215, -5.8999999999999915, -19.099999999999994, -42.000000000000284, -11.89999999999997, -40.500000000000306, -39.800000000000246, -38.7000000000002, -43.1000000000003, -6.999999999999988, -22.799999999999976, -46.90000000000027, -26.70000000000007, -43.10000000000028, -56.800000000000374, -6.099999999999991, -43.900000000000325, -43.40000000000033, -12.299999999999969, -33.30000000000018, -43.00000000000031, -11.499999999999972, -27.800000000000036, -25.70000000000007, -23.800000000000033, -11.69999999999997, -43.80000000000028, -4.999999999999995, -18.99999999999999, -9.19999999999998, -39.60000000000031, -43.80000000000034, -8.99999999999998, -42.400000000000276, -10.499999999999975, -54.10000000000028, -15.299999999999962, -8.199999999999989, -6.899999999999991, -13.999999999999963, -6.999999999999988, -42.00000000000033, -7.399999999999986, -15.39999999999997, -26.900000000000126, -7.099999999999987, -45.500000000000284, -43.40000000000033, -24.80000000000009, -63.500000000000355, -42.40000000000028, -12.199999999999969, -31.90000000000004, -46.50000000000027, -60.400000000000325, -21.900000000000045, -14.89999999999996, -5.999999999999991, -7.199999999999989, -11.99999999999997, -6.599999999999991, -43.1000000000003, -67.1000000000004, -41.80000000000027, -11.69999999999997, -12.199999999999969, -25.400000000000098, -50.900000000000354, -40.10000000000029, -17.99999999999998, -39.6000000000003, -18.200000000000003, -24.800000000000097, -17.199999999999985, -8.599999999999984, -41.10000000000031, -3.8999999999999986, -7.2999999999999865, -8.89999999999998, -16.799999999999983, -8.199999999999983, -5.199999999999994, -39.6000000000003, -42.300000000000246, -6.6999999999999895, -6.799999999999988], "episode_lengths": [292, 129, 400, 369, 129, 400, 89, 400, 400, 400, 400, 196, 400, 169, 341, 70, 191, 400, 130, 400, 365, 354, 397, 81, 207, 400, 226, 400, 400, 72, 400, 387, 130, 333, 400, 119, 250, 257, 228, 128, 400, 61, 194, 102, 379, 400, 101, 400, 116, 400, 164, 87, 77, 144, 81, 400, 85, 138, 275, 82, 400, 400, 254, 400, 400, 123, 286, 400, 400, 217, 160, 71, 79, 116, 75, 400, 400, 400, 121, 131, 254, 400, 400, 172, 390, 187, 259, 155, 92, 400, 50, 84, 94, 164, 88, 63, 394, 400, 77, 79]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23926489847108884, "mean_inference_ms": 0.7396851171903839, "mean_action_processing_ms": 0.07799849541761295, "mean_env_wait_ms": 6.38498392504927, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006963491439819336, "StateBufferConnector_ms": 0.003780364990234375, "ViewRequirementAgentConnector_ms": 0.09217023849487305}, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 454.1600041644558, "num_env_steps_trained_throughput_per_sec": 454.1600041644558, "timesteps_total": 40000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 40000, "timers": {"training_iteration_time_ms": 8908.078, "sample_time_ms": 5071.825, "load_time_ms": 1.061, "load_throughput": 3770499.82, "learn_time_ms": 3829.628, "learn_throughput": 1044.488, "synch_weights_time_ms": 4.79}, "counters": {"num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000}, "done": false, "episodes_total": 145, "training_iteration": 10, "trial_id": "b7012_00000", "date": "2024-03-07_12-41-34", "timestamp": 1709833294, "time_this_iter_s": 8.809799194335938, "time_total_s": 89.10466408729553, "pid": 109767, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4d85689f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 89.10466408729553, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 27.927272727272733, "ram_util_percent": 48.72727272727273, "gpu_util_percent0": 0.12272727272727271, "vram_util_percent0": 0.12931315104166669}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 4.24508021249566, "policy_loss": -0.01225909955639352, "vf_loss": 4.256296294527028, "vf_explained_var": -0.12189698417981466, "kl": 0.005215200964454734, "entropy": 1.0229766914921423, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 9765.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_agent_steps_sampled": 44000, "num_agent_steps_trained": 44000}, "sampler_results": {"episode_reward_max": -3.8999999999999986, "episode_reward_min": -67.1000000000004, "episode_reward_mean": -25.93300000000012, "episode_len_mean": 239.96, "episode_media": {}, "episodes_this_iter": 15, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-5.8999999999999915, -19.099999999999994, -42.000000000000284, -11.89999999999997, -40.500000000000306, -39.800000000000246, -38.7000000000002, -43.1000000000003, -6.999999999999988, -22.799999999999976, -46.90000000000027, -26.70000000000007, -43.10000000000028, -56.800000000000374, -6.099999999999991, -43.900000000000325, -43.40000000000033, -12.299999999999969, -33.30000000000018, -43.00000000000031, -11.499999999999972, -27.800000000000036, -25.70000000000007, -23.800000000000033, -11.69999999999997, -43.80000000000028, -4.999999999999995, -18.99999999999999, -9.19999999999998, -39.60000000000031, -43.80000000000034, -8.99999999999998, -42.400000000000276, -10.499999999999975, -54.10000000000028, -15.299999999999962, -8.199999999999989, -6.899999999999991, -13.999999999999963, -6.999999999999988, -42.00000000000033, -7.399999999999986, -15.39999999999997, -26.900000000000126, -7.099999999999987, -45.500000000000284, -43.40000000000033, -24.80000000000009, -63.500000000000355, -42.40000000000028, -12.199999999999969, -31.90000000000004, -46.50000000000027, -60.400000000000325, -21.900000000000045, -14.89999999999996, -5.999999999999991, -7.199999999999989, -11.99999999999997, -6.599999999999991, -43.1000000000003, -67.1000000000004, -41.80000000000027, -11.69999999999997, -12.199999999999969, -25.400000000000098, -50.900000000000354, -40.10000000000029, -17.99999999999998, -39.6000000000003, -18.200000000000003, -24.800000000000097, -17.199999999999985, -8.599999999999984, -41.10000000000031, -3.8999999999999986, -7.2999999999999865, -8.89999999999998, -16.799999999999983, -8.199999999999983, -5.199999999999994, -39.6000000000003, -42.300000000000246, -6.6999999999999895, -6.799999999999988, -32.80000000000016, -19.099999999999977, -40.80000000000024, -20.20000000000003, -41.90000000000032, -49.60000000000028, -6.599999999999989, -34.2000000000002, -22.50000000000006, -4.299999999999997, -28.500000000000124, -28.200000000000053, -5.799999999999992, -19.39999999999999, -41.30000000000028], "episode_lengths": [70, 191, 400, 130, 400, 365, 354, 397, 81, 207, 400, 226, 400, 400, 72, 400, 387, 130, 333, 400, 119, 250, 257, 228, 128, 400, 61, 194, 102, 379, 400, 101, 400, 116, 400, 164, 87, 77, 144, 81, 400, 85, 138, 275, 82, 400, 400, 254, 400, 400, 123, 286, 400, 400, 217, 160, 71, 79, 116, 75, 400, 400, 400, 121, 131, 254, 400, 400, 172, 390, 187, 259, 155, 92, 400, 50, 84, 94, 164, 88, 63, 394, 400, 77, 79, 296, 178, 366, 207, 400, 400, 77, 344, 233, 54, 282, 251, 69, 193, 400]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24031457395222575, "mean_inference_ms": 0.7409647657109535, "mean_action_processing_ms": 0.0781342264369209, "mean_env_wait_ms": 6.381886303644457, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007052898406982422, "StateBufferConnector_ms": 0.0038526058197021484, "ViewRequirementAgentConnector_ms": 0.09339642524719238}}, "episode_reward_max": -3.8999999999999986, "episode_reward_min": -67.1000000000004, "episode_reward_mean": -25.93300000000012, "episode_len_mean": 239.96, "episodes_this_iter": 15, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-5.8999999999999915, -19.099999999999994, -42.000000000000284, -11.89999999999997, -40.500000000000306, -39.800000000000246, -38.7000000000002, -43.1000000000003, -6.999999999999988, -22.799999999999976, -46.90000000000027, -26.70000000000007, -43.10000000000028, -56.800000000000374, -6.099999999999991, -43.900000000000325, -43.40000000000033, -12.299999999999969, -33.30000000000018, -43.00000000000031, -11.499999999999972, -27.800000000000036, -25.70000000000007, -23.800000000000033, -11.69999999999997, -43.80000000000028, -4.999999999999995, -18.99999999999999, -9.19999999999998, -39.60000000000031, -43.80000000000034, -8.99999999999998, -42.400000000000276, -10.499999999999975, -54.10000000000028, -15.299999999999962, -8.199999999999989, -6.899999999999991, -13.999999999999963, -6.999999999999988, -42.00000000000033, -7.399999999999986, -15.39999999999997, -26.900000000000126, -7.099999999999987, -45.500000000000284, -43.40000000000033, -24.80000000000009, -63.500000000000355, -42.40000000000028, -12.199999999999969, -31.90000000000004, -46.50000000000027, -60.400000000000325, -21.900000000000045, -14.89999999999996, -5.999999999999991, -7.199999999999989, -11.99999999999997, -6.599999999999991, -43.1000000000003, -67.1000000000004, -41.80000000000027, -11.69999999999997, -12.199999999999969, -25.400000000000098, -50.900000000000354, -40.10000000000029, -17.99999999999998, -39.6000000000003, -18.200000000000003, -24.800000000000097, -17.199999999999985, -8.599999999999984, -41.10000000000031, -3.8999999999999986, -7.2999999999999865, -8.89999999999998, -16.799999999999983, -8.199999999999983, -5.199999999999994, -39.6000000000003, -42.300000000000246, -6.6999999999999895, -6.799999999999988, -32.80000000000016, -19.099999999999977, -40.80000000000024, -20.20000000000003, -41.90000000000032, -49.60000000000028, -6.599999999999989, -34.2000000000002, -22.50000000000006, -4.299999999999997, -28.500000000000124, -28.200000000000053, -5.799999999999992, -19.39999999999999, -41.30000000000028], "episode_lengths": [70, 191, 400, 130, 400, 365, 354, 397, 81, 207, 400, 226, 400, 400, 72, 400, 387, 130, 333, 400, 119, 250, 257, 228, 128, 400, 61, 194, 102, 379, 400, 101, 400, 116, 400, 164, 87, 77, 144, 81, 400, 85, 138, 275, 82, 400, 400, 254, 400, 400, 123, 286, 400, 400, 217, 160, 71, 79, 116, 75, 400, 400, 400, 121, 131, 254, 400, 400, 172, 390, 187, 259, 155, 92, 400, 50, 84, 94, 164, 88, 63, 394, 400, 77, 79, 296, 178, 366, 207, 400, 400, 77, 344, 233, 54, 282, 251, 69, 193, 400]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24031457395222575, "mean_inference_ms": 0.7409647657109535, "mean_action_processing_ms": 0.0781342264369209, "mean_env_wait_ms": 6.381886303644457, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007052898406982422, "StateBufferConnector_ms": 0.0038526058197021484, "ViewRequirementAgentConnector_ms": 0.09339642524719238}, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 44000, "num_agent_steps_trained": 44000, "num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 421.1689538538371, "num_env_steps_trained_throughput_per_sec": 421.1689538538371, "timesteps_total": 44000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 44000, "timers": {"training_iteration_time_ms": 8968.493, "sample_time_ms": 5100.344, "load_time_ms": 1.077, "load_throughput": 3714074.205, "learn_time_ms": 3861.511, "learn_throughput": 1035.864, "synch_weights_time_ms": 4.796}, "counters": {"num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_agent_steps_sampled": 44000, "num_agent_steps_trained": 44000}, "done": false, "episodes_total": 160, "training_iteration": 11, "trial_id": "b7012_00000", "date": "2024-03-07_12-41-43", "timestamp": 1709833303, "time_this_iter_s": 9.499760389328003, "time_total_s": 98.60442447662354, "pid": 109767, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4d85689f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 98.60442447662354, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 31.566666666666666, "ram_util_percent": 48.90833333333333, "gpu_util_percent0": 0.16749999999999998, "vram_util_percent0": 0.1292724609375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 4.996265172189282, "policy_loss": -0.00994297056308677, "vf_loss": 5.005307854119168, "vf_explained_var": -0.36001197330413326, "kl": 0.004501282275595428, "entropy": 1.010404340297945, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 10695.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000}, "sampler_results": {"episode_reward_max": -3.8999999999999986, "episode_reward_min": -67.1000000000004, "episode_reward_mean": -24.195000000000103, "episode_len_mean": 226.27, "episode_media": {}, "episodes_this_iter": 19, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-43.00000000000031, -11.499999999999972, -27.800000000000036, -25.70000000000007, -23.800000000000033, -11.69999999999997, -43.80000000000028, -4.999999999999995, -18.99999999999999, -9.19999999999998, -39.60000000000031, -43.80000000000034, -8.99999999999998, -42.400000000000276, -10.499999999999975, -54.10000000000028, -15.299999999999962, -8.199999999999989, -6.899999999999991, -13.999999999999963, -6.999999999999988, -42.00000000000033, -7.399999999999986, -15.39999999999997, -26.900000000000126, -7.099999999999987, -45.500000000000284, -43.40000000000033, -24.80000000000009, -63.500000000000355, -42.40000000000028, -12.199999999999969, -31.90000000000004, -46.50000000000027, -60.400000000000325, -21.900000000000045, -14.89999999999996, -5.999999999999991, -7.199999999999989, -11.99999999999997, -6.599999999999991, -43.1000000000003, -67.1000000000004, -41.80000000000027, -11.69999999999997, -12.199999999999969, -25.400000000000098, -50.900000000000354, -40.10000000000029, -17.99999999999998, -39.6000000000003, -18.200000000000003, -24.800000000000097, -17.199999999999985, -8.599999999999984, -41.10000000000031, -3.8999999999999986, -7.2999999999999865, -8.89999999999998, -16.799999999999983, -8.199999999999983, -5.199999999999994, -39.6000000000003, -42.300000000000246, -6.6999999999999895, -6.799999999999988, -32.80000000000016, -19.099999999999977, -40.80000000000024, -20.20000000000003, -41.90000000000032, -49.60000000000028, -6.599999999999989, -34.2000000000002, -22.50000000000006, -4.299999999999997, -28.500000000000124, -28.200000000000053, -5.799999999999992, -19.39999999999999, -41.30000000000028, -42.900000000000325, -7.399999999999986, -22.50000000000003, -12.899999999999967, -40.60000000000031, -32.40000000000011, -32.20000000000012, -25.7000000000001, -7.999999999999993, -42.000000000000256, -19.69999999999999, -13.599999999999964, -37.100000000000264, -7.999999999999984, -6.799999999999988, -9.399999999999979, -7.2999999999999865, -21.30000000000005, -19.699999999999974], "episode_lengths": [400, 119, 250, 257, 228, 128, 400, 61, 194, 102, 379, 400, 101, 400, 116, 400, 164, 87, 77, 144, 81, 400, 85, 138, 275, 82, 400, 400, 254, 400, 400, 123, 286, 400, 400, 217, 160, 71, 79, 116, 75, 400, 400, 400, 121, 131, 254, 400, 400, 172, 390, 187, 259, 155, 92, 400, 50, 84, 94, 164, 88, 63, 394, 400, 77, 79, 296, 178, 366, 207, 400, 400, 77, 344, 233, 54, 282, 251, 69, 193, 400, 400, 85, 223, 128, 400, 282, 252, 261, 81, 400, 196, 144, 359, 91, 79, 104, 84, 218, 187]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24132953446371594, "mean_inference_ms": 0.7420756525578711, "mean_action_processing_ms": 0.07822867337814668, "mean_env_wait_ms": 6.376937960714616, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007031440734863281, "StateBufferConnector_ms": 0.0038704872131347656, "ViewRequirementAgentConnector_ms": 0.09374761581420898}}, "episode_reward_max": -3.8999999999999986, "episode_reward_min": -67.1000000000004, "episode_reward_mean": -24.195000000000103, "episode_len_mean": 226.27, "episodes_this_iter": 19, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-43.00000000000031, -11.499999999999972, -27.800000000000036, -25.70000000000007, -23.800000000000033, -11.69999999999997, -43.80000000000028, -4.999999999999995, -18.99999999999999, -9.19999999999998, -39.60000000000031, -43.80000000000034, -8.99999999999998, -42.400000000000276, -10.499999999999975, -54.10000000000028, -15.299999999999962, -8.199999999999989, -6.899999999999991, -13.999999999999963, -6.999999999999988, -42.00000000000033, -7.399999999999986, -15.39999999999997, -26.900000000000126, -7.099999999999987, -45.500000000000284, -43.40000000000033, -24.80000000000009, -63.500000000000355, -42.40000000000028, -12.199999999999969, -31.90000000000004, -46.50000000000027, -60.400000000000325, -21.900000000000045, -14.89999999999996, -5.999999999999991, -7.199999999999989, -11.99999999999997, -6.599999999999991, -43.1000000000003, -67.1000000000004, -41.80000000000027, -11.69999999999997, -12.199999999999969, -25.400000000000098, -50.900000000000354, -40.10000000000029, -17.99999999999998, -39.6000000000003, -18.200000000000003, -24.800000000000097, -17.199999999999985, -8.599999999999984, -41.10000000000031, -3.8999999999999986, -7.2999999999999865, -8.89999999999998, -16.799999999999983, -8.199999999999983, -5.199999999999994, -39.6000000000003, -42.300000000000246, -6.6999999999999895, -6.799999999999988, -32.80000000000016, -19.099999999999977, -40.80000000000024, -20.20000000000003, -41.90000000000032, -49.60000000000028, -6.599999999999989, -34.2000000000002, -22.50000000000006, -4.299999999999997, -28.500000000000124, -28.200000000000053, -5.799999999999992, -19.39999999999999, -41.30000000000028, -42.900000000000325, -7.399999999999986, -22.50000000000003, -12.899999999999967, -40.60000000000031, -32.40000000000011, -32.20000000000012, -25.7000000000001, -7.999999999999993, -42.000000000000256, -19.69999999999999, -13.599999999999964, -37.100000000000264, -7.999999999999984, -6.799999999999988, -9.399999999999979, -7.2999999999999865, -21.30000000000005, -19.699999999999974], "episode_lengths": [400, 119, 250, 257, 228, 128, 400, 61, 194, 102, 379, 400, 101, 400, 116, 400, 164, 87, 77, 144, 81, 400, 85, 138, 275, 82, 400, 400, 254, 400, 400, 123, 286, 400, 400, 217, 160, 71, 79, 116, 75, 400, 400, 400, 121, 131, 254, 400, 400, 172, 390, 187, 259, 155, 92, 400, 50, 84, 94, 164, 88, 63, 394, 400, 77, 79, 296, 178, 366, 207, 400, 400, 77, 344, 233, 54, 282, 251, 69, 193, 400, 400, 85, 223, 128, 400, 282, 252, 261, 81, 400, 196, 144, 359, 91, 79, 104, 84, 218, 187]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24132953446371594, "mean_inference_ms": 0.7420756525578711, "mean_action_processing_ms": 0.07822867337814668, "mean_env_wait_ms": 6.376937960714616, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007031440734863281, "StateBufferConnector_ms": 0.0038704872131347656, "ViewRequirementAgentConnector_ms": 0.09374761581420898}, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000, "num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 402.2908969098788, "num_env_steps_trained_throughput_per_sec": 402.2908969098788, "timesteps_total": 48000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 48000, "timers": {"training_iteration_time_ms": 9082.574, "sample_time_ms": 5134.357, "load_time_ms": 1.084, "load_throughput": 3688840.615, "learn_time_ms": 3941.598, "learn_throughput": 1014.817, "synch_weights_time_ms": 4.775}, "counters": {"num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000}, "done": false, "episodes_total": 179, "training_iteration": 12, "trial_id": "b7012_00000", "date": "2024-03-07_12-41-53", "timestamp": 1709833313, "time_this_iter_s": 9.9454505443573, "time_total_s": 108.54987502098083, "pid": 109767, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4d85689f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 108.54987502098083, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 35.46153846153847, "ram_util_percent": 49.93076923076923, "gpu_util_percent0": 0.15307692307692308, "vram_util_percent0": 0.13070913461538464}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.10000000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 4.34204418204164, "policy_loss": -0.012989177310498812, "vf_loss": 4.3543178168275665, "vf_explained_var": -0.1760796962245818, "kl": 0.007155526370768772, "entropy": 1.0269772862234423, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 11625.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_agent_steps_sampled": 52000, "num_agent_steps_trained": 52000}, "sampler_results": {"episode_reward_max": -3.8999999999999986, "episode_reward_min": -67.1000000000004, "episode_reward_mean": -23.7590000000001, "episode_len_mean": 222.68, "episode_media": {}, "episodes_this_iter": 17, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8.199999999999989, -6.899999999999991, -13.999999999999963, -6.999999999999988, -42.00000000000033, -7.399999999999986, -15.39999999999997, -26.900000000000126, -7.099999999999987, -45.500000000000284, -43.40000000000033, -24.80000000000009, -63.500000000000355, -42.40000000000028, -12.199999999999969, -31.90000000000004, -46.50000000000027, -60.400000000000325, -21.900000000000045, -14.89999999999996, -5.999999999999991, -7.199999999999989, -11.99999999999997, -6.599999999999991, -43.1000000000003, -67.1000000000004, -41.80000000000027, -11.69999999999997, -12.199999999999969, -25.400000000000098, -50.900000000000354, -40.10000000000029, -17.99999999999998, -39.6000000000003, -18.200000000000003, -24.800000000000097, -17.199999999999985, -8.599999999999984, -41.10000000000031, -3.8999999999999986, -7.2999999999999865, -8.89999999999998, -16.799999999999983, -8.199999999999983, -5.199999999999994, -39.6000000000003, -42.300000000000246, -6.6999999999999895, -6.799999999999988, -32.80000000000016, -19.099999999999977, -40.80000000000024, -20.20000000000003, -41.90000000000032, -49.60000000000028, -6.599999999999989, -34.2000000000002, -22.50000000000006, -4.299999999999997, -28.500000000000124, -28.200000000000053, -5.799999999999992, -19.39999999999999, -41.30000000000028, -42.900000000000325, -7.399999999999986, -22.50000000000003, -12.899999999999967, -40.60000000000031, -32.40000000000011, -32.20000000000012, -25.7000000000001, -7.999999999999993, -42.000000000000256, -19.69999999999999, -13.599999999999964, -37.100000000000264, -7.999999999999984, -6.799999999999988, -9.399999999999979, -7.2999999999999865, -21.30000000000005, -19.699999999999974, -8.699999999999982, -46.60000000000032, -8.599999999999982, -11.199999999999973, -53.90000000000021, -5.5999999999999925, -7.199999999999989, -20.70000000000004, -27.20000000000008, -33.50000000000016, -9.599999999999978, -42.800000000000296, -18.200000000000006, -42.000000000000306, -41.50000000000032, -7.899999999999984, -6.39999999999999], "episode_lengths": [87, 77, 144, 81, 400, 85, 138, 275, 82, 400, 400, 254, 400, 400, 123, 286, 400, 400, 217, 160, 71, 79, 116, 75, 400, 400, 400, 121, 131, 254, 400, 400, 172, 390, 187, 259, 155, 92, 400, 50, 84, 94, 164, 88, 63, 394, 400, 77, 79, 296, 178, 366, 207, 400, 400, 77, 344, 233, 54, 282, 251, 69, 193, 400, 400, 85, 223, 128, 400, 282, 252, 261, 81, 400, 196, 144, 359, 91, 79, 104, 84, 218, 187, 98, 400, 97, 123, 400, 67, 81, 217, 269, 328, 104, 400, 191, 400, 400, 90, 75]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.242429194687875, "mean_inference_ms": 0.7433510950654372, "mean_action_processing_ms": 0.07827838084669288, "mean_env_wait_ms": 6.384684468547776, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007081270217895508, "StateBufferConnector_ms": 0.0039103031158447266, "ViewRequirementAgentConnector_ms": 0.09447884559631348}}, "episode_reward_max": -3.8999999999999986, "episode_reward_min": -67.1000000000004, "episode_reward_mean": -23.7590000000001, "episode_len_mean": 222.68, "episodes_this_iter": 17, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-8.199999999999989, -6.899999999999991, -13.999999999999963, -6.999999999999988, -42.00000000000033, -7.399999999999986, -15.39999999999997, -26.900000000000126, -7.099999999999987, -45.500000000000284, -43.40000000000033, -24.80000000000009, -63.500000000000355, -42.40000000000028, -12.199999999999969, -31.90000000000004, -46.50000000000027, -60.400000000000325, -21.900000000000045, -14.89999999999996, -5.999999999999991, -7.199999999999989, -11.99999999999997, -6.599999999999991, -43.1000000000003, -67.1000000000004, -41.80000000000027, -11.69999999999997, -12.199999999999969, -25.400000000000098, -50.900000000000354, -40.10000000000029, -17.99999999999998, -39.6000000000003, -18.200000000000003, -24.800000000000097, -17.199999999999985, -8.599999999999984, -41.10000000000031, -3.8999999999999986, -7.2999999999999865, -8.89999999999998, -16.799999999999983, -8.199999999999983, -5.199999999999994, -39.6000000000003, -42.300000000000246, -6.6999999999999895, -6.799999999999988, -32.80000000000016, -19.099999999999977, -40.80000000000024, -20.20000000000003, -41.90000000000032, -49.60000000000028, -6.599999999999989, -34.2000000000002, -22.50000000000006, -4.299999999999997, -28.500000000000124, -28.200000000000053, -5.799999999999992, -19.39999999999999, -41.30000000000028, -42.900000000000325, -7.399999999999986, -22.50000000000003, -12.899999999999967, -40.60000000000031, -32.40000000000011, -32.20000000000012, -25.7000000000001, -7.999999999999993, -42.000000000000256, -19.69999999999999, -13.599999999999964, -37.100000000000264, -7.999999999999984, -6.799999999999988, -9.399999999999979, -7.2999999999999865, -21.30000000000005, -19.699999999999974, -8.699999999999982, -46.60000000000032, -8.599999999999982, -11.199999999999973, -53.90000000000021, -5.5999999999999925, -7.199999999999989, -20.70000000000004, -27.20000000000008, -33.50000000000016, -9.599999999999978, -42.800000000000296, -18.200000000000006, -42.000000000000306, -41.50000000000032, -7.899999999999984, -6.39999999999999], "episode_lengths": [87, 77, 144, 81, 400, 85, 138, 275, 82, 400, 400, 254, 400, 400, 123, 286, 400, 400, 217, 160, 71, 79, 116, 75, 400, 400, 400, 121, 131, 254, 400, 400, 172, 390, 187, 259, 155, 92, 400, 50, 84, 94, 164, 88, 63, 394, 400, 77, 79, 296, 178, 366, 207, 400, 400, 77, 344, 233, 54, 282, 251, 69, 193, 400, 400, 85, 223, 128, 400, 282, 252, 261, 81, 400, 196, 144, 359, 91, 79, 104, 84, 218, 187, 98, 400, 97, 123, 400, 67, 81, 217, 269, 328, 104, 400, 191, 400, 400, 90, 75]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.242429194687875, "mean_inference_ms": 0.7433510950654372, "mean_action_processing_ms": 0.07827838084669288, "mean_env_wait_ms": 6.384684468547776, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007081270217895508, "StateBufferConnector_ms": 0.0039103031158447266, "ViewRequirementAgentConnector_ms": 0.09447884559631348}, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 52000, "num_agent_steps_trained": 52000, "num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 426.004750258724, "num_env_steps_trained_throughput_per_sec": 426.004750258724, "timesteps_total": 52000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 52000, "timers": {"training_iteration_time_ms": 9149.313, "sample_time_ms": 5154.987, "load_time_ms": 1.086, "load_throughput": 3682363.425, "learn_time_ms": 3987.691, "learn_throughput": 1003.087, "synch_weights_time_ms": 4.788}, "counters": {"num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_agent_steps_sampled": 52000, "num_agent_steps_trained": 52000}, "done": false, "episodes_total": 196, "training_iteration": 13, "trial_id": "b7012_00000", "date": "2024-03-07_12-42-02", "timestamp": 1709833322, "time_this_iter_s": 9.39189338684082, "time_total_s": 117.94176840782166, "pid": 109767, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4d85689f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 117.94176840782166, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 30.599999999999994, "ram_util_percent": 50.199999999999996, "gpu_util_percent0": 0.17833333333333334, "vram_util_percent0": 0.12978108723958334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.10000000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 5.223066059748332, "policy_loss": -0.01183685037077114, "vf_loss": 5.234290777270993, "vf_explained_var": -0.04446401448659999, "kl": 0.006121365987028869, "entropy": 1.0102114954943298, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 12555.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 56000}, "sampler_results": {"episode_reward_max": -3.8999999999999986, "episode_reward_min": -67.1000000000004, "episode_reward_mean": -22.823000000000096, "episode_len_mean": 217.29, "episode_media": {}, "episodes_this_iter": 20, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-5.999999999999991, -7.199999999999989, -11.99999999999997, -6.599999999999991, -43.1000000000003, -67.1000000000004, -41.80000000000027, -11.69999999999997, -12.199999999999969, -25.400000000000098, -50.900000000000354, -40.10000000000029, -17.99999999999998, -39.6000000000003, -18.200000000000003, -24.800000000000097, -17.199999999999985, -8.599999999999984, -41.10000000000031, -3.8999999999999986, -7.2999999999999865, -8.89999999999998, -16.799999999999983, -8.199999999999983, -5.199999999999994, -39.6000000000003, -42.300000000000246, -6.6999999999999895, -6.799999999999988, -32.80000000000016, -19.099999999999977, -40.80000000000024, -20.20000000000003, -41.90000000000032, -49.60000000000028, -6.599999999999989, -34.2000000000002, -22.50000000000006, -4.299999999999997, -28.500000000000124, -28.200000000000053, -5.799999999999992, -19.39999999999999, -41.30000000000028, -42.900000000000325, -7.399999999999986, -22.50000000000003, -12.899999999999967, -40.60000000000031, -32.40000000000011, -32.20000000000012, -25.7000000000001, -7.999999999999993, -42.000000000000256, -19.69999999999999, -13.599999999999964, -37.100000000000264, -7.999999999999984, -6.799999999999988, -9.399999999999979, -7.2999999999999865, -21.30000000000005, -19.699999999999974, -8.699999999999982, -46.60000000000032, -8.599999999999982, -11.199999999999973, -53.90000000000021, -5.5999999999999925, -7.199999999999989, -20.70000000000004, -27.20000000000008, -33.50000000000016, -9.599999999999978, -42.800000000000296, -18.200000000000006, -42.000000000000306, -41.50000000000032, -7.899999999999984, -6.39999999999999, -10.199999999999985, -21.200000000000045, -43.20000000000031, -6.799999999999988, -16.99999999999996, -7.099999999999987, -7.599999999999987, -11.99999999999997, -6.599999999999989, -42.800000000000296, -40.90000000000031, -40.60000000000029, -25.500000000000107, -8.299999999999983, -6.599999999999992, -41.4000000000003, -46.40000000000036, -5.5999999999999925, -10.299999999999976, -48.60000000000026], "episode_lengths": [71, 79, 116, 75, 400, 400, 400, 121, 131, 254, 400, 400, 172, 390, 187, 259, 155, 92, 400, 50, 84, 94, 164, 88, 63, 394, 400, 77, 79, 296, 178, 366, 207, 400, 400, 77, 344, 233, 54, 282, 251, 69, 193, 400, 400, 85, 223, 128, 400, 282, 252, 261, 81, 400, 196, 144, 359, 91, 79, 104, 84, 218, 187, 98, 400, 97, 123, 400, 67, 81, 217, 269, 328, 104, 400, 191, 400, 400, 90, 75, 91, 221, 400, 79, 159, 82, 83, 131, 77, 400, 392, 400, 218, 93, 74, 400, 400, 67, 103, 400]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2434904413638003, "mean_inference_ms": 0.7457467534773606, "mean_action_processing_ms": 0.07828587788224645, "mean_env_wait_ms": 6.3977757345014545, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007318019866943359, "StateBufferConnector_ms": 0.003976583480834961, "ViewRequirementAgentConnector_ms": 0.09575200080871582}}, "episode_reward_max": -3.8999999999999986, "episode_reward_min": -67.1000000000004, "episode_reward_mean": -22.823000000000096, "episode_len_mean": 217.29, "episodes_this_iter": 20, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-5.999999999999991, -7.199999999999989, -11.99999999999997, -6.599999999999991, -43.1000000000003, -67.1000000000004, -41.80000000000027, -11.69999999999997, -12.199999999999969, -25.400000000000098, -50.900000000000354, -40.10000000000029, -17.99999999999998, -39.6000000000003, -18.200000000000003, -24.800000000000097, -17.199999999999985, -8.599999999999984, -41.10000000000031, -3.8999999999999986, -7.2999999999999865, -8.89999999999998, -16.799999999999983, -8.199999999999983, -5.199999999999994, -39.6000000000003, -42.300000000000246, -6.6999999999999895, -6.799999999999988, -32.80000000000016, -19.099999999999977, -40.80000000000024, -20.20000000000003, -41.90000000000032, -49.60000000000028, -6.599999999999989, -34.2000000000002, -22.50000000000006, -4.299999999999997, -28.500000000000124, -28.200000000000053, -5.799999999999992, -19.39999999999999, -41.30000000000028, -42.900000000000325, -7.399999999999986, -22.50000000000003, -12.899999999999967, -40.60000000000031, -32.40000000000011, -32.20000000000012, -25.7000000000001, -7.999999999999993, -42.000000000000256, -19.69999999999999, -13.599999999999964, -37.100000000000264, -7.999999999999984, -6.799999999999988, -9.399999999999979, -7.2999999999999865, -21.30000000000005, -19.699999999999974, -8.699999999999982, -46.60000000000032, -8.599999999999982, -11.199999999999973, -53.90000000000021, -5.5999999999999925, -7.199999999999989, -20.70000000000004, -27.20000000000008, -33.50000000000016, -9.599999999999978, -42.800000000000296, -18.200000000000006, -42.000000000000306, -41.50000000000032, -7.899999999999984, -6.39999999999999, -10.199999999999985, -21.200000000000045, -43.20000000000031, -6.799999999999988, -16.99999999999996, -7.099999999999987, -7.599999999999987, -11.99999999999997, -6.599999999999989, -42.800000000000296, -40.90000000000031, -40.60000000000029, -25.500000000000107, -8.299999999999983, -6.599999999999992, -41.4000000000003, -46.40000000000036, -5.5999999999999925, -10.299999999999976, -48.60000000000026], "episode_lengths": [71, 79, 116, 75, 400, 400, 400, 121, 131, 254, 400, 400, 172, 390, 187, 259, 155, 92, 400, 50, 84, 94, 164, 88, 63, 394, 400, 77, 79, 296, 178, 366, 207, 400, 400, 77, 344, 233, 54, 282, 251, 69, 193, 400, 400, 85, 223, 128, 400, 282, 252, 261, 81, 400, 196, 144, 359, 91, 79, 104, 84, 218, 187, 98, 400, 97, 123, 400, 67, 81, 217, 269, 328, 104, 400, 191, 400, 400, 90, 75, 91, 221, 400, 79, 159, 82, 83, 131, 77, 400, 392, 400, 218, 93, 74, 400, 400, 67, 103, 400]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2434904413638003, "mean_inference_ms": 0.7457467534773606, "mean_action_processing_ms": 0.07828587788224645, "mean_env_wait_ms": 6.3977757345014545, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007318019866943359, "StateBufferConnector_ms": 0.003976583480834961, "ViewRequirementAgentConnector_ms": 0.09575200080871582}, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 56000, "num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 427.32668129819956, "num_env_steps_trained_throughput_per_sec": 427.32668129819956, "timesteps_total": 56000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 56000, "timers": {"training_iteration_time_ms": 9181.131, "sample_time_ms": 5168.602, "load_time_ms": 1.086, "load_throughput": 3683495.291, "learn_time_ms": 4005.83, "learn_throughput": 998.545, "synch_weights_time_ms": 4.818}, "counters": {"num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 56000}, "done": false, "episodes_total": 216, "training_iteration": 14, "trial_id": "b7012_00000", "date": "2024-03-07_12-42-12", "timestamp": 1709833332, "time_this_iter_s": 9.363077878952026, "time_total_s": 127.30484628677368, "pid": 109767, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4d85689f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 127.30484628677368, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 30.29166666666666, "ram_util_percent": 50.199999999999996, "gpu_util_percent0": 0.13749999999999998, "vram_util_percent0": 0.12791612413194445}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.10000000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 5.205409270524979, "policy_loss": -0.011463011689083551, "vf_loss": 5.216270323273956, "vf_explained_var": -0.2084988929251189, "kl": 0.00601962098272282, "entropy": 1.0070591067114183, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 13485.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000}, "sampler_results": {"episode_reward_max": -3.8999999999999986, "episode_reward_min": -53.90000000000021, "episode_reward_mean": -22.162000000000088, "episode_len_mean": 212.38, "episode_media": {}, "episodes_this_iter": 19, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.8999999999999986, -7.2999999999999865, -8.89999999999998, -16.799999999999983, -8.199999999999983, -5.199999999999994, -39.6000000000003, -42.300000000000246, -6.6999999999999895, -6.799999999999988, -32.80000000000016, -19.099999999999977, -40.80000000000024, -20.20000000000003, -41.90000000000032, -49.60000000000028, -6.599999999999989, -34.2000000000002, -22.50000000000006, -4.299999999999997, -28.500000000000124, -28.200000000000053, -5.799999999999992, -19.39999999999999, -41.30000000000028, -42.900000000000325, -7.399999999999986, -22.50000000000003, -12.899999999999967, -40.60000000000031, -32.40000000000011, -32.20000000000012, -25.7000000000001, -7.999999999999993, -42.000000000000256, -19.69999999999999, -13.599999999999964, -37.100000000000264, -7.999999999999984, -6.799999999999988, -9.399999999999979, -7.2999999999999865, -21.30000000000005, -19.699999999999974, -8.699999999999982, -46.60000000000032, -8.599999999999982, -11.199999999999973, -53.90000000000021, -5.5999999999999925, -7.199999999999989, -20.70000000000004, -27.20000000000008, -33.50000000000016, -9.599999999999978, -42.800000000000296, -18.200000000000006, -42.000000000000306, -41.50000000000032, -7.899999999999984, -6.39999999999999, -10.199999999999985, -21.200000000000045, -43.20000000000031, -6.799999999999988, -16.99999999999996, -7.099999999999987, -7.599999999999987, -11.99999999999997, -6.599999999999989, -42.800000000000296, -40.90000000000031, -40.60000000000029, -25.500000000000107, -8.299999999999983, -6.599999999999992, -41.4000000000003, -46.40000000000036, -5.5999999999999925, -10.299999999999976, -48.60000000000026, -38.100000000000286, -45.00000000000031, -20.400000000000023, -21.699999999999974, -9.29999999999998, -36.00000000000011, -21.69999999999999, -4.299999999999997, -7.699999999999985, -43.800000000000296, -8.699999999999989, -42.90000000000029, -5.799999999999992, -25.500000000000092, -5.099999999999994, -25.70000000000011, -5.8999999999999915, -27.00000000000011, -30.9000000000001], "episode_lengths": [50, 84, 94, 164, 88, 63, 394, 400, 77, 79, 296, 178, 366, 207, 400, 400, 77, 344, 233, 54, 282, 251, 69, 193, 400, 400, 85, 223, 128, 400, 282, 252, 261, 81, 400, 196, 144, 359, 91, 79, 104, 84, 218, 187, 98, 400, 97, 123, 400, 67, 81, 217, 269, 328, 104, 400, 191, 400, 400, 90, 75, 91, 221, 400, 79, 159, 82, 83, 131, 77, 400, 392, 400, 218, 93, 74, 400, 400, 67, 103, 400, 373, 400, 186, 189, 102, 288, 168, 54, 88, 400, 87, 400, 69, 258, 62, 267, 70, 263, 287]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2447474321360599, "mean_inference_ms": 0.7480668435297307, "mean_action_processing_ms": 0.0784736623357472, "mean_env_wait_ms": 6.4121405490883525, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00735163688659668, "StateBufferConnector_ms": 0.004024982452392578, "ViewRequirementAgentConnector_ms": 0.09663724899291992}}, "episode_reward_max": -3.8999999999999986, "episode_reward_min": -53.90000000000021, "episode_reward_mean": -22.162000000000088, "episode_len_mean": 212.38, "episodes_this_iter": 19, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3.8999999999999986, -7.2999999999999865, -8.89999999999998, -16.799999999999983, -8.199999999999983, -5.199999999999994, -39.6000000000003, -42.300000000000246, -6.6999999999999895, -6.799999999999988, -32.80000000000016, -19.099999999999977, -40.80000000000024, -20.20000000000003, -41.90000000000032, -49.60000000000028, -6.599999999999989, -34.2000000000002, -22.50000000000006, -4.299999999999997, -28.500000000000124, -28.200000000000053, -5.799999999999992, -19.39999999999999, -41.30000000000028, -42.900000000000325, -7.399999999999986, -22.50000000000003, -12.899999999999967, -40.60000000000031, -32.40000000000011, -32.20000000000012, -25.7000000000001, -7.999999999999993, -42.000000000000256, -19.69999999999999, -13.599999999999964, -37.100000000000264, -7.999999999999984, -6.799999999999988, -9.399999999999979, -7.2999999999999865, -21.30000000000005, -19.699999999999974, -8.699999999999982, -46.60000000000032, -8.599999999999982, -11.199999999999973, -53.90000000000021, -5.5999999999999925, -7.199999999999989, -20.70000000000004, -27.20000000000008, -33.50000000000016, -9.599999999999978, -42.800000000000296, -18.200000000000006, -42.000000000000306, -41.50000000000032, -7.899999999999984, -6.39999999999999, -10.199999999999985, -21.200000000000045, -43.20000000000031, -6.799999999999988, -16.99999999999996, -7.099999999999987, -7.599999999999987, -11.99999999999997, -6.599999999999989, -42.800000000000296, -40.90000000000031, -40.60000000000029, -25.500000000000107, -8.299999999999983, -6.599999999999992, -41.4000000000003, -46.40000000000036, -5.5999999999999925, -10.299999999999976, -48.60000000000026, -38.100000000000286, -45.00000000000031, -20.400000000000023, -21.699999999999974, -9.29999999999998, -36.00000000000011, -21.69999999999999, -4.299999999999997, -7.699999999999985, -43.800000000000296, -8.699999999999989, -42.90000000000029, -5.799999999999992, -25.500000000000092, -5.099999999999994, -25.70000000000011, -5.8999999999999915, -27.00000000000011, -30.9000000000001], "episode_lengths": [50, 84, 94, 164, 88, 63, 394, 400, 77, 79, 296, 178, 366, 207, 400, 400, 77, 344, 233, 54, 282, 251, 69, 193, 400, 400, 85, 223, 128, 400, 282, 252, 261, 81, 400, 196, 144, 359, 91, 79, 104, 84, 218, 187, 98, 400, 97, 123, 400, 67, 81, 217, 269, 328, 104, 400, 191, 400, 400, 90, 75, 91, 221, 400, 79, 159, 82, 83, 131, 77, 400, 392, 400, 218, 93, 74, 400, 400, 67, 103, 400, 373, 400, 186, 189, 102, 288, 168, 54, 88, 400, 87, 400, 69, 258, 62, 267, 70, 263, 287]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2447474321360599, "mean_inference_ms": 0.7480668435297307, "mean_action_processing_ms": 0.0784736623357472, "mean_env_wait_ms": 6.4121405490883525, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00735163688659668, "StateBufferConnector_ms": 0.004024982452392578, "ViewRequirementAgentConnector_ms": 0.09663724899291992}, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000, "num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 440.2201255963834, "num_env_steps_trained_throughput_per_sec": 440.2201255963834, "timesteps_total": 60000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 60000, "timers": {"training_iteration_time_ms": 9156.265, "sample_time_ms": 5163.024, "load_time_ms": 1.042, "load_throughput": 3838477.167, "learn_time_ms": 3987.928, "learn_throughput": 1003.027, "synch_weights_time_ms": 3.51}, "counters": {"num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000}, "done": false, "episodes_total": 235, "training_iteration": 15, "trial_id": "b7012_00000", "date": "2024-03-07_12-42-21", "timestamp": 1709833341, "time_this_iter_s": 9.088642597198486, "time_total_s": 136.39348888397217, "pid": 109767, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4d85689f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 136.39348888397217, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 29.275000000000006, "ram_util_percent": 50.699999999999996, "gpu_util_percent0": 0.14333333333333334, "vram_util_percent0": 0.13067626953124997}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.10000000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 6.046124976552942, "policy_loss": -0.016712153482661453, "vf_loss": 6.061984335959599, "vf_explained_var": -0.06484909115299102, "kl": 0.008527716192729322, "entropy": 0.9964770383091384, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 14415.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000}, "sampler_results": {"episode_reward_max": -4.299999999999997, "episode_reward_min": -65.30000000000035, "episode_reward_mean": -22.443000000000094, "episode_len_mean": 211.32, "episode_media": {}, "episodes_this_iter": 23, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-19.39999999999999, -41.30000000000028, -42.900000000000325, -7.399999999999986, -22.50000000000003, -12.899999999999967, -40.60000000000031, -32.40000000000011, -32.20000000000012, -25.7000000000001, -7.999999999999993, -42.000000000000256, -19.69999999999999, -13.599999999999964, -37.100000000000264, -7.999999999999984, -6.799999999999988, -9.399999999999979, -7.2999999999999865, -21.30000000000005, -19.699999999999974, -8.699999999999982, -46.60000000000032, -8.599999999999982, -11.199999999999973, -53.90000000000021, -5.5999999999999925, -7.199999999999989, -20.70000000000004, -27.20000000000008, -33.50000000000016, -9.599999999999978, -42.800000000000296, -18.200000000000006, -42.000000000000306, -41.50000000000032, -7.899999999999984, -6.39999999999999, -10.199999999999985, -21.200000000000045, -43.20000000000031, -6.799999999999988, -16.99999999999996, -7.099999999999987, -7.599999999999987, -11.99999999999997, -6.599999999999989, -42.800000000000296, -40.90000000000031, -40.60000000000029, -25.500000000000107, -8.299999999999983, -6.599999999999992, -41.4000000000003, -46.40000000000036, -5.5999999999999925, -10.299999999999976, -48.60000000000026, -38.100000000000286, -45.00000000000031, -20.400000000000023, -21.699999999999974, -9.29999999999998, -36.00000000000011, -21.69999999999999, -4.299999999999997, -7.699999999999985, -43.800000000000296, -8.699999999999989, -42.90000000000029, -5.799999999999992, -25.500000000000092, -5.099999999999994, -25.70000000000011, -5.8999999999999915, -27.00000000000011, -30.9000000000001, -36.00000000000025, -9.399999999999979, -10.999999999999975, -13.199999999999966, -43.500000000000284, -33.90000000000022, -6.599999999999989, -9.699999999999982, -52.000000000000306, -6.59999999999999, -5.299999999999994, -26.700000000000077, -7.699999999999987, -7.699999999999987, -6.599999999999989, -54.000000000000234, -65.30000000000035, -6.19999999999999, -6.6999999999999895, -28.800000000000093, -15.499999999999964, -9.399999999999979, -46.50000000000026], "episode_lengths": [193, 400, 400, 85, 223, 128, 400, 282, 252, 261, 81, 400, 196, 144, 359, 91, 79, 104, 84, 218, 187, 98, 400, 97, 123, 400, 67, 81, 217, 269, 328, 104, 400, 191, 400, 400, 90, 75, 91, 221, 400, 79, 159, 82, 83, 131, 77, 400, 392, 400, 218, 93, 74, 400, 400, 67, 103, 400, 373, 400, 186, 189, 102, 288, 168, 54, 88, 400, 87, 400, 69, 258, 62, 267, 70, 263, 287, 361, 105, 112, 133, 400, 343, 77, 101, 400, 73, 64, 260, 87, 85, 77, 382, 400, 73, 77, 270, 162, 102, 400]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24605450607858131, "mean_inference_ms": 0.7501218987089178, "mean_action_processing_ms": 0.07863803146696408, "mean_env_wait_ms": 6.425142987971007, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007336854934692383, "StateBufferConnector_ms": 0.003985881805419922, "ViewRequirementAgentConnector_ms": 0.0962822437286377}}, "episode_reward_max": -4.299999999999997, "episode_reward_min": -65.30000000000035, "episode_reward_mean": -22.443000000000094, "episode_len_mean": 211.32, "episodes_this_iter": 23, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-19.39999999999999, -41.30000000000028, -42.900000000000325, -7.399999999999986, -22.50000000000003, -12.899999999999967, -40.60000000000031, -32.40000000000011, -32.20000000000012, -25.7000000000001, -7.999999999999993, -42.000000000000256, -19.69999999999999, -13.599999999999964, -37.100000000000264, -7.999999999999984, -6.799999999999988, -9.399999999999979, -7.2999999999999865, -21.30000000000005, -19.699999999999974, -8.699999999999982, -46.60000000000032, -8.599999999999982, -11.199999999999973, -53.90000000000021, -5.5999999999999925, -7.199999999999989, -20.70000000000004, -27.20000000000008, -33.50000000000016, -9.599999999999978, -42.800000000000296, -18.200000000000006, -42.000000000000306, -41.50000000000032, -7.899999999999984, -6.39999999999999, -10.199999999999985, -21.200000000000045, -43.20000000000031, -6.799999999999988, -16.99999999999996, -7.099999999999987, -7.599999999999987, -11.99999999999997, -6.599999999999989, -42.800000000000296, -40.90000000000031, -40.60000000000029, -25.500000000000107, -8.299999999999983, -6.599999999999992, -41.4000000000003, -46.40000000000036, -5.5999999999999925, -10.299999999999976, -48.60000000000026, -38.100000000000286, -45.00000000000031, -20.400000000000023, -21.699999999999974, -9.29999999999998, -36.00000000000011, -21.69999999999999, -4.299999999999997, -7.699999999999985, -43.800000000000296, -8.699999999999989, -42.90000000000029, -5.799999999999992, -25.500000000000092, -5.099999999999994, -25.70000000000011, -5.8999999999999915, -27.00000000000011, -30.9000000000001, -36.00000000000025, -9.399999999999979, -10.999999999999975, -13.199999999999966, -43.500000000000284, -33.90000000000022, -6.599999999999989, -9.699999999999982, -52.000000000000306, -6.59999999999999, -5.299999999999994, -26.700000000000077, -7.699999999999987, -7.699999999999987, -6.599999999999989, -54.000000000000234, -65.30000000000035, -6.19999999999999, -6.6999999999999895, -28.800000000000093, -15.499999999999964, -9.399999999999979, -46.50000000000026], "episode_lengths": [193, 400, 400, 85, 223, 128, 400, 282, 252, 261, 81, 400, 196, 144, 359, 91, 79, 104, 84, 218, 187, 98, 400, 97, 123, 400, 67, 81, 217, 269, 328, 104, 400, 191, 400, 400, 90, 75, 91, 221, 400, 79, 159, 82, 83, 131, 77, 400, 392, 400, 218, 93, 74, 400, 400, 67, 103, 400, 373, 400, 186, 189, 102, 288, 168, 54, 88, 400, 87, 400, 69, 258, 62, 267, 70, 263, 287, 361, 105, 112, 133, 400, 343, 77, 101, 400, 73, 64, 260, 87, 85, 77, 382, 400, 73, 77, 270, 162, 102, 400]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24605450607858131, "mean_inference_ms": 0.7501218987089178, "mean_action_processing_ms": 0.07863803146696408, "mean_env_wait_ms": 6.425142987971007, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007336854934692383, "StateBufferConnector_ms": 0.003985881805419922, "ViewRequirementAgentConnector_ms": 0.0962822437286377}, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000, "num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 448.5564126151465, "num_env_steps_trained_throughput_per_sec": 448.5564126151465, "timesteps_total": 64000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 64000, "timers": {"training_iteration_time_ms": 9121.002, "sample_time_ms": 5138.5, "load_time_ms": 1.047, "load_throughput": 3819948.998, "learn_time_ms": 3978.436, "learn_throughput": 1005.42, "synch_weights_time_ms": 2.296}, "counters": {"num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000}, "done": false, "episodes_total": 258, "training_iteration": 16, "trial_id": "b7012_00000", "date": "2024-03-07_12-42-30", "timestamp": 1709833350, "time_this_iter_s": 8.919734954833984, "time_total_s": 145.31322383880615, "pid": 109767, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4d85689f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 145.31322383880615, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 28.58181818181818, "ram_util_percent": 50.5, "gpu_util_percent0": 0.1127272727272727, "vram_util_percent0": 0.129638671875}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.10000000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 6.421101008051185, "policy_loss": -0.006069634169820816, "vf_loss": 6.426470682000922, "vf_explained_var": -0.15063845060204947, "kl": 0.00699944104571048, "entropy": 0.9829221668422863, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 15345.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_agent_steps_sampled": 68000, "num_agent_steps_trained": 68000}, "sampler_results": {"episode_reward_max": -4.299999999999997, "episode_reward_min": -65.30000000000035, "episode_reward_mean": -20.190000000000076, "episode_len_mean": 191.92, "episode_media": {}, "episodes_this_iter": 26, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-5.5999999999999925, -7.199999999999989, -20.70000000000004, -27.20000000000008, -33.50000000000016, -9.599999999999978, -42.800000000000296, -18.200000000000006, -42.000000000000306, -41.50000000000032, -7.899999999999984, -6.39999999999999, -10.199999999999985, -21.200000000000045, -43.20000000000031, -6.799999999999988, -16.99999999999996, -7.099999999999987, -7.599999999999987, -11.99999999999997, -6.599999999999989, -42.800000000000296, -40.90000000000031, -40.60000000000029, -25.500000000000107, -8.299999999999983, -6.599999999999992, -41.4000000000003, -46.40000000000036, -5.5999999999999925, -10.299999999999976, -48.60000000000026, -38.100000000000286, -45.00000000000031, -20.400000000000023, -21.699999999999974, -9.29999999999998, -36.00000000000011, -21.69999999999999, -4.299999999999997, -7.699999999999985, -43.800000000000296, -8.699999999999989, -42.90000000000029, -5.799999999999992, -25.500000000000092, -5.099999999999994, -25.70000000000011, -5.8999999999999915, -27.00000000000011, -30.9000000000001, -36.00000000000025, -9.399999999999979, -10.999999999999975, -13.199999999999966, -43.500000000000284, -33.90000000000022, -6.599999999999989, -9.699999999999982, -52.000000000000306, -6.59999999999999, -5.299999999999994, -26.700000000000077, -7.699999999999987, -7.699999999999987, -6.599999999999989, -54.000000000000234, -65.30000000000035, -6.19999999999999, -6.6999999999999895, -28.800000000000093, -15.499999999999964, -9.399999999999979, -46.50000000000026, -15.699999999999967, -7.2999999999999865, -5.599999999999994, -9.599999999999978, -9.399999999999979, -4.599999999999996, -10.699999999999974, -46.900000000000226, -42.00000000000029, -5.299999999999994, -9.199999999999982, -17.899999999999984, -41.000000000000306, -8.89999999999998, -7.499999999999986, -9.699999999999978, -11.099999999999973, -8.199999999999983, -7.899999999999988, -7.899999999999984, -9.49999999999998, -25.80000000000005, -5.799999999999994, -29.800000000000082, -9.499999999999979, -7.099999999999987], "episode_lengths": [67, 81, 217, 269, 328, 104, 400, 191, 400, 400, 90, 75, 91, 221, 400, 79, 159, 82, 83, 131, 77, 400, 392, 400, 218, 93, 74, 400, 400, 67, 103, 400, 373, 400, 186, 189, 102, 288, 168, 54, 88, 400, 87, 400, 69, 258, 62, 267, 70, 263, 287, 361, 105, 112, 133, 400, 343, 77, 101, 400, 73, 64, 260, 87, 85, 77, 382, 400, 73, 77, 270, 162, 102, 400, 156, 84, 65, 99, 99, 57, 115, 400, 400, 64, 101, 182, 400, 99, 86, 108, 116, 89, 83, 90, 103, 234, 67, 264, 102, 82]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2472292225015013, "mean_inference_ms": 0.7505248286999934, "mean_action_processing_ms": 0.07872494530233504, "mean_env_wait_ms": 6.429693922480198, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0072896480560302734, "StateBufferConnector_ms": 0.003919839859008789, "ViewRequirementAgentConnector_ms": 0.09465718269348145}}, "episode_reward_max": -4.299999999999997, "episode_reward_min": -65.30000000000035, "episode_reward_mean": -20.190000000000076, "episode_len_mean": 191.92, "episodes_this_iter": 26, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-5.5999999999999925, -7.199999999999989, -20.70000000000004, -27.20000000000008, -33.50000000000016, -9.599999999999978, -42.800000000000296, -18.200000000000006, -42.000000000000306, -41.50000000000032, -7.899999999999984, -6.39999999999999, -10.199999999999985, -21.200000000000045, -43.20000000000031, -6.799999999999988, -16.99999999999996, -7.099999999999987, -7.599999999999987, -11.99999999999997, -6.599999999999989, -42.800000000000296, -40.90000000000031, -40.60000000000029, -25.500000000000107, -8.299999999999983, -6.599999999999992, -41.4000000000003, -46.40000000000036, -5.5999999999999925, -10.299999999999976, -48.60000000000026, -38.100000000000286, -45.00000000000031, -20.400000000000023, -21.699999999999974, -9.29999999999998, -36.00000000000011, -21.69999999999999, -4.299999999999997, -7.699999999999985, -43.800000000000296, -8.699999999999989, -42.90000000000029, -5.799999999999992, -25.500000000000092, -5.099999999999994, -25.70000000000011, -5.8999999999999915, -27.00000000000011, -30.9000000000001, -36.00000000000025, -9.399999999999979, -10.999999999999975, -13.199999999999966, -43.500000000000284, -33.90000000000022, -6.599999999999989, -9.699999999999982, -52.000000000000306, -6.59999999999999, -5.299999999999994, -26.700000000000077, -7.699999999999987, -7.699999999999987, -6.599999999999989, -54.000000000000234, -65.30000000000035, -6.19999999999999, -6.6999999999999895, -28.800000000000093, -15.499999999999964, -9.399999999999979, -46.50000000000026, -15.699999999999967, -7.2999999999999865, -5.599999999999994, -9.599999999999978, -9.399999999999979, -4.599999999999996, -10.699999999999974, -46.900000000000226, -42.00000000000029, -5.299999999999994, -9.199999999999982, -17.899999999999984, -41.000000000000306, -8.89999999999998, -7.499999999999986, -9.699999999999978, -11.099999999999973, -8.199999999999983, -7.899999999999988, -7.899999999999984, -9.49999999999998, -25.80000000000005, -5.799999999999994, -29.800000000000082, -9.499999999999979, -7.099999999999987], "episode_lengths": [67, 81, 217, 269, 328, 104, 400, 191, 400, 400, 90, 75, 91, 221, 400, 79, 159, 82, 83, 131, 77, 400, 392, 400, 218, 93, 74, 400, 400, 67, 103, 400, 373, 400, 186, 189, 102, 288, 168, 54, 88, 400, 87, 400, 69, 258, 62, 267, 70, 263, 287, 361, 105, 112, 133, 400, 343, 77, 101, 400, 73, 64, 260, 87, 85, 77, 382, 400, 73, 77, 270, 162, 102, 400, 156, 84, 65, 99, 99, 57, 115, 400, 400, 64, 101, 182, 400, 99, 86, 108, 116, 89, 83, 90, 103, 234, 67, 264, 102, 82]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2472292225015013, "mean_inference_ms": 0.7505248286999934, "mean_action_processing_ms": 0.07872494530233504, "mean_env_wait_ms": 6.429693922480198, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0072896480560302734, "StateBufferConnector_ms": 0.003919839859008789, "ViewRequirementAgentConnector_ms": 0.09465718269348145}, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 68000, "num_agent_steps_trained": 68000, "num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 428.05661837635114, "num_env_steps_trained_throughput_per_sec": 428.05661837635114, "timesteps_total": 68000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 68000, "timers": {"training_iteration_time_ms": 9173.075, "sample_time_ms": 5157.609, "load_time_ms": 1.037, "load_throughput": 3855590.385, "learn_time_ms": 4011.399, "learn_throughput": 997.158, "synch_weights_time_ms": 2.302}, "counters": {"num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_agent_steps_sampled": 68000, "num_agent_steps_trained": 68000}, "done": false, "episodes_total": 284, "training_iteration": 17, "trial_id": "b7012_00000", "date": "2024-03-07_12-42-39", "timestamp": 1709833359, "time_this_iter_s": 9.34684157371521, "time_total_s": 154.66006541252136, "pid": 109767, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4d85689f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 154.66006541252136, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 28.64166666666667, "ram_util_percent": 50.333333333333336, "gpu_util_percent0": 0.1525, "vram_util_percent0": 0.12870958116319445}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.10000000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 5.791311334922749, "policy_loss": -0.014674148279973256, "vf_loss": 5.805343052808956, "vf_explained_var": -0.21661301062953087, "kl": 0.006424326014294674, "entropy": 0.9730198679431792, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 16275.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000}, "sampler_results": {"episode_reward_max": -4.299999999999997, "episode_reward_min": -65.30000000000035, "episode_reward_mean": -19.782000000000068, "episode_len_mean": 186.58, "episode_media": {}, "episodes_this_iter": 22, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-40.90000000000031, -40.60000000000029, -25.500000000000107, -8.299999999999983, -6.599999999999992, -41.4000000000003, -46.40000000000036, -5.5999999999999925, -10.299999999999976, -48.60000000000026, -38.100000000000286, -45.00000000000031, -20.400000000000023, -21.699999999999974, -9.29999999999998, -36.00000000000011, -21.69999999999999, -4.299999999999997, -7.699999999999985, -43.800000000000296, -8.699999999999989, -42.90000000000029, -5.799999999999992, -25.500000000000092, -5.099999999999994, -25.70000000000011, -5.8999999999999915, -27.00000000000011, -30.9000000000001, -36.00000000000025, -9.399999999999979, -10.999999999999975, -13.199999999999966, -43.500000000000284, -33.90000000000022, -6.599999999999989, -9.699999999999982, -52.000000000000306, -6.59999999999999, -5.299999999999994, -26.700000000000077, -7.699999999999987, -7.699999999999987, -6.599999999999989, -54.000000000000234, -65.30000000000035, -6.19999999999999, -6.6999999999999895, -28.800000000000093, -15.499999999999964, -9.399999999999979, -46.50000000000026, -15.699999999999967, -7.2999999999999865, -5.599999999999994, -9.599999999999978, -9.399999999999979, -4.599999999999996, -10.699999999999974, -46.900000000000226, -42.00000000000029, -5.299999999999994, -9.199999999999982, -17.899999999999984, -41.000000000000306, -8.89999999999998, -7.499999999999986, -9.699999999999978, -11.099999999999973, -8.199999999999983, -7.899999999999988, -7.899999999999984, -9.49999999999998, -25.80000000000005, -5.799999999999994, -29.800000000000082, -9.499999999999979, -7.099999999999987, -9.29999999999998, -26.100000000000076, -7.099999999999989, -4.999999999999995, -42.30000000000031, -4.899999999999995, -32.600000000000165, -42.800000000000246, -16.49999999999998, -7.899999999999984, -8.499999999999982, -11.799999999999972, -6.799999999999988, -6.599999999999989, -6.199999999999995, -9.399999999999979, -40.3000000000003, -29.200000000000106, -10.099999999999977, -7.999999999999984, -10.499999999999975, -54.40000000000035], "episode_lengths": [392, 400, 218, 93, 74, 400, 400, 67, 103, 400, 373, 400, 186, 189, 102, 288, 168, 54, 88, 400, 87, 400, 69, 258, 62, 267, 70, 263, 287, 361, 105, 112, 133, 400, 343, 77, 101, 400, 73, 64, 260, 87, 85, 77, 382, 400, 73, 77, 270, 162, 102, 400, 156, 84, 65, 99, 99, 57, 115, 400, 400, 64, 101, 182, 400, 99, 86, 108, 116, 89, 83, 90, 103, 234, 67, 264, 102, 82, 102, 249, 81, 61, 400, 60, 297, 383, 163, 90, 96, 109, 79, 77, 68, 101, 400, 281, 112, 91, 113, 398]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24815545267831393, "mean_inference_ms": 0.7507290157955547, "mean_action_processing_ms": 0.07881686294001236, "mean_env_wait_ms": 6.434403238007551, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007313966751098633, "StateBufferConnector_ms": 0.003939151763916016, "ViewRequirementAgentConnector_ms": 0.09536504745483398}}, "episode_reward_max": -4.299999999999997, "episode_reward_min": -65.30000000000035, "episode_reward_mean": -19.782000000000068, "episode_len_mean": 186.58, "episodes_this_iter": 22, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-40.90000000000031, -40.60000000000029, -25.500000000000107, -8.299999999999983, -6.599999999999992, -41.4000000000003, -46.40000000000036, -5.5999999999999925, -10.299999999999976, -48.60000000000026, -38.100000000000286, -45.00000000000031, -20.400000000000023, -21.699999999999974, -9.29999999999998, -36.00000000000011, -21.69999999999999, -4.299999999999997, -7.699999999999985, -43.800000000000296, -8.699999999999989, -42.90000000000029, -5.799999999999992, -25.500000000000092, -5.099999999999994, -25.70000000000011, -5.8999999999999915, -27.00000000000011, -30.9000000000001, -36.00000000000025, -9.399999999999979, -10.999999999999975, -13.199999999999966, -43.500000000000284, -33.90000000000022, -6.599999999999989, -9.699999999999982, -52.000000000000306, -6.59999999999999, -5.299999999999994, -26.700000000000077, -7.699999999999987, -7.699999999999987, -6.599999999999989, -54.000000000000234, -65.30000000000035, -6.19999999999999, -6.6999999999999895, -28.800000000000093, -15.499999999999964, -9.399999999999979, -46.50000000000026, -15.699999999999967, -7.2999999999999865, -5.599999999999994, -9.599999999999978, -9.399999999999979, -4.599999999999996, -10.699999999999974, -46.900000000000226, -42.00000000000029, -5.299999999999994, -9.199999999999982, -17.899999999999984, -41.000000000000306, -8.89999999999998, -7.499999999999986, -9.699999999999978, -11.099999999999973, -8.199999999999983, -7.899999999999988, -7.899999999999984, -9.49999999999998, -25.80000000000005, -5.799999999999994, -29.800000000000082, -9.499999999999979, -7.099999999999987, -9.29999999999998, -26.100000000000076, -7.099999999999989, -4.999999999999995, -42.30000000000031, -4.899999999999995, -32.600000000000165, -42.800000000000246, -16.49999999999998, -7.899999999999984, -8.499999999999982, -11.799999999999972, -6.799999999999988, -6.599999999999989, -6.199999999999995, -9.399999999999979, -40.3000000000003, -29.200000000000106, -10.099999999999977, -7.999999999999984, -10.499999999999975, -54.40000000000035], "episode_lengths": [392, 400, 218, 93, 74, 400, 400, 67, 103, 400, 373, 400, 186, 189, 102, 288, 168, 54, 88, 400, 87, 400, 69, 258, 62, 267, 70, 263, 287, 361, 105, 112, 133, 400, 343, 77, 101, 400, 73, 64, 260, 87, 85, 77, 382, 400, 73, 77, 270, 162, 102, 400, 156, 84, 65, 99, 99, 57, 115, 400, 400, 64, 101, 182, 400, 99, 86, 108, 116, 89, 83, 90, 103, 234, 67, 264, 102, 82, 102, 249, 81, 61, 400, 60, 297, 383, 163, 90, 96, 109, 79, 77, 68, 101, 400, 281, 112, 91, 113, 398]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24815545267831393, "mean_inference_ms": 0.7507290157955547, "mean_action_processing_ms": 0.07881686294001236, "mean_env_wait_ms": 6.434403238007551, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007313966751098633, "StateBufferConnector_ms": 0.003939151763916016, "ViewRequirementAgentConnector_ms": 0.09536504745483398}, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000, "num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 429.3913452844226, "num_env_steps_trained_throughput_per_sec": 429.3913452844226, "timesteps_total": 72000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 72000, "timers": {"training_iteration_time_ms": 9236.39, "sample_time_ms": 5213.905, "load_time_ms": 1.014, "load_throughput": 3943961.071, "learn_time_ms": 4018.46, "learn_throughput": 995.406, "synch_weights_time_ms": 2.289}, "counters": {"num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000}, "done": false, "episodes_total": 306, "training_iteration": 18, "trial_id": "b7012_00000", "date": "2024-03-07_12-42-48", "timestamp": 1709833368, "time_this_iter_s": 9.33024787902832, "time_total_s": 163.99031329154968, "pid": 109767, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4d85689f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 163.99031329154968, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 30.915384615384614, "ram_util_percent": 50.330769230769235, "gpu_util_percent0": 0.13923076923076924, "vram_util_percent0": 0.12670898437500003}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.10000000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 5.519868914670842, "policy_loss": -0.018847261020733464, "vf_loss": 5.537892673733414, "vf_explained_var": -0.6940313486642735, "kl": 0.008234997953812762, "entropy": 0.9912212188525866, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 17205.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_agent_steps_sampled": 76000, "num_agent_steps_trained": 76000}, "sampler_results": {"episode_reward_max": -4.599999999999996, "episode_reward_min": -65.30000000000035, "episode_reward_mean": -17.032000000000043, "episode_len_mean": 161.69, "episode_media": {}, "episodes_this_iter": 31, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10.999999999999975, -13.199999999999966, -43.500000000000284, -33.90000000000022, -6.599999999999989, -9.699999999999982, -52.000000000000306, -6.59999999999999, -5.299999999999994, -26.700000000000077, -7.699999999999987, -7.699999999999987, -6.599999999999989, -54.000000000000234, -65.30000000000035, -6.19999999999999, -6.6999999999999895, -28.800000000000093, -15.499999999999964, -9.399999999999979, -46.50000000000026, -15.699999999999967, -7.2999999999999865, -5.599999999999994, -9.599999999999978, -9.399999999999979, -4.599999999999996, -10.699999999999974, -46.900000000000226, -42.00000000000029, -5.299999999999994, -9.199999999999982, -17.899999999999984, -41.000000000000306, -8.89999999999998, -7.499999999999986, -9.699999999999978, -11.099999999999973, -8.199999999999983, -7.899999999999988, -7.899999999999984, -9.49999999999998, -25.80000000000005, -5.799999999999994, -29.800000000000082, -9.499999999999979, -7.099999999999987, -9.29999999999998, -26.100000000000076, -7.099999999999989, -4.999999999999995, -42.30000000000031, -4.899999999999995, -32.600000000000165, -42.800000000000246, -16.49999999999998, -7.899999999999984, -8.499999999999982, -11.799999999999972, -6.799999999999988, -6.599999999999989, -6.199999999999995, -9.399999999999979, -40.3000000000003, -29.200000000000106, -10.099999999999977, -7.999999999999984, -10.499999999999975, -54.40000000000035, -36.60000000000019, -16.099999999999973, -9.399999999999983, -8.299999999999983, -48.10000000000033, -14.79999999999996, -8.099999999999987, -9.19999999999998, -9.699999999999978, -11.099999999999973, -54.60000000000031, -6.499999999999991, -6.099999999999991, -6.39999999999999, -8.89999999999998, -21.300000000000047, -48.00000000000029, -7.7999999999999865, -13.099999999999966, -12.599999999999968, -10.499999999999975, -9.699999999999982, -9.19999999999998, -9.29999999999998, -9.29999999999998, -7.199999999999989, -9.499999999999979, -24.10000000000009, -6.499999999999989, -13.299999999999965, -4.799999999999995], "episode_lengths": [112, 133, 400, 343, 77, 101, 400, 73, 64, 260, 87, 85, 77, 382, 400, 73, 77, 270, 162, 102, 400, 156, 84, 65, 99, 99, 57, 115, 400, 400, 64, 101, 182, 400, 99, 86, 108, 116, 89, 83, 90, 103, 234, 67, 264, 102, 82, 102, 249, 81, 61, 400, 60, 297, 383, 163, 90, 96, 109, 79, 77, 68, 101, 400, 281, 112, 91, 113, 398, 331, 166, 92, 90, 400, 156, 84, 101, 106, 114, 400, 74, 72, 75, 99, 211, 400, 84, 140, 128, 109, 94, 103, 101, 98, 81, 106, 249, 76, 137, 58]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24926995256574414, "mean_inference_ms": 0.7511891002768958, "mean_action_processing_ms": 0.07880377226953865, "mean_env_wait_ms": 6.441364745928549, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007121086120605469, "StateBufferConnector_ms": 0.0038995742797851562, "ViewRequirementAgentConnector_ms": 0.09441375732421875}}, "episode_reward_max": -4.599999999999996, "episode_reward_min": -65.30000000000035, "episode_reward_mean": -17.032000000000043, "episode_len_mean": 161.69, "episodes_this_iter": 31, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10.999999999999975, -13.199999999999966, -43.500000000000284, -33.90000000000022, -6.599999999999989, -9.699999999999982, -52.000000000000306, -6.59999999999999, -5.299999999999994, -26.700000000000077, -7.699999999999987, -7.699999999999987, -6.599999999999989, -54.000000000000234, -65.30000000000035, -6.19999999999999, -6.6999999999999895, -28.800000000000093, -15.499999999999964, -9.399999999999979, -46.50000000000026, -15.699999999999967, -7.2999999999999865, -5.599999999999994, -9.599999999999978, -9.399999999999979, -4.599999999999996, -10.699999999999974, -46.900000000000226, -42.00000000000029, -5.299999999999994, -9.199999999999982, -17.899999999999984, -41.000000000000306, -8.89999999999998, -7.499999999999986, -9.699999999999978, -11.099999999999973, -8.199999999999983, -7.899999999999988, -7.899999999999984, -9.49999999999998, -25.80000000000005, -5.799999999999994, -29.800000000000082, -9.499999999999979, -7.099999999999987, -9.29999999999998, -26.100000000000076, -7.099999999999989, -4.999999999999995, -42.30000000000031, -4.899999999999995, -32.600000000000165, -42.800000000000246, -16.49999999999998, -7.899999999999984, -8.499999999999982, -11.799999999999972, -6.799999999999988, -6.599999999999989, -6.199999999999995, -9.399999999999979, -40.3000000000003, -29.200000000000106, -10.099999999999977, -7.999999999999984, -10.499999999999975, -54.40000000000035, -36.60000000000019, -16.099999999999973, -9.399999999999983, -8.299999999999983, -48.10000000000033, -14.79999999999996, -8.099999999999987, -9.19999999999998, -9.699999999999978, -11.099999999999973, -54.60000000000031, -6.499999999999991, -6.099999999999991, -6.39999999999999, -8.89999999999998, -21.300000000000047, -48.00000000000029, -7.7999999999999865, -13.099999999999966, -12.599999999999968, -10.499999999999975, -9.699999999999982, -9.19999999999998, -9.29999999999998, -9.29999999999998, -7.199999999999989, -9.499999999999979, -24.10000000000009, -6.499999999999989, -13.299999999999965, -4.799999999999995], "episode_lengths": [112, 133, 400, 343, 77, 101, 400, 73, 64, 260, 87, 85, 77, 382, 400, 73, 77, 270, 162, 102, 400, 156, 84, 65, 99, 99, 57, 115, 400, 400, 64, 101, 182, 400, 99, 86, 108, 116, 89, 83, 90, 103, 234, 67, 264, 102, 82, 102, 249, 81, 61, 400, 60, 297, 383, 163, 90, 96, 109, 79, 77, 68, 101, 400, 281, 112, 91, 113, 398, 331, 166, 92, 90, 400, 156, 84, 101, 106, 114, 400, 74, 72, 75, 99, 211, 400, 84, 140, 128, 109, 94, 103, 101, 98, 81, 106, 249, 76, 137, 58]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24926995256574414, "mean_inference_ms": 0.7511891002768958, "mean_action_processing_ms": 0.07880377226953865, "mean_env_wait_ms": 6.441364745928549, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007121086120605469, "StateBufferConnector_ms": 0.0038995742797851562, "ViewRequirementAgentConnector_ms": 0.09441375732421875}, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 76000, "num_agent_steps_trained": 76000, "num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 436.8092377312196, "num_env_steps_trained_throughput_per_sec": 436.8092377312196, "timesteps_total": 76000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 76000, "timers": {"training_iteration_time_ms": 9281.885, "sample_time_ms": 5240.96, "load_time_ms": 1.012, "load_throughput": 3953254.318, "learn_time_ms": 4036.993, "learn_throughput": 990.836, "synch_weights_time_ms": 2.216}, "counters": {"num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_agent_steps_sampled": 76000, "num_agent_steps_trained": 76000}, "done": false, "episodes_total": 337, "training_iteration": 19, "trial_id": "b7012_00000", "date": "2024-03-07_12-42-58", "timestamp": 1709833378, "time_this_iter_s": 9.159757137298584, "time_total_s": 173.15007042884827, "pid": 109767, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4d85689f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 173.15007042884827, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 28.981818181818184, "ram_util_percent": 50.04545454545455, "gpu_util_percent0": 0.11818181818181818, "vram_util_percent0": 0.12640565814393942}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.10000000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 3.57677795234617, "policy_loss": -0.01339704253740849, "vf_loss": 3.589228841197747, "vf_explained_var": 0.2753411538498376, "kl": 0.00946172591642937, "entropy": 0.9635499667095881, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 18135.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000}, "sampler_results": {"episode_reward_max": -4.399999999999998, "episode_reward_min": -54.60000000000031, "episode_reward_mean": -15.225000000000028, "episode_len_mean": 147.44, "episode_media": {}, "episodes_this_iter": 31, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-9.199999999999982, -17.899999999999984, -41.000000000000306, -8.89999999999998, -7.499999999999986, -9.699999999999978, -11.099999999999973, -8.199999999999983, -7.899999999999988, -7.899999999999984, -9.49999999999998, -25.80000000000005, -5.799999999999994, -29.800000000000082, -9.499999999999979, -7.099999999999987, -9.29999999999998, -26.100000000000076, -7.099999999999989, -4.999999999999995, -42.30000000000031, -4.899999999999995, -32.600000000000165, -42.800000000000246, -16.49999999999998, -7.899999999999984, -8.499999999999982, -11.799999999999972, -6.799999999999988, -6.599999999999989, -6.199999999999995, -9.399999999999979, -40.3000000000003, -29.200000000000106, -10.099999999999977, -7.999999999999984, -10.499999999999975, -54.40000000000035, -36.60000000000019, -16.099999999999973, -9.399999999999983, -8.299999999999983, -48.10000000000033, -14.79999999999996, -8.099999999999987, -9.19999999999998, -9.699999999999978, -11.099999999999973, -54.60000000000031, -6.499999999999991, -6.099999999999991, -6.39999999999999, -8.89999999999998, -21.300000000000047, -48.00000000000029, -7.7999999999999865, -13.099999999999966, -12.599999999999968, -10.499999999999975, -9.699999999999982, -9.19999999999998, -9.29999999999998, -9.29999999999998, -7.199999999999989, -9.499999999999979, -24.10000000000009, -6.499999999999989, -13.299999999999965, -4.799999999999995, -44.00000000000022, -35.200000000000045, -11.399999999999972, -7.199999999999987, -17.9, -7.599999999999989, -5.5999999999999925, -8.299999999999983, -10.399999999999975, -52.000000000000256, -6.799999999999988, -4.399999999999998, -7.299999999999988, -9.69999999999998, -52.00000000000035, -8.699999999999982, -6.999999999999988, -10.199999999999976, -9.899999999999977, -7.89999999999999, -6.29999999999999, -11.499999999999972, -23.200000000000063, -8.49999999999999, -6.499999999999989, -7.799999999999985, -11.799999999999974, -10.599999999999975, -12.599999999999968, -9.899999999999977, -7.099999999999989], "episode_lengths": [101, 182, 400, 99, 86, 108, 116, 89, 83, 90, 103, 234, 67, 264, 102, 82, 102, 249, 81, 61, 400, 60, 297, 383, 163, 90, 96, 109, 79, 77, 68, 101, 400, 281, 112, 91, 113, 398, 331, 166, 92, 90, 400, 156, 84, 101, 106, 114, 400, 74, 72, 75, 99, 211, 400, 84, 140, 128, 109, 94, 103, 101, 98, 81, 106, 249, 76, 137, 58, 357, 265, 119, 83, 190, 81, 67, 94, 103, 400, 79, 52, 82, 96, 400, 98, 81, 111, 102, 83, 74, 126, 230, 85, 76, 89, 126, 116, 137, 110, 80]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2506336300487761, "mean_inference_ms": 0.7521759498070735, "mean_action_processing_ms": 0.07896896546112629, "mean_env_wait_ms": 6.455001306549196, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007216215133666992, "StateBufferConnector_ms": 0.003926992416381836, "ViewRequirementAgentConnector_ms": 0.09532737731933594}}, "episode_reward_max": -4.399999999999998, "episode_reward_min": -54.60000000000031, "episode_reward_mean": -15.225000000000028, "episode_len_mean": 147.44, "episodes_this_iter": 31, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-9.199999999999982, -17.899999999999984, -41.000000000000306, -8.89999999999998, -7.499999999999986, -9.699999999999978, -11.099999999999973, -8.199999999999983, -7.899999999999988, -7.899999999999984, -9.49999999999998, -25.80000000000005, -5.799999999999994, -29.800000000000082, -9.499999999999979, -7.099999999999987, -9.29999999999998, -26.100000000000076, -7.099999999999989, -4.999999999999995, -42.30000000000031, -4.899999999999995, -32.600000000000165, -42.800000000000246, -16.49999999999998, -7.899999999999984, -8.499999999999982, -11.799999999999972, -6.799999999999988, -6.599999999999989, -6.199999999999995, -9.399999999999979, -40.3000000000003, -29.200000000000106, -10.099999999999977, -7.999999999999984, -10.499999999999975, -54.40000000000035, -36.60000000000019, -16.099999999999973, -9.399999999999983, -8.299999999999983, -48.10000000000033, -14.79999999999996, -8.099999999999987, -9.19999999999998, -9.699999999999978, -11.099999999999973, -54.60000000000031, -6.499999999999991, -6.099999999999991, -6.39999999999999, -8.89999999999998, -21.300000000000047, -48.00000000000029, -7.7999999999999865, -13.099999999999966, -12.599999999999968, -10.499999999999975, -9.699999999999982, -9.19999999999998, -9.29999999999998, -9.29999999999998, -7.199999999999989, -9.499999999999979, -24.10000000000009, -6.499999999999989, -13.299999999999965, -4.799999999999995, -44.00000000000022, -35.200000000000045, -11.399999999999972, -7.199999999999987, -17.9, -7.599999999999989, -5.5999999999999925, -8.299999999999983, -10.399999999999975, -52.000000000000256, -6.799999999999988, -4.399999999999998, -7.299999999999988, -9.69999999999998, -52.00000000000035, -8.699999999999982, -6.999999999999988, -10.199999999999976, -9.899999999999977, -7.89999999999999, -6.29999999999999, -11.499999999999972, -23.200000000000063, -8.49999999999999, -6.499999999999989, -7.799999999999985, -11.799999999999974, -10.599999999999975, -12.599999999999968, -9.899999999999977, -7.099999999999989], "episode_lengths": [101, 182, 400, 99, 86, 108, 116, 89, 83, 90, 103, 234, 67, 264, 102, 82, 102, 249, 81, 61, 400, 60, 297, 383, 163, 90, 96, 109, 79, 77, 68, 101, 400, 281, 112, 91, 113, 398, 331, 166, 92, 90, 400, 156, 84, 101, 106, 114, 400, 74, 72, 75, 99, 211, 400, 84, 140, 128, 109, 94, 103, 101, 98, 81, 106, 249, 76, 137, 58, 357, 265, 119, 83, 190, 81, 67, 94, 103, 400, 79, 52, 82, 96, 400, 98, 81, 111, 102, 83, 74, 126, 230, 85, 76, 89, 126, 116, 137, 110, 80]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2506336300487761, "mean_inference_ms": 0.7521759498070735, "mean_action_processing_ms": 0.07896896546112629, "mean_env_wait_ms": 6.455001306549196, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007216215133666992, "StateBufferConnector_ms": 0.003926992416381836, "ViewRequirementAgentConnector_ms": 0.09532737731933594}, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000, "num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 418.55439703857803, "num_env_steps_trained_throughput_per_sec": 418.55439703857803, "timesteps_total": 80000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 80000, "timers": {"training_iteration_time_ms": 9356.808, "sample_time_ms": 5269.549, "load_time_ms": 1.016, "load_throughput": 3935819.082, "learn_time_ms": 4083.328, "learn_throughput": 979.593, "synch_weights_time_ms": 2.206}, "counters": {"num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000}, "done": false, "episodes_total": 368, "training_iteration": 20, "trial_id": "b7012_00000", "date": "2024-03-07_12-43-07", "timestamp": 1709833387, "time_this_iter_s": 9.559101819992065, "time_total_s": 182.70917224884033, "pid": 109767, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4d85689f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 182.70917224884033, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 29.223076923076924, "ram_util_percent": 49.900000000000006, "gpu_util_percent0": 0.1476923076923077, "vram_util_percent0": 0.12756660657051283}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.10000000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 3.2961489012755294, "policy_loss": -0.009587405461777923, "vf_loss": 3.304925775864432, "vf_explained_var": 0.3024113103907595, "kl": 0.008105213892881154, "entropy": 0.949802129755738, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 19065.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 84000}, "sampler_results": {"episode_reward_max": -4.1999999999999975, "episode_reward_min": -54.60000000000031, "episode_reward_mean": -13.56400000000002, "episode_len_mean": 131.67, "episode_media": {}, "episodes_this_iter": 33, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-29.200000000000106, -10.099999999999977, -7.999999999999984, -10.499999999999975, -54.40000000000035, -36.60000000000019, -16.099999999999973, -9.399999999999983, -8.299999999999983, -48.10000000000033, -14.79999999999996, -8.099999999999987, -9.19999999999998, -9.699999999999978, -11.099999999999973, -54.60000000000031, -6.499999999999991, -6.099999999999991, -6.39999999999999, -8.89999999999998, -21.300000000000047, -48.00000000000029, -7.7999999999999865, -13.099999999999966, -12.599999999999968, -10.499999999999975, -9.699999999999982, -9.19999999999998, -9.29999999999998, -9.29999999999998, -7.199999999999989, -9.499999999999979, -24.10000000000009, -6.499999999999989, -13.299999999999965, -4.799999999999995, -44.00000000000022, -35.200000000000045, -11.399999999999972, -7.199999999999987, -17.9, -7.599999999999989, -5.5999999999999925, -8.299999999999983, -10.399999999999975, -52.000000000000256, -6.799999999999988, -4.399999999999998, -7.299999999999988, -9.69999999999998, -52.00000000000035, -8.699999999999982, -6.999999999999988, -10.199999999999976, -9.899999999999977, -7.89999999999999, -6.29999999999999, -11.499999999999972, -23.200000000000063, -8.49999999999999, -6.499999999999989, -7.799999999999985, -11.799999999999974, -10.599999999999975, -12.599999999999968, -9.899999999999977, -7.099999999999989, -8.599999999999982, -6.69999999999999, -6.999999999999988, -4.899999999999995, -7.099999999999989, -12.799999999999967, -7.999999999999984, -19.700000000000024, -9.999999999999977, -7.499999999999986, -5.799999999999992, -5.599999999999993, -6.999999999999988, -8.99999999999998, -5.099999999999994, -7.799999999999985, -9.099999999999982, -6.799999999999988, -5.699999999999992, -5.8999999999999915, -6.499999999999989, -8.89999999999998, -7.099999999999987, -6.19999999999999, -38.70000000000015, -9.09999999999999, -10.699999999999974, -5.099999999999994, -9.899999999999977, -4.1999999999999975, -51.80000000000039, -10.999999999999973, -5.499999999999993], "episode_lengths": [281, 112, 91, 113, 398, 331, 166, 92, 90, 400, 156, 84, 101, 106, 114, 400, 74, 72, 75, 99, 211, 400, 84, 140, 128, 109, 94, 103, 101, 98, 81, 106, 249, 76, 137, 58, 357, 265, 119, 83, 190, 81, 67, 94, 103, 400, 79, 52, 82, 96, 400, 98, 81, 111, 102, 83, 74, 126, 230, 85, 76, 89, 126, 116, 137, 110, 80, 95, 76, 77, 60, 80, 129, 90, 195, 111, 86, 69, 66, 81, 95, 62, 89, 94, 79, 68, 70, 76, 100, 82, 73, 340, 87, 111, 62, 105, 53, 400, 118, 66]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.25215984626998333, "mean_inference_ms": 0.7535821499364732, "mean_action_processing_ms": 0.07896969556881527, "mean_env_wait_ms": 6.4667654096112495, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007281303405761719, "StateBufferConnector_ms": 0.003988742828369141, "ViewRequirementAgentConnector_ms": 0.09679603576660156}}, "episode_reward_max": -4.1999999999999975, "episode_reward_min": -54.60000000000031, "episode_reward_mean": -13.56400000000002, "episode_len_mean": 131.67, "episodes_this_iter": 33, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-29.200000000000106, -10.099999999999977, -7.999999999999984, -10.499999999999975, -54.40000000000035, -36.60000000000019, -16.099999999999973, -9.399999999999983, -8.299999999999983, -48.10000000000033, -14.79999999999996, -8.099999999999987, -9.19999999999998, -9.699999999999978, -11.099999999999973, -54.60000000000031, -6.499999999999991, -6.099999999999991, -6.39999999999999, -8.89999999999998, -21.300000000000047, -48.00000000000029, -7.7999999999999865, -13.099999999999966, -12.599999999999968, -10.499999999999975, -9.699999999999982, -9.19999999999998, -9.29999999999998, -9.29999999999998, -7.199999999999989, -9.499999999999979, -24.10000000000009, -6.499999999999989, -13.299999999999965, -4.799999999999995, -44.00000000000022, -35.200000000000045, -11.399999999999972, -7.199999999999987, -17.9, -7.599999999999989, -5.5999999999999925, -8.299999999999983, -10.399999999999975, -52.000000000000256, -6.799999999999988, -4.399999999999998, -7.299999999999988, -9.69999999999998, -52.00000000000035, -8.699999999999982, -6.999999999999988, -10.199999999999976, -9.899999999999977, -7.89999999999999, -6.29999999999999, -11.499999999999972, -23.200000000000063, -8.49999999999999, -6.499999999999989, -7.799999999999985, -11.799999999999974, -10.599999999999975, -12.599999999999968, -9.899999999999977, -7.099999999999989, -8.599999999999982, -6.69999999999999, -6.999999999999988, -4.899999999999995, -7.099999999999989, -12.799999999999967, -7.999999999999984, -19.700000000000024, -9.999999999999977, -7.499999999999986, -5.799999999999992, -5.599999999999993, -6.999999999999988, -8.99999999999998, -5.099999999999994, -7.799999999999985, -9.099999999999982, -6.799999999999988, -5.699999999999992, -5.8999999999999915, -6.499999999999989, -8.89999999999998, -7.099999999999987, -6.19999999999999, -38.70000000000015, -9.09999999999999, -10.699999999999974, -5.099999999999994, -9.899999999999977, -4.1999999999999975, -51.80000000000039, -10.999999999999973, -5.499999999999993], "episode_lengths": [281, 112, 91, 113, 398, 331, 166, 92, 90, 400, 156, 84, 101, 106, 114, 400, 74, 72, 75, 99, 211, 400, 84, 140, 128, 109, 94, 103, 101, 98, 81, 106, 249, 76, 137, 58, 357, 265, 119, 83, 190, 81, 67, 94, 103, 400, 79, 52, 82, 96, 400, 98, 81, 111, 102, 83, 74, 126, 230, 85, 76, 89, 126, 116, 137, 110, 80, 95, 76, 77, 60, 80, 129, 90, 195, 111, 86, 69, 66, 81, 95, 62, 89, 94, 79, 68, 70, 76, 100, 82, 73, 340, 87, 111, 62, 105, 53, 400, 118, 66]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.25215984626998333, "mean_inference_ms": 0.7535821499364732, "mean_action_processing_ms": 0.07896969556881527, "mean_env_wait_ms": 6.4667654096112495, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007281303405761719, "StateBufferConnector_ms": 0.003988742828369141, "ViewRequirementAgentConnector_ms": 0.09679603576660156}, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 84000, "num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 406.34185458312567, "num_env_steps_trained_throughput_per_sec": 406.34185458312567, "timesteps_total": 84000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 84000, "timers": {"training_iteration_time_ms": 9391.464, "sample_time_ms": 5286.658, "load_time_ms": 1.012, "load_throughput": 3951671.377, "learn_time_ms": 4100.917, "learn_throughput": 975.392, "synch_weights_time_ms": 2.172}, "counters": {"num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 84000}, "done": false, "episodes_total": 401, "training_iteration": 21, "trial_id": "b7012_00000", "date": "2024-03-07_12-43-17", "timestamp": 1709833397, "time_this_iter_s": 9.846385955810547, "time_total_s": 192.55555820465088, "pid": 109767, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4d85689f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 192.55555820465088, "iterations_since_restore": 21, "perf": {"cpu_util_percent": 34.625, "ram_util_percent": 50.258333333333326, "gpu_util_percent0": 0.16416666666666668, "vram_util_percent0": 0.13358561197916666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.10000000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 3.7230154669797297, "policy_loss": -0.00831936145181297, "vf_loss": 3.7304106365929366, "vf_explained_var": 0.008032502538414412, "kl": 0.009241763145532591, "entropy": 0.9546101905966318, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 19995.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_agent_steps_sampled": 88000, "num_agent_steps_trained": 88000}, "sampler_results": {"episode_reward_max": -4.1999999999999975, "episode_reward_min": -69.00000000000043, "episode_reward_mean": -12.902000000000017, "episode_len_mean": 124.17, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-24.10000000000009, -6.499999999999989, -13.299999999999965, -4.799999999999995, -44.00000000000022, -35.200000000000045, -11.399999999999972, -7.199999999999987, -17.9, -7.599999999999989, -5.5999999999999925, -8.299999999999983, -10.399999999999975, -52.000000000000256, -6.799999999999988, -4.399999999999998, -7.299999999999988, -9.69999999999998, -52.00000000000035, -8.699999999999982, -6.999999999999988, -10.199999999999976, -9.899999999999977, -7.89999999999999, -6.29999999999999, -11.499999999999972, -23.200000000000063, -8.49999999999999, -6.499999999999989, -7.799999999999985, -11.799999999999974, -10.599999999999975, -12.599999999999968, -9.899999999999977, -7.099999999999989, -8.599999999999982, -6.69999999999999, -6.999999999999988, -4.899999999999995, -7.099999999999989, -12.799999999999967, -7.999999999999984, -19.700000000000024, -9.999999999999977, -7.499999999999986, -5.799999999999992, -5.599999999999993, -6.999999999999988, -8.99999999999998, -5.099999999999994, -7.799999999999985, -9.099999999999982, -6.799999999999988, -5.699999999999992, -5.8999999999999915, -6.499999999999989, -8.89999999999998, -7.099999999999987, -6.19999999999999, -38.70000000000015, -9.09999999999999, -10.699999999999974, -5.099999999999994, -9.899999999999977, -4.1999999999999975, -51.80000000000039, -10.999999999999973, -5.499999999999993, -8.599999999999982, -6.999999999999988, -16.799999999999972, -5.399999999999993, -10.999999999999973, -5.199999999999994, -12.199999999999969, -6.69999999999999, -23.40000000000004, -58.4000000000004, -7.099999999999987, -11.599999999999971, -5.499999999999993, -8.89999999999998, -4.599999999999996, -7.799999999999985, -9.599999999999978, -4.999999999999995, -43.10000000000027, -7.499999999999986, -7.3999999999999915, -69.00000000000043, -10.599999999999977, -7.099999999999996, -8.699999999999982, -8.599999999999982, -8.199999999999983, -9.399999999999979, -9.499999999999984, -48.400000000000304, -6.099999999999991, -8.999999999999982], "episode_lengths": [249, 76, 137, 58, 357, 265, 119, 83, 190, 81, 67, 94, 103, 400, 79, 52, 82, 96, 400, 98, 81, 111, 102, 83, 74, 126, 230, 85, 76, 89, 126, 116, 137, 110, 80, 95, 76, 77, 60, 80, 129, 90, 195, 111, 86, 69, 66, 81, 95, 62, 89, 94, 79, 68, 70, 76, 100, 82, 73, 340, 87, 111, 62, 105, 53, 400, 118, 66, 97, 81, 148, 65, 121, 63, 127, 76, 216, 400, 82, 125, 66, 99, 57, 88, 105, 61, 400, 86, 78, 400, 102, 73, 94, 97, 92, 104, 89, 400, 72, 96]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2539189103762154, "mean_inference_ms": 0.7543166893356391, "mean_action_processing_ms": 0.07908993795430835, "mean_env_wait_ms": 6.476156594211832, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0073010921478271484, "StateBufferConnector_ms": 0.0039937496185302734, "ViewRequirementAgentConnector_ms": 0.09699678421020508}}, "episode_reward_max": -4.1999999999999975, "episode_reward_min": -69.00000000000043, "episode_reward_mean": -12.902000000000017, "episode_len_mean": 124.17, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-24.10000000000009, -6.499999999999989, -13.299999999999965, -4.799999999999995, -44.00000000000022, -35.200000000000045, -11.399999999999972, -7.199999999999987, -17.9, -7.599999999999989, -5.5999999999999925, -8.299999999999983, -10.399999999999975, -52.000000000000256, -6.799999999999988, -4.399999999999998, -7.299999999999988, -9.69999999999998, -52.00000000000035, -8.699999999999982, -6.999999999999988, -10.199999999999976, -9.899999999999977, -7.89999999999999, -6.29999999999999, -11.499999999999972, -23.200000000000063, -8.49999999999999, -6.499999999999989, -7.799999999999985, -11.799999999999974, -10.599999999999975, -12.599999999999968, -9.899999999999977, -7.099999999999989, -8.599999999999982, -6.69999999999999, -6.999999999999988, -4.899999999999995, -7.099999999999989, -12.799999999999967, -7.999999999999984, -19.700000000000024, -9.999999999999977, -7.499999999999986, -5.799999999999992, -5.599999999999993, -6.999999999999988, -8.99999999999998, -5.099999999999994, -7.799999999999985, -9.099999999999982, -6.799999999999988, -5.699999999999992, -5.8999999999999915, -6.499999999999989, -8.89999999999998, -7.099999999999987, -6.19999999999999, -38.70000000000015, -9.09999999999999, -10.699999999999974, -5.099999999999994, -9.899999999999977, -4.1999999999999975, -51.80000000000039, -10.999999999999973, -5.499999999999993, -8.599999999999982, -6.999999999999988, -16.799999999999972, -5.399999999999993, -10.999999999999973, -5.199999999999994, -12.199999999999969, -6.69999999999999, -23.40000000000004, -58.4000000000004, -7.099999999999987, -11.599999999999971, -5.499999999999993, -8.89999999999998, -4.599999999999996, -7.799999999999985, -9.599999999999978, -4.999999999999995, -43.10000000000027, -7.499999999999986, -7.3999999999999915, -69.00000000000043, -10.599999999999977, -7.099999999999996, -8.699999999999982, -8.599999999999982, -8.199999999999983, -9.399999999999979, -9.499999999999984, -48.400000000000304, -6.099999999999991, -8.999999999999982], "episode_lengths": [249, 76, 137, 58, 357, 265, 119, 83, 190, 81, 67, 94, 103, 400, 79, 52, 82, 96, 400, 98, 81, 111, 102, 83, 74, 126, 230, 85, 76, 89, 126, 116, 137, 110, 80, 95, 76, 77, 60, 80, 129, 90, 195, 111, 86, 69, 66, 81, 95, 62, 89, 94, 79, 68, 70, 76, 100, 82, 73, 340, 87, 111, 62, 105, 53, 400, 118, 66, 97, 81, 148, 65, 121, 63, 127, 76, 216, 400, 82, 125, 66, 99, 57, 88, 105, 61, 400, 86, 78, 400, 102, 73, 94, 97, 92, 104, 89, 400, 72, 96]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2539189103762154, "mean_inference_ms": 0.7543166893356391, "mean_action_processing_ms": 0.07908993795430835, "mean_env_wait_ms": 6.476156594211832, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0073010921478271484, "StateBufferConnector_ms": 0.0039937496185302734, "ViewRequirementAgentConnector_ms": 0.09699678421020508}, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 88000, "num_agent_steps_trained": 88000, "num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 442.63163425426103, "num_env_steps_trained_throughput_per_sec": 442.63163425426103, "timesteps_total": 88000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 88000, "timers": {"training_iteration_time_ms": 9300.844, "sample_time_ms": 5271.425, "load_time_ms": 1.011, "load_throughput": 3956424.007, "learn_time_ms": 4025.514, "learn_throughput": 993.662, "synch_weights_time_ms": 2.187}, "counters": {"num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_agent_steps_sampled": 88000, "num_agent_steps_trained": 88000}, "done": false, "episodes_total": 433, "training_iteration": 22, "trial_id": "b7012_00000", "date": "2024-03-07_12-43-26", "timestamp": 1709833406, "time_this_iter_s": 9.039329528808594, "time_total_s": 201.59488773345947, "pid": 109767, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4d85689f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 201.59488773345947, "iterations_since_restore": 22, "perf": {"cpu_util_percent": 28.59166666666667, "ram_util_percent": 49.775, "gpu_util_percent0": 0.13166666666666665, "vram_util_percent0": 0.13647460937500003}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.10000000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 2.5307104475615967, "policy_loss": -0.006677742337467529, "vf_loss": 2.536725043417305, "vf_explained_var": 0.3849706113979381, "kl": 0.006631516213242468, "entropy": 0.9491700767188944, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 20925.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_agent_steps_sampled": 92000, "num_agent_steps_trained": 92000}, "sampler_results": {"episode_reward_max": -3.5, "episode_reward_min": -69.00000000000043, "episode_reward_mean": -12.041000000000018, "episode_len_mean": 118.03, "episode_media": {}, "episodes_this_iter": 37, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-6.999999999999988, -4.899999999999995, -7.099999999999989, -12.799999999999967, -7.999999999999984, -19.700000000000024, -9.999999999999977, -7.499999999999986, -5.799999999999992, -5.599999999999993, -6.999999999999988, -8.99999999999998, -5.099999999999994, -7.799999999999985, -9.099999999999982, -6.799999999999988, -5.699999999999992, -5.8999999999999915, -6.499999999999989, -8.89999999999998, -7.099999999999987, -6.19999999999999, -38.70000000000015, -9.09999999999999, -10.699999999999974, -5.099999999999994, -9.899999999999977, -4.1999999999999975, -51.80000000000039, -10.999999999999973, -5.499999999999993, -8.599999999999982, -6.999999999999988, -16.799999999999972, -5.399999999999993, -10.999999999999973, -5.199999999999994, -12.199999999999969, -6.69999999999999, -23.40000000000004, -58.4000000000004, -7.099999999999987, -11.599999999999971, -5.499999999999993, -8.89999999999998, -4.599999999999996, -7.799999999999985, -9.599999999999978, -4.999999999999995, -43.10000000000027, -7.499999999999986, -7.3999999999999915, -69.00000000000043, -10.599999999999977, -7.099999999999996, -8.699999999999982, -8.599999999999982, -8.199999999999983, -9.399999999999979, -9.499999999999984, -48.400000000000304, -6.099999999999991, -8.999999999999982, -21.50000000000004, -8.099999999999984, -5.399999999999993, -5.099999999999994, -8.699999999999982, -5.799999999999992, -8.099999999999987, -3.5, -6.599999999999989, -6.899999999999991, -10.899999999999974, -6.899999999999991, -6.499999999999989, -10.299999999999976, -9.999999999999977, -32.600000000000065, -8.299999999999983, -10.199999999999976, -5.999999999999991, -48.60000000000018, -8.899999999999988, -27.600000000000048, -7.2999999999999865, -7.399999999999986, -6.199999999999991, -20.500000000000043, -10.999999999999973, -6.099999999999991, -8.999999999999982, -7.29999999999999, -10.199999999999976, -21.50000000000004, -4.599999999999996, -20.600000000000037, -4.699999999999998, -7.399999999999988, -6.899999999999988], "episode_lengths": [77, 60, 80, 129, 90, 195, 111, 86, 69, 66, 81, 95, 62, 89, 94, 79, 68, 70, 76, 100, 82, 73, 340, 87, 111, 62, 105, 53, 400, 118, 66, 97, 81, 148, 65, 121, 63, 127, 76, 216, 400, 82, 125, 66, 99, 57, 88, 105, 61, 400, 86, 78, 400, 102, 73, 94, 97, 92, 104, 89, 400, 72, 96, 222, 89, 65, 62, 98, 69, 87, 46, 77, 71, 112, 77, 76, 109, 103, 282, 94, 112, 71, 400, 86, 244, 84, 85, 72, 199, 119, 72, 97, 79, 105, 219, 57, 210, 55, 84, 80]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.25534097239769343, "mean_inference_ms": 0.7550089561916263, "mean_action_processing_ms": 0.0791323773636248, "mean_env_wait_ms": 6.480725093268948, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007245540618896484, "StateBufferConnector_ms": 0.0039310455322265625, "ViewRequirementAgentConnector_ms": 0.09596514701843262}}, "episode_reward_max": -3.5, "episode_reward_min": -69.00000000000043, "episode_reward_mean": -12.041000000000018, "episode_len_mean": 118.03, "episodes_this_iter": 37, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-6.999999999999988, -4.899999999999995, -7.099999999999989, -12.799999999999967, -7.999999999999984, -19.700000000000024, -9.999999999999977, -7.499999999999986, -5.799999999999992, -5.599999999999993, -6.999999999999988, -8.99999999999998, -5.099999999999994, -7.799999999999985, -9.099999999999982, -6.799999999999988, -5.699999999999992, -5.8999999999999915, -6.499999999999989, -8.89999999999998, -7.099999999999987, -6.19999999999999, -38.70000000000015, -9.09999999999999, -10.699999999999974, -5.099999999999994, -9.899999999999977, -4.1999999999999975, -51.80000000000039, -10.999999999999973, -5.499999999999993, -8.599999999999982, -6.999999999999988, -16.799999999999972, -5.399999999999993, -10.999999999999973, -5.199999999999994, -12.199999999999969, -6.69999999999999, -23.40000000000004, -58.4000000000004, -7.099999999999987, -11.599999999999971, -5.499999999999993, -8.89999999999998, -4.599999999999996, -7.799999999999985, -9.599999999999978, -4.999999999999995, -43.10000000000027, -7.499999999999986, -7.3999999999999915, -69.00000000000043, -10.599999999999977, -7.099999999999996, -8.699999999999982, -8.599999999999982, -8.199999999999983, -9.399999999999979, -9.499999999999984, -48.400000000000304, -6.099999999999991, -8.999999999999982, -21.50000000000004, -8.099999999999984, -5.399999999999993, -5.099999999999994, -8.699999999999982, -5.799999999999992, -8.099999999999987, -3.5, -6.599999999999989, -6.899999999999991, -10.899999999999974, -6.899999999999991, -6.499999999999989, -10.299999999999976, -9.999999999999977, -32.600000000000065, -8.299999999999983, -10.199999999999976, -5.999999999999991, -48.60000000000018, -8.899999999999988, -27.600000000000048, -7.2999999999999865, -7.399999999999986, -6.199999999999991, -20.500000000000043, -10.999999999999973, -6.099999999999991, -8.999999999999982, -7.29999999999999, -10.199999999999976, -21.50000000000004, -4.599999999999996, -20.600000000000037, -4.699999999999998, -7.399999999999988, -6.899999999999988], "episode_lengths": [77, 60, 80, 129, 90, 195, 111, 86, 69, 66, 81, 95, 62, 89, 94, 79, 68, 70, 76, 100, 82, 73, 340, 87, 111, 62, 105, 53, 400, 118, 66, 97, 81, 148, 65, 121, 63, 127, 76, 216, 400, 82, 125, 66, 99, 57, 88, 105, 61, 400, 86, 78, 400, 102, 73, 94, 97, 92, 104, 89, 400, 72, 96, 222, 89, 65, 62, 98, 69, 87, 46, 77, 71, 112, 77, 76, 109, 103, 282, 94, 112, 71, 400, 86, 244, 84, 85, 72, 199, 119, 72, 97, 79, 105, 219, 57, 210, 55, 84, 80]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.25534097239769343, "mean_inference_ms": 0.7550089561916263, "mean_action_processing_ms": 0.0791323773636248, "mean_env_wait_ms": 6.480725093268948, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007245540618896484, "StateBufferConnector_ms": 0.0039310455322265625, "ViewRequirementAgentConnector_ms": 0.09596514701843262}, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 92000, "num_agent_steps_trained": 92000, "num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 420.3187331345115, "num_env_steps_trained_throughput_per_sec": 420.3187331345115, "timesteps_total": 92000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 92000, "timers": {"training_iteration_time_ms": 9313.546, "sample_time_ms": 5279.101, "load_time_ms": 1.012, "load_throughput": 3952509.247, "learn_time_ms": 4030.563, "learn_throughput": 992.417, "synch_weights_time_ms": 2.165}, "counters": {"num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_agent_steps_sampled": 92000, "num_agent_steps_trained": 92000}, "done": false, "episodes_total": 470, "training_iteration": 23, "trial_id": "b7012_00000", "date": "2024-03-07_12-43-36", "timestamp": 1709833416, "time_this_iter_s": 9.519394397735596, "time_total_s": 211.11428213119507, "pid": 109767, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4d85689f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 211.11428213119507, "iterations_since_restore": 23, "perf": {"cpu_util_percent": 29.125000000000004, "ram_util_percent": 49.73333333333333, "gpu_util_percent0": 0.1475, "vram_util_percent0": 0.13723415798611108}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.10000000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 2.884505649944874, "policy_loss": -0.00806790345138119, "vf_loss": 2.891733323005579, "vf_explained_var": 0.36888126128463333, "kl": 0.008402245056671203, "entropy": 0.9475555574381224, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 21855.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000}, "sampler_results": {"episode_reward_max": -3.5, "episode_reward_min": -69.00000000000043, "episode_reward_mean": -11.999000000000013, "episode_len_mean": 119.19, "episode_media": {}, "episodes_this_iter": 34, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-5.399999999999993, -10.999999999999973, -5.199999999999994, -12.199999999999969, -6.69999999999999, -23.40000000000004, -58.4000000000004, -7.099999999999987, -11.599999999999971, -5.499999999999993, -8.89999999999998, -4.599999999999996, -7.799999999999985, -9.599999999999978, -4.999999999999995, -43.10000000000027, -7.499999999999986, -7.3999999999999915, -69.00000000000043, -10.599999999999977, -7.099999999999996, -8.699999999999982, -8.599999999999982, -8.199999999999983, -9.399999999999979, -9.499999999999984, -48.400000000000304, -6.099999999999991, -8.999999999999982, -21.50000000000004, -8.099999999999984, -5.399999999999993, -5.099999999999994, -8.699999999999982, -5.799999999999992, -8.099999999999987, -3.5, -6.599999999999989, -6.899999999999991, -10.899999999999974, -6.899999999999991, -6.499999999999989, -10.299999999999976, -9.999999999999977, -32.600000000000065, -8.299999999999983, -10.199999999999976, -5.999999999999991, -48.60000000000018, -8.899999999999988, -27.600000000000048, -7.2999999999999865, -7.399999999999986, -6.199999999999991, -20.500000000000043, -10.999999999999973, -6.099999999999991, -8.999999999999982, -7.29999999999999, -10.199999999999976, -21.50000000000004, -4.599999999999996, -20.600000000000037, -4.699999999999998, -7.399999999999988, -6.899999999999988, -19.500000000000007, -4.299999999999997, -14.69999999999996, -8.599999999999985, -7.199999999999987, -5.199999999999994, -12.499999999999968, -5.799999999999992, -8.199999999999983, -5.199999999999994, -23.400000000000077, -9.999999999999977, -8.599999999999982, -6.59999999999999, -6.099999999999991, -7.099999999999991, -7.899999999999984, -8.199999999999983, -6.999999999999988, -6.999999999999991, -8.89999999999998, -7.499999999999986, -6.699999999999989, -18.400000000000006, -7.799999999999985, -46.70000000000027, -9.599999999999978, -8.499999999999982, -4.799999999999995, -6.599999999999989, -6.999999999999988, -12.699999999999967, -11.69999999999997, -7.69999999999999], "episode_lengths": [65, 121, 63, 127, 76, 216, 400, 82, 125, 66, 99, 57, 88, 105, 61, 400, 86, 78, 400, 102, 73, 94, 97, 92, 104, 89, 400, 72, 96, 222, 89, 65, 62, 98, 69, 87, 46, 77, 71, 112, 77, 76, 109, 103, 282, 94, 112, 71, 400, 86, 244, 84, 85, 72, 199, 119, 72, 97, 79, 105, 219, 57, 210, 55, 84, 80, 197, 54, 146, 90, 83, 63, 130, 69, 93, 63, 241, 111, 97, 76, 72, 78, 90, 93, 81, 77, 99, 86, 78, 194, 89, 400, 104, 96, 59, 77, 81, 138, 128, 83]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.25678158164850473, "mean_inference_ms": 0.7559157573878527, "mean_action_processing_ms": 0.07937109211961454, "mean_env_wait_ms": 6.497028094284542, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007244586944580078, "StateBufferConnector_ms": 0.003925800323486328, "ViewRequirementAgentConnector_ms": 0.09566712379455566}}, "episode_reward_max": -3.5, "episode_reward_min": -69.00000000000043, "episode_reward_mean": -11.999000000000013, "episode_len_mean": 119.19, "episodes_this_iter": 34, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-5.399999999999993, -10.999999999999973, -5.199999999999994, -12.199999999999969, -6.69999999999999, -23.40000000000004, -58.4000000000004, -7.099999999999987, -11.599999999999971, -5.499999999999993, -8.89999999999998, -4.599999999999996, -7.799999999999985, -9.599999999999978, -4.999999999999995, -43.10000000000027, -7.499999999999986, -7.3999999999999915, -69.00000000000043, -10.599999999999977, -7.099999999999996, -8.699999999999982, -8.599999999999982, -8.199999999999983, -9.399999999999979, -9.499999999999984, -48.400000000000304, -6.099999999999991, -8.999999999999982, -21.50000000000004, -8.099999999999984, -5.399999999999993, -5.099999999999994, -8.699999999999982, -5.799999999999992, -8.099999999999987, -3.5, -6.599999999999989, -6.899999999999991, -10.899999999999974, -6.899999999999991, -6.499999999999989, -10.299999999999976, -9.999999999999977, -32.600000000000065, -8.299999999999983, -10.199999999999976, -5.999999999999991, -48.60000000000018, -8.899999999999988, -27.600000000000048, -7.2999999999999865, -7.399999999999986, -6.199999999999991, -20.500000000000043, -10.999999999999973, -6.099999999999991, -8.999999999999982, -7.29999999999999, -10.199999999999976, -21.50000000000004, -4.599999999999996, -20.600000000000037, -4.699999999999998, -7.399999999999988, -6.899999999999988, -19.500000000000007, -4.299999999999997, -14.69999999999996, -8.599999999999985, -7.199999999999987, -5.199999999999994, -12.499999999999968, -5.799999999999992, -8.199999999999983, -5.199999999999994, -23.400000000000077, -9.999999999999977, -8.599999999999982, -6.59999999999999, -6.099999999999991, -7.099999999999991, -7.899999999999984, -8.199999999999983, -6.999999999999988, -6.999999999999991, -8.89999999999998, -7.499999999999986, -6.699999999999989, -18.400000000000006, -7.799999999999985, -46.70000000000027, -9.599999999999978, -8.499999999999982, -4.799999999999995, -6.599999999999989, -6.999999999999988, -12.699999999999967, -11.69999999999997, -7.69999999999999], "episode_lengths": [65, 121, 63, 127, 76, 216, 400, 82, 125, 66, 99, 57, 88, 105, 61, 400, 86, 78, 400, 102, 73, 94, 97, 92, 104, 89, 400, 72, 96, 222, 89, 65, 62, 98, 69, 87, 46, 77, 71, 112, 77, 76, 109, 103, 282, 94, 112, 71, 400, 86, 244, 84, 85, 72, 199, 119, 72, 97, 79, 105, 219, 57, 210, 55, 84, 80, 197, 54, 146, 90, 83, 63, 130, 69, 93, 63, 241, 111, 97, 76, 72, 78, 90, 93, 81, 77, 99, 86, 78, 194, 89, 400, 104, 96, 59, 77, 81, 138, 128, 83]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.25678158164850473, "mean_inference_ms": 0.7559157573878527, "mean_action_processing_ms": 0.07937109211961454, "mean_env_wait_ms": 6.497028094284542, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007244586944580078, "StateBufferConnector_ms": 0.003925800323486328, "ViewRequirementAgentConnector_ms": 0.09566712379455566}, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000, "num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 406.9502925968164, "num_env_steps_trained_throughput_per_sec": 406.9502925968164, "timesteps_total": 96000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 96000, "timers": {"training_iteration_time_ms": 9360.416, "sample_time_ms": 5335.911, "load_time_ms": 1.155, "load_throughput": 3463004.108, "learn_time_ms": 4020.543, "learn_throughput": 994.89, "synch_weights_time_ms": 2.133}, "counters": {"num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000}, "done": false, "episodes_total": 504, "training_iteration": 24, "trial_id": "b7012_00000", "date": "2024-03-07_12-43-46", "timestamp": 1709833426, "time_this_iter_s": 9.831748962402344, "time_total_s": 220.9460310935974, "pid": 109767, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4d85689f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 220.9460310935974, "iterations_since_restore": 24, "perf": {"cpu_util_percent": 34.02307692307692, "ram_util_percent": 50.69999999999998, "gpu_util_percent0": 0.18, "vram_util_percent0": 0.1340582431891026}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.10000000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 1.478174236474899, "policy_loss": -0.009530913495328478, "vf_loss": 1.4868260863327212, "vf_explained_var": 0.6247775435447693, "kl": 0.008790690116743903, "entropy": 0.9269296153899163, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 22785.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_agent_steps_sampled": 100000, "num_agent_steps_trained": 100000}, "sampler_results": {"episode_reward_max": -3.5, "episode_reward_min": -57.10000000000028, "episode_reward_mean": -10.386, "episode_len_mean": 108.11, "episode_media": {}, "episodes_this_iter": 45, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8.299999999999983, -10.199999999999976, -5.999999999999991, -48.60000000000018, -8.899999999999988, -27.600000000000048, -7.2999999999999865, -7.399999999999986, -6.199999999999991, -20.500000000000043, -10.999999999999973, -6.099999999999991, -8.999999999999982, -7.29999999999999, -10.199999999999976, -21.50000000000004, -4.599999999999996, -20.600000000000037, -4.699999999999998, -7.399999999999988, -6.899999999999988, -19.500000000000007, -4.299999999999997, -14.69999999999996, -8.599999999999985, -7.199999999999987, -5.199999999999994, -12.499999999999968, -5.799999999999992, -8.199999999999983, -5.199999999999994, -23.400000000000077, -9.999999999999977, -8.599999999999982, -6.59999999999999, -6.099999999999991, -7.099999999999991, -7.899999999999984, -8.199999999999983, -6.999999999999988, -6.999999999999991, -8.89999999999998, -7.499999999999986, -6.699999999999989, -18.400000000000006, -7.799999999999985, -46.70000000000027, -9.599999999999978, -8.499999999999982, -4.799999999999995, -6.599999999999989, -6.999999999999988, -12.699999999999967, -11.69999999999997, -7.69999999999999, -13.599999999999964, -17.19999999999998, -5.999999999999991, -11.599999999999971, -8.199999999999983, -6.7999999999999945, -4.599999999999996, -5.099999999999994, -57.10000000000028, -6.39999999999999, -8.599999999999982, -6.29999999999999, -5.5999999999999925, -11.299999999999972, -7.7999999999999865, -6.599999999999989, -8.999999999999982, -10.999999999999973, -8.89999999999998, -4.899999999999995, -6.39999999999999, -7.19999999999999, -8.599999999999985, -9.599999999999978, -9.699999999999978, -6.39999999999999, -9.999999999999977, -7.199999999999992, -6.39999999999999, -7.599999999999985, -22.900000000000052, -19.299999999999983, -5.899999999999992, -7.499999999999986, -8.299999999999988, -7.999999999999984, -7.499999999999986, -3.5, -9.399999999999979, -8.89999999999998, -8.499999999999982, -6.799999999999988, -3.6999999999999993, -7.699999999999994, -6.999999999999988], "episode_lengths": [94, 112, 71, 400, 86, 244, 84, 85, 72, 199, 119, 72, 97, 79, 105, 219, 57, 210, 55, 84, 80, 197, 54, 146, 90, 83, 63, 130, 69, 93, 63, 241, 111, 97, 76, 72, 78, 90, 93, 81, 77, 99, 86, 78, 194, 89, 400, 104, 96, 59, 77, 81, 138, 128, 83, 128, 181, 71, 124, 93, 72, 57, 62, 400, 73, 96, 74, 67, 124, 86, 77, 96, 121, 100, 60, 75, 79, 91, 107, 105, 75, 111, 76, 75, 87, 221, 177, 60, 86, 84, 91, 86, 46, 98, 100, 95, 79, 48, 76, 81]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2588446197132443, "mean_inference_ms": 0.7574857980910042, "mean_action_processing_ms": 0.0796571890130615, "mean_env_wait_ms": 6.519696680970048, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007406949996948242, "StateBufferConnector_ms": 0.004021167755126953, "ViewRequirementAgentConnector_ms": 0.09755754470825195}}, "episode_reward_max": -3.5, "episode_reward_min": -57.10000000000028, "episode_reward_mean": -10.386, "episode_len_mean": 108.11, "episodes_this_iter": 45, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-8.299999999999983, -10.199999999999976, -5.999999999999991, -48.60000000000018, -8.899999999999988, -27.600000000000048, -7.2999999999999865, -7.399999999999986, -6.199999999999991, -20.500000000000043, -10.999999999999973, -6.099999999999991, -8.999999999999982, -7.29999999999999, -10.199999999999976, -21.50000000000004, -4.599999999999996, -20.600000000000037, -4.699999999999998, -7.399999999999988, -6.899999999999988, -19.500000000000007, -4.299999999999997, -14.69999999999996, -8.599999999999985, -7.199999999999987, -5.199999999999994, -12.499999999999968, -5.799999999999992, -8.199999999999983, -5.199999999999994, -23.400000000000077, -9.999999999999977, -8.599999999999982, -6.59999999999999, -6.099999999999991, -7.099999999999991, -7.899999999999984, -8.199999999999983, -6.999999999999988, -6.999999999999991, -8.89999999999998, -7.499999999999986, -6.699999999999989, -18.400000000000006, -7.799999999999985, -46.70000000000027, -9.599999999999978, -8.499999999999982, -4.799999999999995, -6.599999999999989, -6.999999999999988, -12.699999999999967, -11.69999999999997, -7.69999999999999, -13.599999999999964, -17.19999999999998, -5.999999999999991, -11.599999999999971, -8.199999999999983, -6.7999999999999945, -4.599999999999996, -5.099999999999994, -57.10000000000028, -6.39999999999999, -8.599999999999982, -6.29999999999999, -5.5999999999999925, -11.299999999999972, -7.7999999999999865, -6.599999999999989, -8.999999999999982, -10.999999999999973, -8.89999999999998, -4.899999999999995, -6.39999999999999, -7.19999999999999, -8.599999999999985, -9.599999999999978, -9.699999999999978, -6.39999999999999, -9.999999999999977, -7.199999999999992, -6.39999999999999, -7.599999999999985, -22.900000000000052, -19.299999999999983, -5.899999999999992, -7.499999999999986, -8.299999999999988, -7.999999999999984, -7.499999999999986, -3.5, -9.399999999999979, -8.89999999999998, -8.499999999999982, -6.799999999999988, -3.6999999999999993, -7.699999999999994, -6.999999999999988], "episode_lengths": [94, 112, 71, 400, 86, 244, 84, 85, 72, 199, 119, 72, 97, 79, 105, 219, 57, 210, 55, 84, 80, 197, 54, 146, 90, 83, 63, 130, 69, 93, 63, 241, 111, 97, 76, 72, 78, 90, 93, 81, 77, 99, 86, 78, 194, 89, 400, 104, 96, 59, 77, 81, 138, 128, 83, 128, 181, 71, 124, 93, 72, 57, 62, 400, 73, 96, 74, 67, 124, 86, 77, 96, 121, 100, 60, 75, 79, 91, 107, 105, 75, 111, 76, 75, 87, 221, 177, 60, 86, 84, 91, 86, 46, 98, 100, 95, 79, 48, 76, 81]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2588446197132443, "mean_inference_ms": 0.7574857980910042, "mean_action_processing_ms": 0.0796571890130615, "mean_env_wait_ms": 6.519696680970048, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007406949996948242, "StateBufferConnector_ms": 0.004021167755126953, "ViewRequirementAgentConnector_ms": 0.09755754470825195}, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 100000, "num_agent_steps_trained": 100000, "num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 422.19052332002, "num_env_steps_trained_throughput_per_sec": 422.19052332002, "timesteps_total": 100000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 100000, "timers": {"training_iteration_time_ms": 9399.218, "sample_time_ms": 5354.411, "load_time_ms": 1.222, "load_throughput": 3273347.641, "learn_time_ms": 4040.784, "learn_throughput": 989.907, "synch_weights_time_ms": 2.12}, "counters": {"num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_agent_steps_sampled": 100000, "num_agent_steps_trained": 100000}, "done": false, "episodes_total": 549, "training_iteration": 25, "trial_id": "b7012_00000", "date": "2024-03-07_12-43-55", "timestamp": 1709833435, "time_this_iter_s": 9.476899147033691, "time_total_s": 230.4229302406311, "pid": 109767, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4d85689f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 230.4229302406311, "iterations_since_restore": 25, "perf": {"cpu_util_percent": 31.491666666666664, "ram_util_percent": 50.69166666666667, "gpu_util_percent0": 0.16083333333333333, "vram_util_percent0": 0.13138834635416666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.10000000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 1.6674833567427492, "policy_loss": -0.02000968645136523, "vf_loss": 1.6866398276340577, "vf_explained_var": 0.6368297721109083, "kl": 0.008532068610265826, "entropy": 0.9306825355816913, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 23715.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 104000, "num_env_steps_trained": 104000, "num_agent_steps_sampled": 104000, "num_agent_steps_trained": 104000}, "sampler_results": {"episode_reward_max": -3.5, "episode_reward_min": -57.10000000000028, "episode_reward_mean": -8.257999999999992, "episode_len_mean": 88.57, "episode_media": {}, "episodes_this_iter": 50, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-6.599999999999989, -6.999999999999988, -12.699999999999967, -11.69999999999997, -7.69999999999999, -13.599999999999964, -17.19999999999998, -5.999999999999991, -11.599999999999971, -8.199999999999983, -6.7999999999999945, -4.599999999999996, -5.099999999999994, -57.10000000000028, -6.39999999999999, -8.599999999999982, -6.29999999999999, -5.5999999999999925, -11.299999999999972, -7.7999999999999865, -6.599999999999989, -8.999999999999982, -10.999999999999973, -8.89999999999998, -4.899999999999995, -6.39999999999999, -7.19999999999999, -8.599999999999985, -9.599999999999978, -9.699999999999978, -6.39999999999999, -9.999999999999977, -7.199999999999992, -6.39999999999999, -7.599999999999985, -22.900000000000052, -19.299999999999983, -5.899999999999992, -7.499999999999986, -8.299999999999988, -7.999999999999984, -7.499999999999986, -3.5, -9.399999999999979, -8.89999999999998, -8.499999999999982, -6.799999999999988, -3.6999999999999993, -7.699999999999994, -6.999999999999988, -3.799999999999999, -11.599999999999977, -8.699999999999985, -12.499999999999975, -7.799999999999985, -6.39999999999999, -12.099999999999973, -4.699999999999996, -6.699999999999992, -5.099999999999994, -5.4999999999999964, -6.29999999999999, -4.599999999999997, -5.9, -7.899999999999984, -5.299999999999994, -4.4999999999999964, -6.899999999999988, -18.90000000000001, -7.499999999999986, -5.499999999999993, -4.099999999999998, -6.29999999999999, -7.3999999999999915, -4.699999999999996, -7.899999999999984, -6.19999999999999, -4.399999999999997, -7.599999999999985, -6.299999999999997, -7.299999999999988, -6.19999999999999, -5.999999999999992, -5.599999999999999, -5.399999999999993, -6.39999999999999, -3.9999999999999982, -5.8999999999999915, -6.099999999999991, -4.899999999999995, -8.899999999999984, -5.5999999999999925, -4.699999999999996, -5.299999999999994, -7.199999999999987, -7.199999999999987, -21.700000000000056, -5.799999999999993, -7.299999999999992, -4.899999999999995], "episode_lengths": [77, 81, 138, 128, 83, 128, 181, 71, 124, 93, 72, 57, 62, 400, 73, 96, 74, 67, 124, 86, 77, 96, 121, 100, 60, 75, 79, 91, 107, 105, 75, 111, 76, 75, 87, 221, 177, 60, 86, 84, 91, 86, 46, 98, 100, 95, 79, 48, 76, 81, 49, 115, 90, 116, 89, 75, 118, 58, 74, 62, 62, 74, 56, 60, 90, 64, 56, 80, 170, 86, 66, 52, 74, 80, 58, 90, 73, 55, 87, 66, 81, 73, 69, 60, 65, 75, 51, 70, 72, 60, 89, 67, 58, 64, 83, 83, 209, 68, 77, 60]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.26107861799357324, "mean_inference_ms": 0.7586087981988328, "mean_action_processing_ms": 0.07957455673448635, "mean_env_wait_ms": 6.531019370647773, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007389545440673828, "StateBufferConnector_ms": 0.003992795944213867, "ViewRequirementAgentConnector_ms": 0.09606790542602539}}, "episode_reward_max": -3.5, "episode_reward_min": -57.10000000000028, "episode_reward_mean": -8.257999999999992, "episode_len_mean": 88.57, "episodes_this_iter": 50, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-6.599999999999989, -6.999999999999988, -12.699999999999967, -11.69999999999997, -7.69999999999999, -13.599999999999964, -17.19999999999998, -5.999999999999991, -11.599999999999971, -8.199999999999983, -6.7999999999999945, -4.599999999999996, -5.099999999999994, -57.10000000000028, -6.39999999999999, -8.599999999999982, -6.29999999999999, -5.5999999999999925, -11.299999999999972, -7.7999999999999865, -6.599999999999989, -8.999999999999982, -10.999999999999973, -8.89999999999998, -4.899999999999995, -6.39999999999999, -7.19999999999999, -8.599999999999985, -9.599999999999978, -9.699999999999978, -6.39999999999999, -9.999999999999977, -7.199999999999992, -6.39999999999999, -7.599999999999985, -22.900000000000052, -19.299999999999983, -5.899999999999992, -7.499999999999986, -8.299999999999988, -7.999999999999984, -7.499999999999986, -3.5, -9.399999999999979, -8.89999999999998, -8.499999999999982, -6.799999999999988, -3.6999999999999993, -7.699999999999994, -6.999999999999988, -3.799999999999999, -11.599999999999977, -8.699999999999985, -12.499999999999975, -7.799999999999985, -6.39999999999999, -12.099999999999973, -4.699999999999996, -6.699999999999992, -5.099999999999994, -5.4999999999999964, -6.29999999999999, -4.599999999999997, -5.9, -7.899999999999984, -5.299999999999994, -4.4999999999999964, -6.899999999999988, -18.90000000000001, -7.499999999999986, -5.499999999999993, -4.099999999999998, -6.29999999999999, -7.3999999999999915, -4.699999999999996, -7.899999999999984, -6.19999999999999, -4.399999999999997, -7.599999999999985, -6.299999999999997, -7.299999999999988, -6.19999999999999, -5.999999999999992, -5.599999999999999, -5.399999999999993, -6.39999999999999, -3.9999999999999982, -5.8999999999999915, -6.099999999999991, -4.899999999999995, -8.899999999999984, -5.5999999999999925, -4.699999999999996, -5.299999999999994, -7.199999999999987, -7.199999999999987, -21.700000000000056, -5.799999999999993, -7.299999999999992, -4.899999999999995], "episode_lengths": [77, 81, 138, 128, 83, 128, 181, 71, 124, 93, 72, 57, 62, 400, 73, 96, 74, 67, 124, 86, 77, 96, 121, 100, 60, 75, 79, 91, 107, 105, 75, 111, 76, 75, 87, 221, 177, 60, 86, 84, 91, 86, 46, 98, 100, 95, 79, 48, 76, 81, 49, 115, 90, 116, 89, 75, 118, 58, 74, 62, 62, 74, 56, 60, 90, 64, 56, 80, 170, 86, 66, 52, 74, 80, 58, 90, 73, 55, 87, 66, 81, 73, 69, 60, 65, 75, 51, 70, 72, 60, 89, 67, 58, 64, 83, 83, 209, 68, 77, 60]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.26107861799357324, "mean_inference_ms": 0.7586087981988328, "mean_action_processing_ms": 0.07957455673448635, "mean_env_wait_ms": 6.531019370647773, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007389545440673828, "StateBufferConnector_ms": 0.003992795944213867, "ViewRequirementAgentConnector_ms": 0.09606790542602539}, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 104000, "num_agent_steps_trained": 104000, "num_env_steps_sampled": 104000, "num_env_steps_trained": 104000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 430.91258286555205, "num_env_steps_trained_throughput_per_sec": 430.91258286555205, "timesteps_total": 104000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 104000, "timers": {"training_iteration_time_ms": 9435.732, "sample_time_ms": 5392.635, "load_time_ms": 1.222, "load_throughput": 3272070.835, "learn_time_ms": 4039.112, "learn_throughput": 990.317, "synch_weights_time_ms": 2.088}, "counters": {"num_env_steps_sampled": 104000, "num_env_steps_trained": 104000, "num_agent_steps_sampled": 104000, "num_agent_steps_trained": 104000}, "done": false, "episodes_total": 599, "training_iteration": 26, "trial_id": "b7012_00000", "date": "2024-03-07_12-44-04", "timestamp": 1709833444, "time_this_iter_s": 9.285077571868896, "time_total_s": 239.7080078125, "pid": 109767, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4d85689f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 239.7080078125, "iterations_since_restore": 26, "perf": {"cpu_util_percent": 29.349999999999998, "ram_util_percent": 50.725, "gpu_util_percent0": 0.15333333333333335, "vram_util_percent0": 0.1294623480902778}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.10000000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 2.31130735238974, "policy_loss": -0.00705563364630585, "vf_loss": 2.317408393035012, "vf_explained_var": 0.45778329654406474, "kl": 0.00954584090058234, "entropy": 0.9268369999624068, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 24645.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_agent_steps_sampled": 108000, "num_agent_steps_trained": 108000}, "sampler_results": {"episode_reward_max": -3.5999999999999996, "episode_reward_min": -50.800000000000345, "episode_reward_mean": -7.711999999999997, "episode_len_mean": 82.58, "episode_media": {}, "episodes_this_iter": 45, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8.499999999999982, -6.799999999999988, -3.6999999999999993, -7.699999999999994, -6.999999999999988, -3.799999999999999, -11.599999999999977, -8.699999999999985, -12.499999999999975, -7.799999999999985, -6.39999999999999, -12.099999999999973, -4.699999999999996, -6.699999999999992, -5.099999999999994, -5.4999999999999964, -6.29999999999999, -4.599999999999997, -5.9, -7.899999999999984, -5.299999999999994, -4.4999999999999964, -6.899999999999988, -18.90000000000001, -7.499999999999986, -5.499999999999993, -4.099999999999998, -6.29999999999999, -7.3999999999999915, -4.699999999999996, -7.899999999999984, -6.19999999999999, -4.399999999999997, -7.599999999999985, -6.299999999999997, -7.299999999999988, -6.19999999999999, -5.999999999999992, -5.599999999999999, -5.399999999999993, -6.39999999999999, -3.9999999999999982, -5.8999999999999915, -6.099999999999991, -4.899999999999995, -8.899999999999984, -5.5999999999999925, -4.699999999999996, -5.299999999999994, -7.199999999999987, -7.199999999999987, -21.700000000000056, -5.799999999999993, -7.299999999999992, -4.899999999999995, -8.99999999999998, -7.299999999999988, -5.199999999999996, -10.799999999999976, -22.20000000000004, -4.899999999999995, -5.399999999999996, -50.200000000000244, -5.8999999999999915, -6.29999999999999, -7.399999999999986, -6.499999999999991, -7.999999999999986, -3.8999999999999986, -5.299999999999994, -11.899999999999977, -4.999999999999995, -5.999999999999996, -4.599999999999996, -5.299999999999994, -7.599999999999989, -7.2999999999999865, -7.0999999999999925, -3.8999999999999986, -6.799999999999988, -5.399999999999993, -4.899999999999995, -4.699999999999996, -6.199999999999992, -4.299999999999997, -50.800000000000345, -5.599999999999995, -4.799999999999995, -5.5999999999999925, -5.999999999999992, -17.19999999999999, -4.599999999999996, -6.6999999999999895, -3.5999999999999996, -3.5999999999999996, -4.899999999999995, -6.899999999999991, -3.8999999999999986, -8.199999999999985, -6.2999999999999945], "episode_lengths": [95, 79, 48, 76, 81, 49, 115, 90, 116, 89, 75, 118, 58, 74, 62, 62, 74, 56, 60, 90, 64, 56, 80, 170, 86, 66, 52, 74, 80, 58, 90, 73, 55, 87, 66, 81, 73, 69, 60, 65, 75, 51, 70, 72, 60, 89, 67, 58, 64, 83, 83, 209, 68, 77, 60, 101, 81, 61, 100, 211, 60, 62, 400, 70, 74, 85, 74, 86, 50, 64, 107, 61, 66, 57, 64, 81, 84, 77, 50, 79, 65, 60, 58, 71, 54, 400, 64, 59, 66, 70, 152, 57, 77, 47, 47, 60, 77, 50, 92, 69]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.26276842491611807, "mean_inference_ms": 0.7585298273861847, "mean_action_processing_ms": 0.07968347184472117, "mean_env_wait_ms": 6.541763532484685, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007228374481201172, "StateBufferConnector_ms": 0.00390625, "ViewRequirementAgentConnector_ms": 0.09465980529785156}}, "episode_reward_max": -3.5999999999999996, "episode_reward_min": -50.800000000000345, "episode_reward_mean": -7.711999999999997, "episode_len_mean": 82.58, "episodes_this_iter": 45, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-8.499999999999982, -6.799999999999988, -3.6999999999999993, -7.699999999999994, -6.999999999999988, -3.799999999999999, -11.599999999999977, -8.699999999999985, -12.499999999999975, -7.799999999999985, -6.39999999999999, -12.099999999999973, -4.699999999999996, -6.699999999999992, -5.099999999999994, -5.4999999999999964, -6.29999999999999, -4.599999999999997, -5.9, -7.899999999999984, -5.299999999999994, -4.4999999999999964, -6.899999999999988, -18.90000000000001, -7.499999999999986, -5.499999999999993, -4.099999999999998, -6.29999999999999, -7.3999999999999915, -4.699999999999996, -7.899999999999984, -6.19999999999999, -4.399999999999997, -7.599999999999985, -6.299999999999997, -7.299999999999988, -6.19999999999999, -5.999999999999992, -5.599999999999999, -5.399999999999993, -6.39999999999999, -3.9999999999999982, -5.8999999999999915, -6.099999999999991, -4.899999999999995, -8.899999999999984, -5.5999999999999925, -4.699999999999996, -5.299999999999994, -7.199999999999987, -7.199999999999987, -21.700000000000056, -5.799999999999993, -7.299999999999992, -4.899999999999995, -8.99999999999998, -7.299999999999988, -5.199999999999996, -10.799999999999976, -22.20000000000004, -4.899999999999995, -5.399999999999996, -50.200000000000244, -5.8999999999999915, -6.29999999999999, -7.399999999999986, -6.499999999999991, -7.999999999999986, -3.8999999999999986, -5.299999999999994, -11.899999999999977, -4.999999999999995, -5.999999999999996, -4.599999999999996, -5.299999999999994, -7.599999999999989, -7.2999999999999865, -7.0999999999999925, -3.8999999999999986, -6.799999999999988, -5.399999999999993, -4.899999999999995, -4.699999999999996, -6.199999999999992, -4.299999999999997, -50.800000000000345, -5.599999999999995, -4.799999999999995, -5.5999999999999925, -5.999999999999992, -17.19999999999999, -4.599999999999996, -6.6999999999999895, -3.5999999999999996, -3.5999999999999996, -4.899999999999995, -6.899999999999991, -3.8999999999999986, -8.199999999999985, -6.2999999999999945], "episode_lengths": [95, 79, 48, 76, 81, 49, 115, 90, 116, 89, 75, 118, 58, 74, 62, 62, 74, 56, 60, 90, 64, 56, 80, 170, 86, 66, 52, 74, 80, 58, 90, 73, 55, 87, 66, 81, 73, 69, 60, 65, 75, 51, 70, 72, 60, 89, 67, 58, 64, 83, 83, 209, 68, 77, 60, 101, 81, 61, 100, 211, 60, 62, 400, 70, 74, 85, 74, 86, 50, 64, 107, 61, 66, 57, 64, 81, 84, 77, 50, 79, 65, 60, 58, 71, 54, 400, 64, 59, 66, 70, 152, 57, 77, 47, 47, 60, 77, 50, 92, 69]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.26276842491611807, "mean_inference_ms": 0.7585298273861847, "mean_action_processing_ms": 0.07968347184472117, "mean_env_wait_ms": 6.541763532484685, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007228374481201172, "StateBufferConnector_ms": 0.00390625, "ViewRequirementAgentConnector_ms": 0.09465980529785156}, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 108000, "num_agent_steps_trained": 108000, "num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 418.670324958554, "num_env_steps_trained_throughput_per_sec": 418.670324958554, "timesteps_total": 108000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 108000, "timers": {"training_iteration_time_ms": 9456.679, "sample_time_ms": 5411.909, "load_time_ms": 1.225, "load_throughput": 3266528.3, "learn_time_ms": 4040.552, "learn_throughput": 989.964, "synch_weights_time_ms": 2.278}, "counters": {"num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_agent_steps_sampled": 108000, "num_agent_steps_trained": 108000}, "done": false, "episodes_total": 644, "training_iteration": 27, "trial_id": "b7012_00000", "date": "2024-03-07_12-44-14", "timestamp": 1709833454, "time_this_iter_s": 9.55718207359314, "time_total_s": 249.26518988609314, "pid": 109767, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4d85689f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 249.26518988609314, "iterations_since_restore": 27, "perf": {"cpu_util_percent": 28.4, "ram_util_percent": 50.60769230769232, "gpu_util_percent0": 0.14307692307692307, "vram_util_percent0": 0.1293507111378205}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.10000000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 1.8629649598065698, "policy_loss": -0.007257450227775881, "vf_loss": 1.869128439583445, "vf_explained_var": 0.6538480249143416, "kl": 0.010939787900011388, "entropy": 0.8699047770551456, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 25575.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_agent_steps_sampled": 112000, "num_agent_steps_trained": 112000}, "sampler_results": {"episode_reward_max": -2.5000000000000018, "episode_reward_min": -59.10000000000035, "episode_reward_mean": -7.451000000000004, "episode_len_mean": 78.9, "episode_media": {}, "episodes_this_iter": 54, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4.899999999999995, -8.99999999999998, -7.299999999999988, -5.199999999999996, -10.799999999999976, -22.20000000000004, -4.899999999999995, -5.399999999999996, -50.200000000000244, -5.8999999999999915, -6.29999999999999, -7.399999999999986, -6.499999999999991, -7.999999999999986, -3.8999999999999986, -5.299999999999994, -11.899999999999977, -4.999999999999995, -5.999999999999996, -4.599999999999996, -5.299999999999994, -7.599999999999989, -7.2999999999999865, -7.0999999999999925, -3.8999999999999986, -6.799999999999988, -5.399999999999993, -4.899999999999995, -4.699999999999996, -6.199999999999992, -4.299999999999997, -50.800000000000345, -5.599999999999995, -4.799999999999995, -5.5999999999999925, -5.999999999999992, -17.19999999999999, -4.599999999999996, -6.6999999999999895, -3.5999999999999996, -3.5999999999999996, -4.899999999999995, -6.899999999999991, -3.8999999999999986, -8.199999999999985, -6.2999999999999945, -14.59999999999996, -59.10000000000035, -5.299999999999995, -4.899999999999996, -3.3000000000000007, -7.399999999999986, -7.999999999999989, -3.200000000000001, -4.1999999999999975, -6.19999999999999, -3.4000000000000004, -5.299999999999996, -6.799999999999991, -4.599999999999996, -5.499999999999998, -6.199999999999992, -5.299999999999994, -3.3000000000000007, -4.4999999999999964, -5.199999999999994, -3.9999999999999982, -4.899999999999995, -6.599999999999994, -5.599999999999993, -12.499999999999968, -3.3000000000000007, -7.599999999999994, -7.099999999999987, -6.499999999999993, -5.299999999999994, -5.199999999999994, -5.5999999999999925, -6.499999999999994, -4.599999999999996, -4.699999999999996, -5.699999999999995, -7.599999999999991, -2.5000000000000018, -3.200000000000001, -5.799999999999993, -4.599999999999996, -3.9999999999999982, -6.299999999999993, -6.29999999999999, -4.299999999999997, -4.299999999999997, -5.799999999999992, -6.099999999999991, -3.5999999999999996, -6.0999999999999925, -4.199999999999998, -5.099999999999998, -4.099999999999998, -6.29999999999999], "episode_lengths": [60, 101, 81, 61, 100, 211, 60, 62, 400, 70, 74, 85, 74, 86, 50, 64, 107, 61, 66, 57, 64, 81, 84, 77, 50, 79, 65, 60, 58, 71, 54, 400, 64, 59, 66, 70, 152, 57, 77, 47, 47, 60, 77, 50, 92, 69, 155, 400, 62, 59, 44, 85, 83, 43, 53, 73, 45, 61, 76, 57, 60, 71, 64, 44, 56, 63, 51, 60, 71, 66, 128, 44, 77, 82, 72, 64, 63, 67, 71, 57, 58, 65, 78, 36, 43, 68, 57, 51, 71, 74, 54, 54, 69, 72, 47, 70, 52, 58, 52, 74]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.26475376252999805, "mean_inference_ms": 0.7589029224036463, "mean_action_processing_ms": 0.07982064801010924, "mean_env_wait_ms": 6.5529764709041505, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00722813606262207, "StateBufferConnector_ms": 0.003906965255737305, "ViewRequirementAgentConnector_ms": 0.09604096412658691}}, "episode_reward_max": -2.5000000000000018, "episode_reward_min": -59.10000000000035, "episode_reward_mean": -7.451000000000004, "episode_len_mean": 78.9, "episodes_this_iter": 54, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-4.899999999999995, -8.99999999999998, -7.299999999999988, -5.199999999999996, -10.799999999999976, -22.20000000000004, -4.899999999999995, -5.399999999999996, -50.200000000000244, -5.8999999999999915, -6.29999999999999, -7.399999999999986, -6.499999999999991, -7.999999999999986, -3.8999999999999986, -5.299999999999994, -11.899999999999977, -4.999999999999995, -5.999999999999996, -4.599999999999996, -5.299999999999994, -7.599999999999989, -7.2999999999999865, -7.0999999999999925, -3.8999999999999986, -6.799999999999988, -5.399999999999993, -4.899999999999995, -4.699999999999996, -6.199999999999992, -4.299999999999997, -50.800000000000345, -5.599999999999995, -4.799999999999995, -5.5999999999999925, -5.999999999999992, -17.19999999999999, -4.599999999999996, -6.6999999999999895, -3.5999999999999996, -3.5999999999999996, -4.899999999999995, -6.899999999999991, -3.8999999999999986, -8.199999999999985, -6.2999999999999945, -14.59999999999996, -59.10000000000035, -5.299999999999995, -4.899999999999996, -3.3000000000000007, -7.399999999999986, -7.999999999999989, -3.200000000000001, -4.1999999999999975, -6.19999999999999, -3.4000000000000004, -5.299999999999996, -6.799999999999991, -4.599999999999996, -5.499999999999998, -6.199999999999992, -5.299999999999994, -3.3000000000000007, -4.4999999999999964, -5.199999999999994, -3.9999999999999982, -4.899999999999995, -6.599999999999994, -5.599999999999993, -12.499999999999968, -3.3000000000000007, -7.599999999999994, -7.099999999999987, -6.499999999999993, -5.299999999999994, -5.199999999999994, -5.5999999999999925, -6.499999999999994, -4.599999999999996, -4.699999999999996, -5.699999999999995, -7.599999999999991, -2.5000000000000018, -3.200000000000001, -5.799999999999993, -4.599999999999996, -3.9999999999999982, -6.299999999999993, -6.29999999999999, -4.299999999999997, -4.299999999999997, -5.799999999999992, -6.099999999999991, -3.5999999999999996, -6.0999999999999925, -4.199999999999998, -5.099999999999998, -4.099999999999998, -6.29999999999999], "episode_lengths": [60, 101, 81, 61, 100, 211, 60, 62, 400, 70, 74, 85, 74, 86, 50, 64, 107, 61, 66, 57, 64, 81, 84, 77, 50, 79, 65, 60, 58, 71, 54, 400, 64, 59, 66, 70, 152, 57, 77, 47, 47, 60, 77, 50, 92, 69, 155, 400, 62, 59, 44, 85, 83, 43, 53, 73, 45, 61, 76, 57, 60, 71, 64, 44, 56, 63, 51, 60, 71, 66, 128, 44, 77, 82, 72, 64, 63, 67, 71, 57, 58, 65, 78, 36, 43, 68, 57, 51, 71, 74, 54, 54, 69, 72, 47, 70, 52, 58, 52, 74]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.26475376252999805, "mean_inference_ms": 0.7589029224036463, "mean_action_processing_ms": 0.07982064801010924, "mean_env_wait_ms": 6.5529764709041505, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00722813606262207, "StateBufferConnector_ms": 0.003906965255737305, "ViewRequirementAgentConnector_ms": 0.09604096412658691}, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 112000, "num_agent_steps_trained": 112000, "num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 407.9845167771715, "num_env_steps_trained_throughput_per_sec": 407.9845167771715, "timesteps_total": 112000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 112000, "timers": {"training_iteration_time_ms": 9505.558, "sample_time_ms": 5422.027, "load_time_ms": 1.354, "load_throughput": 2953631.21, "learn_time_ms": 4079.183, "learn_throughput": 980.588, "synch_weights_time_ms": 2.275}, "counters": {"num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_agent_steps_sampled": 112000, "num_agent_steps_trained": 112000}, "done": false, "episodes_total": 698, "training_iteration": 28, "trial_id": "b7012_00000", "date": "2024-03-07_12-44-24", "timestamp": 1709833464, "time_this_iter_s": 9.806802034378052, "time_total_s": 259.0719919204712, "pid": 109767, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4d85689f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 259.0719919204712, "iterations_since_restore": 28, "perf": {"cpu_util_percent": 31.291666666666668, "ram_util_percent": 50.50833333333333, "gpu_util_percent0": 0.19333333333333333, "vram_util_percent0": 0.13130696614583334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.10000000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 1.0723257841693203, "policy_loss": -0.017589025155350727, "vf_loss": 1.088969751319257, "vf_explained_var": 0.7580166052746516, "kl": 0.009450523967044834, "entropy": 0.8537883177880318, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 26505.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 116000, "num_env_steps_trained": 116000, "num_agent_steps_sampled": 116000, "num_agent_steps_trained": 116000}, "sampler_results": {"episode_reward_max": -2.5000000000000018, "episode_reward_min": -55.000000000000306, "episode_reward_mean": -5.891999999999997, "episode_len_mean": 66.54, "episode_media": {}, "episodes_this_iter": 61, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-6.199999999999992, -5.299999999999994, -3.3000000000000007, -4.4999999999999964, -5.199999999999994, -3.9999999999999982, -4.899999999999995, -6.599999999999994, -5.599999999999993, -12.499999999999968, -3.3000000000000007, -7.599999999999994, -7.099999999999987, -6.499999999999993, -5.299999999999994, -5.199999999999994, -5.5999999999999925, -6.499999999999994, -4.599999999999996, -4.699999999999996, -5.699999999999995, -7.599999999999991, -2.5000000000000018, -3.200000000000001, -5.799999999999993, -4.599999999999996, -3.9999999999999982, -6.299999999999993, -6.29999999999999, -4.299999999999997, -4.299999999999997, -5.799999999999992, -6.099999999999991, -3.5999999999999996, -6.0999999999999925, -4.199999999999998, -5.099999999999998, -4.099999999999998, -6.29999999999999, -4.099999999999998, -4.899999999999995, -5.099999999999994, -4.299999999999997, -5.2, -6.099999999999995, -6.39999999999999, -4.999999999999995, -5.399999999999996, -5.599999999999993, -3.5, -5.299999999999994, -2.5000000000000018, -4.599999999999996, -4.599999999999996, -3.8999999999999986, -5.199999999999994, -5.399999999999993, -2.600000000000002, -4.299999999999999, -5.899999999999994, -5.299999999999994, -6.2999999999999945, -5.699999999999992, -5.5999999999999925, -3.9999999999999982, -6.39999999999999, -5.799999999999992, -3.9999999999999982, -3.799999999999999, -9.199999999999985, -6.599999999999989, -6.099999999999996, -7.599999999999985, -2.5000000000000018, -5.199999999999994, -4.1999999999999975, -11.499999999999972, -3.5, -3.5999999999999996, -5.199999999999994, -15.89999999999997, -4.999999999999995, -7.299999999999988, -4.099999999999998, -4.599999999999996, -6.199999999999992, -5.199999999999994, -4.1999999999999975, -4.899999999999995, -5.299999999999997, -6.19999999999999, -55.000000000000306, -5.5999999999999925, -4.299999999999997, -9.899999999999983, -5.9999999999999964, -5.299999999999994, -3.6999999999999993, -4.4999999999999964, -3.5999999999999996], "episode_lengths": [71, 64, 44, 56, 63, 51, 60, 71, 66, 128, 44, 77, 82, 72, 64, 63, 67, 71, 57, 58, 65, 78, 36, 43, 68, 57, 51, 71, 74, 54, 54, 69, 72, 47, 70, 52, 58, 52, 74, 52, 60, 62, 54, 54, 67, 75, 61, 62, 66, 46, 64, 36, 57, 57, 50, 63, 65, 37, 52, 67, 64, 69, 68, 67, 50, 75, 69, 51, 49, 87, 77, 66, 87, 36, 63, 53, 115, 46, 47, 63, 170, 61, 82, 52, 57, 71, 59, 53, 60, 60, 73, 380, 67, 54, 92, 65, 64, 48, 56, 47]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.26750167127863955, "mean_inference_ms": 0.7604315328489687, "mean_action_processing_ms": 0.07995066678985734, "mean_env_wait_ms": 6.572557228404395, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00757908821105957, "StateBufferConnector_ms": 0.004113435745239258, "ViewRequirementAgentConnector_ms": 0.10046553611755371}}, "episode_reward_max": -2.5000000000000018, "episode_reward_min": -55.000000000000306, "episode_reward_mean": -5.891999999999997, "episode_len_mean": 66.54, "episodes_this_iter": 61, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-6.199999999999992, -5.299999999999994, -3.3000000000000007, -4.4999999999999964, -5.199999999999994, -3.9999999999999982, -4.899999999999995, -6.599999999999994, -5.599999999999993, -12.499999999999968, -3.3000000000000007, -7.599999999999994, -7.099999999999987, -6.499999999999993, -5.299999999999994, -5.199999999999994, -5.5999999999999925, -6.499999999999994, -4.599999999999996, -4.699999999999996, -5.699999999999995, -7.599999999999991, -2.5000000000000018, -3.200000000000001, -5.799999999999993, -4.599999999999996, -3.9999999999999982, -6.299999999999993, -6.29999999999999, -4.299999999999997, -4.299999999999997, -5.799999999999992, -6.099999999999991, -3.5999999999999996, -6.0999999999999925, -4.199999999999998, -5.099999999999998, -4.099999999999998, -6.29999999999999, -4.099999999999998, -4.899999999999995, -5.099999999999994, -4.299999999999997, -5.2, -6.099999999999995, -6.39999999999999, -4.999999999999995, -5.399999999999996, -5.599999999999993, -3.5, -5.299999999999994, -2.5000000000000018, -4.599999999999996, -4.599999999999996, -3.8999999999999986, -5.199999999999994, -5.399999999999993, -2.600000000000002, -4.299999999999999, -5.899999999999994, -5.299999999999994, -6.2999999999999945, -5.699999999999992, -5.5999999999999925, -3.9999999999999982, -6.39999999999999, -5.799999999999992, -3.9999999999999982, -3.799999999999999, -9.199999999999985, -6.599999999999989, -6.099999999999996, -7.599999999999985, -2.5000000000000018, -5.199999999999994, -4.1999999999999975, -11.499999999999972, -3.5, -3.5999999999999996, -5.199999999999994, -15.89999999999997, -4.999999999999995, -7.299999999999988, -4.099999999999998, -4.599999999999996, -6.199999999999992, -5.199999999999994, -4.1999999999999975, -4.899999999999995, -5.299999999999997, -6.19999999999999, -55.000000000000306, -5.5999999999999925, -4.299999999999997, -9.899999999999983, -5.9999999999999964, -5.299999999999994, -3.6999999999999993, -4.4999999999999964, -3.5999999999999996], "episode_lengths": [71, 64, 44, 56, 63, 51, 60, 71, 66, 128, 44, 77, 82, 72, 64, 63, 67, 71, 57, 58, 65, 78, 36, 43, 68, 57, 51, 71, 74, 54, 54, 69, 72, 47, 70, 52, 58, 52, 74, 52, 60, 62, 54, 54, 67, 75, 61, 62, 66, 46, 64, 36, 57, 57, 50, 63, 65, 37, 52, 67, 64, 69, 68, 67, 50, 75, 69, 51, 49, 87, 77, 66, 87, 36, 63, 53, 115, 46, 47, 63, 170, 61, 82, 52, 57, 71, 59, 53, 60, 60, 73, 380, 67, 54, 92, 65, 64, 48, 56, 47]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.26750167127863955, "mean_inference_ms": 0.7604315328489687, "mean_action_processing_ms": 0.07995066678985734, "mean_env_wait_ms": 6.572557228404395, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00757908821105957, "StateBufferConnector_ms": 0.004113435745239258, "ViewRequirementAgentConnector_ms": 0.10046553611755371}, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 116000, "num_agent_steps_trained": 116000, "num_env_steps_sampled": 116000, "num_env_steps_trained": 116000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 402.0070525367116, "num_env_steps_trained_throughput_per_sec": 402.0070525367116, "timesteps_total": 116000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 116000, "timers": {"training_iteration_time_ms": 9584.833, "sample_time_ms": 5473.284, "load_time_ms": 1.38, "load_throughput": 2898770.842, "learn_time_ms": 4107.143, "learn_throughput": 973.913, "synch_weights_time_ms": 2.289}, "counters": {"num_env_steps_sampled": 116000, "num_env_steps_trained": 116000, "num_agent_steps_sampled": 116000, "num_agent_steps_trained": 116000}, "done": false, "episodes_total": 759, "training_iteration": 29, "trial_id": "b7012_00000", "date": "2024-03-07_12-44-34", "timestamp": 1709833474, "time_this_iter_s": 9.952504396438599, "time_total_s": 269.0244963169098, "pid": 109767, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4d85689f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 269.0244963169098, "iterations_since_restore": 29, "perf": {"cpu_util_percent": 34.36923076923077, "ram_util_percent": 50.6076923076923, "gpu_util_percent0": 0.16461538461538464, "vram_util_percent0": 0.13177959735576925}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.10000000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 1.9662867067148908, "policy_loss": -0.012238962651901348, "vf_loss": 1.9777150494036495, "vf_explained_var": 0.526344108837907, "kl": 0.008106158746631977, "entropy": 0.85357043961043, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 27435.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 120000, "num_env_steps_trained": 120000, "num_agent_steps_sampled": 120000, "num_agent_steps_trained": 120000}, "sampler_results": {"episode_reward_max": -2.5000000000000018, "episode_reward_min": -72.40000000000045, "episode_reward_mean": -6.848000000000006, "episode_len_mean": 71.05, "episode_media": {}, "episodes_this_iter": 57, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2.600000000000002, -4.299999999999999, -5.899999999999994, -5.299999999999994, -6.2999999999999945, -5.699999999999992, -5.5999999999999925, -3.9999999999999982, -6.39999999999999, -5.799999999999992, -3.9999999999999982, -3.799999999999999, -9.199999999999985, -6.599999999999989, -6.099999999999996, -7.599999999999985, -2.5000000000000018, -5.199999999999994, -4.1999999999999975, -11.499999999999972, -3.5, -3.5999999999999996, -5.199999999999994, -15.89999999999997, -4.999999999999995, -7.299999999999988, -4.099999999999998, -4.599999999999996, -6.199999999999992, -5.199999999999994, -4.1999999999999975, -4.899999999999995, -5.299999999999997, -6.19999999999999, -55.000000000000306, -5.5999999999999925, -4.299999999999997, -9.899999999999983, -5.9999999999999964, -5.299999999999994, -3.6999999999999993, -4.4999999999999964, -3.5999999999999996, -6.19999999999999, -4.099999999999998, -3.799999999999999, -3.8999999999999986, -4.699999999999997, -4.799999999999996, -4.4999999999999964, -3.5, -4.299999999999998, -5.2, -6.099999999999992, -4.699999999999996, -4.399999999999997, -7.099999999999991, -4.999999999999995, -4.799999999999997, -3.6999999999999993, -4.599999999999996, -5.499999999999999, -3.8000000000000016, -6.799999999999988, -4.299999999999997, -5.499999999999993, -3.4000000000000004, -4.299999999999997, -3.5999999999999996, -4.399999999999997, -5.199999999999994, -4.4999999999999964, -3.6999999999999993, -3.1000000000000014, -5.399999999999993, -7.099999999999989, -3.1000000000000014, -3.200000000000001, -3.5999999999999996, -5.199999999999996, -4.4999999999999964, -72.40000000000045, -4.4999999999999964, -5.599999999999993, -3.5, -54.70000000000031, -3.5999999999999996, -4.9999999999999964, -5.999999999999994, -4.6999999999999975, -3.5999999999999996, -5.499999999999995, -10.599999999999982, -3.0000000000000018, -10.099999999999977, -3.5999999999999996, -6.19999999999999, -5.799999999999992, -4.399999999999997, -4.699999999999998], "episode_lengths": [37, 52, 67, 64, 69, 68, 67, 50, 75, 69, 51, 49, 87, 77, 66, 87, 36, 63, 53, 115, 46, 47, 63, 170, 61, 82, 52, 57, 71, 59, 53, 60, 60, 73, 380, 67, 54, 92, 65, 64, 48, 56, 47, 73, 52, 49, 50, 57, 58, 56, 46, 53, 56, 71, 58, 55, 78, 61, 57, 48, 57, 59, 46, 79, 54, 66, 45, 54, 47, 55, 63, 56, 48, 42, 65, 80, 42, 43, 47, 61, 56, 400, 56, 64, 46, 377, 47, 59, 68, 56, 47, 64, 98, 41, 111, 47, 73, 69, 55, 55]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.27074854940090914, "mean_inference_ms": 0.7638049049564066, "mean_action_processing_ms": 0.08023026392104217, "mean_env_wait_ms": 6.610372643850322, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008046627044677734, "StateBufferConnector_ms": 0.004435539245605469, "ViewRequirementAgentConnector_ms": 0.10729265213012695}}, "episode_reward_max": -2.5000000000000018, "episode_reward_min": -72.40000000000045, "episode_reward_mean": -6.848000000000006, "episode_len_mean": 71.05, "episodes_this_iter": 57, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-2.600000000000002, -4.299999999999999, -5.899999999999994, -5.299999999999994, -6.2999999999999945, -5.699999999999992, -5.5999999999999925, -3.9999999999999982, -6.39999999999999, -5.799999999999992, -3.9999999999999982, -3.799999999999999, -9.199999999999985, -6.599999999999989, -6.099999999999996, -7.599999999999985, -2.5000000000000018, -5.199999999999994, -4.1999999999999975, -11.499999999999972, -3.5, -3.5999999999999996, -5.199999999999994, -15.89999999999997, -4.999999999999995, -7.299999999999988, -4.099999999999998, -4.599999999999996, -6.199999999999992, -5.199999999999994, -4.1999999999999975, -4.899999999999995, -5.299999999999997, -6.19999999999999, -55.000000000000306, -5.5999999999999925, -4.299999999999997, -9.899999999999983, -5.9999999999999964, -5.299999999999994, -3.6999999999999993, -4.4999999999999964, -3.5999999999999996, -6.19999999999999, -4.099999999999998, -3.799999999999999, -3.8999999999999986, -4.699999999999997, -4.799999999999996, -4.4999999999999964, -3.5, -4.299999999999998, -5.2, -6.099999999999992, -4.699999999999996, -4.399999999999997, -7.099999999999991, -4.999999999999995, -4.799999999999997, -3.6999999999999993, -4.599999999999996, -5.499999999999999, -3.8000000000000016, -6.799999999999988, -4.299999999999997, -5.499999999999993, -3.4000000000000004, -4.299999999999997, -3.5999999999999996, -4.399999999999997, -5.199999999999994, -4.4999999999999964, -3.6999999999999993, -3.1000000000000014, -5.399999999999993, -7.099999999999989, -3.1000000000000014, -3.200000000000001, -3.5999999999999996, -5.199999999999996, -4.4999999999999964, -72.40000000000045, -4.4999999999999964, -5.599999999999993, -3.5, -54.70000000000031, -3.5999999999999996, -4.9999999999999964, -5.999999999999994, -4.6999999999999975, -3.5999999999999996, -5.499999999999995, -10.599999999999982, -3.0000000000000018, -10.099999999999977, -3.5999999999999996, -6.19999999999999, -5.799999999999992, -4.399999999999997, -4.699999999999998], "episode_lengths": [37, 52, 67, 64, 69, 68, 67, 50, 75, 69, 51, 49, 87, 77, 66, 87, 36, 63, 53, 115, 46, 47, 63, 170, 61, 82, 52, 57, 71, 59, 53, 60, 60, 73, 380, 67, 54, 92, 65, 64, 48, 56, 47, 73, 52, 49, 50, 57, 58, 56, 46, 53, 56, 71, 58, 55, 78, 61, 57, 48, 57, 59, 46, 79, 54, 66, 45, 54, 47, 55, 63, 56, 48, 42, 65, 80, 42, 43, 47, 61, 56, 400, 56, 64, 46, 377, 47, 59, 68, 56, 47, 64, 98, 41, 111, 47, 73, 69, 55, 55]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.27074854940090914, "mean_inference_ms": 0.7638049049564066, "mean_action_processing_ms": 0.08023026392104217, "mean_env_wait_ms": 6.610372643850322, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008046627044677734, "StateBufferConnector_ms": 0.004435539245605469, "ViewRequirementAgentConnector_ms": 0.10729265213012695}, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 120000, "num_agent_steps_trained": 120000, "num_env_steps_sampled": 120000, "num_env_steps_trained": 120000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 323.01734555976526, "num_env_steps_trained_throughput_per_sec": 323.01734555976526, "timesteps_total": 120000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 120000, "timers": {"training_iteration_time_ms": 9867.486, "sample_time_ms": 5578.837, "load_time_ms": 1.384, "load_throughput": 2889534.635, "learn_time_ms": 4284.116, "learn_throughput": 933.682, "synch_weights_time_ms": 2.386}, "counters": {"num_env_steps_sampled": 120000, "num_env_steps_trained": 120000, "num_agent_steps_sampled": 120000, "num_agent_steps_trained": 120000}, "done": false, "episodes_total": 816, "training_iteration": 30, "trial_id": "b7012_00000", "date": "2024-03-07_12-44-46", "timestamp": 1709833486, "time_this_iter_s": 12.387075901031494, "time_total_s": 281.4115722179413, "pid": 109767, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4d85689f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 281.4115722179413, "iterations_since_restore": 30, "perf": {"cpu_util_percent": 50.425, "ram_util_percent": 53.225, "gpu_util_percent0": 0.173125, "vram_util_percent0": 0.13254292805989581}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.10000000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 1.3526057997945025, "policy_loss": -0.009898413182987321, "vf_loss": 1.361570858394587, "vf_explained_var": 0.7301891132067608, "kl": 0.009333490138959451, "entropy": 0.7988430991608609, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 28365.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 124000, "num_env_steps_trained": 124000, "num_agent_steps_sampled": 124000, "num_agent_steps_trained": 124000}, "sampler_results": {"episode_reward_max": -1.9000000000000012, "episode_reward_min": -72.40000000000045, "episode_reward_mean": -6.829000000000008, "episode_len_mean": 68.38, "episode_media": {}, "episodes_this_iter": 64, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4.299999999999997, -5.499999999999993, -3.4000000000000004, -4.299999999999997, -3.5999999999999996, -4.399999999999997, -5.199999999999994, -4.4999999999999964, -3.6999999999999993, -3.1000000000000014, -5.399999999999993, -7.099999999999989, -3.1000000000000014, -3.200000000000001, -3.5999999999999996, -5.199999999999996, -4.4999999999999964, -72.40000000000045, -4.4999999999999964, -5.599999999999993, -3.5, -54.70000000000031, -3.5999999999999996, -4.9999999999999964, -5.999999999999994, -4.6999999999999975, -3.5999999999999996, -5.499999999999995, -10.599999999999982, -3.0000000000000018, -10.099999999999977, -3.5999999999999996, -6.19999999999999, -5.799999999999992, -4.399999999999997, -4.699999999999998, -6.599999999999994, -4.399999999999997, -5.099999999999994, -4.1999999999999975, -4.099999999999998, -6.399999999999995, -4.299999999999998, -6.899999999999991, -3.6999999999999993, -3.3000000000000007, -6.399999999999992, -3.5, -2.900000000000002, -5.999999999999995, -4.299999999999997, -3.6999999999999993, -2.800000000000002, -5.199999999999994, -3.8999999999999986, -5.899999999999997, -4.999999999999995, -9.299999999999994, -5.5999999999999925, -3.8000000000000007, -4.799999999999995, -4.599999999999996, -6.199999999999995, -3.5999999999999996, -4.5, -6.399999999999996, -6.299999999999994, -5.499999999999993, -4.799999999999997, -5.099999999999994, -4.4999999999999964, -3.1000000000000014, -5.3, -4.099999999999998, -4.699999999999996, -21.399999999999967, -4.1000000000000005, -3.9999999999999982, -4.4999999999999964, -4.099999999999998, -4.099999999999998, -4.6, -3.6999999999999993, -3.6999999999999993, -3.5999999999999996, -2.3000000000000016, -5.999999999999998, -10.899999999999983, -3.5999999999999996, -3.8999999999999986, -4.799999999999995, -6.099999999999996, -1.9000000000000012, -70.70000000000041, -4.199999999999998, -3.9999999999999982, -4.399999999999997, -3.9999999999999982, -3.5999999999999996, -12.299999999999969], "episode_lengths": [54, 66, 45, 54, 47, 55, 63, 56, 48, 42, 65, 80, 42, 43, 47, 61, 56, 400, 56, 64, 46, 377, 47, 59, 68, 56, 47, 64, 98, 41, 111, 47, 73, 69, 55, 55, 71, 54, 62, 53, 52, 69, 51, 73, 46, 44, 70, 46, 40, 67, 54, 48, 39, 63, 50, 64, 61, 82, 67, 47, 59, 57, 68, 47, 52, 68, 70, 66, 57, 62, 56, 42, 57, 52, 58, 151, 49, 51, 56, 52, 52, 53, 48, 48, 47, 34, 63, 94, 47, 50, 59, 66, 30, 400, 52, 51, 55, 51, 47, 131]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.27514329874867227, "mean_inference_ms": 0.7697162069224831, "mean_action_processing_ms": 0.08092702270347361, "mean_env_wait_ms": 6.664856041135305, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008640050888061523, "StateBufferConnector_ms": 0.0048863887786865234, "ViewRequirementAgentConnector_ms": 0.11739706993103027}}, "episode_reward_max": -1.9000000000000012, "episode_reward_min": -72.40000000000045, "episode_reward_mean": -6.829000000000008, "episode_len_mean": 68.38, "episodes_this_iter": 64, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-4.299999999999997, -5.499999999999993, -3.4000000000000004, -4.299999999999997, -3.5999999999999996, -4.399999999999997, -5.199999999999994, -4.4999999999999964, -3.6999999999999993, -3.1000000000000014, -5.399999999999993, -7.099999999999989, -3.1000000000000014, -3.200000000000001, -3.5999999999999996, -5.199999999999996, -4.4999999999999964, -72.40000000000045, -4.4999999999999964, -5.599999999999993, -3.5, -54.70000000000031, -3.5999999999999996, -4.9999999999999964, -5.999999999999994, -4.6999999999999975, -3.5999999999999996, -5.499999999999995, -10.599999999999982, -3.0000000000000018, -10.099999999999977, -3.5999999999999996, -6.19999999999999, -5.799999999999992, -4.399999999999997, -4.699999999999998, -6.599999999999994, -4.399999999999997, -5.099999999999994, -4.1999999999999975, -4.099999999999998, -6.399999999999995, -4.299999999999998, -6.899999999999991, -3.6999999999999993, -3.3000000000000007, -6.399999999999992, -3.5, -2.900000000000002, -5.999999999999995, -4.299999999999997, -3.6999999999999993, -2.800000000000002, -5.199999999999994, -3.8999999999999986, -5.899999999999997, -4.999999999999995, -9.299999999999994, -5.5999999999999925, -3.8000000000000007, -4.799999999999995, -4.599999999999996, -6.199999999999995, -3.5999999999999996, -4.5, -6.399999999999996, -6.299999999999994, -5.499999999999993, -4.799999999999997, -5.099999999999994, -4.4999999999999964, -3.1000000000000014, -5.3, -4.099999999999998, -4.699999999999996, -21.399999999999967, -4.1000000000000005, -3.9999999999999982, -4.4999999999999964, -4.099999999999998, -4.099999999999998, -4.6, -3.6999999999999993, -3.6999999999999993, -3.5999999999999996, -2.3000000000000016, -5.999999999999998, -10.899999999999983, -3.5999999999999996, -3.8999999999999986, -4.799999999999995, -6.099999999999996, -1.9000000000000012, -70.70000000000041, -4.199999999999998, -3.9999999999999982, -4.399999999999997, -3.9999999999999982, -3.5999999999999996, -12.299999999999969], "episode_lengths": [54, 66, 45, 54, 47, 55, 63, 56, 48, 42, 65, 80, 42, 43, 47, 61, 56, 400, 56, 64, 46, 377, 47, 59, 68, 56, 47, 64, 98, 41, 111, 47, 73, 69, 55, 55, 71, 54, 62, 53, 52, 69, 51, 73, 46, 44, 70, 46, 40, 67, 54, 48, 39, 63, 50, 64, 61, 82, 67, 47, 59, 57, 68, 47, 52, 68, 70, 66, 57, 62, 56, 42, 57, 52, 58, 151, 49, 51, 56, 52, 52, 53, 48, 48, 47, 34, 63, 94, 47, 50, 59, 66, 30, 400, 52, 51, 55, 51, 47, 131]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.27514329874867227, "mean_inference_ms": 0.7697162069224831, "mean_action_processing_ms": 0.08092702270347361, "mean_env_wait_ms": 6.664856041135305, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008640050888061523, "StateBufferConnector_ms": 0.0048863887786865234, "ViewRequirementAgentConnector_ms": 0.11739706993103027}, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 124000, "num_agent_steps_trained": 124000, "num_env_steps_sampled": 124000, "num_env_steps_trained": 124000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 349.29320616700994, "num_env_steps_trained_throughput_per_sec": 349.29320616700994, "timesteps_total": 124000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 124000, "timers": {"training_iteration_time_ms": 10028.262, "sample_time_ms": 5711.105, "load_time_ms": 1.474, "load_throughput": 2713486.552, "learn_time_ms": 4312.477, "learn_throughput": 927.541, "synch_weights_time_ms": 2.442}, "counters": {"num_env_steps_sampled": 124000, "num_env_steps_trained": 124000, "num_agent_steps_sampled": 124000, "num_agent_steps_trained": 124000}, "done": false, "episodes_total": 880, "training_iteration": 31, "trial_id": "b7012_00000", "date": "2024-03-07_12-44-58", "timestamp": 1709833498, "time_this_iter_s": 11.454623699188232, "time_total_s": 292.8661959171295, "pid": 109767, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4d85689f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 292.8661959171295, "iterations_since_restore": 31, "perf": {"cpu_util_percent": 49.33571428571429, "ram_util_percent": 57.271428571428565, "gpu_util_percent0": 0.18, "vram_util_percent0": 0.1348935081845238}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.10000000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 1.4238149981174657, "policy_loss": -0.009252589508410423, "vf_loss": 1.432123385634153, "vf_explained_var": 0.6084576672764235, "kl": 0.009442000181146189, "entropy": 0.7665156802823466, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 29295.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 128000, "num_env_steps_trained": 128000, "num_agent_steps_sampled": 128000, "num_agent_steps_trained": 128000}, "sampler_results": {"episode_reward_max": -1.9000000000000012, "episode_reward_min": -70.70000000000041, "episode_reward_mean": -5.8680000000000065, "episode_len_mean": 61.61, "episode_media": {}, "episodes_this_iter": 68, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4.799999999999997, -5.099999999999994, -4.4999999999999964, -3.1000000000000014, -5.3, -4.099999999999998, -4.699999999999996, -21.399999999999967, -4.1000000000000005, -3.9999999999999982, -4.4999999999999964, -4.099999999999998, -4.099999999999998, -4.6, -3.6999999999999993, -3.6999999999999993, -3.5999999999999996, -2.3000000000000016, -5.999999999999998, -10.899999999999983, -3.5999999999999996, -3.8999999999999986, -4.799999999999995, -6.099999999999996, -1.9000000000000012, -70.70000000000041, -4.199999999999998, -3.9999999999999982, -4.399999999999997, -3.9999999999999982, -3.5999999999999996, -12.299999999999969, -4.399999999999997, -4.1999999999999975, -3.6999999999999993, -4.2, -4.599999999999996, -4.1999999999999975, -4.1999999999999975, -4.1999999999999975, -3.799999999999999, -10.099999999999984, -4.899999999999995, -3.5999999999999996, -4.299999999999997, -3.1000000000000014, -3.200000000000001, -69.40000000000046, -3.5999999999999996, -3.9999999999999982, -3.8999999999999986, -4.4999999999999964, -4.499999999999998, -4.299999999999997, -5.099999999999999, -3.799999999999999, -3.3000000000000007, -4.099999999999998, -6.099999999999994, -4.399999999999997, -3.799999999999999, -4.699999999999996, -4.699999999999996, -3.0000000000000018, -3.4000000000000004, -4.299999999999997, -3.1000000000000014, -3.8999999999999995, -3.6999999999999993, -5.499999999999997, -4.799999999999995, -3.8999999999999986, -4.699999999999996, -3.4000000000000004, -5.299999999999994, -4.0, -3.0000000000000018, -4.599999999999997, -5.099999999999994, -3.4000000000000004, -4.1999999999999975, -4.199999999999998, -4.899999999999998, -4.699999999999996, -3.200000000000001, -8.199999999999985, -5.099999999999994, -3.5, -4.599999999999996, -4.4999999999999964, -4.799999999999998, -2.700000000000002, -2.800000000000002, -4.099999999999998, -5.099999999999994, -2.5000000000000018, -5.099999999999995, -3.3000000000000007, -3.200000000000001, -3.9999999999999982], "episode_lengths": [57, 62, 56, 42, 57, 52, 58, 151, 49, 51, 56, 52, 52, 53, 48, 48, 47, 34, 63, 94, 47, 50, 59, 66, 30, 400, 52, 51, 55, 51, 47, 131, 55, 53, 48, 50, 57, 53, 53, 53, 49, 97, 60, 47, 54, 42, 43, 400, 47, 51, 50, 56, 54, 54, 57, 49, 44, 52, 68, 55, 49, 58, 58, 41, 45, 54, 42, 49, 48, 61, 59, 50, 58, 45, 64, 49, 41, 56, 62, 45, 53, 49, 57, 58, 43, 92, 62, 46, 57, 56, 56, 38, 39, 52, 62, 36, 61, 44, 43, 51]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2791704540985138, "mean_inference_ms": 0.7756654029741226, "mean_action_processing_ms": 0.08152691193493801, "mean_env_wait_ms": 6.7285313962236675, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008578062057495117, "StateBufferConnector_ms": 0.004865407943725586, "ViewRequirementAgentConnector_ms": 0.11592793464660645}}, "episode_reward_max": -1.9000000000000012, "episode_reward_min": -70.70000000000041, "episode_reward_mean": -5.8680000000000065, "episode_len_mean": 61.61, "episodes_this_iter": 68, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-4.799999999999997, -5.099999999999994, -4.4999999999999964, -3.1000000000000014, -5.3, -4.099999999999998, -4.699999999999996, -21.399999999999967, -4.1000000000000005, -3.9999999999999982, -4.4999999999999964, -4.099999999999998, -4.099999999999998, -4.6, -3.6999999999999993, -3.6999999999999993, -3.5999999999999996, -2.3000000000000016, -5.999999999999998, -10.899999999999983, -3.5999999999999996, -3.8999999999999986, -4.799999999999995, -6.099999999999996, -1.9000000000000012, -70.70000000000041, -4.199999999999998, -3.9999999999999982, -4.399999999999997, -3.9999999999999982, -3.5999999999999996, -12.299999999999969, -4.399999999999997, -4.1999999999999975, -3.6999999999999993, -4.2, -4.599999999999996, -4.1999999999999975, -4.1999999999999975, -4.1999999999999975, -3.799999999999999, -10.099999999999984, -4.899999999999995, -3.5999999999999996, -4.299999999999997, -3.1000000000000014, -3.200000000000001, -69.40000000000046, -3.5999999999999996, -3.9999999999999982, -3.8999999999999986, -4.4999999999999964, -4.499999999999998, -4.299999999999997, -5.099999999999999, -3.799999999999999, -3.3000000000000007, -4.099999999999998, -6.099999999999994, -4.399999999999997, -3.799999999999999, -4.699999999999996, -4.699999999999996, -3.0000000000000018, -3.4000000000000004, -4.299999999999997, -3.1000000000000014, -3.8999999999999995, -3.6999999999999993, -5.499999999999997, -4.799999999999995, -3.8999999999999986, -4.699999999999996, -3.4000000000000004, -5.299999999999994, -4.0, -3.0000000000000018, -4.599999999999997, -5.099999999999994, -3.4000000000000004, -4.1999999999999975, -4.199999999999998, -4.899999999999998, -4.699999999999996, -3.200000000000001, -8.199999999999985, -5.099999999999994, -3.5, -4.599999999999996, -4.4999999999999964, -4.799999999999998, -2.700000000000002, -2.800000000000002, -4.099999999999998, -5.099999999999994, -2.5000000000000018, -5.099999999999995, -3.3000000000000007, -3.200000000000001, -3.9999999999999982], "episode_lengths": [57, 62, 56, 42, 57, 52, 58, 151, 49, 51, 56, 52, 52, 53, 48, 48, 47, 34, 63, 94, 47, 50, 59, 66, 30, 400, 52, 51, 55, 51, 47, 131, 55, 53, 48, 50, 57, 53, 53, 53, 49, 97, 60, 47, 54, 42, 43, 400, 47, 51, 50, 56, 54, 54, 57, 49, 44, 52, 68, 55, 49, 58, 58, 41, 45, 54, 42, 49, 48, 61, 59, 50, 58, 45, 64, 49, 41, 56, 62, 45, 53, 49, 57, 58, 43, 92, 62, 46, 57, 56, 56, 38, 39, 52, 62, 36, 61, 44, 43, 51]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2791704540985138, "mean_inference_ms": 0.7756654029741226, "mean_action_processing_ms": 0.08152691193493801, "mean_env_wait_ms": 6.7285313962236675, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008578062057495117, "StateBufferConnector_ms": 0.004865407943725586, "ViewRequirementAgentConnector_ms": 0.11592793464660645}, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 128000, "num_agent_steps_trained": 128000, "num_env_steps_sampled": 128000, "num_env_steps_trained": 128000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 342.52716790191204, "num_env_steps_trained_throughput_per_sec": 342.52716790191204, "timesteps_total": 128000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 128000, "timers": {"training_iteration_time_ms": 10292.367, "sample_time_ms": 5877.083, "load_time_ms": 1.477, "load_throughput": 2707662.115, "learn_time_ms": 4410.345, "learn_throughput": 906.958, "synch_weights_time_ms": 2.69}, "counters": {"num_env_steps_sampled": 128000, "num_env_steps_trained": 128000, "num_agent_steps_sampled": 128000, "num_agent_steps_trained": 128000}, "done": false, "episodes_total": 948, "training_iteration": 32, "trial_id": "b7012_00000", "date": "2024-03-07_12-45-09", "timestamp": 1709833509, "time_this_iter_s": 11.680728912353516, "time_total_s": 304.54692482948303, "pid": 109767, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4d85689f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 304.54692482948303, "iterations_since_restore": 32, "perf": {"cpu_util_percent": 47.18, "ram_util_percent": 58.35333333333334, "gpu_util_percent0": 0.13866666666666666, "vram_util_percent0": 0.13462456597222225}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.10000000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 0.9527938335426702, "policy_loss": 0.0008356490993611915, "vf_loss": 0.9508473982694008, "vf_explained_var": 0.666358127709358, "kl": 0.011107982034461387, "entropy": 0.7203642220266404, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 30225.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 132000, "num_env_steps_trained": 132000, "num_agent_steps_sampled": 132000, "num_agent_steps_trained": 132000}, "sampler_results": {"episode_reward_max": -1.9000000000000012, "episode_reward_min": -71.10000000000046, "episode_reward_mean": -4.8830000000000044, "episode_len_mean": 54.88, "episode_media": {}, "episodes_this_iter": 73, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.4000000000000004, -5.299999999999994, -4.0, -3.0000000000000018, -4.599999999999997, -5.099999999999994, -3.4000000000000004, -4.1999999999999975, -4.199999999999998, -4.899999999999998, -4.699999999999996, -3.200000000000001, -8.199999999999985, -5.099999999999994, -3.5, -4.599999999999996, -4.4999999999999964, -4.799999999999998, -2.700000000000002, -2.800000000000002, -4.099999999999998, -5.099999999999994, -2.5000000000000018, -5.099999999999995, -3.3000000000000007, -3.200000000000001, -3.9999999999999982, -71.10000000000046, -3.6999999999999993, -3.6999999999999993, -3.8999999999999986, -4.399999999999997, -3.3000000000000007, -3.6999999999999993, -2.600000000000002, -3.8999999999999986, -2.5000000000000018, -3.4000000000000004, -3.0000000000000018, -3.9999999999999982, -4.599999999999996, -4.899999999999996, -2.700000000000002, -4.899999999999996, -3.9999999999999982, -2.700000000000002, -3.3000000000000007, -4.1999999999999975, -3.0000000000000018, -3.6999999999999993, -3.200000000000001, -4.399999999999997, -3.5999999999999996, -3.5, -3.799999999999999, -3.799999999999999, -5.399999999999997, -3.1000000000000014, -3.4000000000000004, -4.1, -4.1999999999999975, -4.799999999999995, -2.900000000000002, -3.5, -3.5999999999999996, -3.200000000000002, -4.799999999999995, -4.1999999999999975, -4.399999999999998, -3.1000000000000014, -4.8, -3.4000000000000004, -5.5999999999999925, -8.099999999999996, -4.4999999999999964, -29.400000000000077, -4.699999999999996, -3.5999999999999996, -2.800000000000002, -3.3000000000000007, -3.5, -3.500000000000001, -4.299999999999997, -4.1999999999999975, -4.099999999999998, -3.500000000000001, -3.6999999999999993, -4.299999999999998, -2.5000000000000018, -3.200000000000001, -5.600000000000001, -3.9999999999999982, -3.200000000000001, -4.699999999999996, -2.5000000000000018, -4.099999999999998, -1.9000000000000012, -4.1999999999999975, -6.300000000000001, -3.1000000000000014], "episode_lengths": [45, 64, 49, 41, 56, 62, 45, 53, 49, 57, 58, 43, 92, 62, 46, 57, 56, 56, 38, 39, 52, 62, 36, 61, 44, 43, 51, 400, 48, 48, 50, 55, 44, 48, 37, 50, 36, 45, 41, 51, 57, 59, 38, 59, 51, 38, 44, 53, 41, 48, 43, 55, 47, 46, 49, 49, 57, 42, 45, 49, 53, 59, 40, 46, 47, 41, 59, 53, 54, 42, 54, 45, 67, 72, 56, 219, 58, 47, 39, 44, 46, 43, 54, 53, 52, 43, 48, 53, 36, 43, 57, 51, 41, 58, 36, 52, 30, 53, 62, 42]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.28345217917166826, "mean_inference_ms": 0.7809584554524033, "mean_action_processing_ms": 0.08178316715323057, "mean_env_wait_ms": 6.796066035160731, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008666276931762695, "StateBufferConnector_ms": 0.004808902740478516, "ViewRequirementAgentConnector_ms": 0.11450648307800293}}, "episode_reward_max": -1.9000000000000012, "episode_reward_min": -71.10000000000046, "episode_reward_mean": -4.8830000000000044, "episode_len_mean": 54.88, "episodes_this_iter": 73, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3.4000000000000004, -5.299999999999994, -4.0, -3.0000000000000018, -4.599999999999997, -5.099999999999994, -3.4000000000000004, -4.1999999999999975, -4.199999999999998, -4.899999999999998, -4.699999999999996, -3.200000000000001, -8.199999999999985, -5.099999999999994, -3.5, -4.599999999999996, -4.4999999999999964, -4.799999999999998, -2.700000000000002, -2.800000000000002, -4.099999999999998, -5.099999999999994, -2.5000000000000018, -5.099999999999995, -3.3000000000000007, -3.200000000000001, -3.9999999999999982, -71.10000000000046, -3.6999999999999993, -3.6999999999999993, -3.8999999999999986, -4.399999999999997, -3.3000000000000007, -3.6999999999999993, -2.600000000000002, -3.8999999999999986, -2.5000000000000018, -3.4000000000000004, -3.0000000000000018, -3.9999999999999982, -4.599999999999996, -4.899999999999996, -2.700000000000002, -4.899999999999996, -3.9999999999999982, -2.700000000000002, -3.3000000000000007, -4.1999999999999975, -3.0000000000000018, -3.6999999999999993, -3.200000000000001, -4.399999999999997, -3.5999999999999996, -3.5, -3.799999999999999, -3.799999999999999, -5.399999999999997, -3.1000000000000014, -3.4000000000000004, -4.1, -4.1999999999999975, -4.799999999999995, -2.900000000000002, -3.5, -3.5999999999999996, -3.200000000000002, -4.799999999999995, -4.1999999999999975, -4.399999999999998, -3.1000000000000014, -4.8, -3.4000000000000004, -5.5999999999999925, -8.099999999999996, -4.4999999999999964, -29.400000000000077, -4.699999999999996, -3.5999999999999996, -2.800000000000002, -3.3000000000000007, -3.5, -3.500000000000001, -4.299999999999997, -4.1999999999999975, -4.099999999999998, -3.500000000000001, -3.6999999999999993, -4.299999999999998, -2.5000000000000018, -3.200000000000001, -5.600000000000001, -3.9999999999999982, -3.200000000000001, -4.699999999999996, -2.5000000000000018, -4.099999999999998, -1.9000000000000012, -4.1999999999999975, -6.300000000000001, -3.1000000000000014], "episode_lengths": [45, 64, 49, 41, 56, 62, 45, 53, 49, 57, 58, 43, 92, 62, 46, 57, 56, 56, 38, 39, 52, 62, 36, 61, 44, 43, 51, 400, 48, 48, 50, 55, 44, 48, 37, 50, 36, 45, 41, 51, 57, 59, 38, 59, 51, 38, 44, 53, 41, 48, 43, 55, 47, 46, 49, 49, 57, 42, 45, 49, 53, 59, 40, 46, 47, 41, 59, 53, 54, 42, 54, 45, 67, 72, 56, 219, 58, 47, 39, 44, 46, 43, 54, 53, 52, 43, 48, 53, 36, 43, 57, 51, 41, 58, 36, 52, 30, 53, 62, 42]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.28345217917166826, "mean_inference_ms": 0.7809584554524033, "mean_action_processing_ms": 0.08178316715323057, "mean_env_wait_ms": 6.796066035160731, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008666276931762695, "StateBufferConnector_ms": 0.004808902740478516, "ViewRequirementAgentConnector_ms": 0.11450648307800293}, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 132000, "num_agent_steps_trained": 132000, "num_env_steps_sampled": 132000, "num_env_steps_trained": 132000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 342.9381698228312, "num_env_steps_trained_throughput_per_sec": 342.9381698228312, "timesteps_total": 132000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 132000, "timers": {"training_iteration_time_ms": 10507.099, "sample_time_ms": 6042.939, "load_time_ms": 1.488, "load_throughput": 2688354.832, "learn_time_ms": 4459.199, "learn_throughput": 897.022, "synch_weights_time_ms": 2.697}, "counters": {"num_env_steps_sampled": 132000, "num_env_steps_trained": 132000, "num_agent_steps_sampled": 132000, "num_agent_steps_trained": 132000}, "done": false, "episodes_total": 1021, "training_iteration": 33, "trial_id": "b7012_00000", "date": "2024-03-07_12-45-21", "timestamp": 1709833521, "time_this_iter_s": 11.666672945022583, "time_total_s": 316.2135977745056, "pid": 109767, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4d85689f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 316.2135977745056, "iterations_since_restore": 33, "perf": {"cpu_util_percent": 43.81333333333334, "ram_util_percent": 60.61333333333333, "gpu_util_percent0": 0.158, "vram_util_percent0": 0.13405490451388888}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.10000000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 0.806024365398472, "policy_loss": -0.01153423792272005, "vf_loss": 0.8166654150852913, "vf_explained_var": 0.7592751012694451, "kl": 0.008931887356958849, "entropy": 0.6946471891736472, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 31155.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 136000, "num_env_steps_trained": 136000, "num_agent_steps_sampled": 136000, "num_agent_steps_trained": 136000}, "sampler_results": {"episode_reward_max": -1.9000000000000012, "episode_reward_min": -20.90000000000004, "episode_reward_mean": -4.026, "episode_len_mean": 50.03, "episode_media": {}, "episodes_this_iter": 80, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.5, -3.500000000000001, -4.299999999999997, -4.1999999999999975, -4.099999999999998, -3.500000000000001, -3.6999999999999993, -4.299999999999998, -2.5000000000000018, -3.200000000000001, -5.600000000000001, -3.9999999999999982, -3.200000000000001, -4.699999999999996, -2.5000000000000018, -4.099999999999998, -1.9000000000000012, -4.1999999999999975, -6.300000000000001, -3.1000000000000014, -4.899999999999996, -4.099999999999998, -3.4000000000000004, -4.299999999999997, -3.4000000000000004, -5.000000000000002, -5.1000000000000005, -3.5999999999999996, -4.1999999999999975, -3.6999999999999993, -3.1000000000000014, -3.5999999999999996, -4.099999999999998, -2.600000000000002, -3.0000000000000018, -2.700000000000002, -2.4000000000000017, -3.6999999999999993, -3.6999999999999993, -5.399999999999993, -3.8999999999999995, -3.5, -4.899999999999995, -3.3000000000000007, -4.599999999999996, -3.6999999999999993, -3.3000000000000007, -4.1999999999999975, -3.1000000000000014, -3.799999999999999, -4.899999999999995, -3.8999999999999986, -6.499999999999996, -3.4000000000000004, -20.90000000000004, -3.4000000000000004, -3.5999999999999996, -3.0000000000000018, -4.3, -4.1, -4.099999999999998, -4.4999999999999964, -3.6999999999999993, -4.1999999999999975, -4.199999999999998, -3.799999999999999, -3.3000000000000007, -3.5, -4.799999999999997, -3.3000000000000007, -2.4000000000000017, -3.8999999999999986, -3.200000000000001, -3.200000000000001, -3.0000000000000018, -2.800000000000002, -4.099999999999998, -3.200000000000001, -6.8000000000000025, -2.4000000000000017, -3.1000000000000014, -3.6999999999999993, -3.200000000000001, -3.9999999999999982, -4.6, -3.1000000000000014, -3.3000000000000007, -14.899999999999965, -3.1000000000000014, -3.0000000000000018, -2.600000000000002, -3.5, -3.9999999999999982, -2.600000000000002, -4.599999999999996, -2.600000000000002, -3.1000000000000014, -4.299999999999997, -2.600000000000002, -3.5999999999999996], "episode_lengths": [46, 43, 54, 53, 52, 43, 48, 53, 36, 43, 57, 51, 41, 58, 36, 52, 30, 53, 62, 42, 59, 52, 45, 54, 45, 53, 55, 47, 53, 48, 42, 47, 52, 37, 41, 38, 35, 48, 48, 65, 49, 46, 60, 44, 57, 48, 44, 53, 42, 49, 60, 50, 69, 45, 220, 45, 47, 41, 51, 50, 52, 56, 48, 53, 52, 42, 44, 46, 57, 44, 35, 50, 43, 43, 41, 39, 52, 43, 60, 35, 42, 48, 43, 51, 53, 42, 44, 130, 42, 41, 37, 46, 51, 37, 57, 37, 42, 54, 37, 47]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2869269749384594, "mean_inference_ms": 0.7830761805380567, "mean_action_processing_ms": 0.08187414032893427, "mean_env_wait_ms": 6.829474891302823, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008058309555053711, "StateBufferConnector_ms": 0.004435300827026367, "ViewRequirementAgentConnector_ms": 0.10549378395080566}}, "episode_reward_max": -1.9000000000000012, "episode_reward_min": -20.90000000000004, "episode_reward_mean": -4.026, "episode_len_mean": 50.03, "episodes_this_iter": 80, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3.5, -3.500000000000001, -4.299999999999997, -4.1999999999999975, -4.099999999999998, -3.500000000000001, -3.6999999999999993, -4.299999999999998, -2.5000000000000018, -3.200000000000001, -5.600000000000001, -3.9999999999999982, -3.200000000000001, -4.699999999999996, -2.5000000000000018, -4.099999999999998, -1.9000000000000012, -4.1999999999999975, -6.300000000000001, -3.1000000000000014, -4.899999999999996, -4.099999999999998, -3.4000000000000004, -4.299999999999997, -3.4000000000000004, -5.000000000000002, -5.1000000000000005, -3.5999999999999996, -4.1999999999999975, -3.6999999999999993, -3.1000000000000014, -3.5999999999999996, -4.099999999999998, -2.600000000000002, -3.0000000000000018, -2.700000000000002, -2.4000000000000017, -3.6999999999999993, -3.6999999999999993, -5.399999999999993, -3.8999999999999995, -3.5, -4.899999999999995, -3.3000000000000007, -4.599999999999996, -3.6999999999999993, -3.3000000000000007, -4.1999999999999975, -3.1000000000000014, -3.799999999999999, -4.899999999999995, -3.8999999999999986, -6.499999999999996, -3.4000000000000004, -20.90000000000004, -3.4000000000000004, -3.5999999999999996, -3.0000000000000018, -4.3, -4.1, -4.099999999999998, -4.4999999999999964, -3.6999999999999993, -4.1999999999999975, -4.199999999999998, -3.799999999999999, -3.3000000000000007, -3.5, -4.799999999999997, -3.3000000000000007, -2.4000000000000017, -3.8999999999999986, -3.200000000000001, -3.200000000000001, -3.0000000000000018, -2.800000000000002, -4.099999999999998, -3.200000000000001, -6.8000000000000025, -2.4000000000000017, -3.1000000000000014, -3.6999999999999993, -3.200000000000001, -3.9999999999999982, -4.6, -3.1000000000000014, -3.3000000000000007, -14.899999999999965, -3.1000000000000014, -3.0000000000000018, -2.600000000000002, -3.5, -3.9999999999999982, -2.600000000000002, -4.599999999999996, -2.600000000000002, -3.1000000000000014, -4.299999999999997, -2.600000000000002, -3.5999999999999996], "episode_lengths": [46, 43, 54, 53, 52, 43, 48, 53, 36, 43, 57, 51, 41, 58, 36, 52, 30, 53, 62, 42, 59, 52, 45, 54, 45, 53, 55, 47, 53, 48, 42, 47, 52, 37, 41, 38, 35, 48, 48, 65, 49, 46, 60, 44, 57, 48, 44, 53, 42, 49, 60, 50, 69, 45, 220, 45, 47, 41, 51, 50, 52, 56, 48, 53, 52, 42, 44, 46, 57, 44, 35, 50, 43, 43, 41, 39, 52, 43, 60, 35, 42, 48, 43, 51, 53, 42, 44, 130, 42, 41, 37, 46, 51, 37, 57, 37, 42, 54, 37, 47]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2869269749384594, "mean_inference_ms": 0.7830761805380567, "mean_action_processing_ms": 0.08187414032893427, "mean_env_wait_ms": 6.829474891302823, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008058309555053711, "StateBufferConnector_ms": 0.004435300827026367, "ViewRequirementAgentConnector_ms": 0.10549378395080566}, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 136000, "num_agent_steps_trained": 136000, "num_env_steps_sampled": 136000, "num_env_steps_trained": 136000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 360.60034660346446, "num_env_steps_trained_throughput_per_sec": 360.60034660346446, "timesteps_total": 136000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 136000, "timers": {"training_iteration_time_ms": 10633.434, "sample_time_ms": 6102.362, "load_time_ms": 1.342, "load_throughput": 2979808.536, "learn_time_ms": 4524.878, "learn_throughput": 884.002, "synch_weights_time_ms": 4.044}, "counters": {"num_env_steps_sampled": 136000, "num_env_steps_trained": 136000, "num_agent_steps_sampled": 136000, "num_agent_steps_trained": 136000}, "done": false, "episodes_total": 1101, "training_iteration": 34, "trial_id": "b7012_00000", "date": "2024-03-07_12-45-32", "timestamp": 1709833532, "time_this_iter_s": 11.096261262893677, "time_total_s": 327.3098590373993, "pid": 109767, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4d85689f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 327.3098590373993, "iterations_since_restore": 34, "perf": {"cpu_util_percent": 35.86000000000001, "ram_util_percent": 57.53333333333333, "gpu_util_percent0": 0.13133333333333333, "vram_util_percent0": 0.1336480034722222}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.10000000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 1.3113911907353828, "policy_loss": -0.008766446430836954, "vf_loss": 1.3189997975343979, "vf_explained_var": 0.624250848767578, "kl": 0.011578406408015662, "entropy": 0.6791297790183816, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 32085.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 140000, "num_env_steps_trained": 140000, "num_agent_steps_sampled": 140000, "num_agent_steps_trained": 140000}, "sampler_results": {"episode_reward_max": -1.9000000000000012, "episode_reward_min": -15.499999999999972, "episode_reward_mean": -3.903999999999999, "episode_len_mean": 47.4, "episode_media": {}, "episodes_this_iter": 82, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.200000000000001, -3.9999999999999982, -4.6, -3.1000000000000014, -3.3000000000000007, -14.899999999999965, -3.1000000000000014, -3.0000000000000018, -2.600000000000002, -3.5, -3.9999999999999982, -2.600000000000002, -4.599999999999996, -2.600000000000002, -3.1000000000000014, -4.299999999999997, -2.600000000000002, -3.5999999999999996, -3.5999999999999996, -3.200000000000001, -2.700000000000002, -2.700000000000002, -3.1000000000000014, -2.900000000000002, -2.2000000000000015, -2.600000000000002, -3.5, -3.4000000000000004, -3.5999999999999996, -3.3000000000000007, -2.3000000000000016, -2.5000000000000018, -2.800000000000002, -3.799999999999999, -3.799999999999999, -3.200000000000001, -2.2000000000000015, -3.5999999999999996, -3.3000000000000007, -3.0000000000000018, -4.299999999999997, -2.5000000000000018, -2.4000000000000017, -2.700000000000002, -3.1000000000000014, -4.099999999999999, -3.1000000000000014, -3.1000000000000014, -3.5, -3.4000000000000004, -3.5, -3.799999999999999, -2.600000000000002, -2.800000000000002, -2.800000000000002, -2.3000000000000016, -4.599999999999996, -3.8999999999999995, -4.399999999999997, -3.6999999999999993, -3.5999999999999996, -15.499999999999972, -3.200000000000001, -4.4999999999999964, -4.499999999999998, -13.49999999999998, -4.799999999999995, -3.0000000000000018, -3.3000000000000007, -2.900000000000002, -3.9999999999999982, -3.4000000000000004, -2.900000000000002, -3.200000000000001, -3.799999999999999, -7.400000000000002, -2.900000000000002, -3.0000000000000018, -3.3000000000000007, -4.899999999999998, -3.4000000000000004, -2.1000000000000014, -5.599999999999996, -3.6999999999999993, -6.6000000000000005, -3.4000000000000004, -3.799999999999999, -15.29999999999998, -2.2000000000000015, -1.9000000000000012, -10.399999999999984, -2.4000000000000017, -3.0000000000000018, -2.4000000000000017, -3.5, -3.3000000000000007, -3.500000000000001, -3.200000000000001, -3.200000000000001, -3.3000000000000007], "episode_lengths": [43, 51, 53, 42, 44, 130, 42, 41, 37, 46, 51, 37, 57, 37, 42, 54, 37, 47, 47, 43, 38, 38, 42, 40, 33, 37, 46, 45, 47, 44, 34, 36, 39, 49, 49, 43, 33, 47, 44, 41, 54, 36, 35, 38, 42, 51, 42, 42, 46, 42, 46, 49, 37, 39, 39, 34, 57, 49, 55, 48, 47, 109, 43, 51, 54, 104, 59, 41, 44, 40, 51, 45, 40, 42, 49, 67, 38, 41, 44, 57, 45, 32, 63, 48, 64, 45, 49, 107, 33, 30, 96, 35, 41, 35, 46, 44, 44, 43, 43, 44]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.28964990313310074, "mean_inference_ms": 0.783510012989305, "mean_action_processing_ms": 0.0818245165199423, "mean_env_wait_ms": 6.851984886981334, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0075836181640625, "StateBufferConnector_ms": 0.004042387008666992, "ViewRequirementAgentConnector_ms": 0.09768533706665039}}, "episode_reward_max": -1.9000000000000012, "episode_reward_min": -15.499999999999972, "episode_reward_mean": -3.903999999999999, "episode_len_mean": 47.4, "episodes_this_iter": 82, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3.200000000000001, -3.9999999999999982, -4.6, -3.1000000000000014, -3.3000000000000007, -14.899999999999965, -3.1000000000000014, -3.0000000000000018, -2.600000000000002, -3.5, -3.9999999999999982, -2.600000000000002, -4.599999999999996, -2.600000000000002, -3.1000000000000014, -4.299999999999997, -2.600000000000002, -3.5999999999999996, -3.5999999999999996, -3.200000000000001, -2.700000000000002, -2.700000000000002, -3.1000000000000014, -2.900000000000002, -2.2000000000000015, -2.600000000000002, -3.5, -3.4000000000000004, -3.5999999999999996, -3.3000000000000007, -2.3000000000000016, -2.5000000000000018, -2.800000000000002, -3.799999999999999, -3.799999999999999, -3.200000000000001, -2.2000000000000015, -3.5999999999999996, -3.3000000000000007, -3.0000000000000018, -4.299999999999997, -2.5000000000000018, -2.4000000000000017, -2.700000000000002, -3.1000000000000014, -4.099999999999999, -3.1000000000000014, -3.1000000000000014, -3.5, -3.4000000000000004, -3.5, -3.799999999999999, -2.600000000000002, -2.800000000000002, -2.800000000000002, -2.3000000000000016, -4.599999999999996, -3.8999999999999995, -4.399999999999997, -3.6999999999999993, -3.5999999999999996, -15.499999999999972, -3.200000000000001, -4.4999999999999964, -4.499999999999998, -13.49999999999998, -4.799999999999995, -3.0000000000000018, -3.3000000000000007, -2.900000000000002, -3.9999999999999982, -3.4000000000000004, -2.900000000000002, -3.200000000000001, -3.799999999999999, -7.400000000000002, -2.900000000000002, -3.0000000000000018, -3.3000000000000007, -4.899999999999998, -3.4000000000000004, -2.1000000000000014, -5.599999999999996, -3.6999999999999993, -6.6000000000000005, -3.4000000000000004, -3.799999999999999, -15.29999999999998, -2.2000000000000015, -1.9000000000000012, -10.399999999999984, -2.4000000000000017, -3.0000000000000018, -2.4000000000000017, -3.5, -3.3000000000000007, -3.500000000000001, -3.200000000000001, -3.200000000000001, -3.3000000000000007], "episode_lengths": [43, 51, 53, 42, 44, 130, 42, 41, 37, 46, 51, 37, 57, 37, 42, 54, 37, 47, 47, 43, 38, 38, 42, 40, 33, 37, 46, 45, 47, 44, 34, 36, 39, 49, 49, 43, 33, 47, 44, 41, 54, 36, 35, 38, 42, 51, 42, 42, 46, 42, 46, 49, 37, 39, 39, 34, 57, 49, 55, 48, 47, 109, 43, 51, 54, 104, 59, 41, 44, 40, 51, 45, 40, 42, 49, 67, 38, 41, 44, 57, 45, 32, 63, 48, 64, 45, 49, 107, 33, 30, 96, 35, 41, 35, 46, 44, 44, 43, 43, 44]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.28964990313310074, "mean_inference_ms": 0.783510012989305, "mean_action_processing_ms": 0.0818245165199423, "mean_env_wait_ms": 6.851984886981334, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0075836181640625, "StateBufferConnector_ms": 0.004042387008666992, "ViewRequirementAgentConnector_ms": 0.09768533706665039}, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 140000, "num_agent_steps_trained": 140000, "num_env_steps_sampled": 140000, "num_env_steps_trained": 140000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 397.85802089181846, "num_env_steps_trained_throughput_per_sec": 397.85802089181846, "timesteps_total": 140000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 140000, "timers": {"training_iteration_time_ms": 10691.379, "sample_time_ms": 6160.005, "load_time_ms": 1.273, "load_throughput": 3143036.775, "learn_time_ms": 4525.24, "learn_throughput": 883.931, "synch_weights_time_ms": 4.057}, "counters": {"num_env_steps_sampled": 140000, "num_env_steps_trained": 140000, "num_agent_steps_sampled": 140000, "num_agent_steps_trained": 140000}, "done": false, "episodes_total": 1183, "training_iteration": 35, "trial_id": "b7012_00000", "date": "2024-03-07_12-45-42", "timestamp": 1709833542, "time_this_iter_s": 10.056601285934448, "time_total_s": 337.36646032333374, "pid": 109767, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4d85689f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 337.36646032333374, "iterations_since_restore": 35, "perf": {"cpu_util_percent": 31.638461538461534, "ram_util_percent": 55.48461538461538, "gpu_util_percent0": 0.16538461538461538, "vram_util_percent0": 0.1326184395032051}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.10000000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 0.9521823293471556, "policy_loss": -0.01382866602050521, "vf_loss": 0.9653183743367673, "vf_explained_var": 0.6973110480334169, "kl": 0.0069262573272444875, "entropy": 0.6480789986348922, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 33015.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_agent_steps_sampled": 144000, "num_agent_steps_trained": 144000}, "sampler_results": {"episode_reward_max": -1.9000000000000012, "episode_reward_min": -57.70000000000031, "episode_reward_mean": -4.317000000000003, "episode_len_mean": 50.39, "episode_media": {}, "episodes_this_iter": 79, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4.899999999999998, -3.4000000000000004, -2.1000000000000014, -5.599999999999996, -3.6999999999999993, -6.6000000000000005, -3.4000000000000004, -3.799999999999999, -15.29999999999998, -2.2000000000000015, -1.9000000000000012, -10.399999999999984, -2.4000000000000017, -3.0000000000000018, -2.4000000000000017, -3.5, -3.3000000000000007, -3.500000000000001, -3.200000000000001, -3.200000000000001, -3.3000000000000007, -3.5999999999999996, -2.600000000000002, -3.0000000000000018, -4.599999999999996, -2.3000000000000016, -4.599999999999998, -3.4000000000000004, -4.799999999999995, -3.5, -3.5999999999999996, -2.900000000000002, -4.1999999999999975, -4.299999999999999, -3.0000000000000018, -3.0000000000000018, -3.3000000000000007, -2.2000000000000015, -3.1000000000000014, -4.4999999999999964, -4.1, -3.6999999999999993, -4.799999999999997, -5.300000000000001, -3.700000000000002, -2.700000000000002, -3.5999999999999996, -3.6999999999999993, -3.400000000000002, -57.70000000000031, -3.0000000000000018, -3.5, -2.900000000000002, -5.599999999999997, -3.5, -3.5999999999999996, -3.5, -2.4000000000000017, -2.2000000000000015, -3.3000000000000007, -3.4000000000000004, -3.1000000000000014, -5.200000000000001, -3.200000000000001, -3.6999999999999993, -3.3000000000000007, -3.200000000000001, -3.6999999999999993, -3.9999999999999982, -3.200000000000001, -3.5, -2.700000000000002, -2.600000000000002, -3.799999999999999, -3.5, -3.3000000000000007, -3.0000000000000018, -2.900000000000002, -2.900000000000002, -3.5999999999999996, -2.4000000000000017, -3.8999999999999986, -8.59999999999999, -2.5000000000000018, -3.0000000000000018, -3.3000000000000007, -3.8999999999999986, -3.3000000000000007, -3.200000000000001, -4.100000000000001, -2.700000000000002, -3.799999999999999, -3.8999999999999986, -3.1000000000000014, -3.5, -3.4000000000000004, -3.6999999999999993, -3.500000000000001, -4.099999999999998, -10.199999999999987], "episode_lengths": [57, 45, 32, 63, 48, 64, 45, 49, 107, 33, 30, 96, 35, 41, 35, 46, 44, 44, 43, 43, 44, 47, 37, 41, 57, 33, 55, 45, 59, 46, 47, 40, 53, 52, 41, 41, 44, 33, 42, 56, 50, 48, 57, 52, 42, 38, 47, 48, 43, 389, 41, 46, 40, 62, 46, 47, 46, 35, 33, 44, 45, 42, 55, 43, 48, 44, 43, 48, 51, 43, 46, 38, 37, 49, 46, 44, 41, 40, 40, 47, 35, 50, 81, 36, 41, 44, 50, 44, 42, 48, 38, 49, 50, 42, 46, 45, 48, 45, 52, 96]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.29135923221297355, "mean_inference_ms": 0.7823310163750332, "mean_action_processing_ms": 0.08182125126951063, "mean_env_wait_ms": 6.859863407715775, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007049083709716797, "StateBufferConnector_ms": 0.003869295120239258, "ViewRequirementAgentConnector_ms": 0.0920112133026123}}, "episode_reward_max": -1.9000000000000012, "episode_reward_min": -57.70000000000031, "episode_reward_mean": -4.317000000000003, "episode_len_mean": 50.39, "episodes_this_iter": 79, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-4.899999999999998, -3.4000000000000004, -2.1000000000000014, -5.599999999999996, -3.6999999999999993, -6.6000000000000005, -3.4000000000000004, -3.799999999999999, -15.29999999999998, -2.2000000000000015, -1.9000000000000012, -10.399999999999984, -2.4000000000000017, -3.0000000000000018, -2.4000000000000017, -3.5, -3.3000000000000007, -3.500000000000001, -3.200000000000001, -3.200000000000001, -3.3000000000000007, -3.5999999999999996, -2.600000000000002, -3.0000000000000018, -4.599999999999996, -2.3000000000000016, -4.599999999999998, -3.4000000000000004, -4.799999999999995, -3.5, -3.5999999999999996, -2.900000000000002, -4.1999999999999975, -4.299999999999999, -3.0000000000000018, -3.0000000000000018, -3.3000000000000007, -2.2000000000000015, -3.1000000000000014, -4.4999999999999964, -4.1, -3.6999999999999993, -4.799999999999997, -5.300000000000001, -3.700000000000002, -2.700000000000002, -3.5999999999999996, -3.6999999999999993, -3.400000000000002, -57.70000000000031, -3.0000000000000018, -3.5, -2.900000000000002, -5.599999999999997, -3.5, -3.5999999999999996, -3.5, -2.4000000000000017, -2.2000000000000015, -3.3000000000000007, -3.4000000000000004, -3.1000000000000014, -5.200000000000001, -3.200000000000001, -3.6999999999999993, -3.3000000000000007, -3.200000000000001, -3.6999999999999993, -3.9999999999999982, -3.200000000000001, -3.5, -2.700000000000002, -2.600000000000002, -3.799999999999999, -3.5, -3.3000000000000007, -3.0000000000000018, -2.900000000000002, -2.900000000000002, -3.5999999999999996, -2.4000000000000017, -3.8999999999999986, -8.59999999999999, -2.5000000000000018, -3.0000000000000018, -3.3000000000000007, -3.8999999999999986, -3.3000000000000007, -3.200000000000001, -4.100000000000001, -2.700000000000002, -3.799999999999999, -3.8999999999999986, -3.1000000000000014, -3.5, -3.4000000000000004, -3.6999999999999993, -3.500000000000001, -4.099999999999998, -10.199999999999987], "episode_lengths": [57, 45, 32, 63, 48, 64, 45, 49, 107, 33, 30, 96, 35, 41, 35, 46, 44, 44, 43, 43, 44, 47, 37, 41, 57, 33, 55, 45, 59, 46, 47, 40, 53, 52, 41, 41, 44, 33, 42, 56, 50, 48, 57, 52, 42, 38, 47, 48, 43, 389, 41, 46, 40, 62, 46, 47, 46, 35, 33, 44, 45, 42, 55, 43, 48, 44, 43, 48, 51, 43, 46, 38, 37, 49, 46, 44, 41, 40, 40, 47, 35, 50, 81, 36, 41, 44, 50, 44, 42, 48, 38, 49, 50, 42, 46, 45, 48, 45, 52, 96]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.29135923221297355, "mean_inference_ms": 0.7823310163750332, "mean_action_processing_ms": 0.08182125126951063, "mean_env_wait_ms": 6.859863407715775, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007049083709716797, "StateBufferConnector_ms": 0.003869295120239258, "ViewRequirementAgentConnector_ms": 0.0920112133026123}, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 144000, "num_agent_steps_trained": 144000, "num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 428.3508383346316, "num_env_steps_trained_throughput_per_sec": 428.3508383346316, "timesteps_total": 144000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 144000, "timers": {"training_iteration_time_ms": 10696.929, "sample_time_ms": 6188.242, "load_time_ms": 1.271, "load_throughput": 3147754.367, "learn_time_ms": 4502.519, "learn_throughput": 888.392, "synch_weights_time_ms": 4.087}, "counters": {"num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_agent_steps_sampled": 144000, "num_agent_steps_trained": 144000}, "done": false, "episodes_total": 1262, "training_iteration": 36, "trial_id": "b7012_00000", "date": "2024-03-07_12-45-52", "timestamp": 1709833552, "time_this_iter_s": 9.340747117996216, "time_total_s": 346.70720744132996, "pid": 109767, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4d85689f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 346.70720744132996, "iterations_since_restore": 36, "perf": {"cpu_util_percent": 29.591666666666665, "ram_util_percent": 52.66666666666666, "gpu_util_percent0": 0.09249999999999999, "vram_util_percent0": 0.1329345703125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.10000000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 0.4403467735850192, "policy_loss": -0.013138901760240877, "vf_loss": 0.452505035001424, "vf_explained_var": 0.8041998033241559, "kl": 0.009806406543679778, "entropy": 0.6468402058847489, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 33945.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 148000, "num_env_steps_trained": 148000, "num_agent_steps_sampled": 148000, "num_agent_steps_trained": 148000}, "sampler_results": {"episode_reward_max": -2.2000000000000015, "episode_reward_min": -25.600000000000104, "episode_reward_mean": -3.8520000000000016, "episode_len_mean": 48.03, "episode_media": {}, "episodes_this_iter": 86, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.8999999999999986, -3.3000000000000007, -3.200000000000001, -4.100000000000001, -2.700000000000002, -3.799999999999999, -3.8999999999999986, -3.1000000000000014, -3.5, -3.4000000000000004, -3.6999999999999993, -3.500000000000001, -4.099999999999998, -10.199999999999987, -4.4999999999999964, -2.700000000000002, -4.200000000000002, -3.0000000000000018, -3.5, -3.1000000000000014, -3.0000000000000018, -2.900000000000002, -2.4000000000000017, -2.900000000000002, -3.8999999999999986, -2.2000000000000015, -3.3000000000000007, -2.900000000000002, -3.3000000000000007, -2.900000000000002, -3.5999999999999996, -3.9999999999999982, -13.199999999999976, -3.8999999999999986, -3.1000000000000014, -3.3000000000000007, -3.6999999999999993, -4.8000000000000025, -2.800000000000002, -3.0000000000000018, -3.4000000000000004, -4.500000000000002, -3.0000000000000018, -4.799999999999997, -4.099999999999998, -2.800000000000002, -4.1999999999999975, -3.8999999999999986, -5.400000000000004, -3.1000000000000014, -2.4000000000000017, -3.9000000000000012, -3.4000000000000004, -3.5, -3.5, -3.4000000000000004, -3.5, -3.0000000000000018, -3.0000000000000018, -3.0000000000000018, -3.200000000000001, -3.0000000000000018, -3.9999999999999982, -2.700000000000002, -3.5, -3.4000000000000004, -3.500000000000001, -4.999999999999995, -3.799999999999999, -2.900000000000002, -3.799999999999999, -4.1999999999999975, -4.199999999999998, -4.1999999999999975, -2.700000000000002, -4.900000000000001, -3.799999999999999, -3.5999999999999996, -3.8000000000000016, -3.0000000000000018, -2.3000000000000016, -3.200000000000001, -2.4000000000000017, -3.3000000000000007, -3.200000000000001, -3.5999999999999996, -2.900000000000002, -25.600000000000104, -3.799999999999999, -3.700000000000001, -4.299999999999997, -2.900000000000002, -3.200000000000001, -3.799999999999999, -3.9999999999999982, -2.900000000000002, -3.200000000000001, -2.5000000000000018, -3.3000000000000007, -3.5999999999999996], "episode_lengths": [50, 44, 42, 48, 38, 49, 50, 42, 46, 45, 48, 45, 52, 96, 56, 38, 48, 41, 46, 42, 41, 40, 35, 40, 50, 33, 44, 40, 44, 40, 47, 51, 128, 50, 42, 44, 48, 51, 39, 41, 45, 49, 41, 57, 52, 39, 53, 50, 53, 39, 35, 47, 45, 46, 46, 45, 46, 41, 41, 41, 43, 41, 51, 38, 46, 45, 44, 61, 49, 40, 49, 53, 52, 53, 38, 51, 49, 47, 46, 41, 34, 43, 35, 44, 37, 47, 40, 219, 49, 46, 54, 40, 43, 49, 51, 40, 43, 36, 44, 47]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2931598099492664, "mean_inference_ms": 0.7804321335441122, "mean_action_processing_ms": 0.0816869784714565, "mean_env_wait_ms": 6.8652108762973265, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00671839714050293, "StateBufferConnector_ms": 0.0036253929138183594, "ViewRequirementAgentConnector_ms": 0.0889894962310791}}, "episode_reward_max": -2.2000000000000015, "episode_reward_min": -25.600000000000104, "episode_reward_mean": -3.8520000000000016, "episode_len_mean": 48.03, "episodes_this_iter": 86, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3.8999999999999986, -3.3000000000000007, -3.200000000000001, -4.100000000000001, -2.700000000000002, -3.799999999999999, -3.8999999999999986, -3.1000000000000014, -3.5, -3.4000000000000004, -3.6999999999999993, -3.500000000000001, -4.099999999999998, -10.199999999999987, -4.4999999999999964, -2.700000000000002, -4.200000000000002, -3.0000000000000018, -3.5, -3.1000000000000014, -3.0000000000000018, -2.900000000000002, -2.4000000000000017, -2.900000000000002, -3.8999999999999986, -2.2000000000000015, -3.3000000000000007, -2.900000000000002, -3.3000000000000007, -2.900000000000002, -3.5999999999999996, -3.9999999999999982, -13.199999999999976, -3.8999999999999986, -3.1000000000000014, -3.3000000000000007, -3.6999999999999993, -4.8000000000000025, -2.800000000000002, -3.0000000000000018, -3.4000000000000004, -4.500000000000002, -3.0000000000000018, -4.799999999999997, -4.099999999999998, -2.800000000000002, -4.1999999999999975, -3.8999999999999986, -5.400000000000004, -3.1000000000000014, -2.4000000000000017, -3.9000000000000012, -3.4000000000000004, -3.5, -3.5, -3.4000000000000004, -3.5, -3.0000000000000018, -3.0000000000000018, -3.0000000000000018, -3.200000000000001, -3.0000000000000018, -3.9999999999999982, -2.700000000000002, -3.5, -3.4000000000000004, -3.500000000000001, -4.999999999999995, -3.799999999999999, -2.900000000000002, -3.799999999999999, -4.1999999999999975, -4.199999999999998, -4.1999999999999975, -2.700000000000002, -4.900000000000001, -3.799999999999999, -3.5999999999999996, -3.8000000000000016, -3.0000000000000018, -2.3000000000000016, -3.200000000000001, -2.4000000000000017, -3.3000000000000007, -3.200000000000001, -3.5999999999999996, -2.900000000000002, -25.600000000000104, -3.799999999999999, -3.700000000000001, -4.299999999999997, -2.900000000000002, -3.200000000000001, -3.799999999999999, -3.9999999999999982, -2.900000000000002, -3.200000000000001, -2.5000000000000018, -3.3000000000000007, -3.5999999999999996], "episode_lengths": [50, 44, 42, 48, 38, 49, 50, 42, 46, 45, 48, 45, 52, 96, 56, 38, 48, 41, 46, 42, 41, 40, 35, 40, 50, 33, 44, 40, 44, 40, 47, 51, 128, 50, 42, 44, 48, 51, 39, 41, 45, 49, 41, 57, 52, 39, 53, 50, 53, 39, 35, 47, 45, 46, 46, 45, 46, 41, 41, 41, 43, 41, 51, 38, 46, 45, 44, 61, 49, 40, 49, 53, 52, 53, 38, 51, 49, 47, 46, 41, 34, 43, 35, 44, 37, 47, 40, 219, 49, 46, 54, 40, 43, 49, 51, 40, 43, 36, 44, 47]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2931598099492664, "mean_inference_ms": 0.7804321335441122, "mean_action_processing_ms": 0.0816869784714565, "mean_env_wait_ms": 6.8652108762973265, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00671839714050293, "StateBufferConnector_ms": 0.0036253929138183594, "ViewRequirementAgentConnector_ms": 0.0889894962310791}, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 148000, "num_agent_steps_trained": 148000, "num_env_steps_sampled": 148000, "num_env_steps_trained": 148000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 435.23120786273176, "num_env_steps_trained_throughput_per_sec": 435.23120786273176, "timesteps_total": 148000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 148000, "timers": {"training_iteration_time_ms": 10660.579, "sample_time_ms": 6211.43, "load_time_ms": 1.271, "load_throughput": 3147163.894, "learn_time_ms": 4443.204, "learn_throughput": 900.251, "synch_weights_time_ms": 3.904}, "counters": {"num_env_steps_sampled": 148000, "num_env_steps_trained": 148000, "num_agent_steps_sampled": 148000, "num_agent_steps_trained": 148000}, "done": false, "episodes_total": 1348, "training_iteration": 37, "trial_id": "b7012_00000", "date": "2024-03-07_12-46-01", "timestamp": 1709833561, "time_this_iter_s": 9.193125009536743, "time_total_s": 355.9003324508667, "pid": 109767, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4d85689f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 355.9003324508667, "iterations_since_restore": 37, "perf": {"cpu_util_percent": 28.609090909090913, "ram_util_percent": 52.20909090909092, "gpu_util_percent0": 0.08727272727272727, "vram_util_percent0": 0.13292347301136362}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.10000000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 1.2138147842893827, "policy_loss": -0.0009519931209343736, "vf_loss": 1.2140326464929247, "vf_explained_var": 0.7596858918025929, "kl": 0.0073413333205716545, "entropy": 0.567176394565131, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 34875.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 152000, "num_env_steps_trained": 152000, "num_agent_steps_sampled": 152000, "num_agent_steps_trained": 152000}, "sampler_results": {"episode_reward_max": -1.8000000000000012, "episode_reward_min": -75.50000000000054, "episode_reward_mean": -4.276000000000007, "episode_len_mean": 48.96, "episode_media": {}, "episodes_this_iter": 85, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.5999999999999996, -2.900000000000002, -25.600000000000104, -3.799999999999999, -3.700000000000001, -4.299999999999997, -2.900000000000002, -3.200000000000001, -3.799999999999999, -3.9999999999999982, -2.900000000000002, -3.200000000000001, -2.5000000000000018, -3.3000000000000007, -3.5999999999999996, -3.500000000000001, -3.6999999999999993, -3.1000000000000014, -2.600000000000002, -3.700000000000001, -3.1000000000000014, -3.5, -3.1000000000000014, -3.6999999999999993, -2.800000000000002, -4.199999999999999, -2.800000000000002, -3.200000000000001, -2.900000000000002, -3.4000000000000004, -2.5000000000000018, -3.5, -2.5000000000000018, -3.200000000000001, -3.5999999999999996, -2.700000000000002, -3.4000000000000004, -4.399999999999997, -3.5, -2.900000000000002, -3.1000000000000014, -3.5999999999999996, -4.3, -3.4000000000000004, -3.3000000000000007, -3.8999999999999986, -75.50000000000054, -3.6999999999999993, -4.099999999999999, -3.8999999999999986, -2.1000000000000014, -2.4000000000000017, -2.5000000000000018, -3.200000000000001, -2.900000000000002, -2.900000000000002, -3.0000000000000018, -2.900000000000002, -3.8999999999999986, -2.3000000000000016, -8.599999999999989, -4.399999999999997, -2.700000000000002, -2.5000000000000018, -2.5000000000000018, -3.0000000000000018, -3.1000000000000014, -3.1000000000000014, -3.0000000000000018, -3.5, -2.1000000000000014, -8.699999999999994, -4.499999999999998, -1.8000000000000012, -2.5000000000000018, -3.5999999999999996, -3.3000000000000007, -2.800000000000002, -2.800000000000002, -3.8000000000000007, -3.5999999999999996, -2.2000000000000015, -3.1000000000000014, -3.3000000000000007, -2.2000000000000015, -4.899999999999995, -2.800000000000002, -2.700000000000002, -3.1000000000000014, -3.3000000000000007, -2.700000000000002, -3.3000000000000007, -2.900000000000002, -2.800000000000002, -3.6999999999999993, -2.900000000000002, -3.9999999999999982, -3.4000000000000004, -3.0000000000000018, -3.6999999999999993], "episode_lengths": [47, 40, 219, 49, 46, 54, 40, 43, 49, 51, 40, 43, 36, 44, 47, 41, 48, 42, 37, 46, 42, 46, 42, 48, 39, 43, 39, 43, 40, 45, 36, 46, 36, 43, 47, 38, 45, 55, 46, 40, 42, 47, 43, 44, 44, 50, 400, 48, 49, 50, 32, 35, 36, 43, 40, 40, 41, 40, 50, 34, 88, 55, 38, 33, 36, 41, 42, 42, 41, 46, 32, 83, 54, 29, 35, 47, 44, 39, 39, 47, 47, 33, 42, 44, 33, 60, 39, 38, 42, 44, 38, 44, 40, 39, 48, 40, 51, 45, 41, 48]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2947813048708834, "mean_inference_ms": 0.7792095208692641, "mean_action_processing_ms": 0.0814396705249162, "mean_env_wait_ms": 6.879468463318928, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0069544315338134766, "StateBufferConnector_ms": 0.0037152767181396484, "ViewRequirementAgentConnector_ms": 0.08922147750854492}}, "episode_reward_max": -1.8000000000000012, "episode_reward_min": -75.50000000000054, "episode_reward_mean": -4.276000000000007, "episode_len_mean": 48.96, "episodes_this_iter": 85, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3.5999999999999996, -2.900000000000002, -25.600000000000104, -3.799999999999999, -3.700000000000001, -4.299999999999997, -2.900000000000002, -3.200000000000001, -3.799999999999999, -3.9999999999999982, -2.900000000000002, -3.200000000000001, -2.5000000000000018, -3.3000000000000007, -3.5999999999999996, -3.500000000000001, -3.6999999999999993, -3.1000000000000014, -2.600000000000002, -3.700000000000001, -3.1000000000000014, -3.5, -3.1000000000000014, -3.6999999999999993, -2.800000000000002, -4.199999999999999, -2.800000000000002, -3.200000000000001, -2.900000000000002, -3.4000000000000004, -2.5000000000000018, -3.5, -2.5000000000000018, -3.200000000000001, -3.5999999999999996, -2.700000000000002, -3.4000000000000004, -4.399999999999997, -3.5, -2.900000000000002, -3.1000000000000014, -3.5999999999999996, -4.3, -3.4000000000000004, -3.3000000000000007, -3.8999999999999986, -75.50000000000054, -3.6999999999999993, -4.099999999999999, -3.8999999999999986, -2.1000000000000014, -2.4000000000000017, -2.5000000000000018, -3.200000000000001, -2.900000000000002, -2.900000000000002, -3.0000000000000018, -2.900000000000002, -3.8999999999999986, -2.3000000000000016, -8.599999999999989, -4.399999999999997, -2.700000000000002, -2.5000000000000018, -2.5000000000000018, -3.0000000000000018, -3.1000000000000014, -3.1000000000000014, -3.0000000000000018, -3.5, -2.1000000000000014, -8.699999999999994, -4.499999999999998, -1.8000000000000012, -2.5000000000000018, -3.5999999999999996, -3.3000000000000007, -2.800000000000002, -2.800000000000002, -3.8000000000000007, -3.5999999999999996, -2.2000000000000015, -3.1000000000000014, -3.3000000000000007, -2.2000000000000015, -4.899999999999995, -2.800000000000002, -2.700000000000002, -3.1000000000000014, -3.3000000000000007, -2.700000000000002, -3.3000000000000007, -2.900000000000002, -2.800000000000002, -3.6999999999999993, -2.900000000000002, -3.9999999999999982, -3.4000000000000004, -3.0000000000000018, -3.6999999999999993], "episode_lengths": [47, 40, 219, 49, 46, 54, 40, 43, 49, 51, 40, 43, 36, 44, 47, 41, 48, 42, 37, 46, 42, 46, 42, 48, 39, 43, 39, 43, 40, 45, 36, 46, 36, 43, 47, 38, 45, 55, 46, 40, 42, 47, 43, 44, 44, 50, 400, 48, 49, 50, 32, 35, 36, 43, 40, 40, 41, 40, 50, 34, 88, 55, 38, 33, 36, 41, 42, 42, 41, 46, 32, 83, 54, 29, 35, 47, 44, 39, 39, 47, 47, 33, 42, 44, 33, 60, 39, 38, 42, 44, 38, 44, 40, 39, 48, 40, 51, 45, 41, 48]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2947813048708834, "mean_inference_ms": 0.7792095208692641, "mean_action_processing_ms": 0.0814396705249162, "mean_env_wait_ms": 6.879468463318928, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0069544315338134766, "StateBufferConnector_ms": 0.0037152767181396484, "ViewRequirementAgentConnector_ms": 0.08922147750854492}, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 152000, "num_agent_steps_trained": 152000, "num_env_steps_sampled": 152000, "num_env_steps_trained": 152000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 432.70082590710035, "num_env_steps_trained_throughput_per_sec": 432.70082590710035, "timesteps_total": 152000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 152000, "timers": {"training_iteration_time_ms": 10604.572, "sample_time_ms": 6214.009, "load_time_ms": 1.138, "load_throughput": 3513405.931, "learn_time_ms": 4384.738, "learn_throughput": 912.255, "synch_weights_time_ms": 3.925}, "counters": {"num_env_steps_sampled": 152000, "num_env_steps_trained": 152000, "num_agent_steps_sampled": 152000, "num_agent_steps_trained": 152000}, "done": false, "episodes_total": 1433, "training_iteration": 38, "trial_id": "b7012_00000", "date": "2024-03-07_12-46-10", "timestamp": 1709833570, "time_this_iter_s": 9.246835708618164, "time_total_s": 365.14716815948486, "pid": 109767, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4d85689f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 365.14716815948486, "iterations_since_restore": 38, "perf": {"cpu_util_percent": 27.133333333333336, "ram_util_percent": 52.1, "gpu_util_percent0": 0.09499999999999999, "vram_util_percent0": 0.13117811414930558}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.10000000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 0.37401892465729547, "policy_loss": -0.006956452976471635, "vf_loss": 0.38010108538012033, "vf_explained_var": 0.8506552187345361, "kl": 0.008742915481589291, "entropy": 0.5452901943716951, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 35805.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 156000, "num_env_steps_trained": 156000, "num_agent_steps_sampled": 156000, "num_agent_steps_trained": 156000}, "sampler_results": {"episode_reward_max": -1.9000000000000012, "episode_reward_min": -14.09999999999997, "episode_reward_mean": -3.2150000000000007, "episode_len_mean": 42.74, "episode_media": {}, "episodes_this_iter": 94, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.6999999999999993, -2.900000000000002, -3.9999999999999982, -3.4000000000000004, -3.0000000000000018, -3.6999999999999993, -2.4000000000000017, -3.799999999999999, -3.3000000000000007, -2.900000000000002, -2.800000000000002, -2.700000000000002, -2.3000000000000016, -3.0000000000000018, -3.6999999999999993, -4.9999999999999964, -2.800000000000002, -3.4000000000000004, -2.3000000000000016, -1.9000000000000012, -2.600000000000002, -3.1000000000000014, -2.700000000000002, -1.9000000000000012, -3.5, -3.799999999999999, -3.200000000000001, -3.3000000000000007, -3.200000000000001, -3.5999999999999996, -2.5000000000000018, -1.9000000000000012, -3.3000000000000007, -2.3000000000000016, -14.09999999999997, -3.3000000000000007, -3.9000000000000004, -2.3000000000000016, -3.5, -3.200000000000001, -3.3000000000000007, -3.6000000000000014, -3.7, -3.200000000000001, -3.1000000000000014, -3.5999999999999996, -2.1000000000000014, -2.4000000000000017, -2.4000000000000017, -2.900000000000002, -2.3000000000000016, -2.2000000000000015, -3.5999999999999996, -3.799999999999999, -2.700000000000002, -3.5, -3.200000000000001, -3.5, -3.0000000000000018, -2.700000000000002, -1.9000000000000012, -2.700000000000002, -2.700000000000002, -3.200000000000001, -2.800000000000002, -3.3000000000000007, -3.1000000000000014, -3.3000000000000007, -3.0000000000000018, -4.000000000000001, -3.1000000000000014, -3.4000000000000004, -3.3000000000000007, -4.9, -3.1000000000000014, -2.800000000000002, -3.1000000000000014, -2.700000000000002, -2.900000000000002, -3.0000000000000018, -2.600000000000002, -3.0000000000000018, -3.5999999999999996, -2.700000000000002, -3.200000000000001, -2.800000000000002, -3.0000000000000018, -2.2000000000000015, -2.5000000000000018, -3.5, -2.800000000000002, -3.4000000000000004, -3.6999999999999993, -3.1000000000000014, -4.000000000000002, -6.399999999999994, -3.5, -2.0000000000000013, -2.800000000000002, -3.4000000000000004], "episode_lengths": [48, 40, 51, 45, 41, 48, 35, 49, 44, 40, 39, 38, 34, 41, 48, 59, 39, 45, 34, 30, 37, 42, 38, 30, 46, 49, 43, 44, 43, 47, 36, 30, 44, 34, 141, 44, 46, 34, 46, 43, 44, 45, 47, 43, 42, 47, 32, 35, 35, 40, 34, 33, 47, 49, 38, 46, 42, 46, 41, 38, 30, 38, 38, 43, 39, 43, 42, 44, 41, 48, 42, 45, 44, 54, 42, 39, 42, 38, 40, 41, 37, 41, 47, 38, 43, 39, 41, 33, 36, 46, 39, 45, 48, 42, 46, 70, 46, 31, 39, 45]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.29674991457711286, "mean_inference_ms": 0.7770974556547686, "mean_action_processing_ms": 0.08145617644942722, "mean_env_wait_ms": 6.87555600404487, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0067596435546875, "StateBufferConnector_ms": 0.003718852996826172, "ViewRequirementAgentConnector_ms": 0.08835434913635254}}, "episode_reward_max": -1.9000000000000012, "episode_reward_min": -14.09999999999997, "episode_reward_mean": -3.2150000000000007, "episode_len_mean": 42.74, "episodes_this_iter": 94, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3.6999999999999993, -2.900000000000002, -3.9999999999999982, -3.4000000000000004, -3.0000000000000018, -3.6999999999999993, -2.4000000000000017, -3.799999999999999, -3.3000000000000007, -2.900000000000002, -2.800000000000002, -2.700000000000002, -2.3000000000000016, -3.0000000000000018, -3.6999999999999993, -4.9999999999999964, -2.800000000000002, -3.4000000000000004, -2.3000000000000016, -1.9000000000000012, -2.600000000000002, -3.1000000000000014, -2.700000000000002, -1.9000000000000012, -3.5, -3.799999999999999, -3.200000000000001, -3.3000000000000007, -3.200000000000001, -3.5999999999999996, -2.5000000000000018, -1.9000000000000012, -3.3000000000000007, -2.3000000000000016, -14.09999999999997, -3.3000000000000007, -3.9000000000000004, -2.3000000000000016, -3.5, -3.200000000000001, -3.3000000000000007, -3.6000000000000014, -3.7, -3.200000000000001, -3.1000000000000014, -3.5999999999999996, -2.1000000000000014, -2.4000000000000017, -2.4000000000000017, -2.900000000000002, -2.3000000000000016, -2.2000000000000015, -3.5999999999999996, -3.799999999999999, -2.700000000000002, -3.5, -3.200000000000001, -3.5, -3.0000000000000018, -2.700000000000002, -1.9000000000000012, -2.700000000000002, -2.700000000000002, -3.200000000000001, -2.800000000000002, -3.3000000000000007, -3.1000000000000014, -3.3000000000000007, -3.0000000000000018, -4.000000000000001, -3.1000000000000014, -3.4000000000000004, -3.3000000000000007, -4.9, -3.1000000000000014, -2.800000000000002, -3.1000000000000014, -2.700000000000002, -2.900000000000002, -3.0000000000000018, -2.600000000000002, -3.0000000000000018, -3.5999999999999996, -2.700000000000002, -3.200000000000001, -2.800000000000002, -3.0000000000000018, -2.2000000000000015, -2.5000000000000018, -3.5, -2.800000000000002, -3.4000000000000004, -3.6999999999999993, -3.1000000000000014, -4.000000000000002, -6.399999999999994, -3.5, -2.0000000000000013, -2.800000000000002, -3.4000000000000004], "episode_lengths": [48, 40, 51, 45, 41, 48, 35, 49, 44, 40, 39, 38, 34, 41, 48, 59, 39, 45, 34, 30, 37, 42, 38, 30, 46, 49, 43, 44, 43, 47, 36, 30, 44, 34, 141, 44, 46, 34, 46, 43, 44, 45, 47, 43, 42, 47, 32, 35, 35, 40, 34, 33, 47, 49, 38, 46, 42, 46, 41, 38, 30, 38, 38, 43, 39, 43, 42, 44, 41, 48, 42, 45, 44, 54, 42, 39, 42, 38, 40, 41, 37, 41, 47, 38, 43, 39, 41, 33, 36, 46, 39, 45, 48, 42, 46, 70, 46, 31, 39, 45]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.29674991457711286, "mean_inference_ms": 0.7770974556547686, "mean_action_processing_ms": 0.08145617644942722, "mean_env_wait_ms": 6.87555600404487, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0067596435546875, "StateBufferConnector_ms": 0.003718852996826172, "ViewRequirementAgentConnector_ms": 0.08835434913635254}, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 156000, "num_agent_steps_trained": 156000, "num_env_steps_sampled": 156000, "num_env_steps_trained": 156000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 437.2140030621004, "num_env_steps_trained_throughput_per_sec": 437.2140030621004, "timesteps_total": 156000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 156000, "timers": {"training_iteration_time_ms": 10524.445, "sample_time_ms": 6197.392, "load_time_ms": 1.142, "load_throughput": 3502915.962, "learn_time_ms": 4321.221, "learn_throughput": 925.664, "synch_weights_time_ms": 3.941}, "counters": {"num_env_steps_sampled": 156000, "num_env_steps_trained": 156000, "num_agent_steps_sampled": 156000, "num_agent_steps_trained": 156000}, "done": false, "episodes_total": 1527, "training_iteration": 39, "trial_id": "b7012_00000", "date": "2024-03-07_12-46-19", "timestamp": 1709833579, "time_this_iter_s": 9.151670455932617, "time_total_s": 374.2988386154175, "pid": 109767, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4d85689f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 374.2988386154175, "iterations_since_restore": 39, "perf": {"cpu_util_percent": 27.291666666666668, "ram_util_percent": 52.0, "gpu_util_percent0": 0.09833333333333333, "vram_util_percent0": 0.13106960720486108}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.10000000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 0.2911983724064519, "policy_loss": -0.01050687570685661, "vf_loss": 0.3008554542266954, "vf_explained_var": 0.8629958321971278, "kl": 0.008497965247838737, "entropy": 0.5152680639938642, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 36735.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 160000, "num_env_steps_trained": 160000, "num_agent_steps_sampled": 160000, "num_agent_steps_trained": 160000}, "sampler_results": {"episode_reward_max": -1.600000000000001, "episode_reward_min": -11.199999999999973, "episode_reward_mean": -3.0400000000000005, "episode_len_mean": 41.0, "episode_media": {}, "episodes_this_iter": 98, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2.800000000000002, -3.4000000000000004, -3.5999999999999996, -4.200000000000001, -3.5, -3.9999999999999982, -2.4000000000000017, -5.699999999999992, -3.200000000000001, -2.900000000000002, -2.4000000000000017, -2.600000000000002, -4.200000000000002, -2.900000000000002, -2.600000000000002, -3.200000000000001, -2.3000000000000016, -2.900000000000002, -3.1000000000000014, -2.0000000000000013, -3.4000000000000004, -2.3000000000000016, -2.0000000000000013, -2.5000000000000018, -2.0000000000000013, -3.5999999999999996, -1.700000000000001, -3.5, -2.5000000000000018, -2.2000000000000015, -3.0000000000000018, -2.0000000000000013, -2.800000000000002, -3.0000000000000018, -3.3000000000000007, -3.5999999999999996, -2.600000000000002, -3.9999999999999982, -3.5999999999999996, -3.799999999999999, -1.8000000000000012, -2.0000000000000013, -3.9000000000000012, -3.6000000000000014, -3.500000000000001, -2.3000000000000016, -3.6999999999999993, -3.200000000000002, -3.1000000000000014, -3.5, -2.700000000000002, -2.900000000000002, -2.1000000000000014, -2.800000000000002, -2.800000000000002, -2.800000000000002, -3.0000000000000018, -2.900000000000002, -3.1000000000000014, -3.3000000000000007, -3.0000000000000018, -3.0000000000000018, -2.800000000000002, -2.700000000000002, -1.700000000000001, -3.0000000000000018, -2.4000000000000017, -2.1000000000000014, -3.1000000000000014, -3.1000000000000014, -2.1000000000000014, -2.600000000000002, -2.5000000000000018, -3.0000000000000018, -2.4000000000000017, -3.4000000000000004, -2.2000000000000015, -3.1000000000000014, -3.4000000000000004, -3.0000000000000018, -2.700000000000002, -2.1000000000000014, -1.600000000000001, -3.5, -2.600000000000002, -3.200000000000001, -3.8999999999999986, -3.6999999999999993, -3.5, -3.8000000000000007, -2.4000000000000017, -2.5000000000000018, -3.200000000000001, -3.1000000000000014, -2.900000000000002, -5.300000000000002, -3.5999999999999996, -2.4000000000000017, -1.9000000000000012, -11.199999999999973], "episode_lengths": [39, 45, 47, 47, 46, 51, 35, 68, 43, 40, 35, 37, 44, 40, 37, 43, 34, 40, 42, 31, 45, 34, 31, 36, 31, 47, 28, 46, 36, 33, 41, 31, 39, 41, 44, 46, 37, 51, 47, 49, 29, 31, 43, 45, 45, 34, 48, 42, 42, 46, 38, 40, 32, 39, 39, 39, 41, 40, 42, 44, 41, 41, 39, 38, 28, 41, 35, 32, 42, 42, 32, 37, 36, 41, 35, 45, 33, 42, 45, 41, 38, 32, 27, 46, 37, 43, 50, 48, 46, 45, 35, 36, 43, 42, 40, 55, 47, 35, 30, 123]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2986206690362692, "mean_inference_ms": 0.775479332194598, "mean_action_processing_ms": 0.08128017859766673, "mean_env_wait_ms": 6.876225219979313, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0068395137786865234, "StateBufferConnector_ms": 0.003658771514892578, "ViewRequirementAgentConnector_ms": 0.0884406566619873}}, "episode_reward_max": -1.600000000000001, "episode_reward_min": -11.199999999999973, "episode_reward_mean": -3.0400000000000005, "episode_len_mean": 41.0, "episodes_this_iter": 98, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-2.800000000000002, -3.4000000000000004, -3.5999999999999996, -4.200000000000001, -3.5, -3.9999999999999982, -2.4000000000000017, -5.699999999999992, -3.200000000000001, -2.900000000000002, -2.4000000000000017, -2.600000000000002, -4.200000000000002, -2.900000000000002, -2.600000000000002, -3.200000000000001, -2.3000000000000016, -2.900000000000002, -3.1000000000000014, -2.0000000000000013, -3.4000000000000004, -2.3000000000000016, -2.0000000000000013, -2.5000000000000018, -2.0000000000000013, -3.5999999999999996, -1.700000000000001, -3.5, -2.5000000000000018, -2.2000000000000015, -3.0000000000000018, -2.0000000000000013, -2.800000000000002, -3.0000000000000018, -3.3000000000000007, -3.5999999999999996, -2.600000000000002, -3.9999999999999982, -3.5999999999999996, -3.799999999999999, -1.8000000000000012, -2.0000000000000013, -3.9000000000000012, -3.6000000000000014, -3.500000000000001, -2.3000000000000016, -3.6999999999999993, -3.200000000000002, -3.1000000000000014, -3.5, -2.700000000000002, -2.900000000000002, -2.1000000000000014, -2.800000000000002, -2.800000000000002, -2.800000000000002, -3.0000000000000018, -2.900000000000002, -3.1000000000000014, -3.3000000000000007, -3.0000000000000018, -3.0000000000000018, -2.800000000000002, -2.700000000000002, -1.700000000000001, -3.0000000000000018, -2.4000000000000017, -2.1000000000000014, -3.1000000000000014, -3.1000000000000014, -2.1000000000000014, -2.600000000000002, -2.5000000000000018, -3.0000000000000018, -2.4000000000000017, -3.4000000000000004, -2.2000000000000015, -3.1000000000000014, -3.4000000000000004, -3.0000000000000018, -2.700000000000002, -2.1000000000000014, -1.600000000000001, -3.5, -2.600000000000002, -3.200000000000001, -3.8999999999999986, -3.6999999999999993, -3.5, -3.8000000000000007, -2.4000000000000017, -2.5000000000000018, -3.200000000000001, -3.1000000000000014, -2.900000000000002, -5.300000000000002, -3.5999999999999996, -2.4000000000000017, -1.9000000000000012, -11.199999999999973], "episode_lengths": [39, 45, 47, 47, 46, 51, 35, 68, 43, 40, 35, 37, 44, 40, 37, 43, 34, 40, 42, 31, 45, 34, 31, 36, 31, 47, 28, 46, 36, 33, 41, 31, 39, 41, 44, 46, 37, 51, 47, 49, 29, 31, 43, 45, 45, 34, 48, 42, 42, 46, 38, 40, 32, 39, 39, 39, 41, 40, 42, 44, 41, 41, 39, 38, 28, 41, 35, 32, 42, 42, 32, 37, 36, 41, 35, 45, 33, 42, 45, 41, 38, 32, 27, 46, 37, 43, 50, 48, 46, 45, 35, 36, 43, 42, 40, 55, 47, 35, 30, 123]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2986206690362692, "mean_inference_ms": 0.775479332194598, "mean_action_processing_ms": 0.08128017859766673, "mean_env_wait_ms": 6.876225219979313, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0068395137786865234, "StateBufferConnector_ms": 0.003658771514892578, "ViewRequirementAgentConnector_ms": 0.0884406566619873}, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 160000, "num_agent_steps_trained": 160000, "num_env_steps_sampled": 160000, "num_env_steps_trained": 160000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 425.48061737185805, "num_env_steps_trained_throughput_per_sec": 425.48061737185805, "timesteps_total": 160000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 160000, "timers": {"training_iteration_time_ms": 10226.236, "sample_time_ms": 6134.987, "load_time_ms": 1.139, "load_throughput": 3512743.871, "learn_time_ms": 4085.536, "learn_throughput": 979.064, "synch_weights_time_ms": 3.856}, "counters": {"num_env_steps_sampled": 160000, "num_env_steps_trained": 160000, "num_agent_steps_sampled": 160000, "num_agent_steps_trained": 160000}, "done": false, "episodes_total": 1625, "training_iteration": 40, "trial_id": "b7012_00000", "date": "2024-03-07_12-46-29", "timestamp": 1709833589, "time_this_iter_s": 9.403635263442993, "time_total_s": 383.7024738788605, "pid": 109767, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4d85689f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 383.7024738788605, "iterations_since_restore": 40, "perf": {"cpu_util_percent": 26.069230769230767, "ram_util_percent": 52.0, "gpu_util_percent0": 0.09384615384615384, "vram_util_percent0": 0.13102839543269232}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.10000000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 0.5833331174848061, "policy_loss": -0.009216980890481062, "vf_loss": 0.5913146365053391, "vf_explained_var": 0.7475770027406754, "kl": 0.012354672218436571, "entropy": 0.49496006715682245, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 37665.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 164000, "num_env_steps_trained": 164000, "num_agent_steps_sampled": 164000, "num_agent_steps_trained": 164000}, "sampler_results": {"episode_reward_max": -1.5000000000000009, "episode_reward_min": -11.199999999999973, "episode_reward_mean": -3.163000000000001, "episode_len_mean": 41.49, "episode_media": {}, "episodes_this_iter": 97, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2.4000000000000017, -1.9000000000000012, -11.199999999999973, -3.5999999999999996, -2.700000000000002, -4.4999999999999964, -3.799999999999999, -3.5999999999999996, -2.700000000000002, -2.900000000000002, -2.900000000000002, -3.5999999999999996, -5.400000000000002, -3.799999999999999, -2.900000000000002, -4.300000000000001, -2.900000000000002, -2.1000000000000014, -1.5000000000000009, -3.5, -3.0000000000000018, -2.700000000000002, -2.600000000000002, -1.700000000000001, -2.5000000000000018, -2.2000000000000015, -2.0000000000000013, -2.900000000000002, -3.6999999999999993, -2.600000000000002, -3.3000000000000007, -9.299999999999994, -3.0000000000000018, -2.0000000000000013, -2.700000000000002, -3.799999999999999, -2.0000000000000013, -3.5999999999999996, -2.1000000000000014, -2.0000000000000013, -3.200000000000001, -2.600000000000002, -2.2000000000000015, -2.800000000000002, -2.600000000000002, -3.5, -2.3000000000000016, -3.200000000000001, -2.4000000000000017, -2.0000000000000013, -2.0000000000000013, -2.0000000000000013, -2.900000000000002, -2.600000000000002, -2.4000000000000017, -3.9999999999999982, -2.800000000000002, -1.8000000000000012, -2.3000000000000016, -2.900000000000002, -3.3000000000000007, -2.800000000000002, -2.900000000000002, -4.100000000000001, -5.8, -3.200000000000001, -3.200000000000001, -2.600000000000002, -1.9000000000000012, -9.499999999999991, -2.0000000000000013, -3.3000000000000007, -2.1000000000000014, -3.3000000000000007, -3.8999999999999986, -2.4000000000000017, -3.8999999999999986, -2.3000000000000016, -2.3000000000000016, -3.3000000000000007, -3.1000000000000014, -2.4000000000000017, -3.8000000000000016, -2.800000000000002, -2.4000000000000017, -3.0000000000000018, -8.000000000000002, -2.4000000000000017, -2.900000000000002, -3.1000000000000014, -3.4000000000000004, -3.0000000000000018, -2.3000000000000016, -1.8000000000000012, -3.0000000000000018, -4.500000000000002, -3.1000000000000014, -3.3000000000000007, -2.900000000000002, -2.600000000000002], "episode_lengths": [35, 30, 123, 47, 38, 56, 49, 47, 38, 40, 40, 47, 50, 49, 40, 50, 40, 32, 26, 46, 41, 38, 37, 28, 36, 33, 31, 40, 48, 37, 44, 76, 41, 31, 38, 49, 31, 47, 32, 31, 43, 37, 33, 39, 37, 46, 34, 43, 35, 31, 31, 31, 40, 37, 35, 51, 39, 29, 34, 40, 44, 39, 40, 48, 60, 43, 43, 37, 30, 86, 31, 44, 32, 44, 50, 35, 50, 34, 34, 44, 42, 35, 46, 39, 35, 41, 67, 35, 40, 42, 45, 41, 34, 29, 41, 50, 42, 43, 40, 37]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3006781799451139, "mean_inference_ms": 0.7746864438624267, "mean_action_processing_ms": 0.08122559195628261, "mean_env_wait_ms": 6.892805733961728, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006951332092285156, "StateBufferConnector_ms": 0.0037796497344970703, "ViewRequirementAgentConnector_ms": 0.09189820289611816}}, "episode_reward_max": -1.5000000000000009, "episode_reward_min": -11.199999999999973, "episode_reward_mean": -3.163000000000001, "episode_len_mean": 41.49, "episodes_this_iter": 97, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-2.4000000000000017, -1.9000000000000012, -11.199999999999973, -3.5999999999999996, -2.700000000000002, -4.4999999999999964, -3.799999999999999, -3.5999999999999996, -2.700000000000002, -2.900000000000002, -2.900000000000002, -3.5999999999999996, -5.400000000000002, -3.799999999999999, -2.900000000000002, -4.300000000000001, -2.900000000000002, -2.1000000000000014, -1.5000000000000009, -3.5, -3.0000000000000018, -2.700000000000002, -2.600000000000002, -1.700000000000001, -2.5000000000000018, -2.2000000000000015, -2.0000000000000013, -2.900000000000002, -3.6999999999999993, -2.600000000000002, -3.3000000000000007, -9.299999999999994, -3.0000000000000018, -2.0000000000000013, -2.700000000000002, -3.799999999999999, -2.0000000000000013, -3.5999999999999996, -2.1000000000000014, -2.0000000000000013, -3.200000000000001, -2.600000000000002, -2.2000000000000015, -2.800000000000002, -2.600000000000002, -3.5, -2.3000000000000016, -3.200000000000001, -2.4000000000000017, -2.0000000000000013, -2.0000000000000013, -2.0000000000000013, -2.900000000000002, -2.600000000000002, -2.4000000000000017, -3.9999999999999982, -2.800000000000002, -1.8000000000000012, -2.3000000000000016, -2.900000000000002, -3.3000000000000007, -2.800000000000002, -2.900000000000002, -4.100000000000001, -5.8, -3.200000000000001, -3.200000000000001, -2.600000000000002, -1.9000000000000012, -9.499999999999991, -2.0000000000000013, -3.3000000000000007, -2.1000000000000014, -3.3000000000000007, -3.8999999999999986, -2.4000000000000017, -3.8999999999999986, -2.3000000000000016, -2.3000000000000016, -3.3000000000000007, -3.1000000000000014, -2.4000000000000017, -3.8000000000000016, -2.800000000000002, -2.4000000000000017, -3.0000000000000018, -8.000000000000002, -2.4000000000000017, -2.900000000000002, -3.1000000000000014, -3.4000000000000004, -3.0000000000000018, -2.3000000000000016, -1.8000000000000012, -3.0000000000000018, -4.500000000000002, -3.1000000000000014, -3.3000000000000007, -2.900000000000002, -2.600000000000002], "episode_lengths": [35, 30, 123, 47, 38, 56, 49, 47, 38, 40, 40, 47, 50, 49, 40, 50, 40, 32, 26, 46, 41, 38, 37, 28, 36, 33, 31, 40, 48, 37, 44, 76, 41, 31, 38, 49, 31, 47, 32, 31, 43, 37, 33, 39, 37, 46, 34, 43, 35, 31, 31, 31, 40, 37, 35, 51, 39, 29, 34, 40, 44, 39, 40, 48, 60, 43, 43, 37, 30, 86, 31, 44, 32, 44, 50, 35, 50, 34, 34, 44, 42, 35, 46, 39, 35, 41, 67, 35, 40, 42, 45, 41, 34, 29, 41, 50, 42, 43, 40, 37]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3006781799451139, "mean_inference_ms": 0.7746864438624267, "mean_action_processing_ms": 0.08122559195628261, "mean_env_wait_ms": 6.892805733961728, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006951332092285156, "StateBufferConnector_ms": 0.0037796497344970703, "ViewRequirementAgentConnector_ms": 0.09189820289611816}, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 164000, "num_agent_steps_trained": 164000, "num_env_steps_sampled": 164000, "num_env_steps_trained": 164000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 414.2121654944056, "num_env_steps_trained_throughput_per_sec": 414.2121654944056, "timesteps_total": 164000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 164000, "timers": {"training_iteration_time_ms": 10046.756, "sample_time_ms": 6041.883, "load_time_ms": 1.041, "load_throughput": 3843841.73, "learn_time_ms": 3999.288, "learn_throughput": 1000.178, "synch_weights_time_ms": 3.828}, "counters": {"num_env_steps_sampled": 164000, "num_env_steps_trained": 164000, "num_agent_steps_sampled": 164000, "num_agent_steps_trained": 164000}, "done": false, "episodes_total": 1722, "training_iteration": 41, "trial_id": "b7012_00000", "date": "2024-03-07_12-46-38", "timestamp": 1709833598, "time_this_iter_s": 9.65958023071289, "time_total_s": 393.36205410957336, "pid": 109767, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4d85689f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 393.36205410957336, "iterations_since_restore": 41, "perf": {"cpu_util_percent": 29.21666666666667, "ram_util_percent": 52.06666666666667, "gpu_util_percent0": 0.125, "vram_util_percent0": 0.12721761067708334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.10000000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 0.352150954769033, "policy_loss": -0.006929666402133843, "vf_loss": 0.35780604697703833, "vf_explained_var": 0.8372991247843671, "kl": 0.012745740804329173, "entropy": 0.4718141628849891, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 38595.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 168000, "num_env_steps_trained": 168000, "num_agent_steps_sampled": 168000, "num_agent_steps_trained": 168000}, "sampler_results": {"episode_reward_max": -1.4000000000000008, "episode_reward_min": -25.100000000000037, "episode_reward_mean": -3.0640000000000014, "episode_len_mean": 40.79, "episode_media": {}, "episodes_this_iter": 100, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.3000000000000007, -3.1000000000000014, -3.1000000000000014, -25.100000000000037, -3.4000000000000004, -2.800000000000002, -2.3000000000000016, -2.3000000000000016, -2.800000000000002, -2.700000000000002, -3.1000000000000014, -3.200000000000001, -3.6000000000000014, -5.599999999999998, -4.599999999999996, -2.700000000000002, -2.5000000000000018, -2.3000000000000016, -3.7, -3.5, -1.9000000000000012, -2.0000000000000013, -2.4000000000000017, -2.3000000000000016, -3.1000000000000014, -2.900000000000002, -3.8999999999999986, -3.200000000000001, -2.700000000000002, -2.900000000000002, -2.800000000000002, -3.3000000000000007, -1.9000000000000012, -2.5000000000000018, -3.4000000000000004, -2.600000000000002, -2.4000000000000017, -2.800000000000002, -3.1000000000000014, -2.2000000000000015, -3.5999999999999996, -2.0000000000000013, -2.3000000000000016, -2.600000000000002, -2.700000000000002, -3.5, -2.600000000000002, -2.700000000000002, -3.200000000000001, -2.900000000000002, -2.1000000000000014, -2.900000000000002, -3.4000000000000004, -3.200000000000001, -2.4000000000000017, -3.200000000000001, -2.3000000000000016, -3.5, -2.1000000000000014, -3.3000000000000007, -2.700000000000002, -3.0000000000000018, -3.3000000000000007, -2.2000000000000015, -2.900000000000002, -3.3000000000000007, -2.800000000000002, -2.800000000000002, -2.4000000000000017, -3.0000000000000018, -3.0000000000000018, -2.2000000000000015, -2.700000000000002, -3.1000000000000014, -3.200000000000001, -3.0000000000000018, -3.200000000000001, -2.700000000000002, -2.700000000000002, -3.4000000000000004, -3.200000000000001, -1.4000000000000008, -1.9000000000000012, -2.0000000000000013, -2.1000000000000014, -1.8000000000000012, -2.900000000000002, -2.800000000000002, -3.3000000000000007, -1.700000000000001, -3.200000000000001, -3.5999999999999996, -2.4000000000000017, -2.4000000000000017, -3.0000000000000018, -3.3000000000000007, -2.600000000000002, -3.1000000000000014, -3.6999999999999993, -1.9000000000000012], "episode_lengths": [43, 42, 42, 192, 45, 39, 34, 34, 39, 38, 42, 43, 45, 61, 57, 38, 36, 34, 47, 46, 30, 31, 35, 34, 42, 40, 50, 43, 37, 39, 39, 44, 30, 36, 45, 37, 35, 39, 42, 33, 47, 31, 34, 37, 38, 46, 37, 38, 43, 40, 32, 40, 43, 43, 35, 43, 34, 46, 32, 44, 38, 41, 44, 33, 39, 44, 39, 39, 35, 41, 41, 33, 38, 42, 43, 41, 43, 38, 38, 45, 43, 25, 30, 31, 32, 29, 40, 39, 44, 28, 43, 47, 35, 35, 41, 44, 37, 42, 48, 30]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3028492801149205, "mean_inference_ms": 0.774112216339983, "mean_action_processing_ms": 0.08120211020145987, "mean_env_wait_ms": 6.903902248302688, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007078886032104492, "StateBufferConnector_ms": 0.0038869380950927734, "ViewRequirementAgentConnector_ms": 0.09309530258178711}}, "episode_reward_max": -1.4000000000000008, "episode_reward_min": -25.100000000000037, "episode_reward_mean": -3.0640000000000014, "episode_len_mean": 40.79, "episodes_this_iter": 100, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3.3000000000000007, -3.1000000000000014, -3.1000000000000014, -25.100000000000037, -3.4000000000000004, -2.800000000000002, -2.3000000000000016, -2.3000000000000016, -2.800000000000002, -2.700000000000002, -3.1000000000000014, -3.200000000000001, -3.6000000000000014, -5.599999999999998, -4.599999999999996, -2.700000000000002, -2.5000000000000018, -2.3000000000000016, -3.7, -3.5, -1.9000000000000012, -2.0000000000000013, -2.4000000000000017, -2.3000000000000016, -3.1000000000000014, -2.900000000000002, -3.8999999999999986, -3.200000000000001, -2.700000000000002, -2.900000000000002, -2.800000000000002, -3.3000000000000007, -1.9000000000000012, -2.5000000000000018, -3.4000000000000004, -2.600000000000002, -2.4000000000000017, -2.800000000000002, -3.1000000000000014, -2.2000000000000015, -3.5999999999999996, -2.0000000000000013, -2.3000000000000016, -2.600000000000002, -2.700000000000002, -3.5, -2.600000000000002, -2.700000000000002, -3.200000000000001, -2.900000000000002, -2.1000000000000014, -2.900000000000002, -3.4000000000000004, -3.200000000000001, -2.4000000000000017, -3.200000000000001, -2.3000000000000016, -3.5, -2.1000000000000014, -3.3000000000000007, -2.700000000000002, -3.0000000000000018, -3.3000000000000007, -2.2000000000000015, -2.900000000000002, -3.3000000000000007, -2.800000000000002, -2.800000000000002, -2.4000000000000017, -3.0000000000000018, -3.0000000000000018, -2.2000000000000015, -2.700000000000002, -3.1000000000000014, -3.200000000000001, -3.0000000000000018, -3.200000000000001, -2.700000000000002, -2.700000000000002, -3.4000000000000004, -3.200000000000001, -1.4000000000000008, -1.9000000000000012, -2.0000000000000013, -2.1000000000000014, -1.8000000000000012, -2.900000000000002, -2.800000000000002, -3.3000000000000007, -1.700000000000001, -3.200000000000001, -3.5999999999999996, -2.4000000000000017, -2.4000000000000017, -3.0000000000000018, -3.3000000000000007, -2.600000000000002, -3.1000000000000014, -3.6999999999999993, -1.9000000000000012], "episode_lengths": [43, 42, 42, 192, 45, 39, 34, 34, 39, 38, 42, 43, 45, 61, 57, 38, 36, 34, 47, 46, 30, 31, 35, 34, 42, 40, 50, 43, 37, 39, 39, 44, 30, 36, 45, 37, 35, 39, 42, 33, 47, 31, 34, 37, 38, 46, 37, 38, 43, 40, 32, 40, 43, 43, 35, 43, 34, 46, 32, 44, 38, 41, 44, 33, 39, 44, 39, 39, 35, 41, 41, 33, 38, 42, 43, 41, 43, 38, 38, 45, 43, 25, 30, 31, 32, 29, 40, 39, 44, 28, 43, 47, 35, 35, 41, 44, 37, 42, 48, 30]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3028492801149205, "mean_inference_ms": 0.774112216339983, "mean_action_processing_ms": 0.08120211020145987, "mean_env_wait_ms": 6.903902248302688, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007078886032104492, "StateBufferConnector_ms": 0.0038869380950927734, "ViewRequirementAgentConnector_ms": 0.09309530258178711}, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 168000, "num_agent_steps_trained": 168000, "num_env_steps_sampled": 168000, "num_env_steps_trained": 168000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 378.2127209400457, "num_env_steps_trained_throughput_per_sec": 378.2127209400457, "timesteps_total": 168000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 168000, "timers": {"training_iteration_time_ms": 9936.572, "sample_time_ms": 5951.38, "load_time_ms": 1.038, "load_throughput": 3854704.531, "learn_time_ms": 3979.9, "learn_throughput": 1005.05, "synch_weights_time_ms": 3.548}, "counters": {"num_env_steps_sampled": 168000, "num_env_steps_trained": 168000, "num_agent_steps_sampled": 168000, "num_agent_steps_trained": 168000}, "done": false, "episodes_total": 1822, "training_iteration": 42, "trial_id": "b7012_00000", "date": "2024-03-07_12-46-49", "timestamp": 1709833609, "time_this_iter_s": 10.578649997711182, "time_total_s": 403.94070410728455, "pid": 109767, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4d85689f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 403.94070410728455, "iterations_since_restore": 42, "perf": {"cpu_util_percent": 31.235714285714288, "ram_util_percent": 52.057142857142864, "gpu_util_percent0": 0.12857142857142856, "vram_util_percent0": 0.12733677455357142}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.10000000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 0.37928742519654934, "policy_loss": -0.0071094828147080635, "vf_loss": 0.38533441756791886, "vf_explained_var": 0.8550384352925003, "kl": 0.010624918342778905, "entropy": 0.4365635555918499, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 39525.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 172000, "num_env_steps_trained": 172000, "num_agent_steps_sampled": 172000, "num_agent_steps_trained": 172000}, "sampler_results": {"episode_reward_max": -1.600000000000001, "episode_reward_min": -11.199999999999973, "episode_reward_mean": -2.8009708737864076, "episode_len_mean": 38.74757281553398, "episode_media": {}, "episodes_this_iter": 103, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1.8000000000000012, -3.4000000000000004, -4.200000000000001, -2.900000000000002, -2.3000000000000016, -2.2000000000000015, -2.1000000000000014, -2.5000000000000018, -2.2000000000000015, -2.3000000000000016, -2.4000000000000017, -3.1000000000000014, -2.3000000000000016, -2.600000000000002, -2.4000000000000017, -1.9000000000000012, -2.900000000000002, -2.800000000000002, -2.1000000000000014, -2.600000000000002, -1.600000000000001, -3.1000000000000014, -1.8000000000000012, -2.800000000000002, -2.3000000000000016, -2.800000000000002, -3.1000000000000014, -2.900000000000002, -3.0000000000000018, -2.4000000000000017, -3.4000000000000004, -2.4000000000000017, -1.700000000000001, -2.2000000000000015, -1.600000000000001, -2.4000000000000017, -2.800000000000002, -2.600000000000002, -9.399999999999979, -2.0000000000000013, -3.3000000000000007, -2.4000000000000017, -3.5, -3.500000000000001, -1.9000000000000012, -3.1000000000000014, -3.200000000000001, -3.0000000000000018, -1.9000000000000012, -3.1000000000000014, -2.5000000000000018, -1.700000000000001, -2.700000000000002, -2.5000000000000018, -3.200000000000001, -2.700000000000002, -3.4000000000000004, -2.0000000000000013, -3.1000000000000014, -3.1000000000000014, -2.4000000000000017, -2.600000000000002, -2.600000000000002, -2.5000000000000018, -3.0000000000000018, -3.200000000000001, -11.199999999999973, -2.700000000000002, -6.099999999999998, -3.0000000000000018, -3.3000000000000007, -2.5000000000000018, -2.0000000000000013, -2.5000000000000018, -1.8000000000000012, -2.600000000000002, -3.6999999999999993, -3.0000000000000018, -2.1000000000000014, -3.4000000000000004, -1.9000000000000012, -3.0000000000000018, -2.0000000000000013, -2.5000000000000018, -3.200000000000001, -3.0000000000000018, -2.5000000000000018, -3.3000000000000007, -2.700000000000002, -2.900000000000002, -2.5000000000000018, -2.1000000000000014, -2.600000000000002, -2.2000000000000015, -3.1000000000000014, -2.800000000000002, -2.4000000000000017, -1.9000000000000012, -2.5000000000000018, -3.200000000000001, -2.600000000000002, -2.2000000000000015, -2.1000000000000014], "episode_lengths": [29, 45, 45, 37, 34, 33, 32, 36, 33, 34, 35, 42, 34, 37, 35, 30, 40, 39, 32, 37, 27, 42, 29, 39, 34, 39, 42, 40, 41, 35, 45, 32, 28, 33, 27, 35, 39, 37, 105, 31, 44, 35, 46, 44, 30, 42, 43, 41, 30, 42, 36, 28, 38, 36, 43, 38, 45, 31, 42, 42, 35, 37, 37, 36, 41, 43, 123, 38, 61, 41, 44, 36, 31, 36, 29, 37, 48, 41, 32, 45, 30, 41, 31, 36, 43, 41, 36, 44, 38, 40, 36, 32, 37, 33, 42, 39, 35, 30, 36, 43, 37, 33, 32]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3050233468188098, "mean_inference_ms": 0.7736548986249894, "mean_action_processing_ms": 0.08097965188300223, "mean_env_wait_ms": 6.91905890985497, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007136817117339199, "StateBufferConnector_ms": 0.003933212132129854, "ViewRequirementAgentConnector_ms": 0.09462509340452917}}, "episode_reward_max": -1.600000000000001, "episode_reward_min": -11.199999999999973, "episode_reward_mean": -2.8009708737864076, "episode_len_mean": 38.74757281553398, "episodes_this_iter": 103, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1.8000000000000012, -3.4000000000000004, -4.200000000000001, -2.900000000000002, -2.3000000000000016, -2.2000000000000015, -2.1000000000000014, -2.5000000000000018, -2.2000000000000015, -2.3000000000000016, -2.4000000000000017, -3.1000000000000014, -2.3000000000000016, -2.600000000000002, -2.4000000000000017, -1.9000000000000012, -2.900000000000002, -2.800000000000002, -2.1000000000000014, -2.600000000000002, -1.600000000000001, -3.1000000000000014, -1.8000000000000012, -2.800000000000002, -2.3000000000000016, -2.800000000000002, -3.1000000000000014, -2.900000000000002, -3.0000000000000018, -2.4000000000000017, -3.4000000000000004, -2.4000000000000017, -1.700000000000001, -2.2000000000000015, -1.600000000000001, -2.4000000000000017, -2.800000000000002, -2.600000000000002, -9.399999999999979, -2.0000000000000013, -3.3000000000000007, -2.4000000000000017, -3.5, -3.500000000000001, -1.9000000000000012, -3.1000000000000014, -3.200000000000001, -3.0000000000000018, -1.9000000000000012, -3.1000000000000014, -2.5000000000000018, -1.700000000000001, -2.700000000000002, -2.5000000000000018, -3.200000000000001, -2.700000000000002, -3.4000000000000004, -2.0000000000000013, -3.1000000000000014, -3.1000000000000014, -2.4000000000000017, -2.600000000000002, -2.600000000000002, -2.5000000000000018, -3.0000000000000018, -3.200000000000001, -11.199999999999973, -2.700000000000002, -6.099999999999998, -3.0000000000000018, -3.3000000000000007, -2.5000000000000018, -2.0000000000000013, -2.5000000000000018, -1.8000000000000012, -2.600000000000002, -3.6999999999999993, -3.0000000000000018, -2.1000000000000014, -3.4000000000000004, -1.9000000000000012, -3.0000000000000018, -2.0000000000000013, -2.5000000000000018, -3.200000000000001, -3.0000000000000018, -2.5000000000000018, -3.3000000000000007, -2.700000000000002, -2.900000000000002, -2.5000000000000018, -2.1000000000000014, -2.600000000000002, -2.2000000000000015, -3.1000000000000014, -2.800000000000002, -2.4000000000000017, -1.9000000000000012, -2.5000000000000018, -3.200000000000001, -2.600000000000002, -2.2000000000000015, -2.1000000000000014], "episode_lengths": [29, 45, 45, 37, 34, 33, 32, 36, 33, 34, 35, 42, 34, 37, 35, 30, 40, 39, 32, 37, 27, 42, 29, 39, 34, 39, 42, 40, 41, 35, 45, 32, 28, 33, 27, 35, 39, 37, 105, 31, 44, 35, 46, 44, 30, 42, 43, 41, 30, 42, 36, 28, 38, 36, 43, 38, 45, 31, 42, 42, 35, 37, 37, 36, 41, 43, 123, 38, 61, 41, 44, 36, 31, 36, 29, 37, 48, 41, 32, 45, 30, 41, 31, 36, 43, 41, 36, 44, 38, 40, 36, 32, 37, 33, 42, 39, 35, 30, 36, 43, 37, 33, 32]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3050233468188098, "mean_inference_ms": 0.7736548986249894, "mean_action_processing_ms": 0.08097965188300223, "mean_env_wait_ms": 6.91905890985497, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007136817117339199, "StateBufferConnector_ms": 0.003933212132129854, "ViewRequirementAgentConnector_ms": 0.09462509340452917}, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 172000, "num_agent_steps_trained": 172000, "num_env_steps_sampled": 172000, "num_env_steps_trained": 172000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 414.85217437404293, "num_env_steps_trained_throughput_per_sec": 414.85217437404293, "timesteps_total": 172000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 172000, "timers": {"training_iteration_time_ms": 9734.38, "sample_time_ms": 5858.053, "load_time_ms": 1.031, "load_throughput": 3879304.477, "learn_time_ms": 3871.04, "learn_throughput": 1033.314, "synch_weights_time_ms": 3.553}, "counters": {"num_env_steps_sampled": 172000, "num_env_steps_trained": 172000, "num_agent_steps_sampled": 172000, "num_agent_steps_trained": 172000}, "done": false, "episodes_total": 1925, "training_iteration": 43, "trial_id": "b7012_00000", "date": "2024-03-07_12-46-59", "timestamp": 1709833619, "time_this_iter_s": 9.64482855796814, "time_total_s": 413.5855326652527, "pid": 109767, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4d85689f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 413.5855326652527, "iterations_since_restore": 43, "perf": {"cpu_util_percent": 29.91666666666667, "ram_util_percent": 52.01666666666667, "gpu_util_percent0": 0.11333333333333333, "vram_util_percent0": 0.12736002604166666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.10000000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 0.06305118263749185, "policy_loss": -0.004489162259845324, "vf_loss": 0.06646234725992525, "vf_explained_var": 0.9512999870443857, "kl": 0.010779980546608978, "entropy": 0.39087535200580475, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 40455.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 176000, "num_env_steps_trained": 176000, "num_agent_steps_sampled": 176000, "num_agent_steps_trained": 176000}, "sampler_results": {"episode_reward_max": -1.600000000000001, "episode_reward_min": -4.000000000000002, "episode_reward_mean": -2.561467889908258, "episode_len_mean": 36.45871559633027, "episode_media": {}, "episodes_this_iter": 109, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2.900000000000002, -3.200000000000001, -3.4000000000000004, -2.2000000000000015, -2.700000000000002, -2.0000000000000013, -2.2000000000000015, -2.5000000000000018, -2.3000000000000016, -2.700000000000002, -2.0000000000000013, -1.600000000000001, -3.200000000000001, -2.800000000000002, -3.4000000000000004, -2.800000000000002, -2.2000000000000015, -2.4000000000000017, -2.5000000000000018, -2.2000000000000015, -2.800000000000002, -1.8000000000000012, -2.600000000000002, -3.0000000000000018, -1.8000000000000012, -2.4000000000000017, -2.800000000000002, -3.1000000000000014, -2.900000000000002, -2.5000000000000018, -2.0000000000000013, -3.3000000000000007, -2.1000000000000014, -2.3000000000000016, -2.600000000000002, -2.700000000000002, -3.0000000000000018, -3.5, -2.0000000000000013, -3.1000000000000014, -2.600000000000002, -2.4000000000000017, -2.5000000000000018, -2.600000000000002, -2.1000000000000014, -2.0000000000000013, -3.200000000000001, -2.2000000000000015, -2.700000000000002, -2.1000000000000014, -3.200000000000001, -1.700000000000001, -2.700000000000002, -2.2000000000000015, -3.0000000000000018, -2.0000000000000013, -2.900000000000002, -2.800000000000002, -2.700000000000002, -2.3000000000000016, -1.9000000000000012, -2.4000000000000017, -2.0000000000000013, -1.700000000000001, -2.700000000000002, -2.0000000000000013, -3.200000000000001, -2.0000000000000013, -3.0000000000000018, -2.600000000000002, -3.6999999999999993, -2.900000000000002, -2.5000000000000018, -2.1000000000000014, -2.800000000000002, -3.1000000000000014, -2.700000000000002, -3.200000000000001, -3.5, -3.1000000000000014, -2.700000000000002, -1.700000000000001, -2.3000000000000016, -2.1000000000000014, -2.600000000000002, -3.0000000000000018, -2.900000000000002, -2.900000000000002, -1.8000000000000012, -4.000000000000002, -2.800000000000002, -2.0000000000000013, -2.5000000000000018, -2.1000000000000014, -2.900000000000002, -3.5, -2.4000000000000017, -2.700000000000002, -2.700000000000002, -2.2000000000000015, -2.1000000000000014, -1.8000000000000012, -1.700000000000001, -2.900000000000002, -3.0000000000000018, -2.900000000000002, -2.700000000000002, -2.1000000000000014, -1.700000000000001], "episode_lengths": [40, 43, 45, 33, 38, 31, 33, 36, 34, 38, 31, 27, 43, 39, 45, 39, 33, 35, 36, 33, 39, 29, 37, 41, 29, 35, 39, 42, 40, 36, 31, 40, 32, 34, 37, 38, 41, 46, 31, 42, 37, 35, 36, 37, 32, 31, 43, 33, 38, 32, 43, 28, 38, 33, 41, 31, 40, 39, 38, 34, 30, 35, 31, 28, 38, 31, 43, 31, 37, 37, 48, 40, 36, 29, 39, 42, 38, 43, 46, 40, 38, 28, 34, 32, 37, 41, 40, 40, 29, 47, 39, 31, 36, 32, 40, 46, 35, 38, 38, 33, 32, 29, 28, 40, 41, 40, 38, 32, 28]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3070143459747249, "mean_inference_ms": 0.7723318182277323, "mean_action_processing_ms": 0.08095869887567278, "mean_env_wait_ms": 6.9300829757035425, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006634598478264765, "StateBufferConnector_ms": 0.003625930996116148, "ViewRequirementAgentConnector_ms": 0.08836908077974932}}, "episode_reward_max": -1.600000000000001, "episode_reward_min": -4.000000000000002, "episode_reward_mean": -2.561467889908258, "episode_len_mean": 36.45871559633027, "episodes_this_iter": 109, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-2.900000000000002, -3.200000000000001, -3.4000000000000004, -2.2000000000000015, -2.700000000000002, -2.0000000000000013, -2.2000000000000015, -2.5000000000000018, -2.3000000000000016, -2.700000000000002, -2.0000000000000013, -1.600000000000001, -3.200000000000001, -2.800000000000002, -3.4000000000000004, -2.800000000000002, -2.2000000000000015, -2.4000000000000017, -2.5000000000000018, -2.2000000000000015, -2.800000000000002, -1.8000000000000012, -2.600000000000002, -3.0000000000000018, -1.8000000000000012, -2.4000000000000017, -2.800000000000002, -3.1000000000000014, -2.900000000000002, -2.5000000000000018, -2.0000000000000013, -3.3000000000000007, -2.1000000000000014, -2.3000000000000016, -2.600000000000002, -2.700000000000002, -3.0000000000000018, -3.5, -2.0000000000000013, -3.1000000000000014, -2.600000000000002, -2.4000000000000017, -2.5000000000000018, -2.600000000000002, -2.1000000000000014, -2.0000000000000013, -3.200000000000001, -2.2000000000000015, -2.700000000000002, -2.1000000000000014, -3.200000000000001, -1.700000000000001, -2.700000000000002, -2.2000000000000015, -3.0000000000000018, -2.0000000000000013, -2.900000000000002, -2.800000000000002, -2.700000000000002, -2.3000000000000016, -1.9000000000000012, -2.4000000000000017, -2.0000000000000013, -1.700000000000001, -2.700000000000002, -2.0000000000000013, -3.200000000000001, -2.0000000000000013, -3.0000000000000018, -2.600000000000002, -3.6999999999999993, -2.900000000000002, -2.5000000000000018, -2.1000000000000014, -2.800000000000002, -3.1000000000000014, -2.700000000000002, -3.200000000000001, -3.5, -3.1000000000000014, -2.700000000000002, -1.700000000000001, -2.3000000000000016, -2.1000000000000014, -2.600000000000002, -3.0000000000000018, -2.900000000000002, -2.900000000000002, -1.8000000000000012, -4.000000000000002, -2.800000000000002, -2.0000000000000013, -2.5000000000000018, -2.1000000000000014, -2.900000000000002, -3.5, -2.4000000000000017, -2.700000000000002, -2.700000000000002, -2.2000000000000015, -2.1000000000000014, -1.8000000000000012, -1.700000000000001, -2.900000000000002, -3.0000000000000018, -2.900000000000002, -2.700000000000002, -2.1000000000000014, -1.700000000000001], "episode_lengths": [40, 43, 45, 33, 38, 31, 33, 36, 34, 38, 31, 27, 43, 39, 45, 39, 33, 35, 36, 33, 39, 29, 37, 41, 29, 35, 39, 42, 40, 36, 31, 40, 32, 34, 37, 38, 41, 46, 31, 42, 37, 35, 36, 37, 32, 31, 43, 33, 38, 32, 43, 28, 38, 33, 41, 31, 40, 39, 38, 34, 30, 35, 31, 28, 38, 31, 43, 31, 37, 37, 48, 40, 36, 29, 39, 42, 38, 43, 46, 40, 38, 28, 34, 32, 37, 41, 40, 40, 29, 47, 39, 31, 36, 32, 40, 46, 35, 38, 38, 33, 32, 29, 28, 40, 41, 40, 38, 32, 28]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3070143459747249, "mean_inference_ms": 0.7723318182277323, "mean_action_processing_ms": 0.08095869887567278, "mean_env_wait_ms": 6.9300829757035425, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006634598478264765, "StateBufferConnector_ms": 0.003625930996116148, "ViewRequirementAgentConnector_ms": 0.08836908077974932}, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 176000, "num_agent_steps_trained": 176000, "num_env_steps_sampled": 176000, "num_env_steps_trained": 176000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 421.7891397721624, "num_env_steps_trained_throughput_per_sec": 421.7891397721624, "timesteps_total": 176000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 176000, "timers": {"training_iteration_time_ms": 9573.464, "sample_time_ms": 5814.313, "load_time_ms": 1.027, "load_throughput": 3894161.502, "learn_time_ms": 3755.258, "learn_throughput": 1065.173, "synch_weights_time_ms": 2.197}, "counters": {"num_env_steps_sampled": 176000, "num_env_steps_trained": 176000, "num_agent_steps_sampled": 176000, "num_agent_steps_trained": 176000}, "done": false, "episodes_total": 2034, "training_iteration": 44, "trial_id": "b7012_00000", "date": "2024-03-07_12-47-08", "timestamp": 1709833628, "time_this_iter_s": 9.486239433288574, "time_total_s": 423.07177209854126, "pid": 109767, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4d85689f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 423.07177209854126, "iterations_since_restore": 44, "perf": {"cpu_util_percent": 28.075000000000003, "ram_util_percent": 51.50833333333333, "gpu_util_percent0": 0.09583333333333333, "vram_util_percent0": 0.12642415364583331}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.10000000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 0.2626268458813028, "policy_loss": -0.002892327483903657, "vf_loss": 0.26430617256330385, "vf_explained_var": 0.8766680748872859, "kl": 0.012129976634711359, "entropy": 0.37629572047341253, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 41385.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 180000, "num_env_steps_trained": 180000, "num_agent_steps_sampled": 180000, "num_agent_steps_trained": 180000}, "sampler_results": {"episode_reward_max": -1.4000000000000008, "episode_reward_min": -12.799999999999985, "episode_reward_mean": -2.6110091743119277, "episode_len_mean": 36.60550458715596, "episode_media": {}, "episodes_this_iter": 109, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2.4000000000000017, -3.700000000000001, -3.6000000000000014, -1.700000000000001, -3.3000000000000007, -3.200000000000001, -2.600000000000002, -2.600000000000002, -2.800000000000002, -3.200000000000001, -2.700000000000002, -2.3000000000000016, -2.2000000000000015, -1.700000000000001, -2.800000000000002, -3.0000000000000018, -2.4000000000000017, -2.4000000000000017, -2.900000000000002, -2.600000000000002, -2.600000000000002, -3.8999999999999986, -2.700000000000002, -2.700000000000002, -2.4000000000000017, -2.0000000000000013, -2.4000000000000017, -3.3000000000000007, -2.5000000000000018, -3.799999999999999, -1.700000000000001, -2.600000000000002, -2.1000000000000014, -2.2000000000000015, -2.600000000000002, -2.5000000000000018, -2.4000000000000017, -2.5000000000000018, -3.500000000000001, -3.0000000000000018, -2.900000000000002, -2.4000000000000017, -2.3000000000000016, -1.9000000000000012, -2.3000000000000016, -3.200000000000002, -2.5000000000000018, -1.4000000000000008, -3.0000000000000018, -2.5000000000000018, -2.3000000000000016, -3.1000000000000014, -3.8999999999999986, -1.700000000000001, -12.799999999999985, -1.8000000000000012, -1.9000000000000012, -1.700000000000001, -1.600000000000001, -2.1000000000000014, -2.700000000000002, -3.4000000000000004, -1.700000000000001, -2.700000000000002, -1.600000000000001, -2.1000000000000014, -2.1000000000000014, -3.0000000000000018, -2.5000000000000018, -2.2000000000000015, -2.800000000000002, -2.5000000000000018, -2.4000000000000017, -2.1000000000000014, -2.800000000000002, -2.800000000000002, -2.600000000000002, -2.4000000000000017, -2.1000000000000014, -3.200000000000001, -2.4000000000000017, -2.5000000000000018, -1.9000000000000012, -2.1000000000000014, -2.0000000000000013, -2.600000000000002, -1.700000000000001, -3.5999999999999996, -2.5000000000000018, -1.700000000000001, -2.2000000000000015, -3.200000000000001, -2.600000000000002, -2.3000000000000016, -3.3000000000000007, -2.4000000000000017, -1.4000000000000008, -3.0000000000000018, -2.700000000000002, -2.0000000000000013, -2.2000000000000015, -3.200000000000001, -2.2000000000000015, -1.9000000000000012, -2.4000000000000017, -2.5000000000000018, -2.600000000000002, -2.4000000000000017, -2.600000000000002], "episode_lengths": [35, 43, 45, 28, 44, 43, 37, 37, 39, 43, 38, 34, 33, 28, 39, 41, 35, 35, 40, 37, 37, 50, 38, 38, 35, 31, 35, 44, 36, 49, 28, 36, 32, 33, 37, 36, 35, 36, 42, 41, 40, 35, 34, 30, 34, 41, 36, 25, 41, 36, 34, 42, 50, 27, 99, 29, 30, 28, 27, 32, 38, 45, 28, 38, 27, 32, 32, 41, 36, 33, 39, 36, 35, 32, 39, 39, 37, 35, 32, 43, 35, 36, 30, 32, 31, 37, 28, 47, 36, 28, 33, 43, 37, 34, 44, 35, 25, 41, 38, 31, 33, 43, 33, 30, 35, 36, 37, 35, 37]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3088683724399635, "mean_inference_ms": 0.77124642453237, "mean_action_processing_ms": 0.0808403848981876, "mean_env_wait_ms": 6.940510519518326, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006858580703035407, "StateBufferConnector_ms": 0.0037368284452945814, "ViewRequirementAgentConnector_ms": 0.08899990571748226}}, "episode_reward_max": -1.4000000000000008, "episode_reward_min": -12.799999999999985, "episode_reward_mean": -2.6110091743119277, "episode_len_mean": 36.60550458715596, "episodes_this_iter": 109, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-2.4000000000000017, -3.700000000000001, -3.6000000000000014, -1.700000000000001, -3.3000000000000007, -3.200000000000001, -2.600000000000002, -2.600000000000002, -2.800000000000002, -3.200000000000001, -2.700000000000002, -2.3000000000000016, -2.2000000000000015, -1.700000000000001, -2.800000000000002, -3.0000000000000018, -2.4000000000000017, -2.4000000000000017, -2.900000000000002, -2.600000000000002, -2.600000000000002, -3.8999999999999986, -2.700000000000002, -2.700000000000002, -2.4000000000000017, -2.0000000000000013, -2.4000000000000017, -3.3000000000000007, -2.5000000000000018, -3.799999999999999, -1.700000000000001, -2.600000000000002, -2.1000000000000014, -2.2000000000000015, -2.600000000000002, -2.5000000000000018, -2.4000000000000017, -2.5000000000000018, -3.500000000000001, -3.0000000000000018, -2.900000000000002, -2.4000000000000017, -2.3000000000000016, -1.9000000000000012, -2.3000000000000016, -3.200000000000002, -2.5000000000000018, -1.4000000000000008, -3.0000000000000018, -2.5000000000000018, -2.3000000000000016, -3.1000000000000014, -3.8999999999999986, -1.700000000000001, -12.799999999999985, -1.8000000000000012, -1.9000000000000012, -1.700000000000001, -1.600000000000001, -2.1000000000000014, -2.700000000000002, -3.4000000000000004, -1.700000000000001, -2.700000000000002, -1.600000000000001, -2.1000000000000014, -2.1000000000000014, -3.0000000000000018, -2.5000000000000018, -2.2000000000000015, -2.800000000000002, -2.5000000000000018, -2.4000000000000017, -2.1000000000000014, -2.800000000000002, -2.800000000000002, -2.600000000000002, -2.4000000000000017, -2.1000000000000014, -3.200000000000001, -2.4000000000000017, -2.5000000000000018, -1.9000000000000012, -2.1000000000000014, -2.0000000000000013, -2.600000000000002, -1.700000000000001, -3.5999999999999996, -2.5000000000000018, -1.700000000000001, -2.2000000000000015, -3.200000000000001, -2.600000000000002, -2.3000000000000016, -3.3000000000000007, -2.4000000000000017, -1.4000000000000008, -3.0000000000000018, -2.700000000000002, -2.0000000000000013, -2.2000000000000015, -3.200000000000001, -2.2000000000000015, -1.9000000000000012, -2.4000000000000017, -2.5000000000000018, -2.600000000000002, -2.4000000000000017, -2.600000000000002], "episode_lengths": [35, 43, 45, 28, 44, 43, 37, 37, 39, 43, 38, 34, 33, 28, 39, 41, 35, 35, 40, 37, 37, 50, 38, 38, 35, 31, 35, 44, 36, 49, 28, 36, 32, 33, 37, 36, 35, 36, 42, 41, 40, 35, 34, 30, 34, 41, 36, 25, 41, 36, 34, 42, 50, 27, 99, 29, 30, 28, 27, 32, 38, 45, 28, 38, 27, 32, 32, 41, 36, 33, 39, 36, 35, 32, 39, 39, 37, 35, 32, 43, 35, 36, 30, 32, 31, 37, 28, 47, 36, 28, 33, 43, 37, 34, 44, 35, 25, 41, 38, 31, 33, 43, 33, 30, 35, 36, 37, 35, 37]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3088683724399635, "mean_inference_ms": 0.77124642453237, "mean_action_processing_ms": 0.0808403848981876, "mean_env_wait_ms": 6.940510519518326, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006858580703035407, "StateBufferConnector_ms": 0.0037368284452945814, "ViewRequirementAgentConnector_ms": 0.08899990571748226}, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 180000, "num_agent_steps_trained": 180000, "num_env_steps_sampled": 180000, "num_env_steps_trained": 180000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 421.93360550135793, "num_env_steps_trained_throughput_per_sec": 421.93360550135793, "timesteps_total": 180000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 180000, "timers": {"training_iteration_time_ms": 9516.098, "sample_time_ms": 5807.775, "load_time_ms": 1.026, "load_throughput": 3897146.574, "learn_time_ms": 3704.469, "learn_throughput": 1079.777, "synch_weights_time_ms": 2.163}, "counters": {"num_env_steps_sampled": 180000, "num_env_steps_trained": 180000, "num_agent_steps_sampled": 180000, "num_agent_steps_trained": 180000}, "done": false, "episodes_total": 2143, "training_iteration": 45, "trial_id": "b7012_00000", "date": "2024-03-07_12-47-18", "timestamp": 1709833638, "time_this_iter_s": 9.48285698890686, "time_total_s": 432.5546290874481, "pid": 109767, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4d85689f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 432.5546290874481, "iterations_since_restore": 45, "perf": {"cpu_util_percent": 26.55384615384616, "ram_util_percent": 51.39999999999999, "gpu_util_percent0": 0.09846153846153846, "vram_util_percent0": 0.1269093048878205}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.10000000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 0.2250907104558772, "policy_loss": -0.009507186465486083, "vf_loss": 0.233911429393676, "vf_explained_var": 0.8738840709450424, "kl": 0.0068646615238978585, "entropy": 0.3470923804147269, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 42315.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 184000, "num_env_steps_trained": 184000, "num_agent_steps_sampled": 184000, "num_agent_steps_trained": 184000}, "sampler_results": {"episode_reward_max": -1.4000000000000008, "episode_reward_min": -8.100000000000001, "episode_reward_mean": -2.4955752212389393, "episode_len_mean": 35.530973451327434, "episode_media": {}, "episodes_this_iter": 113, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4.099999999999998, -2.1000000000000014, -2.900000000000002, -1.8000000000000012, -2.800000000000002, -2.2000000000000015, -2.5000000000000018, -2.700000000000002, -2.800000000000002, -2.5000000000000018, -3.0000000000000018, -2.700000000000002, -2.700000000000002, -2.3000000000000016, -1.9000000000000012, -2.700000000000002, -2.2000000000000015, -2.4000000000000017, -2.0000000000000013, -2.2000000000000015, -2.4000000000000017, -2.800000000000002, -2.3000000000000016, -1.600000000000001, -1.700000000000001, -2.5000000000000018, -2.0000000000000013, -2.5000000000000018, -2.400000000000001, -2.0000000000000013, -2.1000000000000014, -1.4000000000000008, -1.700000000000001, -2.5000000000000018, -2.700000000000002, -2.1000000000000014, -1.600000000000001, -2.700000000000002, -2.800000000000002, -3.3000000000000007, -2.1000000000000014, -3.3000000000000007, -3.3000000000000007, -2.3000000000000016, -2.0000000000000013, -2.3000000000000016, -2.800000000000002, -2.2000000000000015, -2.3000000000000016, -2.900000000000002, -2.900000000000002, -2.0000000000000013, -2.5000000000000018, -2.5000000000000018, -1.9000000000000012, -5.599999999999996, -2.1000000000000014, -2.3000000000000016, -2.3000000000000016, -2.5000000000000018, -1.8000000000000012, -1.8000000000000012, -2.600000000000002, -2.3000000000000016, -1.8000000000000012, -2.0000000000000013, -2.4000000000000017, -2.3000000000000007, -2.600000000000002, -2.3000000000000016, -2.3000000000000016, -8.100000000000001, -2.2000000000000015, -2.1000000000000014, -2.600000000000002, -2.1000000000000014, -2.900000000000002, -4.200000000000002, -2.2000000000000015, -2.900000000000002, -2.600000000000002, -3.200000000000001, -3.0000000000000018, -2.1000000000000014, -3.0000000000000018, -2.1000000000000014, -2.3000000000000016, -2.5000000000000018, -2.800000000000002, -2.1000000000000014, -3.200000000000001, -2.4000000000000017, -2.600000000000002, -2.700000000000002, -2.800000000000002, -2.3000000000000016, -2.0000000000000013, -2.4000000000000017, -2.2000000000000015, -2.2000000000000015, -1.9000000000000012, -1.9000000000000012, -2.700000000000002, -1.9000000000000012, -2.2000000000000015, -1.700000000000001, -2.5000000000000018, -2.2000000000000015, -3.3000000000000007, -2.0000000000000013, -2.600000000000002, -2.900000000000002, -2.5000000000000018], "episode_lengths": [52, 32, 40, 29, 39, 33, 36, 38, 39, 36, 41, 38, 38, 34, 30, 38, 33, 35, 31, 33, 35, 39, 34, 27, 28, 36, 31, 36, 29, 31, 32, 25, 28, 36, 38, 32, 27, 38, 39, 44, 32, 44, 44, 34, 31, 34, 39, 33, 34, 40, 40, 31, 36, 36, 30, 63, 32, 34, 34, 36, 29, 29, 37, 34, 29, 31, 35, 28, 37, 34, 34, 67, 33, 32, 37, 32, 40, 46, 33, 40, 37, 43, 41, 32, 41, 32, 34, 36, 39, 32, 43, 35, 37, 38, 39, 34, 31, 35, 33, 33, 30, 30, 38, 30, 33, 28, 36, 33, 44, 31, 37, 40, 36]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3110376193904852, "mean_inference_ms": 0.770647003363659, "mean_action_processing_ms": 0.0807520132235269, "mean_env_wait_ms": 6.953762963818417, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0069538048938312365, "StateBufferConnector_ms": 0.0037845257109245366, "ViewRequirementAgentConnector_ms": 0.09105395426792381}}, "episode_reward_max": -1.4000000000000008, "episode_reward_min": -8.100000000000001, "episode_reward_mean": -2.4955752212389393, "episode_len_mean": 35.530973451327434, "episodes_this_iter": 113, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-4.099999999999998, -2.1000000000000014, -2.900000000000002, -1.8000000000000012, -2.800000000000002, -2.2000000000000015, -2.5000000000000018, -2.700000000000002, -2.800000000000002, -2.5000000000000018, -3.0000000000000018, -2.700000000000002, -2.700000000000002, -2.3000000000000016, -1.9000000000000012, -2.700000000000002, -2.2000000000000015, -2.4000000000000017, -2.0000000000000013, -2.2000000000000015, -2.4000000000000017, -2.800000000000002, -2.3000000000000016, -1.600000000000001, -1.700000000000001, -2.5000000000000018, -2.0000000000000013, -2.5000000000000018, -2.400000000000001, -2.0000000000000013, -2.1000000000000014, -1.4000000000000008, -1.700000000000001, -2.5000000000000018, -2.700000000000002, -2.1000000000000014, -1.600000000000001, -2.700000000000002, -2.800000000000002, -3.3000000000000007, -2.1000000000000014, -3.3000000000000007, -3.3000000000000007, -2.3000000000000016, -2.0000000000000013, -2.3000000000000016, -2.800000000000002, -2.2000000000000015, -2.3000000000000016, -2.900000000000002, -2.900000000000002, -2.0000000000000013, -2.5000000000000018, -2.5000000000000018, -1.9000000000000012, -5.599999999999996, -2.1000000000000014, -2.3000000000000016, -2.3000000000000016, -2.5000000000000018, -1.8000000000000012, -1.8000000000000012, -2.600000000000002, -2.3000000000000016, -1.8000000000000012, -2.0000000000000013, -2.4000000000000017, -2.3000000000000007, -2.600000000000002, -2.3000000000000016, -2.3000000000000016, -8.100000000000001, -2.2000000000000015, -2.1000000000000014, -2.600000000000002, -2.1000000000000014, -2.900000000000002, -4.200000000000002, -2.2000000000000015, -2.900000000000002, -2.600000000000002, -3.200000000000001, -3.0000000000000018, -2.1000000000000014, -3.0000000000000018, -2.1000000000000014, -2.3000000000000016, -2.5000000000000018, -2.800000000000002, -2.1000000000000014, -3.200000000000001, -2.4000000000000017, -2.600000000000002, -2.700000000000002, -2.800000000000002, -2.3000000000000016, -2.0000000000000013, -2.4000000000000017, -2.2000000000000015, -2.2000000000000015, -1.9000000000000012, -1.9000000000000012, -2.700000000000002, -1.9000000000000012, -2.2000000000000015, -1.700000000000001, -2.5000000000000018, -2.2000000000000015, -3.3000000000000007, -2.0000000000000013, -2.600000000000002, -2.900000000000002, -2.5000000000000018], "episode_lengths": [52, 32, 40, 29, 39, 33, 36, 38, 39, 36, 41, 38, 38, 34, 30, 38, 33, 35, 31, 33, 35, 39, 34, 27, 28, 36, 31, 36, 29, 31, 32, 25, 28, 36, 38, 32, 27, 38, 39, 44, 32, 44, 44, 34, 31, 34, 39, 33, 34, 40, 40, 31, 36, 36, 30, 63, 32, 34, 34, 36, 29, 29, 37, 34, 29, 31, 35, 28, 37, 34, 34, 67, 33, 32, 37, 32, 40, 46, 33, 40, 37, 43, 41, 32, 41, 32, 34, 36, 39, 32, 43, 35, 37, 38, 39, 34, 31, 35, 33, 33, 30, 30, 38, 30, 33, 28, 36, 33, 44, 31, 37, 40, 36]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3110376193904852, "mean_inference_ms": 0.770647003363659, "mean_action_processing_ms": 0.0807520132235269, "mean_env_wait_ms": 6.953762963818417, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0069538048938312365, "StateBufferConnector_ms": 0.0037845257109245366, "ViewRequirementAgentConnector_ms": 0.09105395426792381}, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 184000, "num_agent_steps_trained": 184000, "num_env_steps_sampled": 184000, "num_env_steps_trained": 184000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 417.37145444379695, "num_env_steps_trained_throughput_per_sec": 417.37145444379695, "timesteps_total": 184000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 184000, "timers": {"training_iteration_time_ms": 9540.664, "sample_time_ms": 5838.794, "load_time_ms": 1.028, "load_throughput": 3890008.115, "learn_time_ms": 3698.04, "learn_throughput": 1081.654, "synch_weights_time_ms": 2.139}, "counters": {"num_env_steps_sampled": 184000, "num_env_steps_trained": 184000, "num_agent_steps_sampled": 184000, "num_agent_steps_trained": 184000}, "done": false, "episodes_total": 2256, "training_iteration": 46, "trial_id": "b7012_00000", "date": "2024-03-07_12-47-27", "timestamp": 1709833647, "time_this_iter_s": 9.586561441421509, "time_total_s": 442.14119052886963, "pid": 109767, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4d85689f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 442.14119052886963, "iterations_since_restore": 46, "perf": {"cpu_util_percent": 29.575, "ram_util_percent": 51.383333333333326, "gpu_util_percent0": 0.09083333333333334, "vram_util_percent0": 0.12551540798611113}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.10000000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 0.5161502077318078, "policy_loss": -0.0034267540740710433, "vf_loss": 0.5187626384168623, "vf_explained_var": 0.8345803081348379, "kl": 0.008143219401443844, "entropy": 0.36830291078295757, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 43245.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 188000, "num_env_steps_trained": 188000, "num_agent_steps_sampled": 188000, "num_agent_steps_trained": 188000}, "sampler_results": {"episode_reward_max": -1.4000000000000008, "episode_reward_min": -72.5000000000005, "episode_reward_mean": -2.901851851851858, "episode_len_mean": 36.870370370370374, "episode_media": {}, "episodes_this_iter": 108, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-72.5000000000005, -1.8000000000000012, -2.2000000000000015, -3.1000000000000014, -2.4000000000000017, -2.900000000000002, -2.3000000000000016, -3.200000000000001, -1.8000000000000012, -2.900000000000002, -1.600000000000001, -1.9000000000000012, -2.700000000000002, -1.8000000000000012, -1.8000000000000012, -2.4000000000000017, -2.1000000000000014, -2.3000000000000016, -2.600000000000002, -2.5000000000000018, -2.5000000000000018, -2.5000000000000018, -2.1000000000000014, -2.4000000000000017, -2.3000000000000016, -2.4000000000000017, -2.1000000000000014, -1.8000000000000012, -2.800000000000002, -2.5000000000000018, -2.600000000000002, -2.1000000000000014, -1.9000000000000012, -2.600000000000002, -2.4000000000000017, -1.9000000000000012, -2.3000000000000016, -2.900000000000002, -1.8000000000000012, -3.1000000000000014, -2.3000000000000016, -2.3000000000000016, -2.0000000000000013, -3.1000000000000014, -2.0000000000000013, -1.5000000000000009, -1.9000000000000012, -2.2000000000000015, -2.4000000000000017, -2.1000000000000014, -2.3000000000000016, -2.4000000000000017, -1.8000000000000012, -2.1000000000000014, -3.0000000000000018, -2.1000000000000014, -1.700000000000001, -2.600000000000002, -2.700000000000002, -1.9000000000000012, -2.800000000000002, -2.2000000000000015, -2.0000000000000013, -2.3000000000000016, -3.200000000000001, -2.3000000000000016, -2.3000000000000016, -2.3000000000000016, -2.700000000000002, -2.600000000000002, -1.700000000000001, -2.5000000000000018, -1.9000000000000012, -1.8000000000000012, -2.0000000000000013, -2.600000000000002, -2.4000000000000017, -2.0000000000000013, -1.700000000000001, -1.9000000000000012, -2.5000000000000018, -2.900000000000002, -1.8000000000000012, -1.700000000000001, -2.4000000000000017, -2.900000000000002, -2.700000000000002, -2.0000000000000013, -2.0000000000000013, -2.5000000000000018, -2.2000000000000015, -1.4000000000000008, -2.0000000000000013, -1.8000000000000012, -2.0000000000000013, -2.5000000000000018, -2.0000000000000013, -2.5000000000000018, -1.8000000000000012, -2.5000000000000018, -2.5000000000000018, -1.8000000000000012, -2.5000000000000018, -1.5000000000000009, -1.600000000000001, -2.5000000000000018, -1.5000000000000009, -2.0000000000000013], "episode_lengths": [400, 29, 33, 42, 35, 40, 34, 43, 29, 40, 27, 30, 38, 29, 29, 35, 32, 34, 37, 36, 36, 36, 32, 35, 34, 35, 32, 29, 39, 36, 37, 32, 30, 37, 35, 30, 34, 40, 29, 42, 34, 34, 31, 42, 31, 26, 30, 33, 35, 32, 34, 35, 29, 32, 41, 32, 28, 37, 38, 30, 39, 33, 31, 34, 43, 34, 34, 34, 38, 37, 28, 36, 30, 29, 31, 37, 35, 31, 28, 30, 36, 40, 29, 28, 35, 40, 38, 31, 31, 36, 29, 25, 31, 29, 31, 36, 31, 36, 29, 36, 36, 29, 36, 26, 27, 36, 26, 31]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3128924124251998, "mean_inference_ms": 0.7696682430456799, "mean_action_processing_ms": 0.08082064218815475, "mean_env_wait_ms": 6.969479479017415, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0066704220241970485, "StateBufferConnector_ms": 0.003635441815411603, "ViewRequirementAgentConnector_ms": 0.08859899308946398}}, "episode_reward_max": -1.4000000000000008, "episode_reward_min": -72.5000000000005, "episode_reward_mean": -2.901851851851858, "episode_len_mean": 36.870370370370374, "episodes_this_iter": 108, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-72.5000000000005, -1.8000000000000012, -2.2000000000000015, -3.1000000000000014, -2.4000000000000017, -2.900000000000002, -2.3000000000000016, -3.200000000000001, -1.8000000000000012, -2.900000000000002, -1.600000000000001, -1.9000000000000012, -2.700000000000002, -1.8000000000000012, -1.8000000000000012, -2.4000000000000017, -2.1000000000000014, -2.3000000000000016, -2.600000000000002, -2.5000000000000018, -2.5000000000000018, -2.5000000000000018, -2.1000000000000014, -2.4000000000000017, -2.3000000000000016, -2.4000000000000017, -2.1000000000000014, -1.8000000000000012, -2.800000000000002, -2.5000000000000018, -2.600000000000002, -2.1000000000000014, -1.9000000000000012, -2.600000000000002, -2.4000000000000017, -1.9000000000000012, -2.3000000000000016, -2.900000000000002, -1.8000000000000012, -3.1000000000000014, -2.3000000000000016, -2.3000000000000016, -2.0000000000000013, -3.1000000000000014, -2.0000000000000013, -1.5000000000000009, -1.9000000000000012, -2.2000000000000015, -2.4000000000000017, -2.1000000000000014, -2.3000000000000016, -2.4000000000000017, -1.8000000000000012, -2.1000000000000014, -3.0000000000000018, -2.1000000000000014, -1.700000000000001, -2.600000000000002, -2.700000000000002, -1.9000000000000012, -2.800000000000002, -2.2000000000000015, -2.0000000000000013, -2.3000000000000016, -3.200000000000001, -2.3000000000000016, -2.3000000000000016, -2.3000000000000016, -2.700000000000002, -2.600000000000002, -1.700000000000001, -2.5000000000000018, -1.9000000000000012, -1.8000000000000012, -2.0000000000000013, -2.600000000000002, -2.4000000000000017, -2.0000000000000013, -1.700000000000001, -1.9000000000000012, -2.5000000000000018, -2.900000000000002, -1.8000000000000012, -1.700000000000001, -2.4000000000000017, -2.900000000000002, -2.700000000000002, -2.0000000000000013, -2.0000000000000013, -2.5000000000000018, -2.2000000000000015, -1.4000000000000008, -2.0000000000000013, -1.8000000000000012, -2.0000000000000013, -2.5000000000000018, -2.0000000000000013, -2.5000000000000018, -1.8000000000000012, -2.5000000000000018, -2.5000000000000018, -1.8000000000000012, -2.5000000000000018, -1.5000000000000009, -1.600000000000001, -2.5000000000000018, -1.5000000000000009, -2.0000000000000013], "episode_lengths": [400, 29, 33, 42, 35, 40, 34, 43, 29, 40, 27, 30, 38, 29, 29, 35, 32, 34, 37, 36, 36, 36, 32, 35, 34, 35, 32, 29, 39, 36, 37, 32, 30, 37, 35, 30, 34, 40, 29, 42, 34, 34, 31, 42, 31, 26, 30, 33, 35, 32, 34, 35, 29, 32, 41, 32, 28, 37, 38, 30, 39, 33, 31, 34, 43, 34, 34, 34, 38, 37, 28, 36, 30, 29, 31, 37, 35, 31, 28, 30, 36, 40, 29, 28, 35, 40, 38, 31, 31, 36, 29, 25, 31, 29, 31, 36, 31, 36, 29, 36, 36, 29, 36, 26, 27, 36, 26, 31]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3128924124251998, "mean_inference_ms": 0.7696682430456799, "mean_action_processing_ms": 0.08082064218815475, "mean_env_wait_ms": 6.969479479017415, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0066704220241970485, "StateBufferConnector_ms": 0.003635441815411603, "ViewRequirementAgentConnector_ms": 0.08859899308946398}, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 188000, "num_agent_steps_trained": 188000, "num_env_steps_sampled": 188000, "num_env_steps_trained": 188000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 421.52480924344746, "num_env_steps_trained_throughput_per_sec": 421.52480924344746, "timesteps_total": 188000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 188000, "timers": {"training_iteration_time_ms": 9570.548, "sample_time_ms": 5872.455, "load_time_ms": 1.022, "load_throughput": 3914514.104, "learn_time_ms": 3694.271, "learn_throughput": 1082.758, "synch_weights_time_ms": 2.141}, "counters": {"num_env_steps_sampled": 188000, "num_env_steps_trained": 188000, "num_agent_steps_sampled": 188000, "num_agent_steps_trained": 188000}, "done": false, "episodes_total": 2364, "training_iteration": 47, "trial_id": "b7012_00000", "date": "2024-03-07_12-47-37", "timestamp": 1709833657, "time_this_iter_s": 9.492131233215332, "time_total_s": 451.63332176208496, "pid": 109767, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4d85689f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 451.63332176208496, "iterations_since_restore": 47, "perf": {"cpu_util_percent": 27.28333333333333, "ram_util_percent": 51.383333333333326, "gpu_util_percent0": 0.08249999999999999, "vram_util_percent0": 0.12548828125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.10000000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 0.1651929009615654, "policy_loss": -0.006238742238811908, "vf_loss": 0.1703246507027577, "vf_explained_var": 0.906602035414788, "kl": 0.01106990784859962, "entropy": 0.2989940554384262, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 44175.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 192000, "num_env_steps_trained": 192000, "num_agent_steps_sampled": 192000, "num_agent_steps_trained": 192000}, "sampler_results": {"episode_reward_max": -1.5000000000000009, "episode_reward_min": -5.800000000000004, "episode_reward_mean": -2.3075630252100847, "episode_len_mean": 33.87394957983193, "episode_media": {}, "episodes_this_iter": 119, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2.3000000000000016, -2.4000000000000017, -2.2000000000000015, -2.1000000000000014, -2.0000000000000013, -2.700000000000002, -2.600000000000002, -2.0000000000000013, -2.2000000000000015, -2.4000000000000017, -2.2000000000000015, -2.1000000000000014, -2.200000000000002, -1.700000000000001, -1.5000000000000009, -2.5000000000000018, -3.0000000000000018, -1.9000000000000012, -2.1000000000000014, -1.8000000000000012, -2.600000000000002, -1.9000000000000012, -2.3000000000000016, -1.9000000000000012, -1.600000000000001, -2.4000000000000017, -1.700000000000001, -2.600000000000002, -2.3000000000000016, -1.9000000000000012, -1.8000000000000012, -2.800000000000002, -1.600000000000001, -3.0000000000000018, -2.700000000000002, -2.1000000000000014, -1.600000000000001, -2.0000000000000013, -2.800000000000002, -1.8000000000000012, -1.9000000000000012, -3.3000000000000007, -2.2000000000000015, -2.2000000000000015, -2.2000000000000015, -2.2000000000000015, -2.600000000000002, -2.2000000000000015, -1.700000000000001, -2.2000000000000015, -1.8000000000000012, -2.700000000000002, -2.2000000000000015, -2.600000000000002, -2.5000000000000018, -2.1000000000000014, -2.600000000000002, -2.1000000000000014, -1.8000000000000012, -3.0000000000000018, -2.4000000000000017, -2.2000000000000015, -1.8000000000000012, -1.700000000000001, -2.900000000000002, -1.8000000000000012, -2.5000000000000018, -2.4000000000000017, -2.1000000000000014, -2.800000000000002, -2.2000000000000015, -2.900000000000002, -2.4000000000000017, -2.0000000000000013, -2.5000000000000018, -2.5000000000000018, -2.600000000000002, -2.0000000000000013, -2.3000000000000016, -2.1000000000000014, -1.9000000000000012, -2.5000000000000018, -2.1000000000000014, -2.800000000000002, -2.3000000000000016, -2.0000000000000013, -2.700000000000002, -2.0000000000000013, -2.800000000000002, -2.0000000000000013, -2.3000000000000016, -2.3000000000000016, -4.699999999999996, -2.0000000000000013, -2.0000000000000013, -2.0000000000000013, -2.3000000000000016, -2.0000000000000013, -2.2000000000000015, -2.5000000000000018, -2.4000000000000017, -2.2000000000000015, -1.5000000000000009, -2.3000000000000016, -2.5000000000000018, -2.900000000000002, -2.600000000000002, -2.5000000000000018, -1.9000000000000012, -5.800000000000004, -2.4000000000000017, -2.1000000000000014, -2.1000000000000014, -1.700000000000001, -2.5000000000000018, -2.4000000000000017, -2.2000000000000015, -1.9000000000000012, -3.799999999999999], "episode_lengths": [34, 35, 33, 32, 31, 38, 37, 31, 33, 35, 33, 28, 32, 28, 26, 36, 41, 30, 32, 29, 37, 30, 34, 30, 27, 35, 28, 37, 34, 30, 29, 39, 27, 38, 38, 32, 27, 31, 39, 29, 30, 44, 33, 33, 33, 33, 37, 33, 28, 33, 29, 38, 33, 37, 36, 32, 37, 32, 29, 41, 35, 33, 29, 28, 40, 29, 36, 35, 32, 39, 33, 40, 35, 31, 36, 36, 37, 31, 34, 32, 30, 36, 32, 39, 34, 31, 38, 31, 39, 31, 34, 34, 58, 31, 31, 31, 34, 31, 33, 36, 33, 33, 26, 34, 36, 40, 37, 36, 30, 55, 35, 32, 32, 28, 36, 35, 33, 30, 49]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.31465961214207755, "mean_inference_ms": 0.7684533299046928, "mean_action_processing_ms": 0.08055107277806306, "mean_env_wait_ms": 6.971666537127291, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006813562216878939, "StateBufferConnector_ms": 0.0036770556153369553, "ViewRequirementAgentConnector_ms": 0.08859273766269203}}, "episode_reward_max": -1.5000000000000009, "episode_reward_min": -5.800000000000004, "episode_reward_mean": -2.3075630252100847, "episode_len_mean": 33.87394957983193, "episodes_this_iter": 119, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-2.3000000000000016, -2.4000000000000017, -2.2000000000000015, -2.1000000000000014, -2.0000000000000013, -2.700000000000002, -2.600000000000002, -2.0000000000000013, -2.2000000000000015, -2.4000000000000017, -2.2000000000000015, -2.1000000000000014, -2.200000000000002, -1.700000000000001, -1.5000000000000009, -2.5000000000000018, -3.0000000000000018, -1.9000000000000012, -2.1000000000000014, -1.8000000000000012, -2.600000000000002, -1.9000000000000012, -2.3000000000000016, -1.9000000000000012, -1.600000000000001, -2.4000000000000017, -1.700000000000001, -2.600000000000002, -2.3000000000000016, -1.9000000000000012, -1.8000000000000012, -2.800000000000002, -1.600000000000001, -3.0000000000000018, -2.700000000000002, -2.1000000000000014, -1.600000000000001, -2.0000000000000013, -2.800000000000002, -1.8000000000000012, -1.9000000000000012, -3.3000000000000007, -2.2000000000000015, -2.2000000000000015, -2.2000000000000015, -2.2000000000000015, -2.600000000000002, -2.2000000000000015, -1.700000000000001, -2.2000000000000015, -1.8000000000000012, -2.700000000000002, -2.2000000000000015, -2.600000000000002, -2.5000000000000018, -2.1000000000000014, -2.600000000000002, -2.1000000000000014, -1.8000000000000012, -3.0000000000000018, -2.4000000000000017, -2.2000000000000015, -1.8000000000000012, -1.700000000000001, -2.900000000000002, -1.8000000000000012, -2.5000000000000018, -2.4000000000000017, -2.1000000000000014, -2.800000000000002, -2.2000000000000015, -2.900000000000002, -2.4000000000000017, -2.0000000000000013, -2.5000000000000018, -2.5000000000000018, -2.600000000000002, -2.0000000000000013, -2.3000000000000016, -2.1000000000000014, -1.9000000000000012, -2.5000000000000018, -2.1000000000000014, -2.800000000000002, -2.3000000000000016, -2.0000000000000013, -2.700000000000002, -2.0000000000000013, -2.800000000000002, -2.0000000000000013, -2.3000000000000016, -2.3000000000000016, -4.699999999999996, -2.0000000000000013, -2.0000000000000013, -2.0000000000000013, -2.3000000000000016, -2.0000000000000013, -2.2000000000000015, -2.5000000000000018, -2.4000000000000017, -2.2000000000000015, -1.5000000000000009, -2.3000000000000016, -2.5000000000000018, -2.900000000000002, -2.600000000000002, -2.5000000000000018, -1.9000000000000012, -5.800000000000004, -2.4000000000000017, -2.1000000000000014, -2.1000000000000014, -1.700000000000001, -2.5000000000000018, -2.4000000000000017, -2.2000000000000015, -1.9000000000000012, -3.799999999999999], "episode_lengths": [34, 35, 33, 32, 31, 38, 37, 31, 33, 35, 33, 28, 32, 28, 26, 36, 41, 30, 32, 29, 37, 30, 34, 30, 27, 35, 28, 37, 34, 30, 29, 39, 27, 38, 38, 32, 27, 31, 39, 29, 30, 44, 33, 33, 33, 33, 37, 33, 28, 33, 29, 38, 33, 37, 36, 32, 37, 32, 29, 41, 35, 33, 29, 28, 40, 29, 36, 35, 32, 39, 33, 40, 35, 31, 36, 36, 37, 31, 34, 32, 30, 36, 32, 39, 34, 31, 38, 31, 39, 31, 34, 34, 58, 31, 31, 31, 34, 31, 33, 36, 33, 33, 26, 34, 36, 40, 37, 36, 30, 55, 35, 32, 32, 28, 36, 35, 33, 30, 49]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.31465961214207755, "mean_inference_ms": 0.7684533299046928, "mean_action_processing_ms": 0.08055107277806306, "mean_env_wait_ms": 6.971666537127291, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006813562216878939, "StateBufferConnector_ms": 0.0036770556153369553, "ViewRequirementAgentConnector_ms": 0.08859273766269203}, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 192000, "num_agent_steps_trained": 192000, "num_env_steps_sampled": 192000, "num_env_steps_trained": 192000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 422.6157499962656, "num_env_steps_trained_throughput_per_sec": 422.6157499962656, "timesteps_total": 192000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 192000, "timers": {"training_iteration_time_ms": 9592.609, "sample_time_ms": 5892.126, "load_time_ms": 1.021, "load_throughput": 3915884.605, "learn_time_ms": 3696.708, "learn_throughput": 1082.044, "synch_weights_time_ms": 2.1}, "counters": {"num_env_steps_sampled": 192000, "num_env_steps_trained": 192000, "num_agent_steps_sampled": 192000, "num_agent_steps_trained": 192000}, "done": false, "episodes_total": 2483, "training_iteration": 48, "trial_id": "b7012_00000", "date": "2024-03-07_12-47-46", "timestamp": 1709833666, "time_this_iter_s": 9.467595338821411, "time_total_s": 461.1009171009064, "pid": 109767, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4d85689f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 461.1009171009064, "iterations_since_restore": 48, "perf": {"cpu_util_percent": 27.09230769230769, "ram_util_percent": 51.29999999999999, "gpu_util_percent0": 0.09615384615384616, "vram_util_percent0": 0.12548828125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.10000000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 0.1235311938114264, "policy_loss": -0.0069826860241191365, "vf_loss": 0.12955145117155806, "vf_explained_var": 0.9132343704982471, "kl": 0.00962429260972221, "entropy": 0.2902417639090169, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 45105.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 196000, "num_env_steps_trained": 196000, "num_agent_steps_sampled": 196000, "num_agent_steps_trained": 196000}, "sampler_results": {"episode_reward_max": -1.4000000000000008, "episode_reward_min": -4.4999999999999964, "episode_reward_mean": -2.163414634146343, "episode_len_mean": 32.46341463414634, "episode_media": {}, "episodes_this_iter": 123, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1.700000000000001, -3.4000000000000012, -1.600000000000001, -1.600000000000001, -1.600000000000001, -1.9000000000000012, -2.700000000000002, -2.2000000000000015, -2.5000000000000018, -2.4000000000000017, -1.9000000000000012, -2.600000000000002, -2.2000000000000015, -2.4000000000000017, -2.2000000000000015, -1.9000000000000012, -1.4000000000000008, -1.4000000000000008, -2.4000000000000017, -2.3000000000000016, -2.0000000000000013, -1.9000000000000012, -2.3000000000000016, -2.900000000000002, -2.3000000000000016, -1.700000000000001, -2.5000000000000018, -1.5000000000000009, -1.8000000000000012, -1.9000000000000012, -1.9000000000000012, -1.700000000000001, -2.800000000000002, -2.3000000000000016, -2.3000000000000016, -2.4000000000000017, -1.700000000000001, -1.9000000000000012, -1.8000000000000012, -2.0000000000000013, -2.2000000000000015, -2.3000000000000016, -2.800000000000002, -2.600000000000002, -1.9000000000000012, -2.5000000000000018, -2.3000000000000016, -2.3000000000000016, -2.2000000000000015, -2.4000000000000017, -1.4000000000000008, -2.3000000000000016, -1.4000000000000008, -3.200000000000001, -4.100000000000002, -2.4000000000000017, -2.1000000000000014, -3.0000000000000018, -2.3000000000000016, -2.900000000000002, -1.9000000000000012, -1.8000000000000012, -2.1000000000000014, -1.8000000000000012, -1.700000000000001, -2.1000000000000014, -2.600000000000002, -1.4000000000000008, -1.9000000000000012, -2.1000000000000014, -1.700000000000001, -2.4000000000000017, -2.1000000000000014, -2.4000000000000017, -1.9000000000000012, -2.3000000000000016, -2.4000000000000017, -2.0000000000000013, -2.1000000000000014, -1.9000000000000012, -2.0000000000000013, -2.1000000000000014, -1.5000000000000009, -2.2000000000000015, -1.8000000000000012, -2.2000000000000015, -2.5000000000000018, -1.600000000000001, -2.1000000000000014, -2.800000000000002, -1.9000000000000012, -2.0000000000000013, -2.900000000000002, -2.0000000000000013, -2.3000000000000016, -1.9000000000000012, -2.4000000000000017, -2.3000000000000016, -1.700000000000001, -2.5000000000000018, -4.4999999999999964, -1.9000000000000012, -2.5000000000000018, -2.1000000000000014, -2.2000000000000015, -1.9000000000000012, -2.0000000000000013, -1.600000000000001, -1.8000000000000012, -2.3000000000000016, -2.2000000000000015, -2.1000000000000014, -1.700000000000001, -2.1000000000000014, -1.8000000000000012, -2.600000000000002, -2.2000000000000015, -2.3000000000000016, -1.700000000000001, -2.1000000000000014, -1.4000000000000008, -2.800000000000002, -2.5000000000000018], "episode_lengths": [28, 43, 27, 27, 27, 30, 38, 33, 36, 35, 30, 37, 33, 35, 33, 30, 25, 25, 35, 34, 31, 30, 34, 40, 34, 28, 36, 26, 29, 30, 30, 28, 39, 34, 34, 35, 28, 30, 29, 31, 33, 34, 39, 37, 30, 36, 34, 34, 33, 35, 25, 34, 25, 39, 37, 35, 32, 41, 34, 40, 30, 29, 32, 29, 28, 32, 37, 25, 30, 32, 28, 35, 32, 35, 30, 34, 35, 31, 32, 30, 31, 32, 26, 33, 29, 33, 36, 27, 32, 39, 30, 31, 40, 31, 34, 30, 35, 34, 28, 36, 56, 30, 36, 32, 33, 30, 31, 27, 29, 34, 33, 32, 28, 32, 29, 37, 33, 34, 28, 32, 25, 39, 36]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3167029867052283, "mean_inference_ms": 0.7675612039870995, "mean_action_processing_ms": 0.08044350969686566, "mean_env_wait_ms": 6.986245163602203, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006816251491143451, "StateBufferConnector_ms": 0.003730766172331523, "ViewRequirementAgentConnector_ms": 0.08904216735343623}}, "episode_reward_max": -1.4000000000000008, "episode_reward_min": -4.4999999999999964, "episode_reward_mean": -2.163414634146343, "episode_len_mean": 32.46341463414634, "episodes_this_iter": 123, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1.700000000000001, -3.4000000000000012, -1.600000000000001, -1.600000000000001, -1.600000000000001, -1.9000000000000012, -2.700000000000002, -2.2000000000000015, -2.5000000000000018, -2.4000000000000017, -1.9000000000000012, -2.600000000000002, -2.2000000000000015, -2.4000000000000017, -2.2000000000000015, -1.9000000000000012, -1.4000000000000008, -1.4000000000000008, -2.4000000000000017, -2.3000000000000016, -2.0000000000000013, -1.9000000000000012, -2.3000000000000016, -2.900000000000002, -2.3000000000000016, -1.700000000000001, -2.5000000000000018, -1.5000000000000009, -1.8000000000000012, -1.9000000000000012, -1.9000000000000012, -1.700000000000001, -2.800000000000002, -2.3000000000000016, -2.3000000000000016, -2.4000000000000017, -1.700000000000001, -1.9000000000000012, -1.8000000000000012, -2.0000000000000013, -2.2000000000000015, -2.3000000000000016, -2.800000000000002, -2.600000000000002, -1.9000000000000012, -2.5000000000000018, -2.3000000000000016, -2.3000000000000016, -2.2000000000000015, -2.4000000000000017, -1.4000000000000008, -2.3000000000000016, -1.4000000000000008, -3.200000000000001, -4.100000000000002, -2.4000000000000017, -2.1000000000000014, -3.0000000000000018, -2.3000000000000016, -2.900000000000002, -1.9000000000000012, -1.8000000000000012, -2.1000000000000014, -1.8000000000000012, -1.700000000000001, -2.1000000000000014, -2.600000000000002, -1.4000000000000008, -1.9000000000000012, -2.1000000000000014, -1.700000000000001, -2.4000000000000017, -2.1000000000000014, -2.4000000000000017, -1.9000000000000012, -2.3000000000000016, -2.4000000000000017, -2.0000000000000013, -2.1000000000000014, -1.9000000000000012, -2.0000000000000013, -2.1000000000000014, -1.5000000000000009, -2.2000000000000015, -1.8000000000000012, -2.2000000000000015, -2.5000000000000018, -1.600000000000001, -2.1000000000000014, -2.800000000000002, -1.9000000000000012, -2.0000000000000013, -2.900000000000002, -2.0000000000000013, -2.3000000000000016, -1.9000000000000012, -2.4000000000000017, -2.3000000000000016, -1.700000000000001, -2.5000000000000018, -4.4999999999999964, -1.9000000000000012, -2.5000000000000018, -2.1000000000000014, -2.2000000000000015, -1.9000000000000012, -2.0000000000000013, -1.600000000000001, -1.8000000000000012, -2.3000000000000016, -2.2000000000000015, -2.1000000000000014, -1.700000000000001, -2.1000000000000014, -1.8000000000000012, -2.600000000000002, -2.2000000000000015, -2.3000000000000016, -1.700000000000001, -2.1000000000000014, -1.4000000000000008, -2.800000000000002, -2.5000000000000018], "episode_lengths": [28, 43, 27, 27, 27, 30, 38, 33, 36, 35, 30, 37, 33, 35, 33, 30, 25, 25, 35, 34, 31, 30, 34, 40, 34, 28, 36, 26, 29, 30, 30, 28, 39, 34, 34, 35, 28, 30, 29, 31, 33, 34, 39, 37, 30, 36, 34, 34, 33, 35, 25, 34, 25, 39, 37, 35, 32, 41, 34, 40, 30, 29, 32, 29, 28, 32, 37, 25, 30, 32, 28, 35, 32, 35, 30, 34, 35, 31, 32, 30, 31, 32, 26, 33, 29, 33, 36, 27, 32, 39, 30, 31, 40, 31, 34, 30, 35, 34, 28, 36, 56, 30, 36, 32, 33, 30, 31, 27, 29, 34, 33, 32, 28, 32, 29, 37, 33, 34, 28, 32, 25, 39, 36]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3167029867052283, "mean_inference_ms": 0.7675612039870995, "mean_action_processing_ms": 0.08044350969686566, "mean_env_wait_ms": 6.986245163602203, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006816251491143451, "StateBufferConnector_ms": 0.003730766172331523, "ViewRequirementAgentConnector_ms": 0.08904216735343623}, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 196000, "num_agent_steps_trained": 196000, "num_env_steps_sampled": 196000, "num_env_steps_trained": 196000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 418.57441532066923, "num_env_steps_trained_throughput_per_sec": 418.57441532066923, "timesteps_total": 196000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 196000, "timers": {"training_iteration_time_ms": 9633.354, "sample_time_ms": 5931.169, "load_time_ms": 0.99, "load_throughput": 4038518.162, "learn_time_ms": 3698.452, "learn_throughput": 1081.533, "synch_weights_time_ms": 2.079}, "counters": {"num_env_steps_sampled": 196000, "num_env_steps_trained": 196000, "num_agent_steps_sampled": 196000, "num_agent_steps_trained": 196000}, "done": false, "episodes_total": 2606, "training_iteration": 49, "trial_id": "b7012_00000", "date": "2024-03-07_12-47-56", "timestamp": 1709833676, "time_this_iter_s": 9.559099912643433, "time_total_s": 470.6600170135498, "pid": 109767, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4d85689f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 470.6600170135498, "iterations_since_restore": 49, "perf": {"cpu_util_percent": 28.308333333333334, "ram_util_percent": 51.29999999999999, "gpu_util_percent0": 0.08166666666666667, "vram_util_percent0": 0.12552897135416666}}
{"evaluation": {"sampler_results": {"episode_reward_max": -1.700000000000001, "episode_reward_min": -2.800000000000002, "episode_reward_mean": -2.1500000000000012, "episode_len_mean": 32.5, "episode_media": {}, "episodes_this_iter": 20, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2.0000000000000013, -1.8000000000000012, -2.3000000000000016, -2.800000000000002, -2.700000000000002, -2.2000000000000015, -2.700000000000002, -2.0000000000000013, -2.700000000000002, -2.3000000000000016, -1.8000000000000012, -2.0000000000000013, -1.9000000000000012, -1.700000000000001, -1.9000000000000012, -1.9000000000000012, -2.3000000000000016, -2.4000000000000017, -1.700000000000001, -1.9000000000000012], "episode_lengths": [31, 29, 34, 39, 38, 33, 38, 31, 38, 34, 29, 31, 30, 28, 30, 30, 34, 35, 28, 30]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.35546415595598113, "mean_inference_ms": 1.1708644861083608, "mean_action_processing_ms": 0.06768377512098273, "mean_env_wait_ms": 6.975708652385004, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0052547454833984375, "StateBufferConnector_ms": 0.003393888473510742, "ViewRequirementAgentConnector_ms": 0.06766319274902344}}, "episode_reward_max": -1.700000000000001, "episode_reward_min": -2.800000000000002, "episode_reward_mean": -2.1500000000000012, "episode_len_mean": 32.5, "episode_media": {}, "episodes_this_iter": 20, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2.0000000000000013, -1.8000000000000012, -2.3000000000000016, -2.800000000000002, -2.700000000000002, -2.2000000000000015, -2.700000000000002, -2.0000000000000013, -2.700000000000002, -2.3000000000000016, -1.8000000000000012, -2.0000000000000013, -1.9000000000000012, -1.700000000000001, -1.9000000000000012, -1.9000000000000012, -2.3000000000000016, -2.4000000000000017, -1.700000000000001, -1.9000000000000012], "episode_lengths": [31, 29, 34, 39, 38, 33, 38, 31, 38, 34, 29, 31, 30, 28, 30, 30, 34, 35, 28, 30]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.35546415595598113, "mean_inference_ms": 1.1708644861083608, "mean_action_processing_ms": 0.06768377512098273, "mean_env_wait_ms": 6.975708652385004, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0052547454833984375, "StateBufferConnector_ms": 0.003393888473510742, "ViewRequirementAgentConnector_ms": 0.06766319274902344}, "num_agent_steps_sampled_this_iter": 650, "num_env_steps_sampled_this_iter": 650, "timesteps_this_iter": 650, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.10000000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 0.2800774017463423, "policy_loss": -0.002914645220403389, "vf_loss": 0.2822690280484817, "vf_explained_var": 0.8828000529478955, "kl": 0.007230179746072259, "entropy": 0.29047639269021247, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 46035.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 200000, "num_env_steps_trained": 200000, "num_agent_steps_sampled": 200000, "num_agent_steps_trained": 200000}, "sampler_results": {"episode_reward_max": -1.4000000000000008, "episode_reward_min": -4.500000000000003, "episode_reward_mean": -2.1500000000000012, "episode_len_mean": 32.416666666666664, "episode_media": {}, "episodes_this_iter": 120, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2.600000000000002, -3.1000000000000014, -2.700000000000002, -2.3000000000000016, -1.4000000000000008, -1.8000000000000012, -1.700000000000001, -2.1000000000000014, -2.1000000000000014, -1.600000000000001, -2.0000000000000013, -1.700000000000001, -2.3000000000000016, -1.700000000000001, -1.9000000000000012, -1.4000000000000008, -1.600000000000001, -2.3000000000000016, -2.4000000000000017, -2.0000000000000013, -2.3000000000000016, -1.600000000000001, -2.2000000000000015, -2.600000000000002, -2.5000000000000018, -2.2000000000000015, -2.600000000000002, -2.3000000000000016, -2.600000000000002, -1.700000000000001, -2.2000000000000015, -1.8000000000000012, -2.2000000000000015, -1.600000000000001, -2.0000000000000013, -2.2000000000000015, -1.9000000000000012, -2.1000000000000014, -2.3000000000000016, -2.5000000000000018, -1.4000000000000008, -1.4000000000000008, -3.4000000000000004, -2.4000000000000017, -1.8000000000000012, -2.0000000000000013, -2.2000000000000015, -1.9000000000000012, -2.0000000000000013, -2.5000000000000018, -2.0000000000000013, -2.4000000000000017, -1.8000000000000012, -1.9000000000000012, -2.0000000000000013, -2.2000000000000015, -2.5000000000000018, -2.3000000000000016, -2.4000000000000017, -2.1000000000000014, -2.700000000000002, -2.800000000000002, -2.900000000000002, -2.3000000000000016, -2.2000000000000015, -2.0000000000000013, -1.700000000000001, -1.700000000000001, -2.3000000000000016, -2.900000000000002, -2.2000000000000015, -1.8000000000000012, -1.700000000000001, -1.9000000000000012, -2.700000000000002, -1.700000000000001, -2.3000000000000016, -1.8000000000000012, -2.0000000000000013, -1.9000000000000012, -2.700000000000002, -1.600000000000001, -2.2000000000000015, -2.900000000000002, -2.3000000000000016, -2.0000000000000013, -2.3000000000000016, -2.1000000000000014, -2.900000000000002, -2.3000000000000016, -2.1000000000000014, -2.0000000000000013, -2.1000000000000014, -1.4000000000000008, -2.3000000000000016, -2.1000000000000014, -2.1000000000000014, -1.5000000000000009, -2.0000000000000013, -2.0000000000000013, -2.4000000000000017, -4.500000000000003, -1.8000000000000012, -2.3000000000000016, -2.5000000000000018, -2.1000000000000014, -1.9000000000000012, -2.4000000000000017, -2.3000000000000016, -2.5000000000000018, -2.1000000000000014, -2.2000000000000015, -1.9000000000000012, -2.4000000000000017, -1.700000000000001, -2.1000000000000014, -1.700000000000001, -2.3000000000000016, -1.8000000000000012, -2.0000000000000013], "episode_lengths": [37, 42, 38, 34, 25, 29, 28, 32, 32, 27, 31, 28, 34, 28, 30, 25, 27, 34, 35, 31, 34, 27, 33, 37, 36, 33, 37, 34, 37, 28, 33, 29, 33, 27, 31, 33, 30, 32, 34, 36, 25, 25, 45, 35, 29, 31, 33, 30, 31, 36, 31, 35, 29, 30, 31, 33, 36, 34, 35, 32, 38, 39, 40, 34, 33, 31, 28, 28, 34, 40, 33, 29, 28, 30, 38, 28, 34, 29, 29, 30, 38, 27, 33, 40, 34, 31, 34, 32, 40, 34, 32, 31, 32, 25, 34, 32, 32, 26, 31, 31, 35, 48, 29, 34, 36, 32, 30, 35, 34, 36, 32, 33, 30, 35, 28, 32, 28, 34, 29, 31]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3185249527830793, "mean_inference_ms": 0.7665315014109602, "mean_action_processing_ms": 0.08039753738632854, "mean_env_wait_ms": 6.995323618216536, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00679473082224528, "StateBufferConnector_ms": 0.00369568665822347, "ViewRequirementAgentConnector_ms": 0.08892357349395752}}, "episode_reward_max": -1.4000000000000008, "episode_reward_min": -4.500000000000003, "episode_reward_mean": -2.1500000000000012, "episode_len_mean": 32.416666666666664, "episodes_this_iter": 120, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-2.600000000000002, -3.1000000000000014, -2.700000000000002, -2.3000000000000016, -1.4000000000000008, -1.8000000000000012, -1.700000000000001, -2.1000000000000014, -2.1000000000000014, -1.600000000000001, -2.0000000000000013, -1.700000000000001, -2.3000000000000016, -1.700000000000001, -1.9000000000000012, -1.4000000000000008, -1.600000000000001, -2.3000000000000016, -2.4000000000000017, -2.0000000000000013, -2.3000000000000016, -1.600000000000001, -2.2000000000000015, -2.600000000000002, -2.5000000000000018, -2.2000000000000015, -2.600000000000002, -2.3000000000000016, -2.600000000000002, -1.700000000000001, -2.2000000000000015, -1.8000000000000012, -2.2000000000000015, -1.600000000000001, -2.0000000000000013, -2.2000000000000015, -1.9000000000000012, -2.1000000000000014, -2.3000000000000016, -2.5000000000000018, -1.4000000000000008, -1.4000000000000008, -3.4000000000000004, -2.4000000000000017, -1.8000000000000012, -2.0000000000000013, -2.2000000000000015, -1.9000000000000012, -2.0000000000000013, -2.5000000000000018, -2.0000000000000013, -2.4000000000000017, -1.8000000000000012, -1.9000000000000012, -2.0000000000000013, -2.2000000000000015, -2.5000000000000018, -2.3000000000000016, -2.4000000000000017, -2.1000000000000014, -2.700000000000002, -2.800000000000002, -2.900000000000002, -2.3000000000000016, -2.2000000000000015, -2.0000000000000013, -1.700000000000001, -1.700000000000001, -2.3000000000000016, -2.900000000000002, -2.2000000000000015, -1.8000000000000012, -1.700000000000001, -1.9000000000000012, -2.700000000000002, -1.700000000000001, -2.3000000000000016, -1.8000000000000012, -2.0000000000000013, -1.9000000000000012, -2.700000000000002, -1.600000000000001, -2.2000000000000015, -2.900000000000002, -2.3000000000000016, -2.0000000000000013, -2.3000000000000016, -2.1000000000000014, -2.900000000000002, -2.3000000000000016, -2.1000000000000014, -2.0000000000000013, -2.1000000000000014, -1.4000000000000008, -2.3000000000000016, -2.1000000000000014, -2.1000000000000014, -1.5000000000000009, -2.0000000000000013, -2.0000000000000013, -2.4000000000000017, -4.500000000000003, -1.8000000000000012, -2.3000000000000016, -2.5000000000000018, -2.1000000000000014, -1.9000000000000012, -2.4000000000000017, -2.3000000000000016, -2.5000000000000018, -2.1000000000000014, -2.2000000000000015, -1.9000000000000012, -2.4000000000000017, -1.700000000000001, -2.1000000000000014, -1.700000000000001, -2.3000000000000016, -1.8000000000000012, -2.0000000000000013], "episode_lengths": [37, 42, 38, 34, 25, 29, 28, 32, 32, 27, 31, 28, 34, 28, 30, 25, 27, 34, 35, 31, 34, 27, 33, 37, 36, 33, 37, 34, 37, 28, 33, 29, 33, 27, 31, 33, 30, 32, 34, 36, 25, 25, 45, 35, 29, 31, 33, 30, 31, 36, 31, 35, 29, 30, 31, 33, 36, 34, 35, 32, 38, 39, 40, 34, 33, 31, 28, 28, 34, 40, 33, 29, 28, 30, 38, 28, 34, 29, 29, 30, 38, 27, 33, 40, 34, 31, 34, 32, 40, 34, 32, 31, 32, 25, 34, 32, 32, 26, 31, 31, 35, 48, 29, 34, 36, 32, 30, 35, 34, 36, 32, 33, 30, 35, 28, 32, 28, 34, 29, 31]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3185249527830793, "mean_inference_ms": 0.7665315014109602, "mean_action_processing_ms": 0.08039753738632854, "mean_env_wait_ms": 6.995323618216536, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00679473082224528, "StateBufferConnector_ms": 0.00369568665822347, "ViewRequirementAgentConnector_ms": 0.08892357349395752}, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 200000, "num_agent_steps_trained": 200000, "num_env_steps_sampled": 200000, "num_env_steps_trained": 200000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 405.8767840525016, "num_env_steps_trained_throughput_per_sec": 405.8767840525016, "timesteps_total": 200000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 200000, "timers": {"training_iteration_time_ms": 9678.761, "sample_time_ms": 5964.466, "load_time_ms": 1.011, "load_throughput": 3957357.236, "learn_time_ms": 3710.569, "learn_throughput": 1078.002, "synch_weights_time_ms": 2.059}, "counters": {"num_env_steps_sampled": 200000, "num_env_steps_trained": 200000, "num_agent_steps_sampled": 200000, "num_agent_steps_trained": 200000}, "done": true, "episodes_total": 2726, "training_iteration": 50, "trial_id": "b7012_00000", "date": "2024-03-07_12-48-11", "timestamp": 1709833691, "time_this_iter_s": 15.449785470962524, "time_total_s": 486.10980248451233, "pid": 109767, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4d85689f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 486.10980248451233, "iterations_since_restore": 50, "perf": {"cpu_util_percent": 20.244999999999997, "ram_util_percent": 51.29999999999999, "gpu_util_percent0": 0.07150000000000001, "vram_util_percent0": 0.12548828125}}
