{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 7.599633692605521, "policy_loss": 0.007855015828885058, "vf_loss": 7.59034220813423, "vf_explained_var": -0.012675110242700065, "kl": 0.007182337871055402, "entropy": 1.0915427714265802, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 465.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000}, "sampler_results": {"episode_reward_max": -26.100000000000044, "episode_reward_min": -62.50000000000038, "episode_reward_mean": -46.92222222222246, "episode_len_mean": 334.0, "episode_media": {}, "episodes_this_iter": 9, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-26.100000000000044, -62.50000000000038, -46.200000000000244, -60.70000000000035, -55.80000000000045, -37.60000000000006, -59.900000000000354, -30.40000000000002, -43.10000000000017], "episode_lengths": [194, 400, 400, 400, 400, 258, 400, 244, 310]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23232148194802468, "mean_inference_ms": 0.7329167452653719, "mean_action_processing_ms": 0.07848241283314529, "mean_env_wait_ms": 6.446017990015025, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007600254482693142, "StateBufferConnector_ms": 0.004092852274576823, "ViewRequirementAgentConnector_ms": 0.09188652038574219}}, "episode_reward_max": -26.100000000000044, "episode_reward_min": -62.50000000000038, "episode_reward_mean": -46.92222222222246, "episode_len_mean": 334.0, "episodes_this_iter": 9, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-26.100000000000044, -62.50000000000038, -46.200000000000244, -60.70000000000035, -55.80000000000045, -37.60000000000006, -59.900000000000354, -30.40000000000002, -43.10000000000017], "episode_lengths": [194, 400, 400, 400, 400, 258, 400, 244, 310]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23232148194802468, "mean_inference_ms": 0.7329167452653719, "mean_action_processing_ms": 0.07848241283314529, "mean_env_wait_ms": 6.446017990015025, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007600254482693142, "StateBufferConnector_ms": 0.004092852274576823, "ViewRequirementAgentConnector_ms": 0.09188652038574219}, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 450.2748702540957, "num_env_steps_trained_throughput_per_sec": 450.2748702540957, "timesteps_total": 4000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 4000, "timers": {"training_iteration_time_ms": 8883.408, "sample_time_ms": 5116.471, "load_time_ms": 0.91, "load_throughput": 4394242.012, "learn_time_ms": 3763.072, "learn_throughput": 1062.961, "synch_weights_time_ms": 2.146}, "counters": {"num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000}, "done": false, "episodes_total": 9, "training_iteration": 1, "trial_id": "95ff9_00000", "date": "2024-03-07_12-32-08", "timestamp": 1709832728, "time_this_iter_s": 8.885438203811646, "time_total_s": 8.885438203811646, "pid": 108075, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4d85689f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 8.885438203811646, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 25.683333333333337, "ram_util_percent": 47.025, "gpu_util_percent0": 0.11166666666666668, "vram_util_percent0": 0.10979546440972222}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 4.890150526710736, "policy_loss": -0.013283083335526528, "vf_loss": 4.902155517225945, "vf_explained_var": -0.04930601683996057, "kl": 0.006390526981849974, "entropy": 1.0850978953863986, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 1395.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000}, "sampler_results": {"episode_reward_max": -9.799999999999985, "episode_reward_min": -62.50000000000038, "episode_reward_mean": -39.01666666666684, "episode_len_mean": 294.9166666666667, "episode_media": {}, "episodes_this_iter": 15, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-26.100000000000044, -62.50000000000038, -46.200000000000244, -60.70000000000035, -55.80000000000045, -37.60000000000006, -59.900000000000354, -30.40000000000002, -43.10000000000017, -36.00000000000005, -25.700000000000045, -14.499999999999964, -51.90000000000027, -9.799999999999985, -47.80000000000026, -57.800000000000445, -10.599999999999977, -22.60000000000005, -25.900000000000045, -49.300000000000296, -23.09999999999997, -48.90000000000031, -52.40000000000028, -37.800000000000104], "episode_lengths": [194, 400, 400, 400, 400, 258, 400, 244, 310, 260, 216, 147, 400, 93, 367, 400, 112, 195, 204, 400, 201, 400, 400, 277]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23387669114641255, "mean_inference_ms": 0.7298711120819412, "mean_action_processing_ms": 0.07825350485536459, "mean_env_wait_ms": 6.392454926934761, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007024407386779785, "StateBufferConnector_ms": 0.00392297903696696, "ViewRequirementAgentConnector_ms": 0.09036461512247722}}, "episode_reward_max": -9.799999999999985, "episode_reward_min": -62.50000000000038, "episode_reward_mean": -39.01666666666684, "episode_len_mean": 294.9166666666667, "episodes_this_iter": 15, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-26.100000000000044, -62.50000000000038, -46.200000000000244, -60.70000000000035, -55.80000000000045, -37.60000000000006, -59.900000000000354, -30.40000000000002, -43.10000000000017, -36.00000000000005, -25.700000000000045, -14.499999999999964, -51.90000000000027, -9.799999999999985, -47.80000000000026, -57.800000000000445, -10.599999999999977, -22.60000000000005, -25.900000000000045, -49.300000000000296, -23.09999999999997, -48.90000000000031, -52.40000000000028, -37.800000000000104], "episode_lengths": [194, 400, 400, 400, 400, 258, 400, 244, 310, 260, 216, 147, 400, 93, 367, 400, 112, 195, 204, 400, 201, 400, 400, 277]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23387669114641255, "mean_inference_ms": 0.7298711120819412, "mean_action_processing_ms": 0.07825350485536459, "mean_env_wait_ms": 6.392454926934761, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007024407386779785, "StateBufferConnector_ms": 0.00392297903696696, "ViewRequirementAgentConnector_ms": 0.09036461512247722}, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 458.722756424278, "num_env_steps_trained_throughput_per_sec": 458.722756424278, "timesteps_total": 8000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 8000, "timers": {"training_iteration_time_ms": 8801.621, "sample_time_ms": 5065.525, "load_time_ms": 0.914, "load_throughput": 4376474.762, "learn_time_ms": 3732.302, "learn_throughput": 1071.725, "synch_weights_time_ms": 2.171}, "counters": {"num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000}, "done": false, "episodes_total": 24, "training_iteration": 2, "trial_id": "95ff9_00000", "date": "2024-03-07_12-32-17", "timestamp": 1709832737, "time_this_iter_s": 8.722037076950073, "time_total_s": 17.60747528076172, "pid": 108075, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4d85689f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 17.60747528076172, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 27.390909090909087, "ram_util_percent": 47.3, "gpu_util_percent0": 0.1, "vram_util_percent0": 0.11027018229166669}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 5.281199396746133, "policy_loss": -0.0023762602599397783, "vf_loss": 5.282266540040252, "vf_explained_var": -0.18002088441643663, "kl": 0.006545622435799741, "entropy": 1.073556184896859, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 2325.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000}, "sampler_results": {"episode_reward_max": -6.799999999999991, "episode_reward_min": -62.50000000000038, "episode_reward_mean": -36.30000000000015, "episode_len_mean": 279.0, "episode_media": {}, "episodes_this_iter": 17, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-26.100000000000044, -62.50000000000038, -46.200000000000244, -60.70000000000035, -55.80000000000045, -37.60000000000006, -59.900000000000354, -30.40000000000002, -43.10000000000017, -36.00000000000005, -25.700000000000045, -14.499999999999964, -51.90000000000027, -9.799999999999985, -47.80000000000026, -57.800000000000445, -10.599999999999977, -22.60000000000005, -25.900000000000045, -49.300000000000296, -23.09999999999997, -48.90000000000031, -52.40000000000028, -37.800000000000104, -24.20000000000008, -56.60000000000036, -27.500000000000043, -7.299999999999988, -47.20000000000036, -27.20000000000006, -13.699999999999964, -14.699999999999973, -49.800000000000345, -35.40000000000004, -55.400000000000276, -49.00000000000032, -17.599999999999977, -51.40000000000028, -14.999999999999963, -53.10000000000037, -6.799999999999991], "episode_lengths": [194, 400, 400, 400, 400, 258, 400, 244, 310, 260, 216, 147, 400, 93, 367, 400, 112, 195, 204, 400, 201, 400, 400, 277, 188, 400, 234, 82, 400, 235, 139, 124, 400, 265, 400, 347, 155, 400, 131, 400, 61]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23446751999781498, "mean_inference_ms": 0.7279560869440451, "mean_action_processing_ms": 0.07785979393015864, "mean_env_wait_ms": 6.37857161073253, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006643155725990854, "StateBufferConnector_ms": 0.0038519138243140244, "ViewRequirementAgentConnector_ms": 0.08958258279939978}}, "episode_reward_max": -6.799999999999991, "episode_reward_min": -62.50000000000038, "episode_reward_mean": -36.30000000000015, "episode_len_mean": 279.0, "episodes_this_iter": 17, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-26.100000000000044, -62.50000000000038, -46.200000000000244, -60.70000000000035, -55.80000000000045, -37.60000000000006, -59.900000000000354, -30.40000000000002, -43.10000000000017, -36.00000000000005, -25.700000000000045, -14.499999999999964, -51.90000000000027, -9.799999999999985, -47.80000000000026, -57.800000000000445, -10.599999999999977, -22.60000000000005, -25.900000000000045, -49.300000000000296, -23.09999999999997, -48.90000000000031, -52.40000000000028, -37.800000000000104, -24.20000000000008, -56.60000000000036, -27.500000000000043, -7.299999999999988, -47.20000000000036, -27.20000000000006, -13.699999999999964, -14.699999999999973, -49.800000000000345, -35.40000000000004, -55.400000000000276, -49.00000000000032, -17.599999999999977, -51.40000000000028, -14.999999999999963, -53.10000000000037, -6.799999999999991], "episode_lengths": [194, 400, 400, 400, 400, 258, 400, 244, 310, 260, 216, 147, 400, 93, 367, 400, 112, 195, 204, 400, 201, 400, 400, 277, 188, 400, 234, 82, 400, 235, 139, 124, 400, 265, 400, 347, 155, 400, 131, 400, 61]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23446751999781498, "mean_inference_ms": 0.7279560869440451, "mean_action_processing_ms": 0.07785979393015864, "mean_env_wait_ms": 6.37857161073253, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006643155725990854, "StateBufferConnector_ms": 0.0038519138243140244, "ViewRequirementAgentConnector_ms": 0.08958258279939978}, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 456.7233828118341, "num_env_steps_trained_throughput_per_sec": 456.7233828118341, "timesteps_total": 12000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 12000, "timers": {"training_iteration_time_ms": 8787.076, "sample_time_ms": 5059.162, "load_time_ms": 1.207, "load_throughput": 3313908.875, "learn_time_ms": 3723.852, "learn_throughput": 1074.157, "synch_weights_time_ms": 2.166}, "counters": {"num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000}, "done": false, "episodes_total": 41, "training_iteration": 3, "trial_id": "95ff9_00000", "date": "2024-03-07_12-32-26", "timestamp": 1709832746, "time_this_iter_s": 8.760175228118896, "time_total_s": 26.367650508880615, "pid": 108075, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4d85689f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 26.367650508880615, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 25.725000000000005, "ram_util_percent": 47.349999999999994, "gpu_util_percent0": 0.12666666666666668, "vram_util_percent0": 0.11027018229166669}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 5.228792128703928, "policy_loss": 0.004525330899062977, "vf_loss": 5.222505778298583, "vf_explained_var": -0.042421481622162686, "kl": 0.008805068489257337, "entropy": 1.051154403148159, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 3255.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000}, "sampler_results": {"episode_reward_max": -3.799999999999999, "episode_reward_min": -62.50000000000038, "episode_reward_mean": -33.56333333333347, "episode_len_mean": 258.7, "episode_media": {}, "episodes_this_iter": 19, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-26.100000000000044, -62.50000000000038, -46.200000000000244, -60.70000000000035, -55.80000000000045, -37.60000000000006, -59.900000000000354, -30.40000000000002, -43.10000000000017, -36.00000000000005, -25.700000000000045, -14.499999999999964, -51.90000000000027, -9.799999999999985, -47.80000000000026, -57.800000000000445, -10.599999999999977, -22.60000000000005, -25.900000000000045, -49.300000000000296, -23.09999999999997, -48.90000000000031, -52.40000000000028, -37.800000000000104, -24.20000000000008, -56.60000000000036, -27.500000000000043, -7.299999999999988, -47.20000000000036, -27.20000000000006, -13.699999999999964, -14.699999999999973, -49.800000000000345, -35.40000000000004, -55.400000000000276, -49.00000000000032, -17.599999999999977, -51.40000000000028, -14.999999999999963, -53.10000000000037, -6.799999999999991, -54.900000000000375, -15.199999999999967, -34.69999999999998, -34.39999999999998, -6.9999999999999885, -45.80000000000023, -30.399999999999967, -48.60000000000022, -15.499999999999961, -4.299999999999997, -13.499999999999964, -52.300000000000374, -10.499999999999975, -20.60000000000002, -53.600000000000314, -42.30000000000022, -3.799999999999999, -20.899999999999977, -17.199999999999996], "episode_lengths": [194, 400, 400, 400, 400, 258, 400, 244, 310, 260, 216, 147, 400, 93, 367, 400, 112, 195, 204, 400, 201, 400, 400, 277, 188, 400, 234, 82, 400, 235, 139, 124, 400, 265, 400, 347, 155, 400, 131, 400, 61, 400, 121, 252, 237, 80, 345, 228, 321, 145, 54, 135, 400, 106, 178, 400, 305, 49, 153, 174]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23545867423609287, "mean_inference_ms": 0.7267581119074737, "mean_action_processing_ms": 0.07760806242302493, "mean_env_wait_ms": 6.369393891856407, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00655055046081543, "StateBufferConnector_ms": 0.0038131078084309897, "ViewRequirementAgentConnector_ms": 0.08952498435974121}}, "episode_reward_max": -3.799999999999999, "episode_reward_min": -62.50000000000038, "episode_reward_mean": -33.56333333333347, "episode_len_mean": 258.7, "episodes_this_iter": 19, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-26.100000000000044, -62.50000000000038, -46.200000000000244, -60.70000000000035, -55.80000000000045, -37.60000000000006, -59.900000000000354, -30.40000000000002, -43.10000000000017, -36.00000000000005, -25.700000000000045, -14.499999999999964, -51.90000000000027, -9.799999999999985, -47.80000000000026, -57.800000000000445, -10.599999999999977, -22.60000000000005, -25.900000000000045, -49.300000000000296, -23.09999999999997, -48.90000000000031, -52.40000000000028, -37.800000000000104, -24.20000000000008, -56.60000000000036, -27.500000000000043, -7.299999999999988, -47.20000000000036, -27.20000000000006, -13.699999999999964, -14.699999999999973, -49.800000000000345, -35.40000000000004, -55.400000000000276, -49.00000000000032, -17.599999999999977, -51.40000000000028, -14.999999999999963, -53.10000000000037, -6.799999999999991, -54.900000000000375, -15.199999999999967, -34.69999999999998, -34.39999999999998, -6.9999999999999885, -45.80000000000023, -30.399999999999967, -48.60000000000022, -15.499999999999961, -4.299999999999997, -13.499999999999964, -52.300000000000374, -10.499999999999975, -20.60000000000002, -53.600000000000314, -42.30000000000022, -3.799999999999999, -20.899999999999977, -17.199999999999996], "episode_lengths": [194, 400, 400, 400, 400, 258, 400, 244, 310, 260, 216, 147, 400, 93, 367, 400, 112, 195, 204, 400, 201, 400, 400, 277, 188, 400, 234, 82, 400, 235, 139, 124, 400, 265, 400, 347, 155, 400, 131, 400, 61, 400, 121, 252, 237, 80, 345, 228, 321, 145, 54, 135, 400, 106, 178, 400, 305, 49, 153, 174]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23545867423609287, "mean_inference_ms": 0.7267581119074737, "mean_action_processing_ms": 0.07760806242302493, "mean_env_wait_ms": 6.369393891856407, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00655055046081543, "StateBufferConnector_ms": 0.0038131078084309897, "ViewRequirementAgentConnector_ms": 0.08952498435974121}, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 456.86474349881564, "num_env_steps_trained_throughput_per_sec": 456.86474349881564, "timesteps_total": 16000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 16000, "timers": {"training_iteration_time_ms": 8779.129, "sample_time_ms": 5051.348, "load_time_ms": 1.165, "load_throughput": 3434083.717, "learn_time_ms": 3723.66, "learn_throughput": 1074.212, "synch_weights_time_ms": 2.251}, "counters": {"num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000}, "done": false, "episodes_total": 60, "training_iteration": 4, "trial_id": "95ff9_00000", "date": "2024-03-07_12-32-35", "timestamp": 1709832755, "time_this_iter_s": 8.757547855377197, "time_total_s": 35.12519836425781, "pid": 108075, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4d85689f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 35.12519836425781, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 27.65454545454546, "ram_util_percent": 47.4, "gpu_util_percent0": 0.09636363636363637, "vram_util_percent0": 0.11027018229166669}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 6.097116015931611, "policy_loss": -0.01073179500558043, "vf_loss": 6.106577381107115, "vf_explained_var": -0.12374461671357513, "kl": 0.006352185860175436, "entropy": 1.0372323914240766, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 4185.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 20000}, "sampler_results": {"episode_reward_max": -3.799999999999999, "episode_reward_min": -64.80000000000038, "episode_reward_mean": -31.531168831168944, "episode_len_mean": 243.64935064935065, "episode_media": {}, "episodes_this_iter": 17, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-26.100000000000044, -62.50000000000038, -46.200000000000244, -60.70000000000035, -55.80000000000045, -37.60000000000006, -59.900000000000354, -30.40000000000002, -43.10000000000017, -36.00000000000005, -25.700000000000045, -14.499999999999964, -51.90000000000027, -9.799999999999985, -47.80000000000026, -57.800000000000445, -10.599999999999977, -22.60000000000005, -25.900000000000045, -49.300000000000296, -23.09999999999997, -48.90000000000031, -52.40000000000028, -37.800000000000104, -24.20000000000008, -56.60000000000036, -27.500000000000043, -7.299999999999988, -47.20000000000036, -27.20000000000006, -13.699999999999964, -14.699999999999973, -49.800000000000345, -35.40000000000004, -55.400000000000276, -49.00000000000032, -17.599999999999977, -51.40000000000028, -14.999999999999963, -53.10000000000037, -6.799999999999991, -54.900000000000375, -15.199999999999967, -34.69999999999998, -34.39999999999998, -6.9999999999999885, -45.80000000000023, -30.399999999999967, -48.60000000000022, -15.499999999999961, -4.299999999999997, -13.499999999999964, -52.300000000000374, -10.499999999999975, -20.60000000000002, -53.600000000000314, -42.30000000000022, -3.799999999999999, -20.899999999999977, -17.199999999999996, -10.699999999999987, -47.400000000000276, -32.600000000000016, -4.599999999999996, -64.80000000000038, -17.499999999999968, -21.500000000000007, -11.99999999999997, -12.799999999999974, -18.0, -25.399999999999956, -55.800000000000274, -38.80000000000015, -19.500000000000032, -10.099999999999977, -14.69999999999997, -7.899999999999988], "episode_lengths": [194, 400, 400, 400, 400, 258, 400, 244, 310, 260, 216, 147, 400, 93, 367, 400, 112, 195, 204, 400, 201, 400, 400, 277, 188, 400, 234, 82, 400, 235, 139, 124, 400, 265, 400, 347, 155, 400, 131, 400, 61, 400, 121, 252, 237, 80, 345, 228, 321, 145, 54, 135, 400, 106, 178, 400, 305, 49, 153, 174, 104, 385, 236, 57, 400, 157, 187, 103, 122, 167, 182, 368, 288, 163, 104, 130, 86]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23595247679611572, "mean_inference_ms": 0.7260853149851372, "mean_action_processing_ms": 0.07746025577186616, "mean_env_wait_ms": 6.365026129752081, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006601717564966771, "StateBufferConnector_ms": 0.0038041696920023335, "ViewRequirementAgentConnector_ms": 0.08930354923396916}}, "episode_reward_max": -3.799999999999999, "episode_reward_min": -64.80000000000038, "episode_reward_mean": -31.531168831168944, "episode_len_mean": 243.64935064935065, "episodes_this_iter": 17, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-26.100000000000044, -62.50000000000038, -46.200000000000244, -60.70000000000035, -55.80000000000045, -37.60000000000006, -59.900000000000354, -30.40000000000002, -43.10000000000017, -36.00000000000005, -25.700000000000045, -14.499999999999964, -51.90000000000027, -9.799999999999985, -47.80000000000026, -57.800000000000445, -10.599999999999977, -22.60000000000005, -25.900000000000045, -49.300000000000296, -23.09999999999997, -48.90000000000031, -52.40000000000028, -37.800000000000104, -24.20000000000008, -56.60000000000036, -27.500000000000043, -7.299999999999988, -47.20000000000036, -27.20000000000006, -13.699999999999964, -14.699999999999973, -49.800000000000345, -35.40000000000004, -55.400000000000276, -49.00000000000032, -17.599999999999977, -51.40000000000028, -14.999999999999963, -53.10000000000037, -6.799999999999991, -54.900000000000375, -15.199999999999967, -34.69999999999998, -34.39999999999998, -6.9999999999999885, -45.80000000000023, -30.399999999999967, -48.60000000000022, -15.499999999999961, -4.299999999999997, -13.499999999999964, -52.300000000000374, -10.499999999999975, -20.60000000000002, -53.600000000000314, -42.30000000000022, -3.799999999999999, -20.899999999999977, -17.199999999999996, -10.699999999999987, -47.400000000000276, -32.600000000000016, -4.599999999999996, -64.80000000000038, -17.499999999999968, -21.500000000000007, -11.99999999999997, -12.799999999999974, -18.0, -25.399999999999956, -55.800000000000274, -38.80000000000015, -19.500000000000032, -10.099999999999977, -14.69999999999997, -7.899999999999988], "episode_lengths": [194, 400, 400, 400, 400, 258, 400, 244, 310, 260, 216, 147, 400, 93, 367, 400, 112, 195, 204, 400, 201, 400, 400, 277, 188, 400, 234, 82, 400, 235, 139, 124, 400, 265, 400, 347, 155, 400, 131, 400, 61, 400, 121, 252, 237, 80, 345, 228, 321, 145, 54, 135, 400, 106, 178, 400, 305, 49, 153, 174, 104, 385, 236, 57, 400, 157, 187, 103, 122, 167, 182, 368, 288, 163, 104, 130, 86]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23595247679611572, "mean_inference_ms": 0.7260853149851372, "mean_action_processing_ms": 0.07746025577186616, "mean_env_wait_ms": 6.365026129752081, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006601717564966771, "StateBufferConnector_ms": 0.0038041696920023335, "ViewRequirementAgentConnector_ms": 0.08930354923396916}, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 20000, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 454.4960422483809, "num_env_steps_trained_throughput_per_sec": 454.4960422483809, "timesteps_total": 20000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 20000, "timers": {"training_iteration_time_ms": 8783.488, "sample_time_ms": 5061.163, "load_time_ms": 1.126, "load_throughput": 3553440.929, "learn_time_ms": 3718.288, "learn_throughput": 1075.764, "synch_weights_time_ms": 2.222}, "counters": {"num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 20000}, "done": false, "episodes_total": 77, "training_iteration": 5, "trial_id": "95ff9_00000", "date": "2024-03-07_12-32-43", "timestamp": 1709832763, "time_this_iter_s": 8.80319857597351, "time_total_s": 43.92839694023132, "pid": 108075, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4d85689f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 43.92839694023132, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 25.916666666666668, "ram_util_percent": 47.41666666666666, "gpu_util_percent0": 0.12666666666666668, "vram_util_percent0": 0.11027018229166669}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 5.527097205833722, "policy_loss": -0.01743326639776589, "vf_loss": 5.543187995783744, "vf_explained_var": -0.18833620714884933, "kl": 0.006712263855273334, "entropy": 1.0282315986771737, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 5115.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000}, "sampler_results": {"episode_reward_max": -3.799999999999999, "episode_reward_min": -64.80000000000038, "episode_reward_mean": -31.644680851063946, "episode_len_mean": 244.68085106382978, "episode_media": {}, "episodes_this_iter": 17, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-26.100000000000044, -62.50000000000038, -46.200000000000244, -60.70000000000035, -55.80000000000045, -37.60000000000006, -59.900000000000354, -30.40000000000002, -43.10000000000017, -36.00000000000005, -25.700000000000045, -14.499999999999964, -51.90000000000027, -9.799999999999985, -47.80000000000026, -57.800000000000445, -10.599999999999977, -22.60000000000005, -25.900000000000045, -49.300000000000296, -23.09999999999997, -48.90000000000031, -52.40000000000028, -37.800000000000104, -24.20000000000008, -56.60000000000036, -27.500000000000043, -7.299999999999988, -47.20000000000036, -27.20000000000006, -13.699999999999964, -14.699999999999973, -49.800000000000345, -35.40000000000004, -55.400000000000276, -49.00000000000032, -17.599999999999977, -51.40000000000028, -14.999999999999963, -53.10000000000037, -6.799999999999991, -54.900000000000375, -15.199999999999967, -34.69999999999998, -34.39999999999998, -6.9999999999999885, -45.80000000000023, -30.399999999999967, -48.60000000000022, -15.499999999999961, -4.299999999999997, -13.499999999999964, -52.300000000000374, -10.499999999999975, -20.60000000000002, -53.600000000000314, -42.30000000000022, -3.799999999999999, -20.899999999999977, -17.199999999999996, -10.699999999999987, -47.400000000000276, -32.600000000000016, -4.599999999999996, -64.80000000000038, -17.499999999999968, -21.500000000000007, -11.99999999999997, -12.799999999999974, -18.0, -25.399999999999956, -55.800000000000274, -38.80000000000015, -19.500000000000032, -10.099999999999977, -14.69999999999997, -7.899999999999988, -39.30000000000014, -22.300000000000004, -46.70000000000034, -9.699999999999989, -59.600000000000335, -52.0000000000003, -7.39999999999999, -41.10000000000009, -16.699999999999992, -14.89999999999996, -11.299999999999983, -51.800000000000246, -51.40000000000024, -61.70000000000039, -20.600000000000016, -23.79999999999999, -16.399999999999974], "episode_lengths": [194, 400, 400, 400, 400, 258, 400, 244, 310, 260, 216, 147, 400, 93, 367, 400, 112, 195, 204, 400, 201, 400, 400, 277, 188, 400, 234, 82, 400, 235, 139, 124, 400, 265, 400, 347, 155, 400, 131, 400, 61, 400, 121, 252, 237, 80, 345, 228, 321, 145, 54, 135, 400, 106, 178, 400, 305, 49, 153, 174, 104, 385, 236, 57, 400, 157, 187, 103, 122, 167, 182, 368, 288, 163, 104, 130, 86, 337, 187, 364, 80, 400, 400, 81, 289, 147, 146, 98, 400, 400, 400, 167, 193, 150]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23646719013081655, "mean_inference_ms": 0.7257086956603787, "mean_action_processing_ms": 0.07737482784502625, "mean_env_wait_ms": 6.367971056929587, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006557271835651804, "StateBufferConnector_ms": 0.0038185018174191738, "ViewRequirementAgentConnector_ms": 0.08919543408332987}}, "episode_reward_max": -3.799999999999999, "episode_reward_min": -64.80000000000038, "episode_reward_mean": -31.644680851063946, "episode_len_mean": 244.68085106382978, "episodes_this_iter": 17, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-26.100000000000044, -62.50000000000038, -46.200000000000244, -60.70000000000035, -55.80000000000045, -37.60000000000006, -59.900000000000354, -30.40000000000002, -43.10000000000017, -36.00000000000005, -25.700000000000045, -14.499999999999964, -51.90000000000027, -9.799999999999985, -47.80000000000026, -57.800000000000445, -10.599999999999977, -22.60000000000005, -25.900000000000045, -49.300000000000296, -23.09999999999997, -48.90000000000031, -52.40000000000028, -37.800000000000104, -24.20000000000008, -56.60000000000036, -27.500000000000043, -7.299999999999988, -47.20000000000036, -27.20000000000006, -13.699999999999964, -14.699999999999973, -49.800000000000345, -35.40000000000004, -55.400000000000276, -49.00000000000032, -17.599999999999977, -51.40000000000028, -14.999999999999963, -53.10000000000037, -6.799999999999991, -54.900000000000375, -15.199999999999967, -34.69999999999998, -34.39999999999998, -6.9999999999999885, -45.80000000000023, -30.399999999999967, -48.60000000000022, -15.499999999999961, -4.299999999999997, -13.499999999999964, -52.300000000000374, -10.499999999999975, -20.60000000000002, -53.600000000000314, -42.30000000000022, -3.799999999999999, -20.899999999999977, -17.199999999999996, -10.699999999999987, -47.400000000000276, -32.600000000000016, -4.599999999999996, -64.80000000000038, -17.499999999999968, -21.500000000000007, -11.99999999999997, -12.799999999999974, -18.0, -25.399999999999956, -55.800000000000274, -38.80000000000015, -19.500000000000032, -10.099999999999977, -14.69999999999997, -7.899999999999988, -39.30000000000014, -22.300000000000004, -46.70000000000034, -9.699999999999989, -59.600000000000335, -52.0000000000003, -7.39999999999999, -41.10000000000009, -16.699999999999992, -14.89999999999996, -11.299999999999983, -51.800000000000246, -51.40000000000024, -61.70000000000039, -20.600000000000016, -23.79999999999999, -16.399999999999974], "episode_lengths": [194, 400, 400, 400, 400, 258, 400, 244, 310, 260, 216, 147, 400, 93, 367, 400, 112, 195, 204, 400, 201, 400, 400, 277, 188, 400, 234, 82, 400, 235, 139, 124, 400, 265, 400, 347, 155, 400, 131, 400, 61, 400, 121, 252, 237, 80, 345, 228, 321, 145, 54, 135, 400, 106, 178, 400, 305, 49, 153, 174, 104, 385, 236, 57, 400, 157, 187, 103, 122, 167, 182, 368, 288, 163, 104, 130, 86, 337, 187, 364, 80, 400, 400, 81, 289, 147, 146, 98, 400, 400, 400, 167, 193, 150]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23646719013081655, "mean_inference_ms": 0.7257086956603787, "mean_action_processing_ms": 0.07737482784502625, "mean_env_wait_ms": 6.367971056929587, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006557271835651804, "StateBufferConnector_ms": 0.0038185018174191738, "ViewRequirementAgentConnector_ms": 0.08919543408332987}, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 450.4539035891239, "num_env_steps_trained_throughput_per_sec": 450.4539035891239, "timesteps_total": 24000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 24000, "timers": {"training_iteration_time_ms": 8799.557, "sample_time_ms": 5070.244, "load_time_ms": 1.099, "load_throughput": 3639835.696, "learn_time_ms": 3725.336, "learn_throughput": 1073.729, "synch_weights_time_ms": 2.199}, "counters": {"num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000}, "done": false, "episodes_total": 94, "training_iteration": 6, "trial_id": "95ff9_00000", "date": "2024-03-07_12-32-52", "timestamp": 1709832772, "time_this_iter_s": 8.882277250289917, "time_total_s": 52.81067419052124, "pid": 108075, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4d85689f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 52.81067419052124, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 28.936363636363637, "ram_util_percent": 47.49090909090909, "gpu_util_percent0": 0.10181818181818181, "vram_util_percent0": 0.11027018229166669}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 5.9840262517493255, "policy_loss": -0.01609539749321117, "vf_loss": 5.998782253730041, "vf_explained_var": -0.06738352743528223, "kl": 0.006696935996836645, "entropy": 1.0265920957570436, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 6045.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 28000}, "sampler_results": {"episode_reward_max": -3.4000000000000004, "episode_reward_min": -64.80000000000038, "episode_reward_mean": -27.579000000000093, "episode_len_mean": 219.76, "episode_media": {}, "episodes_this_iter": 23, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-22.60000000000005, -25.900000000000045, -49.300000000000296, -23.09999999999997, -48.90000000000031, -52.40000000000028, -37.800000000000104, -24.20000000000008, -56.60000000000036, -27.500000000000043, -7.299999999999988, -47.20000000000036, -27.20000000000006, -13.699999999999964, -14.699999999999973, -49.800000000000345, -35.40000000000004, -55.400000000000276, -49.00000000000032, -17.599999999999977, -51.40000000000028, -14.999999999999963, -53.10000000000037, -6.799999999999991, -54.900000000000375, -15.199999999999967, -34.69999999999998, -34.39999999999998, -6.9999999999999885, -45.80000000000023, -30.399999999999967, -48.60000000000022, -15.499999999999961, -4.299999999999997, -13.499999999999964, -52.300000000000374, -10.499999999999975, -20.60000000000002, -53.600000000000314, -42.30000000000022, -3.799999999999999, -20.899999999999977, -17.199999999999996, -10.699999999999987, -47.400000000000276, -32.600000000000016, -4.599999999999996, -64.80000000000038, -17.499999999999968, -21.500000000000007, -11.99999999999997, -12.799999999999974, -18.0, -25.399999999999956, -55.800000000000274, -38.80000000000015, -19.500000000000032, -10.099999999999977, -14.69999999999997, -7.899999999999988, -39.30000000000014, -22.300000000000004, -46.70000000000034, -9.699999999999989, -59.600000000000335, -52.0000000000003, -7.39999999999999, -41.10000000000009, -16.699999999999992, -14.89999999999996, -11.299999999999983, -51.800000000000246, -51.40000000000024, -61.70000000000039, -20.600000000000016, -23.79999999999999, -16.399999999999974, -55.30000000000039, -36.70000000000018, -13.799999999999969, -52.20000000000035, -7.499999999999988, -21.399999999999974, -5.999999999999996, -9.999999999999977, -10.499999999999979, -3.4000000000000004, -13.19999999999998, -4.999999999999995, -45.00000000000026, -6.199999999999997, -5.999999999999991, -29.899999999999988, -22.90000000000004, -14.19999999999997, -20.3, -14.399999999999963, -48.70000000000029, -8.099999999999985, -8.999999999999982], "episode_lengths": [195, 204, 400, 201, 400, 400, 277, 188, 400, 234, 82, 400, 235, 139, 124, 400, 265, 400, 347, 155, 400, 131, 400, 61, 400, 121, 252, 237, 80, 345, 228, 321, 145, 54, 135, 400, 106, 178, 400, 305, 49, 153, 174, 104, 385, 236, 57, 400, 157, 187, 103, 122, 167, 182, 368, 288, 163, 104, 130, 86, 337, 187, 364, 80, 400, 400, 81, 289, 147, 146, 98, 400, 400, 400, 167, 193, 150, 400, 305, 118, 400, 84, 171, 66, 98, 104, 45, 119, 61, 382, 65, 67, 236, 194, 142, 195, 135, 400, 91, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23801346553399896, "mean_inference_ms": 0.7245826348325111, "mean_action_processing_ms": 0.07709497717393327, "mean_env_wait_ms": 6.37038614846348, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0064389705657958984, "StateBufferConnector_ms": 0.003816843032836914, "ViewRequirementAgentConnector_ms": 0.08928656578063965}}, "episode_reward_max": -3.4000000000000004, "episode_reward_min": -64.80000000000038, "episode_reward_mean": -27.579000000000093, "episode_len_mean": 219.76, "episodes_this_iter": 23, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-22.60000000000005, -25.900000000000045, -49.300000000000296, -23.09999999999997, -48.90000000000031, -52.40000000000028, -37.800000000000104, -24.20000000000008, -56.60000000000036, -27.500000000000043, -7.299999999999988, -47.20000000000036, -27.20000000000006, -13.699999999999964, -14.699999999999973, -49.800000000000345, -35.40000000000004, -55.400000000000276, -49.00000000000032, -17.599999999999977, -51.40000000000028, -14.999999999999963, -53.10000000000037, -6.799999999999991, -54.900000000000375, -15.199999999999967, -34.69999999999998, -34.39999999999998, -6.9999999999999885, -45.80000000000023, -30.399999999999967, -48.60000000000022, -15.499999999999961, -4.299999999999997, -13.499999999999964, -52.300000000000374, -10.499999999999975, -20.60000000000002, -53.600000000000314, -42.30000000000022, -3.799999999999999, -20.899999999999977, -17.199999999999996, -10.699999999999987, -47.400000000000276, -32.600000000000016, -4.599999999999996, -64.80000000000038, -17.499999999999968, -21.500000000000007, -11.99999999999997, -12.799999999999974, -18.0, -25.399999999999956, -55.800000000000274, -38.80000000000015, -19.500000000000032, -10.099999999999977, -14.69999999999997, -7.899999999999988, -39.30000000000014, -22.300000000000004, -46.70000000000034, -9.699999999999989, -59.600000000000335, -52.0000000000003, -7.39999999999999, -41.10000000000009, -16.699999999999992, -14.89999999999996, -11.299999999999983, -51.800000000000246, -51.40000000000024, -61.70000000000039, -20.600000000000016, -23.79999999999999, -16.399999999999974, -55.30000000000039, -36.70000000000018, -13.799999999999969, -52.20000000000035, -7.499999999999988, -21.399999999999974, -5.999999999999996, -9.999999999999977, -10.499999999999979, -3.4000000000000004, -13.19999999999998, -4.999999999999995, -45.00000000000026, -6.199999999999997, -5.999999999999991, -29.899999999999988, -22.90000000000004, -14.19999999999997, -20.3, -14.399999999999963, -48.70000000000029, -8.099999999999985, -8.999999999999982], "episode_lengths": [195, 204, 400, 201, 400, 400, 277, 188, 400, 234, 82, 400, 235, 139, 124, 400, 265, 400, 347, 155, 400, 131, 400, 61, 400, 121, 252, 237, 80, 345, 228, 321, 145, 54, 135, 400, 106, 178, 400, 305, 49, 153, 174, 104, 385, 236, 57, 400, 157, 187, 103, 122, 167, 182, 368, 288, 163, 104, 130, 86, 337, 187, 364, 80, 400, 400, 81, 289, 147, 146, 98, 400, 400, 400, 167, 193, 150, 400, 305, 118, 400, 84, 171, 66, 98, 104, 45, 119, 61, 382, 65, 67, 236, 194, 142, 195, 135, 400, 91, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23801346553399896, "mean_inference_ms": 0.7245826348325111, "mean_action_processing_ms": 0.07709497717393327, "mean_env_wait_ms": 6.37038614846348, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0064389705657958984, "StateBufferConnector_ms": 0.003816843032836914, "ViewRequirementAgentConnector_ms": 0.08928656578063965}, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 28000, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 448.53456311726677, "num_env_steps_trained_throughput_per_sec": 448.53456311726677, "timesteps_total": 28000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 28000, "timers": {"training_iteration_time_ms": 8816.464, "sample_time_ms": 5078.379, "load_time_ms": 1.078, "load_throughput": 3712125.423, "learn_time_ms": 3734.169, "learn_throughput": 1071.189, "synch_weights_time_ms": 2.157}, "counters": {"num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 28000}, "done": false, "episodes_total": 117, "training_iteration": 7, "trial_id": "95ff9_00000", "date": "2024-03-07_12-33-01", "timestamp": 1709832781, "time_this_iter_s": 8.920005559921265, "time_total_s": 61.730679750442505, "pid": 108075, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4d85689f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 61.730679750442505, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 26.241666666666664, "ram_util_percent": 47.41666666666666, "gpu_util_percent0": 0.11833333333333333, "vram_util_percent0": 0.11027018229166669}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 5.788479394041082, "policy_loss": -0.01727866982660627, "vf_loss": 5.804452974741817, "vf_explained_var": -0.1996068222548372, "kl": 0.00652545434608015, "entropy": 1.0112525892514055, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 6975.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000}, "sampler_results": {"episode_reward_max": -3.4000000000000004, "episode_reward_min": -64.80000000000038, "episode_reward_mean": -24.997000000000074, "episode_len_mean": 202.59, "episode_media": {}, "episodes_this_iter": 22, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-53.10000000000037, -6.799999999999991, -54.900000000000375, -15.199999999999967, -34.69999999999998, -34.39999999999998, -6.9999999999999885, -45.80000000000023, -30.399999999999967, -48.60000000000022, -15.499999999999961, -4.299999999999997, -13.499999999999964, -52.300000000000374, -10.499999999999975, -20.60000000000002, -53.600000000000314, -42.30000000000022, -3.799999999999999, -20.899999999999977, -17.199999999999996, -10.699999999999987, -47.400000000000276, -32.600000000000016, -4.599999999999996, -64.80000000000038, -17.499999999999968, -21.500000000000007, -11.99999999999997, -12.799999999999974, -18.0, -25.399999999999956, -55.800000000000274, -38.80000000000015, -19.500000000000032, -10.099999999999977, -14.69999999999997, -7.899999999999988, -39.30000000000014, -22.300000000000004, -46.70000000000034, -9.699999999999989, -59.600000000000335, -52.0000000000003, -7.39999999999999, -41.10000000000009, -16.699999999999992, -14.89999999999996, -11.299999999999983, -51.800000000000246, -51.40000000000024, -61.70000000000039, -20.600000000000016, -23.79999999999999, -16.399999999999974, -55.30000000000039, -36.70000000000018, -13.799999999999969, -52.20000000000035, -7.499999999999988, -21.399999999999974, -5.999999999999996, -9.999999999999977, -10.499999999999979, -3.4000000000000004, -13.19999999999998, -4.999999999999995, -45.00000000000026, -6.199999999999997, -5.999999999999991, -29.899999999999988, -22.90000000000004, -14.19999999999997, -20.3, -14.399999999999963, -48.70000000000029, -8.099999999999985, -8.999999999999982, -33.80000000000016, -23.000000000000007, -18.599999999999966, -27.90000000000001, -52.00000000000034, -46.600000000000264, -13.299999999999965, -28.70000000000008, -15.699999999999974, -10.89999999999999, -49.10000000000032, -16.099999999999977, -9.099999999999987, -14.399999999999967, -9.499999999999988, -50.60000000000036, -5.199999999999994, -5.199999999999994, -18.799999999999976, -29.900000000000095, -10.599999999999985, -4.799999999999995], "episode_lengths": [400, 61, 400, 121, 252, 237, 80, 345, 228, 321, 145, 54, 135, 400, 106, 178, 400, 305, 49, 153, 174, 104, 385, 236, 57, 400, 157, 187, 103, 122, 167, 182, 368, 288, 163, 104, 130, 86, 337, 187, 364, 80, 400, 400, 81, 289, 147, 146, 98, 400, 400, 400, 167, 193, 150, 400, 305, 118, 400, 84, 171, 66, 98, 104, 45, 119, 61, 382, 65, 67, 236, 194, 142, 195, 135, 400, 91, 99, 269, 206, 157, 239, 398, 400, 121, 262, 130, 98, 400, 155, 89, 123, 97, 400, 63, 63, 171, 258, 104, 57]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23938159161733696, "mean_inference_ms": 0.7243760705403927, "mean_action_processing_ms": 0.0768929165789924, "mean_env_wait_ms": 6.378297541684381, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0065653324127197266, "StateBufferConnector_ms": 0.0038192272186279297, "ViewRequirementAgentConnector_ms": 0.08935809135437012}}, "episode_reward_max": -3.4000000000000004, "episode_reward_min": -64.80000000000038, "episode_reward_mean": -24.997000000000074, "episode_len_mean": 202.59, "episodes_this_iter": 22, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-53.10000000000037, -6.799999999999991, -54.900000000000375, -15.199999999999967, -34.69999999999998, -34.39999999999998, -6.9999999999999885, -45.80000000000023, -30.399999999999967, -48.60000000000022, -15.499999999999961, -4.299999999999997, -13.499999999999964, -52.300000000000374, -10.499999999999975, -20.60000000000002, -53.600000000000314, -42.30000000000022, -3.799999999999999, -20.899999999999977, -17.199999999999996, -10.699999999999987, -47.400000000000276, -32.600000000000016, -4.599999999999996, -64.80000000000038, -17.499999999999968, -21.500000000000007, -11.99999999999997, -12.799999999999974, -18.0, -25.399999999999956, -55.800000000000274, -38.80000000000015, -19.500000000000032, -10.099999999999977, -14.69999999999997, -7.899999999999988, -39.30000000000014, -22.300000000000004, -46.70000000000034, -9.699999999999989, -59.600000000000335, -52.0000000000003, -7.39999999999999, -41.10000000000009, -16.699999999999992, -14.89999999999996, -11.299999999999983, -51.800000000000246, -51.40000000000024, -61.70000000000039, -20.600000000000016, -23.79999999999999, -16.399999999999974, -55.30000000000039, -36.70000000000018, -13.799999999999969, -52.20000000000035, -7.499999999999988, -21.399999999999974, -5.999999999999996, -9.999999999999977, -10.499999999999979, -3.4000000000000004, -13.19999999999998, -4.999999999999995, -45.00000000000026, -6.199999999999997, -5.999999999999991, -29.899999999999988, -22.90000000000004, -14.19999999999997, -20.3, -14.399999999999963, -48.70000000000029, -8.099999999999985, -8.999999999999982, -33.80000000000016, -23.000000000000007, -18.599999999999966, -27.90000000000001, -52.00000000000034, -46.600000000000264, -13.299999999999965, -28.70000000000008, -15.699999999999974, -10.89999999999999, -49.10000000000032, -16.099999999999977, -9.099999999999987, -14.399999999999967, -9.499999999999988, -50.60000000000036, -5.199999999999994, -5.199999999999994, -18.799999999999976, -29.900000000000095, -10.599999999999985, -4.799999999999995], "episode_lengths": [400, 61, 400, 121, 252, 237, 80, 345, 228, 321, 145, 54, 135, 400, 106, 178, 400, 305, 49, 153, 174, 104, 385, 236, 57, 400, 157, 187, 103, 122, 167, 182, 368, 288, 163, 104, 130, 86, 337, 187, 364, 80, 400, 400, 81, 289, 147, 146, 98, 400, 400, 400, 167, 193, 150, 400, 305, 118, 400, 84, 171, 66, 98, 104, 45, 119, 61, 382, 65, 67, 236, 194, 142, 195, 135, 400, 91, 99, 269, 206, 157, 239, 398, 400, 121, 262, 130, 98, 400, 155, 89, 123, 97, 400, 63, 63, 171, 258, 104, 57]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23938159161733696, "mean_inference_ms": 0.7243760705403927, "mean_action_processing_ms": 0.0768929165789924, "mean_env_wait_ms": 6.378297541684381, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0065653324127197266, "StateBufferConnector_ms": 0.0038192272186279297, "ViewRequirementAgentConnector_ms": 0.08935809135437012}, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 457.1189301227906, "num_env_steps_trained_throughput_per_sec": 457.1189301227906, "timesteps_total": 32000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 32000, "timers": {"training_iteration_time_ms": 8808.21, "sample_time_ms": 5073.566, "load_time_ms": 1.089, "load_throughput": 3671866.276, "learn_time_ms": 3730.749, "learn_throughput": 1072.171, "synch_weights_time_ms": 2.13}, "counters": {"num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000}, "done": false, "episodes_total": 139, "training_iteration": 8, "trial_id": "95ff9_00000", "date": "2024-03-07_12-33-10", "timestamp": 1709832790, "time_this_iter_s": 8.752675294876099, "time_total_s": 70.4833550453186, "pid": 108075, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4d85689f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 70.4833550453186, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 27.70909090909091, "ram_util_percent": 47.31818181818182, "gpu_util_percent0": 0.10818181818181817, "vram_util_percent0": 0.11027018229166669}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 6.185815848458198, "policy_loss": -0.0025457984577584012, "vf_loss": 6.187112142225748, "vf_explained_var": -0.36930314770308875, "kl": 0.00624746324206761, "entropy": 0.9987547621291171, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 7905.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000}, "sampler_results": {"episode_reward_max": -3.4000000000000004, "episode_reward_min": -61.70000000000039, "episode_reward_mean": -22.14000000000005, "episode_len_mean": 185.52, "episode_media": {}, "episodes_this_iter": 27, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-21.500000000000007, -11.99999999999997, -12.799999999999974, -18.0, -25.399999999999956, -55.800000000000274, -38.80000000000015, -19.500000000000032, -10.099999999999977, -14.69999999999997, -7.899999999999988, -39.30000000000014, -22.300000000000004, -46.70000000000034, -9.699999999999989, -59.600000000000335, -52.0000000000003, -7.39999999999999, -41.10000000000009, -16.699999999999992, -14.89999999999996, -11.299999999999983, -51.800000000000246, -51.40000000000024, -61.70000000000039, -20.600000000000016, -23.79999999999999, -16.399999999999974, -55.30000000000039, -36.70000000000018, -13.799999999999969, -52.20000000000035, -7.499999999999988, -21.399999999999974, -5.999999999999996, -9.999999999999977, -10.499999999999979, -3.4000000000000004, -13.19999999999998, -4.999999999999995, -45.00000000000026, -6.199999999999997, -5.999999999999991, -29.899999999999988, -22.90000000000004, -14.19999999999997, -20.3, -14.399999999999963, -48.70000000000029, -8.099999999999985, -8.999999999999982, -33.80000000000016, -23.000000000000007, -18.599999999999966, -27.90000000000001, -52.00000000000034, -46.600000000000264, -13.299999999999965, -28.70000000000008, -15.699999999999974, -10.89999999999999, -49.10000000000032, -16.099999999999977, -9.099999999999987, -14.399999999999967, -9.499999999999988, -50.60000000000036, -5.199999999999994, -5.199999999999994, -18.799999999999976, -29.900000000000095, -10.599999999999985, -4.799999999999995, -9.09999999999998, -17.099999999999973, -8.799999999999988, -10.699999999999978, -6.199999999999993, -31.600000000000144, -34.10000000000002, -46.80000000000026, -4.999999999999995, -3.5999999999999996, -6.399999999999993, -12.999999999999966, -9.499999999999986, -16.499999999999986, -33.5000000000002, -34.29999999999998, -9.699999999999987, -5.899999999999995, -15.099999999999962, -19.30000000000003, -48.30000000000031, -36.20000000000002, -34.600000000000044, -6.499999999999996, -7.599999999999985, -4.1999999999999975, -3.6999999999999993], "episode_lengths": [187, 103, 122, 167, 182, 368, 288, 163, 104, 130, 86, 337, 187, 364, 80, 400, 400, 81, 289, 147, 146, 98, 400, 400, 400, 167, 193, 150, 400, 305, 118, 400, 84, 171, 66, 98, 104, 45, 119, 61, 382, 65, 67, 236, 194, 142, 195, 135, 400, 91, 99, 269, 206, 157, 239, 398, 400, 121, 262, 130, 98, 400, 155, 89, 123, 97, 400, 63, 63, 171, 258, 104, 57, 96, 149, 86, 100, 70, 288, 245, 400, 61, 47, 71, 122, 95, 158, 305, 249, 89, 64, 146, 154, 400, 270, 256, 67, 87, 53, 48]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24129316181471216, "mean_inference_ms": 0.724279498854659, "mean_action_processing_ms": 0.07680225827839574, "mean_env_wait_ms": 6.394568580239927, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006583690643310547, "StateBufferConnector_ms": 0.0038127899169921875, "ViewRequirementAgentConnector_ms": 0.08947920799255371}}, "episode_reward_max": -3.4000000000000004, "episode_reward_min": -61.70000000000039, "episode_reward_mean": -22.14000000000005, "episode_len_mean": 185.52, "episodes_this_iter": 27, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-21.500000000000007, -11.99999999999997, -12.799999999999974, -18.0, -25.399999999999956, -55.800000000000274, -38.80000000000015, -19.500000000000032, -10.099999999999977, -14.69999999999997, -7.899999999999988, -39.30000000000014, -22.300000000000004, -46.70000000000034, -9.699999999999989, -59.600000000000335, -52.0000000000003, -7.39999999999999, -41.10000000000009, -16.699999999999992, -14.89999999999996, -11.299999999999983, -51.800000000000246, -51.40000000000024, -61.70000000000039, -20.600000000000016, -23.79999999999999, -16.399999999999974, -55.30000000000039, -36.70000000000018, -13.799999999999969, -52.20000000000035, -7.499999999999988, -21.399999999999974, -5.999999999999996, -9.999999999999977, -10.499999999999979, -3.4000000000000004, -13.19999999999998, -4.999999999999995, -45.00000000000026, -6.199999999999997, -5.999999999999991, -29.899999999999988, -22.90000000000004, -14.19999999999997, -20.3, -14.399999999999963, -48.70000000000029, -8.099999999999985, -8.999999999999982, -33.80000000000016, -23.000000000000007, -18.599999999999966, -27.90000000000001, -52.00000000000034, -46.600000000000264, -13.299999999999965, -28.70000000000008, -15.699999999999974, -10.89999999999999, -49.10000000000032, -16.099999999999977, -9.099999999999987, -14.399999999999967, -9.499999999999988, -50.60000000000036, -5.199999999999994, -5.199999999999994, -18.799999999999976, -29.900000000000095, -10.599999999999985, -4.799999999999995, -9.09999999999998, -17.099999999999973, -8.799999999999988, -10.699999999999978, -6.199999999999993, -31.600000000000144, -34.10000000000002, -46.80000000000026, -4.999999999999995, -3.5999999999999996, -6.399999999999993, -12.999999999999966, -9.499999999999986, -16.499999999999986, -33.5000000000002, -34.29999999999998, -9.699999999999987, -5.899999999999995, -15.099999999999962, -19.30000000000003, -48.30000000000031, -36.20000000000002, -34.600000000000044, -6.499999999999996, -7.599999999999985, -4.1999999999999975, -3.6999999999999993], "episode_lengths": [187, 103, 122, 167, 182, 368, 288, 163, 104, 130, 86, 337, 187, 364, 80, 400, 400, 81, 289, 147, 146, 98, 400, 400, 400, 167, 193, 150, 400, 305, 118, 400, 84, 171, 66, 98, 104, 45, 119, 61, 382, 65, 67, 236, 194, 142, 195, 135, 400, 91, 99, 269, 206, 157, 239, 398, 400, 121, 262, 130, 98, 400, 155, 89, 123, 97, 400, 63, 63, 171, 258, 104, 57, 96, 149, 86, 100, 70, 288, 245, 400, 61, 47, 71, 122, 95, 158, 305, 249, 89, 64, 146, 154, 400, 270, 256, 67, 87, 53, 48]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24129316181471216, "mean_inference_ms": 0.724279498854659, "mean_action_processing_ms": 0.07680225827839574, "mean_env_wait_ms": 6.394568580239927, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006583690643310547, "StateBufferConnector_ms": 0.0038127899169921875, "ViewRequirementAgentConnector_ms": 0.08947920799255371}, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 455.48151108776557, "num_env_steps_trained_throughput_per_sec": 455.48151108776557, "timesteps_total": 36000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 36000, "timers": {"training_iteration_time_ms": 8805.284, "sample_time_ms": 5074.415, "load_time_ms": 1.076, "load_throughput": 3718354.61, "learn_time_ms": 3727.0, "learn_throughput": 1073.249, "synch_weights_time_ms": 2.119}, "counters": {"num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000}, "done": false, "episodes_total": 166, "training_iteration": 9, "trial_id": "95ff9_00000", "date": "2024-03-07_12-33-19", "timestamp": 1709832799, "time_this_iter_s": 8.784106492996216, "time_total_s": 79.26746153831482, "pid": 108075, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4d85689f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 79.26746153831482, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 26.33333333333333, "ram_util_percent": 47.34166666666666, "gpu_util_percent0": 0.11, "vram_util_percent0": 0.11027018229166669}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 6.314035881206554, "policy_loss": -0.012767218049335224, "vf_loss": 6.3252785084709044, "vf_explained_var": -0.31594564363520633, "kl": 0.007623000581794317, "entropy": 0.9844079345785162, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 8835.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000}, "sampler_results": {"episode_reward_max": -2.600000000000002, "episode_reward_min": -70.90000000000047, "episode_reward_mean": -21.14900000000005, "episode_len_mean": 176.81, "episode_media": {}, "episodes_this_iter": 23, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-51.40000000000024, -61.70000000000039, -20.600000000000016, -23.79999999999999, -16.399999999999974, -55.30000000000039, -36.70000000000018, -13.799999999999969, -52.20000000000035, -7.499999999999988, -21.399999999999974, -5.999999999999996, -9.999999999999977, -10.499999999999979, -3.4000000000000004, -13.19999999999998, -4.999999999999995, -45.00000000000026, -6.199999999999997, -5.999999999999991, -29.899999999999988, -22.90000000000004, -14.19999999999997, -20.3, -14.399999999999963, -48.70000000000029, -8.099999999999985, -8.999999999999982, -33.80000000000016, -23.000000000000007, -18.599999999999966, -27.90000000000001, -52.00000000000034, -46.600000000000264, -13.299999999999965, -28.70000000000008, -15.699999999999974, -10.89999999999999, -49.10000000000032, -16.099999999999977, -9.099999999999987, -14.399999999999967, -9.499999999999988, -50.60000000000036, -5.199999999999994, -5.199999999999994, -18.799999999999976, -29.900000000000095, -10.599999999999985, -4.799999999999995, -9.09999999999998, -17.099999999999973, -8.799999999999988, -10.699999999999978, -6.199999999999993, -31.600000000000144, -34.10000000000002, -46.80000000000026, -4.999999999999995, -3.5999999999999996, -6.399999999999993, -12.999999999999966, -9.499999999999986, -16.499999999999986, -33.5000000000002, -34.29999999999998, -9.699999999999987, -5.899999999999995, -15.099999999999962, -19.30000000000003, -48.30000000000031, -36.20000000000002, -34.600000000000044, -6.499999999999996, -7.599999999999985, -4.1999999999999975, -3.6999999999999993, -23.90000000000001, -46.10000000000023, -48.30000000000023, -14.69999999999997, -9.29999999999998, -19.300000000000015, -13.999999999999964, -6.39999999999999, -51.600000000000314, -7.199999999999992, -70.90000000000047, -17.499999999999993, -2.800000000000002, -13.09999999999997, -7.299999999999994, -24.399999999999974, -15.299999999999969, -2.700000000000002, -16.49999999999996, -12.899999999999974, -14.59999999999997, -68.80000000000047, -2.600000000000002], "episode_lengths": [400, 400, 167, 193, 150, 400, 305, 118, 400, 84, 171, 66, 98, 104, 45, 119, 61, 382, 65, 67, 236, 194, 142, 195, 135, 400, 91, 99, 269, 206, 157, 239, 398, 400, 121, 262, 130, 98, 400, 155, 89, 123, 97, 400, 63, 63, 171, 258, 104, 57, 96, 149, 86, 100, 70, 288, 245, 400, 61, 47, 71, 122, 95, 158, 305, 249, 89, 64, 146, 154, 400, 270, 256, 67, 87, 53, 48, 198, 348, 360, 124, 100, 198, 132, 75, 400, 78, 400, 146, 39, 118, 76, 194, 133, 38, 136, 118, 110, 400, 37]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24254340890608111, "mean_inference_ms": 0.7245551579207782, "mean_action_processing_ms": 0.07672319364034692, "mean_env_wait_ms": 6.409377508315977, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0067234039306640625, "StateBufferConnector_ms": 0.003809213638305664, "ViewRequirementAgentConnector_ms": 0.08977890014648438}}, "episode_reward_max": -2.600000000000002, "episode_reward_min": -70.90000000000047, "episode_reward_mean": -21.14900000000005, "episode_len_mean": 176.81, "episodes_this_iter": 23, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-51.40000000000024, -61.70000000000039, -20.600000000000016, -23.79999999999999, -16.399999999999974, -55.30000000000039, -36.70000000000018, -13.799999999999969, -52.20000000000035, -7.499999999999988, -21.399999999999974, -5.999999999999996, -9.999999999999977, -10.499999999999979, -3.4000000000000004, -13.19999999999998, -4.999999999999995, -45.00000000000026, -6.199999999999997, -5.999999999999991, -29.899999999999988, -22.90000000000004, -14.19999999999997, -20.3, -14.399999999999963, -48.70000000000029, -8.099999999999985, -8.999999999999982, -33.80000000000016, -23.000000000000007, -18.599999999999966, -27.90000000000001, -52.00000000000034, -46.600000000000264, -13.299999999999965, -28.70000000000008, -15.699999999999974, -10.89999999999999, -49.10000000000032, -16.099999999999977, -9.099999999999987, -14.399999999999967, -9.499999999999988, -50.60000000000036, -5.199999999999994, -5.199999999999994, -18.799999999999976, -29.900000000000095, -10.599999999999985, -4.799999999999995, -9.09999999999998, -17.099999999999973, -8.799999999999988, -10.699999999999978, -6.199999999999993, -31.600000000000144, -34.10000000000002, -46.80000000000026, -4.999999999999995, -3.5999999999999996, -6.399999999999993, -12.999999999999966, -9.499999999999986, -16.499999999999986, -33.5000000000002, -34.29999999999998, -9.699999999999987, -5.899999999999995, -15.099999999999962, -19.30000000000003, -48.30000000000031, -36.20000000000002, -34.600000000000044, -6.499999999999996, -7.599999999999985, -4.1999999999999975, -3.6999999999999993, -23.90000000000001, -46.10000000000023, -48.30000000000023, -14.69999999999997, -9.29999999999998, -19.300000000000015, -13.999999999999964, -6.39999999999999, -51.600000000000314, -7.199999999999992, -70.90000000000047, -17.499999999999993, -2.800000000000002, -13.09999999999997, -7.299999999999994, -24.399999999999974, -15.299999999999969, -2.700000000000002, -16.49999999999996, -12.899999999999974, -14.59999999999997, -68.80000000000047, -2.600000000000002], "episode_lengths": [400, 400, 167, 193, 150, 400, 305, 118, 400, 84, 171, 66, 98, 104, 45, 119, 61, 382, 65, 67, 236, 194, 142, 195, 135, 400, 91, 99, 269, 206, 157, 239, 398, 400, 121, 262, 130, 98, 400, 155, 89, 123, 97, 400, 63, 63, 171, 258, 104, 57, 96, 149, 86, 100, 70, 288, 245, 400, 61, 47, 71, 122, 95, 158, 305, 249, 89, 64, 146, 154, 400, 270, 256, 67, 87, 53, 48, 198, 348, 360, 124, 100, 198, 132, 75, 400, 78, 400, 146, 39, 118, 76, 194, 133, 38, 136, 118, 110, 400, 37]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24254340890608111, "mean_inference_ms": 0.7245551579207782, "mean_action_processing_ms": 0.07672319364034692, "mean_env_wait_ms": 6.409377508315977, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0067234039306640625, "StateBufferConnector_ms": 0.003809213638305664, "ViewRequirementAgentConnector_ms": 0.08977890014648438}, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 447.8654801013689, "num_env_steps_trained_throughput_per_sec": 447.8654801013689, "timesteps_total": 40000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 40000, "timers": {"training_iteration_time_ms": 8817.879, "sample_time_ms": 5086.658, "load_time_ms": 1.064, "load_throughput": 3759347.495, "learn_time_ms": 3727.376, "learn_throughput": 1073.141, "synch_weights_time_ms": 2.105}, "counters": {"num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000}, "done": false, "episodes_total": 189, "training_iteration": 10, "trial_id": "95ff9_00000", "date": "2024-03-07_12-33-28", "timestamp": 1709832808, "time_this_iter_s": 8.933495044708252, "time_total_s": 88.20095658302307, "pid": 108075, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4d85689f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 88.20095658302307, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 28.027272727272734, "ram_util_percent": 47.31818181818182, "gpu_util_percent0": 0.1, "vram_util_percent0": 0.11027018229166669}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 6.46285966801387, "policy_loss": -0.007410810467216276, "vf_loss": 6.468800477315021, "vf_explained_var": -0.5542555966684896, "kl": 0.007349972965176461, "entropy": 0.9525263719020352, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 9765.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_agent_steps_sampled": 44000, "num_agent_steps_trained": 44000}, "sampler_results": {"episode_reward_max": -2.600000000000002, "episode_reward_min": -74.2000000000005, "episode_reward_mean": -16.139000000000035, "episode_len_mean": 137.88, "episode_media": {}, "episodes_this_iter": 42, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-9.499999999999988, -50.60000000000036, -5.199999999999994, -5.199999999999994, -18.799999999999976, -29.900000000000095, -10.599999999999985, -4.799999999999995, -9.09999999999998, -17.099999999999973, -8.799999999999988, -10.699999999999978, -6.199999999999993, -31.600000000000144, -34.10000000000002, -46.80000000000026, -4.999999999999995, -3.5999999999999996, -6.399999999999993, -12.999999999999966, -9.499999999999986, -16.499999999999986, -33.5000000000002, -34.29999999999998, -9.699999999999987, -5.899999999999995, -15.099999999999962, -19.30000000000003, -48.30000000000031, -36.20000000000002, -34.600000000000044, -6.499999999999996, -7.599999999999985, -4.1999999999999975, -3.6999999999999993, -23.90000000000001, -46.10000000000023, -48.30000000000023, -14.69999999999997, -9.29999999999998, -19.300000000000015, -13.999999999999964, -6.39999999999999, -51.600000000000314, -7.199999999999992, -70.90000000000047, -17.499999999999993, -2.800000000000002, -13.09999999999997, -7.299999999999994, -24.399999999999974, -15.299999999999969, -2.700000000000002, -16.49999999999996, -12.899999999999974, -14.59999999999997, -68.80000000000047, -2.600000000000002, -55.0000000000003, -5.799999999999997, -45.40000000000029, -12.399999999999977, -6.499999999999989, -8.399999999999986, -8.699999999999987, -4.099999999999998, -8.499999999999988, -2.900000000000002, -11.099999999999973, -8.399999999999991, -5.799999999999992, -12.799999999999967, -74.2000000000005, -5.699999999999992, -7.499999999999995, -4.699999999999996, -9.599999999999987, -5.099999999999994, -17.699999999999985, -5.299999999999994, -15.699999999999978, -6.599999999999989, -8.89999999999998, -3.4000000000000004, -6.599999999999999, -3.5, -8.099999999999987, -4.099999999999998, -6.299999999999998, -4.699999999999996, -14.099999999999978, -5.699999999999999, -13.999999999999963, -11.399999999999977, -6.799999999999991, -14.299999999999962, -2.900000000000002, -12.49999999999997, -8.199999999999983, -8.399999999999988], "episode_lengths": [97, 400, 63, 63, 171, 258, 104, 57, 96, 149, 86, 100, 70, 288, 245, 400, 61, 47, 71, 122, 95, 158, 305, 249, 89, 64, 146, 154, 400, 270, 256, 67, 87, 53, 48, 198, 348, 360, 124, 100, 198, 132, 75, 400, 78, 400, 146, 39, 118, 76, 194, 133, 38, 136, 118, 110, 400, 37, 400, 63, 400, 104, 73, 92, 89, 52, 89, 40, 115, 82, 69, 133, 400, 68, 75, 58, 91, 62, 150, 64, 148, 77, 95, 43, 60, 46, 88, 45, 65, 58, 105, 60, 128, 93, 73, 140, 40, 130, 92, 86]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.245318728756523, "mean_inference_ms": 0.7243989079493659, "mean_action_processing_ms": 0.07662865439957564, "mean_env_wait_ms": 6.431210649172258, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006639957427978516, "StateBufferConnector_ms": 0.0038089752197265625, "ViewRequirementAgentConnector_ms": 0.08997154235839844}}, "episode_reward_max": -2.600000000000002, "episode_reward_min": -74.2000000000005, "episode_reward_mean": -16.139000000000035, "episode_len_mean": 137.88, "episodes_this_iter": 42, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-9.499999999999988, -50.60000000000036, -5.199999999999994, -5.199999999999994, -18.799999999999976, -29.900000000000095, -10.599999999999985, -4.799999999999995, -9.09999999999998, -17.099999999999973, -8.799999999999988, -10.699999999999978, -6.199999999999993, -31.600000000000144, -34.10000000000002, -46.80000000000026, -4.999999999999995, -3.5999999999999996, -6.399999999999993, -12.999999999999966, -9.499999999999986, -16.499999999999986, -33.5000000000002, -34.29999999999998, -9.699999999999987, -5.899999999999995, -15.099999999999962, -19.30000000000003, -48.30000000000031, -36.20000000000002, -34.600000000000044, -6.499999999999996, -7.599999999999985, -4.1999999999999975, -3.6999999999999993, -23.90000000000001, -46.10000000000023, -48.30000000000023, -14.69999999999997, -9.29999999999998, -19.300000000000015, -13.999999999999964, -6.39999999999999, -51.600000000000314, -7.199999999999992, -70.90000000000047, -17.499999999999993, -2.800000000000002, -13.09999999999997, -7.299999999999994, -24.399999999999974, -15.299999999999969, -2.700000000000002, -16.49999999999996, -12.899999999999974, -14.59999999999997, -68.80000000000047, -2.600000000000002, -55.0000000000003, -5.799999999999997, -45.40000000000029, -12.399999999999977, -6.499999999999989, -8.399999999999986, -8.699999999999987, -4.099999999999998, -8.499999999999988, -2.900000000000002, -11.099999999999973, -8.399999999999991, -5.799999999999992, -12.799999999999967, -74.2000000000005, -5.699999999999992, -7.499999999999995, -4.699999999999996, -9.599999999999987, -5.099999999999994, -17.699999999999985, -5.299999999999994, -15.699999999999978, -6.599999999999989, -8.89999999999998, -3.4000000000000004, -6.599999999999999, -3.5, -8.099999999999987, -4.099999999999998, -6.299999999999998, -4.699999999999996, -14.099999999999978, -5.699999999999999, -13.999999999999963, -11.399999999999977, -6.799999999999991, -14.299999999999962, -2.900000000000002, -12.49999999999997, -8.199999999999983, -8.399999999999988], "episode_lengths": [97, 400, 63, 63, 171, 258, 104, 57, 96, 149, 86, 100, 70, 288, 245, 400, 61, 47, 71, 122, 95, 158, 305, 249, 89, 64, 146, 154, 400, 270, 256, 67, 87, 53, 48, 198, 348, 360, 124, 100, 198, 132, 75, 400, 78, 400, 146, 39, 118, 76, 194, 133, 38, 136, 118, 110, 400, 37, 400, 63, 400, 104, 73, 92, 89, 52, 89, 40, 115, 82, 69, 133, 400, 68, 75, 58, 91, 62, 150, 64, 148, 77, 95, 43, 60, 46, 88, 45, 65, 58, 105, 60, 128, 93, 73, 140, 40, 130, 92, 86]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.245318728756523, "mean_inference_ms": 0.7243989079493659, "mean_action_processing_ms": 0.07662865439957564, "mean_env_wait_ms": 6.431210649172258, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006639957427978516, "StateBufferConnector_ms": 0.0038089752197265625, "ViewRequirementAgentConnector_ms": 0.08997154235839844}, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 44000, "num_agent_steps_trained": 44000, "num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 445.45329127783043, "num_env_steps_trained_throughput_per_sec": 445.45329127783043, "timesteps_total": 44000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 44000, "timers": {"training_iteration_time_ms": 8827.497, "sample_time_ms": 5099.766, "load_time_ms": 1.07, "load_throughput": 3737822.435, "learn_time_ms": 3723.9, "learn_throughput": 1074.143, "synch_weights_time_ms": 2.103}, "counters": {"num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_agent_steps_sampled": 44000, "num_agent_steps_trained": 44000}, "done": false, "episodes_total": 231, "training_iteration": 11, "trial_id": "95ff9_00000", "date": "2024-03-07_12-33-37", "timestamp": 1709832817, "time_this_iter_s": 8.981996059417725, "time_total_s": 97.1829526424408, "pid": 108075, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4d85689f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 97.1829526424408, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 26.691666666666663, "ram_util_percent": 47.30833333333333, "gpu_util_percent0": 0.10833333333333334, "vram_util_percent0": 0.11027018229166669}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 5.207726384170594, "policy_loss": -0.010276779692660096, "vf_loss": 5.216954821027735, "vf_explained_var": -0.22036368148301239, "kl": 0.005241747040029229, "entropy": 0.8911912748890538, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 10695.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000}, "sampler_results": {"episode_reward_max": -2.5000000000000018, "episode_reward_min": -74.2000000000005, "episode_reward_mean": -14.662000000000026, "episode_len_mean": 123.12, "episode_media": {}, "episodes_this_iter": 34, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.6999999999999993, -23.90000000000001, -46.10000000000023, -48.30000000000023, -14.69999999999997, -9.29999999999998, -19.300000000000015, -13.999999999999964, -6.39999999999999, -51.600000000000314, -7.199999999999992, -70.90000000000047, -17.499999999999993, -2.800000000000002, -13.09999999999997, -7.299999999999994, -24.399999999999974, -15.299999999999969, -2.700000000000002, -16.49999999999996, -12.899999999999974, -14.59999999999997, -68.80000000000047, -2.600000000000002, -55.0000000000003, -5.799999999999997, -45.40000000000029, -12.399999999999977, -6.499999999999989, -8.399999999999986, -8.699999999999987, -4.099999999999998, -8.499999999999988, -2.900000000000002, -11.099999999999973, -8.399999999999991, -5.799999999999992, -12.799999999999967, -74.2000000000005, -5.699999999999992, -7.499999999999995, -4.699999999999996, -9.599999999999987, -5.099999999999994, -17.699999999999985, -5.299999999999994, -15.699999999999978, -6.599999999999989, -8.89999999999998, -3.4000000000000004, -6.599999999999999, -3.5, -8.099999999999987, -4.099999999999998, -6.299999999999998, -4.699999999999996, -14.099999999999978, -5.699999999999999, -13.999999999999963, -11.399999999999977, -6.799999999999991, -14.299999999999962, -2.900000000000002, -12.49999999999997, -8.199999999999983, -8.399999999999988, -55.30000000000026, -6.099999999999995, -8.299999999999988, -11.599999999999982, -4.899999999999995, -9.699999999999985, -3.5999999999999996, -5.499999999999997, -70.90000000000046, -5.499999999999995, -9.899999999999979, -10.09999999999998, -3.6999999999999993, -9.89999999999999, -16.399999999999977, -32.49999999999999, -7.899999999999986, -5.799999999999991, -3.799999999999999, -8.599999999999987, -36.900000000000055, -10.599999999999985, -7.1999999999999975, -8.199999999999992, -4.699999999999996, -28.50000000000002, -8.599999999999984, -14.09999999999997, -9.299999999999985, -7.39999999999999, -7.099999999999996, -4.900000000000001, -2.5000000000000018, -20.49999999999998], "episode_lengths": [48, 198, 348, 360, 124, 100, 198, 132, 75, 400, 78, 400, 146, 39, 118, 76, 194, 133, 38, 136, 118, 110, 400, 37, 400, 63, 400, 104, 73, 92, 89, 52, 89, 40, 115, 82, 69, 133, 400, 68, 75, 58, 91, 62, 150, 64, 148, 77, 95, 43, 60, 46, 88, 45, 65, 58, 105, 60, 128, 93, 73, 140, 40, 130, 92, 86, 400, 66, 87, 100, 60, 97, 47, 61, 400, 58, 94, 97, 48, 77, 133, 222, 88, 60, 49, 90, 279, 88, 72, 81, 58, 244, 91, 125, 88, 70, 72, 50, 36, 177]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2471562077893602, "mean_inference_ms": 0.724312339676047, "mean_action_processing_ms": 0.07664504255266164, "mean_env_wait_ms": 6.449421768335208, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006539821624755859, "StateBufferConnector_ms": 0.003823518753051758, "ViewRequirementAgentConnector_ms": 0.08987045288085938}}, "episode_reward_max": -2.5000000000000018, "episode_reward_min": -74.2000000000005, "episode_reward_mean": -14.662000000000026, "episode_len_mean": 123.12, "episodes_this_iter": 34, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3.6999999999999993, -23.90000000000001, -46.10000000000023, -48.30000000000023, -14.69999999999997, -9.29999999999998, -19.300000000000015, -13.999999999999964, -6.39999999999999, -51.600000000000314, -7.199999999999992, -70.90000000000047, -17.499999999999993, -2.800000000000002, -13.09999999999997, -7.299999999999994, -24.399999999999974, -15.299999999999969, -2.700000000000002, -16.49999999999996, -12.899999999999974, -14.59999999999997, -68.80000000000047, -2.600000000000002, -55.0000000000003, -5.799999999999997, -45.40000000000029, -12.399999999999977, -6.499999999999989, -8.399999999999986, -8.699999999999987, -4.099999999999998, -8.499999999999988, -2.900000000000002, -11.099999999999973, -8.399999999999991, -5.799999999999992, -12.799999999999967, -74.2000000000005, -5.699999999999992, -7.499999999999995, -4.699999999999996, -9.599999999999987, -5.099999999999994, -17.699999999999985, -5.299999999999994, -15.699999999999978, -6.599999999999989, -8.89999999999998, -3.4000000000000004, -6.599999999999999, -3.5, -8.099999999999987, -4.099999999999998, -6.299999999999998, -4.699999999999996, -14.099999999999978, -5.699999999999999, -13.999999999999963, -11.399999999999977, -6.799999999999991, -14.299999999999962, -2.900000000000002, -12.49999999999997, -8.199999999999983, -8.399999999999988, -55.30000000000026, -6.099999999999995, -8.299999999999988, -11.599999999999982, -4.899999999999995, -9.699999999999985, -3.5999999999999996, -5.499999999999997, -70.90000000000046, -5.499999999999995, -9.899999999999979, -10.09999999999998, -3.6999999999999993, -9.89999999999999, -16.399999999999977, -32.49999999999999, -7.899999999999986, -5.799999999999991, -3.799999999999999, -8.599999999999987, -36.900000000000055, -10.599999999999985, -7.1999999999999975, -8.199999999999992, -4.699999999999996, -28.50000000000002, -8.599999999999984, -14.09999999999997, -9.299999999999985, -7.39999999999999, -7.099999999999996, -4.900000000000001, -2.5000000000000018, -20.49999999999998], "episode_lengths": [48, 198, 348, 360, 124, 100, 198, 132, 75, 400, 78, 400, 146, 39, 118, 76, 194, 133, 38, 136, 118, 110, 400, 37, 400, 63, 400, 104, 73, 92, 89, 52, 89, 40, 115, 82, 69, 133, 400, 68, 75, 58, 91, 62, 150, 64, 148, 77, 95, 43, 60, 46, 88, 45, 65, 58, 105, 60, 128, 93, 73, 140, 40, 130, 92, 86, 400, 66, 87, 100, 60, 97, 47, 61, 400, 58, 94, 97, 48, 77, 133, 222, 88, 60, 49, 90, 279, 88, 72, 81, 58, 244, 91, 125, 88, 70, 72, 50, 36, 177]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2471562077893602, "mean_inference_ms": 0.724312339676047, "mean_action_processing_ms": 0.07664504255266164, "mean_env_wait_ms": 6.449421768335208, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006539821624755859, "StateBufferConnector_ms": 0.003823518753051758, "ViewRequirementAgentConnector_ms": 0.08987045288085938}, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000, "num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 432.88499595851056, "num_env_steps_trained_throughput_per_sec": 432.88499595851056, "timesteps_total": 48000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 48000, "timers": {"training_iteration_time_ms": 8879.542, "sample_time_ms": 5140.229, "load_time_ms": 1.073, "load_throughput": 3728601.653, "learn_time_ms": 3735.475, "learn_throughput": 1070.814, "synch_weights_time_ms": 2.101}, "counters": {"num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000}, "done": false, "episodes_total": 265, "training_iteration": 12, "trial_id": "95ff9_00000", "date": "2024-03-07_12-33-46", "timestamp": 1709832826, "time_this_iter_s": 9.242859601974487, "time_total_s": 106.42581224441528, "pid": 108075, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4d85689f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 106.42581224441528, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 27.75, "ram_util_percent": 47.39166666666666, "gpu_util_percent0": 0.11083333333333334, "vram_util_percent0": 0.11027018229166669}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 4.073594292710405, "policy_loss": -0.006044287502925883, "vf_loss": 4.078305037335683, "vf_explained_var": 0.2662647594046849, "kl": 0.0066677160088812505, "entropy": 0.9242237633915358, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 11625.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_agent_steps_sampled": 52000, "num_agent_steps_trained": 52000}, "sampler_results": {"episode_reward_max": -2.5000000000000018, "episode_reward_min": -70.90000000000046, "episode_reward_mean": -10.963999999999999, "episode_len_mean": 100.55, "episode_media": {}, "episodes_this_iter": 39, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-5.699999999999992, -7.499999999999995, -4.699999999999996, -9.599999999999987, -5.099999999999994, -17.699999999999985, -5.299999999999994, -15.699999999999978, -6.599999999999989, -8.89999999999998, -3.4000000000000004, -6.599999999999999, -3.5, -8.099999999999987, -4.099999999999998, -6.299999999999998, -4.699999999999996, -14.099999999999978, -5.699999999999999, -13.999999999999963, -11.399999999999977, -6.799999999999991, -14.299999999999962, -2.900000000000002, -12.49999999999997, -8.199999999999983, -8.399999999999988, -55.30000000000026, -6.099999999999995, -8.299999999999988, -11.599999999999982, -4.899999999999995, -9.699999999999985, -3.5999999999999996, -5.499999999999997, -70.90000000000046, -5.499999999999995, -9.899999999999979, -10.09999999999998, -3.6999999999999993, -9.89999999999999, -16.399999999999977, -32.49999999999999, -7.899999999999986, -5.799999999999991, -3.799999999999999, -8.599999999999987, -36.900000000000055, -10.599999999999985, -7.1999999999999975, -8.199999999999992, -4.699999999999996, -28.50000000000002, -8.599999999999984, -14.09999999999997, -9.299999999999985, -7.39999999999999, -7.099999999999996, -4.900000000000001, -2.5000000000000018, -20.49999999999998, -6.699999999999999, -4.599999999999997, -12.999999999999979, -19.099999999999994, -8.69999999999999, -4.899999999999995, -3.3000000000000007, -4.599999999999999, -7.7999999999999865, -8.099999999999994, -4.599999999999996, -18.19999999999998, -3.200000000000001, -11.599999999999973, -3.0000000000000018, -11.399999999999974, -4.099999999999998, -9.29999999999998, -42.20000000000013, -10.799999999999983, -6.799999999999996, -8.599999999999982, -6.999999999999995, -13.599999999999964, -6.39999999999999, -9.099999999999994, -2.900000000000002, -3.8999999999999986, -7.499999999999989, -5.799999999999996, -6.999999999999993, -14.499999999999961, -28.5000000000001, -23.799999999999972, -5.099999999999994, -3.999999999999999, -13.899999999999963, -7.599999999999994, -38.900000000000176], "episode_lengths": [68, 75, 58, 91, 62, 150, 64, 148, 77, 95, 43, 60, 46, 88, 45, 65, 58, 105, 60, 128, 93, 73, 140, 40, 130, 92, 86, 400, 66, 87, 100, 60, 97, 47, 61, 400, 58, 94, 97, 48, 77, 133, 222, 88, 60, 49, 90, 279, 88, 72, 81, 58, 244, 91, 125, 88, 70, 72, 50, 36, 177, 66, 56, 119, 147, 74, 60, 44, 53, 88, 81, 57, 179, 43, 110, 41, 121, 52, 104, 312, 91, 70, 96, 73, 138, 75, 83, 40, 50, 81, 54, 72, 140, 245, 202, 62, 50, 146, 64, 311]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24973683962745136, "mean_inference_ms": 0.7246878729860359, "mean_action_processing_ms": 0.0765763159598867, "mean_env_wait_ms": 6.473091790553817, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006473064422607422, "StateBufferConnector_ms": 0.003879547119140625, "ViewRequirementAgentConnector_ms": 0.09055185317993164}}, "episode_reward_max": -2.5000000000000018, "episode_reward_min": -70.90000000000046, "episode_reward_mean": -10.963999999999999, "episode_len_mean": 100.55, "episodes_this_iter": 39, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-5.699999999999992, -7.499999999999995, -4.699999999999996, -9.599999999999987, -5.099999999999994, -17.699999999999985, -5.299999999999994, -15.699999999999978, -6.599999999999989, -8.89999999999998, -3.4000000000000004, -6.599999999999999, -3.5, -8.099999999999987, -4.099999999999998, -6.299999999999998, -4.699999999999996, -14.099999999999978, -5.699999999999999, -13.999999999999963, -11.399999999999977, -6.799999999999991, -14.299999999999962, -2.900000000000002, -12.49999999999997, -8.199999999999983, -8.399999999999988, -55.30000000000026, -6.099999999999995, -8.299999999999988, -11.599999999999982, -4.899999999999995, -9.699999999999985, -3.5999999999999996, -5.499999999999997, -70.90000000000046, -5.499999999999995, -9.899999999999979, -10.09999999999998, -3.6999999999999993, -9.89999999999999, -16.399999999999977, -32.49999999999999, -7.899999999999986, -5.799999999999991, -3.799999999999999, -8.599999999999987, -36.900000000000055, -10.599999999999985, -7.1999999999999975, -8.199999999999992, -4.699999999999996, -28.50000000000002, -8.599999999999984, -14.09999999999997, -9.299999999999985, -7.39999999999999, -7.099999999999996, -4.900000000000001, -2.5000000000000018, -20.49999999999998, -6.699999999999999, -4.599999999999997, -12.999999999999979, -19.099999999999994, -8.69999999999999, -4.899999999999995, -3.3000000000000007, -4.599999999999999, -7.7999999999999865, -8.099999999999994, -4.599999999999996, -18.19999999999998, -3.200000000000001, -11.599999999999973, -3.0000000000000018, -11.399999999999974, -4.099999999999998, -9.29999999999998, -42.20000000000013, -10.799999999999983, -6.799999999999996, -8.599999999999982, -6.999999999999995, -13.599999999999964, -6.39999999999999, -9.099999999999994, -2.900000000000002, -3.8999999999999986, -7.499999999999989, -5.799999999999996, -6.999999999999993, -14.499999999999961, -28.5000000000001, -23.799999999999972, -5.099999999999994, -3.999999999999999, -13.899999999999963, -7.599999999999994, -38.900000000000176], "episode_lengths": [68, 75, 58, 91, 62, 150, 64, 148, 77, 95, 43, 60, 46, 88, 45, 65, 58, 105, 60, 128, 93, 73, 140, 40, 130, 92, 86, 400, 66, 87, 100, 60, 97, 47, 61, 400, 58, 94, 97, 48, 77, 133, 222, 88, 60, 49, 90, 279, 88, 72, 81, 58, 244, 91, 125, 88, 70, 72, 50, 36, 177, 66, 56, 119, 147, 74, 60, 44, 53, 88, 81, 57, 179, 43, 110, 41, 121, 52, 104, 312, 91, 70, 96, 73, 138, 75, 83, 40, 50, 81, 54, 72, 140, 245, 202, 62, 50, 146, 64, 311]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24973683962745136, "mean_inference_ms": 0.7246878729860359, "mean_action_processing_ms": 0.0765763159598867, "mean_env_wait_ms": 6.473091790553817, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006473064422607422, "StateBufferConnector_ms": 0.003879547119140625, "ViewRequirementAgentConnector_ms": 0.09055185317993164}, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 52000, "num_agent_steps_trained": 52000, "num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 446.4429199593526, "num_env_steps_trained_throughput_per_sec": 446.4429199593526, "timesteps_total": 52000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 52000, "timers": {"training_iteration_time_ms": 8899.711, "sample_time_ms": 5157.894, "load_time_ms": 1.018, "load_throughput": 3928538.379, "learn_time_ms": 3738.011, "learn_throughput": 1070.088, "synch_weights_time_ms": 2.111}, "counters": {"num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_agent_steps_sampled": 52000, "num_agent_steps_trained": 52000}, "done": false, "episodes_total": 304, "training_iteration": 13, "trial_id": "95ff9_00000", "date": "2024-03-07_12-33-55", "timestamp": 1709832835, "time_this_iter_s": 8.962126970291138, "time_total_s": 115.38793921470642, "pid": 108075, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4d85689f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 115.38793921470642, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 28.39090909090909, "ram_util_percent": 47.42727272727272, "gpu_util_percent0": 0.0990909090909091, "vram_util_percent0": 0.11027018229166669}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 4.747782223092853, "policy_loss": -0.005893936224522129, "vf_loss": 4.7524985103196995, "vf_explained_var": -0.040060547218527844, "kl": 0.005888212704730182, "entropy": 0.9200486513876146, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 12555.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 56000}, "sampler_results": {"episode_reward_max": -2.5000000000000018, "episode_reward_min": -70.90000000000046, "episode_reward_mean": -12.950000000000019, "episode_len_mean": 113.36, "episode_media": {}, "episodes_this_iter": 31, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4.899999999999995, -9.699999999999985, -3.5999999999999996, -5.499999999999997, -70.90000000000046, -5.499999999999995, -9.899999999999979, -10.09999999999998, -3.6999999999999993, -9.89999999999999, -16.399999999999977, -32.49999999999999, -7.899999999999986, -5.799999999999991, -3.799999999999999, -8.599999999999987, -36.900000000000055, -10.599999999999985, -7.1999999999999975, -8.199999999999992, -4.699999999999996, -28.50000000000002, -8.599999999999984, -14.09999999999997, -9.299999999999985, -7.39999999999999, -7.099999999999996, -4.900000000000001, -2.5000000000000018, -20.49999999999998, -6.699999999999999, -4.599999999999997, -12.999999999999979, -19.099999999999994, -8.69999999999999, -4.899999999999995, -3.3000000000000007, -4.599999999999999, -7.7999999999999865, -8.099999999999994, -4.599999999999996, -18.19999999999998, -3.200000000000001, -11.599999999999973, -3.0000000000000018, -11.399999999999974, -4.099999999999998, -9.29999999999998, -42.20000000000013, -10.799999999999983, -6.799999999999996, -8.599999999999982, -6.999999999999995, -13.599999999999964, -6.39999999999999, -9.099999999999994, -2.900000000000002, -3.8999999999999986, -7.499999999999989, -5.799999999999996, -6.999999999999993, -14.499999999999961, -28.5000000000001, -23.799999999999972, -5.099999999999994, -3.999999999999999, -13.899999999999963, -7.599999999999994, -38.900000000000176, -32.60000000000002, -59.60000000000033, -3.1000000000000014, -4.1999999999999975, -61.50000000000045, -9.699999999999985, -8.299999999999983, -22.699999999999996, -8.799999999999992, -7.699999999999996, -3.8999999999999986, -6.799999999999994, -10.89999999999998, -7.199999999999992, -5.199999999999996, -16.79999999999996, -5.399999999999993, -30.399999999999995, -6.299999999999992, -6.799999999999995, -7.599999999999991, -3.5, -7.399999999999999, -49.600000000000364, -34.100000000000065, -6.3, -14.59999999999997, -3.4000000000000004, -4.899999999999995, -47.00000000000021, -5.400000000000001], "episode_lengths": [60, 97, 47, 61, 400, 58, 94, 97, 48, 77, 133, 222, 88, 60, 49, 90, 279, 88, 72, 81, 58, 244, 91, 125, 88, 70, 72, 50, 36, 177, 66, 56, 119, 147, 74, 60, 44, 53, 88, 81, 57, 179, 43, 110, 41, 121, 52, 104, 312, 91, 70, 96, 73, 138, 75, 83, 40, 50, 81, 54, 72, 140, 245, 202, 62, 50, 146, 64, 311, 263, 400, 42, 52, 400, 94, 93, 183, 85, 74, 50, 73, 97, 78, 54, 140, 63, 235, 61, 71, 80, 46, 70, 400, 270, 62, 125, 45, 60, 352, 56]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.25130931486751235, "mean_inference_ms": 0.7243216409852596, "mean_action_processing_ms": 0.07670926191814842, "mean_env_wait_ms": 6.482206403659998, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0065042972564697266, "StateBufferConnector_ms": 0.003877401351928711, "ViewRequirementAgentConnector_ms": 0.09073114395141602}}, "episode_reward_max": -2.5000000000000018, "episode_reward_min": -70.90000000000046, "episode_reward_mean": -12.950000000000019, "episode_len_mean": 113.36, "episodes_this_iter": 31, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-4.899999999999995, -9.699999999999985, -3.5999999999999996, -5.499999999999997, -70.90000000000046, -5.499999999999995, -9.899999999999979, -10.09999999999998, -3.6999999999999993, -9.89999999999999, -16.399999999999977, -32.49999999999999, -7.899999999999986, -5.799999999999991, -3.799999999999999, -8.599999999999987, -36.900000000000055, -10.599999999999985, -7.1999999999999975, -8.199999999999992, -4.699999999999996, -28.50000000000002, -8.599999999999984, -14.09999999999997, -9.299999999999985, -7.39999999999999, -7.099999999999996, -4.900000000000001, -2.5000000000000018, -20.49999999999998, -6.699999999999999, -4.599999999999997, -12.999999999999979, -19.099999999999994, -8.69999999999999, -4.899999999999995, -3.3000000000000007, -4.599999999999999, -7.7999999999999865, -8.099999999999994, -4.599999999999996, -18.19999999999998, -3.200000000000001, -11.599999999999973, -3.0000000000000018, -11.399999999999974, -4.099999999999998, -9.29999999999998, -42.20000000000013, -10.799999999999983, -6.799999999999996, -8.599999999999982, -6.999999999999995, -13.599999999999964, -6.39999999999999, -9.099999999999994, -2.900000000000002, -3.8999999999999986, -7.499999999999989, -5.799999999999996, -6.999999999999993, -14.499999999999961, -28.5000000000001, -23.799999999999972, -5.099999999999994, -3.999999999999999, -13.899999999999963, -7.599999999999994, -38.900000000000176, -32.60000000000002, -59.60000000000033, -3.1000000000000014, -4.1999999999999975, -61.50000000000045, -9.699999999999985, -8.299999999999983, -22.699999999999996, -8.799999999999992, -7.699999999999996, -3.8999999999999986, -6.799999999999994, -10.89999999999998, -7.199999999999992, -5.199999999999996, -16.79999999999996, -5.399999999999993, -30.399999999999995, -6.299999999999992, -6.799999999999995, -7.599999999999991, -3.5, -7.399999999999999, -49.600000000000364, -34.100000000000065, -6.3, -14.59999999999997, -3.4000000000000004, -4.899999999999995, -47.00000000000021, -5.400000000000001], "episode_lengths": [60, 97, 47, 61, 400, 58, 94, 97, 48, 77, 133, 222, 88, 60, 49, 90, 279, 88, 72, 81, 58, 244, 91, 125, 88, 70, 72, 50, 36, 177, 66, 56, 119, 147, 74, 60, 44, 53, 88, 81, 57, 179, 43, 110, 41, 121, 52, 104, 312, 91, 70, 96, 73, 138, 75, 83, 40, 50, 81, 54, 72, 140, 245, 202, 62, 50, 146, 64, 311, 263, 400, 42, 52, 400, 94, 93, 183, 85, 74, 50, 73, 97, 78, 54, 140, 63, 235, 61, 71, 80, 46, 70, 400, 270, 62, 125, 45, 60, 352, 56]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.25130931486751235, "mean_inference_ms": 0.7243216409852596, "mean_action_processing_ms": 0.07670926191814842, "mean_env_wait_ms": 6.482206403659998, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0065042972564697266, "StateBufferConnector_ms": 0.003877401351928711, "ViewRequirementAgentConnector_ms": 0.09073114395141602}, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 56000, "num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 446.3026626770484, "num_env_steps_trained_throughput_per_sec": 446.3026626770484, "timesteps_total": 56000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 56000, "timers": {"training_iteration_time_ms": 8920.432, "sample_time_ms": 5179.397, "load_time_ms": 1.011, "load_throughput": 3955024.988, "learn_time_ms": 3737.29, "learn_throughput": 1070.294, "synch_weights_time_ms": 2.062}, "counters": {"num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 56000}, "done": false, "episodes_total": 335, "training_iteration": 14, "trial_id": "95ff9_00000", "date": "2024-03-07_12-34-04", "timestamp": 1709832844, "time_this_iter_s": 8.9649817943573, "time_total_s": 124.35292100906372, "pid": 108075, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4d85689f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 124.35292100906372, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 26.525000000000002, "ram_util_percent": 47.4, "gpu_util_percent0": 0.1175, "vram_util_percent0": 0.11027018229166669}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 2.921109930882531, "policy_loss": -0.006389527729842612, "vf_loss": 2.926050543560777, "vf_explained_var": 0.4331928455060528, "kl": 0.007244612720463114, "entropy": 0.9066668332904898, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 13485.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000}, "sampler_results": {"episode_reward_max": -2.600000000000002, "episode_reward_min": -61.50000000000045, "episode_reward_mean": -12.487000000000013, "episode_len_mean": 111.9, "episode_media": {}, "episodes_this_iter": 41, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-18.19999999999998, -3.200000000000001, -11.599999999999973, -3.0000000000000018, -11.399999999999974, -4.099999999999998, -9.29999999999998, -42.20000000000013, -10.799999999999983, -6.799999999999996, -8.599999999999982, -6.999999999999995, -13.599999999999964, -6.39999999999999, -9.099999999999994, -2.900000000000002, -3.8999999999999986, -7.499999999999989, -5.799999999999996, -6.999999999999993, -14.499999999999961, -28.5000000000001, -23.799999999999972, -5.099999999999994, -3.999999999999999, -13.899999999999963, -7.599999999999994, -38.900000000000176, -32.60000000000002, -59.60000000000033, -3.1000000000000014, -4.1999999999999975, -61.50000000000045, -9.699999999999985, -8.299999999999983, -22.699999999999996, -8.799999999999992, -7.699999999999996, -3.8999999999999986, -6.799999999999994, -10.89999999999998, -7.199999999999992, -5.199999999999996, -16.79999999999996, -5.399999999999993, -30.399999999999995, -6.299999999999992, -6.799999999999995, -7.599999999999991, -3.5, -7.399999999999999, -49.600000000000364, -34.100000000000065, -6.3, -14.59999999999997, -3.4000000000000004, -4.899999999999995, -47.00000000000021, -5.400000000000001, -41.20000000000012, -11.399999999999977, -9.799999999999978, -3.1000000000000014, -6.199999999999998, -4.099999999999998, -17.499999999999968, -24.299999999999972, -7.899999999999993, -9.19999999999998, -7.799999999999992, -7.699999999999992, -8.59999999999999, -6.399999999999991, -36.20000000000003, -12.199999999999974, -12.099999999999975, -10.899999999999974, -2.600000000000002, -8.299999999999992, -6.399999999999997, -5.699999999999993, -7.399999999999995, -3.6999999999999993, -4.899999999999995, -10.399999999999975, -7.2999999999999865, -7.29999999999999, -8.399999999999993, -4.399999999999997, -4.999999999999995, -9.899999999999986, -10.299999999999976, -10.099999999999978, -3.3000000000000007, -8.599999999999982, -7.5999999999999925, -7.2999999999999865, -16.79999999999996, -22.90000000000001, -3.1000000000000014], "episode_lengths": [179, 43, 110, 41, 121, 52, 104, 312, 91, 70, 96, 73, 138, 75, 83, 40, 50, 81, 54, 72, 140, 245, 202, 62, 50, 146, 64, 311, 263, 400, 42, 52, 400, 94, 93, 183, 85, 74, 50, 73, 97, 78, 54, 140, 63, 235, 61, 71, 80, 46, 70, 400, 270, 62, 125, 45, 60, 352, 56, 296, 106, 103, 42, 64, 52, 147, 192, 77, 95, 78, 79, 83, 66, 250, 120, 115, 94, 37, 75, 60, 67, 74, 48, 60, 97, 84, 79, 82, 52, 61, 94, 107, 96, 44, 90, 78, 84, 157, 185, 41]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.253339301739511, "mean_inference_ms": 0.7241117845214421, "mean_action_processing_ms": 0.07668350678717233, "mean_env_wait_ms": 6.49550407908217, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0066070556640625, "StateBufferConnector_ms": 0.003908395767211914, "ViewRequirementAgentConnector_ms": 0.09086155891418457}}, "episode_reward_max": -2.600000000000002, "episode_reward_min": -61.50000000000045, "episode_reward_mean": -12.487000000000013, "episode_len_mean": 111.9, "episodes_this_iter": 41, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-18.19999999999998, -3.200000000000001, -11.599999999999973, -3.0000000000000018, -11.399999999999974, -4.099999999999998, -9.29999999999998, -42.20000000000013, -10.799999999999983, -6.799999999999996, -8.599999999999982, -6.999999999999995, -13.599999999999964, -6.39999999999999, -9.099999999999994, -2.900000000000002, -3.8999999999999986, -7.499999999999989, -5.799999999999996, -6.999999999999993, -14.499999999999961, -28.5000000000001, -23.799999999999972, -5.099999999999994, -3.999999999999999, -13.899999999999963, -7.599999999999994, -38.900000000000176, -32.60000000000002, -59.60000000000033, -3.1000000000000014, -4.1999999999999975, -61.50000000000045, -9.699999999999985, -8.299999999999983, -22.699999999999996, -8.799999999999992, -7.699999999999996, -3.8999999999999986, -6.799999999999994, -10.89999999999998, -7.199999999999992, -5.199999999999996, -16.79999999999996, -5.399999999999993, -30.399999999999995, -6.299999999999992, -6.799999999999995, -7.599999999999991, -3.5, -7.399999999999999, -49.600000000000364, -34.100000000000065, -6.3, -14.59999999999997, -3.4000000000000004, -4.899999999999995, -47.00000000000021, -5.400000000000001, -41.20000000000012, -11.399999999999977, -9.799999999999978, -3.1000000000000014, -6.199999999999998, -4.099999999999998, -17.499999999999968, -24.299999999999972, -7.899999999999993, -9.19999999999998, -7.799999999999992, -7.699999999999992, -8.59999999999999, -6.399999999999991, -36.20000000000003, -12.199999999999974, -12.099999999999975, -10.899999999999974, -2.600000000000002, -8.299999999999992, -6.399999999999997, -5.699999999999993, -7.399999999999995, -3.6999999999999993, -4.899999999999995, -10.399999999999975, -7.2999999999999865, -7.29999999999999, -8.399999999999993, -4.399999999999997, -4.999999999999995, -9.899999999999986, -10.299999999999976, -10.099999999999978, -3.3000000000000007, -8.599999999999982, -7.5999999999999925, -7.2999999999999865, -16.79999999999996, -22.90000000000001, -3.1000000000000014], "episode_lengths": [179, 43, 110, 41, 121, 52, 104, 312, 91, 70, 96, 73, 138, 75, 83, 40, 50, 81, 54, 72, 140, 245, 202, 62, 50, 146, 64, 311, 263, 400, 42, 52, 400, 94, 93, 183, 85, 74, 50, 73, 97, 78, 54, 140, 63, 235, 61, 71, 80, 46, 70, 400, 270, 62, 125, 45, 60, 352, 56, 296, 106, 103, 42, 64, 52, 147, 192, 77, 95, 78, 79, 83, 66, 250, 120, 115, 94, 37, 75, 60, 67, 74, 48, 60, 97, 84, 79, 82, 52, 61, 94, 107, 96, 44, 90, 78, 84, 157, 185, 41]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.253339301739511, "mean_inference_ms": 0.7241117845214421, "mean_action_processing_ms": 0.07668350678717233, "mean_env_wait_ms": 6.49550407908217, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0066070556640625, "StateBufferConnector_ms": 0.003908395767211914, "ViewRequirementAgentConnector_ms": 0.09086155891418457}, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000, "num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 440.0296164418987, "num_env_steps_trained_throughput_per_sec": 440.0296164418987, "timesteps_total": 60000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 60000, "timers": {"training_iteration_time_ms": 8949.367, "sample_time_ms": 5194.601, "load_time_ms": 1.022, "load_throughput": 3913418.395, "learn_time_ms": 3751.026, "learn_throughput": 1066.375, "synch_weights_time_ms": 2.047}, "counters": {"num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000}, "done": false, "episodes_total": 376, "training_iteration": 15, "trial_id": "95ff9_00000", "date": "2024-03-07_12-34-13", "timestamp": 1709832853, "time_this_iter_s": 9.092749834060669, "time_total_s": 133.4456708431244, "pid": 108075, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4d85689f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 133.4456708431244, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 26.883333333333336, "ram_util_percent": 47.41666666666666, "gpu_util_percent0": 0.11083333333333334, "vram_util_percent0": 0.11027018229166669}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 2.5693489046992672, "policy_loss": -0.012752086468922194, "vf_loss": 2.5807556256171194, "vf_explained_var": 0.4500311900851547, "kl": 0.00672686291754178, "entropy": 0.9109184335636836, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 14415.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000}, "sampler_results": {"episode_reward_max": -2.3000000000000016, "episode_reward_min": -49.600000000000364, "episode_reward_mean": -10.105999999999998, "episode_len_mean": 96.57, "episode_media": {}, "episodes_this_iter": 44, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-5.399999999999993, -30.399999999999995, -6.299999999999992, -6.799999999999995, -7.599999999999991, -3.5, -7.399999999999999, -49.600000000000364, -34.100000000000065, -6.3, -14.59999999999997, -3.4000000000000004, -4.899999999999995, -47.00000000000021, -5.400000000000001, -41.20000000000012, -11.399999999999977, -9.799999999999978, -3.1000000000000014, -6.199999999999998, -4.099999999999998, -17.499999999999968, -24.299999999999972, -7.899999999999993, -9.19999999999998, -7.799999999999992, -7.699999999999992, -8.59999999999999, -6.399999999999991, -36.20000000000003, -12.199999999999974, -12.099999999999975, -10.899999999999974, -2.600000000000002, -8.299999999999992, -6.399999999999997, -5.699999999999993, -7.399999999999995, -3.6999999999999993, -4.899999999999995, -10.399999999999975, -7.2999999999999865, -7.29999999999999, -8.399999999999993, -4.399999999999997, -4.999999999999995, -9.899999999999986, -10.299999999999976, -10.099999999999978, -3.3000000000000007, -8.599999999999982, -7.5999999999999925, -7.2999999999999865, -16.79999999999996, -22.90000000000001, -3.1000000000000014, -3.6999999999999993, -6.499999999999997, -3.5999999999999996, -10.299999999999976, -7.699999999999989, -2.600000000000002, -4.699999999999996, -9.399999999999979, -13.699999999999964, -6.199999999999992, -6.999999999999989, -4.900000000000001, -7.599999999999985, -9.799999999999978, -6.499999999999989, -5.699999999999992, -6.099999999999992, -13.69999999999998, -13.999999999999963, -11.699999999999989, -7.399999999999986, -6.5999999999999925, -10.099999999999982, -2.3000000000000016, -31.700000000000124, -4.299999999999997, -10.999999999999975, -8.199999999999983, -4.399999999999997, -6.799999999999988, -5.8999999999999915, -7.399999999999986, -5.799999999999999, -7.1, -6.29999999999999, -10.899999999999974, -10.799999999999974, -6.899999999999992, -6.099999999999991, -8.099999999999984, -7.999999999999984, -12.199999999999969, -9.699999999999978, -6.1999999999999975], "episode_lengths": [63, 235, 61, 71, 80, 46, 70, 400, 270, 62, 125, 45, 60, 352, 56, 296, 106, 103, 42, 64, 52, 147, 192, 77, 95, 78, 79, 83, 66, 250, 120, 115, 94, 37, 75, 60, 67, 74, 48, 60, 97, 84, 79, 82, 52, 61, 94, 107, 96, 44, 90, 78, 84, 157, 185, 41, 48, 67, 47, 112, 70, 37, 57, 104, 140, 67, 79, 53, 87, 109, 74, 68, 71, 102, 141, 92, 85, 73, 98, 34, 267, 54, 119, 93, 55, 79, 70, 85, 61, 68, 74, 102, 116, 64, 70, 92, 91, 116, 94, 65]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2548506419879888, "mean_inference_ms": 0.7244945403983882, "mean_action_processing_ms": 0.0765412428894424, "mean_env_wait_ms": 6.504535158274972, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006506919860839844, "StateBufferConnector_ms": 0.003904104232788086, "ViewRequirementAgentConnector_ms": 0.09027695655822754}}, "episode_reward_max": -2.3000000000000016, "episode_reward_min": -49.600000000000364, "episode_reward_mean": -10.105999999999998, "episode_len_mean": 96.57, "episodes_this_iter": 44, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-5.399999999999993, -30.399999999999995, -6.299999999999992, -6.799999999999995, -7.599999999999991, -3.5, -7.399999999999999, -49.600000000000364, -34.100000000000065, -6.3, -14.59999999999997, -3.4000000000000004, -4.899999999999995, -47.00000000000021, -5.400000000000001, -41.20000000000012, -11.399999999999977, -9.799999999999978, -3.1000000000000014, -6.199999999999998, -4.099999999999998, -17.499999999999968, -24.299999999999972, -7.899999999999993, -9.19999999999998, -7.799999999999992, -7.699999999999992, -8.59999999999999, -6.399999999999991, -36.20000000000003, -12.199999999999974, -12.099999999999975, -10.899999999999974, -2.600000000000002, -8.299999999999992, -6.399999999999997, -5.699999999999993, -7.399999999999995, -3.6999999999999993, -4.899999999999995, -10.399999999999975, -7.2999999999999865, -7.29999999999999, -8.399999999999993, -4.399999999999997, -4.999999999999995, -9.899999999999986, -10.299999999999976, -10.099999999999978, -3.3000000000000007, -8.599999999999982, -7.5999999999999925, -7.2999999999999865, -16.79999999999996, -22.90000000000001, -3.1000000000000014, -3.6999999999999993, -6.499999999999997, -3.5999999999999996, -10.299999999999976, -7.699999999999989, -2.600000000000002, -4.699999999999996, -9.399999999999979, -13.699999999999964, -6.199999999999992, -6.999999999999989, -4.900000000000001, -7.599999999999985, -9.799999999999978, -6.499999999999989, -5.699999999999992, -6.099999999999992, -13.69999999999998, -13.999999999999963, -11.699999999999989, -7.399999999999986, -6.5999999999999925, -10.099999999999982, -2.3000000000000016, -31.700000000000124, -4.299999999999997, -10.999999999999975, -8.199999999999983, -4.399999999999997, -6.799999999999988, -5.8999999999999915, -7.399999999999986, -5.799999999999999, -7.1, -6.29999999999999, -10.899999999999974, -10.799999999999974, -6.899999999999992, -6.099999999999991, -8.099999999999984, -7.999999999999984, -12.199999999999969, -9.699999999999978, -6.1999999999999975], "episode_lengths": [63, 235, 61, 71, 80, 46, 70, 400, 270, 62, 125, 45, 60, 352, 56, 296, 106, 103, 42, 64, 52, 147, 192, 77, 95, 78, 79, 83, 66, 250, 120, 115, 94, 37, 75, 60, 67, 74, 48, 60, 97, 84, 79, 82, 52, 61, 94, 107, 96, 44, 90, 78, 84, 157, 185, 41, 48, 67, 47, 112, 70, 37, 57, 104, 140, 67, 79, 53, 87, 109, 74, 68, 71, 102, 141, 92, 85, 73, 98, 34, 267, 54, 119, 93, 55, 79, 70, 85, 61, 68, 74, 102, 116, 64, 70, 92, 91, 116, 94, 65]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2548506419879888, "mean_inference_ms": 0.7244945403983882, "mean_action_processing_ms": 0.0765412428894424, "mean_env_wait_ms": 6.504535158274972, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006506919860839844, "StateBufferConnector_ms": 0.003904104232788086, "ViewRequirementAgentConnector_ms": 0.09027695655822754}, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000, "num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 446.65575435330675, "num_env_steps_trained_throughput_per_sec": 446.65575435330675, "timesteps_total": 64000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 64000, "timers": {"training_iteration_time_ms": 8956.918, "sample_time_ms": 5208.447, "load_time_ms": 1.02, "load_throughput": 3920551.492, "learn_time_ms": 3744.685, "learn_throughput": 1068.181, "synch_weights_time_ms": 2.091}, "counters": {"num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000}, "done": false, "episodes_total": 420, "training_iteration": 16, "trial_id": "95ff9_00000", "date": "2024-03-07_12-34-22", "timestamp": 1709832862, "time_this_iter_s": 8.957911491394043, "time_total_s": 142.40358233451843, "pid": 108075, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4d85689f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 142.40358233451843, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 28.272727272727273, "ram_util_percent": 47.4, "gpu_util_percent0": 0.1, "vram_util_percent0": 0.11027018229166669}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 2.0254829564983003, "policy_loss": -0.010735731207395113, "vf_loss": 2.0346644144224864, "vf_explained_var": 0.6072538298945274, "kl": 0.007771363765215707, "entropy": 0.8970979150264494, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 15345.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_agent_steps_sampled": 68000, "num_agent_steps_trained": 68000}, "sampler_results": {"episode_reward_max": -2.3000000000000016, "episode_reward_min": -33.40000000000008, "episode_reward_mean": -8.505999999999995, "episode_len_mean": 86.86, "episode_media": {}, "episodes_this_iter": 50, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8.599999999999982, -7.5999999999999925, -7.2999999999999865, -16.79999999999996, -22.90000000000001, -3.1000000000000014, -3.6999999999999993, -6.499999999999997, -3.5999999999999996, -10.299999999999976, -7.699999999999989, -2.600000000000002, -4.699999999999996, -9.399999999999979, -13.699999999999964, -6.199999999999992, -6.999999999999989, -4.900000000000001, -7.599999999999985, -9.799999999999978, -6.499999999999989, -5.699999999999992, -6.099999999999992, -13.69999999999998, -13.999999999999963, -11.699999999999989, -7.399999999999986, -6.5999999999999925, -10.099999999999982, -2.3000000000000016, -31.700000000000124, -4.299999999999997, -10.999999999999975, -8.199999999999983, -4.399999999999997, -6.799999999999988, -5.8999999999999915, -7.399999999999986, -5.799999999999999, -7.1, -6.29999999999999, -10.899999999999974, -10.799999999999974, -6.899999999999992, -6.099999999999991, -8.099999999999984, -7.999999999999984, -12.199999999999969, -9.699999999999978, -6.1999999999999975, -33.40000000000008, -5.099999999999994, -12.299999999999976, -7.799999999999985, -7.199999999999996, -6.999999999999988, -3.5, -6.39999999999999, -5.499999999999993, -4.599999999999996, -6.099999999999995, -4.1999999999999975, -10.299999999999976, -6.899999999999993, -3.799999999999999, -4.099999999999998, -5.2999999999999945, -30.20000000000007, -5.099999999999994, -5.099999999999997, -3.200000000000001, -3.200000000000001, -5.399999999999993, -6.599999999999992, -4.1999999999999975, -11.69999999999997, -8.199999999999987, -3.5, -13.699999999999964, -6.799999999999988, -8.099999999999989, -8.299999999999983, -7.999999999999986, -6.59999999999999, -3.5, -4.399999999999997, -5.8999999999999915, -18.299999999999983, -3.200000000000001, -6.499999999999989, -6.19999999999999, -3.799999999999999, -4.799999999999995, -3.4000000000000004, -31.100000000000108, -25.90000000000003, -13.699999999999978, -7.999999999999984, -4.099999999999998, -10.499999999999988], "episode_lengths": [90, 78, 84, 157, 185, 41, 48, 67, 47, 112, 70, 37, 57, 104, 140, 67, 79, 53, 87, 109, 74, 68, 71, 102, 141, 92, 85, 73, 98, 34, 267, 54, 119, 93, 55, 79, 70, 85, 61, 68, 74, 102, 116, 64, 70, 92, 91, 116, 94, 65, 266, 62, 109, 89, 72, 81, 46, 75, 66, 55, 65, 52, 114, 74, 49, 52, 63, 267, 62, 59, 43, 43, 65, 72, 53, 110, 82, 46, 137, 65, 81, 90, 83, 76, 44, 52, 70, 161, 43, 76, 73, 49, 53, 44, 270, 204, 101, 90, 52, 95]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.25718628545337113, "mean_inference_ms": 0.7248252197441815, "mean_action_processing_ms": 0.07656189783243603, "mean_env_wait_ms": 6.514354720427039, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006466388702392578, "StateBufferConnector_ms": 0.0038793087005615234, "ViewRequirementAgentConnector_ms": 0.08997750282287598}}, "episode_reward_max": -2.3000000000000016, "episode_reward_min": -33.40000000000008, "episode_reward_mean": -8.505999999999995, "episode_len_mean": 86.86, "episodes_this_iter": 50, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-8.599999999999982, -7.5999999999999925, -7.2999999999999865, -16.79999999999996, -22.90000000000001, -3.1000000000000014, -3.6999999999999993, -6.499999999999997, -3.5999999999999996, -10.299999999999976, -7.699999999999989, -2.600000000000002, -4.699999999999996, -9.399999999999979, -13.699999999999964, -6.199999999999992, -6.999999999999989, -4.900000000000001, -7.599999999999985, -9.799999999999978, -6.499999999999989, -5.699999999999992, -6.099999999999992, -13.69999999999998, -13.999999999999963, -11.699999999999989, -7.399999999999986, -6.5999999999999925, -10.099999999999982, -2.3000000000000016, -31.700000000000124, -4.299999999999997, -10.999999999999975, -8.199999999999983, -4.399999999999997, -6.799999999999988, -5.8999999999999915, -7.399999999999986, -5.799999999999999, -7.1, -6.29999999999999, -10.899999999999974, -10.799999999999974, -6.899999999999992, -6.099999999999991, -8.099999999999984, -7.999999999999984, -12.199999999999969, -9.699999999999978, -6.1999999999999975, -33.40000000000008, -5.099999999999994, -12.299999999999976, -7.799999999999985, -7.199999999999996, -6.999999999999988, -3.5, -6.39999999999999, -5.499999999999993, -4.599999999999996, -6.099999999999995, -4.1999999999999975, -10.299999999999976, -6.899999999999993, -3.799999999999999, -4.099999999999998, -5.2999999999999945, -30.20000000000007, -5.099999999999994, -5.099999999999997, -3.200000000000001, -3.200000000000001, -5.399999999999993, -6.599999999999992, -4.1999999999999975, -11.69999999999997, -8.199999999999987, -3.5, -13.699999999999964, -6.799999999999988, -8.099999999999989, -8.299999999999983, -7.999999999999986, -6.59999999999999, -3.5, -4.399999999999997, -5.8999999999999915, -18.299999999999983, -3.200000000000001, -6.499999999999989, -6.19999999999999, -3.799999999999999, -4.799999999999995, -3.4000000000000004, -31.100000000000108, -25.90000000000003, -13.699999999999978, -7.999999999999984, -4.099999999999998, -10.499999999999988], "episode_lengths": [90, 78, 84, 157, 185, 41, 48, 67, 47, 112, 70, 37, 57, 104, 140, 67, 79, 53, 87, 109, 74, 68, 71, 102, 141, 92, 85, 73, 98, 34, 267, 54, 119, 93, 55, 79, 70, 85, 61, 68, 74, 102, 116, 64, 70, 92, 91, 116, 94, 65, 266, 62, 109, 89, 72, 81, 46, 75, 66, 55, 65, 52, 114, 74, 49, 52, 63, 267, 62, 59, 43, 43, 65, 72, 53, 110, 82, 46, 137, 65, 81, 90, 83, 76, 44, 52, 70, 161, 43, 76, 73, 49, 53, 44, 270, 204, 101, 90, 52, 95]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.25718628545337113, "mean_inference_ms": 0.7248252197441815, "mean_action_processing_ms": 0.07656189783243603, "mean_env_wait_ms": 6.514354720427039, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006466388702392578, "StateBufferConnector_ms": 0.0038793087005615234, "ViewRequirementAgentConnector_ms": 0.08997750282287598}, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 68000, "num_agent_steps_trained": 68000, "num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 440.3145753480814, "num_env_steps_trained_throughput_per_sec": 440.3145753480814, "timesteps_total": 68000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 68000, "timers": {"training_iteration_time_ms": 8973.564, "sample_time_ms": 5229.288, "load_time_ms": 1.024, "load_throughput": 3906766.021, "learn_time_ms": 3740.442, "learn_throughput": 1069.392, "synch_weights_time_ms": 2.135}, "counters": {"num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_agent_steps_sampled": 68000, "num_agent_steps_trained": 68000}, "done": false, "episodes_total": 470, "training_iteration": 17, "trial_id": "95ff9_00000", "date": "2024-03-07_12-34-31", "timestamp": 1709832871, "time_this_iter_s": 9.086903095245361, "time_total_s": 151.4904854297638, "pid": 108075, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4d85689f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 151.4904854297638, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 26.808333333333334, "ram_util_percent": 47.36666666666665, "gpu_util_percent0": 0.11083333333333334, "vram_util_percent0": 0.11027018229166669}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 4.032694248575967, "policy_loss": -0.005539643416000951, "vf_loss": 4.036646489013908, "vf_explained_var": 0.06622447089482379, "kl": 0.007936980926022595, "entropy": 0.8840202993603163, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 16275.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000}, "sampler_results": {"episode_reward_max": -2.0000000000000013, "episode_reward_min": -66.40000000000039, "episode_reward_mean": -9.728000000000007, "episode_len_mean": 93.74, "episode_media": {}, "episodes_this_iter": 37, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-7.399999999999986, -5.799999999999999, -7.1, -6.29999999999999, -10.899999999999974, -10.799999999999974, -6.899999999999992, -6.099999999999991, -8.099999999999984, -7.999999999999984, -12.199999999999969, -9.699999999999978, -6.1999999999999975, -33.40000000000008, -5.099999999999994, -12.299999999999976, -7.799999999999985, -7.199999999999996, -6.999999999999988, -3.5, -6.39999999999999, -5.499999999999993, -4.599999999999996, -6.099999999999995, -4.1999999999999975, -10.299999999999976, -6.899999999999993, -3.799999999999999, -4.099999999999998, -5.2999999999999945, -30.20000000000007, -5.099999999999994, -5.099999999999997, -3.200000000000001, -3.200000000000001, -5.399999999999993, -6.599999999999992, -4.1999999999999975, -11.69999999999997, -8.199999999999987, -3.5, -13.699999999999964, -6.799999999999988, -8.099999999999989, -8.299999999999983, -7.999999999999986, -6.59999999999999, -3.5, -4.399999999999997, -5.8999999999999915, -18.299999999999983, -3.200000000000001, -6.499999999999989, -6.19999999999999, -3.799999999999999, -4.799999999999995, -3.4000000000000004, -31.100000000000108, -25.90000000000003, -13.699999999999978, -7.999999999999984, -4.099999999999998, -10.499999999999988, -8.89999999999998, -9.899999999999977, -5.799999999999993, -4.899999999999999, -9.499999999999979, -2.0000000000000013, -5.8999999999999915, -10.299999999999992, -9.29999999999998, -10.299999999999983, -4.599999999999996, -3.200000000000001, -3.799999999999999, -11.89999999999997, -5.399999999999993, -5.299999999999994, -4.399999999999997, -5.8999999999999915, -7.999999999999984, -45.5000000000003, -2.900000000000002, -4.999999999999994, -3.200000000000001, -26.900000000000084, -5.999999999999991, -6.39999999999999, -5.799999999999992, -3.3000000000000007, -16.099999999999977, -6.799999999999994, -35.39999999999999, -3.6999999999999993, -53.700000000000244, -10.499999999999986, -66.40000000000039, -11.099999999999975, -4.599999999999996], "episode_lengths": [85, 61, 68, 74, 102, 116, 64, 70, 92, 91, 116, 94, 65, 266, 62, 109, 89, 72, 81, 46, 75, 66, 55, 65, 52, 114, 74, 49, 52, 63, 267, 62, 59, 43, 43, 65, 72, 53, 110, 82, 46, 137, 65, 81, 90, 83, 76, 44, 52, 70, 161, 43, 76, 73, 49, 53, 44, 270, 204, 101, 90, 52, 95, 95, 110, 68, 56, 95, 31, 70, 87, 104, 104, 57, 43, 49, 119, 65, 64, 55, 70, 91, 400, 40, 53, 43, 221, 71, 70, 69, 42, 156, 73, 233, 48, 373, 85, 400, 108, 57]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2584937112571238, "mean_inference_ms": 0.724757754453459, "mean_action_processing_ms": 0.07653323261549211, "mean_env_wait_ms": 6.515357888974345, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006459474563598633, "StateBufferConnector_ms": 0.0038352012634277344, "ViewRequirementAgentConnector_ms": 0.08929586410522461}}, "episode_reward_max": -2.0000000000000013, "episode_reward_min": -66.40000000000039, "episode_reward_mean": -9.728000000000007, "episode_len_mean": 93.74, "episodes_this_iter": 37, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-7.399999999999986, -5.799999999999999, -7.1, -6.29999999999999, -10.899999999999974, -10.799999999999974, -6.899999999999992, -6.099999999999991, -8.099999999999984, -7.999999999999984, -12.199999999999969, -9.699999999999978, -6.1999999999999975, -33.40000000000008, -5.099999999999994, -12.299999999999976, -7.799999999999985, -7.199999999999996, -6.999999999999988, -3.5, -6.39999999999999, -5.499999999999993, -4.599999999999996, -6.099999999999995, -4.1999999999999975, -10.299999999999976, -6.899999999999993, -3.799999999999999, -4.099999999999998, -5.2999999999999945, -30.20000000000007, -5.099999999999994, -5.099999999999997, -3.200000000000001, -3.200000000000001, -5.399999999999993, -6.599999999999992, -4.1999999999999975, -11.69999999999997, -8.199999999999987, -3.5, -13.699999999999964, -6.799999999999988, -8.099999999999989, -8.299999999999983, -7.999999999999986, -6.59999999999999, -3.5, -4.399999999999997, -5.8999999999999915, -18.299999999999983, -3.200000000000001, -6.499999999999989, -6.19999999999999, -3.799999999999999, -4.799999999999995, -3.4000000000000004, -31.100000000000108, -25.90000000000003, -13.699999999999978, -7.999999999999984, -4.099999999999998, -10.499999999999988, -8.89999999999998, -9.899999999999977, -5.799999999999993, -4.899999999999999, -9.499999999999979, -2.0000000000000013, -5.8999999999999915, -10.299999999999992, -9.29999999999998, -10.299999999999983, -4.599999999999996, -3.200000000000001, -3.799999999999999, -11.89999999999997, -5.399999999999993, -5.299999999999994, -4.399999999999997, -5.8999999999999915, -7.999999999999984, -45.5000000000003, -2.900000000000002, -4.999999999999994, -3.200000000000001, -26.900000000000084, -5.999999999999991, -6.39999999999999, -5.799999999999992, -3.3000000000000007, -16.099999999999977, -6.799999999999994, -35.39999999999999, -3.6999999999999993, -53.700000000000244, -10.499999999999986, -66.40000000000039, -11.099999999999975, -4.599999999999996], "episode_lengths": [85, 61, 68, 74, 102, 116, 64, 70, 92, 91, 116, 94, 65, 266, 62, 109, 89, 72, 81, 46, 75, 66, 55, 65, 52, 114, 74, 49, 52, 63, 267, 62, 59, 43, 43, 65, 72, 53, 110, 82, 46, 137, 65, 81, 90, 83, 76, 44, 52, 70, 161, 43, 76, 73, 49, 53, 44, 270, 204, 101, 90, 52, 95, 95, 110, 68, 56, 95, 31, 70, 87, 104, 104, 57, 43, 49, 119, 65, 64, 55, 70, 91, 400, 40, 53, 43, 221, 71, 70, 69, 42, 156, 73, 233, 48, 373, 85, 400, 108, 57]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2584937112571238, "mean_inference_ms": 0.724757754453459, "mean_action_processing_ms": 0.07653323261549211, "mean_env_wait_ms": 6.515357888974345, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006459474563598633, "StateBufferConnector_ms": 0.0038352012634277344, "ViewRequirementAgentConnector_ms": 0.08929586410522461}, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000, "num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 447.69868838541737, "num_env_steps_trained_throughput_per_sec": 447.69868838541737, "timesteps_total": 72000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 72000, "timers": {"training_iteration_time_ms": 8991.977, "sample_time_ms": 5246.137, "load_time_ms": 1.001, "load_throughput": 3996954.378, "learn_time_ms": 3742.022, "learn_throughput": 1068.941, "synch_weights_time_ms": 2.138}, "counters": {"num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000}, "done": false, "episodes_total": 507, "training_iteration": 18, "trial_id": "95ff9_00000", "date": "2024-03-07_12-34-40", "timestamp": 1709832880, "time_this_iter_s": 8.9369535446167, "time_total_s": 160.4274389743805, "pid": 108075, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4d85689f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 160.4274389743805, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 26.149999999999995, "ram_util_percent": 47.4, "gpu_util_percent0": 0.11, "vram_util_percent0": 0.11027018229166669}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 2.747359466508171, "policy_loss": -0.012671294886498681, "vf_loss": 2.7588994833089973, "vf_explained_var": 0.4463190735027354, "kl": 0.005656416273100198, "entropy": 0.8447096970773512, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 17205.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_agent_steps_sampled": 76000, "num_agent_steps_trained": 76000}, "sampler_results": {"episode_reward_max": -2.0000000000000013, "episode_reward_min": -66.40000000000039, "episode_reward_mean": -9.204000000000006, "episode_len_mean": 89.02, "episode_media": {}, "episodes_this_iter": 52, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-6.499999999999989, -6.19999999999999, -3.799999999999999, -4.799999999999995, -3.4000000000000004, -31.100000000000108, -25.90000000000003, -13.699999999999978, -7.999999999999984, -4.099999999999998, -10.499999999999988, -8.89999999999998, -9.899999999999977, -5.799999999999993, -4.899999999999999, -9.499999999999979, -2.0000000000000013, -5.8999999999999915, -10.299999999999992, -9.29999999999998, -10.299999999999983, -4.599999999999996, -3.200000000000001, -3.799999999999999, -11.89999999999997, -5.399999999999993, -5.299999999999994, -4.399999999999997, -5.8999999999999915, -7.999999999999984, -45.5000000000003, -2.900000000000002, -4.999999999999994, -3.200000000000001, -26.900000000000084, -5.999999999999991, -6.39999999999999, -5.799999999999992, -3.3000000000000007, -16.099999999999977, -6.799999999999994, -35.39999999999999, -3.6999999999999993, -53.700000000000244, -10.499999999999986, -66.40000000000039, -11.099999999999975, -4.599999999999996, -3.9999999999999982, -5.899999999999997, -3.5999999999999996, -4.4999999999999964, -5.799999999999992, -2.900000000000002, -7.899999999999984, -7.499999999999986, -4.799999999999995, -4.099999999999998, -3.3000000000000007, -27.10000000000002, -4.899999999999996, -3.900000000000002, -7.299999999999992, -10.599999999999975, -9.499999999999984, -3.0000000000000018, -2.700000000000002, -3.0000000000000018, -11.499999999999973, -4.399999999999997, -29.99999999999994, -4.4999999999999964, -3.5, -5.8999999999999915, -5.799999999999992, -3.5999999999999996, -16.999999999999986, -5.199999999999994, -4.699999999999996, -13.599999999999968, -7.699999999999989, -3.500000000000001, -10.99999999999998, -10.599999999999984, -3.5, -3.5, -4.899999999999995, -5.299999999999994, -3.6999999999999993, -5.5999999999999925, -4.699999999999996, -4.299999999999997, -15.999999999999975, -15.699999999999964, -3.3000000000000007, -4.4999999999999964, -3.5, -3.1000000000000014, -4.699999999999996, -4.699999999999996], "episode_lengths": [76, 73, 49, 53, 44, 270, 204, 101, 90, 52, 95, 95, 110, 68, 56, 95, 31, 70, 87, 104, 104, 57, 43, 49, 119, 65, 64, 55, 70, 91, 400, 40, 53, 43, 221, 71, 70, 69, 42, 156, 73, 233, 48, 373, 85, 400, 108, 57, 51, 64, 44, 56, 69, 40, 90, 86, 59, 52, 44, 227, 58, 46, 78, 110, 100, 41, 38, 41, 119, 55, 230, 56, 46, 70, 69, 47, 144, 63, 58, 125, 84, 45, 103, 91, 46, 46, 60, 64, 48, 67, 58, 54, 133, 148, 44, 54, 46, 42, 58, 53]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.26055280582040696, "mean_inference_ms": 0.7261192200544897, "mean_action_processing_ms": 0.07661626459470375, "mean_env_wait_ms": 6.530648604865609, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0066678524017333984, "StateBufferConnector_ms": 0.003984689712524414, "ViewRequirementAgentConnector_ms": 0.09286952018737793}}, "episode_reward_max": -2.0000000000000013, "episode_reward_min": -66.40000000000039, "episode_reward_mean": -9.204000000000006, "episode_len_mean": 89.02, "episodes_this_iter": 52, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-6.499999999999989, -6.19999999999999, -3.799999999999999, -4.799999999999995, -3.4000000000000004, -31.100000000000108, -25.90000000000003, -13.699999999999978, -7.999999999999984, -4.099999999999998, -10.499999999999988, -8.89999999999998, -9.899999999999977, -5.799999999999993, -4.899999999999999, -9.499999999999979, -2.0000000000000013, -5.8999999999999915, -10.299999999999992, -9.29999999999998, -10.299999999999983, -4.599999999999996, -3.200000000000001, -3.799999999999999, -11.89999999999997, -5.399999999999993, -5.299999999999994, -4.399999999999997, -5.8999999999999915, -7.999999999999984, -45.5000000000003, -2.900000000000002, -4.999999999999994, -3.200000000000001, -26.900000000000084, -5.999999999999991, -6.39999999999999, -5.799999999999992, -3.3000000000000007, -16.099999999999977, -6.799999999999994, -35.39999999999999, -3.6999999999999993, -53.700000000000244, -10.499999999999986, -66.40000000000039, -11.099999999999975, -4.599999999999996, -3.9999999999999982, -5.899999999999997, -3.5999999999999996, -4.4999999999999964, -5.799999999999992, -2.900000000000002, -7.899999999999984, -7.499999999999986, -4.799999999999995, -4.099999999999998, -3.3000000000000007, -27.10000000000002, -4.899999999999996, -3.900000000000002, -7.299999999999992, -10.599999999999975, -9.499999999999984, -3.0000000000000018, -2.700000000000002, -3.0000000000000018, -11.499999999999973, -4.399999999999997, -29.99999999999994, -4.4999999999999964, -3.5, -5.8999999999999915, -5.799999999999992, -3.5999999999999996, -16.999999999999986, -5.199999999999994, -4.699999999999996, -13.599999999999968, -7.699999999999989, -3.500000000000001, -10.99999999999998, -10.599999999999984, -3.5, -3.5, -4.899999999999995, -5.299999999999994, -3.6999999999999993, -5.5999999999999925, -4.699999999999996, -4.299999999999997, -15.999999999999975, -15.699999999999964, -3.3000000000000007, -4.4999999999999964, -3.5, -3.1000000000000014, -4.699999999999996, -4.699999999999996], "episode_lengths": [76, 73, 49, 53, 44, 270, 204, 101, 90, 52, 95, 95, 110, 68, 56, 95, 31, 70, 87, 104, 104, 57, 43, 49, 119, 65, 64, 55, 70, 91, 400, 40, 53, 43, 221, 71, 70, 69, 42, 156, 73, 233, 48, 373, 85, 400, 108, 57, 51, 64, 44, 56, 69, 40, 90, 86, 59, 52, 44, 227, 58, 46, 78, 110, 100, 41, 38, 41, 119, 55, 230, 56, 46, 70, 69, 47, 144, 63, 58, 125, 84, 45, 103, 91, 46, 46, 60, 64, 48, 67, 58, 54, 133, 148, 44, 54, 46, 42, 58, 53]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.26055280582040696, "mean_inference_ms": 0.7261192200544897, "mean_action_processing_ms": 0.07661626459470375, "mean_env_wait_ms": 6.530648604865609, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0066678524017333984, "StateBufferConnector_ms": 0.003984689712524414, "ViewRequirementAgentConnector_ms": 0.09286952018737793}, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 76000, "num_agent_steps_trained": 76000, "num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 431.4776885417749, "num_env_steps_trained_throughput_per_sec": 431.4776885417749, "timesteps_total": 76000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 76000, "timers": {"training_iteration_time_ms": 9040.831, "sample_time_ms": 5284.722, "load_time_ms": 1.014, "load_throughput": 3945909.027, "learn_time_ms": 3752.257, "learn_throughput": 1066.025, "synch_weights_time_ms": 2.152}, "counters": {"num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_agent_steps_sampled": 76000, "num_agent_steps_trained": 76000}, "done": false, "episodes_total": 559, "training_iteration": 19, "trial_id": "95ff9_00000", "date": "2024-03-07_12-34-49", "timestamp": 1709832889, "time_this_iter_s": 9.272913694381714, "time_total_s": 169.7003526687622, "pid": 108075, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4d85689f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 169.7003526687622, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 31.25833333333334, "ram_util_percent": 47.50833333333333, "gpu_util_percent0": 0.14166666666666666, "vram_util_percent0": 0.11095513237847222}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 2.6862629453112716, "policy_loss": -0.01149076436976752, "vf_loss": 2.696467658028167, "vf_explained_var": 0.45329722018652063, "kl": 0.006430209465634107, "entropy": 0.8565404930422383, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 18135.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000}, "sampler_results": {"episode_reward_max": -2.5000000000000018, "episode_reward_min": -64.10000000000035, "episode_reward_mean": -7.384999999999999, "episode_len_mean": 75.64, "episode_media": {}, "episodes_this_iter": 52, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-5.799999999999992, -2.900000000000002, -7.899999999999984, -7.499999999999986, -4.799999999999995, -4.099999999999998, -3.3000000000000007, -27.10000000000002, -4.899999999999996, -3.900000000000002, -7.299999999999992, -10.599999999999975, -9.499999999999984, -3.0000000000000018, -2.700000000000002, -3.0000000000000018, -11.499999999999973, -4.399999999999997, -29.99999999999994, -4.4999999999999964, -3.5, -5.8999999999999915, -5.799999999999992, -3.5999999999999996, -16.999999999999986, -5.199999999999994, -4.699999999999996, -13.599999999999968, -7.699999999999989, -3.500000000000001, -10.99999999999998, -10.599999999999984, -3.5, -3.5, -4.899999999999995, -5.299999999999994, -3.6999999999999993, -5.5999999999999925, -4.699999999999996, -4.299999999999997, -15.999999999999975, -15.699999999999964, -3.3000000000000007, -4.4999999999999964, -3.5, -3.1000000000000014, -4.699999999999996, -4.699999999999996, -4.399999999999997, -3.1000000000000014, -4.599999999999997, -4.799999999999995, -5.599999999999996, -9.199999999999987, -4.099999999999998, -3.5, -4.899999999999998, -5.499999999999993, -3.1000000000000014, -6.999999999999988, -4.699999999999996, -13.399999999999977, -4.599999999999996, -20.399999999999988, -3.200000000000001, -11.299999999999978, -18.999999999999996, -5.699999999999992, -6.499999999999992, -5.299999999999999, -3.1000000000000014, -4.4999999999999964, -5.399999999999993, -2.5000000000000018, -23.900000000000002, -5.499999999999993, -8.099999999999985, -7.399999999999999, -4.500000000000001, -19.49999999999999, -5.699999999999992, -4.999999999999996, -4.599999999999996, -3.5, -4.499999999999997, -3.0000000000000018, -3.1000000000000014, -5.099999999999995, -4.599999999999996, -5.099999999999994, -4.299999999999997, -8.799999999999994, -3.799999999999999, -7.199999999999996, -4.1999999999999975, -64.10000000000035, -4.3999999999999995, -6.499999999999989, -4.1999999999999975, -6.699999999999994], "episode_lengths": [69, 40, 90, 86, 59, 52, 44, 227, 58, 46, 78, 110, 100, 41, 38, 41, 119, 55, 230, 56, 46, 70, 69, 47, 144, 63, 58, 125, 84, 45, 103, 91, 46, 46, 60, 64, 48, 67, 58, 54, 133, 148, 44, 54, 46, 42, 58, 53, 55, 42, 56, 59, 63, 90, 52, 46, 57, 66, 42, 81, 58, 112, 57, 174, 43, 107, 151, 68, 73, 58, 42, 56, 65, 36, 200, 66, 90, 70, 51, 169, 68, 60, 57, 46, 55, 41, 42, 61, 57, 62, 54, 78, 49, 68, 53, 400, 52, 76, 53, 72]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.26343196923053513, "mean_inference_ms": 0.7271169091607612, "mean_action_processing_ms": 0.07671308992405786, "mean_env_wait_ms": 6.542378659978167, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006781578063964844, "StateBufferConnector_ms": 0.004014015197753906, "ViewRequirementAgentConnector_ms": 0.093902587890625}}, "episode_reward_max": -2.5000000000000018, "episode_reward_min": -64.10000000000035, "episode_reward_mean": -7.384999999999999, "episode_len_mean": 75.64, "episodes_this_iter": 52, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-5.799999999999992, -2.900000000000002, -7.899999999999984, -7.499999999999986, -4.799999999999995, -4.099999999999998, -3.3000000000000007, -27.10000000000002, -4.899999999999996, -3.900000000000002, -7.299999999999992, -10.599999999999975, -9.499999999999984, -3.0000000000000018, -2.700000000000002, -3.0000000000000018, -11.499999999999973, -4.399999999999997, -29.99999999999994, -4.4999999999999964, -3.5, -5.8999999999999915, -5.799999999999992, -3.5999999999999996, -16.999999999999986, -5.199999999999994, -4.699999999999996, -13.599999999999968, -7.699999999999989, -3.500000000000001, -10.99999999999998, -10.599999999999984, -3.5, -3.5, -4.899999999999995, -5.299999999999994, -3.6999999999999993, -5.5999999999999925, -4.699999999999996, -4.299999999999997, -15.999999999999975, -15.699999999999964, -3.3000000000000007, -4.4999999999999964, -3.5, -3.1000000000000014, -4.699999999999996, -4.699999999999996, -4.399999999999997, -3.1000000000000014, -4.599999999999997, -4.799999999999995, -5.599999999999996, -9.199999999999987, -4.099999999999998, -3.5, -4.899999999999998, -5.499999999999993, -3.1000000000000014, -6.999999999999988, -4.699999999999996, -13.399999999999977, -4.599999999999996, -20.399999999999988, -3.200000000000001, -11.299999999999978, -18.999999999999996, -5.699999999999992, -6.499999999999992, -5.299999999999999, -3.1000000000000014, -4.4999999999999964, -5.399999999999993, -2.5000000000000018, -23.900000000000002, -5.499999999999993, -8.099999999999985, -7.399999999999999, -4.500000000000001, -19.49999999999999, -5.699999999999992, -4.999999999999996, -4.599999999999996, -3.5, -4.499999999999997, -3.0000000000000018, -3.1000000000000014, -5.099999999999995, -4.599999999999996, -5.099999999999994, -4.299999999999997, -8.799999999999994, -3.799999999999999, -7.199999999999996, -4.1999999999999975, -64.10000000000035, -4.3999999999999995, -6.499999999999989, -4.1999999999999975, -6.699999999999994], "episode_lengths": [69, 40, 90, 86, 59, 52, 44, 227, 58, 46, 78, 110, 100, 41, 38, 41, 119, 55, 230, 56, 46, 70, 69, 47, 144, 63, 58, 125, 84, 45, 103, 91, 46, 46, 60, 64, 48, 67, 58, 54, 133, 148, 44, 54, 46, 42, 58, 53, 55, 42, 56, 59, 63, 90, 52, 46, 57, 66, 42, 81, 58, 112, 57, 174, 43, 107, 151, 68, 73, 58, 42, 56, 65, 36, 200, 66, 90, 70, 51, 169, 68, 60, 57, 46, 55, 41, 42, 61, 57, 62, 54, 78, 49, 68, 53, 400, 52, 76, 53, 72]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.26343196923053513, "mean_inference_ms": 0.7271169091607612, "mean_action_processing_ms": 0.07671308992405786, "mean_env_wait_ms": 6.542378659978167, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006781578063964844, "StateBufferConnector_ms": 0.004014015197753906, "ViewRequirementAgentConnector_ms": 0.093902587890625}, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000, "num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 444.078887638662, "num_env_steps_trained_throughput_per_sec": 444.078887638662, "timesteps_total": 80000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 80000, "timers": {"training_iteration_time_ms": 9048.447, "sample_time_ms": 5299.9, "load_time_ms": 1.013, "load_throughput": 3949252.86, "learn_time_ms": 3744.692, "learn_throughput": 1068.179, "synch_weights_time_ms": 2.16}, "counters": {"num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000}, "done": false, "episodes_total": 611, "training_iteration": 20, "trial_id": "95ff9_00000", "date": "2024-03-07_12-34-58", "timestamp": 1709832898, "time_this_iter_s": 9.009798049926758, "time_total_s": 178.71015071868896, "pid": 108075, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4d85689f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 178.71015071868896, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 29.13636363636364, "ram_util_percent": 47.345454545454544, "gpu_util_percent0": 0.09818181818181819, "vram_util_percent0": 0.11027018229166669}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 2.826321762163312, "policy_loss": -0.007484192184863552, "vf_loss": 2.8324969195069807, "vf_explained_var": 0.32254038805602697, "kl": 0.006545218452642068, "entropy": 0.8380847779653405, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 19065.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 84000}, "sampler_results": {"episode_reward_max": -2.5000000000000018, "episode_reward_min": -64.10000000000035, "episode_reward_mean": -8.101000000000004, "episode_len_mean": 80.14, "episode_media": {}, "episodes_this_iter": 51, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4.799999999999995, -5.599999999999996, -9.199999999999987, -4.099999999999998, -3.5, -4.899999999999998, -5.499999999999993, -3.1000000000000014, -6.999999999999988, -4.699999999999996, -13.399999999999977, -4.599999999999996, -20.399999999999988, -3.200000000000001, -11.299999999999978, -18.999999999999996, -5.699999999999992, -6.499999999999992, -5.299999999999999, -3.1000000000000014, -4.4999999999999964, -5.399999999999993, -2.5000000000000018, -23.900000000000002, -5.499999999999993, -8.099999999999985, -7.399999999999999, -4.500000000000001, -19.49999999999999, -5.699999999999992, -4.999999999999996, -4.599999999999996, -3.5, -4.499999999999997, -3.0000000000000018, -3.1000000000000014, -5.099999999999995, -4.599999999999996, -5.099999999999994, -4.299999999999997, -8.799999999999994, -3.799999999999999, -7.199999999999996, -4.1999999999999975, -64.10000000000035, -4.3999999999999995, -6.499999999999989, -4.1999999999999975, -6.699999999999994, -5.299999999999994, -4.6999999999999975, -3.1000000000000014, -14.499999999999973, -12.79999999999997, -5.1, -3.799999999999999, -5.199999999999994, -58.00000000000034, -4.999999999999995, -7.599999999999989, -4.1999999999999975, -9.69999999999998, -3.1000000000000014, -14.899999999999968, -34.900000000000105, -5.499999999999993, -5.199999999999995, -3.4000000000000004, -13.399999999999968, -6.299999999999991, -4.999999999999995, -4.799999999999995, -2.800000000000002, -8.19999999999999, -4.399999999999997, -2.900000000000002, -2.900000000000002, -5.999999999999991, -6.299999999999996, -5.199999999999996, -12.399999999999974, -5.799999999999992, -4.1999999999999975, -6.29999999999999, -2.900000000000002, -4.999999999999995, -3.9999999999999982, -4.999999999999996, -6.099999999999991, -46.70000000000014, -3.5999999999999996, -4.999999999999995, -4.699999999999996, -3.9999999999999982, -15.599999999999966, -3.5, -3.5, -3.9999999999999982, -3.9999999999999982, -4.999999999999995], "episode_lengths": [59, 63, 90, 52, 46, 57, 66, 42, 81, 58, 112, 57, 174, 43, 107, 151, 68, 73, 58, 42, 56, 65, 36, 200, 66, 90, 70, 51, 169, 68, 60, 57, 46, 55, 41, 42, 61, 57, 62, 54, 78, 49, 68, 53, 400, 52, 76, 53, 72, 64, 56, 42, 133, 128, 56, 49, 63, 400, 61, 80, 53, 88, 42, 143, 275, 66, 62, 45, 129, 73, 61, 59, 39, 86, 55, 40, 40, 71, 67, 61, 120, 69, 53, 74, 40, 61, 51, 60, 68, 311, 47, 61, 58, 51, 142, 46, 46, 51, 51, 61]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.26544986819148136, "mean_inference_ms": 0.7273801663578578, "mean_action_processing_ms": 0.07673226526448718, "mean_env_wait_ms": 6.558390676226014, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006764411926269531, "StateBufferConnector_ms": 0.003953218460083008, "ViewRequirementAgentConnector_ms": 0.09183812141418457}}, "episode_reward_max": -2.5000000000000018, "episode_reward_min": -64.10000000000035, "episode_reward_mean": -8.101000000000004, "episode_len_mean": 80.14, "episodes_this_iter": 51, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-4.799999999999995, -5.599999999999996, -9.199999999999987, -4.099999999999998, -3.5, -4.899999999999998, -5.499999999999993, -3.1000000000000014, -6.999999999999988, -4.699999999999996, -13.399999999999977, -4.599999999999996, -20.399999999999988, -3.200000000000001, -11.299999999999978, -18.999999999999996, -5.699999999999992, -6.499999999999992, -5.299999999999999, -3.1000000000000014, -4.4999999999999964, -5.399999999999993, -2.5000000000000018, -23.900000000000002, -5.499999999999993, -8.099999999999985, -7.399999999999999, -4.500000000000001, -19.49999999999999, -5.699999999999992, -4.999999999999996, -4.599999999999996, -3.5, -4.499999999999997, -3.0000000000000018, -3.1000000000000014, -5.099999999999995, -4.599999999999996, -5.099999999999994, -4.299999999999997, -8.799999999999994, -3.799999999999999, -7.199999999999996, -4.1999999999999975, -64.10000000000035, -4.3999999999999995, -6.499999999999989, -4.1999999999999975, -6.699999999999994, -5.299999999999994, -4.6999999999999975, -3.1000000000000014, -14.499999999999973, -12.79999999999997, -5.1, -3.799999999999999, -5.199999999999994, -58.00000000000034, -4.999999999999995, -7.599999999999989, -4.1999999999999975, -9.69999999999998, -3.1000000000000014, -14.899999999999968, -34.900000000000105, -5.499999999999993, -5.199999999999995, -3.4000000000000004, -13.399999999999968, -6.299999999999991, -4.999999999999995, -4.799999999999995, -2.800000000000002, -8.19999999999999, -4.399999999999997, -2.900000000000002, -2.900000000000002, -5.999999999999991, -6.299999999999996, -5.199999999999996, -12.399999999999974, -5.799999999999992, -4.1999999999999975, -6.29999999999999, -2.900000000000002, -4.999999999999995, -3.9999999999999982, -4.999999999999996, -6.099999999999991, -46.70000000000014, -3.5999999999999996, -4.999999999999995, -4.699999999999996, -3.9999999999999982, -15.599999999999966, -3.5, -3.5, -3.9999999999999982, -3.9999999999999982, -4.999999999999995], "episode_lengths": [59, 63, 90, 52, 46, 57, 66, 42, 81, 58, 112, 57, 174, 43, 107, 151, 68, 73, 58, 42, 56, 65, 36, 200, 66, 90, 70, 51, 169, 68, 60, 57, 46, 55, 41, 42, 61, 57, 62, 54, 78, 49, 68, 53, 400, 52, 76, 53, 72, 64, 56, 42, 133, 128, 56, 49, 63, 400, 61, 80, 53, 88, 42, 143, 275, 66, 62, 45, 129, 73, 61, 59, 39, 86, 55, 40, 40, 71, 67, 61, 120, 69, 53, 74, 40, 61, 51, 60, 68, 311, 47, 61, 58, 51, 142, 46, 46, 51, 51, 61]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.26544986819148136, "mean_inference_ms": 0.7273801663578578, "mean_action_processing_ms": 0.07673226526448718, "mean_env_wait_ms": 6.558390676226014, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006764411926269531, "StateBufferConnector_ms": 0.003953218460083008, "ViewRequirementAgentConnector_ms": 0.09183812141418457}, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 84000, "num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 441.64649971027603, "num_env_steps_trained_throughput_per_sec": 441.64649971027603, "timesteps_total": 84000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 84000, "timers": {"training_iteration_time_ms": 9056.186, "sample_time_ms": 5314.862, "load_time_ms": 1.013, "load_throughput": 3948695.161, "learn_time_ms": 3737.486, "learn_throughput": 1070.238, "synch_weights_time_ms": 2.142}, "counters": {"num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 84000}, "done": false, "episodes_total": 662, "training_iteration": 21, "trial_id": "95ff9_00000", "date": "2024-03-07_12-35-07", "timestamp": 1709832907, "time_this_iter_s": 9.059360265731812, "time_total_s": 187.76951098442078, "pid": 108075, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4d85689f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 187.76951098442078, "iterations_since_restore": 21, "perf": {"cpu_util_percent": 27.466666666666665, "ram_util_percent": 47.324999999999996, "gpu_util_percent0": 0.13333333333333333, "vram_util_percent0": 0.11027018229166669}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 2.869581936407454, "policy_loss": -0.0032906590850763423, "vf_loss": 2.871623994089583, "vf_explained_var": 0.4959113565824365, "kl": 0.0062430323045836915, "entropy": 0.8104494635776807, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 19995.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_agent_steps_sampled": 88000, "num_agent_steps_trained": 88000}, "sampler_results": {"episode_reward_max": -2.3000000000000016, "episode_reward_min": -58.00000000000034, "episode_reward_mean": -7.453000000000004, "episode_len_mean": 76.44, "episode_media": {}, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-12.79999999999997, -5.1, -3.799999999999999, -5.199999999999994, -58.00000000000034, -4.999999999999995, -7.599999999999989, -4.1999999999999975, -9.69999999999998, -3.1000000000000014, -14.899999999999968, -34.900000000000105, -5.499999999999993, -5.199999999999995, -3.4000000000000004, -13.399999999999968, -6.299999999999991, -4.999999999999995, -4.799999999999995, -2.800000000000002, -8.19999999999999, -4.399999999999997, -2.900000000000002, -2.900000000000002, -5.999999999999991, -6.299999999999996, -5.199999999999996, -12.399999999999974, -5.799999999999992, -4.1999999999999975, -6.29999999999999, -2.900000000000002, -4.999999999999995, -3.9999999999999982, -4.999999999999996, -6.099999999999991, -46.70000000000014, -3.5999999999999996, -4.999999999999995, -4.699999999999996, -3.9999999999999982, -15.599999999999966, -3.5, -3.5, -3.9999999999999982, -3.9999999999999982, -4.999999999999995, -20.199999999999974, -4.099999999999998, -3.8999999999999986, -4.099999999999998, -3.4000000000000004, -3.799999999999999, -3.5999999999999996, -2.700000000000002, -6.39999999999999, -5.5999999999999925, -4.999999999999995, -3.799999999999999, -6.39999999999999, -4.599999999999996, -2.700000000000002, -3.0000000000000018, -12.59999999999997, -6.399999999999997, -4.699999999999997, -4.399999999999997, -4.1999999999999975, -5.399999999999998, -3.9999999999999982, -4.399999999999997, -5.499999999999993, -3.4000000000000004, -2.900000000000002, -5.099999999999994, -27.60000000000006, -4.799999999999995, -5.799999999999992, -2.700000000000002, -2.3000000000000016, -4.799999999999995, -32.50000000000007, -7.199999999999992, -4.399999999999997, -4.099999999999998, -4.699999999999996, -4.499999999999996, -4.599999999999996, -26.70000000000003, -3.5999999999999996, -2.700000000000002, -4.299999999999998, -5.8999999999999915, -4.199999999999998, -6.19999999999999, -3.799999999999999, -6.100000000000002, -5.599999999999998, -4.399999999999997, -17.59999999999999], "episode_lengths": [128, 56, 49, 63, 400, 61, 80, 53, 88, 42, 143, 275, 66, 62, 45, 129, 73, 61, 59, 39, 86, 55, 40, 40, 71, 67, 61, 120, 69, 53, 74, 40, 61, 51, 60, 68, 311, 47, 61, 58, 51, 142, 46, 46, 51, 51, 61, 159, 52, 50, 52, 45, 49, 45, 38, 74, 67, 61, 49, 75, 57, 38, 41, 118, 67, 57, 55, 51, 60, 51, 55, 66, 45, 40, 62, 223, 59, 69, 38, 34, 59, 265, 77, 55, 52, 58, 52, 57, 233, 47, 38, 53, 62, 52, 73, 49, 59, 61, 55, 172]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2670514387232116, "mean_inference_ms": 0.7274637356791674, "mean_action_processing_ms": 0.0768108070244831, "mean_env_wait_ms": 6.569212444224763, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006512641906738281, "StateBufferConnector_ms": 0.003882884979248047, "ViewRequirementAgentConnector_ms": 0.09082913398742676}}, "episode_reward_max": -2.3000000000000016, "episode_reward_min": -58.00000000000034, "episode_reward_mean": -7.453000000000004, "episode_len_mean": 76.44, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-12.79999999999997, -5.1, -3.799999999999999, -5.199999999999994, -58.00000000000034, -4.999999999999995, -7.599999999999989, -4.1999999999999975, -9.69999999999998, -3.1000000000000014, -14.899999999999968, -34.900000000000105, -5.499999999999993, -5.199999999999995, -3.4000000000000004, -13.399999999999968, -6.299999999999991, -4.999999999999995, -4.799999999999995, -2.800000000000002, -8.19999999999999, -4.399999999999997, -2.900000000000002, -2.900000000000002, -5.999999999999991, -6.299999999999996, -5.199999999999996, -12.399999999999974, -5.799999999999992, -4.1999999999999975, -6.29999999999999, -2.900000000000002, -4.999999999999995, -3.9999999999999982, -4.999999999999996, -6.099999999999991, -46.70000000000014, -3.5999999999999996, -4.999999999999995, -4.699999999999996, -3.9999999999999982, -15.599999999999966, -3.5, -3.5, -3.9999999999999982, -3.9999999999999982, -4.999999999999995, -20.199999999999974, -4.099999999999998, -3.8999999999999986, -4.099999999999998, -3.4000000000000004, -3.799999999999999, -3.5999999999999996, -2.700000000000002, -6.39999999999999, -5.5999999999999925, -4.999999999999995, -3.799999999999999, -6.39999999999999, -4.599999999999996, -2.700000000000002, -3.0000000000000018, -12.59999999999997, -6.399999999999997, -4.699999999999997, -4.399999999999997, -4.1999999999999975, -5.399999999999998, -3.9999999999999982, -4.399999999999997, -5.499999999999993, -3.4000000000000004, -2.900000000000002, -5.099999999999994, -27.60000000000006, -4.799999999999995, -5.799999999999992, -2.700000000000002, -2.3000000000000016, -4.799999999999995, -32.50000000000007, -7.199999999999992, -4.399999999999997, -4.099999999999998, -4.699999999999996, -4.499999999999996, -4.599999999999996, -26.70000000000003, -3.5999999999999996, -2.700000000000002, -4.299999999999998, -5.8999999999999915, -4.199999999999998, -6.19999999999999, -3.799999999999999, -6.100000000000002, -5.599999999999998, -4.399999999999997, -17.59999999999999], "episode_lengths": [128, 56, 49, 63, 400, 61, 80, 53, 88, 42, 143, 275, 66, 62, 45, 129, 73, 61, 59, 39, 86, 55, 40, 40, 71, 67, 61, 120, 69, 53, 74, 40, 61, 51, 60, 68, 311, 47, 61, 58, 51, 142, 46, 46, 51, 51, 61, 159, 52, 50, 52, 45, 49, 45, 38, 74, 67, 61, 49, 75, 57, 38, 41, 118, 67, 57, 55, 51, 60, 51, 55, 66, 45, 40, 62, 223, 59, 69, 38, 34, 59, 265, 77, 55, 52, 58, 52, 57, 233, 47, 38, 53, 62, 52, 73, 49, 59, 61, 55, 172]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2670514387232116, "mean_inference_ms": 0.7274637356791674, "mean_action_processing_ms": 0.0768108070244831, "mean_env_wait_ms": 6.569212444224763, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006512641906738281, "StateBufferConnector_ms": 0.003882884979248047, "ViewRequirementAgentConnector_ms": 0.09082913398742676}, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 88000, "num_agent_steps_trained": 88000, "num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 437.4260075288867, "num_env_steps_trained_throughput_per_sec": 437.4260075288867, "timesteps_total": 88000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 88000, "timers": {"training_iteration_time_ms": 9046.595, "sample_time_ms": 5307.541, "load_time_ms": 1.034, "load_throughput": 3869908.888, "learn_time_ms": 3735.237, "learn_throughput": 1070.883, "synch_weights_time_ms": 2.108}, "counters": {"num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_agent_steps_sampled": 88000, "num_agent_steps_trained": 88000}, "done": false, "episodes_total": 715, "training_iteration": 22, "trial_id": "95ff9_00000", "date": "2024-03-07_12-35-17", "timestamp": 1709832917, "time_this_iter_s": 9.146813869476318, "time_total_s": 196.9163248538971, "pid": 108075, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4d85689f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 196.9163248538971, "iterations_since_restore": 22, "perf": {"cpu_util_percent": 27.166666666666668, "ram_util_percent": 47.29999999999999, "gpu_util_percent0": 0.11166666666666668, "vram_util_percent0": 0.11027018229166669}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 2.2757735073919436, "policy_loss": -0.0020885498493268925, "vf_loss": 2.2768591710276183, "vf_explained_var": 0.43605366663266254, "kl": 0.0050145050291010625, "entropy": 0.7926696624807132, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 20925.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_agent_steps_sampled": 92000, "num_agent_steps_trained": 92000}, "sampler_results": {"episode_reward_max": -2.3000000000000016, "episode_reward_min": -72.40000000000049, "episode_reward_mean": -7.228000000000008, "episode_len_mean": 72.35, "episode_media": {}, "episodes_this_iter": 63, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-12.59999999999997, -6.399999999999997, -4.699999999999997, -4.399999999999997, -4.1999999999999975, -5.399999999999998, -3.9999999999999982, -4.399999999999997, -5.499999999999993, -3.4000000000000004, -2.900000000000002, -5.099999999999994, -27.60000000000006, -4.799999999999995, -5.799999999999992, -2.700000000000002, -2.3000000000000016, -4.799999999999995, -32.50000000000007, -7.199999999999992, -4.399999999999997, -4.099999999999998, -4.699999999999996, -4.499999999999996, -4.599999999999996, -26.70000000000003, -3.5999999999999996, -2.700000000000002, -4.299999999999998, -5.8999999999999915, -4.199999999999998, -6.19999999999999, -3.799999999999999, -6.100000000000002, -5.599999999999998, -4.399999999999997, -17.59999999999999, -56.500000000000306, -3.200000000000001, -5.299999999999994, -2.800000000000002, -3.200000000000001, -2.800000000000002, -3.5, -19.500000000000032, -3.5999999999999996, -3.5999999999999996, -5.099999999999994, -28.500000000000018, -3.200000000000001, -4.1999999999999975, -3.8999999999999995, -2.800000000000002, -5.099999999999994, -3.8999999999999986, -4.1999999999999975, -2.800000000000002, -3.8999999999999986, -4.799999999999995, -5.199999999999994, -3.3000000000000007, -4.099999999999998, -2.900000000000002, -4.399999999999999, -4.399999999999997, -3.200000000000001, -4.699999999999996, -3.0000000000000018, -4.1999999999999975, -6.699999999999994, -9.099999999999982, -3.5, -3.799999999999999, -4.199999999999998, -72.40000000000049, -3.3000000000000007, -4.399999999999997, -3.9999999999999982, -5.099999999999994, -29.699999999999996, -4.4999999999999964, -3.4000000000000004, -5.099999999999994, -4.399999999999997, -3.6999999999999993, -3.8999999999999986, -20.500000000000007, -3.0000000000000018, -5.800000000000001, -3.6999999999999993, -2.900000000000002, -3.5, -3.6999999999999993, -4.799999999999995, -6.1, -2.4000000000000017, -4.299999999999997, -4.299999999999997, -4.1999999999999975, -2.5000000000000018], "episode_lengths": [118, 67, 57, 55, 51, 60, 51, 55, 66, 45, 40, 62, 223, 59, 69, 38, 34, 59, 265, 77, 55, 52, 58, 52, 57, 233, 47, 38, 53, 62, 52, 73, 49, 59, 61, 55, 172, 366, 42, 64, 39, 43, 39, 46, 165, 47, 47, 62, 224, 43, 53, 49, 39, 62, 50, 53, 39, 50, 59, 63, 44, 52, 40, 53, 55, 43, 58, 41, 53, 72, 96, 44, 49, 52, 400, 44, 55, 51, 62, 220, 56, 45, 62, 55, 48, 50, 180, 41, 59, 48, 40, 46, 48, 59, 59, 35, 54, 54, 53, 36]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2692298573254267, "mean_inference_ms": 0.7272967804553612, "mean_action_processing_ms": 0.07679109118008226, "mean_env_wait_ms": 6.57989191640511, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006360292434692383, "StateBufferConnector_ms": 0.0038063526153564453, "ViewRequirementAgentConnector_ms": 0.08954000473022461}}, "episode_reward_max": -2.3000000000000016, "episode_reward_min": -72.40000000000049, "episode_reward_mean": -7.228000000000008, "episode_len_mean": 72.35, "episodes_this_iter": 63, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-12.59999999999997, -6.399999999999997, -4.699999999999997, -4.399999999999997, -4.1999999999999975, -5.399999999999998, -3.9999999999999982, -4.399999999999997, -5.499999999999993, -3.4000000000000004, -2.900000000000002, -5.099999999999994, -27.60000000000006, -4.799999999999995, -5.799999999999992, -2.700000000000002, -2.3000000000000016, -4.799999999999995, -32.50000000000007, -7.199999999999992, -4.399999999999997, -4.099999999999998, -4.699999999999996, -4.499999999999996, -4.599999999999996, -26.70000000000003, -3.5999999999999996, -2.700000000000002, -4.299999999999998, -5.8999999999999915, -4.199999999999998, -6.19999999999999, -3.799999999999999, -6.100000000000002, -5.599999999999998, -4.399999999999997, -17.59999999999999, -56.500000000000306, -3.200000000000001, -5.299999999999994, -2.800000000000002, -3.200000000000001, -2.800000000000002, -3.5, -19.500000000000032, -3.5999999999999996, -3.5999999999999996, -5.099999999999994, -28.500000000000018, -3.200000000000001, -4.1999999999999975, -3.8999999999999995, -2.800000000000002, -5.099999999999994, -3.8999999999999986, -4.1999999999999975, -2.800000000000002, -3.8999999999999986, -4.799999999999995, -5.199999999999994, -3.3000000000000007, -4.099999999999998, -2.900000000000002, -4.399999999999999, -4.399999999999997, -3.200000000000001, -4.699999999999996, -3.0000000000000018, -4.1999999999999975, -6.699999999999994, -9.099999999999982, -3.5, -3.799999999999999, -4.199999999999998, -72.40000000000049, -3.3000000000000007, -4.399999999999997, -3.9999999999999982, -5.099999999999994, -29.699999999999996, -4.4999999999999964, -3.4000000000000004, -5.099999999999994, -4.399999999999997, -3.6999999999999993, -3.8999999999999986, -20.500000000000007, -3.0000000000000018, -5.800000000000001, -3.6999999999999993, -2.900000000000002, -3.5, -3.6999999999999993, -4.799999999999995, -6.1, -2.4000000000000017, -4.299999999999997, -4.299999999999997, -4.1999999999999975, -2.5000000000000018], "episode_lengths": [118, 67, 57, 55, 51, 60, 51, 55, 66, 45, 40, 62, 223, 59, 69, 38, 34, 59, 265, 77, 55, 52, 58, 52, 57, 233, 47, 38, 53, 62, 52, 73, 49, 59, 61, 55, 172, 366, 42, 64, 39, 43, 39, 46, 165, 47, 47, 62, 224, 43, 53, 49, 39, 62, 50, 53, 39, 50, 59, 63, 44, 52, 40, 53, 55, 43, 58, 41, 53, 72, 96, 44, 49, 52, 400, 44, 55, 51, 62, 220, 56, 45, 62, 55, 48, 50, 180, 41, 59, 48, 40, 46, 48, 59, 59, 35, 54, 54, 53, 36]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2692298573254267, "mean_inference_ms": 0.7272967804553612, "mean_action_processing_ms": 0.07679109118008226, "mean_env_wait_ms": 6.57989191640511, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006360292434692383, "StateBufferConnector_ms": 0.0038063526153564453, "ViewRequirementAgentConnector_ms": 0.08954000473022461}, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 92000, "num_agent_steps_trained": 92000, "num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 435.223225497231, "num_env_steps_trained_throughput_per_sec": 435.223225497231, "timesteps_total": 92000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 92000, "timers": {"training_iteration_time_ms": 9069.693, "sample_time_ms": 5337.128, "load_time_ms": 1.005, "load_throughput": 3979415.56, "learn_time_ms": 3728.776, "learn_throughput": 1072.738, "synch_weights_time_ms": 2.118}, "counters": {"num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_agent_steps_sampled": 92000, "num_agent_steps_trained": 92000}, "done": false, "episodes_total": 778, "training_iteration": 23, "trial_id": "95ff9_00000", "date": "2024-03-07_12-35-26", "timestamp": 1709832926, "time_this_iter_s": 9.193121671676636, "time_total_s": 206.10944652557373, "pid": 108075, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4d85689f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 206.10944652557373, "iterations_since_restore": 23, "perf": {"cpu_util_percent": 27.5, "ram_util_percent": 47.39166666666666, "gpu_util_percent0": 0.11, "vram_util_percent0": 0.11027018229166669}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 1.9167757408723476, "policy_loss": -0.006853992580085672, "vf_loss": 1.922241045326315, "vf_explained_var": 0.5133898139640849, "kl": 0.006943393715028248, "entropy": 0.7443042937145439, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 21855.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000}, "sampler_results": {"episode_reward_max": -2.2000000000000015, "episode_reward_min": -72.40000000000049, "episode_reward_mean": -5.930000000000002, "episode_len_mean": 63.11, "episode_media": {}, "episodes_this_iter": 64, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4.399999999999997, -3.200000000000001, -4.699999999999996, -3.0000000000000018, -4.1999999999999975, -6.699999999999994, -9.099999999999982, -3.5, -3.799999999999999, -4.199999999999998, -72.40000000000049, -3.3000000000000007, -4.399999999999997, -3.9999999999999982, -5.099999999999994, -29.699999999999996, -4.4999999999999964, -3.4000000000000004, -5.099999999999994, -4.399999999999997, -3.6999999999999993, -3.8999999999999986, -20.500000000000007, -3.0000000000000018, -5.800000000000001, -3.6999999999999993, -2.900000000000002, -3.5, -3.6999999999999993, -4.799999999999995, -6.1, -2.4000000000000017, -4.299999999999997, -4.299999999999997, -4.1999999999999975, -2.5000000000000018, -9.899999999999977, -26.000000000000025, -8.199999999999994, -5.599999999999996, -2.800000000000002, -4.399999999999997, -3.200000000000001, -5.599999999999994, -4.799999999999995, -3.5999999999999996, -3.8999999999999986, -2.2000000000000015, -11.499999999999977, -5.199999999999998, -5.599999999999996, -3.1000000000000014, -2.700000000000002, -5.799999999999996, -4.4999999999999964, -2.700000000000002, -3.0000000000000018, -12.499999999999972, -3.3000000000000007, -4.4999999999999964, -3.799999999999999, -4.099999999999998, -3.4000000000000004, -6.000000000000002, -4.000000000000003, -4.099999999999998, -4.399999999999998, -3.4000000000000004, -3.4000000000000004, -2.700000000000002, -4.299999999999997, -3.4000000000000004, -3.5999999999999996, -3.3000000000000007, -3.799999999999999, -7.699999999999989, -4.700000000000001, -4.699999999999996, -2.900000000000002, -3.5999999999999996, -3.4000000000000004, -3.799999999999999, -4.699999999999997, -5.8999999999999915, -3.1000000000000014, -4.799999999999997, -4.299999999999999, -4.099999999999998, -3.6999999999999993, -5.799999999999996, -3.799999999999999, -15.299999999999965, -3.799999999999999, -2.800000000000002, -2.700000000000002, -16.29999999999998, -3.5, -3.4000000000000004, -4.399999999999999, -5.099999999999994], "episode_lengths": [55, 43, 58, 41, 53, 72, 96, 44, 49, 52, 400, 44, 55, 51, 62, 220, 56, 45, 62, 55, 48, 50, 180, 41, 59, 48, 40, 46, 48, 59, 59, 35, 54, 54, 53, 36, 92, 215, 80, 63, 39, 55, 43, 65, 59, 47, 50, 33, 120, 58, 63, 41, 38, 64, 56, 38, 41, 127, 44, 56, 49, 52, 45, 59, 46, 52, 54, 45, 43, 38, 54, 45, 47, 44, 49, 69, 52, 58, 40, 47, 45, 49, 57, 62, 41, 56, 52, 52, 48, 58, 49, 150, 49, 39, 38, 162, 46, 45, 53, 62]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2717346192326755, "mean_inference_ms": 0.7273325264566393, "mean_action_processing_ms": 0.07675449686351767, "mean_env_wait_ms": 6.594076425354139, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0064508914947509766, "StateBufferConnector_ms": 0.0037899017333984375, "ViewRequirementAgentConnector_ms": 0.08971667289733887}}, "episode_reward_max": -2.2000000000000015, "episode_reward_min": -72.40000000000049, "episode_reward_mean": -5.930000000000002, "episode_len_mean": 63.11, "episodes_this_iter": 64, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-4.399999999999997, -3.200000000000001, -4.699999999999996, -3.0000000000000018, -4.1999999999999975, -6.699999999999994, -9.099999999999982, -3.5, -3.799999999999999, -4.199999999999998, -72.40000000000049, -3.3000000000000007, -4.399999999999997, -3.9999999999999982, -5.099999999999994, -29.699999999999996, -4.4999999999999964, -3.4000000000000004, -5.099999999999994, -4.399999999999997, -3.6999999999999993, -3.8999999999999986, -20.500000000000007, -3.0000000000000018, -5.800000000000001, -3.6999999999999993, -2.900000000000002, -3.5, -3.6999999999999993, -4.799999999999995, -6.1, -2.4000000000000017, -4.299999999999997, -4.299999999999997, -4.1999999999999975, -2.5000000000000018, -9.899999999999977, -26.000000000000025, -8.199999999999994, -5.599999999999996, -2.800000000000002, -4.399999999999997, -3.200000000000001, -5.599999999999994, -4.799999999999995, -3.5999999999999996, -3.8999999999999986, -2.2000000000000015, -11.499999999999977, -5.199999999999998, -5.599999999999996, -3.1000000000000014, -2.700000000000002, -5.799999999999996, -4.4999999999999964, -2.700000000000002, -3.0000000000000018, -12.499999999999972, -3.3000000000000007, -4.4999999999999964, -3.799999999999999, -4.099999999999998, -3.4000000000000004, -6.000000000000002, -4.000000000000003, -4.099999999999998, -4.399999999999998, -3.4000000000000004, -3.4000000000000004, -2.700000000000002, -4.299999999999997, -3.4000000000000004, -3.5999999999999996, -3.3000000000000007, -3.799999999999999, -7.699999999999989, -4.700000000000001, -4.699999999999996, -2.900000000000002, -3.5999999999999996, -3.4000000000000004, -3.799999999999999, -4.699999999999997, -5.8999999999999915, -3.1000000000000014, -4.799999999999997, -4.299999999999999, -4.099999999999998, -3.6999999999999993, -5.799999999999996, -3.799999999999999, -15.299999999999965, -3.799999999999999, -2.800000000000002, -2.700000000000002, -16.29999999999998, -3.5, -3.4000000000000004, -4.399999999999999, -5.099999999999994], "episode_lengths": [55, 43, 58, 41, 53, 72, 96, 44, 49, 52, 400, 44, 55, 51, 62, 220, 56, 45, 62, 55, 48, 50, 180, 41, 59, 48, 40, 46, 48, 59, 59, 35, 54, 54, 53, 36, 92, 215, 80, 63, 39, 55, 43, 65, 59, 47, 50, 33, 120, 58, 63, 41, 38, 64, 56, 38, 41, 127, 44, 56, 49, 52, 45, 59, 46, 52, 54, 45, 43, 38, 54, 45, 47, 44, 49, 69, 52, 58, 40, 47, 45, 49, 57, 62, 41, 56, 52, 52, 48, 58, 49, 150, 49, 39, 38, 162, 46, 45, 53, 62]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2717346192326755, "mean_inference_ms": 0.7273325264566393, "mean_action_processing_ms": 0.07675449686351767, "mean_env_wait_ms": 6.594076425354139, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0064508914947509766, "StateBufferConnector_ms": 0.0037899017333984375, "ViewRequirementAgentConnector_ms": 0.08971667289733887}, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000, "num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 439.9512438447085, "num_env_steps_trained_throughput_per_sec": 439.9512438447085, "timesteps_total": 96000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 96000, "timers": {"training_iteration_time_ms": 9082.632, "sample_time_ms": 5357.75, "load_time_ms": 1.008, "load_throughput": 3966620.011, "learn_time_ms": 3721.094, "learn_throughput": 1074.953, "synch_weights_time_ms": 2.122}, "counters": {"num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000}, "done": false, "episodes_total": 842, "training_iteration": 24, "trial_id": "95ff9_00000", "date": "2024-03-07_12-35-35", "timestamp": 1709832935, "time_this_iter_s": 9.094323873519897, "time_total_s": 215.20377039909363, "pid": 108075, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4d85689f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 215.20377039909363, "iterations_since_restore": 24, "perf": {"cpu_util_percent": 27.599999999999998, "ram_util_percent": 47.29999999999999, "gpu_util_percent0": 0.11, "vram_util_percent0": 0.1102566189236111}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 1.0077940165104033, "policy_loss": -0.009990285144698236, "vf_loss": 1.0162489143831115, "vf_explained_var": 0.7072720034789014, "kl": 0.00767696245206073, "entropy": 0.7199744354012192, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 22785.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_agent_steps_sampled": 100000, "num_agent_steps_trained": 100000}, "sampler_results": {"episode_reward_max": -2.2000000000000015, "episode_reward_min": -25.599999999999998, "episode_reward_mean": -4.654999999999998, "episode_len_mean": 54.79, "episode_media": {}, "episodes_this_iter": 78, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2.900000000000002, -3.5999999999999996, -3.4000000000000004, -3.799999999999999, -4.699999999999997, -5.8999999999999915, -3.1000000000000014, -4.799999999999997, -4.299999999999999, -4.099999999999998, -3.6999999999999993, -5.799999999999996, -3.799999999999999, -15.299999999999965, -3.799999999999999, -2.800000000000002, -2.700000000000002, -16.29999999999998, -3.5, -3.4000000000000004, -4.399999999999999, -5.099999999999994, -25.599999999999998, -5.299999999999999, -4.700000000000001, -4.599999999999996, -9.099999999999984, -3.1000000000000014, -3.8999999999999986, -3.6999999999999993, -2.700000000000002, -3.9999999999999982, -2.800000000000002, -4.799999999999995, -5.299999999999998, -4.099999999999998, -2.900000000000002, -4.099999999999999, -2.800000000000002, -4.400000000000001, -5.199999999999998, -3.9999999999999982, -2.2000000000000015, -3.200000000000002, -3.5999999999999996, -2.800000000000002, -5.200000000000002, -2.4000000000000017, -2.700000000000002, -3.5, -4.1999999999999975, -3.3000000000000007, -6.499999999999994, -3.799999999999999, -4.899999999999995, -3.799999999999999, -3.200000000000001, -3.200000000000001, -3.799999999999999, -3.8999999999999986, -3.799999999999999, -6.600000000000001, -6.1999999999999975, -3.5, -5.299999999999999, -4.9999999999999964, -3.0000000000000018, -4.699999999999999, -3.200000000000001, -3.200000000000001, -3.6999999999999993, -4.1999999999999975, -2.4000000000000017, -5.099999999999997, -5.399999999999994, -3.3000000000000007, -3.4000000000000004, -4.1999999999999975, -4.8, -3.5, -2.5000000000000018, -7.799999999999994, -3.799999999999999, -2.800000000000002, -6.799999999999995, -6.699999999999993, -3.799999999999999, -2.5000000000000018, -3.999999999999999, -6.8999999999999915, -3.8999999999999986, -4.399999999999997, -9.699999999999983, -3.1000000000000014, -2.700000000000002, -3.200000000000001, -2.800000000000002, -3.5, -10.499999999999975, -5.099999999999994], "episode_lengths": [40, 47, 45, 49, 57, 62, 41, 56, 52, 52, 48, 58, 49, 150, 49, 39, 38, 162, 46, 45, 53, 62, 184, 58, 52, 57, 98, 42, 50, 48, 38, 51, 39, 59, 59, 52, 40, 51, 39, 50, 58, 51, 33, 42, 47, 39, 54, 35, 38, 46, 53, 44, 71, 49, 60, 49, 43, 43, 49, 50, 49, 63, 65, 46, 54, 56, 41, 54, 43, 40, 48, 53, 35, 59, 64, 44, 45, 53, 54, 46, 36, 79, 49, 39, 71, 73, 49, 36, 50, 76, 50, 55, 97, 42, 38, 43, 39, 46, 116, 62]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2744868023586596, "mean_inference_ms": 0.7275892404339112, "mean_action_processing_ms": 0.07665932113583813, "mean_env_wait_ms": 6.603512627989357, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0063478946685791016, "StateBufferConnector_ms": 0.003831624984741211, "ViewRequirementAgentConnector_ms": 0.08967280387878418}}, "episode_reward_max": -2.2000000000000015, "episode_reward_min": -25.599999999999998, "episode_reward_mean": -4.654999999999998, "episode_len_mean": 54.79, "episodes_this_iter": 78, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-2.900000000000002, -3.5999999999999996, -3.4000000000000004, -3.799999999999999, -4.699999999999997, -5.8999999999999915, -3.1000000000000014, -4.799999999999997, -4.299999999999999, -4.099999999999998, -3.6999999999999993, -5.799999999999996, -3.799999999999999, -15.299999999999965, -3.799999999999999, -2.800000000000002, -2.700000000000002, -16.29999999999998, -3.5, -3.4000000000000004, -4.399999999999999, -5.099999999999994, -25.599999999999998, -5.299999999999999, -4.700000000000001, -4.599999999999996, -9.099999999999984, -3.1000000000000014, -3.8999999999999986, -3.6999999999999993, -2.700000000000002, -3.9999999999999982, -2.800000000000002, -4.799999999999995, -5.299999999999998, -4.099999999999998, -2.900000000000002, -4.099999999999999, -2.800000000000002, -4.400000000000001, -5.199999999999998, -3.9999999999999982, -2.2000000000000015, -3.200000000000002, -3.5999999999999996, -2.800000000000002, -5.200000000000002, -2.4000000000000017, -2.700000000000002, -3.5, -4.1999999999999975, -3.3000000000000007, -6.499999999999994, -3.799999999999999, -4.899999999999995, -3.799999999999999, -3.200000000000001, -3.200000000000001, -3.799999999999999, -3.8999999999999986, -3.799999999999999, -6.600000000000001, -6.1999999999999975, -3.5, -5.299999999999999, -4.9999999999999964, -3.0000000000000018, -4.699999999999999, -3.200000000000001, -3.200000000000001, -3.6999999999999993, -4.1999999999999975, -2.4000000000000017, -5.099999999999997, -5.399999999999994, -3.3000000000000007, -3.4000000000000004, -4.1999999999999975, -4.8, -3.5, -2.5000000000000018, -7.799999999999994, -3.799999999999999, -2.800000000000002, -6.799999999999995, -6.699999999999993, -3.799999999999999, -2.5000000000000018, -3.999999999999999, -6.8999999999999915, -3.8999999999999986, -4.399999999999997, -9.699999999999983, -3.1000000000000014, -2.700000000000002, -3.200000000000001, -2.800000000000002, -3.5, -10.499999999999975, -5.099999999999994], "episode_lengths": [40, 47, 45, 49, 57, 62, 41, 56, 52, 52, 48, 58, 49, 150, 49, 39, 38, 162, 46, 45, 53, 62, 184, 58, 52, 57, 98, 42, 50, 48, 38, 51, 39, 59, 59, 52, 40, 51, 39, 50, 58, 51, 33, 42, 47, 39, 54, 35, 38, 46, 53, 44, 71, 49, 60, 49, 43, 43, 49, 50, 49, 63, 65, 46, 54, 56, 41, 54, 43, 40, 48, 53, 35, 59, 64, 44, 45, 53, 54, 46, 36, 79, 49, 39, 71, 73, 49, 36, 50, 76, 50, 55, 97, 42, 38, 43, 39, 46, 116, 62]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2744868023586596, "mean_inference_ms": 0.7275892404339112, "mean_action_processing_ms": 0.07665932113583813, "mean_env_wait_ms": 6.603512627989357, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0063478946685791016, "StateBufferConnector_ms": 0.003831624984741211, "ViewRequirementAgentConnector_ms": 0.08967280387878418}, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 100000, "num_agent_steps_trained": 100000, "num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 418.55846946038184, "num_env_steps_trained_throughput_per_sec": 418.55846946038184, "timesteps_total": 100000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 100000, "timers": {"training_iteration_time_ms": 9129.262, "sample_time_ms": 5389.221, "load_time_ms": 1.002, "load_throughput": 3992198.929, "learn_time_ms": 3736.223, "learn_throughput": 1070.6, "synch_weights_time_ms": 2.154}, "counters": {"num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_agent_steps_sampled": 100000, "num_agent_steps_trained": 100000}, "done": false, "episodes_total": 920, "training_iteration": 25, "trial_id": "95ff9_00000", "date": "2024-03-07_12-35-44", "timestamp": 1709832944, "time_this_iter_s": 9.559451818466187, "time_total_s": 224.76322221755981, "pid": 108075, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4d85689f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 224.76322221755981, "iterations_since_restore": 25, "perf": {"cpu_util_percent": 29.024999999999995, "ram_util_percent": 47.383333333333326, "gpu_util_percent0": 0.12583333333333332, "vram_util_percent0": 0.11042616102430557}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 1.7066425404609658, "policy_loss": -0.01003540834832576, "vf_loss": 1.7153130732797166, "vf_explained_var": 0.5274936046651615, "kl": 0.006824330171798219, "entropy": 0.7240744908009806, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 23715.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 104000, "num_env_steps_trained": 104000, "num_agent_steps_sampled": 104000, "num_agent_steps_trained": 104000}, "sampler_results": {"episode_reward_max": -2.0000000000000013, "episode_reward_min": -20.400000000000013, "episode_reward_mean": -4.507999999999998, "episode_len_mean": 53.7, "episode_media": {}, "episodes_this_iter": 73, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-5.099999999999997, -5.399999999999994, -3.3000000000000007, -3.4000000000000004, -4.1999999999999975, -4.8, -3.5, -2.5000000000000018, -7.799999999999994, -3.799999999999999, -2.800000000000002, -6.799999999999995, -6.699999999999993, -3.799999999999999, -2.5000000000000018, -3.999999999999999, -6.8999999999999915, -3.8999999999999986, -4.399999999999997, -9.699999999999983, -3.1000000000000014, -2.700000000000002, -3.200000000000001, -2.800000000000002, -3.5, -10.499999999999975, -5.099999999999994, -2.900000000000002, -3.200000000000001, -7.099999999999987, -4.099999999999998, -3.4000000000000004, -3.9999999999999982, -2.600000000000002, -13.19999999999997, -3.9999999999999982, -3.4000000000000004, -2.3000000000000016, -3.6999999999999993, -2.5000000000000018, -3.3000000000000007, -3.6000000000000023, -2.800000000000002, -5.199999999999999, -4.399999999999997, -3.1000000000000014, -11.19999999999998, -3.799999999999999, -4.299999999999998, -3.0000000000000018, -3.200000000000001, -3.8999999999999986, -2.600000000000002, -5.399999999999993, -2.900000000000002, -2.5000000000000018, -8.699999999999989, -2.900000000000002, -3.3000000000000007, -3.5, -2.900000000000002, -2.700000000000002, -2.2000000000000015, -2.600000000000002, -3.0000000000000018, -3.4000000000000004, -4.8, -3.1000000000000014, -3.8999999999999986, -20.400000000000013, -4.099999999999998, -4.399999999999997, -3.4000000000000004, -5.100000000000002, -2.3000000000000016, -13.599999999999973, -3.1000000000000014, -2.0000000000000013, -4.799999999999995, -2.700000000000002, -2.4000000000000017, -3.0000000000000018, -7.69999999999999, -5.499999999999993, -2.900000000000002, -7.100000000000003, -3.5999999999999996, -3.3000000000000007, -15.499999999999961, -3.200000000000001, -3.4000000000000004, -3.5, -5.499999999999993, -3.0000000000000018, -4.4999999999999964, -3.4000000000000004, -4.1999999999999975, -3.799999999999999, -2.0000000000000013, -2.600000000000002], "episode_lengths": [59, 64, 44, 45, 53, 54, 46, 36, 79, 49, 39, 71, 73, 49, 36, 50, 76, 50, 55, 97, 42, 38, 43, 39, 46, 116, 62, 40, 43, 82, 52, 45, 50, 37, 128, 51, 45, 34, 48, 36, 44, 44, 39, 57, 55, 42, 107, 49, 53, 41, 43, 50, 37, 65, 40, 36, 80, 40, 44, 46, 40, 38, 33, 37, 41, 45, 54, 42, 50, 190, 52, 55, 45, 53, 34, 114, 42, 31, 59, 38, 35, 41, 82, 66, 40, 64, 47, 44, 133, 43, 45, 46, 66, 41, 56, 45, 53, 48, 31, 37]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.27710344675629855, "mean_inference_ms": 0.7280881309094895, "mean_action_processing_ms": 0.07672107044962242, "mean_env_wait_ms": 6.624841385180652, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0068035125732421875, "StateBufferConnector_ms": 0.00395965576171875, "ViewRequirementAgentConnector_ms": 0.09203839302062988}}, "episode_reward_max": -2.0000000000000013, "episode_reward_min": -20.400000000000013, "episode_reward_mean": -4.507999999999998, "episode_len_mean": 53.7, "episodes_this_iter": 73, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-5.099999999999997, -5.399999999999994, -3.3000000000000007, -3.4000000000000004, -4.1999999999999975, -4.8, -3.5, -2.5000000000000018, -7.799999999999994, -3.799999999999999, -2.800000000000002, -6.799999999999995, -6.699999999999993, -3.799999999999999, -2.5000000000000018, -3.999999999999999, -6.8999999999999915, -3.8999999999999986, -4.399999999999997, -9.699999999999983, -3.1000000000000014, -2.700000000000002, -3.200000000000001, -2.800000000000002, -3.5, -10.499999999999975, -5.099999999999994, -2.900000000000002, -3.200000000000001, -7.099999999999987, -4.099999999999998, -3.4000000000000004, -3.9999999999999982, -2.600000000000002, -13.19999999999997, -3.9999999999999982, -3.4000000000000004, -2.3000000000000016, -3.6999999999999993, -2.5000000000000018, -3.3000000000000007, -3.6000000000000023, -2.800000000000002, -5.199999999999999, -4.399999999999997, -3.1000000000000014, -11.19999999999998, -3.799999999999999, -4.299999999999998, -3.0000000000000018, -3.200000000000001, -3.8999999999999986, -2.600000000000002, -5.399999999999993, -2.900000000000002, -2.5000000000000018, -8.699999999999989, -2.900000000000002, -3.3000000000000007, -3.5, -2.900000000000002, -2.700000000000002, -2.2000000000000015, -2.600000000000002, -3.0000000000000018, -3.4000000000000004, -4.8, -3.1000000000000014, -3.8999999999999986, -20.400000000000013, -4.099999999999998, -4.399999999999997, -3.4000000000000004, -5.100000000000002, -2.3000000000000016, -13.599999999999973, -3.1000000000000014, -2.0000000000000013, -4.799999999999995, -2.700000000000002, -2.4000000000000017, -3.0000000000000018, -7.69999999999999, -5.499999999999993, -2.900000000000002, -7.100000000000003, -3.5999999999999996, -3.3000000000000007, -15.499999999999961, -3.200000000000001, -3.4000000000000004, -3.5, -5.499999999999993, -3.0000000000000018, -4.4999999999999964, -3.4000000000000004, -4.1999999999999975, -3.799999999999999, -2.0000000000000013, -2.600000000000002], "episode_lengths": [59, 64, 44, 45, 53, 54, 46, 36, 79, 49, 39, 71, 73, 49, 36, 50, 76, 50, 55, 97, 42, 38, 43, 39, 46, 116, 62, 40, 43, 82, 52, 45, 50, 37, 128, 51, 45, 34, 48, 36, 44, 44, 39, 57, 55, 42, 107, 49, 53, 41, 43, 50, 37, 65, 40, 36, 80, 40, 44, 46, 40, 38, 33, 37, 41, 45, 54, 42, 50, 190, 52, 55, 45, 53, 34, 114, 42, 31, 59, 38, 35, 41, 82, 66, 40, 64, 47, 44, 133, 43, 45, 46, 66, 41, 56, 45, 53, 48, 31, 37]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.27710344675629855, "mean_inference_ms": 0.7280881309094895, "mean_action_processing_ms": 0.07672107044962242, "mean_env_wait_ms": 6.624841385180652, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0068035125732421875, "StateBufferConnector_ms": 0.00395965576171875, "ViewRequirementAgentConnector_ms": 0.09203839302062988}, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 104000, "num_agent_steps_trained": 104000, "num_env_steps_sampled": 104000, "num_env_steps_trained": 104000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 423.9736164794707, "num_env_steps_trained_throughput_per_sec": 423.9736164794707, "timesteps_total": 104000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 104000, "timers": {"training_iteration_time_ms": 9177.167, "sample_time_ms": 5433.745, "load_time_ms": 1.006, "load_throughput": 3975737.814, "learn_time_ms": 3738.439, "learn_throughput": 1069.965, "synch_weights_time_ms": 3.272}, "counters": {"num_env_steps_sampled": 104000, "num_env_steps_trained": 104000, "num_agent_steps_sampled": 104000, "num_agent_steps_trained": 104000}, "done": false, "episodes_total": 993, "training_iteration": 26, "trial_id": "95ff9_00000", "date": "2024-03-07_12-35-54", "timestamp": 1709832954, "time_this_iter_s": 9.437851667404175, "time_total_s": 234.201073884964, "pid": 108075, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4d85689f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 234.201073884964, "iterations_since_restore": 26, "perf": {"cpu_util_percent": 28.0, "ram_util_percent": 47.43076923076922, "gpu_util_percent0": 0.10307692307692307, "vram_util_percent0": 0.11042042267628208}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 0.8924315927175915, "policy_loss": -0.012307915580208583, "vf_loss": 0.9028273335147289, "vf_explained_var": 0.7075781686972547, "kl": 0.00956082865958098, "entropy": 0.6805055613799762, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 24645.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_agent_steps_sampled": 108000, "num_agent_steps_trained": 108000}, "sampler_results": {"episode_reward_max": -2.0000000000000013, "episode_reward_min": -51.00000000000033, "episode_reward_mean": -4.331000000000003, "episode_len_mean": 51.58, "episode_media": {}, "episodes_this_iter": 80, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2.4000000000000017, -3.0000000000000018, -7.69999999999999, -5.499999999999993, -2.900000000000002, -7.100000000000003, -3.5999999999999996, -3.3000000000000007, -15.499999999999961, -3.200000000000001, -3.4000000000000004, -3.5, -5.499999999999993, -3.0000000000000018, -4.4999999999999964, -3.4000000000000004, -4.1999999999999975, -3.799999999999999, -2.0000000000000013, -2.600000000000002, -51.00000000000033, -4.399999999999997, -4.599999999999998, -4.499999999999998, -5.8999999999999915, -3.4000000000000012, -2.700000000000002, -2.800000000000002, -3.200000000000001, -3.799999999999999, -3.4000000000000004, -2.900000000000002, -3.3000000000000007, -2.5000000000000018, -3.6999999999999993, -3.6999999999999993, -3.4000000000000004, -3.1000000000000014, -3.4000000000000004, -11.199999999999973, -6.6, -2.5000000000000018, -2.900000000000002, -3.200000000000001, -4.299999999999997, -4.2, -3.5999999999999996, -3.200000000000001, -3.0000000000000018, -4.099999999999999, -3.200000000000001, -4.599999999999996, -2.3000000000000016, -2.5000000000000018, -3.9999999999999982, -2.800000000000002, -3.5, -5.8000000000000025, -5.099999999999998, -5.5999999999999925, -3.6999999999999993, -3.0000000000000018, -2.700000000000002, -3.3000000000000007, -4.1999999999999975, -3.5, -2.900000000000002, -2.800000000000002, -3.200000000000001, -2.3000000000000016, -2.5000000000000018, -3.8000000000000016, -2.4000000000000017, -2.800000000000002, -3.4000000000000004, -3.5, -2.700000000000002, -3.5, -3.5, -7.3999999999999915, -4.599999999999996, -3.5, -2.700000000000002, -3.6999999999999993, -3.5999999999999996, -3.8000000000000016, -3.3000000000000007, -4.299999999999997, -3.5999999999999996, -7.699999999999996, -3.3000000000000016, -3.8999999999999986, -3.6000000000000005, -2.4000000000000017, -2.700000000000002, -4.299999999999997, -2.600000000000002, -2.3000000000000016, -2.1000000000000014, -4.0], "episode_lengths": [35, 41, 82, 66, 40, 64, 47, 44, 133, 43, 45, 46, 66, 41, 56, 45, 53, 48, 31, 37, 400, 55, 55, 54, 70, 44, 38, 39, 42, 49, 45, 40, 44, 36, 45, 48, 45, 42, 45, 106, 65, 36, 40, 43, 54, 50, 47, 43, 41, 51, 43, 57, 34, 36, 51, 39, 46, 57, 58, 67, 48, 41, 38, 44, 53, 46, 40, 39, 43, 34, 36, 46, 35, 39, 45, 46, 38, 46, 46, 80, 57, 46, 38, 48, 47, 44, 44, 54, 47, 72, 40, 50, 46, 35, 38, 54, 37, 34, 32, 49]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2796564607963255, "mean_inference_ms": 0.728446000923218, "mean_action_processing_ms": 0.07677614806616599, "mean_env_wait_ms": 6.646793878745349, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006638288497924805, "StateBufferConnector_ms": 0.003874540328979492, "ViewRequirementAgentConnector_ms": 0.09043741226196289}}, "episode_reward_max": -2.0000000000000013, "episode_reward_min": -51.00000000000033, "episode_reward_mean": -4.331000000000003, "episode_len_mean": 51.58, "episodes_this_iter": 80, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-2.4000000000000017, -3.0000000000000018, -7.69999999999999, -5.499999999999993, -2.900000000000002, -7.100000000000003, -3.5999999999999996, -3.3000000000000007, -15.499999999999961, -3.200000000000001, -3.4000000000000004, -3.5, -5.499999999999993, -3.0000000000000018, -4.4999999999999964, -3.4000000000000004, -4.1999999999999975, -3.799999999999999, -2.0000000000000013, -2.600000000000002, -51.00000000000033, -4.399999999999997, -4.599999999999998, -4.499999999999998, -5.8999999999999915, -3.4000000000000012, -2.700000000000002, -2.800000000000002, -3.200000000000001, -3.799999999999999, -3.4000000000000004, -2.900000000000002, -3.3000000000000007, -2.5000000000000018, -3.6999999999999993, -3.6999999999999993, -3.4000000000000004, -3.1000000000000014, -3.4000000000000004, -11.199999999999973, -6.6, -2.5000000000000018, -2.900000000000002, -3.200000000000001, -4.299999999999997, -4.2, -3.5999999999999996, -3.200000000000001, -3.0000000000000018, -4.099999999999999, -3.200000000000001, -4.599999999999996, -2.3000000000000016, -2.5000000000000018, -3.9999999999999982, -2.800000000000002, -3.5, -5.8000000000000025, -5.099999999999998, -5.5999999999999925, -3.6999999999999993, -3.0000000000000018, -2.700000000000002, -3.3000000000000007, -4.1999999999999975, -3.5, -2.900000000000002, -2.800000000000002, -3.200000000000001, -2.3000000000000016, -2.5000000000000018, -3.8000000000000016, -2.4000000000000017, -2.800000000000002, -3.4000000000000004, -3.5, -2.700000000000002, -3.5, -3.5, -7.3999999999999915, -4.599999999999996, -3.5, -2.700000000000002, -3.6999999999999993, -3.5999999999999996, -3.8000000000000016, -3.3000000000000007, -4.299999999999997, -3.5999999999999996, -7.699999999999996, -3.3000000000000016, -3.8999999999999986, -3.6000000000000005, -2.4000000000000017, -2.700000000000002, -4.299999999999997, -2.600000000000002, -2.3000000000000016, -2.1000000000000014, -4.0], "episode_lengths": [35, 41, 82, 66, 40, 64, 47, 44, 133, 43, 45, 46, 66, 41, 56, 45, 53, 48, 31, 37, 400, 55, 55, 54, 70, 44, 38, 39, 42, 49, 45, 40, 44, 36, 45, 48, 45, 42, 45, 106, 65, 36, 40, 43, 54, 50, 47, 43, 41, 51, 43, 57, 34, 36, 51, 39, 46, 57, 58, 67, 48, 41, 38, 44, 53, 46, 40, 39, 43, 34, 36, 46, 35, 39, 45, 46, 38, 46, 46, 80, 57, 46, 38, 48, 47, 44, 44, 54, 47, 72, 40, 50, 46, 35, 38, 54, 37, 34, 32, 49]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2796564607963255, "mean_inference_ms": 0.728446000923218, "mean_action_processing_ms": 0.07677614806616599, "mean_env_wait_ms": 6.646793878745349, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006638288497924805, "StateBufferConnector_ms": 0.003874540328979492, "ViewRequirementAgentConnector_ms": 0.09043741226196289}, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 108000, "num_agent_steps_trained": 108000, "num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 423.1895291086427, "num_env_steps_trained_throughput_per_sec": 423.1895291086427, "timesteps_total": 108000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 108000, "timers": {"training_iteration_time_ms": 9213.929, "sample_time_ms": 5464.862, "load_time_ms": 1.005, "load_throughput": 3980831.89, "learn_time_ms": 3744.094, "learn_throughput": 1068.349, "synch_weights_time_ms": 3.263}, "counters": {"num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_agent_steps_sampled": 108000, "num_agent_steps_trained": 108000}, "done": false, "episodes_total": 1073, "training_iteration": 27, "trial_id": "95ff9_00000", "date": "2024-03-07_12-36-03", "timestamp": 1709832963, "time_this_iter_s": 9.454570531845093, "time_total_s": 243.65564441680908, "pid": 108075, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4d85689f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 243.65564441680908, "iterations_since_restore": 27, "perf": {"cpu_util_percent": 28.38333333333334, "ram_util_percent": 47.34166666666666, "gpu_util_percent0": 0.12, "vram_util_percent0": 0.11027018229166669}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 2.4471708141420017, "policy_loss": -0.002082870828528558, "vf_loss": 2.448222841042024, "vf_explained_var": 0.5617854589416135, "kl": 0.005154242283382241, "entropy": 0.6518517603797297, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 25575.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_agent_steps_sampled": 112000, "num_agent_steps_trained": 112000}, "sampler_results": {"episode_reward_max": -2.1000000000000014, "episode_reward_min": -72.70000000000049, "episode_reward_mean": -4.889000000000009, "episode_len_mean": 51.93, "episode_media": {}, "episodes_this_iter": 75, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.5, -2.700000000000002, -3.5, -3.5, -7.3999999999999915, -4.599999999999996, -3.5, -2.700000000000002, -3.6999999999999993, -3.5999999999999996, -3.8000000000000016, -3.3000000000000007, -4.299999999999997, -3.5999999999999996, -7.699999999999996, -3.3000000000000016, -3.8999999999999986, -3.6000000000000005, -2.4000000000000017, -2.700000000000002, -4.299999999999997, -2.600000000000002, -2.3000000000000016, -2.1000000000000014, -4.0, -3.4000000000000004, -4.099999999999998, -3.6000000000000023, -2.1000000000000014, -71.90000000000047, -3.0000000000000018, -2.800000000000002, -3.4000000000000004, -2.5000000000000018, -3.1000000000000014, -4.399999999999997, -3.0000000000000018, -3.200000000000001, -4.4, -4.799999999999995, -2.800000000000002, -3.0000000000000018, -5.799999999999996, -2.4000000000000017, -3.3000000000000007, -3.3000000000000007, -2.800000000000002, -3.3000000000000007, -4.399999999999997, -2.900000000000002, -2.3000000000000016, -3.4000000000000004, -3.4000000000000004, -3.5999999999999996, -7.199999999999999, -3.0000000000000018, -5.7, -3.0000000000000018, -3.5999999999999996, -2.700000000000002, -3.3000000000000007, -3.200000000000001, -2.5000000000000018, -3.1000000000000014, -2.4000000000000017, -2.4000000000000017, -3.799999999999999, -3.200000000000001, -2.5000000000000018, -3.8999999999999986, -3.4000000000000004, -3.5999999999999996, -3.0000000000000018, -3.3000000000000007, -4.099999999999999, -3.0000000000000018, -3.9999999999999982, -3.3000000000000007, -2.5000000000000018, -2.4000000000000017, -2.600000000000002, -3.6999999999999993, -3.6000000000000023, -3.3000000000000007, -9.499999999999986, -4.099999999999998, -6.299999999999999, -3.200000000000001, -3.200000000000002, -3.1000000000000014, -3.3000000000000007, -3.4000000000000004, -3.4000000000000004, -3.200000000000002, -2.1000000000000014, -2.900000000000002, -72.70000000000049, -2.5000000000000018, -3.0000000000000018, -2.700000000000002], "episode_lengths": [46, 38, 46, 46, 80, 57, 46, 38, 48, 47, 44, 44, 54, 47, 72, 40, 50, 46, 35, 38, 54, 37, 34, 32, 49, 45, 52, 43, 32, 400, 41, 39, 45, 36, 42, 52, 41, 43, 51, 50, 39, 41, 64, 35, 44, 44, 39, 44, 48, 40, 34, 45, 45, 47, 68, 41, 59, 41, 47, 38, 44, 43, 36, 42, 35, 35, 46, 43, 36, 48, 45, 47, 40, 44, 51, 41, 51, 44, 36, 35, 37, 48, 44, 44, 89, 52, 64, 43, 42, 42, 44, 45, 45, 42, 32, 40, 400, 36, 41, 38]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2824854762577306, "mean_inference_ms": 0.7283777046208024, "mean_action_processing_ms": 0.07679569777217175, "mean_env_wait_ms": 6.657054858775091, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006513357162475586, "StateBufferConnector_ms": 0.0038483142852783203, "ViewRequirementAgentConnector_ms": 0.08985614776611328}}, "episode_reward_max": -2.1000000000000014, "episode_reward_min": -72.70000000000049, "episode_reward_mean": -4.889000000000009, "episode_len_mean": 51.93, "episodes_this_iter": 75, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3.5, -2.700000000000002, -3.5, -3.5, -7.3999999999999915, -4.599999999999996, -3.5, -2.700000000000002, -3.6999999999999993, -3.5999999999999996, -3.8000000000000016, -3.3000000000000007, -4.299999999999997, -3.5999999999999996, -7.699999999999996, -3.3000000000000016, -3.8999999999999986, -3.6000000000000005, -2.4000000000000017, -2.700000000000002, -4.299999999999997, -2.600000000000002, -2.3000000000000016, -2.1000000000000014, -4.0, -3.4000000000000004, -4.099999999999998, -3.6000000000000023, -2.1000000000000014, -71.90000000000047, -3.0000000000000018, -2.800000000000002, -3.4000000000000004, -2.5000000000000018, -3.1000000000000014, -4.399999999999997, -3.0000000000000018, -3.200000000000001, -4.4, -4.799999999999995, -2.800000000000002, -3.0000000000000018, -5.799999999999996, -2.4000000000000017, -3.3000000000000007, -3.3000000000000007, -2.800000000000002, -3.3000000000000007, -4.399999999999997, -2.900000000000002, -2.3000000000000016, -3.4000000000000004, -3.4000000000000004, -3.5999999999999996, -7.199999999999999, -3.0000000000000018, -5.7, -3.0000000000000018, -3.5999999999999996, -2.700000000000002, -3.3000000000000007, -3.200000000000001, -2.5000000000000018, -3.1000000000000014, -2.4000000000000017, -2.4000000000000017, -3.799999999999999, -3.200000000000001, -2.5000000000000018, -3.8999999999999986, -3.4000000000000004, -3.5999999999999996, -3.0000000000000018, -3.3000000000000007, -4.099999999999999, -3.0000000000000018, -3.9999999999999982, -3.3000000000000007, -2.5000000000000018, -2.4000000000000017, -2.600000000000002, -3.6999999999999993, -3.6000000000000023, -3.3000000000000007, -9.499999999999986, -4.099999999999998, -6.299999999999999, -3.200000000000001, -3.200000000000002, -3.1000000000000014, -3.3000000000000007, -3.4000000000000004, -3.4000000000000004, -3.200000000000002, -2.1000000000000014, -2.900000000000002, -72.70000000000049, -2.5000000000000018, -3.0000000000000018, -2.700000000000002], "episode_lengths": [46, 38, 46, 46, 80, 57, 46, 38, 48, 47, 44, 44, 54, 47, 72, 40, 50, 46, 35, 38, 54, 37, 34, 32, 49, 45, 52, 43, 32, 400, 41, 39, 45, 36, 42, 52, 41, 43, 51, 50, 39, 41, 64, 35, 44, 44, 39, 44, 48, 40, 34, 45, 45, 47, 68, 41, 59, 41, 47, 38, 44, 43, 36, 42, 35, 35, 46, 43, 36, 48, 45, 47, 40, 44, 51, 41, 51, 44, 36, 35, 37, 48, 44, 44, 89, 52, 64, 43, 42, 42, 44, 45, 45, 42, 32, 40, 400, 36, 41, 38]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2824854762577306, "mean_inference_ms": 0.7283777046208024, "mean_action_processing_ms": 0.07679569777217175, "mean_env_wait_ms": 6.657054858775091, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006513357162475586, "StateBufferConnector_ms": 0.0038483142852783203, "ViewRequirementAgentConnector_ms": 0.08985614776611328}, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 112000, "num_agent_steps_trained": 112000, "num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 429.81534036468736, "num_env_steps_trained_throughput_per_sec": 429.81534036468736, "timesteps_total": 112000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 112000, "timers": {"training_iteration_time_ms": 9251.103, "sample_time_ms": 5504.119, "load_time_ms": 1.007, "load_throughput": 3970656.758, "learn_time_ms": 3742.002, "learn_throughput": 1068.946, "synch_weights_time_ms": 3.269}, "counters": {"num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_agent_steps_sampled": 112000, "num_agent_steps_trained": 112000}, "done": false, "episodes_total": 1148, "training_iteration": 28, "trial_id": "95ff9_00000", "date": "2024-03-07_12-36-13", "timestamp": 1709832973, "time_this_iter_s": 9.308805465698242, "time_total_s": 252.96444988250732, "pid": 108075, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4d85689f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 252.96444988250732, "iterations_since_restore": 28, "perf": {"cpu_util_percent": 28.058333333333334, "ram_util_percent": 47.36666666666667, "gpu_util_percent0": 0.11166666666666668, "vram_util_percent0": 0.11024983723958331}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 0.5994359752373589, "policy_loss": -0.015216535922660623, "vf_loss": 0.6132428427777623, "vf_explained_var": 0.7804933076904667, "kl": 0.007048329475274481, "entropy": 0.6048317164503118, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 26505.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 116000, "num_env_steps_trained": 116000, "num_agent_steps_sampled": 116000, "num_agent_steps_trained": 116000}, "sampler_results": {"episode_reward_max": -1.9000000000000012, "episode_reward_min": -72.70000000000049, "episode_reward_mean": -4.021000000000006, "episode_len_mean": 46.61, "episode_media": {}, "episodes_this_iter": 92, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.4000000000000004, -3.200000000000002, -2.1000000000000014, -2.900000000000002, -72.70000000000049, -2.5000000000000018, -3.0000000000000018, -2.700000000000002, -3.1000000000000014, -2.2000000000000015, -3.1000000000000014, -3.8999999999999995, -2.800000000000002, -3.5999999999999996, -2.3000000000000016, -3.4000000000000004, -2.4000000000000017, -3.799999999999999, -3.9000000000000012, -3.8000000000000016, -2.3000000000000016, -3.4000000000000004, -3.1000000000000014, -2.600000000000002, -4.399999999999998, -2.700000000000002, -2.800000000000002, -3.0000000000000018, -2.900000000000002, -2.900000000000002, -6.699999999999997, -3.8000000000000007, -4.1999999999999975, -2.4000000000000017, -3.3000000000000007, -4.0, -2.600000000000002, -4.1999999999999975, -2.900000000000002, -1.9000000000000012, -3.200000000000001, -2.700000000000002, -3.5, -2.4000000000000017, -3.0000000000000018, -2.600000000000002, -3.4000000000000004, -2.800000000000002, -4.2, -3.5999999999999996, -2.600000000000002, -4.200000000000001, -6.6, -3.1000000000000014, -3.4000000000000004, -3.1000000000000014, -3.200000000000001, -3.5999999999999996, -9.599999999999985, -2.800000000000002, -3.200000000000001, -3.4000000000000004, -2.800000000000002, -3.8999999999999986, -2.900000000000002, -2.1000000000000014, -3.0000000000000018, -3.3000000000000007, -2.1000000000000014, -2.3000000000000016, -2.0000000000000013, -4.000000000000002, -3.1000000000000014, -4.799999999999996, -3.0000000000000018, -2.700000000000002, -3.5, -3.5, -2.800000000000002, -5.599999999999999, -4.100000000000001, -4.099999999999999, -2.3000000000000016, -2.4000000000000017, -2.2000000000000015, -3.3000000000000016, -3.0000000000000018, -3.0000000000000018, -4.399999999999997, -6.100000000000003, -2.800000000000002, -3.3000000000000007, -3.0000000000000018, -3.8999999999999986, -2.600000000000002, -3.0000000000000018, -3.6999999999999993, -4.599999999999997, -2.2000000000000015, -3.5999999999999996], "episode_lengths": [45, 42, 32, 40, 400, 36, 41, 38, 42, 33, 42, 49, 39, 47, 34, 45, 35, 49, 47, 41, 34, 45, 42, 37, 54, 37, 39, 41, 40, 40, 69, 40, 53, 35, 44, 49, 34, 53, 40, 30, 43, 38, 46, 35, 41, 37, 45, 39, 50, 47, 37, 48, 65, 42, 45, 42, 43, 47, 92, 39, 43, 45, 39, 50, 40, 32, 41, 44, 32, 34, 31, 47, 42, 58, 41, 38, 46, 46, 39, 52, 48, 49, 34, 35, 33, 42, 39, 41, 55, 58, 39, 44, 41, 50, 37, 41, 47, 54, 33, 47]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.28430386534576274, "mean_inference_ms": 0.7282696336117003, "mean_action_processing_ms": 0.07678588190923824, "mean_env_wait_ms": 6.671565884407417, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0064601898193359375, "StateBufferConnector_ms": 0.003811359405517578, "ViewRequirementAgentConnector_ms": 0.08951783180236816}}, "episode_reward_max": -1.9000000000000012, "episode_reward_min": -72.70000000000049, "episode_reward_mean": -4.021000000000006, "episode_len_mean": 46.61, "episodes_this_iter": 92, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3.4000000000000004, -3.200000000000002, -2.1000000000000014, -2.900000000000002, -72.70000000000049, -2.5000000000000018, -3.0000000000000018, -2.700000000000002, -3.1000000000000014, -2.2000000000000015, -3.1000000000000014, -3.8999999999999995, -2.800000000000002, -3.5999999999999996, -2.3000000000000016, -3.4000000000000004, -2.4000000000000017, -3.799999999999999, -3.9000000000000012, -3.8000000000000016, -2.3000000000000016, -3.4000000000000004, -3.1000000000000014, -2.600000000000002, -4.399999999999998, -2.700000000000002, -2.800000000000002, -3.0000000000000018, -2.900000000000002, -2.900000000000002, -6.699999999999997, -3.8000000000000007, -4.1999999999999975, -2.4000000000000017, -3.3000000000000007, -4.0, -2.600000000000002, -4.1999999999999975, -2.900000000000002, -1.9000000000000012, -3.200000000000001, -2.700000000000002, -3.5, -2.4000000000000017, -3.0000000000000018, -2.600000000000002, -3.4000000000000004, -2.800000000000002, -4.2, -3.5999999999999996, -2.600000000000002, -4.200000000000001, -6.6, -3.1000000000000014, -3.4000000000000004, -3.1000000000000014, -3.200000000000001, -3.5999999999999996, -9.599999999999985, -2.800000000000002, -3.200000000000001, -3.4000000000000004, -2.800000000000002, -3.8999999999999986, -2.900000000000002, -2.1000000000000014, -3.0000000000000018, -3.3000000000000007, -2.1000000000000014, -2.3000000000000016, -2.0000000000000013, -4.000000000000002, -3.1000000000000014, -4.799999999999996, -3.0000000000000018, -2.700000000000002, -3.5, -3.5, -2.800000000000002, -5.599999999999999, -4.100000000000001, -4.099999999999999, -2.3000000000000016, -2.4000000000000017, -2.2000000000000015, -3.3000000000000016, -3.0000000000000018, -3.0000000000000018, -4.399999999999997, -6.100000000000003, -2.800000000000002, -3.3000000000000007, -3.0000000000000018, -3.8999999999999986, -2.600000000000002, -3.0000000000000018, -3.6999999999999993, -4.599999999999997, -2.2000000000000015, -3.5999999999999996], "episode_lengths": [45, 42, 32, 40, 400, 36, 41, 38, 42, 33, 42, 49, 39, 47, 34, 45, 35, 49, 47, 41, 34, 45, 42, 37, 54, 37, 39, 41, 40, 40, 69, 40, 53, 35, 44, 49, 34, 53, 40, 30, 43, 38, 46, 35, 41, 37, 45, 39, 50, 47, 37, 48, 65, 42, 45, 42, 43, 47, 92, 39, 43, 45, 39, 50, 40, 32, 41, 44, 32, 34, 31, 47, 42, 58, 41, 38, 46, 46, 39, 52, 48, 49, 34, 35, 33, 42, 39, 41, 55, 58, 39, 44, 41, 50, 37, 41, 47, 54, 33, 47]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.28430386534576274, "mean_inference_ms": 0.7282696336117003, "mean_action_processing_ms": 0.07678588190923824, "mean_env_wait_ms": 6.671565884407417, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0064601898193359375, "StateBufferConnector_ms": 0.003811359405517578, "ViewRequirementAgentConnector_ms": 0.08951783180236816}, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 116000, "num_agent_steps_trained": 116000, "num_env_steps_sampled": 116000, "num_env_steps_trained": 116000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 425.40326389158827, "num_env_steps_trained_throughput_per_sec": 425.40326389158827, "timesteps_total": 116000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 116000, "timers": {"training_iteration_time_ms": 9264.341, "sample_time_ms": 5520.433, "load_time_ms": 0.993, "load_throughput": 4026789.555, "learn_time_ms": 3738.961, "learn_throughput": 1069.816, "synch_weights_time_ms": 3.257}, "counters": {"num_env_steps_sampled": 116000, "num_env_steps_trained": 116000, "num_agent_steps_sampled": 116000, "num_agent_steps_trained": 116000}, "done": false, "episodes_total": 1240, "training_iteration": 29, "trial_id": "95ff9_00000", "date": "2024-03-07_12-36-22", "timestamp": 1709832982, "time_this_iter_s": 9.405413389205933, "time_total_s": 262.36986327171326, "pid": 108075, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4d85689f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 262.36986327171326, "iterations_since_restore": 29, "perf": {"cpu_util_percent": 28.691666666666666, "ram_util_percent": 47.34166666666666, "gpu_util_percent0": 0.105, "vram_util_percent0": 0.1102294921875}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 1.1290407810954788, "policy_loss": -0.01705590294053157, "vf_loss": 1.1440922109029625, "vf_explained_var": 0.6884462609726896, "kl": 0.010022359954991265, "entropy": 0.5975608775372147, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 27435.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 120000, "num_env_steps_trained": 120000, "num_agent_steps_sampled": 120000, "num_agent_steps_trained": 120000}, "sampler_results": {"episode_reward_max": -1.9000000000000012, "episode_reward_min": -17.8, "episode_reward_mean": -3.135000000000001, "episode_len_mean": 41.52, "episode_media": {}, "episodes_this_iter": 90, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2.800000000000002, -3.3000000000000007, -3.0000000000000018, -3.8999999999999986, -2.600000000000002, -3.0000000000000018, -3.6999999999999993, -4.599999999999997, -2.2000000000000015, -3.5999999999999996, -3.4000000000000004, -2.600000000000002, -2.3000000000000016, -3.1000000000000014, -2.700000000000002, -3.799999999999999, -3.1000000000000014, -4.399999999999999, -6.499999999999992, -3.0000000000000018, -2.5000000000000018, -1.9000000000000012, -2.700000000000002, -2.900000000000002, -1.9000000000000012, -2.600000000000002, -2.700000000000002, -2.600000000000002, -3.1000000000000014, -3.6000000000000023, -5.099999999999997, -2.900000000000002, -5.799999999999996, -3.0000000000000018, -2.900000000000002, -2.900000000000002, -2.2000000000000015, -2.800000000000002, -2.700000000000002, -2.900000000000002, -3.1000000000000014, -2.3000000000000016, -3.1000000000000014, -3.3000000000000007, -2.0000000000000013, -3.3000000000000007, -2.4000000000000017, -2.5000000000000018, -2.1000000000000014, -2.2000000000000015, -3.6000000000000023, -2.0000000000000013, -2.900000000000002, -3.1000000000000014, -2.700000000000002, -3.5, -3.4000000000000004, -2.4000000000000017, -2.3000000000000016, -3.5999999999999996, -3.3000000000000007, -3.4000000000000004, -2.1000000000000014, -2.5000000000000018, -2.800000000000002, -2.700000000000002, -2.900000000000002, -2.900000000000002, -3.8999999999999986, -3.0000000000000018, -17.8, -2.600000000000002, -2.800000000000002, -4.599999999999996, -3.4000000000000004, -2.900000000000002, -2.700000000000002, -2.900000000000002, -3.1000000000000014, -2.3000000000000016, -2.2000000000000015, -3.3000000000000007, -2.3000000000000016, -3.200000000000001, -4.799999999999995, -2.600000000000002, -2.800000000000002, -2.900000000000002, -2.600000000000002, -2.900000000000002, -2.2000000000000015, -3.200000000000001, -2.800000000000002, -2.4000000000000017, -2.900000000000002, -2.1000000000000014, -2.0000000000000013, -3.3000000000000007, -2.2000000000000015, -3.1000000000000014], "episode_lengths": [39, 44, 41, 50, 37, 41, 47, 54, 33, 47, 45, 37, 34, 42, 38, 49, 42, 53, 73, 41, 36, 30, 38, 40, 30, 37, 38, 37, 42, 44, 59, 40, 64, 41, 40, 40, 33, 39, 38, 40, 42, 34, 42, 44, 31, 38, 35, 36, 32, 33, 43, 31, 40, 42, 38, 46, 45, 35, 34, 47, 44, 45, 32, 36, 39, 38, 38, 40, 50, 41, 139, 37, 39, 57, 45, 39, 38, 40, 42, 34, 33, 44, 34, 43, 59, 37, 39, 40, 37, 40, 33, 43, 39, 35, 40, 32, 31, 44, 33, 42]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.28719774756884314, "mean_inference_ms": 0.7286434717509082, "mean_action_processing_ms": 0.07682267295707267, "mean_env_wait_ms": 6.689185265023407, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006539821624755859, "StateBufferConnector_ms": 0.003887653350830078, "ViewRequirementAgentConnector_ms": 0.09055018424987793}}, "episode_reward_max": -1.9000000000000012, "episode_reward_min": -17.8, "episode_reward_mean": -3.135000000000001, "episode_len_mean": 41.52, "episodes_this_iter": 90, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-2.800000000000002, -3.3000000000000007, -3.0000000000000018, -3.8999999999999986, -2.600000000000002, -3.0000000000000018, -3.6999999999999993, -4.599999999999997, -2.2000000000000015, -3.5999999999999996, -3.4000000000000004, -2.600000000000002, -2.3000000000000016, -3.1000000000000014, -2.700000000000002, -3.799999999999999, -3.1000000000000014, -4.399999999999999, -6.499999999999992, -3.0000000000000018, -2.5000000000000018, -1.9000000000000012, -2.700000000000002, -2.900000000000002, -1.9000000000000012, -2.600000000000002, -2.700000000000002, -2.600000000000002, -3.1000000000000014, -3.6000000000000023, -5.099999999999997, -2.900000000000002, -5.799999999999996, -3.0000000000000018, -2.900000000000002, -2.900000000000002, -2.2000000000000015, -2.800000000000002, -2.700000000000002, -2.900000000000002, -3.1000000000000014, -2.3000000000000016, -3.1000000000000014, -3.3000000000000007, -2.0000000000000013, -3.3000000000000007, -2.4000000000000017, -2.5000000000000018, -2.1000000000000014, -2.2000000000000015, -3.6000000000000023, -2.0000000000000013, -2.900000000000002, -3.1000000000000014, -2.700000000000002, -3.5, -3.4000000000000004, -2.4000000000000017, -2.3000000000000016, -3.5999999999999996, -3.3000000000000007, -3.4000000000000004, -2.1000000000000014, -2.5000000000000018, -2.800000000000002, -2.700000000000002, -2.900000000000002, -2.900000000000002, -3.8999999999999986, -3.0000000000000018, -17.8, -2.600000000000002, -2.800000000000002, -4.599999999999996, -3.4000000000000004, -2.900000000000002, -2.700000000000002, -2.900000000000002, -3.1000000000000014, -2.3000000000000016, -2.2000000000000015, -3.3000000000000007, -2.3000000000000016, -3.200000000000001, -4.799999999999995, -2.600000000000002, -2.800000000000002, -2.900000000000002, -2.600000000000002, -2.900000000000002, -2.2000000000000015, -3.200000000000001, -2.800000000000002, -2.4000000000000017, -2.900000000000002, -2.1000000000000014, -2.0000000000000013, -3.3000000000000007, -2.2000000000000015, -3.1000000000000014], "episode_lengths": [39, 44, 41, 50, 37, 41, 47, 54, 33, 47, 45, 37, 34, 42, 38, 49, 42, 53, 73, 41, 36, 30, 38, 40, 30, 37, 38, 37, 42, 44, 59, 40, 64, 41, 40, 40, 33, 39, 38, 40, 42, 34, 42, 44, 31, 38, 35, 36, 32, 33, 43, 31, 40, 42, 38, 46, 45, 35, 34, 47, 44, 45, 32, 36, 39, 38, 38, 40, 50, 41, 139, 37, 39, 57, 45, 39, 38, 40, 42, 34, 33, 44, 34, 43, 59, 37, 39, 40, 37, 40, 33, 43, 39, 35, 40, 32, 31, 44, 33, 42]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.28719774756884314, "mean_inference_ms": 0.7286434717509082, "mean_action_processing_ms": 0.07682267295707267, "mean_env_wait_ms": 6.689185265023407, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006539821624755859, "StateBufferConnector_ms": 0.003887653350830078, "ViewRequirementAgentConnector_ms": 0.09055018424987793}, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 120000, "num_agent_steps_trained": 120000, "num_env_steps_sampled": 120000, "num_env_steps_trained": 120000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 394.46235311245294, "num_env_steps_trained_throughput_per_sec": 394.46235311245294, "timesteps_total": 120000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 120000, "timers": {"training_iteration_time_ms": 9377.639, "sample_time_ms": 5572.234, "load_time_ms": 1.032, "load_throughput": 3874377.295, "learn_time_ms": 3800.393, "learn_throughput": 1052.523, "synch_weights_time_ms": 3.275}, "counters": {"num_env_steps_sampled": 120000, "num_env_steps_trained": 120000, "num_agent_steps_sampled": 120000, "num_agent_steps_trained": 120000}, "done": false, "episodes_total": 1330, "training_iteration": 30, "trial_id": "95ff9_00000", "date": "2024-03-07_12-36-32", "timestamp": 1709832992, "time_this_iter_s": 10.142863750457764, "time_total_s": 272.512727022171, "pid": 108075, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4d85689f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 272.512727022171, "iterations_since_restore": 30, "perf": {"cpu_util_percent": 29.49230769230769, "ram_util_percent": 47.5076923076923, "gpu_util_percent0": 0.14307692307692307, "vram_util_percent0": 0.11270532852564104}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 0.4952894218172753, "policy_loss": -0.012859827157871057, "vf_loss": 0.5067197406964917, "vf_explained_var": 0.7813461135792475, "kl": 0.007147526973533796, "entropy": 0.537107051380219, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 28365.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 124000, "num_env_steps_trained": 124000, "num_agent_steps_sampled": 124000, "num_agent_steps_trained": 124000}, "sampler_results": {"episode_reward_max": -1.8000000000000012, "episode_reward_min": -61.000000000000355, "episode_reward_mean": -3.514705882352946, "episode_len_mean": 42.57843137254902, "episode_media": {}, "episodes_this_iter": 102, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2.1000000000000014, -2.800000000000002, -2.2000000000000015, -2.4000000000000017, -8.299999999999999, -2.3000000000000016, -2.900000000000002, -3.8, -2.3000000000000016, -1.8000000000000012, -4.299999999999997, -3.200000000000001, -2.3000000000000016, -3.1000000000000014, -1.8000000000000012, -2.2000000000000015, -2.4000000000000017, -2.600000000000002, -5.799999999999993, -1.8000000000000012, -3.1000000000000014, -2.800000000000002, -2.4000000000000017, -2.3000000000000016, -2.900000000000002, -2.2000000000000015, -1.9000000000000012, -3.0000000000000018, -2.700000000000002, -1.8000000000000012, -2.3000000000000016, -2.0000000000000013, -4.099999999999998, -2.5000000000000018, -3.0000000000000018, -4.999999999999995, -1.9000000000000012, -2.800000000000002, -3.0000000000000018, -2.900000000000002, -2.3000000000000016, -2.1000000000000014, -3.200000000000001, -3.3000000000000007, -2.1000000000000014, -3.5, -2.4000000000000017, -3.6999999999999993, -2.2000000000000015, -7.100000000000003, -3.5999999999999996, -3.200000000000001, -2.600000000000002, -2.600000000000002, -2.5000000000000018, -3.200000000000001, -3.3000000000000016, -2.1000000000000014, -2.1000000000000014, -1.9000000000000012, -1.9000000000000012, -2.600000000000002, -2.3000000000000016, -3.200000000000001, -2.4000000000000017, -3.200000000000002, -2.700000000000002, -2.900000000000002, -2.900000000000002, -5.0, -3.4000000000000004, -2.3000000000000016, -2.3000000000000016, -2.800000000000002, -2.3000000000000016, -2.5000000000000018, -3.4000000000000004, -2.700000000000002, -3.6000000000000014, -2.2000000000000015, -2.900000000000002, -2.900000000000002, -2.700000000000002, -1.9000000000000012, -4.1999999999999975, -1.9000000000000012, -2.900000000000002, -61.000000000000355, -5.300000000000001, -2.4000000000000017, -2.800000000000002, -5.099999999999997, -2.5000000000000018, -2.1000000000000014, -2.2000000000000015, -5.200000000000001, -2.700000000000002, -5.099999999999998, -3.5999999999999996, -2.800000000000002, -2.900000000000002, -2.800000000000002], "episode_lengths": [32, 39, 33, 35, 65, 34, 40, 46, 34, 29, 54, 43, 34, 42, 29, 33, 35, 37, 68, 29, 40, 39, 35, 34, 40, 33, 30, 41, 38, 29, 34, 31, 52, 36, 40, 61, 30, 39, 41, 40, 34, 32, 43, 42, 32, 46, 35, 48, 33, 61, 47, 43, 37, 37, 36, 43, 43, 32, 32, 30, 30, 37, 34, 43, 35, 42, 38, 40, 40, 54, 45, 34, 34, 39, 34, 36, 45, 38, 45, 33, 40, 40, 38, 30, 53, 30, 38, 359, 56, 35, 39, 59, 36, 32, 33, 55, 38, 51, 47, 39, 40, 39]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.29094671621868834, "mean_inference_ms": 0.728858015288897, "mean_action_processing_ms": 0.07685221190066059, "mean_env_wait_ms": 6.704291529134966, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006696055917178883, "StateBufferConnector_ms": 0.003891131457160501, "ViewRequirementAgentConnector_ms": 0.09083327125100528}}, "episode_reward_max": -1.8000000000000012, "episode_reward_min": -61.000000000000355, "episode_reward_mean": -3.514705882352946, "episode_len_mean": 42.57843137254902, "episodes_this_iter": 102, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-2.1000000000000014, -2.800000000000002, -2.2000000000000015, -2.4000000000000017, -8.299999999999999, -2.3000000000000016, -2.900000000000002, -3.8, -2.3000000000000016, -1.8000000000000012, -4.299999999999997, -3.200000000000001, -2.3000000000000016, -3.1000000000000014, -1.8000000000000012, -2.2000000000000015, -2.4000000000000017, -2.600000000000002, -5.799999999999993, -1.8000000000000012, -3.1000000000000014, -2.800000000000002, -2.4000000000000017, -2.3000000000000016, -2.900000000000002, -2.2000000000000015, -1.9000000000000012, -3.0000000000000018, -2.700000000000002, -1.8000000000000012, -2.3000000000000016, -2.0000000000000013, -4.099999999999998, -2.5000000000000018, -3.0000000000000018, -4.999999999999995, -1.9000000000000012, -2.800000000000002, -3.0000000000000018, -2.900000000000002, -2.3000000000000016, -2.1000000000000014, -3.200000000000001, -3.3000000000000007, -2.1000000000000014, -3.5, -2.4000000000000017, -3.6999999999999993, -2.2000000000000015, -7.100000000000003, -3.5999999999999996, -3.200000000000001, -2.600000000000002, -2.600000000000002, -2.5000000000000018, -3.200000000000001, -3.3000000000000016, -2.1000000000000014, -2.1000000000000014, -1.9000000000000012, -1.9000000000000012, -2.600000000000002, -2.3000000000000016, -3.200000000000001, -2.4000000000000017, -3.200000000000002, -2.700000000000002, -2.900000000000002, -2.900000000000002, -5.0, -3.4000000000000004, -2.3000000000000016, -2.3000000000000016, -2.800000000000002, -2.3000000000000016, -2.5000000000000018, -3.4000000000000004, -2.700000000000002, -3.6000000000000014, -2.2000000000000015, -2.900000000000002, -2.900000000000002, -2.700000000000002, -1.9000000000000012, -4.1999999999999975, -1.9000000000000012, -2.900000000000002, -61.000000000000355, -5.300000000000001, -2.4000000000000017, -2.800000000000002, -5.099999999999997, -2.5000000000000018, -2.1000000000000014, -2.2000000000000015, -5.200000000000001, -2.700000000000002, -5.099999999999998, -3.5999999999999996, -2.800000000000002, -2.900000000000002, -2.800000000000002], "episode_lengths": [32, 39, 33, 35, 65, 34, 40, 46, 34, 29, 54, 43, 34, 42, 29, 33, 35, 37, 68, 29, 40, 39, 35, 34, 40, 33, 30, 41, 38, 29, 34, 31, 52, 36, 40, 61, 30, 39, 41, 40, 34, 32, 43, 42, 32, 46, 35, 48, 33, 61, 47, 43, 37, 37, 36, 43, 43, 32, 32, 30, 30, 37, 34, 43, 35, 42, 38, 40, 40, 54, 45, 34, 34, 39, 34, 36, 45, 38, 45, 33, 40, 40, 38, 30, 53, 30, 38, 359, 56, 35, 39, 59, 36, 32, 33, 55, 38, 51, 47, 39, 40, 39]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.29094671621868834, "mean_inference_ms": 0.728858015288897, "mean_action_processing_ms": 0.07685221190066059, "mean_env_wait_ms": 6.704291529134966, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006696055917178883, "StateBufferConnector_ms": 0.003891131457160501, "ViewRequirementAgentConnector_ms": 0.09083327125100528}, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 124000, "num_agent_steps_trained": 124000, "num_env_steps_sampled": 124000, "num_env_steps_trained": 124000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 424.1794816632405, "num_env_steps_trained_throughput_per_sec": 424.1794816632405, "timesteps_total": 124000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 124000, "timers": {"training_iteration_time_ms": 9414.928, "sample_time_ms": 5608.929, "load_time_ms": 1.035, "load_throughput": 3863136.614, "learn_time_ms": 3799.812, "learn_throughput": 1052.684, "synch_weights_time_ms": 4.414}, "counters": {"num_env_steps_sampled": 124000, "num_env_steps_trained": 124000, "num_agent_steps_sampled": 124000, "num_agent_steps_trained": 124000}, "done": false, "episodes_total": 1432, "training_iteration": 31, "trial_id": "95ff9_00000", "date": "2024-03-07_12-36-42", "timestamp": 1709833002, "time_this_iter_s": 9.433517694473267, "time_total_s": 281.9462447166443, "pid": 108075, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4d85689f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 281.9462447166443, "iterations_since_restore": 31, "perf": {"cpu_util_percent": 27.215384615384615, "ram_util_percent": 47.599999999999994, "gpu_util_percent0": 0.1023076923076923, "vram_util_percent0": 0.12130033052884616}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 0.34756148791344965, "policy_loss": -0.013350969180464745, "vf_loss": 0.3595244442303014, "vf_explained_var": 0.8136269755260919, "kl": 0.00694008234669023, "entropy": 0.488797311596973, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 29295.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 128000, "num_env_steps_trained": 128000, "num_agent_steps_sampled": 128000, "num_agent_steps_trained": 128000}, "sampler_results": {"episode_reward_max": -1.600000000000001, "episode_reward_min": -5.499999999999993, "episode_reward_mean": -2.68867924528302, "episode_len_mean": 37.65094339622642, "episode_media": {}, "episodes_this_iter": 106, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2.600000000000002, -3.1000000000000014, -2.2000000000000015, -2.0000000000000013, -3.1000000000000014, -2.700000000000002, -3.8, -5.299999999999996, -2.600000000000002, -3.0000000000000018, -4.399999999999997, -2.1000000000000014, -2.5000000000000018, -2.4000000000000017, -2.700000000000002, -2.5000000000000018, -2.5000000000000018, -2.1000000000000014, -2.600000000000002, -2.600000000000002, -2.5000000000000018, -2.4000000000000017, -2.4000000000000017, -2.5000000000000018, -2.700000000000002, -2.3000000000000016, -3.200000000000001, -3.0000000000000018, -2.5000000000000018, -3.0000000000000027, -3.1000000000000014, -2.4000000000000017, -2.800000000000002, -3.1000000000000014, -3.200000000000001, -3.0000000000000018, -1.8000000000000012, -2.1000000000000014, -1.700000000000001, -2.700000000000002, -2.600000000000002, -3.200000000000001, -2.800000000000002, -1.9000000000000012, -2.4000000000000017, -1.8000000000000012, -2.0000000000000013, -2.2000000000000015, -2.4000000000000017, -2.1000000000000014, -5.300000000000001, -2.900000000000002, -2.3000000000000016, -3.6999999999999993, -2.600000000000002, -2.2000000000000015, -2.3000000000000016, -5.199999999999994, -3.1000000000000014, -2.2000000000000015, -2.0000000000000013, -2.900000000000002, -2.600000000000002, -2.2000000000000015, -2.900000000000002, -1.8000000000000012, -2.5000000000000018, -3.0000000000000018, -2.0000000000000013, -2.3000000000000016, -2.800000000000002, -2.0000000000000013, -2.2000000000000015, -2.5000000000000018, -2.5000000000000018, -3.5999999999999996, -2.700000000000002, -1.9000000000000012, -2.800000000000002, -2.700000000000002, -2.1000000000000014, -2.1000000000000014, -3.0000000000000018, -2.4000000000000017, -2.2000000000000015, -2.900000000000002, -2.900000000000002, -2.2000000000000015, -3.0000000000000018, -2.800000000000002, -2.700000000000002, -3.0000000000000018, -3.1000000000000014, -2.0000000000000013, -2.4000000000000017, -2.800000000000002, -1.8000000000000012, -4.599999999999996, -3.6999999999999993, -2.4000000000000017, -2.3000000000000016, -1.600000000000001, -1.8000000000000012, -5.499999999999993, -2.700000000000002, -2.700000000000002], "episode_lengths": [37, 42, 33, 31, 42, 38, 44, 61, 37, 41, 55, 32, 36, 35, 38, 36, 36, 32, 37, 37, 36, 33, 35, 36, 38, 34, 43, 41, 36, 39, 42, 35, 38, 42, 43, 40, 29, 32, 28, 38, 37, 43, 39, 30, 35, 29, 31, 33, 35, 32, 56, 40, 34, 48, 37, 33, 34, 63, 39, 33, 31, 40, 37, 33, 40, 29, 36, 41, 31, 34, 39, 31, 33, 36, 36, 47, 38, 30, 39, 38, 32, 32, 41, 35, 33, 40, 40, 33, 41, 39, 38, 41, 42, 31, 35, 39, 29, 57, 48, 35, 34, 27, 29, 66, 38, 38]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2942370081036089, "mean_inference_ms": 0.7337246899033977, "mean_action_processing_ms": 0.07688573480087488, "mean_env_wait_ms": 6.727089843845798, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006828443059381449, "StateBufferConnector_ms": 0.003971468727543669, "ViewRequirementAgentConnector_ms": 0.09188157207560989}}, "episode_reward_max": -1.600000000000001, "episode_reward_min": -5.499999999999993, "episode_reward_mean": -2.68867924528302, "episode_len_mean": 37.65094339622642, "episodes_this_iter": 106, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-2.600000000000002, -3.1000000000000014, -2.2000000000000015, -2.0000000000000013, -3.1000000000000014, -2.700000000000002, -3.8, -5.299999999999996, -2.600000000000002, -3.0000000000000018, -4.399999999999997, -2.1000000000000014, -2.5000000000000018, -2.4000000000000017, -2.700000000000002, -2.5000000000000018, -2.5000000000000018, -2.1000000000000014, -2.600000000000002, -2.600000000000002, -2.5000000000000018, -2.4000000000000017, -2.4000000000000017, -2.5000000000000018, -2.700000000000002, -2.3000000000000016, -3.200000000000001, -3.0000000000000018, -2.5000000000000018, -3.0000000000000027, -3.1000000000000014, -2.4000000000000017, -2.800000000000002, -3.1000000000000014, -3.200000000000001, -3.0000000000000018, -1.8000000000000012, -2.1000000000000014, -1.700000000000001, -2.700000000000002, -2.600000000000002, -3.200000000000001, -2.800000000000002, -1.9000000000000012, -2.4000000000000017, -1.8000000000000012, -2.0000000000000013, -2.2000000000000015, -2.4000000000000017, -2.1000000000000014, -5.300000000000001, -2.900000000000002, -2.3000000000000016, -3.6999999999999993, -2.600000000000002, -2.2000000000000015, -2.3000000000000016, -5.199999999999994, -3.1000000000000014, -2.2000000000000015, -2.0000000000000013, -2.900000000000002, -2.600000000000002, -2.2000000000000015, -2.900000000000002, -1.8000000000000012, -2.5000000000000018, -3.0000000000000018, -2.0000000000000013, -2.3000000000000016, -2.800000000000002, -2.0000000000000013, -2.2000000000000015, -2.5000000000000018, -2.5000000000000018, -3.5999999999999996, -2.700000000000002, -1.9000000000000012, -2.800000000000002, -2.700000000000002, -2.1000000000000014, -2.1000000000000014, -3.0000000000000018, -2.4000000000000017, -2.2000000000000015, -2.900000000000002, -2.900000000000002, -2.2000000000000015, -3.0000000000000018, -2.800000000000002, -2.700000000000002, -3.0000000000000018, -3.1000000000000014, -2.0000000000000013, -2.4000000000000017, -2.800000000000002, -1.8000000000000012, -4.599999999999996, -3.6999999999999993, -2.4000000000000017, -2.3000000000000016, -1.600000000000001, -1.8000000000000012, -5.499999999999993, -2.700000000000002, -2.700000000000002], "episode_lengths": [37, 42, 33, 31, 42, 38, 44, 61, 37, 41, 55, 32, 36, 35, 38, 36, 36, 32, 37, 37, 36, 33, 35, 36, 38, 34, 43, 41, 36, 39, 42, 35, 38, 42, 43, 40, 29, 32, 28, 38, 37, 43, 39, 30, 35, 29, 31, 33, 35, 32, 56, 40, 34, 48, 37, 33, 34, 63, 39, 33, 31, 40, 37, 33, 40, 29, 36, 41, 31, 34, 39, 31, 33, 36, 36, 47, 38, 30, 39, 38, 32, 32, 41, 35, 33, 40, 40, 33, 41, 39, 38, 41, 42, 31, 35, 39, 29, 57, 48, 35, 34, 27, 29, 66, 38, 38]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2942370081036089, "mean_inference_ms": 0.7337246899033977, "mean_action_processing_ms": 0.07688573480087488, "mean_env_wait_ms": 6.727089843845798, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006828443059381449, "StateBufferConnector_ms": 0.003971468727543669, "ViewRequirementAgentConnector_ms": 0.09188157207560989}, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 128000, "num_agent_steps_trained": 128000, "num_env_steps_sampled": 128000, "num_env_steps_trained": 128000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 416.24539430413336, "num_env_steps_trained_throughput_per_sec": 416.24539430413336, "timesteps_total": 128000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 128000, "timers": {"training_iteration_time_ms": 9461.458, "sample_time_ms": 5667.252, "load_time_ms": 1.019, "load_throughput": 3926975.166, "learn_time_ms": 3788.02, "learn_throughput": 1055.961, "synch_weights_time_ms": 4.429}, "counters": {"num_env_steps_sampled": 128000, "num_env_steps_trained": 128000, "num_agent_steps_sampled": 128000, "num_agent_steps_trained": 128000}, "done": false, "episodes_total": 1538, "training_iteration": 32, "trial_id": "95ff9_00000", "date": "2024-03-07_12-36-51", "timestamp": 1709833011, "time_this_iter_s": 9.612311601638794, "time_total_s": 291.5585563182831, "pid": 108075, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4d85689f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 291.5585563182831, "iterations_since_restore": 32, "perf": {"cpu_util_percent": 30.033333333333335, "ram_util_percent": 47.541666666666664, "gpu_util_percent0": 0.11083333333333334, "vram_util_percent0": 0.1201171875}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 0.2611816421103594, "policy_loss": -0.009541344847930695, "vf_loss": 0.2693696884678737, "vf_explained_var": 0.8520625820083003, "kl": 0.006766488798831523, "entropy": 0.47034280444345167, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 30225.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 132000, "num_env_steps_trained": 132000, "num_agent_steps_sampled": 132000, "num_agent_steps_trained": 132000}, "sampler_results": {"episode_reward_max": -1.600000000000001, "episode_reward_min": -11.699999999999985, "episode_reward_mean": -2.5351351351351368, "episode_len_mean": 35.927927927927925, "episode_media": {}, "episodes_this_iter": 111, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2.800000000000002, -1.8000000000000012, -2.3000000000000016, -2.4000000000000017, -4.299999999999997, -1.9000000000000012, -2.5000000000000018, -3.1000000000000014, -2.600000000000002, -2.600000000000002, -2.4000000000000017, -2.2000000000000015, -2.3000000000000016, -1.9000000000000012, -3.1000000000000014, -2.3000000000000016, -2.3000000000000016, -3.3000000000000007, -3.0000000000000018, -2.700000000000002, -3.6999999999999993, -2.900000000000002, -3.0000000000000018, -2.2000000000000015, -1.700000000000001, -2.5000000000000018, -2.700000000000002, -2.4000000000000017, -3.0000000000000018, -2.700000000000002, -3.9000000000000012, -2.4000000000000017, -2.800000000000002, -1.700000000000001, -1.600000000000001, -2.4000000000000017, -2.5000000000000018, -1.600000000000001, -1.9000000000000012, -2.0000000000000013, -2.0000000000000013, -2.4000000000000017, -3.3000000000000007, -2.0000000000000013, -2.700000000000002, -1.9000000000000012, -2.1000000000000014, -11.699999999999985, -2.900000000000002, -2.700000000000002, -2.800000000000002, -2.4000000000000017, -3.0000000000000018, -2.800000000000002, -2.3000000000000016, -3.3000000000000007, -2.0000000000000013, -1.9000000000000012, -2.5000000000000018, -2.900000000000002, -2.4000000000000017, -2.2000000000000015, -2.800000000000002, -2.4000000000000017, -2.2000000000000015, -2.2000000000000015, -1.600000000000001, -2.3000000000000016, -2.1000000000000014, -2.3000000000000016, -2.1000000000000014, -2.2000000000000015, -2.2000000000000015, -2.2000000000000015, -1.9000000000000012, -1.9000000000000012, -1.700000000000001, -2.1000000000000014, -2.0000000000000013, -2.600000000000002, -2.4000000000000017, -2.1000000000000014, -2.0000000000000013, -2.3000000000000016, -2.4000000000000017, -3.0000000000000018, -2.700000000000002, -3.200000000000001, -2.2000000000000015, -3.1000000000000014, -3.6999999999999993, -2.2000000000000015, -2.0000000000000013, -2.4000000000000017, -2.3000000000000016, -2.4000000000000017, -1.9000000000000012, -1.9000000000000012, -2.1000000000000014, -2.0000000000000013, -2.800000000000002, -2.600000000000002, -2.900000000000002, -2.2000000000000015, -2.600000000000002, -1.600000000000001, -2.800000000000002, -2.2000000000000015, -4.200000000000001, -1.600000000000001, -3.200000000000001], "episode_lengths": [39, 29, 34, 35, 54, 30, 36, 39, 37, 37, 35, 33, 34, 30, 42, 34, 34, 44, 41, 38, 48, 40, 41, 33, 28, 36, 38, 35, 40, 38, 47, 35, 39, 28, 27, 35, 36, 27, 30, 31, 31, 35, 44, 31, 38, 30, 32, 97, 40, 38, 39, 35, 41, 39, 34, 43, 31, 30, 36, 40, 35, 33, 39, 35, 33, 33, 27, 34, 32, 34, 32, 33, 33, 33, 30, 30, 28, 32, 31, 37, 35, 32, 31, 34, 35, 41, 38, 43, 33, 42, 48, 33, 31, 35, 34, 35, 30, 30, 32, 31, 39, 37, 40, 33, 37, 27, 39, 33, 45, 27, 43]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.29736050049315405, "mean_inference_ms": 0.733934912405491, "mean_action_processing_ms": 0.07687920763799216, "mean_env_wait_ms": 6.747575435296694, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0066589664768528295, "StateBufferConnector_ms": 0.003863025355983425, "ViewRequirementAgentConnector_ms": 0.09077518909901112}}, "episode_reward_max": -1.600000000000001, "episode_reward_min": -11.699999999999985, "episode_reward_mean": -2.5351351351351368, "episode_len_mean": 35.927927927927925, "episodes_this_iter": 111, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-2.800000000000002, -1.8000000000000012, -2.3000000000000016, -2.4000000000000017, -4.299999999999997, -1.9000000000000012, -2.5000000000000018, -3.1000000000000014, -2.600000000000002, -2.600000000000002, -2.4000000000000017, -2.2000000000000015, -2.3000000000000016, -1.9000000000000012, -3.1000000000000014, -2.3000000000000016, -2.3000000000000016, -3.3000000000000007, -3.0000000000000018, -2.700000000000002, -3.6999999999999993, -2.900000000000002, -3.0000000000000018, -2.2000000000000015, -1.700000000000001, -2.5000000000000018, -2.700000000000002, -2.4000000000000017, -3.0000000000000018, -2.700000000000002, -3.9000000000000012, -2.4000000000000017, -2.800000000000002, -1.700000000000001, -1.600000000000001, -2.4000000000000017, -2.5000000000000018, -1.600000000000001, -1.9000000000000012, -2.0000000000000013, -2.0000000000000013, -2.4000000000000017, -3.3000000000000007, -2.0000000000000013, -2.700000000000002, -1.9000000000000012, -2.1000000000000014, -11.699999999999985, -2.900000000000002, -2.700000000000002, -2.800000000000002, -2.4000000000000017, -3.0000000000000018, -2.800000000000002, -2.3000000000000016, -3.3000000000000007, -2.0000000000000013, -1.9000000000000012, -2.5000000000000018, -2.900000000000002, -2.4000000000000017, -2.2000000000000015, -2.800000000000002, -2.4000000000000017, -2.2000000000000015, -2.2000000000000015, -1.600000000000001, -2.3000000000000016, -2.1000000000000014, -2.3000000000000016, -2.1000000000000014, -2.2000000000000015, -2.2000000000000015, -2.2000000000000015, -1.9000000000000012, -1.9000000000000012, -1.700000000000001, -2.1000000000000014, -2.0000000000000013, -2.600000000000002, -2.4000000000000017, -2.1000000000000014, -2.0000000000000013, -2.3000000000000016, -2.4000000000000017, -3.0000000000000018, -2.700000000000002, -3.200000000000001, -2.2000000000000015, -3.1000000000000014, -3.6999999999999993, -2.2000000000000015, -2.0000000000000013, -2.4000000000000017, -2.3000000000000016, -2.4000000000000017, -1.9000000000000012, -1.9000000000000012, -2.1000000000000014, -2.0000000000000013, -2.800000000000002, -2.600000000000002, -2.900000000000002, -2.2000000000000015, -2.600000000000002, -1.600000000000001, -2.800000000000002, -2.2000000000000015, -4.200000000000001, -1.600000000000001, -3.200000000000001], "episode_lengths": [39, 29, 34, 35, 54, 30, 36, 39, 37, 37, 35, 33, 34, 30, 42, 34, 34, 44, 41, 38, 48, 40, 41, 33, 28, 36, 38, 35, 40, 38, 47, 35, 39, 28, 27, 35, 36, 27, 30, 31, 31, 35, 44, 31, 38, 30, 32, 97, 40, 38, 39, 35, 41, 39, 34, 43, 31, 30, 36, 40, 35, 33, 39, 35, 33, 33, 27, 34, 32, 34, 32, 33, 33, 33, 30, 30, 28, 32, 31, 37, 35, 32, 31, 34, 35, 41, 38, 43, 33, 42, 48, 33, 31, 35, 34, 35, 30, 30, 32, 31, 39, 37, 40, 33, 37, 27, 39, 33, 45, 27, 43]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.29736050049315405, "mean_inference_ms": 0.733934912405491, "mean_action_processing_ms": 0.07687920763799216, "mean_env_wait_ms": 6.747575435296694, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0066589664768528295, "StateBufferConnector_ms": 0.003863025355983425, "ViewRequirementAgentConnector_ms": 0.09077518909901112}, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 132000, "num_agent_steps_trained": 132000, "num_env_steps_sampled": 132000, "num_env_steps_trained": 132000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 420.14266786483125, "num_env_steps_trained_throughput_per_sec": 420.14266786483125, "timesteps_total": 132000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 132000, "timers": {"training_iteration_time_ms": 9494.447, "sample_time_ms": 5696.564, "load_time_ms": 1.026, "load_throughput": 3898867.328, "learn_time_ms": 3791.733, "learn_throughput": 1054.927, "synch_weights_time_ms": 4.388}, "counters": {"num_env_steps_sampled": 132000, "num_env_steps_trained": 132000, "num_agent_steps_sampled": 132000, "num_agent_steps_trained": 132000}, "done": false, "episodes_total": 1649, "training_iteration": 33, "trial_id": "95ff9_00000", "date": "2024-03-07_12-37-01", "timestamp": 1709833021, "time_this_iter_s": 9.52357029914856, "time_total_s": 301.08212661743164, "pid": 108075, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4d85689f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 301.08212661743164, "iterations_since_restore": 33, "perf": {"cpu_util_percent": 29.116666666666664, "ram_util_percent": 47.50833333333333, "gpu_util_percent0": 0.09666666666666666, "vram_util_percent0": 0.1201171875}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 0.6698307348434033, "policy_loss": -0.006024220379530102, "vf_loss": 0.6741377944206839, "vf_explained_var": 0.6796717691806055, "kl": 0.008585798695438, "entropy": 0.4771063872562942, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 31155.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 136000, "num_env_steps_trained": 136000, "num_agent_steps_sampled": 136000, "num_agent_steps_trained": 136000}, "sampler_results": {"episode_reward_max": -1.5000000000000009, "episode_reward_min": -20.300000000000043, "episode_reward_mean": -2.6076190476190493, "episode_len_mean": 36.885714285714286, "episode_media": {}, "episodes_this_iter": 105, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1.9000000000000012, -2.4000000000000017, -2.2000000000000015, -2.800000000000002, -2.2000000000000015, -2.700000000000002, -2.3000000000000016, -3.1000000000000014, -1.9000000000000012, -3.1000000000000014, -3.5, -2.2000000000000015, -1.8000000000000012, -3.1000000000000014, -1.8000000000000012, -2.0000000000000013, -2.1000000000000014, -2.4000000000000017, -2.3000000000000016, -2.1000000000000014, -2.0000000000000013, -3.9999999999999982, -2.800000000000002, -2.600000000000002, -2.1000000000000014, -1.9000000000000012, -2.800000000000002, -2.1000000000000014, -2.1000000000000014, -2.4000000000000017, -2.700000000000002, -2.600000000000002, -1.8000000000000012, -2.3000000000000016, -1.9000000000000012, -4.399999999999998, -2.1000000000000014, -2.2000000000000015, -2.700000000000002, -1.9000000000000012, -2.0000000000000013, -3.0000000000000018, -2.800000000000002, -2.2000000000000015, -1.9000000000000012, -2.0000000000000013, -5.599999999999995, -2.4000000000000017, -2.800000000000002, -1.700000000000001, -1.9000000000000012, -2.600000000000002, -2.5000000000000018, -2.4000000000000017, -3.200000000000001, -2.4000000000000017, -1.9000000000000012, -1.700000000000001, -20.300000000000043, -2.0000000000000013, -2.900000000000002, -3.4000000000000004, -3.0000000000000018, -2.0000000000000013, -2.800000000000002, -1.9000000000000012, -1.600000000000001, -3.3000000000000007, -1.9000000000000012, -2.2000000000000015, -2.800000000000002, -3.6000000000000005, -2.2000000000000015, -3.3000000000000007, -1.9000000000000012, -2.3000000000000016, -4.799999999999995, -2.2000000000000015, -1.5000000000000009, -2.2000000000000015, -3.1000000000000014, -2.0000000000000013, -2.0000000000000013, -2.3000000000000016, -2.700000000000002, -2.700000000000002, -2.800000000000002, -2.2000000000000015, -2.1000000000000014, -2.3000000000000016, -3.4000000000000004, -1.600000000000001, -2.3000000000000016, -2.700000000000002, -1.600000000000001, -2.700000000000002, -1.600000000000001, -2.4000000000000017, -2.0000000000000013, -2.0000000000000013, -1.8000000000000012, -2.2000000000000015, -2.4000000000000017, -2.4000000000000017, -2.1000000000000014], "episode_lengths": [30, 35, 33, 39, 33, 38, 34, 42, 30, 42, 46, 33, 29, 42, 29, 31, 32, 35, 34, 32, 31, 51, 39, 37, 32, 30, 39, 32, 32, 35, 38, 37, 29, 34, 30, 54, 32, 33, 38, 30, 31, 41, 39, 33, 30, 31, 64, 35, 39, 28, 30, 37, 36, 35, 43, 35, 30, 28, 199, 31, 40, 45, 41, 31, 39, 30, 27, 44, 30, 33, 39, 46, 33, 44, 30, 34, 59, 33, 26, 33, 42, 31, 31, 34, 38, 38, 39, 33, 32, 34, 45, 27, 34, 38, 27, 38, 27, 35, 31, 31, 29, 33, 35, 35, 32]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.29991428229928524, "mean_inference_ms": 0.734033273040155, "mean_action_processing_ms": 0.0768402674747787, "mean_env_wait_ms": 6.766381531511562, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0066598256429036455, "StateBufferConnector_ms": 0.003886449904668899, "ViewRequirementAgentConnector_ms": 0.09106545221237909}}, "episode_reward_max": -1.5000000000000009, "episode_reward_min": -20.300000000000043, "episode_reward_mean": -2.6076190476190493, "episode_len_mean": 36.885714285714286, "episodes_this_iter": 105, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1.9000000000000012, -2.4000000000000017, -2.2000000000000015, -2.800000000000002, -2.2000000000000015, -2.700000000000002, -2.3000000000000016, -3.1000000000000014, -1.9000000000000012, -3.1000000000000014, -3.5, -2.2000000000000015, -1.8000000000000012, -3.1000000000000014, -1.8000000000000012, -2.0000000000000013, -2.1000000000000014, -2.4000000000000017, -2.3000000000000016, -2.1000000000000014, -2.0000000000000013, -3.9999999999999982, -2.800000000000002, -2.600000000000002, -2.1000000000000014, -1.9000000000000012, -2.800000000000002, -2.1000000000000014, -2.1000000000000014, -2.4000000000000017, -2.700000000000002, -2.600000000000002, -1.8000000000000012, -2.3000000000000016, -1.9000000000000012, -4.399999999999998, -2.1000000000000014, -2.2000000000000015, -2.700000000000002, -1.9000000000000012, -2.0000000000000013, -3.0000000000000018, -2.800000000000002, -2.2000000000000015, -1.9000000000000012, -2.0000000000000013, -5.599999999999995, -2.4000000000000017, -2.800000000000002, -1.700000000000001, -1.9000000000000012, -2.600000000000002, -2.5000000000000018, -2.4000000000000017, -3.200000000000001, -2.4000000000000017, -1.9000000000000012, -1.700000000000001, -20.300000000000043, -2.0000000000000013, -2.900000000000002, -3.4000000000000004, -3.0000000000000018, -2.0000000000000013, -2.800000000000002, -1.9000000000000012, -1.600000000000001, -3.3000000000000007, -1.9000000000000012, -2.2000000000000015, -2.800000000000002, -3.6000000000000005, -2.2000000000000015, -3.3000000000000007, -1.9000000000000012, -2.3000000000000016, -4.799999999999995, -2.2000000000000015, -1.5000000000000009, -2.2000000000000015, -3.1000000000000014, -2.0000000000000013, -2.0000000000000013, -2.3000000000000016, -2.700000000000002, -2.700000000000002, -2.800000000000002, -2.2000000000000015, -2.1000000000000014, -2.3000000000000016, -3.4000000000000004, -1.600000000000001, -2.3000000000000016, -2.700000000000002, -1.600000000000001, -2.700000000000002, -1.600000000000001, -2.4000000000000017, -2.0000000000000013, -2.0000000000000013, -1.8000000000000012, -2.2000000000000015, -2.4000000000000017, -2.4000000000000017, -2.1000000000000014], "episode_lengths": [30, 35, 33, 39, 33, 38, 34, 42, 30, 42, 46, 33, 29, 42, 29, 31, 32, 35, 34, 32, 31, 51, 39, 37, 32, 30, 39, 32, 32, 35, 38, 37, 29, 34, 30, 54, 32, 33, 38, 30, 31, 41, 39, 33, 30, 31, 64, 35, 39, 28, 30, 37, 36, 35, 43, 35, 30, 28, 199, 31, 40, 45, 41, 31, 39, 30, 27, 44, 30, 33, 39, 46, 33, 44, 30, 34, 59, 33, 26, 33, 42, 31, 31, 34, 38, 38, 39, 33, 32, 34, 45, 27, 34, 38, 27, 38, 27, 35, 31, 31, 29, 33, 35, 35, 32]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.29991428229928524, "mean_inference_ms": 0.734033273040155, "mean_action_processing_ms": 0.0768402674747787, "mean_env_wait_ms": 6.766381531511562, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0066598256429036455, "StateBufferConnector_ms": 0.003886449904668899, "ViewRequirementAgentConnector_ms": 0.09106545221237909}, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 136000, "num_agent_steps_trained": 136000, "num_env_steps_sampled": 136000, "num_env_steps_trained": 136000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 406.33562498153265, "num_env_steps_trained_throughput_per_sec": 406.33562498153265, "timesteps_total": 136000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 136000, "timers": {"training_iteration_time_ms": 9569.663, "sample_time_ms": 5737.341, "load_time_ms": 1.024, "load_throughput": 3907675.968, "learn_time_ms": 3826.13, "learn_throughput": 1045.443, "synch_weights_time_ms": 4.419}, "counters": {"num_env_steps_sampled": 136000, "num_env_steps_trained": 136000, "num_agent_steps_sampled": 136000, "num_agent_steps_trained": 136000}, "done": false, "episodes_total": 1754, "training_iteration": 34, "trial_id": "95ff9_00000", "date": "2024-03-07_12-37-11", "timestamp": 1709833031, "time_this_iter_s": 9.846907138824463, "time_total_s": 310.9290337562561, "pid": 108075, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4d85689f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 310.9290337562561, "iterations_since_restore": 34, "perf": {"cpu_util_percent": 27.969230769230766, "ram_util_percent": 47.47692307692308, "gpu_util_percent0": 0.12923076923076923, "vram_util_percent0": 0.12142553084935896}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 0.1755236109209833, "policy_loss": -0.009500934043398468, "vf_loss": 0.18368640405035788, "vf_explained_var": 0.8872452423136722, "kl": 0.006690704537280578, "entropy": 0.42496580228369724, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 32085.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 140000, "num_env_steps_trained": 140000, "num_agent_steps_sampled": 140000, "num_agent_steps_trained": 140000}, "sampler_results": {"episode_reward_max": -1.600000000000001, "episode_reward_min": -24.19999999999996, "episode_reward_mean": -2.6149122807017555, "episode_len_mean": 36.20175438596491, "episode_media": {}, "episodes_this_iter": 114, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2.900000000000002, -2.0000000000000013, -3.3000000000000007, -3.1000000000000014, -2.3000000000000016, -2.5000000000000018, -2.2000000000000015, -2.5000000000000018, -2.4000000000000017, -1.8000000000000012, -2.4000000000000017, -2.600000000000002, -2.5000000000000018, -2.800000000000002, -2.1000000000000014, -3.5, -2.0000000000000013, -2.4000000000000017, -2.3000000000000016, -2.1000000000000014, -2.1000000000000014, -2.900000000000002, -2.5000000000000018, -2.0000000000000013, -2.1000000000000014, -2.4000000000000017, -2.3000000000000016, -1.8000000000000012, -2.2000000000000015, -2.1000000000000014, -3.1000000000000014, -2.3000000000000016, -2.1000000000000014, -2.1000000000000014, -2.2000000000000015, -2.5000000000000018, -2.3000000000000016, -2.2000000000000015, -2.700000000000002, -24.19999999999996, -4.300000000000001, -3.0000000000000018, -2.700000000000002, -2.3000000000000016, -3.4000000000000004, -2.600000000000002, -2.3000000000000016, -2.4000000000000017, -1.9000000000000012, -2.600000000000002, -2.3000000000000016, -2.2000000000000015, -2.700000000000002, -2.0000000000000013, -2.900000000000002, -1.700000000000001, -3.8999999999999986, -2.900000000000002, -2.1000000000000014, -2.2000000000000015, -2.1000000000000014, -1.9000000000000012, -3.700000000000002, -1.600000000000001, -2.2000000000000015, -3.6999999999999993, -2.0000000000000013, -1.9000000000000012, -2.5000000000000018, -2.1000000000000014, -2.1000000000000014, -1.9000000000000012, -2.2000000000000015, -2.0000000000000013, -2.3000000000000016, -3.200000000000001, -3.0000000000000018, -2.800000000000002, -2.2000000000000015, -2.4000000000000017, -2.2000000000000015, -1.9000000000000012, -2.4000000000000017, -2.1000000000000014, -2.2000000000000015, -1.600000000000001, -2.0000000000000013, -1.700000000000001, -2.0000000000000013, -2.3000000000000016, -3.9000000000000012, -2.1000000000000014, -2.2000000000000015, -1.9000000000000012, -3.200000000000001, -2.0000000000000013, -3.4000000000000004, -1.9000000000000012, -2.5000000000000018, -3.0000000000000018, -2.0000000000000013, -2.0000000000000013, -2.1000000000000014, -2.3000000000000016, -2.4000000000000017, -2.900000000000002, -2.5000000000000018, -2.2000000000000015, -2.1000000000000014, -4.1999999999999975, -2.2000000000000015, -2.2000000000000015, -2.2000000000000015, -2.3000000000000016], "episode_lengths": [40, 31, 42, 42, 34, 36, 33, 36, 35, 29, 35, 37, 36, 39, 32, 46, 31, 35, 34, 32, 32, 40, 36, 31, 32, 35, 34, 29, 33, 32, 42, 34, 32, 32, 33, 36, 34, 33, 38, 166, 45, 41, 38, 34, 45, 37, 34, 35, 30, 37, 34, 33, 38, 31, 40, 28, 50, 40, 32, 33, 32, 30, 43, 27, 33, 48, 31, 30, 36, 32, 32, 30, 33, 31, 34, 43, 41, 39, 33, 35, 33, 30, 35, 32, 33, 27, 31, 28, 31, 34, 45, 32, 33, 30, 43, 31, 45, 30, 36, 41, 31, 31, 32, 34, 35, 40, 36, 33, 32, 53, 33, 33, 33, 34]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.30421238396466277, "mean_inference_ms": 0.7362917144424675, "mean_action_processing_ms": 0.07710280956097393, "mean_env_wait_ms": 6.797478681377761, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007421510261401795, "StateBufferConnector_ms": 0.0043024096572608275, "ViewRequirementAgentConnector_ms": 0.1003014413934005}}, "episode_reward_max": -1.600000000000001, "episode_reward_min": -24.19999999999996, "episode_reward_mean": -2.6149122807017555, "episode_len_mean": 36.20175438596491, "episodes_this_iter": 114, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-2.900000000000002, -2.0000000000000013, -3.3000000000000007, -3.1000000000000014, -2.3000000000000016, -2.5000000000000018, -2.2000000000000015, -2.5000000000000018, -2.4000000000000017, -1.8000000000000012, -2.4000000000000017, -2.600000000000002, -2.5000000000000018, -2.800000000000002, -2.1000000000000014, -3.5, -2.0000000000000013, -2.4000000000000017, -2.3000000000000016, -2.1000000000000014, -2.1000000000000014, -2.900000000000002, -2.5000000000000018, -2.0000000000000013, -2.1000000000000014, -2.4000000000000017, -2.3000000000000016, -1.8000000000000012, -2.2000000000000015, -2.1000000000000014, -3.1000000000000014, -2.3000000000000016, -2.1000000000000014, -2.1000000000000014, -2.2000000000000015, -2.5000000000000018, -2.3000000000000016, -2.2000000000000015, -2.700000000000002, -24.19999999999996, -4.300000000000001, -3.0000000000000018, -2.700000000000002, -2.3000000000000016, -3.4000000000000004, -2.600000000000002, -2.3000000000000016, -2.4000000000000017, -1.9000000000000012, -2.600000000000002, -2.3000000000000016, -2.2000000000000015, -2.700000000000002, -2.0000000000000013, -2.900000000000002, -1.700000000000001, -3.8999999999999986, -2.900000000000002, -2.1000000000000014, -2.2000000000000015, -2.1000000000000014, -1.9000000000000012, -3.700000000000002, -1.600000000000001, -2.2000000000000015, -3.6999999999999993, -2.0000000000000013, -1.9000000000000012, -2.5000000000000018, -2.1000000000000014, -2.1000000000000014, -1.9000000000000012, -2.2000000000000015, -2.0000000000000013, -2.3000000000000016, -3.200000000000001, -3.0000000000000018, -2.800000000000002, -2.2000000000000015, -2.4000000000000017, -2.2000000000000015, -1.9000000000000012, -2.4000000000000017, -2.1000000000000014, -2.2000000000000015, -1.600000000000001, -2.0000000000000013, -1.700000000000001, -2.0000000000000013, -2.3000000000000016, -3.9000000000000012, -2.1000000000000014, -2.2000000000000015, -1.9000000000000012, -3.200000000000001, -2.0000000000000013, -3.4000000000000004, -1.9000000000000012, -2.5000000000000018, -3.0000000000000018, -2.0000000000000013, -2.0000000000000013, -2.1000000000000014, -2.3000000000000016, -2.4000000000000017, -2.900000000000002, -2.5000000000000018, -2.2000000000000015, -2.1000000000000014, -4.1999999999999975, -2.2000000000000015, -2.2000000000000015, -2.2000000000000015, -2.3000000000000016], "episode_lengths": [40, 31, 42, 42, 34, 36, 33, 36, 35, 29, 35, 37, 36, 39, 32, 46, 31, 35, 34, 32, 32, 40, 36, 31, 32, 35, 34, 29, 33, 32, 42, 34, 32, 32, 33, 36, 34, 33, 38, 166, 45, 41, 38, 34, 45, 37, 34, 35, 30, 37, 34, 33, 38, 31, 40, 28, 50, 40, 32, 33, 32, 30, 43, 27, 33, 48, 31, 30, 36, 32, 32, 30, 33, 31, 34, 43, 41, 39, 33, 35, 33, 30, 35, 32, 33, 27, 31, 28, 31, 34, 45, 32, 33, 30, 43, 31, 45, 30, 36, 41, 31, 31, 32, 34, 35, 40, 36, 33, 32, 53, 33, 33, 33, 34]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.30421238396466277, "mean_inference_ms": 0.7362917144424675, "mean_action_processing_ms": 0.07710280956097393, "mean_env_wait_ms": 6.797478681377761, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007421510261401795, "StateBufferConnector_ms": 0.0043024096572608275, "ViewRequirementAgentConnector_ms": 0.1003014413934005}, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 140000, "num_agent_steps_trained": 140000, "num_env_steps_sampled": 140000, "num_env_steps_trained": 140000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 398.65343982140405, "num_env_steps_trained_throughput_per_sec": 398.65343982140405, "timesteps_total": 140000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 140000, "timers": {"training_iteration_time_ms": 9617.379, "sample_time_ms": 5809.692, "load_time_ms": 1.024, "load_throughput": 3907402.939, "learn_time_ms": 3801.501, "learn_throughput": 1052.216, "synch_weights_time_ms": 4.416}, "counters": {"num_env_steps_sampled": 140000, "num_env_steps_trained": 140000, "num_agent_steps_sampled": 140000, "num_agent_steps_trained": 140000}, "done": false, "episodes_total": 1868, "training_iteration": 35, "trial_id": "95ff9_00000", "date": "2024-03-07_12-37-21", "timestamp": 1709833041, "time_this_iter_s": 10.036911964416504, "time_total_s": 320.9659457206726, "pid": 108075, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4d85689f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 320.9659457206726, "iterations_since_restore": 35, "perf": {"cpu_util_percent": 33.50769230769231, "ram_util_percent": 48.06153846153847, "gpu_util_percent0": 0.11615384615384615, "vram_util_percent0": 0.12632086338141024}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 0.5978371807953007, "policy_loss": -0.0008553574883168743, "vf_loss": 0.5971362813135549, "vf_explained_var": 0.8287434391437039, "kl": 0.007781281601017938, "entropy": 0.4313442155879031, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 33015.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_agent_steps_sampled": 144000, "num_agent_steps_trained": 144000}, "sampler_results": {"episode_reward_max": -1.5000000000000009, "episode_reward_min": -36.50000000000005, "episode_reward_mean": -2.6008771929824577, "episode_len_mean": 35.719298245614034, "episode_media": {}, "episodes_this_iter": 114, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2.2000000000000015, -2.1000000000000014, -2.2000000000000015, -3.3000000000000007, -2.1000000000000014, -2.3000000000000016, -2.600000000000002, -2.5000000000000018, -2.4000000000000017, -2.2000000000000015, -2.2000000000000015, -2.1000000000000014, -2.800000000000002, -1.9000000000000012, -1.9000000000000012, -2.0000000000000013, -2.4000000000000017, -1.600000000000001, -3.6000000000000005, -1.700000000000001, -2.900000000000002, -2.2000000000000015, -1.8000000000000012, -1.9000000000000012, -1.5000000000000009, -2.600000000000002, -2.600000000000002, -2.5000000000000018, -2.600000000000002, -2.700000000000002, -2.0000000000000013, -2.3000000000000016, -3.200000000000001, -2.0000000000000013, -1.8000000000000012, -2.2000000000000015, -1.700000000000001, -1.9000000000000012, -1.8000000000000012, -2.1000000000000014, -2.800000000000002, -1.700000000000001, -2.700000000000002, -2.4000000000000017, -1.700000000000001, -2.0000000000000013, -2.5000000000000018, -2.5000000000000018, -3.1000000000000014, -3.0000000000000018, -1.9000000000000012, -2.3000000000000016, -1.9000000000000012, -2.700000000000002, -2.2000000000000015, -2.2000000000000015, -2.5000000000000018, -2.600000000000002, -2.0000000000000013, -2.5000000000000018, -2.3000000000000016, -2.1000000000000014, -2.800000000000002, -2.900000000000002, -2.2000000000000015, -2.0000000000000013, -2.2000000000000015, -1.700000000000001, -2.5000000000000018, -3.200000000000001, -1.8000000000000012, -1.700000000000001, -2.1000000000000014, -2.600000000000002, -2.4000000000000017, -2.3000000000000016, -2.1000000000000014, -1.9000000000000012, -2.5000000000000018, -2.5000000000000018, -1.9000000000000012, -1.8000000000000012, -2.2000000000000015, -2.800000000000002, -2.1000000000000014, -1.8000000000000012, -1.600000000000001, -2.5000000000000018, -1.8000000000000012, -2.3000000000000016, -2.2000000000000015, -2.600000000000002, -2.700000000000002, -2.4000000000000017, -1.5000000000000009, -2.0000000000000013, -1.9000000000000012, -5.999999999999995, -1.600000000000001, -2.0000000000000013, -2.2000000000000015, -2.2000000000000015, -1.8000000000000012, -2.700000000000002, -2.2000000000000015, -36.50000000000005, -2.700000000000002, -1.8000000000000012, -1.9000000000000012, -1.8000000000000012, -4.2, -3.200000000000001, -2.2000000000000015, -2.0000000000000013], "episode_lengths": [33, 32, 33, 44, 32, 34, 37, 36, 35, 33, 33, 32, 39, 30, 30, 31, 35, 27, 44, 28, 40, 33, 29, 30, 26, 37, 37, 36, 37, 38, 31, 34, 43, 31, 29, 33, 28, 30, 29, 32, 39, 28, 38, 35, 28, 31, 36, 36, 42, 41, 30, 34, 30, 38, 33, 33, 36, 37, 31, 36, 34, 32, 39, 40, 33, 31, 33, 28, 36, 43, 29, 28, 32, 37, 35, 34, 32, 30, 36, 36, 30, 29, 33, 39, 32, 29, 27, 36, 29, 34, 33, 37, 38, 35, 26, 31, 30, 67, 27, 31, 33, 33, 29, 38, 33, 241, 38, 29, 30, 29, 48, 43, 33, 31]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3075138578645332, "mean_inference_ms": 0.7365944040283845, "mean_action_processing_ms": 0.07716487694019547, "mean_env_wait_ms": 6.815966921076915, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006735324859619141, "StateBufferConnector_ms": 0.0039577484130859375, "ViewRequirementAgentConnector_ms": 0.09193734118812963}}, "episode_reward_max": -1.5000000000000009, "episode_reward_min": -36.50000000000005, "episode_reward_mean": -2.6008771929824577, "episode_len_mean": 35.719298245614034, "episodes_this_iter": 114, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-2.2000000000000015, -2.1000000000000014, -2.2000000000000015, -3.3000000000000007, -2.1000000000000014, -2.3000000000000016, -2.600000000000002, -2.5000000000000018, -2.4000000000000017, -2.2000000000000015, -2.2000000000000015, -2.1000000000000014, -2.800000000000002, -1.9000000000000012, -1.9000000000000012, -2.0000000000000013, -2.4000000000000017, -1.600000000000001, -3.6000000000000005, -1.700000000000001, -2.900000000000002, -2.2000000000000015, -1.8000000000000012, -1.9000000000000012, -1.5000000000000009, -2.600000000000002, -2.600000000000002, -2.5000000000000018, -2.600000000000002, -2.700000000000002, -2.0000000000000013, -2.3000000000000016, -3.200000000000001, -2.0000000000000013, -1.8000000000000012, -2.2000000000000015, -1.700000000000001, -1.9000000000000012, -1.8000000000000012, -2.1000000000000014, -2.800000000000002, -1.700000000000001, -2.700000000000002, -2.4000000000000017, -1.700000000000001, -2.0000000000000013, -2.5000000000000018, -2.5000000000000018, -3.1000000000000014, -3.0000000000000018, -1.9000000000000012, -2.3000000000000016, -1.9000000000000012, -2.700000000000002, -2.2000000000000015, -2.2000000000000015, -2.5000000000000018, -2.600000000000002, -2.0000000000000013, -2.5000000000000018, -2.3000000000000016, -2.1000000000000014, -2.800000000000002, -2.900000000000002, -2.2000000000000015, -2.0000000000000013, -2.2000000000000015, -1.700000000000001, -2.5000000000000018, -3.200000000000001, -1.8000000000000012, -1.700000000000001, -2.1000000000000014, -2.600000000000002, -2.4000000000000017, -2.3000000000000016, -2.1000000000000014, -1.9000000000000012, -2.5000000000000018, -2.5000000000000018, -1.9000000000000012, -1.8000000000000012, -2.2000000000000015, -2.800000000000002, -2.1000000000000014, -1.8000000000000012, -1.600000000000001, -2.5000000000000018, -1.8000000000000012, -2.3000000000000016, -2.2000000000000015, -2.600000000000002, -2.700000000000002, -2.4000000000000017, -1.5000000000000009, -2.0000000000000013, -1.9000000000000012, -5.999999999999995, -1.600000000000001, -2.0000000000000013, -2.2000000000000015, -2.2000000000000015, -1.8000000000000012, -2.700000000000002, -2.2000000000000015, -36.50000000000005, -2.700000000000002, -1.8000000000000012, -1.9000000000000012, -1.8000000000000012, -4.2, -3.200000000000001, -2.2000000000000015, -2.0000000000000013], "episode_lengths": [33, 32, 33, 44, 32, 34, 37, 36, 35, 33, 33, 32, 39, 30, 30, 31, 35, 27, 44, 28, 40, 33, 29, 30, 26, 37, 37, 36, 37, 38, 31, 34, 43, 31, 29, 33, 28, 30, 29, 32, 39, 28, 38, 35, 28, 31, 36, 36, 42, 41, 30, 34, 30, 38, 33, 33, 36, 37, 31, 36, 34, 32, 39, 40, 33, 31, 33, 28, 36, 43, 29, 28, 32, 37, 35, 34, 32, 30, 36, 36, 30, 29, 33, 39, 32, 29, 27, 36, 29, 34, 33, 37, 38, 35, 26, 31, 30, 67, 27, 31, 33, 33, 29, 38, 33, 241, 38, 29, 30, 29, 48, 43, 33, 31]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3075138578645332, "mean_inference_ms": 0.7365944040283845, "mean_action_processing_ms": 0.07716487694019547, "mean_env_wait_ms": 6.815966921076915, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006735324859619141, "StateBufferConnector_ms": 0.0039577484130859375, "ViewRequirementAgentConnector_ms": 0.09193734118812963}, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 144000, "num_agent_steps_trained": 144000, "num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 411.1288250943707, "num_env_steps_trained_throughput_per_sec": 411.1288250943707, "timesteps_total": 144000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 144000, "timers": {"training_iteration_time_ms": 9646.861, "sample_time_ms": 5837.596, "load_time_ms": 1.024, "load_throughput": 3908040.065, "learn_time_ms": 3804.26, "learn_throughput": 1051.453, "synch_weights_time_ms": 3.269}, "counters": {"num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_agent_steps_sampled": 144000, "num_agent_steps_trained": 144000}, "done": false, "episodes_total": 1982, "training_iteration": 36, "trial_id": "95ff9_00000", "date": "2024-03-07_12-37-31", "timestamp": 1709833051, "time_this_iter_s": 9.732402563095093, "time_total_s": 330.6983482837677, "pid": 108075, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4d85689f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 330.6983482837677, "iterations_since_restore": 36, "perf": {"cpu_util_percent": 29.276923076923076, "ram_util_percent": 47.64615384615385, "gpu_util_percent0": 0.10615384615384614, "vram_util_percent0": 0.12174479166666664}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 0.06968433949595658, "policy_loss": -0.021881991388496533, "vf_loss": 0.09024033074377365, "vf_explained_var": 0.9215058941354034, "kl": 0.006629995364507951, "entropy": 0.3912610018445599, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 33945.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 148000, "num_env_steps_trained": 148000, "num_agent_steps_sampled": 148000, "num_agent_steps_trained": 148000}, "sampler_results": {"episode_reward_max": -1.5000000000000009, "episode_reward_min": -3.8999999999999986, "episode_reward_mean": -2.2355932203389846, "episode_len_mean": 33.26271186440678, "episode_media": {}, "episodes_this_iter": 118, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2.900000000000002, -2.1000000000000014, -2.0000000000000013, -2.3000000000000016, -2.2000000000000015, -2.3000000000000016, -2.2000000000000015, -2.7000000000000015, -2.2000000000000015, -2.4000000000000017, -3.0000000000000018, -2.2000000000000015, -2.3000000000000016, -2.2000000000000015, -2.3000000000000016, -2.2000000000000015, -3.4000000000000004, -2.1000000000000014, -2.2000000000000015, -2.2000000000000015, -2.1000000000000014, -2.4000000000000017, -2.5000000000000018, -1.9000000000000012, -2.1000000000000014, -2.4000000000000017, -2.600000000000002, -2.4000000000000017, -1.600000000000001, -2.600000000000002, -2.0000000000000013, -1.5000000000000009, -1.9000000000000012, -1.8000000000000012, -2.0000000000000013, -2.4000000000000017, -1.8000000000000012, -3.5999999999999996, -3.1000000000000014, -2.4000000000000017, -1.9000000000000012, -2.1000000000000014, -1.9000000000000012, -2.4000000000000017, -2.3000000000000016, -2.1000000000000014, -1.600000000000001, -2.0000000000000013, -2.0000000000000013, -2.0000000000000013, -2.0000000000000013, -2.2000000000000015, -2.3000000000000016, -2.1000000000000014, -2.4000000000000017, -2.0000000000000013, -2.1000000000000014, -2.1000000000000014, -3.8999999999999986, -2.2000000000000015, -2.1000000000000014, -2.5000000000000018, -2.4000000000000017, -1.9000000000000012, -1.700000000000001, -2.700000000000002, -3.799999999999999, -1.5000000000000009, -2.2000000000000015, -2.4000000000000017, -1.9000000000000012, -2.1000000000000014, -1.9000000000000012, -1.700000000000001, -2.1000000000000014, -2.2000000000000015, -2.1000000000000014, -1.9000000000000012, -1.9000000000000012, -2.4000000000000017, -3.1000000000000014, -2.2000000000000015, -2.1000000000000014, -2.1000000000000014, -1.9000000000000012, -2.1000000000000014, -2.0000000000000013, -1.8000000000000012, -1.8000000000000012, -2.900000000000002, -2.1000000000000014, -2.2000000000000015, -2.2000000000000015, -2.2000000000000015, -2.3000000000000016, -2.0000000000000013, -2.1000000000000014, -1.700000000000001, -2.600000000000002, -2.3000000000000016, -2.0000000000000013, -1.8000000000000012, -2.3000000000000016, -2.0000000000000013, -2.4000000000000017, -2.600000000000002, -3.6000000000000014, -2.2000000000000015, -1.8000000000000012, -2.0000000000000013, -2.3000000000000016, -2.3000000000000016, -1.600000000000001, -2.5000000000000018, -2.1000000000000014, -2.5000000000000018, -2.5000000000000018, -2.1000000000000014], "episode_lengths": [40, 32, 31, 34, 33, 34, 33, 35, 33, 35, 41, 33, 34, 33, 34, 33, 45, 32, 33, 30, 32, 35, 36, 30, 32, 35, 37, 35, 27, 37, 31, 26, 30, 29, 31, 35, 29, 47, 42, 35, 30, 32, 30, 35, 34, 32, 27, 31, 31, 31, 31, 33, 31, 32, 35, 31, 32, 32, 50, 33, 32, 36, 35, 30, 28, 38, 49, 26, 33, 35, 30, 32, 30, 28, 32, 33, 32, 30, 30, 35, 42, 33, 32, 32, 30, 32, 31, 29, 29, 40, 32, 33, 33, 33, 34, 31, 32, 28, 37, 34, 31, 29, 34, 31, 35, 37, 45, 33, 29, 31, 34, 34, 27, 36, 32, 36, 36, 32]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3101079777425643, "mean_inference_ms": 0.7365383629490069, "mean_action_processing_ms": 0.07715258974876349, "mean_env_wait_ms": 6.836958074183376, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006565805208885064, "StateBufferConnector_ms": 0.0038674322225279727, "ViewRequirementAgentConnector_ms": 0.08957103147345075}}, "episode_reward_max": -1.5000000000000009, "episode_reward_min": -3.8999999999999986, "episode_reward_mean": -2.2355932203389846, "episode_len_mean": 33.26271186440678, "episodes_this_iter": 118, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-2.900000000000002, -2.1000000000000014, -2.0000000000000013, -2.3000000000000016, -2.2000000000000015, -2.3000000000000016, -2.2000000000000015, -2.7000000000000015, -2.2000000000000015, -2.4000000000000017, -3.0000000000000018, -2.2000000000000015, -2.3000000000000016, -2.2000000000000015, -2.3000000000000016, -2.2000000000000015, -3.4000000000000004, -2.1000000000000014, -2.2000000000000015, -2.2000000000000015, -2.1000000000000014, -2.4000000000000017, -2.5000000000000018, -1.9000000000000012, -2.1000000000000014, -2.4000000000000017, -2.600000000000002, -2.4000000000000017, -1.600000000000001, -2.600000000000002, -2.0000000000000013, -1.5000000000000009, -1.9000000000000012, -1.8000000000000012, -2.0000000000000013, -2.4000000000000017, -1.8000000000000012, -3.5999999999999996, -3.1000000000000014, -2.4000000000000017, -1.9000000000000012, -2.1000000000000014, -1.9000000000000012, -2.4000000000000017, -2.3000000000000016, -2.1000000000000014, -1.600000000000001, -2.0000000000000013, -2.0000000000000013, -2.0000000000000013, -2.0000000000000013, -2.2000000000000015, -2.3000000000000016, -2.1000000000000014, -2.4000000000000017, -2.0000000000000013, -2.1000000000000014, -2.1000000000000014, -3.8999999999999986, -2.2000000000000015, -2.1000000000000014, -2.5000000000000018, -2.4000000000000017, -1.9000000000000012, -1.700000000000001, -2.700000000000002, -3.799999999999999, -1.5000000000000009, -2.2000000000000015, -2.4000000000000017, -1.9000000000000012, -2.1000000000000014, -1.9000000000000012, -1.700000000000001, -2.1000000000000014, -2.2000000000000015, -2.1000000000000014, -1.9000000000000012, -1.9000000000000012, -2.4000000000000017, -3.1000000000000014, -2.2000000000000015, -2.1000000000000014, -2.1000000000000014, -1.9000000000000012, -2.1000000000000014, -2.0000000000000013, -1.8000000000000012, -1.8000000000000012, -2.900000000000002, -2.1000000000000014, -2.2000000000000015, -2.2000000000000015, -2.2000000000000015, -2.3000000000000016, -2.0000000000000013, -2.1000000000000014, -1.700000000000001, -2.600000000000002, -2.3000000000000016, -2.0000000000000013, -1.8000000000000012, -2.3000000000000016, -2.0000000000000013, -2.4000000000000017, -2.600000000000002, -3.6000000000000014, -2.2000000000000015, -1.8000000000000012, -2.0000000000000013, -2.3000000000000016, -2.3000000000000016, -1.600000000000001, -2.5000000000000018, -2.1000000000000014, -2.5000000000000018, -2.5000000000000018, -2.1000000000000014], "episode_lengths": [40, 32, 31, 34, 33, 34, 33, 35, 33, 35, 41, 33, 34, 33, 34, 33, 45, 32, 33, 30, 32, 35, 36, 30, 32, 35, 37, 35, 27, 37, 31, 26, 30, 29, 31, 35, 29, 47, 42, 35, 30, 32, 30, 35, 34, 32, 27, 31, 31, 31, 31, 33, 31, 32, 35, 31, 32, 32, 50, 33, 32, 36, 35, 30, 28, 38, 49, 26, 33, 35, 30, 32, 30, 28, 32, 33, 32, 30, 30, 35, 42, 33, 32, 32, 30, 32, 31, 29, 29, 40, 32, 33, 33, 33, 34, 31, 32, 28, 37, 34, 31, 29, 34, 31, 35, 37, 45, 33, 29, 31, 34, 34, 27, 36, 32, 36, 36, 32]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3101079777425643, "mean_inference_ms": 0.7365383629490069, "mean_action_processing_ms": 0.07715258974876349, "mean_env_wait_ms": 6.836958074183376, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006565805208885064, "StateBufferConnector_ms": 0.0038674322225279727, "ViewRequirementAgentConnector_ms": 0.08957103147345075}, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 148000, "num_agent_steps_trained": 148000, "num_env_steps_sampled": 148000, "num_env_steps_trained": 148000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 409.7955332984078, "num_env_steps_trained_throughput_per_sec": 409.7955332984078, "timesteps_total": 148000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 148000, "timers": {"training_iteration_time_ms": 9677.755, "sample_time_ms": 5871.669, "load_time_ms": 1.022, "load_throughput": 3914148.8, "learn_time_ms": 3801.093, "learn_throughput": 1052.329, "synch_weights_time_ms": 3.262}, "counters": {"num_env_steps_sampled": 148000, "num_env_steps_trained": 148000, "num_agent_steps_sampled": 148000, "num_agent_steps_trained": 148000}, "done": false, "episodes_total": 2100, "training_iteration": 37, "trial_id": "95ff9_00000", "date": "2024-03-07_12-37-40", "timestamp": 1709833060, "time_this_iter_s": 9.763702630996704, "time_total_s": 340.4620509147644, "pid": 108075, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4d85689f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 340.4620509147644, "iterations_since_restore": 37, "perf": {"cpu_util_percent": 29.13333333333333, "ram_util_percent": 47.5, "gpu_util_percent0": 0.09499999999999999, "vram_util_percent0": 0.12117513020833331}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 0.13667051150683834, "policy_loss": -0.008781674072667155, "vf_loss": 0.14431483813972082, "vf_explained_var": 0.8966763365653253, "kl": 0.005686736194874788, "entropy": 0.36338326799613174, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 34875.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 152000, "num_env_steps_trained": 152000, "num_agent_steps_sampled": 152000, "num_agent_steps_trained": 152000}, "sampler_results": {"episode_reward_max": -1.600000000000001, "episode_reward_min": -4.799999999999997, "episode_reward_mean": -2.2225000000000015, "episode_len_mean": 33.175, "episode_media": {}, "episodes_this_iter": 120, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2.2000000000000015, -2.900000000000002, -2.4000000000000017, -1.9000000000000012, -2.1000000000000014, -2.0000000000000013, -2.3000000000000016, -1.9000000000000012, -2.3000000000000016, -2.2000000000000015, -1.600000000000001, -1.700000000000001, -3.400000000000002, -1.700000000000001, -1.9000000000000012, -1.600000000000001, -2.2000000000000015, -1.700000000000001, -1.9000000000000012, -2.4000000000000017, -2.0000000000000013, -2.4000000000000017, -2.2000000000000015, -1.700000000000001, -1.600000000000001, -2.4000000000000017, -2.0000000000000013, -1.9000000000000012, -2.4000000000000017, -4.799999999999997, -2.2000000000000015, -2.5000000000000018, -2.0000000000000013, -2.0000000000000013, -2.5000000000000018, -2.5000000000000018, -2.2000000000000015, -1.8000000000000012, -2.2000000000000015, -2.3000000000000016, -1.9000000000000012, -3.1000000000000014, -2.0000000000000013, -2.5000000000000018, -2.600000000000002, -2.1000000000000014, -1.8000000000000012, -1.700000000000001, -2.2000000000000015, -2.0000000000000013, -2.0000000000000013, -2.600000000000002, -1.9000000000000012, -2.1000000000000014, -2.3000000000000016, -1.700000000000001, -1.8000000000000012, -2.1000000000000014, -2.800000000000002, -2.700000000000002, -2.2000000000000015, -1.8000000000000012, -1.600000000000001, -2.0000000000000013, -2.1000000000000014, -2.0000000000000013, -2.5000000000000018, -2.0000000000000013, -2.600000000000002, -2.1000000000000014, -2.1000000000000014, -2.2000000000000015, -2.2000000000000015, -2.4000000000000017, -2.0000000000000013, -2.1000000000000014, -1.8000000000000012, -2.1000000000000014, -1.700000000000001, -3.0000000000000018, -2.2000000000000015, -2.2000000000000015, -1.8000000000000012, -1.700000000000001, -2.2000000000000015, -2.1000000000000014, -3.0000000000000018, -2.1000000000000014, -1.9000000000000012, -3.0000000000000018, -2.600000000000002, -1.700000000000001, -3.799999999999999, -2.1000000000000014, -2.4000000000000017, -2.0000000000000013, -3.200000000000001, -2.700000000000002, -2.1000000000000014, -2.2000000000000015, -2.600000000000002, -1.700000000000001, -2.1000000000000014, -2.1000000000000014, -3.0000000000000018, -1.8000000000000012, -2.800000000000002, -1.8000000000000012, -2.3000000000000016, -1.8000000000000012, -2.4000000000000017, -2.4000000000000017, -2.3000000000000016, -1.8000000000000012, -2.900000000000002, -1.600000000000001, -2.5000000000000018, -3.799999999999999, -1.8000000000000012, -1.9000000000000012], "episode_lengths": [33, 40, 35, 30, 32, 31, 34, 30, 34, 33, 27, 28, 41, 28, 30, 27, 33, 28, 30, 35, 31, 35, 33, 28, 27, 35, 31, 30, 35, 57, 33, 36, 31, 31, 36, 36, 33, 29, 33, 34, 30, 42, 31, 36, 37, 32, 29, 28, 33, 31, 31, 37, 30, 32, 34, 28, 29, 32, 39, 38, 33, 29, 27, 31, 32, 31, 36, 31, 37, 32, 32, 33, 33, 35, 31, 32, 29, 32, 28, 41, 33, 33, 29, 28, 33, 32, 41, 32, 30, 41, 37, 28, 49, 32, 35, 31, 43, 38, 32, 33, 37, 28, 32, 32, 41, 29, 39, 29, 34, 29, 35, 35, 34, 29, 40, 27, 36, 49, 29, 30]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.31286655216507847, "mean_inference_ms": 0.7369003036936351, "mean_action_processing_ms": 0.07717709103105577, "mean_env_wait_ms": 6.858735060569981, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006734530131022136, "StateBufferConnector_ms": 0.00397642453511556, "ViewRequirementAgentConnector_ms": 0.09259700775146484}}, "episode_reward_max": -1.600000000000001, "episode_reward_min": -4.799999999999997, "episode_reward_mean": -2.2225000000000015, "episode_len_mean": 33.175, "episodes_this_iter": 120, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-2.2000000000000015, -2.900000000000002, -2.4000000000000017, -1.9000000000000012, -2.1000000000000014, -2.0000000000000013, -2.3000000000000016, -1.9000000000000012, -2.3000000000000016, -2.2000000000000015, -1.600000000000001, -1.700000000000001, -3.400000000000002, -1.700000000000001, -1.9000000000000012, -1.600000000000001, -2.2000000000000015, -1.700000000000001, -1.9000000000000012, -2.4000000000000017, -2.0000000000000013, -2.4000000000000017, -2.2000000000000015, -1.700000000000001, -1.600000000000001, -2.4000000000000017, -2.0000000000000013, -1.9000000000000012, -2.4000000000000017, -4.799999999999997, -2.2000000000000015, -2.5000000000000018, -2.0000000000000013, -2.0000000000000013, -2.5000000000000018, -2.5000000000000018, -2.2000000000000015, -1.8000000000000012, -2.2000000000000015, -2.3000000000000016, -1.9000000000000012, -3.1000000000000014, -2.0000000000000013, -2.5000000000000018, -2.600000000000002, -2.1000000000000014, -1.8000000000000012, -1.700000000000001, -2.2000000000000015, -2.0000000000000013, -2.0000000000000013, -2.600000000000002, -1.9000000000000012, -2.1000000000000014, -2.3000000000000016, -1.700000000000001, -1.8000000000000012, -2.1000000000000014, -2.800000000000002, -2.700000000000002, -2.2000000000000015, -1.8000000000000012, -1.600000000000001, -2.0000000000000013, -2.1000000000000014, -2.0000000000000013, -2.5000000000000018, -2.0000000000000013, -2.600000000000002, -2.1000000000000014, -2.1000000000000014, -2.2000000000000015, -2.2000000000000015, -2.4000000000000017, -2.0000000000000013, -2.1000000000000014, -1.8000000000000012, -2.1000000000000014, -1.700000000000001, -3.0000000000000018, -2.2000000000000015, -2.2000000000000015, -1.8000000000000012, -1.700000000000001, -2.2000000000000015, -2.1000000000000014, -3.0000000000000018, -2.1000000000000014, -1.9000000000000012, -3.0000000000000018, -2.600000000000002, -1.700000000000001, -3.799999999999999, -2.1000000000000014, -2.4000000000000017, -2.0000000000000013, -3.200000000000001, -2.700000000000002, -2.1000000000000014, -2.2000000000000015, -2.600000000000002, -1.700000000000001, -2.1000000000000014, -2.1000000000000014, -3.0000000000000018, -1.8000000000000012, -2.800000000000002, -1.8000000000000012, -2.3000000000000016, -1.8000000000000012, -2.4000000000000017, -2.4000000000000017, -2.3000000000000016, -1.8000000000000012, -2.900000000000002, -1.600000000000001, -2.5000000000000018, -3.799999999999999, -1.8000000000000012, -1.9000000000000012], "episode_lengths": [33, 40, 35, 30, 32, 31, 34, 30, 34, 33, 27, 28, 41, 28, 30, 27, 33, 28, 30, 35, 31, 35, 33, 28, 27, 35, 31, 30, 35, 57, 33, 36, 31, 31, 36, 36, 33, 29, 33, 34, 30, 42, 31, 36, 37, 32, 29, 28, 33, 31, 31, 37, 30, 32, 34, 28, 29, 32, 39, 38, 33, 29, 27, 31, 32, 31, 36, 31, 37, 32, 32, 33, 33, 35, 31, 32, 29, 32, 28, 41, 33, 33, 29, 28, 33, 32, 41, 32, 30, 41, 37, 28, 49, 32, 35, 31, 43, 38, 32, 33, 37, 28, 32, 32, 41, 29, 39, 29, 34, 29, 35, 35, 34, 29, 40, 27, 36, 49, 29, 30]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.31286655216507847, "mean_inference_ms": 0.7369003036936351, "mean_action_processing_ms": 0.07717709103105577, "mean_env_wait_ms": 6.858735060569981, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006734530131022136, "StateBufferConnector_ms": 0.00397642453511556, "ViewRequirementAgentConnector_ms": 0.09259700775146484}, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 152000, "num_agent_steps_trained": 152000, "num_env_steps_sampled": 152000, "num_env_steps_trained": 152000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 396.0043844346057, "num_env_steps_trained_throughput_per_sec": 396.0043844346057, "timesteps_total": 152000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 152000, "timers": {"training_iteration_time_ms": 9757.21, "sample_time_ms": 5928.395, "load_time_ms": 1.027, "load_throughput": 3896512.994, "learn_time_ms": 3822.513, "learn_throughput": 1046.432, "synch_weights_time_ms": 4.539}, "counters": {"num_env_steps_sampled": 152000, "num_env_steps_trained": 152000, "num_agent_steps_sampled": 152000, "num_agent_steps_trained": 152000}, "done": false, "episodes_total": 2220, "training_iteration": 38, "trial_id": "95ff9_00000", "date": "2024-03-07_12-37-50", "timestamp": 1709833070, "time_this_iter_s": 10.105474472045898, "time_total_s": 350.5675253868103, "pid": 108075, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4d85689f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 350.5675253868103, "iterations_since_restore": 38, "perf": {"cpu_util_percent": 28.342857142857138, "ram_util_percent": 47.521428571428565, "gpu_util_percent0": 0.10999999999999999, "vram_util_percent0": 0.12130882626488095}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 0.21801661859023616, "policy_loss": -0.005187158274053726, "vf_loss": 0.22127191521758113, "vf_explained_var": 0.885428104157089, "kl": 0.009659301214822402, "entropy": 0.35545135813374673, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 35805.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 156000, "num_env_steps_trained": 156000, "num_agent_steps_sampled": 156000, "num_agent_steps_trained": 156000}, "sampler_results": {"episode_reward_max": -1.4000000000000008, "episode_reward_min": -7.2999999999999865, "episode_reward_mean": -2.1349206349206358, "episode_len_mean": 32.25396825396825, "episode_media": {}, "episodes_this_iter": 126, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2.2000000000000015, -2.0000000000000013, -1.9000000000000012, -3.0000000000000018, -2.4000000000000017, -7.2999999999999865, -2.2000000000000015, -1.8000000000000012, -2.700000000000002, -1.600000000000001, -2.0000000000000013, -1.600000000000001, -2.800000000000002, -2.1000000000000014, -1.9000000000000012, -1.5000000000000009, -2.0000000000000013, -2.600000000000002, -2.4000000000000017, -1.9000000000000012, -3.200000000000001, -1.9000000000000012, -1.9000000000000012, -1.9000000000000012, -2.0000000000000013, -1.9000000000000012, -2.1000000000000014, -3.4000000000000004, -1.700000000000001, -2.1000000000000014, -2.900000000000002, -1.600000000000001, -1.9000000000000012, -2.4000000000000017, -2.1000000000000014, -2.0000000000000013, -1.9000000000000012, -1.8000000000000012, -1.700000000000001, -1.9000000000000012, -2.0000000000000013, -1.8000000000000012, -2.0000000000000013, -2.2000000000000015, -1.700000000000001, -3.1000000000000014, -2.2000000000000015, -1.700000000000001, -2.0000000000000013, -2.4000000000000017, -2.2000000000000015, -1.5000000000000009, -1.5000000000000009, -1.8000000000000012, -1.4000000000000008, -1.5000000000000009, -1.8000000000000012, -2.0000000000000013, -1.8000000000000012, -2.0000000000000013, -1.700000000000001, -2.1000000000000014, -3.5999999999999996, -2.700000000000002, -1.4000000000000008, -2.0000000000000013, -2.0000000000000013, -1.9000000000000012, -2.1000000000000014, -2.0000000000000013, -3.0000000000000018, -2.1000000000000014, -1.9000000000000012, -1.9000000000000012, -1.9000000000000012, -1.700000000000001, -2.700000000000002, -2.2000000000000015, -2.700000000000002, -1.9000000000000012, -1.600000000000001, -2.800000000000002, -2.800000000000002, -2.2000000000000015, -1.8000000000000012, -2.2000000000000015, -1.9000000000000012, -2.3000000000000016, -1.8000000000000012, -1.600000000000001, -1.700000000000001, -1.600000000000001, -1.600000000000001, -1.8000000000000012, -2.700000000000002, -3.6999999999999993, -2.0000000000000013, -2.4000000000000017, -2.0000000000000013, -1.9000000000000012, -2.3000000000000016, -1.8000000000000012, -2.1000000000000014, -4.100000000000001, -1.8000000000000012, -1.9000000000000012, -2.4000000000000017, -1.8000000000000012, -2.3000000000000016, -2.800000000000002, -1.600000000000001, -1.700000000000001, -1.8000000000000012, -2.2000000000000015, -2.1000000000000014, -1.8000000000000012, -1.9000000000000012, -1.700000000000001, -1.700000000000001, -2.0000000000000013, -1.8000000000000012, -2.5000000000000018, -1.8000000000000012, -2.0000000000000013, -2.5000000000000018, -1.9000000000000012], "episode_lengths": [33, 31, 30, 41, 35, 84, 33, 29, 38, 27, 31, 27, 39, 32, 30, 26, 31, 37, 35, 30, 37, 30, 30, 30, 31, 30, 32, 43, 28, 32, 40, 27, 30, 35, 32, 31, 30, 29, 28, 30, 31, 29, 31, 33, 28, 42, 33, 28, 31, 35, 33, 26, 26, 29, 25, 26, 29, 31, 29, 31, 28, 32, 47, 38, 25, 31, 31, 30, 32, 31, 41, 32, 30, 30, 30, 28, 38, 33, 38, 30, 27, 39, 39, 33, 29, 33, 30, 34, 29, 27, 28, 27, 27, 29, 38, 48, 31, 35, 31, 30, 34, 29, 32, 48, 29, 30, 35, 29, 34, 39, 27, 28, 29, 33, 32, 29, 30, 28, 28, 31, 29, 36, 29, 31, 36, 30]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3161605528492704, "mean_inference_ms": 0.7374788583363533, "mean_action_processing_ms": 0.07724577940526227, "mean_env_wait_ms": 6.882407009376514, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006908462161109561, "StateBufferConnector_ms": 0.004087175641741071, "ViewRequirementAgentConnector_ms": 0.09424913497198195}}, "episode_reward_max": -1.4000000000000008, "episode_reward_min": -7.2999999999999865, "episode_reward_mean": -2.1349206349206358, "episode_len_mean": 32.25396825396825, "episodes_this_iter": 126, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-2.2000000000000015, -2.0000000000000013, -1.9000000000000012, -3.0000000000000018, -2.4000000000000017, -7.2999999999999865, -2.2000000000000015, -1.8000000000000012, -2.700000000000002, -1.600000000000001, -2.0000000000000013, -1.600000000000001, -2.800000000000002, -2.1000000000000014, -1.9000000000000012, -1.5000000000000009, -2.0000000000000013, -2.600000000000002, -2.4000000000000017, -1.9000000000000012, -3.200000000000001, -1.9000000000000012, -1.9000000000000012, -1.9000000000000012, -2.0000000000000013, -1.9000000000000012, -2.1000000000000014, -3.4000000000000004, -1.700000000000001, -2.1000000000000014, -2.900000000000002, -1.600000000000001, -1.9000000000000012, -2.4000000000000017, -2.1000000000000014, -2.0000000000000013, -1.9000000000000012, -1.8000000000000012, -1.700000000000001, -1.9000000000000012, -2.0000000000000013, -1.8000000000000012, -2.0000000000000013, -2.2000000000000015, -1.700000000000001, -3.1000000000000014, -2.2000000000000015, -1.700000000000001, -2.0000000000000013, -2.4000000000000017, -2.2000000000000015, -1.5000000000000009, -1.5000000000000009, -1.8000000000000012, -1.4000000000000008, -1.5000000000000009, -1.8000000000000012, -2.0000000000000013, -1.8000000000000012, -2.0000000000000013, -1.700000000000001, -2.1000000000000014, -3.5999999999999996, -2.700000000000002, -1.4000000000000008, -2.0000000000000013, -2.0000000000000013, -1.9000000000000012, -2.1000000000000014, -2.0000000000000013, -3.0000000000000018, -2.1000000000000014, -1.9000000000000012, -1.9000000000000012, -1.9000000000000012, -1.700000000000001, -2.700000000000002, -2.2000000000000015, -2.700000000000002, -1.9000000000000012, -1.600000000000001, -2.800000000000002, -2.800000000000002, -2.2000000000000015, -1.8000000000000012, -2.2000000000000015, -1.9000000000000012, -2.3000000000000016, -1.8000000000000012, -1.600000000000001, -1.700000000000001, -1.600000000000001, -1.600000000000001, -1.8000000000000012, -2.700000000000002, -3.6999999999999993, -2.0000000000000013, -2.4000000000000017, -2.0000000000000013, -1.9000000000000012, -2.3000000000000016, -1.8000000000000012, -2.1000000000000014, -4.100000000000001, -1.8000000000000012, -1.9000000000000012, -2.4000000000000017, -1.8000000000000012, -2.3000000000000016, -2.800000000000002, -1.600000000000001, -1.700000000000001, -1.8000000000000012, -2.2000000000000015, -2.1000000000000014, -1.8000000000000012, -1.9000000000000012, -1.700000000000001, -1.700000000000001, -2.0000000000000013, -1.8000000000000012, -2.5000000000000018, -1.8000000000000012, -2.0000000000000013, -2.5000000000000018, -1.9000000000000012], "episode_lengths": [33, 31, 30, 41, 35, 84, 33, 29, 38, 27, 31, 27, 39, 32, 30, 26, 31, 37, 35, 30, 37, 30, 30, 30, 31, 30, 32, 43, 28, 32, 40, 27, 30, 35, 32, 31, 30, 29, 28, 30, 31, 29, 31, 33, 28, 42, 33, 28, 31, 35, 33, 26, 26, 29, 25, 26, 29, 31, 29, 31, 28, 32, 47, 38, 25, 31, 31, 30, 32, 31, 41, 32, 30, 30, 30, 28, 38, 33, 38, 30, 27, 39, 39, 33, 29, 33, 30, 34, 29, 27, 28, 27, 27, 29, 38, 48, 31, 35, 31, 30, 34, 29, 32, 48, 29, 30, 35, 29, 34, 39, 27, 28, 29, 33, 32, 29, 30, 28, 28, 31, 29, 36, 29, 31, 36, 30]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3161605528492704, "mean_inference_ms": 0.7374788583363533, "mean_action_processing_ms": 0.07724577940526227, "mean_env_wait_ms": 6.882407009376514, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006908462161109561, "StateBufferConnector_ms": 0.004087175641741071, "ViewRequirementAgentConnector_ms": 0.09424913497198195}, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 156000, "num_agent_steps_trained": 156000, "num_env_steps_sampled": 156000, "num_env_steps_trained": 156000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 413.7359453166345, "num_env_steps_trained_throughput_per_sec": 413.7359453166345, "timesteps_total": 156000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 156000, "timers": {"training_iteration_time_ms": 9783.725, "sample_time_ms": 5975.406, "load_time_ms": 2.121, "load_throughput": 1885928.058, "learn_time_ms": 3800.916, "learn_throughput": 1052.378, "synch_weights_time_ms": 4.538}, "counters": {"num_env_steps_sampled": 156000, "num_env_steps_trained": 156000, "num_agent_steps_sampled": 156000, "num_agent_steps_trained": 156000}, "done": false, "episodes_total": 2346, "training_iteration": 39, "trial_id": "95ff9_00000", "date": "2024-03-07_12-38-00", "timestamp": 1709833080, "time_this_iter_s": 9.670869827270508, "time_total_s": 360.2383952140808, "pid": 108075, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4d85689f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 360.2383952140808, "iterations_since_restore": 39, "perf": {"cpu_util_percent": 31.183333333333326, "ram_util_percent": 47.86666666666667, "gpu_util_percent0": 0.13083333333333333, "vram_util_percent0": 0.12913682725694445}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 0.053855381983830546, "policy_loss": -0.013676203559002568, "vf_loss": 0.06632107456304855, "vf_explained_var": 0.9419980772720871, "kl": 0.0060525543329505325, "entropy": 0.3232049579421679, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 36735.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 160000, "num_env_steps_trained": 160000, "num_agent_steps_sampled": 160000, "num_agent_steps_trained": 160000}, "sampler_results": {"episode_reward_max": -1.4000000000000008, "episode_reward_min": -3.9999999999999982, "episode_reward_mean": -2.0062015503875985, "episode_len_mean": 30.984496124031008, "episode_media": {}, "episodes_this_iter": 129, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2.2000000000000015, -1.9000000000000012, -2.2000000000000015, -1.700000000000001, -1.700000000000001, -1.4000000000000008, -1.5000000000000009, -1.700000000000001, -3.9999999999999982, -2.0000000000000013, -1.8000000000000012, -1.5000000000000009, -2.0000000000000013, -2.1000000000000014, -1.700000000000001, -1.8000000000000012, -2.4000000000000017, -1.600000000000001, -2.700000000000002, -2.700000000000002, -2.600000000000002, -2.2000000000000015, -2.0000000000000013, -2.3000000000000016, -1.9000000000000012, -1.5000000000000009, -1.600000000000001, -2.5000000000000018, -2.4000000000000017, -2.1000000000000014, -1.9000000000000012, -2.1000000000000014, -2.0000000000000013, -2.3000000000000016, -1.5000000000000009, -2.2000000000000015, -2.2000000000000015, -2.600000000000002, -2.5000000000000018, -2.0000000000000013, -2.3000000000000016, -1.5000000000000009, -1.9000000000000012, -1.9000000000000012, -1.700000000000001, -2.0000000000000013, -1.600000000000001, -2.2000000000000015, -1.700000000000001, -1.5000000000000009, -1.8000000000000012, -2.2000000000000015, -2.1000000000000014, -2.0000000000000013, -1.9000000000000012, -1.600000000000001, -2.1000000000000014, -1.8000000000000012, -1.600000000000001, -1.5000000000000009, -1.8000000000000012, -1.700000000000001, -1.9000000000000012, -2.3000000000000016, -1.9000000000000012, -2.0000000000000013, -1.600000000000001, -1.8000000000000012, -2.0000000000000013, -1.5000000000000009, -1.9000000000000012, -2.1000000000000014, -2.0000000000000013, -2.0000000000000013, -1.600000000000001, -2.3000000000000016, -1.9000000000000012, -2.1000000000000014, -2.0000000000000013, -1.9000000000000012, -1.5000000000000009, -1.5000000000000009, -1.9000000000000012, -1.700000000000001, -1.700000000000001, -3.0000000000000018, -2.1000000000000014, -2.3000000000000016, -2.4000000000000017, -1.8000000000000012, -2.2000000000000015, -2.1000000000000014, -2.0000000000000013, -2.4000000000000017, -1.8000000000000012, -1.9000000000000012, -2.700000000000002, -2.1000000000000014, -1.600000000000001, -2.1000000000000014, -1.9000000000000012, -1.5000000000000009, -1.700000000000001, -2.2000000000000015, -1.8000000000000012, -2.2000000000000015, -1.9000000000000012, -2.2000000000000015, -2.5000000000000018, -2.5000000000000018, -1.9000000000000012, -1.600000000000001, -1.700000000000001, -2.0000000000000013, -2.3000000000000016, -1.700000000000001, -2.5000000000000018, -2.4000000000000017, -1.8000000000000012, -2.3000000000000016, -2.1000000000000014, -1.4000000000000008, -2.1000000000000014, -2.600000000000002, -2.1000000000000014, -2.1000000000000014, -1.9000000000000012, -2.5000000000000018, -2.4000000000000017], "episode_lengths": [33, 30, 33, 28, 28, 25, 26, 28, 45, 28, 29, 26, 31, 32, 28, 29, 35, 27, 38, 38, 37, 33, 31, 34, 30, 26, 27, 35, 35, 32, 30, 32, 31, 34, 26, 33, 33, 37, 36, 31, 34, 26, 30, 30, 28, 31, 27, 33, 28, 26, 29, 33, 32, 31, 30, 27, 32, 29, 27, 26, 29, 28, 30, 34, 30, 31, 27, 29, 31, 26, 30, 32, 31, 31, 27, 34, 30, 32, 31, 30, 26, 26, 30, 28, 28, 41, 32, 34, 35, 29, 33, 32, 31, 35, 29, 30, 38, 32, 27, 32, 30, 26, 28, 33, 29, 33, 30, 33, 36, 36, 30, 27, 28, 31, 34, 28, 36, 35, 29, 34, 32, 25, 32, 37, 32, 32, 30, 36, 35]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.31954090593774226, "mean_inference_ms": 0.7384289986534274, "mean_action_processing_ms": 0.07733736960245245, "mean_env_wait_ms": 6.906355340190176, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007006364275318707, "StateBufferConnector_ms": 0.004103202228398286, "ViewRequirementAgentConnector_ms": 0.09551399437956108}}, "episode_reward_max": -1.4000000000000008, "episode_reward_min": -3.9999999999999982, "episode_reward_mean": -2.0062015503875985, "episode_len_mean": 30.984496124031008, "episodes_this_iter": 129, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-2.2000000000000015, -1.9000000000000012, -2.2000000000000015, -1.700000000000001, -1.700000000000001, -1.4000000000000008, -1.5000000000000009, -1.700000000000001, -3.9999999999999982, -2.0000000000000013, -1.8000000000000012, -1.5000000000000009, -2.0000000000000013, -2.1000000000000014, -1.700000000000001, -1.8000000000000012, -2.4000000000000017, -1.600000000000001, -2.700000000000002, -2.700000000000002, -2.600000000000002, -2.2000000000000015, -2.0000000000000013, -2.3000000000000016, -1.9000000000000012, -1.5000000000000009, -1.600000000000001, -2.5000000000000018, -2.4000000000000017, -2.1000000000000014, -1.9000000000000012, -2.1000000000000014, -2.0000000000000013, -2.3000000000000016, -1.5000000000000009, -2.2000000000000015, -2.2000000000000015, -2.600000000000002, -2.5000000000000018, -2.0000000000000013, -2.3000000000000016, -1.5000000000000009, -1.9000000000000012, -1.9000000000000012, -1.700000000000001, -2.0000000000000013, -1.600000000000001, -2.2000000000000015, -1.700000000000001, -1.5000000000000009, -1.8000000000000012, -2.2000000000000015, -2.1000000000000014, -2.0000000000000013, -1.9000000000000012, -1.600000000000001, -2.1000000000000014, -1.8000000000000012, -1.600000000000001, -1.5000000000000009, -1.8000000000000012, -1.700000000000001, -1.9000000000000012, -2.3000000000000016, -1.9000000000000012, -2.0000000000000013, -1.600000000000001, -1.8000000000000012, -2.0000000000000013, -1.5000000000000009, -1.9000000000000012, -2.1000000000000014, -2.0000000000000013, -2.0000000000000013, -1.600000000000001, -2.3000000000000016, -1.9000000000000012, -2.1000000000000014, -2.0000000000000013, -1.9000000000000012, -1.5000000000000009, -1.5000000000000009, -1.9000000000000012, -1.700000000000001, -1.700000000000001, -3.0000000000000018, -2.1000000000000014, -2.3000000000000016, -2.4000000000000017, -1.8000000000000012, -2.2000000000000015, -2.1000000000000014, -2.0000000000000013, -2.4000000000000017, -1.8000000000000012, -1.9000000000000012, -2.700000000000002, -2.1000000000000014, -1.600000000000001, -2.1000000000000014, -1.9000000000000012, -1.5000000000000009, -1.700000000000001, -2.2000000000000015, -1.8000000000000012, -2.2000000000000015, -1.9000000000000012, -2.2000000000000015, -2.5000000000000018, -2.5000000000000018, -1.9000000000000012, -1.600000000000001, -1.700000000000001, -2.0000000000000013, -2.3000000000000016, -1.700000000000001, -2.5000000000000018, -2.4000000000000017, -1.8000000000000012, -2.3000000000000016, -2.1000000000000014, -1.4000000000000008, -2.1000000000000014, -2.600000000000002, -2.1000000000000014, -2.1000000000000014, -1.9000000000000012, -2.5000000000000018, -2.4000000000000017], "episode_lengths": [33, 30, 33, 28, 28, 25, 26, 28, 45, 28, 29, 26, 31, 32, 28, 29, 35, 27, 38, 38, 37, 33, 31, 34, 30, 26, 27, 35, 35, 32, 30, 32, 31, 34, 26, 33, 33, 37, 36, 31, 34, 26, 30, 30, 28, 31, 27, 33, 28, 26, 29, 33, 32, 31, 30, 27, 32, 29, 27, 26, 29, 28, 30, 34, 30, 31, 27, 29, 31, 26, 30, 32, 31, 31, 27, 34, 30, 32, 31, 30, 26, 26, 30, 28, 28, 41, 32, 34, 35, 29, 33, 32, 31, 35, 29, 30, 38, 32, 27, 32, 30, 26, 28, 33, 29, 33, 30, 33, 36, 36, 30, 27, 28, 31, 34, 28, 36, 35, 29, 34, 32, 25, 32, 37, 32, 32, 30, 36, 35]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.31954090593774226, "mean_inference_ms": 0.7384289986534274, "mean_action_processing_ms": 0.07733736960245245, "mean_env_wait_ms": 6.906355340190176, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007006364275318707, "StateBufferConnector_ms": 0.004103202228398286, "ViewRequirementAgentConnector_ms": 0.09551399437956108}, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 160000, "num_agent_steps_trained": 160000, "num_env_steps_sampled": 160000, "num_env_steps_trained": 160000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 396.2200943231156, "num_env_steps_trained_throughput_per_sec": 396.2200943231156, "timesteps_total": 160000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 160000, "timers": {"training_iteration_time_ms": 9779.226, "sample_time_ms": 6007.418, "load_time_ms": 2.082, "load_throughput": 1921084.597, "learn_time_ms": 3764.451, "learn_throughput": 1062.572, "synch_weights_time_ms": 4.541}, "counters": {"num_env_steps_sampled": 160000, "num_env_steps_trained": 160000, "num_agent_steps_sampled": 160000, "num_agent_steps_trained": 160000}, "done": false, "episodes_total": 2475, "training_iteration": 40, "trial_id": "95ff9_00000", "date": "2024-03-07_12-38-10", "timestamp": 1709833090, "time_this_iter_s": 10.098259210586548, "time_total_s": 370.33665442466736, "pid": 108075, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4d85689f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 370.33665442466736, "iterations_since_restore": 40, "perf": {"cpu_util_percent": 31.200000000000003, "ram_util_percent": 47.86923076923077, "gpu_util_percent0": 0.13153846153846155, "vram_util_percent0": 0.12841170873397437}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 0.04386500736237854, "policy_loss": -0.009510570472126365, "vf_loss": 0.052388446189723506, "vf_explained_var": 0.9450740315580881, "kl": 0.004935660995475638, "entropy": 0.28560600820728527, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 37665.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 164000, "num_env_steps_trained": 164000, "num_agent_steps_sampled": 164000, "num_agent_steps_trained": 164000}, "sampler_results": {"episode_reward_max": -1.4000000000000008, "episode_reward_min": -3.5, "episode_reward_mean": -1.990697674418606, "episode_len_mean": 30.844961240310077, "episode_media": {}, "episodes_this_iter": 129, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2.0000000000000013, -2.4000000000000017, -1.8000000000000012, -2.0000000000000013, -3.0000000000000018, -1.700000000000001, -1.600000000000001, -2.2000000000000015, -1.600000000000001, -1.600000000000001, -1.8000000000000012, -2.700000000000002, -1.600000000000001, -2.5000000000000018, -2.0000000000000013, -2.3000000000000016, -1.5000000000000009, -2.1000000000000014, -1.8000000000000012, -2.0000000000000013, -2.4000000000000017, -1.700000000000001, -1.8000000000000012, -2.1000000000000014, -2.0000000000000013, -1.9000000000000012, -1.5000000000000009, -2.1000000000000014, -2.600000000000002, -2.5000000000000018, -1.8000000000000012, -2.1000000000000014, -1.8000000000000012, -2.2000000000000015, -2.4000000000000017, -1.600000000000001, -1.9000000000000012, -1.9000000000000012, -1.9000000000000012, -1.8000000000000012, -2.1000000000000014, -2.1000000000000014, -1.8000000000000012, -1.8000000000000012, -2.3000000000000016, -1.9000000000000012, -1.700000000000001, -2.2000000000000015, -2.900000000000002, -1.8000000000000012, -2.3000000000000016, -1.5000000000000009, -2.4000000000000017, -2.1000000000000014, -1.700000000000001, -2.1000000000000014, -2.0000000000000013, -2.2000000000000015, -1.5000000000000009, -1.600000000000001, -2.0000000000000013, -2.0000000000000013, -1.5000000000000009, -1.5000000000000009, -1.700000000000001, -2.600000000000002, -1.700000000000001, -1.8000000000000012, -1.9000000000000012, -1.4000000000000008, -2.0000000000000013, -2.800000000000002, -1.600000000000001, -2.1000000000000014, -2.4000000000000017, -2.0000000000000013, -1.9000000000000012, -1.4000000000000008, -2.0000000000000013, -1.8000000000000012, -2.0000000000000013, -1.8000000000000012, -1.9000000000000012, -1.600000000000001, -1.700000000000001, -2.1000000000000014, -1.4000000000000008, -2.0000000000000013, -1.5000000000000009, -1.600000000000001, -2.2000000000000015, -1.9000000000000012, -2.0000000000000013, -1.9000000000000012, -2.3000000000000016, -2.700000000000002, -2.2000000000000015, -1.9000000000000012, -2.700000000000002, -1.9000000000000012, -1.700000000000001, -2.700000000000002, -2.1000000000000014, -3.5, -1.8000000000000012, -1.600000000000001, -2.0000000000000013, -2.3000000000000016, -1.700000000000001, -1.5000000000000009, -2.1000000000000014, -1.9000000000000012, -1.8000000000000012, -2.0000000000000013, -1.9000000000000012, -2.0000000000000013, -2.0000000000000013, -2.1000000000000014, -2.0000000000000013, -2.3000000000000016, -2.0000000000000013, -1.9000000000000012, -2.3000000000000016, -2.3000000000000016, -1.9000000000000012, -2.1000000000000014, -1.9000000000000012, -1.9000000000000012, -1.9000000000000012], "episode_lengths": [31, 35, 29, 31, 41, 28, 27, 33, 27, 27, 29, 38, 27, 36, 31, 34, 26, 32, 29, 31, 35, 28, 29, 32, 31, 30, 26, 32, 37, 36, 29, 32, 29, 33, 35, 27, 30, 30, 30, 29, 32, 32, 29, 29, 34, 30, 28, 33, 40, 29, 34, 26, 35, 32, 28, 32, 31, 33, 26, 27, 31, 31, 26, 26, 28, 34, 28, 29, 30, 25, 31, 34, 27, 32, 35, 31, 30, 25, 31, 29, 31, 29, 30, 27, 28, 32, 25, 31, 26, 27, 33, 30, 31, 30, 34, 38, 33, 30, 38, 30, 28, 38, 32, 46, 29, 27, 31, 34, 28, 26, 32, 30, 29, 31, 30, 31, 31, 32, 31, 34, 31, 30, 34, 34, 30, 32, 30, 30, 30]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3222951730844878, "mean_inference_ms": 0.7385224566835232, "mean_action_processing_ms": 0.0773430321768914, "mean_env_wait_ms": 6.925244981701994, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0068076821260674054, "StateBufferConnector_ms": 0.003944810970809108, "ViewRequirementAgentConnector_ms": 0.09165586427200673}}, "episode_reward_max": -1.4000000000000008, "episode_reward_min": -3.5, "episode_reward_mean": -1.990697674418606, "episode_len_mean": 30.844961240310077, "episodes_this_iter": 129, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-2.0000000000000013, -2.4000000000000017, -1.8000000000000012, -2.0000000000000013, -3.0000000000000018, -1.700000000000001, -1.600000000000001, -2.2000000000000015, -1.600000000000001, -1.600000000000001, -1.8000000000000012, -2.700000000000002, -1.600000000000001, -2.5000000000000018, -2.0000000000000013, -2.3000000000000016, -1.5000000000000009, -2.1000000000000014, -1.8000000000000012, -2.0000000000000013, -2.4000000000000017, -1.700000000000001, -1.8000000000000012, -2.1000000000000014, -2.0000000000000013, -1.9000000000000012, -1.5000000000000009, -2.1000000000000014, -2.600000000000002, -2.5000000000000018, -1.8000000000000012, -2.1000000000000014, -1.8000000000000012, -2.2000000000000015, -2.4000000000000017, -1.600000000000001, -1.9000000000000012, -1.9000000000000012, -1.9000000000000012, -1.8000000000000012, -2.1000000000000014, -2.1000000000000014, -1.8000000000000012, -1.8000000000000012, -2.3000000000000016, -1.9000000000000012, -1.700000000000001, -2.2000000000000015, -2.900000000000002, -1.8000000000000012, -2.3000000000000016, -1.5000000000000009, -2.4000000000000017, -2.1000000000000014, -1.700000000000001, -2.1000000000000014, -2.0000000000000013, -2.2000000000000015, -1.5000000000000009, -1.600000000000001, -2.0000000000000013, -2.0000000000000013, -1.5000000000000009, -1.5000000000000009, -1.700000000000001, -2.600000000000002, -1.700000000000001, -1.8000000000000012, -1.9000000000000012, -1.4000000000000008, -2.0000000000000013, -2.800000000000002, -1.600000000000001, -2.1000000000000014, -2.4000000000000017, -2.0000000000000013, -1.9000000000000012, -1.4000000000000008, -2.0000000000000013, -1.8000000000000012, -2.0000000000000013, -1.8000000000000012, -1.9000000000000012, -1.600000000000001, -1.700000000000001, -2.1000000000000014, -1.4000000000000008, -2.0000000000000013, -1.5000000000000009, -1.600000000000001, -2.2000000000000015, -1.9000000000000012, -2.0000000000000013, -1.9000000000000012, -2.3000000000000016, -2.700000000000002, -2.2000000000000015, -1.9000000000000012, -2.700000000000002, -1.9000000000000012, -1.700000000000001, -2.700000000000002, -2.1000000000000014, -3.5, -1.8000000000000012, -1.600000000000001, -2.0000000000000013, -2.3000000000000016, -1.700000000000001, -1.5000000000000009, -2.1000000000000014, -1.9000000000000012, -1.8000000000000012, -2.0000000000000013, -1.9000000000000012, -2.0000000000000013, -2.0000000000000013, -2.1000000000000014, -2.0000000000000013, -2.3000000000000016, -2.0000000000000013, -1.9000000000000012, -2.3000000000000016, -2.3000000000000016, -1.9000000000000012, -2.1000000000000014, -1.9000000000000012, -1.9000000000000012, -1.9000000000000012], "episode_lengths": [31, 35, 29, 31, 41, 28, 27, 33, 27, 27, 29, 38, 27, 36, 31, 34, 26, 32, 29, 31, 35, 28, 29, 32, 31, 30, 26, 32, 37, 36, 29, 32, 29, 33, 35, 27, 30, 30, 30, 29, 32, 32, 29, 29, 34, 30, 28, 33, 40, 29, 34, 26, 35, 32, 28, 32, 31, 33, 26, 27, 31, 31, 26, 26, 28, 34, 28, 29, 30, 25, 31, 34, 27, 32, 35, 31, 30, 25, 31, 29, 31, 29, 30, 27, 28, 32, 25, 31, 26, 27, 33, 30, 31, 30, 34, 38, 33, 30, 38, 30, 28, 38, 32, 46, 29, 27, 31, 34, 28, 26, 32, 30, 29, 31, 30, 31, 31, 32, 31, 34, 31, 30, 34, 34, 30, 32, 30, 30, 30]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3222951730844878, "mean_inference_ms": 0.7385224566835232, "mean_action_processing_ms": 0.0773430321768914, "mean_env_wait_ms": 6.925244981701994, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0068076821260674054, "StateBufferConnector_ms": 0.003944810970809108, "ViewRequirementAgentConnector_ms": 0.09165586427200673}, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 164000, "num_agent_steps_trained": 164000, "num_env_steps_sampled": 164000, "num_env_steps_trained": 164000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 408.02878038467446, "num_env_steps_trained_throughput_per_sec": 408.02878038467446, "timesteps_total": 164000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 164000, "timers": {"training_iteration_time_ms": 9816.559, "sample_time_ms": 6044.559, "load_time_ms": 2.082, "load_throughput": 1921634.691, "learn_time_ms": 3765.803, "learn_throughput": 1062.19, "synch_weights_time_ms": 3.413}, "counters": {"num_env_steps_sampled": 164000, "num_env_steps_trained": 164000, "num_agent_steps_sampled": 164000, "num_agent_steps_trained": 164000}, "done": false, "episodes_total": 2604, "training_iteration": 41, "trial_id": "95ff9_00000", "date": "2024-03-07_12-38-20", "timestamp": 1709833100, "time_this_iter_s": 9.806002140045166, "time_total_s": 380.1426565647125, "pid": 108075, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4d85689f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 380.1426565647125, "iterations_since_restore": 41, "perf": {"cpu_util_percent": 28.28461538461539, "ram_util_percent": 47.88461538461537, "gpu_util_percent0": 0.11307692307692307, "vram_util_percent0": 0.1273975861378205}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.10000000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 0.07447219169645455, "policy_loss": -0.010434674565750425, "vf_loss": 0.08439124799784153, "vf_explained_var": 0.9288822588741138, "kl": 0.005156179519457854, "entropy": 0.2512781066038916, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 38595.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 168000, "num_env_steps_trained": 168000, "num_agent_steps_sampled": 168000, "num_agent_steps_trained": 168000}, "sampler_results": {"episode_reward_max": -1.4000000000000008, "episode_reward_min": -4.1999999999999975, "episode_reward_mean": -1.9022727272727284, "episode_len_mean": 29.992424242424242, "episode_media": {}, "episodes_this_iter": 132, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2.2000000000000015, -1.9000000000000012, -1.700000000000001, -1.600000000000001, -1.600000000000001, -1.700000000000001, -1.8000000000000012, -1.9000000000000012, -2.3000000000000016, -2.2000000000000015, -1.8000000000000012, -2.4000000000000017, -1.8000000000000012, -2.0000000000000013, -1.700000000000001, -1.4000000000000008, -1.4000000000000008, -1.8000000000000012, -1.700000000000001, -1.9000000000000012, -1.600000000000001, -1.700000000000001, -1.4000000000000008, -2.0000000000000013, -2.1000000000000014, -2.0000000000000013, -1.4000000000000008, -2.0000000000000013, -1.600000000000001, -2.0000000000000013, -2.3000000000000016, -1.8000000000000012, -1.600000000000001, -1.8000000000000012, -1.8000000000000012, -1.9000000000000012, -2.2000000000000015, -2.1000000000000014, -1.5000000000000009, -2.0000000000000013, -1.5000000000000009, -2.2000000000000015, -2.0000000000000013, -1.8000000000000012, -2.3000000000000016, -1.4000000000000008, -2.3000000000000016, -2.2000000000000015, -1.700000000000001, -2.0000000000000013, -2.0000000000000013, -2.0000000000000013, -1.8000000000000012, -1.8000000000000012, -1.5000000000000009, -1.600000000000001, -1.9000000000000012, -1.9000000000000012, -1.9000000000000012, -1.9000000000000012, -1.5000000000000009, -2.3000000000000016, -1.9000000000000012, -1.600000000000001, -1.600000000000001, -2.2000000000000015, -4.1999999999999975, -1.8000000000000012, -2.0000000000000013, -2.2000000000000015, -1.8000000000000012, -2.0000000000000013, -1.700000000000001, -1.5000000000000009, -1.5000000000000009, -1.8000000000000012, -1.5000000000000009, -2.3000000000000016, -2.0000000000000013, -2.0000000000000013, -2.0000000000000013, -2.3000000000000016, -1.700000000000001, -1.700000000000001, -1.8000000000000012, -2.2000000000000015, -1.8000000000000012, -2.0000000000000013, -2.0000000000000013, -1.8000000000000012, -2.2000000000000015, -1.700000000000001, -1.5000000000000009, -1.600000000000001, -1.8000000000000012, -2.900000000000002, -1.700000000000001, -2.3000000000000016, -2.3000000000000016, -1.700000000000001, -2.0000000000000013, -1.9000000000000012, -3.0000000000000018, -1.600000000000001, -1.9000000000000012, -1.5000000000000009, -1.8000000000000012, -1.5000000000000009, -1.4000000000000008, -1.8000000000000012, -2.1000000000000014, -2.0000000000000013, -1.9000000000000012, -1.600000000000001, -1.9000000000000012, -2.1000000000000014, -1.700000000000001, -2.1000000000000014, -2.5000000000000018, -1.8000000000000012, -1.700000000000001, -2.0000000000000013, -2.1000000000000014, -2.1000000000000014, -1.4000000000000008, -1.8000000000000012, -2.0000000000000013, -1.8000000000000012, -2.3000000000000016, -1.4000000000000008, -2.1000000000000014, -2.600000000000002], "episode_lengths": [33, 30, 28, 27, 27, 28, 29, 30, 34, 33, 29, 35, 29, 31, 28, 25, 25, 29, 28, 30, 27, 28, 25, 31, 32, 31, 25, 31, 27, 31, 34, 29, 27, 29, 29, 30, 33, 32, 26, 31, 26, 33, 31, 29, 34, 25, 34, 33, 28, 30, 31, 31, 29, 29, 26, 27, 30, 30, 30, 30, 26, 34, 30, 27, 27, 33, 51, 29, 31, 33, 29, 31, 28, 26, 26, 29, 26, 34, 31, 31, 31, 34, 28, 28, 29, 33, 29, 31, 31, 29, 33, 28, 26, 27, 29, 40, 28, 34, 34, 28, 31, 30, 40, 27, 30, 26, 29, 26, 25, 29, 32, 31, 30, 27, 30, 32, 28, 32, 36, 29, 28, 31, 32, 32, 25, 29, 31, 29, 34, 25, 32, 37]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.32484445890979546, "mean_inference_ms": 0.7384977202001526, "mean_action_processing_ms": 0.07732142566248057, "mean_env_wait_ms": 6.943415493480399, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006813713998505564, "StateBufferConnector_ms": 0.003930113532326438, "ViewRequirementAgentConnector_ms": 0.09089058095758612}}, "episode_reward_max": -1.4000000000000008, "episode_reward_min": -4.1999999999999975, "episode_reward_mean": -1.9022727272727284, "episode_len_mean": 29.992424242424242, "episodes_this_iter": 132, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-2.2000000000000015, -1.9000000000000012, -1.700000000000001, -1.600000000000001, -1.600000000000001, -1.700000000000001, -1.8000000000000012, -1.9000000000000012, -2.3000000000000016, -2.2000000000000015, -1.8000000000000012, -2.4000000000000017, -1.8000000000000012, -2.0000000000000013, -1.700000000000001, -1.4000000000000008, -1.4000000000000008, -1.8000000000000012, -1.700000000000001, -1.9000000000000012, -1.600000000000001, -1.700000000000001, -1.4000000000000008, -2.0000000000000013, -2.1000000000000014, -2.0000000000000013, -1.4000000000000008, -2.0000000000000013, -1.600000000000001, -2.0000000000000013, -2.3000000000000016, -1.8000000000000012, -1.600000000000001, -1.8000000000000012, -1.8000000000000012, -1.9000000000000012, -2.2000000000000015, -2.1000000000000014, -1.5000000000000009, -2.0000000000000013, -1.5000000000000009, -2.2000000000000015, -2.0000000000000013, -1.8000000000000012, -2.3000000000000016, -1.4000000000000008, -2.3000000000000016, -2.2000000000000015, -1.700000000000001, -2.0000000000000013, -2.0000000000000013, -2.0000000000000013, -1.8000000000000012, -1.8000000000000012, -1.5000000000000009, -1.600000000000001, -1.9000000000000012, -1.9000000000000012, -1.9000000000000012, -1.9000000000000012, -1.5000000000000009, -2.3000000000000016, -1.9000000000000012, -1.600000000000001, -1.600000000000001, -2.2000000000000015, -4.1999999999999975, -1.8000000000000012, -2.0000000000000013, -2.2000000000000015, -1.8000000000000012, -2.0000000000000013, -1.700000000000001, -1.5000000000000009, -1.5000000000000009, -1.8000000000000012, -1.5000000000000009, -2.3000000000000016, -2.0000000000000013, -2.0000000000000013, -2.0000000000000013, -2.3000000000000016, -1.700000000000001, -1.700000000000001, -1.8000000000000012, -2.2000000000000015, -1.8000000000000012, -2.0000000000000013, -2.0000000000000013, -1.8000000000000012, -2.2000000000000015, -1.700000000000001, -1.5000000000000009, -1.600000000000001, -1.8000000000000012, -2.900000000000002, -1.700000000000001, -2.3000000000000016, -2.3000000000000016, -1.700000000000001, -2.0000000000000013, -1.9000000000000012, -3.0000000000000018, -1.600000000000001, -1.9000000000000012, -1.5000000000000009, -1.8000000000000012, -1.5000000000000009, -1.4000000000000008, -1.8000000000000012, -2.1000000000000014, -2.0000000000000013, -1.9000000000000012, -1.600000000000001, -1.9000000000000012, -2.1000000000000014, -1.700000000000001, -2.1000000000000014, -2.5000000000000018, -1.8000000000000012, -1.700000000000001, -2.0000000000000013, -2.1000000000000014, -2.1000000000000014, -1.4000000000000008, -1.8000000000000012, -2.0000000000000013, -1.8000000000000012, -2.3000000000000016, -1.4000000000000008, -2.1000000000000014, -2.600000000000002], "episode_lengths": [33, 30, 28, 27, 27, 28, 29, 30, 34, 33, 29, 35, 29, 31, 28, 25, 25, 29, 28, 30, 27, 28, 25, 31, 32, 31, 25, 31, 27, 31, 34, 29, 27, 29, 29, 30, 33, 32, 26, 31, 26, 33, 31, 29, 34, 25, 34, 33, 28, 30, 31, 31, 29, 29, 26, 27, 30, 30, 30, 30, 26, 34, 30, 27, 27, 33, 51, 29, 31, 33, 29, 31, 28, 26, 26, 29, 26, 34, 31, 31, 31, 34, 28, 28, 29, 33, 29, 31, 31, 29, 33, 28, 26, 27, 29, 40, 28, 34, 34, 28, 31, 30, 40, 27, 30, 26, 29, 26, 25, 29, 32, 31, 30, 27, 30, 32, 28, 32, 36, 29, 28, 31, 32, 32, 25, 29, 31, 29, 34, 25, 32, 37]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.32484445890979546, "mean_inference_ms": 0.7384977202001526, "mean_action_processing_ms": 0.07732142566248057, "mean_env_wait_ms": 6.943415493480399, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006813713998505564, "StateBufferConnector_ms": 0.003930113532326438, "ViewRequirementAgentConnector_ms": 0.09089058095758612}, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 168000, "num_agent_steps_trained": 168000, "num_env_steps_sampled": 168000, "num_env_steps_trained": 168000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 411.75944506624927, "num_env_steps_trained_throughput_per_sec": 411.75944506624927, "timesteps_total": 168000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 168000, "timers": {"training_iteration_time_ms": 9827.028, "sample_time_ms": 6061.576, "load_time_ms": 2.08, "load_throughput": 1922713.791, "learn_time_ms": 3759.24, "learn_throughput": 1064.045, "synch_weights_time_ms": 3.428}, "counters": {"num_env_steps_sampled": 168000, "num_env_steps_trained": 168000, "num_agent_steps_sampled": 168000, "num_agent_steps_trained": 168000}, "done": false, "episodes_total": 2736, "training_iteration": 42, "trial_id": "95ff9_00000", "date": "2024-03-07_12-38-30", "timestamp": 1709833110, "time_this_iter_s": 9.717531204223633, "time_total_s": 389.86018776893616, "pid": 108075, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4d85689f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 389.86018776893616, "iterations_since_restore": 42, "perf": {"cpu_util_percent": 29.558333333333337, "ram_util_percent": 47.79999999999999, "gpu_util_percent0": 0.09749999999999999, "vram_util_percent0": 0.12696668836805555}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.10000000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 0.03195124316787828, "policy_loss": -0.017872349421183268, "vf_loss": 0.04793843898511622, "vf_explained_var": 0.9505500865238969, "kl": 0.01885152589826463, "entropy": 0.2964013983004837, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 39525.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 172000, "num_env_steps_trained": 172000, "num_agent_steps_sampled": 172000, "num_agent_steps_trained": 172000}, "sampler_results": {"episode_reward_max": -1.4000000000000008, "episode_reward_min": -3.700000000000001, "episode_reward_mean": -1.9237037037037048, "episode_len_mean": 30.14814814814815, "episode_media": {}, "episodes_this_iter": 135, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1.8000000000000012, -1.9000000000000012, -2.2000000000000015, -1.700000000000001, -1.9000000000000012, -2.0000000000000013, -1.9000000000000012, -2.2000000000000015, -2.2000000000000015, -1.5000000000000009, -2.3000000000000016, -1.8000000000000012, -1.8000000000000012, -2.0000000000000013, -2.4000000000000017, -2.0000000000000013, -1.8000000000000012, -2.3000000000000016, -1.5000000000000009, -1.4000000000000008, -1.600000000000001, -1.9000000000000012, -2.2000000000000015, -1.600000000000001, -1.9000000000000012, -2.3000000000000016, -1.9000000000000012, -1.600000000000001, -1.8000000000000012, -1.8000000000000012, -2.0000000000000013, -1.600000000000001, -2.2000000000000015, -1.600000000000001, -2.1000000000000014, -2.0000000000000013, -2.0000000000000013, -1.5000000000000009, -1.700000000000001, -1.9000000000000012, -2.1000000000000014, -1.700000000000001, -2.0000000000000013, -1.600000000000001, -2.700000000000002, -1.4000000000000008, -1.8000000000000012, -1.9000000000000012, -2.0000000000000013, -2.3000000000000016, -1.8000000000000012, -1.700000000000001, -1.700000000000001, -2.0000000000000013, -2.0000000000000013, -2.4000000000000017, -2.1000000000000014, -1.700000000000001, -2.4000000000000017, -1.5000000000000009, -1.5000000000000009, -1.600000000000001, -1.700000000000001, -1.8000000000000012, -2.2000000000000015, -1.4000000000000008, -2.0000000000000013, -1.600000000000001, -2.2000000000000015, -1.700000000000001, -1.8000000000000012, -2.0000000000000013, -1.4000000000000008, -1.4000000000000008, -2.0000000000000013, -1.700000000000001, -2.3000000000000016, -1.4000000000000008, -2.1000000000000014, -2.3000000000000016, -1.600000000000001, -1.9000000000000012, -1.9000000000000012, -1.700000000000001, -1.8000000000000012, -2.0000000000000013, -1.9000000000000012, -1.9000000000000012, -1.600000000000001, -1.9000000000000012, -2.2000000000000015, -3.700000000000001, -2.3000000000000016, -1.8000000000000012, -1.600000000000001, -1.700000000000001, -2.0000000000000013, -1.600000000000001, -1.700000000000001, -3.0000000000000018, -1.700000000000001, -3.1000000000000014, -1.8000000000000012, -1.9000000000000012, -1.9000000000000012, -1.700000000000001, -2.1000000000000014, -1.600000000000001, -2.1000000000000014, -1.9000000000000012, -2.700000000000002, -3.3000000000000007, -1.5000000000000009, -2.2000000000000015, -1.4000000000000008, -2.1000000000000014, -1.4000000000000008, -2.2000000000000015, -1.8000000000000012, -1.600000000000001, -1.9000000000000012, -2.0000000000000013, -1.5000000000000009, -2.700000000000002, -1.700000000000001, -1.8000000000000012, -2.0000000000000013, -1.8000000000000012, -1.700000000000001, -2.2000000000000015, -1.700000000000001, -2.0000000000000013, -2.2000000000000015, -2.1000000000000014, -1.9000000000000012], "episode_lengths": [29, 30, 33, 28, 30, 31, 30, 33, 33, 26, 34, 29, 29, 31, 35, 31, 28, 34, 26, 25, 27, 30, 33, 27, 30, 31, 30, 27, 29, 29, 31, 27, 33, 27, 32, 31, 31, 26, 28, 30, 32, 28, 31, 27, 35, 25, 29, 30, 31, 34, 29, 28, 28, 31, 31, 34, 32, 28, 35, 26, 26, 27, 28, 29, 33, 25, 31, 27, 33, 28, 29, 31, 25, 25, 31, 28, 34, 25, 32, 34, 27, 30, 30, 28, 29, 31, 30, 30, 27, 30, 33, 44, 34, 29, 27, 28, 31, 27, 28, 41, 28, 42, 29, 30, 30, 28, 32, 27, 32, 30, 38, 44, 26, 33, 25, 32, 25, 33, 29, 27, 30, 31, 26, 38, 28, 29, 31, 29, 28, 33, 28, 31, 33, 32, 30]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.32760764091449707, "mean_inference_ms": 0.738477005235583, "mean_action_processing_ms": 0.07732446877791832, "mean_env_wait_ms": 6.9609167020495955, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006685080351652922, "StateBufferConnector_ms": 0.0038699750547055846, "ViewRequirementAgentConnector_ms": 0.091146363152398}}, "episode_reward_max": -1.4000000000000008, "episode_reward_min": -3.700000000000001, "episode_reward_mean": -1.9237037037037048, "episode_len_mean": 30.14814814814815, "episodes_this_iter": 135, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1.8000000000000012, -1.9000000000000012, -2.2000000000000015, -1.700000000000001, -1.9000000000000012, -2.0000000000000013, -1.9000000000000012, -2.2000000000000015, -2.2000000000000015, -1.5000000000000009, -2.3000000000000016, -1.8000000000000012, -1.8000000000000012, -2.0000000000000013, -2.4000000000000017, -2.0000000000000013, -1.8000000000000012, -2.3000000000000016, -1.5000000000000009, -1.4000000000000008, -1.600000000000001, -1.9000000000000012, -2.2000000000000015, -1.600000000000001, -1.9000000000000012, -2.3000000000000016, -1.9000000000000012, -1.600000000000001, -1.8000000000000012, -1.8000000000000012, -2.0000000000000013, -1.600000000000001, -2.2000000000000015, -1.600000000000001, -2.1000000000000014, -2.0000000000000013, -2.0000000000000013, -1.5000000000000009, -1.700000000000001, -1.9000000000000012, -2.1000000000000014, -1.700000000000001, -2.0000000000000013, -1.600000000000001, -2.700000000000002, -1.4000000000000008, -1.8000000000000012, -1.9000000000000012, -2.0000000000000013, -2.3000000000000016, -1.8000000000000012, -1.700000000000001, -1.700000000000001, -2.0000000000000013, -2.0000000000000013, -2.4000000000000017, -2.1000000000000014, -1.700000000000001, -2.4000000000000017, -1.5000000000000009, -1.5000000000000009, -1.600000000000001, -1.700000000000001, -1.8000000000000012, -2.2000000000000015, -1.4000000000000008, -2.0000000000000013, -1.600000000000001, -2.2000000000000015, -1.700000000000001, -1.8000000000000012, -2.0000000000000013, -1.4000000000000008, -1.4000000000000008, -2.0000000000000013, -1.700000000000001, -2.3000000000000016, -1.4000000000000008, -2.1000000000000014, -2.3000000000000016, -1.600000000000001, -1.9000000000000012, -1.9000000000000012, -1.700000000000001, -1.8000000000000012, -2.0000000000000013, -1.9000000000000012, -1.9000000000000012, -1.600000000000001, -1.9000000000000012, -2.2000000000000015, -3.700000000000001, -2.3000000000000016, -1.8000000000000012, -1.600000000000001, -1.700000000000001, -2.0000000000000013, -1.600000000000001, -1.700000000000001, -3.0000000000000018, -1.700000000000001, -3.1000000000000014, -1.8000000000000012, -1.9000000000000012, -1.9000000000000012, -1.700000000000001, -2.1000000000000014, -1.600000000000001, -2.1000000000000014, -1.9000000000000012, -2.700000000000002, -3.3000000000000007, -1.5000000000000009, -2.2000000000000015, -1.4000000000000008, -2.1000000000000014, -1.4000000000000008, -2.2000000000000015, -1.8000000000000012, -1.600000000000001, -1.9000000000000012, -2.0000000000000013, -1.5000000000000009, -2.700000000000002, -1.700000000000001, -1.8000000000000012, -2.0000000000000013, -1.8000000000000012, -1.700000000000001, -2.2000000000000015, -1.700000000000001, -2.0000000000000013, -2.2000000000000015, -2.1000000000000014, -1.9000000000000012], "episode_lengths": [29, 30, 33, 28, 30, 31, 30, 33, 33, 26, 34, 29, 29, 31, 35, 31, 28, 34, 26, 25, 27, 30, 33, 27, 30, 31, 30, 27, 29, 29, 31, 27, 33, 27, 32, 31, 31, 26, 28, 30, 32, 28, 31, 27, 35, 25, 29, 30, 31, 34, 29, 28, 28, 31, 31, 34, 32, 28, 35, 26, 26, 27, 28, 29, 33, 25, 31, 27, 33, 28, 29, 31, 25, 25, 31, 28, 34, 25, 32, 34, 27, 30, 30, 28, 29, 31, 30, 30, 27, 30, 33, 44, 34, 29, 27, 28, 31, 27, 28, 41, 28, 42, 29, 30, 30, 28, 32, 27, 32, 30, 38, 44, 26, 33, 25, 32, 25, 33, 29, 27, 30, 31, 26, 38, 28, 29, 31, 29, 28, 33, 28, 31, 33, 32, 30]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.32760764091449707, "mean_inference_ms": 0.738477005235583, "mean_action_processing_ms": 0.07732446877791832, "mean_env_wait_ms": 6.9609167020495955, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006685080351652922, "StateBufferConnector_ms": 0.0038699750547055846, "ViewRequirementAgentConnector_ms": 0.091146363152398}, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 172000, "num_agent_steps_trained": 172000, "num_env_steps_sampled": 172000, "num_env_steps_trained": 172000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 411.84578622403035, "num_env_steps_trained_throughput_per_sec": 411.84578622403035, "timesteps_total": 172000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 172000, "timers": {"training_iteration_time_ms": 9846.208, "sample_time_ms": 6083.0, "load_time_ms": 2.079, "load_throughput": 1923617.643, "learn_time_ms": 3756.973, "learn_throughput": 1064.687, "synch_weights_time_ms": 3.451}, "counters": {"num_env_steps_sampled": 172000, "num_env_steps_trained": 172000, "num_agent_steps_sampled": 172000, "num_agent_steps_trained": 172000}, "done": false, "episodes_total": 2871, "training_iteration": 43, "trial_id": "95ff9_00000", "date": "2024-03-07_12-38-40", "timestamp": 1709833120, "time_this_iter_s": 9.715113162994385, "time_total_s": 399.57530093193054, "pid": 108075, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4d85689f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 399.57530093193054, "iterations_since_restore": 43, "perf": {"cpu_util_percent": 28.092307692307692, "ram_util_percent": 47.79999999999999, "gpu_util_percent0": 0.1123076923076923, "vram_util_percent0": 0.126953125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.10000000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 0.14211349940247914, "policy_loss": -0.010437208658424757, "vf_loss": 0.15089044018989048, "vf_explained_var": 0.8965820613727775, "kl": 0.01660268495365927, "entropy": 0.2982017094249366, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 40455.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 176000, "num_env_steps_trained": 176000, "num_agent_steps_sampled": 176000, "num_agent_steps_trained": 176000}, "sampler_results": {"episode_reward_max": -1.4000000000000008, "episode_reward_min": -4.799999999999995, "episode_reward_mean": -1.9303030303030315, "episode_len_mean": 30.106060606060606, "episode_media": {}, "episodes_this_iter": 132, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1.5000000000000009, -1.4000000000000008, -1.5000000000000009, -2.0000000000000013, -1.8000000000000012, -1.700000000000001, -2.700000000000002, -1.9000000000000012, -2.800000000000002, -1.600000000000001, -1.600000000000001, -1.8000000000000012, -1.9000000000000012, -2.1000000000000014, -1.600000000000001, -1.8000000000000012, -1.4000000000000008, -2.0000000000000013, -2.2000000000000015, -2.0000000000000013, -1.4000000000000008, -1.8000000000000012, -2.0000000000000013, -4.100000000000001, -1.8000000000000012, -1.5000000000000009, -1.600000000000001, -1.600000000000001, -2.1000000000000014, -1.600000000000001, -2.0000000000000013, -1.8000000000000012, -1.5000000000000009, -2.1000000000000014, -1.8000000000000012, -1.8000000000000012, -1.9000000000000012, -4.799999999999995, -1.700000000000001, -3.5, -1.8000000000000012, -1.9000000000000012, -1.8000000000000012, -2.0000000000000013, -1.8000000000000012, -1.8000000000000012, -2.2000000000000015, -2.0000000000000013, -2.5000000000000018, -3.5999999999999996, -2.0000000000000013, -1.700000000000001, -2.4000000000000017, -2.1000000000000014, -1.600000000000001, -2.0000000000000013, -1.600000000000001, -2.0000000000000013, -2.1000000000000014, -1.600000000000001, -1.9000000000000012, -1.700000000000001, -1.700000000000001, -2.0000000000000013, -1.600000000000001, -2.0000000000000013, -2.900000000000002, -1.600000000000001, -1.700000000000001, -1.8000000000000012, -1.4000000000000008, -2.4000000000000017, -1.5000000000000009, -1.8000000000000012, -1.5000000000000009, -1.4000000000000008, -2.3000000000000016, -2.2000000000000015, -2.0000000000000013, -1.8000000000000012, -1.700000000000001, -1.5000000000000009, -1.5000000000000009, -2.2000000000000015, -2.1000000000000014, -1.700000000000001, -2.2000000000000015, -2.0000000000000013, -1.8000000000000012, -1.4000000000000008, -2.2000000000000015, -1.700000000000001, -2.1000000000000014, -1.9000000000000012, -1.4000000000000008, -2.3000000000000016, -1.5000000000000009, -3.0000000000000018, -2.2000000000000015, -1.9000000000000012, -1.600000000000001, -1.8000000000000012, -1.8000000000000012, -1.8000000000000012, -2.0000000000000013, -1.600000000000001, -1.8000000000000012, -2.4000000000000017, -1.9000000000000012, -1.9000000000000012, -2.2000000000000015, -1.8000000000000012, -1.5000000000000009, -1.9000000000000012, -1.600000000000001, -1.8000000000000012, -2.2000000000000015, -1.700000000000001, -1.700000000000001, -1.9000000000000012, -2.0000000000000013, -1.700000000000001, -2.0000000000000013, -2.1000000000000014, -1.600000000000001, -1.700000000000001, -2.0000000000000013, -1.4000000000000008, -2.0000000000000013, -1.8000000000000012, -1.700000000000001, -2.2000000000000015], "episode_lengths": [26, 25, 26, 31, 29, 28, 38, 30, 39, 27, 27, 29, 30, 32, 27, 29, 25, 31, 33, 31, 25, 29, 31, 42, 29, 26, 27, 27, 32, 27, 31, 29, 26, 32, 29, 29, 30, 55, 28, 44, 29, 30, 29, 31, 29, 29, 33, 31, 36, 41, 31, 28, 31, 32, 27, 31, 27, 31, 32, 27, 30, 28, 28, 31, 27, 31, 40, 27, 28, 29, 25, 35, 26, 29, 26, 25, 34, 33, 31, 29, 28, 26, 26, 33, 32, 28, 33, 31, 29, 25, 33, 28, 32, 30, 25, 34, 26, 41, 33, 30, 27, 29, 29, 29, 31, 27, 29, 35, 30, 30, 33, 29, 26, 30, 27, 29, 33, 28, 28, 30, 31, 28, 31, 32, 27, 28, 31, 25, 31, 29, 28, 33]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.33010099411197114, "mean_inference_ms": 0.738555250751649, "mean_action_processing_ms": 0.07733655103403853, "mean_env_wait_ms": 6.980011738776554, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006837013996008671, "StateBufferConnector_ms": 0.003965876319191672, "ViewRequirementAgentConnector_ms": 0.0917864568305738}}, "episode_reward_max": -1.4000000000000008, "episode_reward_min": -4.799999999999995, "episode_reward_mean": -1.9303030303030315, "episode_len_mean": 30.106060606060606, "episodes_this_iter": 132, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1.5000000000000009, -1.4000000000000008, -1.5000000000000009, -2.0000000000000013, -1.8000000000000012, -1.700000000000001, -2.700000000000002, -1.9000000000000012, -2.800000000000002, -1.600000000000001, -1.600000000000001, -1.8000000000000012, -1.9000000000000012, -2.1000000000000014, -1.600000000000001, -1.8000000000000012, -1.4000000000000008, -2.0000000000000013, -2.2000000000000015, -2.0000000000000013, -1.4000000000000008, -1.8000000000000012, -2.0000000000000013, -4.100000000000001, -1.8000000000000012, -1.5000000000000009, -1.600000000000001, -1.600000000000001, -2.1000000000000014, -1.600000000000001, -2.0000000000000013, -1.8000000000000012, -1.5000000000000009, -2.1000000000000014, -1.8000000000000012, -1.8000000000000012, -1.9000000000000012, -4.799999999999995, -1.700000000000001, -3.5, -1.8000000000000012, -1.9000000000000012, -1.8000000000000012, -2.0000000000000013, -1.8000000000000012, -1.8000000000000012, -2.2000000000000015, -2.0000000000000013, -2.5000000000000018, -3.5999999999999996, -2.0000000000000013, -1.700000000000001, -2.4000000000000017, -2.1000000000000014, -1.600000000000001, -2.0000000000000013, -1.600000000000001, -2.0000000000000013, -2.1000000000000014, -1.600000000000001, -1.9000000000000012, -1.700000000000001, -1.700000000000001, -2.0000000000000013, -1.600000000000001, -2.0000000000000013, -2.900000000000002, -1.600000000000001, -1.700000000000001, -1.8000000000000012, -1.4000000000000008, -2.4000000000000017, -1.5000000000000009, -1.8000000000000012, -1.5000000000000009, -1.4000000000000008, -2.3000000000000016, -2.2000000000000015, -2.0000000000000013, -1.8000000000000012, -1.700000000000001, -1.5000000000000009, -1.5000000000000009, -2.2000000000000015, -2.1000000000000014, -1.700000000000001, -2.2000000000000015, -2.0000000000000013, -1.8000000000000012, -1.4000000000000008, -2.2000000000000015, -1.700000000000001, -2.1000000000000014, -1.9000000000000012, -1.4000000000000008, -2.3000000000000016, -1.5000000000000009, -3.0000000000000018, -2.2000000000000015, -1.9000000000000012, -1.600000000000001, -1.8000000000000012, -1.8000000000000012, -1.8000000000000012, -2.0000000000000013, -1.600000000000001, -1.8000000000000012, -2.4000000000000017, -1.9000000000000012, -1.9000000000000012, -2.2000000000000015, -1.8000000000000012, -1.5000000000000009, -1.9000000000000012, -1.600000000000001, -1.8000000000000012, -2.2000000000000015, -1.700000000000001, -1.700000000000001, -1.9000000000000012, -2.0000000000000013, -1.700000000000001, -2.0000000000000013, -2.1000000000000014, -1.600000000000001, -1.700000000000001, -2.0000000000000013, -1.4000000000000008, -2.0000000000000013, -1.8000000000000012, -1.700000000000001, -2.2000000000000015], "episode_lengths": [26, 25, 26, 31, 29, 28, 38, 30, 39, 27, 27, 29, 30, 32, 27, 29, 25, 31, 33, 31, 25, 29, 31, 42, 29, 26, 27, 27, 32, 27, 31, 29, 26, 32, 29, 29, 30, 55, 28, 44, 29, 30, 29, 31, 29, 29, 33, 31, 36, 41, 31, 28, 31, 32, 27, 31, 27, 31, 32, 27, 30, 28, 28, 31, 27, 31, 40, 27, 28, 29, 25, 35, 26, 29, 26, 25, 34, 33, 31, 29, 28, 26, 26, 33, 32, 28, 33, 31, 29, 25, 33, 28, 32, 30, 25, 34, 26, 41, 33, 30, 27, 29, 29, 29, 31, 27, 29, 35, 30, 30, 33, 29, 26, 30, 27, 29, 33, 28, 28, 30, 31, 28, 31, 32, 27, 28, 31, 25, 31, 29, 28, 33]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.33010099411197114, "mean_inference_ms": 0.738555250751649, "mean_action_processing_ms": 0.07733655103403853, "mean_env_wait_ms": 6.980011738776554, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006837013996008671, "StateBufferConnector_ms": 0.003965876319191672, "ViewRequirementAgentConnector_ms": 0.0917864568305738}, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 176000, "num_agent_steps_trained": 176000, "num_env_steps_sampled": 176000, "num_env_steps_trained": 176000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 407.56337714759354, "num_env_steps_trained_throughput_per_sec": 407.56337714759354, "timesteps_total": 176000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 176000, "timers": {"training_iteration_time_ms": 9843.243, "sample_time_ms": 6111.537, "load_time_ms": 2.079, "load_throughput": 1924080.921, "learn_time_ms": 3725.506, "learn_throughput": 1073.68, "synch_weights_time_ms": 3.42}, "counters": {"num_env_steps_sampled": 176000, "num_env_steps_trained": 176000, "num_agent_steps_sampled": 176000, "num_agent_steps_trained": 176000}, "done": false, "episodes_total": 3003, "training_iteration": 44, "trial_id": "95ff9_00000", "date": "2024-03-07_12-38-49", "timestamp": 1709833129, "time_this_iter_s": 9.81729793548584, "time_total_s": 409.3925988674164, "pid": 108075, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4d85689f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 409.3925988674164, "iterations_since_restore": 44, "perf": {"cpu_util_percent": 29.200000000000003, "ram_util_percent": 47.79999999999999, "gpu_util_percent0": 0.10461538461538461, "vram_util_percent0": 0.126953125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.10000000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 0.03563832860979532, "policy_loss": -0.004352145053205952, "vf_loss": 0.03857486629207689, "vf_explained_var": 0.9558809004163229, "kl": 0.014156074034091885, "entropy": 0.24377948553651893, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 41385.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 180000, "num_env_steps_trained": 180000, "num_agent_steps_sampled": 180000, "num_agent_steps_trained": 180000}, "sampler_results": {"episode_reward_max": -1.4000000000000008, "episode_reward_min": -3.3000000000000007, "episode_reward_mean": -1.8338129496402888, "episode_len_mean": 29.18705035971223, "episode_media": {}, "episodes_this_iter": 139, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1.4000000000000008, -1.9000000000000012, -1.700000000000001, -1.600000000000001, -2.0000000000000013, -1.4000000000000008, -2.3000000000000016, -1.700000000000001, -1.600000000000001, -1.9000000000000012, -1.5000000000000009, -1.8000000000000012, -1.9000000000000012, -1.600000000000001, -1.5000000000000009, -1.600000000000001, -1.600000000000001, -1.8000000000000012, -1.600000000000001, -2.0000000000000013, -1.9000000000000012, -1.5000000000000009, -2.900000000000002, -2.2000000000000015, -1.8000000000000012, -1.600000000000001, -1.600000000000001, -2.2000000000000015, -1.8000000000000012, -1.600000000000001, -2.1000000000000014, -1.600000000000001, -1.9000000000000012, -1.9000000000000012, -1.8000000000000012, -2.800000000000002, -1.5000000000000009, -1.8000000000000012, -1.600000000000001, -2.0000000000000013, -1.600000000000001, -2.0000000000000013, -1.9000000000000012, -1.700000000000001, -2.0000000000000013, -1.8000000000000012, -2.0000000000000013, -2.1000000000000014, -1.5000000000000009, -1.9000000000000012, -1.700000000000001, -1.700000000000001, -2.4000000000000017, -2.4000000000000017, -1.700000000000001, -1.700000000000001, -1.5000000000000009, -2.3000000000000016, -1.700000000000001, -1.600000000000001, -1.9000000000000012, -2.0000000000000013, -1.8000000000000012, -1.700000000000001, -1.700000000000001, -1.700000000000001, -2.1000000000000014, -2.1000000000000014, -1.5000000000000009, -1.8000000000000012, -1.9000000000000012, -1.5000000000000009, -1.9000000000000012, -1.600000000000001, -1.700000000000001, -1.700000000000001, -1.5000000000000009, -1.9000000000000012, -1.600000000000001, -2.1000000000000014, -2.1000000000000014, -1.5000000000000009, -1.9000000000000012, -1.600000000000001, -2.2000000000000015, -1.600000000000001, -1.5000000000000009, -1.700000000000001, -2.3000000000000016, -1.8000000000000012, -1.8000000000000012, -1.8000000000000012, -1.8000000000000012, -3.3000000000000007, -2.1000000000000014, -2.2000000000000015, -1.700000000000001, -1.9000000000000012, -1.9000000000000012, -2.1000000000000014, -1.5000000000000009, -1.9000000000000012, -1.8000000000000012, -1.700000000000001, -2.3000000000000016, -1.4000000000000008, -1.700000000000001, -1.600000000000001, -1.9000000000000012, -1.700000000000001, -1.700000000000001, -1.600000000000001, -1.8000000000000012, -1.600000000000001, -1.600000000000001, -2.2000000000000015, -1.5000000000000009, -1.8000000000000012, -1.9000000000000012, -1.600000000000001, -2.800000000000002, -2.0000000000000013, -2.5000000000000018, -1.700000000000001, -2.600000000000002, -1.600000000000001, -1.9000000000000012, -1.9000000000000012, -1.8000000000000012, -1.8000000000000012, -1.600000000000001, -1.600000000000001, -1.5000000000000009, -2.1000000000000014, -1.9000000000000012, -1.5000000000000009, -1.700000000000001, -2.0000000000000013, -1.4000000000000008], "episode_lengths": [25, 30, 28, 27, 31, 25, 34, 28, 27, 30, 26, 29, 30, 27, 26, 27, 27, 29, 27, 31, 30, 26, 33, 33, 29, 27, 27, 33, 29, 27, 32, 27, 30, 30, 29, 33, 26, 29, 27, 31, 27, 31, 30, 28, 31, 29, 31, 32, 26, 30, 28, 28, 35, 35, 28, 28, 26, 34, 28, 27, 30, 31, 29, 28, 28, 28, 32, 32, 26, 29, 30, 26, 30, 27, 28, 28, 26, 30, 27, 32, 32, 26, 30, 27, 33, 27, 26, 28, 34, 29, 29, 29, 29, 42, 32, 33, 28, 30, 30, 32, 26, 30, 29, 28, 34, 25, 28, 27, 30, 28, 28, 27, 29, 27, 27, 33, 26, 29, 30, 27, 33, 31, 36, 28, 37, 27, 30, 30, 29, 29, 27, 27, 26, 32, 30, 26, 28, 31, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.33281342862272534, "mean_inference_ms": 0.7386788150322386, "mean_action_processing_ms": 0.07733742895573194, "mean_env_wait_ms": 6.996945672385548, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006713627053679322, "StateBufferConnector_ms": 0.00397833131200118, "ViewRequirementAgentConnector_ms": 0.09203471725793194}}, "episode_reward_max": -1.4000000000000008, "episode_reward_min": -3.3000000000000007, "episode_reward_mean": -1.8338129496402888, "episode_len_mean": 29.18705035971223, "episodes_this_iter": 139, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1.4000000000000008, -1.9000000000000012, -1.700000000000001, -1.600000000000001, -2.0000000000000013, -1.4000000000000008, -2.3000000000000016, -1.700000000000001, -1.600000000000001, -1.9000000000000012, -1.5000000000000009, -1.8000000000000012, -1.9000000000000012, -1.600000000000001, -1.5000000000000009, -1.600000000000001, -1.600000000000001, -1.8000000000000012, -1.600000000000001, -2.0000000000000013, -1.9000000000000012, -1.5000000000000009, -2.900000000000002, -2.2000000000000015, -1.8000000000000012, -1.600000000000001, -1.600000000000001, -2.2000000000000015, -1.8000000000000012, -1.600000000000001, -2.1000000000000014, -1.600000000000001, -1.9000000000000012, -1.9000000000000012, -1.8000000000000012, -2.800000000000002, -1.5000000000000009, -1.8000000000000012, -1.600000000000001, -2.0000000000000013, -1.600000000000001, -2.0000000000000013, -1.9000000000000012, -1.700000000000001, -2.0000000000000013, -1.8000000000000012, -2.0000000000000013, -2.1000000000000014, -1.5000000000000009, -1.9000000000000012, -1.700000000000001, -1.700000000000001, -2.4000000000000017, -2.4000000000000017, -1.700000000000001, -1.700000000000001, -1.5000000000000009, -2.3000000000000016, -1.700000000000001, -1.600000000000001, -1.9000000000000012, -2.0000000000000013, -1.8000000000000012, -1.700000000000001, -1.700000000000001, -1.700000000000001, -2.1000000000000014, -2.1000000000000014, -1.5000000000000009, -1.8000000000000012, -1.9000000000000012, -1.5000000000000009, -1.9000000000000012, -1.600000000000001, -1.700000000000001, -1.700000000000001, -1.5000000000000009, -1.9000000000000012, -1.600000000000001, -2.1000000000000014, -2.1000000000000014, -1.5000000000000009, -1.9000000000000012, -1.600000000000001, -2.2000000000000015, -1.600000000000001, -1.5000000000000009, -1.700000000000001, -2.3000000000000016, -1.8000000000000012, -1.8000000000000012, -1.8000000000000012, -1.8000000000000012, -3.3000000000000007, -2.1000000000000014, -2.2000000000000015, -1.700000000000001, -1.9000000000000012, -1.9000000000000012, -2.1000000000000014, -1.5000000000000009, -1.9000000000000012, -1.8000000000000012, -1.700000000000001, -2.3000000000000016, -1.4000000000000008, -1.700000000000001, -1.600000000000001, -1.9000000000000012, -1.700000000000001, -1.700000000000001, -1.600000000000001, -1.8000000000000012, -1.600000000000001, -1.600000000000001, -2.2000000000000015, -1.5000000000000009, -1.8000000000000012, -1.9000000000000012, -1.600000000000001, -2.800000000000002, -2.0000000000000013, -2.5000000000000018, -1.700000000000001, -2.600000000000002, -1.600000000000001, -1.9000000000000012, -1.9000000000000012, -1.8000000000000012, -1.8000000000000012, -1.600000000000001, -1.600000000000001, -1.5000000000000009, -2.1000000000000014, -1.9000000000000012, -1.5000000000000009, -1.700000000000001, -2.0000000000000013, -1.4000000000000008], "episode_lengths": [25, 30, 28, 27, 31, 25, 34, 28, 27, 30, 26, 29, 30, 27, 26, 27, 27, 29, 27, 31, 30, 26, 33, 33, 29, 27, 27, 33, 29, 27, 32, 27, 30, 30, 29, 33, 26, 29, 27, 31, 27, 31, 30, 28, 31, 29, 31, 32, 26, 30, 28, 28, 35, 35, 28, 28, 26, 34, 28, 27, 30, 31, 29, 28, 28, 28, 32, 32, 26, 29, 30, 26, 30, 27, 28, 28, 26, 30, 27, 32, 32, 26, 30, 27, 33, 27, 26, 28, 34, 29, 29, 29, 29, 42, 32, 33, 28, 30, 30, 32, 26, 30, 29, 28, 34, 25, 28, 27, 30, 28, 28, 27, 29, 27, 27, 33, 26, 29, 30, 27, 33, 31, 36, 28, 37, 27, 30, 30, 29, 29, 27, 27, 26, 32, 30, 26, 28, 31, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.33281342862272534, "mean_inference_ms": 0.7386788150322386, "mean_action_processing_ms": 0.07733742895573194, "mean_env_wait_ms": 6.996945672385548, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006713627053679322, "StateBufferConnector_ms": 0.00397833131200118, "ViewRequirementAgentConnector_ms": 0.09203471725793194}, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 180000, "num_agent_steps_trained": 180000, "num_env_steps_sampled": 180000, "num_env_steps_trained": 180000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 383.13841795033244, "num_env_steps_trained_throughput_per_sec": 383.13841795033244, "timesteps_total": 180000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 180000, "timers": {"training_iteration_time_ms": 9883.875, "sample_time_ms": 6095.094, "load_time_ms": 2.079, "load_throughput": 1923926.47, "learn_time_ms": 3782.594, "learn_throughput": 1057.475, "synch_weights_time_ms": 3.406}, "counters": {"num_env_steps_sampled": 180000, "num_env_steps_trained": 180000, "num_agent_steps_sampled": 180000, "num_agent_steps_trained": 180000}, "done": false, "episodes_total": 3142, "training_iteration": 45, "trial_id": "95ff9_00000", "date": "2024-03-07_12-39-00", "timestamp": 1709833140, "time_this_iter_s": 10.442898750305176, "time_total_s": 419.83549761772156, "pid": 108075, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4d85689f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 419.83549761772156, "iterations_since_restore": 45, "perf": {"cpu_util_percent": 31.04615384615385, "ram_util_percent": 47.98461538461538, "gpu_util_percent0": 0.1323076923076923, "vram_util_percent0": 0.12759164663461536}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.10000000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 0.0495514783656828, "policy_loss": -0.008919280102496506, "vf_loss": 0.05740123570831593, "vf_explained_var": 0.9440108803651666, "kl": 0.010695232296282081, "entropy": 0.24244593171983636, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 42315.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 184000, "num_env_steps_trained": 184000, "num_agent_steps_sampled": 184000, "num_agent_steps_trained": 184000}, "sampler_results": {"episode_reward_max": -1.4000000000000008, "episode_reward_min": -3.5000000000000018, "episode_reward_mean": -1.8110294117647072, "episode_len_mean": 28.948529411764707, "episode_media": {}, "episodes_this_iter": 136, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1.700000000000001, -2.1000000000000014, -1.5000000000000009, -1.4000000000000008, -1.600000000000001, -1.9000000000000012, -1.9000000000000012, -2.0000000000000013, -1.600000000000001, -1.600000000000001, -1.9000000000000012, -1.4000000000000008, -1.8000000000000012, -1.4000000000000008, -1.700000000000001, -1.600000000000001, -2.1000000000000014, -1.8000000000000012, -2.1000000000000014, -1.4000000000000008, -1.600000000000001, -1.4000000000000008, -2.0000000000000013, -1.9000000000000012, -1.9000000000000012, -1.600000000000001, -2.2000000000000015, -2.0000000000000013, -1.9000000000000012, -1.8000000000000012, -2.4000000000000017, -1.8000000000000012, -1.9000000000000012, -1.600000000000001, -3.5000000000000018, -1.4000000000000008, -2.0000000000000013, -1.4000000000000008, -1.700000000000001, -2.0000000000000013, -1.8000000000000012, -1.5000000000000009, -1.9000000000000012, -1.700000000000001, -1.8000000000000012, -1.600000000000001, -1.8000000000000012, -1.600000000000001, -1.8000000000000012, -2.1000000000000014, -1.700000000000001, -1.700000000000001, -1.9000000000000012, -3.200000000000001, -1.600000000000001, -2.0000000000000013, -1.700000000000001, -2.5000000000000018, -1.9000000000000012, -1.8000000000000012, -1.600000000000001, -2.0000000000000013, -1.5000000000000009, -1.8000000000000012, -1.700000000000001, -1.700000000000001, -1.4000000000000008, -2.1000000000000014, -1.8000000000000012, -2.0000000000000013, -1.4000000000000008, -1.600000000000001, -1.8000000000000012, -1.5000000000000009, -1.600000000000001, -2.0000000000000013, -1.9000000000000012, -1.4000000000000008, -1.5000000000000009, -1.5000000000000009, -1.600000000000001, -1.9000000000000012, -1.4000000000000008, -1.600000000000001, -1.600000000000001, -1.600000000000001, -2.5000000000000018, -1.8000000000000012, -1.600000000000001, -1.9000000000000012, -1.4000000000000008, -1.4000000000000008, -2.4000000000000017, -2.0000000000000013, -2.0000000000000013, -1.9000000000000012, -1.700000000000001, -1.600000000000001, -3.1000000000000014, -1.9000000000000012, -1.9000000000000012, -1.700000000000001, -2.1000000000000014, -1.700000000000001, -1.600000000000001, -1.8000000000000012, -2.0000000000000013, -1.8000000000000012, -1.8000000000000012, -2.2000000000000015, -1.700000000000001, -1.4000000000000008, -1.5000000000000009, -1.4000000000000008, -1.5000000000000009, -1.600000000000001, -1.9000000000000012, -2.0000000000000013, -2.600000000000002, -1.8000000000000012, -1.600000000000001, -1.700000000000001, -2.1000000000000014, -2.0000000000000013, -1.600000000000001, -2.0000000000000013, -2.1000000000000014, -1.9000000000000012, -1.8000000000000012, -1.9000000000000012, -2.1000000000000014, -1.9000000000000012, -1.5000000000000009, -1.5000000000000009, -1.9000000000000012, -1.9000000000000012], "episode_lengths": [28, 32, 26, 25, 27, 30, 30, 31, 27, 27, 30, 25, 29, 25, 28, 27, 32, 29, 32, 25, 27, 25, 31, 30, 30, 27, 33, 31, 30, 29, 35, 29, 30, 27, 38, 25, 31, 25, 28, 31, 29, 26, 30, 28, 29, 27, 29, 27, 29, 32, 28, 28, 30, 39, 27, 31, 28, 36, 30, 29, 27, 31, 26, 29, 28, 28, 25, 32, 29, 31, 25, 27, 29, 26, 27, 31, 30, 25, 26, 26, 27, 30, 25, 27, 27, 27, 36, 29, 27, 30, 25, 25, 35, 31, 31, 30, 28, 27, 36, 30, 30, 28, 32, 28, 27, 29, 31, 29, 29, 33, 28, 25, 26, 25, 26, 27, 30, 31, 33, 29, 27, 28, 32, 31, 27, 31, 32, 30, 29, 30, 32, 30, 26, 26, 30, 30]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3355041314491714, "mean_inference_ms": 0.7389951452931421, "mean_action_processing_ms": 0.0773658236045203, "mean_env_wait_ms": 7.015455283960897, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007028439465691061, "StateBufferConnector_ms": 0.00403295545017018, "ViewRequirementAgentConnector_ms": 0.093382947585162}}, "episode_reward_max": -1.4000000000000008, "episode_reward_min": -3.5000000000000018, "episode_reward_mean": -1.8110294117647072, "episode_len_mean": 28.948529411764707, "episodes_this_iter": 136, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1.700000000000001, -2.1000000000000014, -1.5000000000000009, -1.4000000000000008, -1.600000000000001, -1.9000000000000012, -1.9000000000000012, -2.0000000000000013, -1.600000000000001, -1.600000000000001, -1.9000000000000012, -1.4000000000000008, -1.8000000000000012, -1.4000000000000008, -1.700000000000001, -1.600000000000001, -2.1000000000000014, -1.8000000000000012, -2.1000000000000014, -1.4000000000000008, -1.600000000000001, -1.4000000000000008, -2.0000000000000013, -1.9000000000000012, -1.9000000000000012, -1.600000000000001, -2.2000000000000015, -2.0000000000000013, -1.9000000000000012, -1.8000000000000012, -2.4000000000000017, -1.8000000000000012, -1.9000000000000012, -1.600000000000001, -3.5000000000000018, -1.4000000000000008, -2.0000000000000013, -1.4000000000000008, -1.700000000000001, -2.0000000000000013, -1.8000000000000012, -1.5000000000000009, -1.9000000000000012, -1.700000000000001, -1.8000000000000012, -1.600000000000001, -1.8000000000000012, -1.600000000000001, -1.8000000000000012, -2.1000000000000014, -1.700000000000001, -1.700000000000001, -1.9000000000000012, -3.200000000000001, -1.600000000000001, -2.0000000000000013, -1.700000000000001, -2.5000000000000018, -1.9000000000000012, -1.8000000000000012, -1.600000000000001, -2.0000000000000013, -1.5000000000000009, -1.8000000000000012, -1.700000000000001, -1.700000000000001, -1.4000000000000008, -2.1000000000000014, -1.8000000000000012, -2.0000000000000013, -1.4000000000000008, -1.600000000000001, -1.8000000000000012, -1.5000000000000009, -1.600000000000001, -2.0000000000000013, -1.9000000000000012, -1.4000000000000008, -1.5000000000000009, -1.5000000000000009, -1.600000000000001, -1.9000000000000012, -1.4000000000000008, -1.600000000000001, -1.600000000000001, -1.600000000000001, -2.5000000000000018, -1.8000000000000012, -1.600000000000001, -1.9000000000000012, -1.4000000000000008, -1.4000000000000008, -2.4000000000000017, -2.0000000000000013, -2.0000000000000013, -1.9000000000000012, -1.700000000000001, -1.600000000000001, -3.1000000000000014, -1.9000000000000012, -1.9000000000000012, -1.700000000000001, -2.1000000000000014, -1.700000000000001, -1.600000000000001, -1.8000000000000012, -2.0000000000000013, -1.8000000000000012, -1.8000000000000012, -2.2000000000000015, -1.700000000000001, -1.4000000000000008, -1.5000000000000009, -1.4000000000000008, -1.5000000000000009, -1.600000000000001, -1.9000000000000012, -2.0000000000000013, -2.600000000000002, -1.8000000000000012, -1.600000000000001, -1.700000000000001, -2.1000000000000014, -2.0000000000000013, -1.600000000000001, -2.0000000000000013, -2.1000000000000014, -1.9000000000000012, -1.8000000000000012, -1.9000000000000012, -2.1000000000000014, -1.9000000000000012, -1.5000000000000009, -1.5000000000000009, -1.9000000000000012, -1.9000000000000012], "episode_lengths": [28, 32, 26, 25, 27, 30, 30, 31, 27, 27, 30, 25, 29, 25, 28, 27, 32, 29, 32, 25, 27, 25, 31, 30, 30, 27, 33, 31, 30, 29, 35, 29, 30, 27, 38, 25, 31, 25, 28, 31, 29, 26, 30, 28, 29, 27, 29, 27, 29, 32, 28, 28, 30, 39, 27, 31, 28, 36, 30, 29, 27, 31, 26, 29, 28, 28, 25, 32, 29, 31, 25, 27, 29, 26, 27, 31, 30, 25, 26, 26, 27, 30, 25, 27, 27, 27, 36, 29, 27, 30, 25, 25, 35, 31, 31, 30, 28, 27, 36, 30, 30, 28, 32, 28, 27, 29, 31, 29, 29, 33, 28, 25, 26, 25, 26, 27, 30, 31, 33, 29, 27, 28, 32, 31, 27, 31, 32, 30, 29, 30, 32, 30, 26, 26, 30, 30]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3355041314491714, "mean_inference_ms": 0.7389951452931421, "mean_action_processing_ms": 0.0773658236045203, "mean_env_wait_ms": 7.015455283960897, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007028439465691061, "StateBufferConnector_ms": 0.00403295545017018, "ViewRequirementAgentConnector_ms": 0.093382947585162}, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 184000, "num_agent_steps_trained": 184000, "num_env_steps_sampled": 184000, "num_env_steps_trained": 184000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 386.20017300403237, "num_env_steps_trained_throughput_per_sec": 386.20017300403237, "timesteps_total": 184000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 184000, "timers": {"training_iteration_time_ms": 9946.672, "sample_time_ms": 6118.528, "load_time_ms": 2.082, "load_throughput": 1921216.591, "learn_time_ms": 3820.755, "learn_throughput": 1046.913, "synch_weights_time_ms": 4.588}, "counters": {"num_env_steps_sampled": 184000, "num_env_steps_trained": 184000, "num_agent_steps_sampled": 184000, "num_agent_steps_trained": 184000}, "done": false, "episodes_total": 3278, "training_iteration": 46, "trial_id": "95ff9_00000", "date": "2024-03-07_12-39-10", "timestamp": 1709833150, "time_this_iter_s": 10.361519575119019, "time_total_s": 430.1970171928406, "pid": 108075, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4d85689f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 430.1970171928406, "iterations_since_restore": 46, "perf": {"cpu_util_percent": 30.142857142857146, "ram_util_percent": 48.47142857142857, "gpu_util_percent0": 0.14, "vram_util_percent0": 0.12900506882440474}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.10000000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 1.8595800649831622, "policy_loss": 0.004881452639356896, "vf_loss": 1.8519843706100056, "vf_explained_var": 0.564664972918008, "kl": 0.027142488828566323, "entropy": 0.34519010998549, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 43245.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 188000, "num_env_steps_trained": 188000, "num_agent_steps_sampled": 188000, "num_agent_steps_trained": 188000}, "sampler_results": {"episode_reward_max": -1.4000000000000008, "episode_reward_min": -29.599999999999927, "episode_reward_mean": -2.3473684210526318, "episode_len_mean": 32.21052631578947, "episode_media": {}, "episodes_this_iter": 114, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2.5000000000000018, -1.5000000000000009, -1.700000000000001, -2.2000000000000015, -1.8000000000000012, -1.600000000000001, -1.9000000000000012, -1.600000000000001, -1.600000000000001, -1.700000000000001, -29.599999999999927, -1.5000000000000009, -1.700000000000001, -2.1000000000000014, -2.0000000000000013, -1.700000000000001, -1.8000000000000012, -1.600000000000001, -6.099999999999993, -1.9000000000000012, -1.4000000000000008, -1.5000000000000009, -1.8000000000000012, -1.8000000000000012, -1.8000000000000012, -7.499999999999995, -2.0000000000000013, -1.4000000000000008, -1.600000000000001, -2.2000000000000015, -9.199999999999996, -1.8000000000000012, -1.5000000000000009, -2.2000000000000015, -4.299999999999997, -3.1000000000000014, -1.8000000000000012, -1.8000000000000012, -1.700000000000001, -1.700000000000001, -1.5000000000000009, -1.5000000000000009, -2.5000000000000018, -1.8000000000000012, -1.700000000000001, -2.0000000000000013, -1.700000000000001, -1.600000000000001, -2.2000000000000015, -1.700000000000001, -1.600000000000001, -2.0000000000000013, -1.4000000000000008, -1.700000000000001, -2.4000000000000017, -1.700000000000001, -1.700000000000001, -1.600000000000001, -2.2000000000000015, -2.0000000000000013, -1.8000000000000012, -1.600000000000001, -2.2000000000000015, -1.8000000000000012, -6.600000000000005, -2.1000000000000014, -1.8000000000000012, -1.9000000000000012, -1.9000000000000012, -1.9000000000000012, -1.700000000000001, -1.700000000000001, -1.600000000000001, -1.8000000000000012, -1.9000000000000012, -1.9000000000000012, -1.8000000000000012, -1.600000000000001, -1.600000000000001, -2.2000000000000015, -1.600000000000001, -2.0000000000000013, -1.5000000000000009, -1.9000000000000012, -2.1000000000000014, -1.9000000000000012, -1.8000000000000012, -1.5000000000000009, -1.700000000000001, -1.5000000000000009, -2.1000000000000014, -1.9000000000000012, -3.5, -1.8000000000000012, -2.0000000000000013, -1.9000000000000012, -1.5000000000000009, -1.600000000000001, -1.700000000000001, -1.9000000000000012, -1.700000000000001, -1.8000000000000012, -1.600000000000001, -1.8000000000000012, -3.3000000000000007, -1.4000000000000008, -1.8000000000000012, -1.8000000000000012, -1.9000000000000012, -2.2000000000000015, -1.8000000000000012, -1.5000000000000009, -7.400000000000004, -2.1000000000000014], "episode_lengths": [35, 26, 28, 33, 29, 27, 30, 27, 27, 28, 167, 26, 28, 32, 31, 28, 29, 27, 67, 30, 25, 26, 29, 29, 29, 72, 31, 25, 27, 33, 72, 29, 26, 33, 54, 39, 28, 29, 28, 28, 26, 26, 33, 29, 28, 31, 28, 27, 33, 28, 27, 31, 25, 28, 35, 28, 28, 27, 33, 31, 29, 27, 33, 29, 57, 32, 29, 30, 30, 30, 28, 28, 27, 29, 30, 30, 29, 27, 27, 32, 27, 31, 26, 30, 32, 30, 29, 26, 28, 26, 32, 30, 39, 29, 31, 30, 26, 27, 28, 30, 28, 29, 27, 29, 39, 25, 29, 29, 30, 33, 29, 26, 58, 32]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3378093060081992, "mean_inference_ms": 0.739999319267184, "mean_action_processing_ms": 0.07756394403547355, "mean_env_wait_ms": 7.042593727695217, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007334090115731223, "StateBufferConnector_ms": 0.0042664377312911185, "ViewRequirementAgentConnector_ms": 0.09951716975161903}}, "episode_reward_max": -1.4000000000000008, "episode_reward_min": -29.599999999999927, "episode_reward_mean": -2.3473684210526318, "episode_len_mean": 32.21052631578947, "episodes_this_iter": 114, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-2.5000000000000018, -1.5000000000000009, -1.700000000000001, -2.2000000000000015, -1.8000000000000012, -1.600000000000001, -1.9000000000000012, -1.600000000000001, -1.600000000000001, -1.700000000000001, -29.599999999999927, -1.5000000000000009, -1.700000000000001, -2.1000000000000014, -2.0000000000000013, -1.700000000000001, -1.8000000000000012, -1.600000000000001, -6.099999999999993, -1.9000000000000012, -1.4000000000000008, -1.5000000000000009, -1.8000000000000012, -1.8000000000000012, -1.8000000000000012, -7.499999999999995, -2.0000000000000013, -1.4000000000000008, -1.600000000000001, -2.2000000000000015, -9.199999999999996, -1.8000000000000012, -1.5000000000000009, -2.2000000000000015, -4.299999999999997, -3.1000000000000014, -1.8000000000000012, -1.8000000000000012, -1.700000000000001, -1.700000000000001, -1.5000000000000009, -1.5000000000000009, -2.5000000000000018, -1.8000000000000012, -1.700000000000001, -2.0000000000000013, -1.700000000000001, -1.600000000000001, -2.2000000000000015, -1.700000000000001, -1.600000000000001, -2.0000000000000013, -1.4000000000000008, -1.700000000000001, -2.4000000000000017, -1.700000000000001, -1.700000000000001, -1.600000000000001, -2.2000000000000015, -2.0000000000000013, -1.8000000000000012, -1.600000000000001, -2.2000000000000015, -1.8000000000000012, -6.600000000000005, -2.1000000000000014, -1.8000000000000012, -1.9000000000000012, -1.9000000000000012, -1.9000000000000012, -1.700000000000001, -1.700000000000001, -1.600000000000001, -1.8000000000000012, -1.9000000000000012, -1.9000000000000012, -1.8000000000000012, -1.600000000000001, -1.600000000000001, -2.2000000000000015, -1.600000000000001, -2.0000000000000013, -1.5000000000000009, -1.9000000000000012, -2.1000000000000014, -1.9000000000000012, -1.8000000000000012, -1.5000000000000009, -1.700000000000001, -1.5000000000000009, -2.1000000000000014, -1.9000000000000012, -3.5, -1.8000000000000012, -2.0000000000000013, -1.9000000000000012, -1.5000000000000009, -1.600000000000001, -1.700000000000001, -1.9000000000000012, -1.700000000000001, -1.8000000000000012, -1.600000000000001, -1.8000000000000012, -3.3000000000000007, -1.4000000000000008, -1.8000000000000012, -1.8000000000000012, -1.9000000000000012, -2.2000000000000015, -1.8000000000000012, -1.5000000000000009, -7.400000000000004, -2.1000000000000014], "episode_lengths": [35, 26, 28, 33, 29, 27, 30, 27, 27, 28, 167, 26, 28, 32, 31, 28, 29, 27, 67, 30, 25, 26, 29, 29, 29, 72, 31, 25, 27, 33, 72, 29, 26, 33, 54, 39, 28, 29, 28, 28, 26, 26, 33, 29, 28, 31, 28, 27, 33, 28, 27, 31, 25, 28, 35, 28, 28, 27, 33, 31, 29, 27, 33, 29, 57, 32, 29, 30, 30, 30, 28, 28, 27, 29, 30, 30, 29, 27, 27, 32, 27, 31, 26, 30, 32, 30, 29, 26, 28, 26, 32, 30, 39, 29, 31, 30, 26, 27, 28, 30, 28, 29, 27, 29, 39, 25, 29, 29, 30, 33, 29, 26, 58, 32]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3378093060081992, "mean_inference_ms": 0.739999319267184, "mean_action_processing_ms": 0.07756394403547355, "mean_env_wait_ms": 7.042593727695217, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007334090115731223, "StateBufferConnector_ms": 0.0042664377312911185, "ViewRequirementAgentConnector_ms": 0.09951716975161903}, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 188000, "num_agent_steps_trained": 188000, "num_env_steps_sampled": 188000, "num_env_steps_trained": 188000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 388.6539165638405, "num_env_steps_trained_throughput_per_sec": 388.6539165638405, "timesteps_total": 188000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 188000, "timers": {"training_iteration_time_ms": 9999.768, "sample_time_ms": 6156.831, "load_time_ms": 2.091, "load_throughput": 1913394.387, "learn_time_ms": 3835.525, "learn_throughput": 1042.882, "synch_weights_time_ms": 4.597}, "counters": {"num_env_steps_sampled": 188000, "num_env_steps_trained": 188000, "num_agent_steps_sampled": 188000, "num_agent_steps_trained": 188000}, "done": false, "episodes_total": 3392, "training_iteration": 47, "trial_id": "95ff9_00000", "date": "2024-03-07_12-39-21", "timestamp": 1709833161, "time_this_iter_s": 10.294851303100586, "time_total_s": 440.49186849594116, "pid": 108075, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4d85689f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 440.49186849594116, "iterations_since_restore": 47, "perf": {"cpu_util_percent": 33.53076923076924, "ram_util_percent": 48.853846153846156, "gpu_util_percent0": 0.14307692307692307, "vram_util_percent0": 0.13193609775641024}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.15, "cur_lr": 0.0010000000000000005, "total_loss": 2.780271193026615, "policy_loss": -3.1960523256691556e-05, "vf_loss": 2.7792124908667817, "vf_explained_var": 0.38924821538309895, "kl": 0.0072711096200969785, "entropy": 0.428442702642692, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 44175.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 192000, "num_env_steps_trained": 192000, "num_agent_steps_sampled": 192000, "num_agent_steps_trained": 192000}, "sampler_results": {"episode_reward_max": -1.4000000000000008, "episode_reward_min": -76.30000000000055, "episode_reward_mean": -4.0840000000000085, "episode_len_mean": 41.55, "episode_media": {}, "episodes_this_iter": 99, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2.1000000000000014, -76.30000000000055, -1.600000000000001, -1.5000000000000009, -1.4000000000000008, -1.600000000000001, -1.700000000000001, -1.700000000000001, -1.9000000000000012, -6.499999999999989, -1.700000000000001, -2.0000000000000013, -1.600000000000001, -1.4000000000000008, -1.700000000000001, -1.600000000000001, -1.8000000000000012, -2.2000000000000015, -1.700000000000001, -2.0000000000000013, -1.700000000000001, -1.9000000000000012, -1.5000000000000009, -1.700000000000001, -1.700000000000001, -1.4000000000000008, -1.9000000000000012, -1.8000000000000012, -1.9000000000000012, -1.8000000000000012, -1.5000000000000009, -1.5000000000000009, -1.8000000000000012, -1.700000000000001, -2.2000000000000015, -1.700000000000001, -2.1000000000000014, -1.9000000000000012, -1.8000000000000012, -1.4000000000000008, -2.0000000000000013, -1.600000000000001, -45.90000000000015, -1.8000000000000012, -1.8000000000000012, -1.5000000000000009, -1.8000000000000012, -5.2999999999999945, -1.5000000000000009, -1.8000000000000012, -1.9000000000000012, -2.0000000000000013, -8.99999999999998, -1.700000000000001, -1.700000000000001, -1.8000000000000012, -1.8000000000000012, -1.700000000000001, -1.9000000000000012, -1.4000000000000008, -2.1000000000000014, -1.8000000000000012, -1.600000000000001, -1.700000000000001, -1.8000000000000012, -41.800000000000075, -2.2000000000000015, -1.9000000000000012, -1.700000000000001, -2.2000000000000015, -15.699999999999974, -1.600000000000001, -2.3000000000000016, -1.9000000000000012, -2.2000000000000015, -41.20000000000008, -1.4000000000000008, -2.900000000000002, -1.4000000000000008, -1.5000000000000009, -1.8000000000000012, -1.5000000000000009, -1.5000000000000009, -1.700000000000001, -1.8000000000000012, -1.8000000000000012, -2.0000000000000013, -2.3000000000000016, -2.700000000000002, -1.5000000000000009, -1.600000000000001, -3.6000000000000023, -1.600000000000001, -1.9000000000000012, -1.8000000000000012, -2.2000000000000015, -1.4000000000000008, -2.0000000000000013, -2.0000000000000013, -2.0000000000000013], "episode_lengths": [32, 400, 27, 26, 25, 27, 28, 28, 30, 76, 28, 31, 27, 25, 28, 27, 29, 33, 28, 31, 28, 30, 26, 28, 28, 25, 30, 29, 30, 29, 26, 26, 29, 28, 33, 28, 32, 30, 29, 25, 31, 27, 283, 29, 29, 26, 29, 61, 26, 29, 30, 31, 99, 28, 28, 29, 29, 28, 30, 25, 32, 29, 27, 28, 29, 229, 33, 30, 28, 33, 104, 27, 34, 30, 33, 240, 25, 35, 25, 26, 29, 26, 26, 28, 29, 29, 31, 34, 34, 26, 27, 40, 27, 30, 29, 33, 25, 31, 31, 31]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.338162098154624, "mean_inference_ms": 0.7401197403007674, "mean_action_processing_ms": 0.07749811643876708, "mean_env_wait_ms": 7.0544721037338896, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006718873977661133, "StateBufferConnector_ms": 0.003948688507080078, "ViewRequirementAgentConnector_ms": 0.09190726280212402}}, "episode_reward_max": -1.4000000000000008, "episode_reward_min": -76.30000000000055, "episode_reward_mean": -4.0840000000000085, "episode_len_mean": 41.55, "episodes_this_iter": 99, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-2.1000000000000014, -76.30000000000055, -1.600000000000001, -1.5000000000000009, -1.4000000000000008, -1.600000000000001, -1.700000000000001, -1.700000000000001, -1.9000000000000012, -6.499999999999989, -1.700000000000001, -2.0000000000000013, -1.600000000000001, -1.4000000000000008, -1.700000000000001, -1.600000000000001, -1.8000000000000012, -2.2000000000000015, -1.700000000000001, -2.0000000000000013, -1.700000000000001, -1.9000000000000012, -1.5000000000000009, -1.700000000000001, -1.700000000000001, -1.4000000000000008, -1.9000000000000012, -1.8000000000000012, -1.9000000000000012, -1.8000000000000012, -1.5000000000000009, -1.5000000000000009, -1.8000000000000012, -1.700000000000001, -2.2000000000000015, -1.700000000000001, -2.1000000000000014, -1.9000000000000012, -1.8000000000000012, -1.4000000000000008, -2.0000000000000013, -1.600000000000001, -45.90000000000015, -1.8000000000000012, -1.8000000000000012, -1.5000000000000009, -1.8000000000000012, -5.2999999999999945, -1.5000000000000009, -1.8000000000000012, -1.9000000000000012, -2.0000000000000013, -8.99999999999998, -1.700000000000001, -1.700000000000001, -1.8000000000000012, -1.8000000000000012, -1.700000000000001, -1.9000000000000012, -1.4000000000000008, -2.1000000000000014, -1.8000000000000012, -1.600000000000001, -1.700000000000001, -1.8000000000000012, -41.800000000000075, -2.2000000000000015, -1.9000000000000012, -1.700000000000001, -2.2000000000000015, -15.699999999999974, -1.600000000000001, -2.3000000000000016, -1.9000000000000012, -2.2000000000000015, -41.20000000000008, -1.4000000000000008, -2.900000000000002, -1.4000000000000008, -1.5000000000000009, -1.8000000000000012, -1.5000000000000009, -1.5000000000000009, -1.700000000000001, -1.8000000000000012, -1.8000000000000012, -2.0000000000000013, -2.3000000000000016, -2.700000000000002, -1.5000000000000009, -1.600000000000001, -3.6000000000000023, -1.600000000000001, -1.9000000000000012, -1.8000000000000012, -2.2000000000000015, -1.4000000000000008, -2.0000000000000013, -2.0000000000000013, -2.0000000000000013], "episode_lengths": [32, 400, 27, 26, 25, 27, 28, 28, 30, 76, 28, 31, 27, 25, 28, 27, 29, 33, 28, 31, 28, 30, 26, 28, 28, 25, 30, 29, 30, 29, 26, 26, 29, 28, 33, 28, 32, 30, 29, 25, 31, 27, 283, 29, 29, 26, 29, 61, 26, 29, 30, 31, 99, 28, 28, 29, 29, 28, 30, 25, 32, 29, 27, 28, 29, 229, 33, 30, 28, 33, 104, 27, 34, 30, 33, 240, 25, 35, 25, 26, 29, 26, 26, 28, 29, 29, 31, 34, 34, 26, 27, 40, 27, 30, 29, 33, 25, 31, 31, 31]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.338162098154624, "mean_inference_ms": 0.7401197403007674, "mean_action_processing_ms": 0.07749811643876708, "mean_env_wait_ms": 7.0544721037338896, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006718873977661133, "StateBufferConnector_ms": 0.003948688507080078, "ViewRequirementAgentConnector_ms": 0.09190726280212402}, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 192000, "num_agent_steps_trained": 192000, "num_env_steps_sampled": 192000, "num_env_steps_trained": 192000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 400.43539658215354, "num_env_steps_trained_throughput_per_sec": 400.43539658215354, "timesteps_total": 192000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 192000, "timers": {"training_iteration_time_ms": 9988.593, "sample_time_ms": 6154.632, "load_time_ms": 2.09, "load_throughput": 1913612.629, "learn_time_ms": 3827.816, "learn_throughput": 1044.982, "synch_weights_time_ms": 3.344}, "counters": {"num_env_steps_sampled": 192000, "num_env_steps_trained": 192000, "num_agent_steps_sampled": 192000, "num_agent_steps_trained": 192000}, "done": false, "episodes_total": 3491, "training_iteration": 48, "trial_id": "95ff9_00000", "date": "2024-03-07_12-39-31", "timestamp": 1709833171, "time_this_iter_s": 9.991710186004639, "time_total_s": 450.4835786819458, "pid": 108075, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4d85689f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 450.4835786819458, "iterations_since_restore": 48, "perf": {"cpu_util_percent": 28.3076923076923, "ram_util_percent": 48.815384615384616, "gpu_util_percent0": 0.11, "vram_util_percent0": 0.1311285556891026}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.15, "cur_lr": 0.0010000000000000005, "total_loss": 1.609111380569076, "policy_loss": 0.0023139630334191425, "vf_loss": 1.6059364258301674, "vf_explained_var": 0.6234289984549245, "kl": 0.005739894248441881, "entropy": 0.33872240124851144, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 45105.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 196000, "num_env_steps_trained": 196000, "num_agent_steps_sampled": 196000, "num_agent_steps_trained": 196000}, "sampler_results": {"episode_reward_max": -1.4000000000000008, "episode_reward_min": -70.20000000000049, "episode_reward_mean": -3.1191304347826176, "episode_len_mean": 36.66086956521739, "episode_media": {}, "episodes_this_iter": 115, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2.0000000000000013, -1.700000000000001, -2.0000000000000013, -1.700000000000001, -1.5000000000000009, -1.700000000000001, -1.4000000000000008, -1.600000000000001, -1.700000000000001, -1.4000000000000008, -1.9000000000000012, -1.5000000000000009, -1.600000000000001, -1.5000000000000009, -1.5000000000000009, -1.8000000000000012, -2.1000000000000014, -1.700000000000001, -1.700000000000001, -1.700000000000001, -1.5000000000000009, -1.8000000000000012, -1.9000000000000012, -1.600000000000001, -68.70000000000044, -1.9000000000000012, -1.9000000000000012, -1.600000000000001, -1.9000000000000012, -2.4000000000000017, -1.600000000000001, -1.5000000000000009, -2.1000000000000014, -1.600000000000001, -2.0000000000000013, -1.9000000000000012, -1.700000000000001, -1.5000000000000009, -1.700000000000001, -3.4000000000000004, -1.600000000000001, -1.700000000000001, -1.600000000000001, -70.20000000000049, -1.600000000000001, -2.0000000000000013, -1.9000000000000012, -1.5000000000000009, -2.0000000000000013, -2.4000000000000017, -1.700000000000001, -1.8000000000000012, -13.299999999999969, -1.8000000000000012, -1.8000000000000012, -1.700000000000001, -1.5000000000000009, -1.600000000000001, -1.8000000000000012, -1.9000000000000012, -2.1000000000000014, -1.8000000000000012, -1.700000000000001, -1.600000000000001, -1.700000000000001, -1.8000000000000012, -1.5000000000000009, -2.1000000000000014, -9.999999999999984, -1.700000000000001, -1.5000000000000009, -2.0000000000000013, -1.700000000000001, -1.9000000000000012, -1.5000000000000009, -1.5000000000000009, -1.700000000000001, -1.5000000000000009, -1.8000000000000012, -2.2000000000000015, -1.700000000000001, -1.600000000000001, -1.700000000000001, -1.9000000000000012, -1.5000000000000009, -1.4000000000000008, -1.9000000000000012, -1.700000000000001, -2.3000000000000016, -1.4000000000000008, -1.5000000000000009, -1.5000000000000009, -1.600000000000001, -1.5000000000000009, -1.8000000000000012, -1.5000000000000009, -2.3000000000000016, -1.600000000000001, -1.4000000000000008, -1.8000000000000012, -1.600000000000001, -1.9000000000000012, -2.3000000000000016, -2.1000000000000014, -1.9000000000000012, -2.3000000000000016, -1.8000000000000012, -1.8000000000000012, -1.700000000000001, -2.1000000000000014, -1.700000000000001, -1.5000000000000009, -1.700000000000001, -2.1000000000000014, -2.0000000000000013], "episode_lengths": [31, 28, 31, 28, 26, 28, 25, 27, 28, 25, 30, 26, 27, 26, 26, 29, 32, 28, 28, 28, 26, 29, 30, 27, 400, 30, 30, 27, 30, 35, 27, 26, 32, 27, 31, 30, 28, 26, 28, 41, 27, 28, 27, 400, 27, 31, 30, 26, 31, 35, 28, 29, 132, 29, 29, 28, 26, 27, 29, 30, 32, 29, 28, 27, 28, 29, 26, 32, 103, 28, 26, 31, 28, 30, 26, 26, 28, 26, 29, 33, 28, 27, 28, 30, 26, 25, 29, 28, 34, 25, 26, 26, 27, 26, 29, 26, 34, 27, 25, 29, 27, 30, 34, 32, 30, 34, 29, 29, 28, 32, 28, 26, 28, 32, 31]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3396476444644239, "mean_inference_ms": 0.7407014441148229, "mean_action_processing_ms": 0.07736616271171586, "mean_env_wait_ms": 7.061344911547131, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006780831710152004, "StateBufferConnector_ms": 0.004010200500488281, "ViewRequirementAgentConnector_ms": 0.09299381919529127}}, "episode_reward_max": -1.4000000000000008, "episode_reward_min": -70.20000000000049, "episode_reward_mean": -3.1191304347826176, "episode_len_mean": 36.66086956521739, "episodes_this_iter": 115, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-2.0000000000000013, -1.700000000000001, -2.0000000000000013, -1.700000000000001, -1.5000000000000009, -1.700000000000001, -1.4000000000000008, -1.600000000000001, -1.700000000000001, -1.4000000000000008, -1.9000000000000012, -1.5000000000000009, -1.600000000000001, -1.5000000000000009, -1.5000000000000009, -1.8000000000000012, -2.1000000000000014, -1.700000000000001, -1.700000000000001, -1.700000000000001, -1.5000000000000009, -1.8000000000000012, -1.9000000000000012, -1.600000000000001, -68.70000000000044, -1.9000000000000012, -1.9000000000000012, -1.600000000000001, -1.9000000000000012, -2.4000000000000017, -1.600000000000001, -1.5000000000000009, -2.1000000000000014, -1.600000000000001, -2.0000000000000013, -1.9000000000000012, -1.700000000000001, -1.5000000000000009, -1.700000000000001, -3.4000000000000004, -1.600000000000001, -1.700000000000001, -1.600000000000001, -70.20000000000049, -1.600000000000001, -2.0000000000000013, -1.9000000000000012, -1.5000000000000009, -2.0000000000000013, -2.4000000000000017, -1.700000000000001, -1.8000000000000012, -13.299999999999969, -1.8000000000000012, -1.8000000000000012, -1.700000000000001, -1.5000000000000009, -1.600000000000001, -1.8000000000000012, -1.9000000000000012, -2.1000000000000014, -1.8000000000000012, -1.700000000000001, -1.600000000000001, -1.700000000000001, -1.8000000000000012, -1.5000000000000009, -2.1000000000000014, -9.999999999999984, -1.700000000000001, -1.5000000000000009, -2.0000000000000013, -1.700000000000001, -1.9000000000000012, -1.5000000000000009, -1.5000000000000009, -1.700000000000001, -1.5000000000000009, -1.8000000000000012, -2.2000000000000015, -1.700000000000001, -1.600000000000001, -1.700000000000001, -1.9000000000000012, -1.5000000000000009, -1.4000000000000008, -1.9000000000000012, -1.700000000000001, -2.3000000000000016, -1.4000000000000008, -1.5000000000000009, -1.5000000000000009, -1.600000000000001, -1.5000000000000009, -1.8000000000000012, -1.5000000000000009, -2.3000000000000016, -1.600000000000001, -1.4000000000000008, -1.8000000000000012, -1.600000000000001, -1.9000000000000012, -2.3000000000000016, -2.1000000000000014, -1.9000000000000012, -2.3000000000000016, -1.8000000000000012, -1.8000000000000012, -1.700000000000001, -2.1000000000000014, -1.700000000000001, -1.5000000000000009, -1.700000000000001, -2.1000000000000014, -2.0000000000000013], "episode_lengths": [31, 28, 31, 28, 26, 28, 25, 27, 28, 25, 30, 26, 27, 26, 26, 29, 32, 28, 28, 28, 26, 29, 30, 27, 400, 30, 30, 27, 30, 35, 27, 26, 32, 27, 31, 30, 28, 26, 28, 41, 27, 28, 27, 400, 27, 31, 30, 26, 31, 35, 28, 29, 132, 29, 29, 28, 26, 27, 29, 30, 32, 29, 28, 27, 28, 29, 26, 32, 103, 28, 26, 31, 28, 30, 26, 26, 28, 26, 29, 33, 28, 27, 28, 30, 26, 25, 29, 28, 34, 25, 26, 26, 27, 26, 29, 26, 34, 27, 25, 29, 27, 30, 34, 32, 30, 34, 29, 29, 28, 32, 28, 26, 28, 32, 31]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3396476444644239, "mean_inference_ms": 0.7407014441148229, "mean_action_processing_ms": 0.07736616271171586, "mean_env_wait_ms": 7.061344911547131, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006780831710152004, "StateBufferConnector_ms": 0.004010200500488281, "ViewRequirementAgentConnector_ms": 0.09299381919529127}, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 196000, "num_agent_steps_trained": 196000, "num_env_steps_sampled": 196000, "num_env_steps_trained": 196000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 397.71952735304126, "num_env_steps_trained_throughput_per_sec": 397.71952735304126, "timesteps_total": 196000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 196000, "timers": {"training_iteration_time_ms": 10027.527, "sample_time_ms": 6158.801, "load_time_ms": 1.007, "load_throughput": 3970844.714, "learn_time_ms": 3863.67, "learn_throughput": 1035.285, "synch_weights_time_ms": 3.345}, "counters": {"num_env_steps_sampled": 196000, "num_env_steps_trained": 196000, "num_agent_steps_sampled": 196000, "num_agent_steps_trained": 196000}, "done": false, "episodes_total": 3606, "training_iteration": 49, "trial_id": "95ff9_00000", "date": "2024-03-07_12-39-41", "timestamp": 1709833181, "time_this_iter_s": 10.060304641723633, "time_total_s": 460.54388332366943, "pid": 108075, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4d85689f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 460.54388332366943, "iterations_since_restore": 49, "perf": {"cpu_util_percent": 29.684615384615388, "ram_util_percent": 48.70000000000001, "gpu_util_percent0": 0.12692307692307692, "vram_util_percent0": 0.13077799479166669}}
{"evaluation": {"sampler_results": {"episode_reward_max": -1.4000000000000008, "episode_reward_min": -2.1000000000000014, "episode_reward_mean": -1.7600000000000011, "episode_len_mean": 28.6, "episode_media": {}, "episodes_this_iter": 20, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1.8000000000000012, -1.8000000000000012, -1.600000000000001, -1.8000000000000012, -2.1000000000000014, -1.600000000000001, -1.8000000000000012, -1.9000000000000012, -2.0000000000000013, -2.0000000000000013, -1.8000000000000012, -1.8000000000000012, -1.600000000000001, -1.5000000000000009, -1.600000000000001, -1.600000000000001, -1.700000000000001, -1.4000000000000008, -1.8000000000000012, -2.0000000000000013], "episode_lengths": [29, 29, 27, 29, 32, 27, 29, 30, 31, 31, 29, 29, 27, 26, 27, 27, 28, 25, 29, 31]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4383298531044632, "mean_inference_ms": 1.4950871259546195, "mean_action_processing_ms": 0.08011280346083183, "mean_env_wait_ms": 7.592527862202642, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0074803829193115234, "StateBufferConnector_ms": 0.003846883773803711, "ViewRequirementAgentConnector_ms": 0.08654952049255371}}, "episode_reward_max": -1.4000000000000008, "episode_reward_min": -2.1000000000000014, "episode_reward_mean": -1.7600000000000011, "episode_len_mean": 28.6, "episode_media": {}, "episodes_this_iter": 20, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1.8000000000000012, -1.8000000000000012, -1.600000000000001, -1.8000000000000012, -2.1000000000000014, -1.600000000000001, -1.8000000000000012, -1.9000000000000012, -2.0000000000000013, -2.0000000000000013, -1.8000000000000012, -1.8000000000000012, -1.600000000000001, -1.5000000000000009, -1.600000000000001, -1.600000000000001, -1.700000000000001, -1.4000000000000008, -1.8000000000000012, -2.0000000000000013], "episode_lengths": [29, 29, 27, 29, 32, 27, 29, 30, 31, 31, 29, 29, 27, 26, 27, 27, 28, 25, 29, 31]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4383298531044632, "mean_inference_ms": 1.4950871259546195, "mean_action_processing_ms": 0.08011280346083183, "mean_env_wait_ms": 7.592527862202642, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0074803829193115234, "StateBufferConnector_ms": 0.003846883773803711, "ViewRequirementAgentConnector_ms": 0.08654952049255371}, "num_agent_steps_sampled_this_iter": 572, "num_env_steps_sampled_this_iter": 572, "timesteps_this_iter": 572, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.15, "cur_lr": 0.0010000000000000005, "total_loss": 1.544506990090601, "policy_loss": -0.010870440632745783, "vf_loss": 1.5541609184010334, "vf_explained_var": 0.4978574236874939, "kl": 0.00811007609768331, "entropy": 0.353681038159837, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 46035.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 200000, "num_env_steps_trained": 200000, "num_agent_steps_sampled": 200000, "num_agent_steps_trained": 200000}, "sampler_results": {"episode_reward_max": -1.4000000000000008, "episode_reward_min": -62.80000000000038, "episode_reward_mean": -2.7622807017543898, "episode_len_mean": 34.59649122807018, "episode_media": {}, "episodes_this_iter": 114, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2.1000000000000014, -2.1000000000000014, -1.8000000000000012, -1.4000000000000008, -1.700000000000001, -62.80000000000038, -2.0000000000000013, -20.899999999999956, -2.2000000000000015, -2.1000000000000014, -2.900000000000002, -1.5000000000000009, -1.4000000000000008, -1.4000000000000008, -1.9000000000000012, -1.700000000000001, -1.700000000000001, -2.3000000000000016, -1.5000000000000009, -1.600000000000001, -1.700000000000001, -1.700000000000001, -1.700000000000001, -1.9000000000000012, -2.3000000000000016, -1.9000000000000012, -1.600000000000001, -2.1000000000000014, -7.900000000000002, -1.700000000000001, -1.8000000000000012, -8.999999999999998, -1.5000000000000009, -1.700000000000001, -1.8000000000000012, -1.8000000000000012, -1.5000000000000009, -2.1000000000000014, -1.5000000000000009, -1.8000000000000012, -1.9000000000000012, -1.9000000000000012, -1.700000000000001, -2.0000000000000013, -2.3000000000000016, -1.9000000000000012, -1.8000000000000012, -1.700000000000001, -2.4000000000000017, -1.8000000000000012, -1.600000000000001, -1.8000000000000012, -1.8000000000000012, -1.600000000000001, -1.8000000000000012, -1.4000000000000008, -1.700000000000001, -2.3000000000000016, -16.099999999999984, -1.700000000000001, -1.9000000000000012, -1.5000000000000009, -1.9000000000000012, -2.0000000000000013, -2.0000000000000013, -2.900000000000002, -1.9000000000000012, -1.5000000000000009, -2.700000000000002, -1.700000000000001, -2.0000000000000013, -1.700000000000001, -1.4000000000000008, -1.600000000000001, -1.700000000000001, -1.5000000000000009, -1.600000000000001, -1.8000000000000012, -1.600000000000001, -2.0000000000000013, -1.700000000000001, -1.8000000000000012, -1.8000000000000012, -2.0000000000000013, -2.1000000000000014, -2.1000000000000014, -1.600000000000001, -1.600000000000001, -1.9000000000000012, -1.600000000000001, -1.4000000000000008, -1.5000000000000009, -1.8000000000000012, -1.600000000000001, -1.600000000000001, -1.5000000000000009, -2.1000000000000014, -1.9000000000000012, -2.1000000000000014, -2.4000000000000017, -2.3000000000000016, -2.1000000000000014, -1.700000000000001, -1.5000000000000009, -1.9000000000000012, -2.1000000000000014, -1.9000000000000012, -2.0000000000000013, -1.600000000000001, -1.4000000000000008, -1.600000000000001, -1.5000000000000009, -1.5000000000000009, -1.600000000000001], "episode_lengths": [32, 32, 29, 25, 28, 350, 31, 132, 33, 32, 39, 26, 25, 25, 30, 28, 28, 34, 26, 27, 28, 28, 28, 30, 34, 30, 27, 32, 60, 28, 29, 70, 26, 28, 29, 29, 26, 32, 26, 29, 30, 30, 28, 31, 34, 30, 29, 28, 35, 29, 27, 29, 29, 27, 29, 25, 28, 34, 152, 28, 30, 26, 30, 31, 31, 40, 30, 26, 38, 28, 31, 28, 25, 27, 28, 26, 27, 29, 27, 31, 28, 29, 29, 31, 32, 32, 27, 27, 30, 27, 25, 26, 29, 27, 27, 26, 32, 30, 32, 35, 34, 32, 28, 26, 30, 32, 30, 31, 27, 25, 27, 26, 26, 27]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.34259024980969977, "mean_inference_ms": 0.7409470878831163, "mean_action_processing_ms": 0.07758571779762478, "mean_env_wait_ms": 7.083828361032449, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007065764644689727, "StateBufferConnector_ms": 0.004033247629801433, "ViewRequirementAgentConnector_ms": 0.09507442775525544}}, "episode_reward_max": -1.4000000000000008, "episode_reward_min": -62.80000000000038, "episode_reward_mean": -2.7622807017543898, "episode_len_mean": 34.59649122807018, "episodes_this_iter": 114, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-2.1000000000000014, -2.1000000000000014, -1.8000000000000012, -1.4000000000000008, -1.700000000000001, -62.80000000000038, -2.0000000000000013, -20.899999999999956, -2.2000000000000015, -2.1000000000000014, -2.900000000000002, -1.5000000000000009, -1.4000000000000008, -1.4000000000000008, -1.9000000000000012, -1.700000000000001, -1.700000000000001, -2.3000000000000016, -1.5000000000000009, -1.600000000000001, -1.700000000000001, -1.700000000000001, -1.700000000000001, -1.9000000000000012, -2.3000000000000016, -1.9000000000000012, -1.600000000000001, -2.1000000000000014, -7.900000000000002, -1.700000000000001, -1.8000000000000012, -8.999999999999998, -1.5000000000000009, -1.700000000000001, -1.8000000000000012, -1.8000000000000012, -1.5000000000000009, -2.1000000000000014, -1.5000000000000009, -1.8000000000000012, -1.9000000000000012, -1.9000000000000012, -1.700000000000001, -2.0000000000000013, -2.3000000000000016, -1.9000000000000012, -1.8000000000000012, -1.700000000000001, -2.4000000000000017, -1.8000000000000012, -1.600000000000001, -1.8000000000000012, -1.8000000000000012, -1.600000000000001, -1.8000000000000012, -1.4000000000000008, -1.700000000000001, -2.3000000000000016, -16.099999999999984, -1.700000000000001, -1.9000000000000012, -1.5000000000000009, -1.9000000000000012, -2.0000000000000013, -2.0000000000000013, -2.900000000000002, -1.9000000000000012, -1.5000000000000009, -2.700000000000002, -1.700000000000001, -2.0000000000000013, -1.700000000000001, -1.4000000000000008, -1.600000000000001, -1.700000000000001, -1.5000000000000009, -1.600000000000001, -1.8000000000000012, -1.600000000000001, -2.0000000000000013, -1.700000000000001, -1.8000000000000012, -1.8000000000000012, -2.0000000000000013, -2.1000000000000014, -2.1000000000000014, -1.600000000000001, -1.600000000000001, -1.9000000000000012, -1.600000000000001, -1.4000000000000008, -1.5000000000000009, -1.8000000000000012, -1.600000000000001, -1.600000000000001, -1.5000000000000009, -2.1000000000000014, -1.9000000000000012, -2.1000000000000014, -2.4000000000000017, -2.3000000000000016, -2.1000000000000014, -1.700000000000001, -1.5000000000000009, -1.9000000000000012, -2.1000000000000014, -1.9000000000000012, -2.0000000000000013, -1.600000000000001, -1.4000000000000008, -1.600000000000001, -1.5000000000000009, -1.5000000000000009, -1.600000000000001], "episode_lengths": [32, 32, 29, 25, 28, 350, 31, 132, 33, 32, 39, 26, 25, 25, 30, 28, 28, 34, 26, 27, 28, 28, 28, 30, 34, 30, 27, 32, 60, 28, 29, 70, 26, 28, 29, 29, 26, 32, 26, 29, 30, 30, 28, 31, 34, 30, 29, 28, 35, 29, 27, 29, 29, 27, 29, 25, 28, 34, 152, 28, 30, 26, 30, 31, 31, 40, 30, 26, 38, 28, 31, 28, 25, 27, 28, 26, 27, 29, 27, 31, 28, 29, 29, 31, 32, 32, 27, 27, 30, 27, 25, 26, 29, 27, 27, 26, 32, 30, 32, 35, 34, 32, 28, 26, 30, 32, 30, 31, 27, 25, 27, 26, 26, 27]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.34259024980969977, "mean_inference_ms": 0.7409470878831163, "mean_action_processing_ms": 0.07758571779762478, "mean_env_wait_ms": 7.083828361032449, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007065764644689727, "StateBufferConnector_ms": 0.004033247629801433, "ViewRequirementAgentConnector_ms": 0.09507442775525544}, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 200000, "num_agent_steps_trained": 200000, "num_env_steps_sampled": 200000, "num_env_steps_trained": 200000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 386.4286494608898, "num_env_steps_trained_throughput_per_sec": 386.4286494608898, "timesteps_total": 200000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 200000, "timers": {"training_iteration_time_ms": 10053.107, "sample_time_ms": 6164.251, "load_time_ms": 1.039, "load_throughput": 3849221.31, "learn_time_ms": 3883.771, "learn_throughput": 1029.927, "synch_weights_time_ms": 3.332}, "counters": {"num_env_steps_sampled": 200000, "num_env_steps_trained": 200000, "num_agent_steps_sampled": 200000, "num_agent_steps_trained": 200000}, "done": true, "episodes_total": 3720, "training_iteration": 50, "trial_id": "95ff9_00000", "date": "2024-03-07_12-39-57", "timestamp": 1709833197, "time_this_iter_s": 15.873148918151855, "time_total_s": 476.4170322418213, "pid": 108075, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4d85689f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 476.4170322418213, "iterations_since_restore": 50, "perf": {"cpu_util_percent": 24.71, "ram_util_percent": 48.69, "gpu_util_percent0": 0.12000000000000002, "vram_util_percent0": 0.13093668619791665}}
