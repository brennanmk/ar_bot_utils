{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 7.843715408801912, "policy_loss": 0.006284824626580361, "vf_loss": 7.835979947159367, "vf_explained_var": -0.019919007760222242, "kl": 0.007253140059757438, "entropy": 1.0910616436312275, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 465.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000}, "sampler_results": {"episode_reward_max": -6.39999999999999, "episode_reward_min": -72.00000000000047, "episode_reward_mean": -45.78000000000024, "episode_len_mean": 303.9, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-71.30000000000048, -59.900000000000404, -15.799999999999972, -48.30000000000022, -66.70000000000047, -6.39999999999999, -72.00000000000047, -15.599999999999966, -39.70000000000012, -62.10000000000036], "episode_lengths": [400, 400, 152, 400, 400, 75, 400, 132, 280, 400]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23467683506583023, "mean_inference_ms": 0.7261555589839607, "mean_action_processing_ms": 0.07798538474503629, "mean_env_wait_ms": 6.275724127383051, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008168220520019531, "StateBufferConnector_ms": 0.004000663757324219, "ViewRequirementAgentConnector_ms": 0.09359121322631836}}, "episode_reward_max": -6.39999999999999, "episode_reward_min": -72.00000000000047, "episode_reward_mean": -45.78000000000024, "episode_len_mean": 303.9, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-71.30000000000048, -59.900000000000404, -15.799999999999972, -48.30000000000022, -66.70000000000047, -6.39999999999999, -72.00000000000047, -15.599999999999966, -39.70000000000012, -62.10000000000036], "episode_lengths": [400, 400, 152, 400, 400, 75, 400, 132, 280, 400]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23467683506583023, "mean_inference_ms": 0.7261555589839607, "mean_action_processing_ms": 0.07798538474503629, "mean_env_wait_ms": 6.275724127383051, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008168220520019531, "StateBufferConnector_ms": 0.004000663757324219, "ViewRequirementAgentConnector_ms": 0.09359121322631836}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 550.7962394663258, "num_env_steps_trained_throughput_per_sec": 550.7962394663258, "timesteps_total": 4000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 4000, "timers": {"training_iteration_time_ms": 7262.142, "sample_time_ms": 3804.081, "load_time_ms": 0.917, "load_throughput": 4363385.176, "learn_time_ms": 3453.74, "learn_throughput": 1158.165, "synch_weights_time_ms": 2.553}, "counters": {"num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000}, "done": false, "episodes_total": 10, "training_iteration": 1, "trial_id": "2154c_00000", "date": "2024-03-07_13-04-39", "timestamp": 1709834679, "time_this_iter_s": 7.26465106010437, "time_total_s": 7.26465106010437, "pid": 116529, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7efea6399f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 7.26465106010437, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 28.130000000000003, "ram_util_percent": 50.14, "gpu_util_percent0": 0.078, "vram_util_percent0": 0.1033203125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 5.7329935897021524, "policy_loss": -0.002743912998947405, "vf_loss": 5.7345611145099005, "vf_explained_var": -0.13608019172504385, "kl": 0.005881943650970347, "entropy": 1.0856309853574282, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 1395.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000}, "sampler_results": {"episode_reward_max": -5.699999999999992, "episode_reward_min": -73.60000000000035, "episode_reward_mean": -41.7304347826089, "episode_len_mean": 292.0, "episode_media": {}, "episodes_this_iter": 13, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-71.30000000000048, -59.900000000000404, -15.799999999999972, -48.30000000000022, -66.70000000000047, -6.39999999999999, -72.00000000000047, -15.599999999999966, -39.70000000000012, -62.10000000000036, -24.39999999999997, -13.199999999999966, -29.599999999999948, -51.90000000000021, -9.09999999999998, -58.800000000000445, -5.699999999999992, -63.40000000000037, -44.700000000000315, -56.10000000000043, -15.299999999999976, -73.60000000000035, -56.20000000000028], "episode_lengths": [400, 400, 152, 400, 400, 75, 400, 132, 280, 400, 198, 133, 240, 400, 99, 400, 68, 400, 400, 400, 139, 400, 400]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23501667891379804, "mean_inference_ms": 0.7269966829460823, "mean_action_processing_ms": 0.07796562019739073, "mean_env_wait_ms": 6.279286815625833, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007734091385551121, "StateBufferConnector_ms": 0.0039245771325152855, "ViewRequirementAgentConnector_ms": 0.09140657341998557}}, "episode_reward_max": -5.699999999999992, "episode_reward_min": -73.60000000000035, "episode_reward_mean": -41.7304347826089, "episode_len_mean": 292.0, "episodes_this_iter": 13, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-71.30000000000048, -59.900000000000404, -15.799999999999972, -48.30000000000022, -66.70000000000047, -6.39999999999999, -72.00000000000047, -15.599999999999966, -39.70000000000012, -62.10000000000036, -24.39999999999997, -13.199999999999966, -29.599999999999948, -51.90000000000021, -9.09999999999998, -58.800000000000445, -5.699999999999992, -63.40000000000037, -44.700000000000315, -56.10000000000043, -15.299999999999976, -73.60000000000035, -56.20000000000028], "episode_lengths": [400, 400, 152, 400, 400, 75, 400, 132, 280, 400, 198, 133, 240, 400, 99, 400, 68, 400, 400, 400, 139, 400, 400]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23501667891379804, "mean_inference_ms": 0.7269966829460823, "mean_action_processing_ms": 0.07796562019739073, "mean_env_wait_ms": 6.279286815625833, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007734091385551121, "StateBufferConnector_ms": 0.0039245771325152855, "ViewRequirementAgentConnector_ms": 0.09140657341998557}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 546.7117586451656, "num_env_steps_trained_throughput_per_sec": 546.7117586451656, "timesteps_total": 8000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 8000, "timers": {"training_iteration_time_ms": 7289.29, "sample_time_ms": 3756.666, "load_time_ms": 0.919, "load_throughput": 4351502.01, "learn_time_ms": 3528.466, "learn_throughput": 1133.637, "synch_weights_time_ms": 2.506}, "counters": {"num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000}, "done": false, "episodes_total": 23, "training_iteration": 2, "trial_id": "2154c_00000", "date": "2024-03-07_13-04-46", "timestamp": 1709834686, "time_this_iter_s": 7.318694353103638, "time_total_s": 14.583345413208008, "pid": 116529, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7efea6399f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 14.583345413208008, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 31.477777777777778, "ram_util_percent": 50.43333333333333, "gpu_util_percent0": 0.0788888888888889, "vram_util_percent0": 0.10369646990740741}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 4.435125327010148, "policy_loss": -0.004171348467308988, "vf_loss": 4.438032779626308, "vf_explained_var": -0.12364124181450054, "kl": 0.006319507887690301, "entropy": 1.0770410064728029, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 2325.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000}, "sampler_results": {"episode_reward_max": -5.699999999999992, "episode_reward_min": -73.60000000000035, "episode_reward_mean": -41.47142857142879, "episode_len_mean": 301.14285714285717, "episode_media": {}, "episodes_this_iter": 12, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-71.30000000000048, -59.900000000000404, -15.799999999999972, -48.30000000000022, -66.70000000000047, -6.39999999999999, -72.00000000000047, -15.599999999999966, -39.70000000000012, -62.10000000000036, -24.39999999999997, -13.199999999999966, -29.599999999999948, -51.90000000000021, -9.09999999999998, -58.800000000000445, -5.699999999999992, -63.40000000000037, -44.700000000000315, -56.10000000000043, -15.299999999999976, -73.60000000000035, -56.20000000000028, -7.699999999999985, -54.90000000000041, -48.10000000000026, -45.40000000000029, -48.90000000000033, -48.300000000000225, -9.799999999999983, -58.000000000000455, -19.3, -58.40000000000042, -43.80000000000019, -49.10000000000036], "episode_lengths": [400, 400, 152, 400, 400, 75, 400, 132, 280, 400, 198, 133, 240, 400, 99, 400, 68, 400, 400, 400, 139, 400, 400, 86, 400, 400, 400, 375, 400, 101, 400, 158, 400, 304, 400]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2346404694513379, "mean_inference_ms": 0.7263412796166431, "mean_action_processing_ms": 0.07779467057731014, "mean_env_wait_ms": 6.280003916644539, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0076116834368024555, "StateBufferConnector_ms": 0.0038882664271763395, "ViewRequirementAgentConnector_ms": 0.08964402335030693}}, "episode_reward_max": -5.699999999999992, "episode_reward_min": -73.60000000000035, "episode_reward_mean": -41.47142857142879, "episode_len_mean": 301.14285714285717, "episodes_this_iter": 12, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-71.30000000000048, -59.900000000000404, -15.799999999999972, -48.30000000000022, -66.70000000000047, -6.39999999999999, -72.00000000000047, -15.599999999999966, -39.70000000000012, -62.10000000000036, -24.39999999999997, -13.199999999999966, -29.599999999999948, -51.90000000000021, -9.09999999999998, -58.800000000000445, -5.699999999999992, -63.40000000000037, -44.700000000000315, -56.10000000000043, -15.299999999999976, -73.60000000000035, -56.20000000000028, -7.699999999999985, -54.90000000000041, -48.10000000000026, -45.40000000000029, -48.90000000000033, -48.300000000000225, -9.799999999999983, -58.000000000000455, -19.3, -58.40000000000042, -43.80000000000019, -49.10000000000036], "episode_lengths": [400, 400, 152, 400, 400, 75, 400, 132, 280, 400, 198, 133, 240, 400, 99, 400, 68, 400, 400, 400, 139, 400, 400, 86, 400, 400, 400, 375, 400, 101, 400, 158, 400, 304, 400]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2346404694513379, "mean_inference_ms": 0.7263412796166431, "mean_action_processing_ms": 0.07779467057731014, "mean_env_wait_ms": 6.280003916644539, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0076116834368024555, "StateBufferConnector_ms": 0.0038882664271763395, "ViewRequirementAgentConnector_ms": 0.08964402335030693}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 543.9808901976859, "num_env_steps_trained_throughput_per_sec": 543.9808901976859, "timesteps_total": 12000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 12000, "timers": {"training_iteration_time_ms": 7310.583, "sample_time_ms": 3789.829, "load_time_ms": 0.923, "load_throughput": 4334078.016, "learn_time_ms": 3516.409, "learn_throughput": 1137.524, "synch_weights_time_ms": 2.726}, "counters": {"num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000}, "done": false, "episodes_total": 35, "training_iteration": 3, "trial_id": "2154c_00000", "date": "2024-03-07_13-04-53", "timestamp": 1709834693, "time_this_iter_s": 7.355475664138794, "time_total_s": 21.9388210773468, "pid": 116529, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7efea6399f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 21.9388210773468, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 28.55, "ram_util_percent": 50.5, "gpu_util_percent0": 0.081, "vram_util_percent0": 0.10371907552083333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 5.181328371391501, "policy_loss": 0.007373846202127395, "vf_loss": 5.172563068600752, "vf_explained_var": -0.19505880904454057, "kl": 0.006957273092270654, "entropy": 1.0734718871373001, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 3255.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000}, "sampler_results": {"episode_reward_max": -5.699999999999992, "episode_reward_min": -73.60000000000035, "episode_reward_mean": -42.1553191489364, "episode_len_mean": 307.8723404255319, "episode_media": {}, "episodes_this_iter": 12, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-71.30000000000048, -59.900000000000404, -15.799999999999972, -48.30000000000022, -66.70000000000047, -6.39999999999999, -72.00000000000047, -15.599999999999966, -39.70000000000012, -62.10000000000036, -24.39999999999997, -13.199999999999966, -29.599999999999948, -51.90000000000021, -9.09999999999998, -58.800000000000445, -5.699999999999992, -63.40000000000037, -44.700000000000315, -56.10000000000043, -15.299999999999976, -73.60000000000035, -56.20000000000028, -7.699999999999985, -54.90000000000041, -48.10000000000026, -45.40000000000029, -48.90000000000033, -48.300000000000225, -9.799999999999983, -58.000000000000455, -19.3, -58.40000000000042, -43.80000000000019, -49.10000000000036, -51.70000000000028, -52.200000000000266, -52.700000000000365, -7.599999999999985, -63.40000000000042, -59.60000000000042, -18.399999999999984, -59.500000000000405, -5.8999999999999915, -59.300000000000296, -50.40000000000021, -49.100000000000385], "episode_lengths": [400, 400, 152, 400, 400, 75, 400, 132, 280, 400, 198, 133, 240, 400, 99, 400, 68, 400, 400, 400, 139, 400, 400, 86, 400, 400, 400, 375, 400, 101, 400, 158, 400, 304, 400, 400, 400, 400, 86, 400, 400, 174, 400, 70, 400, 400, 400]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23457070888676154, "mean_inference_ms": 0.7260010610913397, "mean_action_processing_ms": 0.07762216844569042, "mean_env_wait_ms": 6.290143468411018, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0075609125989548704, "StateBufferConnector_ms": 0.0038882519336456947, "ViewRequirementAgentConnector_ms": 0.08962458752571269}}, "episode_reward_max": -5.699999999999992, "episode_reward_min": -73.60000000000035, "episode_reward_mean": -42.1553191489364, "episode_len_mean": 307.8723404255319, "episodes_this_iter": 12, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-71.30000000000048, -59.900000000000404, -15.799999999999972, -48.30000000000022, -66.70000000000047, -6.39999999999999, -72.00000000000047, -15.599999999999966, -39.70000000000012, -62.10000000000036, -24.39999999999997, -13.199999999999966, -29.599999999999948, -51.90000000000021, -9.09999999999998, -58.800000000000445, -5.699999999999992, -63.40000000000037, -44.700000000000315, -56.10000000000043, -15.299999999999976, -73.60000000000035, -56.20000000000028, -7.699999999999985, -54.90000000000041, -48.10000000000026, -45.40000000000029, -48.90000000000033, -48.300000000000225, -9.799999999999983, -58.000000000000455, -19.3, -58.40000000000042, -43.80000000000019, -49.10000000000036, -51.70000000000028, -52.200000000000266, -52.700000000000365, -7.599999999999985, -63.40000000000042, -59.60000000000042, -18.399999999999984, -59.500000000000405, -5.8999999999999915, -59.300000000000296, -50.40000000000021, -49.100000000000385], "episode_lengths": [400, 400, 152, 400, 400, 75, 400, 132, 280, 400, 198, 133, 240, 400, 99, 400, 68, 400, 400, 400, 139, 400, 400, 86, 400, 400, 400, 375, 400, 101, 400, 158, 400, 304, 400, 400, 400, 400, 86, 400, 400, 174, 400, 70, 400, 400, 400]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23457070888676154, "mean_inference_ms": 0.7260010610913397, "mean_action_processing_ms": 0.07762216844569042, "mean_env_wait_ms": 6.290143468411018, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0075609125989548704, "StateBufferConnector_ms": 0.0038882519336456947, "ViewRequirementAgentConnector_ms": 0.08962458752571269}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 543.3347877561242, "num_env_steps_trained_throughput_per_sec": 543.3347877561242, "timesteps_total": 16000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 16000, "timers": {"training_iteration_time_ms": 7323.412, "sample_time_ms": 3806.648, "load_time_ms": 0.932, "load_throughput": 4291122.45, "learn_time_ms": 3512.354, "learn_throughput": 1138.837, "synch_weights_time_ms": 2.788}, "counters": {"num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000}, "done": false, "episodes_total": 47, "training_iteration": 4, "trial_id": "2154c_00000", "date": "2024-03-07_13-05-01", "timestamp": 1709834701, "time_this_iter_s": 7.364198684692383, "time_total_s": 29.303019762039185, "pid": 116529, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7efea6399f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 29.303019762039185, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 30.71111111111111, "ram_util_percent": 50.5, "gpu_util_percent0": 0.07777777777777778, "vram_util_percent0": 0.1037326388888889}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 4.46725450459347, "policy_loss": -0.014456799438083043, "vf_loss": 4.480376157212642, "vf_explained_var": -0.043858748097573556, "kl": 0.006675831508144164, "entropy": 1.0610228870504645, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 4185.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 20000}, "sampler_results": {"episode_reward_max": -4.299999999999997, "episode_reward_min": -73.60000000000035, "episode_reward_mean": -39.69523809523831, "episode_len_mean": 297.76190476190476, "episode_media": {}, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-71.30000000000048, -59.900000000000404, -15.799999999999972, -48.30000000000022, -66.70000000000047, -6.39999999999999, -72.00000000000047, -15.599999999999966, -39.70000000000012, -62.10000000000036, -24.39999999999997, -13.199999999999966, -29.599999999999948, -51.90000000000021, -9.09999999999998, -58.800000000000445, -5.699999999999992, -63.40000000000037, -44.700000000000315, -56.10000000000043, -15.299999999999976, -73.60000000000035, -56.20000000000028, -7.699999999999985, -54.90000000000041, -48.10000000000026, -45.40000000000029, -48.90000000000033, -48.300000000000225, -9.799999999999983, -58.000000000000455, -19.3, -58.40000000000042, -43.80000000000019, -49.10000000000036, -51.70000000000028, -52.200000000000266, -52.700000000000365, -7.599999999999985, -63.40000000000042, -59.60000000000042, -18.399999999999984, -59.500000000000405, -5.8999999999999915, -59.300000000000296, -50.40000000000021, -49.100000000000385, -42.800000000000246, -44.200000000000344, -15.499999999999964, -11.099999999999978, -18.599999999999962, -14.199999999999964, -49.00000000000036, -37.70000000000022, -58.500000000000306, -47.00000000000027, -63.10000000000037, -6.899999999999988, -28.099999999999987, -46.10000000000026, -32.40000000000018, -4.299999999999997], "episode_lengths": [400, 400, 152, 400, 400, 75, 400, 132, 280, 400, 198, 133, 240, 400, 99, 400, 68, 400, 400, 400, 139, 400, 400, 86, 400, 400, 400, 375, 400, 101, 400, 158, 400, 304, 400, 400, 400, 400, 86, 400, 400, 174, 400, 70, 400, 400, 400, 373, 390, 145, 117, 177, 131, 400, 329, 377, 400, 400, 80, 215, 400, 301, 54]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23437941736624535, "mean_inference_ms": 0.7255265915981197, "mean_action_processing_ms": 0.07742627732715927, "mean_env_wait_ms": 6.293696850228738, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007317936609661769, "StateBufferConnector_ms": 0.0038900072612459697, "ViewRequirementAgentConnector_ms": 0.08950309147910467}}, "episode_reward_max": -4.299999999999997, "episode_reward_min": -73.60000000000035, "episode_reward_mean": -39.69523809523831, "episode_len_mean": 297.76190476190476, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-71.30000000000048, -59.900000000000404, -15.799999999999972, -48.30000000000022, -66.70000000000047, -6.39999999999999, -72.00000000000047, -15.599999999999966, -39.70000000000012, -62.10000000000036, -24.39999999999997, -13.199999999999966, -29.599999999999948, -51.90000000000021, -9.09999999999998, -58.800000000000445, -5.699999999999992, -63.40000000000037, -44.700000000000315, -56.10000000000043, -15.299999999999976, -73.60000000000035, -56.20000000000028, -7.699999999999985, -54.90000000000041, -48.10000000000026, -45.40000000000029, -48.90000000000033, -48.300000000000225, -9.799999999999983, -58.000000000000455, -19.3, -58.40000000000042, -43.80000000000019, -49.10000000000036, -51.70000000000028, -52.200000000000266, -52.700000000000365, -7.599999999999985, -63.40000000000042, -59.60000000000042, -18.399999999999984, -59.500000000000405, -5.8999999999999915, -59.300000000000296, -50.40000000000021, -49.100000000000385, -42.800000000000246, -44.200000000000344, -15.499999999999964, -11.099999999999978, -18.599999999999962, -14.199999999999964, -49.00000000000036, -37.70000000000022, -58.500000000000306, -47.00000000000027, -63.10000000000037, -6.899999999999988, -28.099999999999987, -46.10000000000026, -32.40000000000018, -4.299999999999997], "episode_lengths": [400, 400, 152, 400, 400, 75, 400, 132, 280, 400, 198, 133, 240, 400, 99, 400, 68, 400, 400, 400, 139, 400, 400, 86, 400, 400, 400, 375, 400, 101, 400, 158, 400, 304, 400, 400, 400, 400, 86, 400, 400, 174, 400, 70, 400, 400, 400, 373, 390, 145, 117, 177, 131, 400, 329, 377, 400, 400, 80, 215, 400, 301, 54]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23437941736624535, "mean_inference_ms": 0.7255265915981197, "mean_action_processing_ms": 0.07742627732715927, "mean_env_wait_ms": 6.293696850228738, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007317936609661769, "StateBufferConnector_ms": 0.0038900072612459697, "ViewRequirementAgentConnector_ms": 0.08950309147910467}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 20000, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 550.3016894966056, "num_env_steps_trained_throughput_per_sec": 550.3016894966056, "timesteps_total": 20000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 20000, "timers": {"training_iteration_time_ms": 7312.469, "sample_time_ms": 3800.788, "load_time_ms": 0.921, "load_throughput": 4341929.607, "learn_time_ms": 3507.346, "learn_throughput": 1140.463, "synch_weights_time_ms": 2.732}, "counters": {"num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 20000}, "done": false, "episodes_total": 63, "training_iteration": 5, "trial_id": "2154c_00000", "date": "2024-03-07_13-05-08", "timestamp": 1709834708, "time_this_iter_s": 7.271168231964111, "time_total_s": 36.574187994003296, "pid": 116529, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7efea6399f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 36.574187994003296, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 28.540000000000003, "ram_util_percent": 50.510000000000005, "gpu_util_percent0": 0.10799999999999998, "vram_util_percent0": 0.1037109375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 5.412574676864891, "policy_loss": 0.00521644722590203, "vf_loss": 5.406439113681034, "vf_explained_var": -0.07828944107537629, "kl": 0.004595534199259827, "entropy": 1.0547233777661478, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 5115.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000}, "sampler_results": {"episode_reward_max": -4.299999999999997, "episode_reward_min": -73.60000000000035, "episode_reward_mean": -36.18809523809542, "episode_len_mean": 279.25, "episode_media": {}, "episodes_this_iter": 21, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-71.30000000000048, -59.900000000000404, -15.799999999999972, -48.30000000000022, -66.70000000000047, -6.39999999999999, -72.00000000000047, -15.599999999999966, -39.70000000000012, -62.10000000000036, -24.39999999999997, -13.199999999999966, -29.599999999999948, -51.90000000000021, -9.09999999999998, -58.800000000000445, -5.699999999999992, -63.40000000000037, -44.700000000000315, -56.10000000000043, -15.299999999999976, -73.60000000000035, -56.20000000000028, -7.699999999999985, -54.90000000000041, -48.10000000000026, -45.40000000000029, -48.90000000000033, -48.300000000000225, -9.799999999999983, -58.000000000000455, -19.3, -58.40000000000042, -43.80000000000019, -49.10000000000036, -51.70000000000028, -52.200000000000266, -52.700000000000365, -7.599999999999985, -63.40000000000042, -59.60000000000042, -18.399999999999984, -59.500000000000405, -5.8999999999999915, -59.300000000000296, -50.40000000000021, -49.100000000000385, -42.800000000000246, -44.200000000000344, -15.499999999999964, -11.099999999999978, -18.599999999999962, -14.199999999999964, -49.00000000000036, -37.70000000000022, -58.500000000000306, -47.00000000000027, -63.10000000000037, -6.899999999999988, -28.099999999999987, -46.10000000000026, -32.40000000000018, -4.299999999999997, -28.100000000000083, -42.40000000000026, -49.30000000000031, -10.499999999999977, -9.699999999999982, -48.50000000000028, -12.19999999999998, -4.999999999999995, -7.499999999999988, -21.999999999999968, -11.399999999999972, -46.10000000000034, -50.30000000000027, -15.999999999999975, -46.80000000000034, -17.900000000000002, -13.199999999999969, -7.599999999999985, -17.79999999999998, -27.900000000000098, -48.80000000000026], "episode_lengths": [400, 400, 152, 400, 400, 75, 400, 132, 280, 400, 198, 133, 240, 400, 99, 400, 68, 400, 400, 400, 139, 400, 400, 86, 400, 400, 400, 375, 400, 101, 400, 158, 400, 304, 400, 400, 400, 400, 86, 400, 400, 174, 400, 70, 400, 400, 400, 373, 390, 145, 117, 177, 131, 400, 329, 377, 400, 400, 80, 215, 400, 301, 54, 273, 400, 400, 102, 97, 400, 109, 61, 80, 156, 125, 400, 400, 120, 400, 186, 128, 77, 140, 244, 400]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2352474196608591, "mean_inference_ms": 0.7251827164352862, "mean_action_processing_ms": 0.07726456379788307, "mean_env_wait_ms": 6.30611140007161, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007208188374837239, "StateBufferConnector_ms": 0.003882816859654018, "ViewRequirementAgentConnector_ms": 0.0894078186580113}}, "episode_reward_max": -4.299999999999997, "episode_reward_min": -73.60000000000035, "episode_reward_mean": -36.18809523809542, "episode_len_mean": 279.25, "episodes_this_iter": 21, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-71.30000000000048, -59.900000000000404, -15.799999999999972, -48.30000000000022, -66.70000000000047, -6.39999999999999, -72.00000000000047, -15.599999999999966, -39.70000000000012, -62.10000000000036, -24.39999999999997, -13.199999999999966, -29.599999999999948, -51.90000000000021, -9.09999999999998, -58.800000000000445, -5.699999999999992, -63.40000000000037, -44.700000000000315, -56.10000000000043, -15.299999999999976, -73.60000000000035, -56.20000000000028, -7.699999999999985, -54.90000000000041, -48.10000000000026, -45.40000000000029, -48.90000000000033, -48.300000000000225, -9.799999999999983, -58.000000000000455, -19.3, -58.40000000000042, -43.80000000000019, -49.10000000000036, -51.70000000000028, -52.200000000000266, -52.700000000000365, -7.599999999999985, -63.40000000000042, -59.60000000000042, -18.399999999999984, -59.500000000000405, -5.8999999999999915, -59.300000000000296, -50.40000000000021, -49.100000000000385, -42.800000000000246, -44.200000000000344, -15.499999999999964, -11.099999999999978, -18.599999999999962, -14.199999999999964, -49.00000000000036, -37.70000000000022, -58.500000000000306, -47.00000000000027, -63.10000000000037, -6.899999999999988, -28.099999999999987, -46.10000000000026, -32.40000000000018, -4.299999999999997, -28.100000000000083, -42.40000000000026, -49.30000000000031, -10.499999999999977, -9.699999999999982, -48.50000000000028, -12.19999999999998, -4.999999999999995, -7.499999999999988, -21.999999999999968, -11.399999999999972, -46.10000000000034, -50.30000000000027, -15.999999999999975, -46.80000000000034, -17.900000000000002, -13.199999999999969, -7.599999999999985, -17.79999999999998, -27.900000000000098, -48.80000000000026], "episode_lengths": [400, 400, 152, 400, 400, 75, 400, 132, 280, 400, 198, 133, 240, 400, 99, 400, 68, 400, 400, 400, 139, 400, 400, 86, 400, 400, 400, 375, 400, 101, 400, 158, 400, 304, 400, 400, 400, 400, 86, 400, 400, 174, 400, 70, 400, 400, 400, 373, 390, 145, 117, 177, 131, 400, 329, 377, 400, 400, 80, 215, 400, 301, 54, 273, 400, 400, 102, 97, 400, 109, 61, 80, 156, 125, 400, 400, 120, 400, 186, 128, 77, 140, 244, 400]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2352474196608591, "mean_inference_ms": 0.7251827164352862, "mean_action_processing_ms": 0.07726456379788307, "mean_env_wait_ms": 6.30611140007161, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007208188374837239, "StateBufferConnector_ms": 0.003882816859654018, "ViewRequirementAgentConnector_ms": 0.0894078186580113}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 529.9014949270884, "num_env_steps_trained_throughput_per_sec": 529.9014949270884, "timesteps_total": 24000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 24000, "timers": {"training_iteration_time_ms": 7351.814, "sample_time_ms": 3820.458, "load_time_ms": 0.907, "load_throughput": 4409448.333, "learn_time_ms": 3527.07, "learn_throughput": 1134.086, "synch_weights_time_ms": 2.702}, "counters": {"num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000}, "done": false, "episodes_total": 84, "training_iteration": 6, "trial_id": "2154c_00000", "date": "2024-03-07_13-05-15", "timestamp": 1709834715, "time_this_iter_s": 7.551146507263184, "time_total_s": 44.12533450126648, "pid": 116529, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7efea6399f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 44.12533450126648, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 28.999999999999993, "ram_util_percent": 50.5, "gpu_util_percent0": 0.083, "vram_util_percent0": 0.10370279947916665}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.10000000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 4.692889493896115, "policy_loss": -0.010867787016335353, "vf_loss": 4.702961717674168, "vf_explained_var": -0.3508220966785185, "kl": 0.007955749974671415, "entropy": 1.0322590351745646, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 6045.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 28000}, "sampler_results": {"episode_reward_max": -3.200000000000001, "episode_reward_min": -73.60000000000035, "episode_reward_mean": -33.567000000000164, "episode_len_mean": 264.17, "episode_media": {}, "episodes_this_iter": 17, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-59.900000000000404, -15.799999999999972, -48.30000000000022, -66.70000000000047, -6.39999999999999, -72.00000000000047, -15.599999999999966, -39.70000000000012, -62.10000000000036, -24.39999999999997, -13.199999999999966, -29.599999999999948, -51.90000000000021, -9.09999999999998, -58.800000000000445, -5.699999999999992, -63.40000000000037, -44.700000000000315, -56.10000000000043, -15.299999999999976, -73.60000000000035, -56.20000000000028, -7.699999999999985, -54.90000000000041, -48.10000000000026, -45.40000000000029, -48.90000000000033, -48.300000000000225, -9.799999999999983, -58.000000000000455, -19.3, -58.40000000000042, -43.80000000000019, -49.10000000000036, -51.70000000000028, -52.200000000000266, -52.700000000000365, -7.599999999999985, -63.40000000000042, -59.60000000000042, -18.399999999999984, -59.500000000000405, -5.8999999999999915, -59.300000000000296, -50.40000000000021, -49.100000000000385, -42.800000000000246, -44.200000000000344, -15.499999999999964, -11.099999999999978, -18.599999999999962, -14.199999999999964, -49.00000000000036, -37.70000000000022, -58.500000000000306, -47.00000000000027, -63.10000000000037, -6.899999999999988, -28.099999999999987, -46.10000000000026, -32.40000000000018, -4.299999999999997, -28.100000000000083, -42.40000000000026, -49.30000000000031, -10.499999999999977, -9.699999999999982, -48.50000000000028, -12.19999999999998, -4.999999999999995, -7.499999999999988, -21.999999999999968, -11.399999999999972, -46.10000000000034, -50.30000000000027, -15.999999999999975, -46.80000000000034, -17.900000000000002, -13.199999999999969, -7.599999999999985, -17.79999999999998, -27.900000000000098, -48.80000000000026, -48.600000000000236, -3.200000000000001, -10.499999999999984, -42.00000000000014, -46.70000000000035, -6.49999999999999, -8.599999999999993, -40.80000000000016, -4.799999999999995, -46.70000000000029, -19.099999999999962, -44.80000000000032, -21.39999999999998, -6.999999999999995, -13.799999999999963, -9.599999999999978, -14.099999999999962], "episode_lengths": [400, 152, 400, 400, 75, 400, 132, 280, 400, 198, 133, 240, 400, 99, 400, 68, 400, 400, 400, 139, 400, 400, 86, 400, 400, 400, 375, 400, 101, 400, 158, 400, 304, 400, 400, 400, 400, 86, 400, 400, 174, 400, 70, 400, 400, 400, 373, 390, 145, 117, 177, 131, 400, 329, 377, 400, 400, 80, 215, 400, 301, 54, 273, 400, 400, 102, 97, 400, 109, 61, 80, 156, 125, 400, 400, 120, 400, 186, 128, 77, 140, 244, 400, 400, 43, 93, 299, 400, 75, 85, 349, 59, 400, 159, 400, 159, 73, 130, 100, 136]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2356252146357921, "mean_inference_ms": 0.7247579276270895, "mean_action_processing_ms": 0.07711026446867368, "mean_env_wait_ms": 6.311409484061148, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007110118865966797, "StateBufferConnector_ms": 0.003874540328979492, "ViewRequirementAgentConnector_ms": 0.0895235538482666}}, "episode_reward_max": -3.200000000000001, "episode_reward_min": -73.60000000000035, "episode_reward_mean": -33.567000000000164, "episode_len_mean": 264.17, "episodes_this_iter": 17, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-59.900000000000404, -15.799999999999972, -48.30000000000022, -66.70000000000047, -6.39999999999999, -72.00000000000047, -15.599999999999966, -39.70000000000012, -62.10000000000036, -24.39999999999997, -13.199999999999966, -29.599999999999948, -51.90000000000021, -9.09999999999998, -58.800000000000445, -5.699999999999992, -63.40000000000037, -44.700000000000315, -56.10000000000043, -15.299999999999976, -73.60000000000035, -56.20000000000028, -7.699999999999985, -54.90000000000041, -48.10000000000026, -45.40000000000029, -48.90000000000033, -48.300000000000225, -9.799999999999983, -58.000000000000455, -19.3, -58.40000000000042, -43.80000000000019, -49.10000000000036, -51.70000000000028, -52.200000000000266, -52.700000000000365, -7.599999999999985, -63.40000000000042, -59.60000000000042, -18.399999999999984, -59.500000000000405, -5.8999999999999915, -59.300000000000296, -50.40000000000021, -49.100000000000385, -42.800000000000246, -44.200000000000344, -15.499999999999964, -11.099999999999978, -18.599999999999962, -14.199999999999964, -49.00000000000036, -37.70000000000022, -58.500000000000306, -47.00000000000027, -63.10000000000037, -6.899999999999988, -28.099999999999987, -46.10000000000026, -32.40000000000018, -4.299999999999997, -28.100000000000083, -42.40000000000026, -49.30000000000031, -10.499999999999977, -9.699999999999982, -48.50000000000028, -12.19999999999998, -4.999999999999995, -7.499999999999988, -21.999999999999968, -11.399999999999972, -46.10000000000034, -50.30000000000027, -15.999999999999975, -46.80000000000034, -17.900000000000002, -13.199999999999969, -7.599999999999985, -17.79999999999998, -27.900000000000098, -48.80000000000026, -48.600000000000236, -3.200000000000001, -10.499999999999984, -42.00000000000014, -46.70000000000035, -6.49999999999999, -8.599999999999993, -40.80000000000016, -4.799999999999995, -46.70000000000029, -19.099999999999962, -44.80000000000032, -21.39999999999998, -6.999999999999995, -13.799999999999963, -9.599999999999978, -14.099999999999962], "episode_lengths": [400, 152, 400, 400, 75, 400, 132, 280, 400, 198, 133, 240, 400, 99, 400, 68, 400, 400, 400, 139, 400, 400, 86, 400, 400, 400, 375, 400, 101, 400, 158, 400, 304, 400, 400, 400, 400, 86, 400, 400, 174, 400, 70, 400, 400, 400, 373, 390, 145, 117, 177, 131, 400, 329, 377, 400, 400, 80, 215, 400, 301, 54, 273, 400, 400, 102, 97, 400, 109, 61, 80, 156, 125, 400, 400, 120, 400, 186, 128, 77, 140, 244, 400, 400, 43, 93, 299, 400, 75, 85, 349, 59, 400, 159, 400, 159, 73, 130, 100, 136]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2356252146357921, "mean_inference_ms": 0.7247579276270895, "mean_action_processing_ms": 0.07711026446867368, "mean_env_wait_ms": 6.311409484061148, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007110118865966797, "StateBufferConnector_ms": 0.003874540328979492, "ViewRequirementAgentConnector_ms": 0.0895235538482666}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 28000, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 543.8944957463991, "num_env_steps_trained_throughput_per_sec": 543.8944957463991, "timesteps_total": 28000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 28000, "timers": {"training_iteration_time_ms": 7352.174, "sample_time_ms": 3828.35, "load_time_ms": 0.904, "load_throughput": 4426038.743, "learn_time_ms": 3519.548, "learn_throughput": 1136.51, "synch_weights_time_ms": 2.702}, "counters": {"num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 28000}, "done": false, "episodes_total": 101, "training_iteration": 7, "trial_id": "2154c_00000", "date": "2024-03-07_13-05-23", "timestamp": 1709834723, "time_this_iter_s": 7.356892347335815, "time_total_s": 51.482226848602295, "pid": 116529, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7efea6399f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 51.482226848602295, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 30.488888888888887, "ram_util_percent": 50.6, "gpu_util_percent0": 0.08444444444444445, "vram_util_percent0": 0.10372359664351852}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.10000000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 5.743990162944281, "policy_loss": -0.009058103470071669, "vf_loss": 5.752309742938447, "vf_explained_var": -0.15156658778908433, "kl": 0.007385366289261494, "entropy": 1.0167374959556006, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 6975.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000}, "sampler_results": {"episode_reward_max": -3.200000000000001, "episode_reward_min": -63.40000000000042, "episode_reward_mean": -28.321000000000122, "episode_len_mean": 234.35, "episode_media": {}, "episodes_this_iter": 24, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-48.10000000000026, -45.40000000000029, -48.90000000000033, -48.300000000000225, -9.799999999999983, -58.000000000000455, -19.3, -58.40000000000042, -43.80000000000019, -49.10000000000036, -51.70000000000028, -52.200000000000266, -52.700000000000365, -7.599999999999985, -63.40000000000042, -59.60000000000042, -18.399999999999984, -59.500000000000405, -5.8999999999999915, -59.300000000000296, -50.40000000000021, -49.100000000000385, -42.800000000000246, -44.200000000000344, -15.499999999999964, -11.099999999999978, -18.599999999999962, -14.199999999999964, -49.00000000000036, -37.70000000000022, -58.500000000000306, -47.00000000000027, -63.10000000000037, -6.899999999999988, -28.099999999999987, -46.10000000000026, -32.40000000000018, -4.299999999999997, -28.100000000000083, -42.40000000000026, -49.30000000000031, -10.499999999999977, -9.699999999999982, -48.50000000000028, -12.19999999999998, -4.999999999999995, -7.499999999999988, -21.999999999999968, -11.399999999999972, -46.10000000000034, -50.30000000000027, -15.999999999999975, -46.80000000000034, -17.900000000000002, -13.199999999999969, -7.599999999999985, -17.79999999999998, -27.900000000000098, -48.80000000000026, -48.600000000000236, -3.200000000000001, -10.499999999999984, -42.00000000000014, -46.70000000000035, -6.49999999999999, -8.599999999999993, -40.80000000000016, -4.799999999999995, -46.70000000000029, -19.099999999999962, -44.80000000000032, -21.39999999999998, -6.999999999999995, -13.799999999999963, -9.599999999999978, -14.099999999999962, -15.799999999999972, -5.199999999999994, -7.199999999999987, -46.600000000000335, -7.699999999999987, -7.099999999999991, -5.399999999999993, -11.79999999999997, -54.50000000000029, -8.799999999999986, -11.399999999999975, -6.699999999999989, -5.699999999999993, -3.200000000000001, -48.30000000000037, -9.199999999999983, -4.299999999999997, -37.600000000000165, -24.50000000000009, -4.099999999999998, -21.099999999999987, -13.599999999999973, -15.799999999999965, -50.90000000000023], "episode_lengths": [400, 400, 375, 400, 101, 400, 158, 400, 304, 400, 400, 400, 400, 86, 400, 400, 174, 400, 70, 400, 400, 400, 373, 390, 145, 117, 177, 131, 400, 329, 377, 400, 400, 80, 215, 400, 301, 54, 273, 400, 400, 102, 97, 400, 109, 61, 80, 156, 125, 400, 400, 120, 400, 186, 128, 77, 140, 244, 400, 400, 43, 93, 299, 400, 75, 85, 349, 59, 400, 159, 400, 159, 73, 130, 100, 136, 138, 63, 83, 400, 86, 79, 65, 120, 400, 86, 109, 78, 67, 43, 400, 95, 54, 318, 248, 52, 184, 110, 142, 400]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23662424232445933, "mean_inference_ms": 0.7240219354457793, "mean_action_processing_ms": 0.07677735222433749, "mean_env_wait_ms": 6.329413483293849, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0069196224212646484, "StateBufferConnector_ms": 0.003882884979248047, "ViewRequirementAgentConnector_ms": 0.08961629867553711}}, "episode_reward_max": -3.200000000000001, "episode_reward_min": -63.40000000000042, "episode_reward_mean": -28.321000000000122, "episode_len_mean": 234.35, "episodes_this_iter": 24, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-48.10000000000026, -45.40000000000029, -48.90000000000033, -48.300000000000225, -9.799999999999983, -58.000000000000455, -19.3, -58.40000000000042, -43.80000000000019, -49.10000000000036, -51.70000000000028, -52.200000000000266, -52.700000000000365, -7.599999999999985, -63.40000000000042, -59.60000000000042, -18.399999999999984, -59.500000000000405, -5.8999999999999915, -59.300000000000296, -50.40000000000021, -49.100000000000385, -42.800000000000246, -44.200000000000344, -15.499999999999964, -11.099999999999978, -18.599999999999962, -14.199999999999964, -49.00000000000036, -37.70000000000022, -58.500000000000306, -47.00000000000027, -63.10000000000037, -6.899999999999988, -28.099999999999987, -46.10000000000026, -32.40000000000018, -4.299999999999997, -28.100000000000083, -42.40000000000026, -49.30000000000031, -10.499999999999977, -9.699999999999982, -48.50000000000028, -12.19999999999998, -4.999999999999995, -7.499999999999988, -21.999999999999968, -11.399999999999972, -46.10000000000034, -50.30000000000027, -15.999999999999975, -46.80000000000034, -17.900000000000002, -13.199999999999969, -7.599999999999985, -17.79999999999998, -27.900000000000098, -48.80000000000026, -48.600000000000236, -3.200000000000001, -10.499999999999984, -42.00000000000014, -46.70000000000035, -6.49999999999999, -8.599999999999993, -40.80000000000016, -4.799999999999995, -46.70000000000029, -19.099999999999962, -44.80000000000032, -21.39999999999998, -6.999999999999995, -13.799999999999963, -9.599999999999978, -14.099999999999962, -15.799999999999972, -5.199999999999994, -7.199999999999987, -46.600000000000335, -7.699999999999987, -7.099999999999991, -5.399999999999993, -11.79999999999997, -54.50000000000029, -8.799999999999986, -11.399999999999975, -6.699999999999989, -5.699999999999993, -3.200000000000001, -48.30000000000037, -9.199999999999983, -4.299999999999997, -37.600000000000165, -24.50000000000009, -4.099999999999998, -21.099999999999987, -13.599999999999973, -15.799999999999965, -50.90000000000023], "episode_lengths": [400, 400, 375, 400, 101, 400, 158, 400, 304, 400, 400, 400, 400, 86, 400, 400, 174, 400, 70, 400, 400, 400, 373, 390, 145, 117, 177, 131, 400, 329, 377, 400, 400, 80, 215, 400, 301, 54, 273, 400, 400, 102, 97, 400, 109, 61, 80, 156, 125, 400, 400, 120, 400, 186, 128, 77, 140, 244, 400, 400, 43, 93, 299, 400, 75, 85, 349, 59, 400, 159, 400, 159, 73, 130, 100, 136, 138, 63, 83, 400, 86, 79, 65, 120, 400, 86, 109, 78, 67, 43, 400, 95, 54, 318, 248, 52, 184, 110, 142, 400]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23662424232445933, "mean_inference_ms": 0.7240219354457793, "mean_action_processing_ms": 0.07677735222433749, "mean_env_wait_ms": 6.329413483293849, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0069196224212646484, "StateBufferConnector_ms": 0.003882884979248047, "ViewRequirementAgentConnector_ms": 0.08961629867553711}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 549.5822841874794, "num_env_steps_trained_throughput_per_sec": 549.5822841874794, "timesteps_total": 32000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 32000, "timers": {"training_iteration_time_ms": 7342.931, "sample_time_ms": 3830.625, "load_time_ms": 0.912, "load_throughput": 4385770.284, "learn_time_ms": 3508.061, "learn_throughput": 1140.231, "synch_weights_time_ms": 2.668}, "counters": {"num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000}, "done": false, "episodes_total": 125, "training_iteration": 8, "trial_id": "2154c_00000", "date": "2024-03-07_13-05-30", "timestamp": 1709834730, "time_this_iter_s": 7.280640363693237, "time_total_s": 58.76286721229553, "pid": 116529, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7efea6399f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 58.76286721229553, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 30.955555555555552, "ram_util_percent": 50.56666666666667, "gpu_util_percent0": 0.08444444444444445, "vram_util_percent0": 0.10374168113425926}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.10000000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 6.362629189670727, "policy_loss": -0.016990376944823932, "vf_loss": 6.378856443749961, "vf_explained_var": -0.06942789721232588, "kl": 0.007631247793581982, "entropy": 1.0224601569355176, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 7905.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000}, "sampler_results": {"episode_reward_max": -3.200000000000001, "episode_reward_min": -63.10000000000037, "episode_reward_mean": -22.998000000000083, "episode_len_mean": 199.15, "episode_media": {}, "episodes_this_iter": 25, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-11.099999999999978, -18.599999999999962, -14.199999999999964, -49.00000000000036, -37.70000000000022, -58.500000000000306, -47.00000000000027, -63.10000000000037, -6.899999999999988, -28.099999999999987, -46.10000000000026, -32.40000000000018, -4.299999999999997, -28.100000000000083, -42.40000000000026, -49.30000000000031, -10.499999999999977, -9.699999999999982, -48.50000000000028, -12.19999999999998, -4.999999999999995, -7.499999999999988, -21.999999999999968, -11.399999999999972, -46.10000000000034, -50.30000000000027, -15.999999999999975, -46.80000000000034, -17.900000000000002, -13.199999999999969, -7.599999999999985, -17.79999999999998, -27.900000000000098, -48.80000000000026, -48.600000000000236, -3.200000000000001, -10.499999999999984, -42.00000000000014, -46.70000000000035, -6.49999999999999, -8.599999999999993, -40.80000000000016, -4.799999999999995, -46.70000000000029, -19.099999999999962, -44.80000000000032, -21.39999999999998, -6.999999999999995, -13.799999999999963, -9.599999999999978, -14.099999999999962, -15.799999999999972, -5.199999999999994, -7.199999999999987, -46.600000000000335, -7.699999999999987, -7.099999999999991, -5.399999999999993, -11.79999999999997, -54.50000000000029, -8.799999999999986, -11.399999999999975, -6.699999999999989, -5.699999999999993, -3.200000000000001, -48.30000000000037, -9.199999999999983, -4.299999999999997, -37.600000000000165, -24.50000000000009, -4.099999999999998, -21.099999999999987, -13.599999999999973, -15.799999999999965, -50.90000000000023, -35.10000000000022, -4.999999999999995, -8.599999999999987, -12.299999999999969, -4.099999999999998, -35.700000000000216, -7.699999999999987, -12.699999999999969, -28.200000000000017, -55.00000000000025, -11.99999999999997, -5.499999999999993, -5.7999999999999945, -39.50000000000023, -5.399999999999993, -7.899999999999984, -27.3000000000001, -49.500000000000306, -54.800000000000246, -7.399999999999986, -45.90000000000032, -5.199999999999994, -8.399999999999986, -4.999999999999995, -45.10000000000033], "episode_lengths": [117, 177, 131, 400, 329, 377, 400, 400, 80, 215, 400, 301, 54, 273, 400, 400, 102, 97, 400, 109, 61, 80, 156, 125, 400, 400, 120, 400, 186, 128, 77, 140, 244, 400, 400, 43, 93, 299, 400, 75, 85, 349, 59, 400, 159, 400, 159, 73, 130, 100, 136, 138, 63, 83, 400, 86, 79, 65, 120, 400, 86, 109, 78, 67, 43, 400, 95, 54, 318, 248, 52, 184, 110, 142, 400, 314, 61, 85, 125, 52, 334, 77, 114, 221, 394, 130, 66, 66, 352, 65, 82, 266, 400, 361, 85, 394, 63, 88, 61, 400]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23847809317963214, "mean_inference_ms": 0.7235735600036654, "mean_action_processing_ms": 0.07661473066823421, "mean_env_wait_ms": 6.345063222424403, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0066874027252197266, "StateBufferConnector_ms": 0.003872394561767578, "ViewRequirementAgentConnector_ms": 0.0897822380065918}}, "episode_reward_max": -3.200000000000001, "episode_reward_min": -63.10000000000037, "episode_reward_mean": -22.998000000000083, "episode_len_mean": 199.15, "episodes_this_iter": 25, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-11.099999999999978, -18.599999999999962, -14.199999999999964, -49.00000000000036, -37.70000000000022, -58.500000000000306, -47.00000000000027, -63.10000000000037, -6.899999999999988, -28.099999999999987, -46.10000000000026, -32.40000000000018, -4.299999999999997, -28.100000000000083, -42.40000000000026, -49.30000000000031, -10.499999999999977, -9.699999999999982, -48.50000000000028, -12.19999999999998, -4.999999999999995, -7.499999999999988, -21.999999999999968, -11.399999999999972, -46.10000000000034, -50.30000000000027, -15.999999999999975, -46.80000000000034, -17.900000000000002, -13.199999999999969, -7.599999999999985, -17.79999999999998, -27.900000000000098, -48.80000000000026, -48.600000000000236, -3.200000000000001, -10.499999999999984, -42.00000000000014, -46.70000000000035, -6.49999999999999, -8.599999999999993, -40.80000000000016, -4.799999999999995, -46.70000000000029, -19.099999999999962, -44.80000000000032, -21.39999999999998, -6.999999999999995, -13.799999999999963, -9.599999999999978, -14.099999999999962, -15.799999999999972, -5.199999999999994, -7.199999999999987, -46.600000000000335, -7.699999999999987, -7.099999999999991, -5.399999999999993, -11.79999999999997, -54.50000000000029, -8.799999999999986, -11.399999999999975, -6.699999999999989, -5.699999999999993, -3.200000000000001, -48.30000000000037, -9.199999999999983, -4.299999999999997, -37.600000000000165, -24.50000000000009, -4.099999999999998, -21.099999999999987, -13.599999999999973, -15.799999999999965, -50.90000000000023, -35.10000000000022, -4.999999999999995, -8.599999999999987, -12.299999999999969, -4.099999999999998, -35.700000000000216, -7.699999999999987, -12.699999999999969, -28.200000000000017, -55.00000000000025, -11.99999999999997, -5.499999999999993, -5.7999999999999945, -39.50000000000023, -5.399999999999993, -7.899999999999984, -27.3000000000001, -49.500000000000306, -54.800000000000246, -7.399999999999986, -45.90000000000032, -5.199999999999994, -8.399999999999986, -4.999999999999995, -45.10000000000033], "episode_lengths": [117, 177, 131, 400, 329, 377, 400, 400, 80, 215, 400, 301, 54, 273, 400, 400, 102, 97, 400, 109, 61, 80, 156, 125, 400, 400, 120, 400, 186, 128, 77, 140, 244, 400, 400, 43, 93, 299, 400, 75, 85, 349, 59, 400, 159, 400, 159, 73, 130, 100, 136, 138, 63, 83, 400, 86, 79, 65, 120, 400, 86, 109, 78, 67, 43, 400, 95, 54, 318, 248, 52, 184, 110, 142, 400, 314, 61, 85, 125, 52, 334, 77, 114, 221, 394, 130, 66, 66, 352, 65, 82, 266, 400, 361, 85, 394, 63, 88, 61, 400]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23847809317963214, "mean_inference_ms": 0.7235735600036654, "mean_action_processing_ms": 0.07661473066823421, "mean_env_wait_ms": 6.345063222424403, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0066874027252197266, "StateBufferConnector_ms": 0.003872394561767578, "ViewRequirementAgentConnector_ms": 0.0897822380065918}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 546.6017347222188, "num_env_steps_trained_throughput_per_sec": 546.6017347222188, "timesteps_total": 36000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 36000, "timers": {"training_iteration_time_ms": 7340.15, "sample_time_ms": 3827.412, "load_time_ms": 0.907, "load_throughput": 4411960.729, "learn_time_ms": 3508.452, "learn_throughput": 1140.104, "synch_weights_time_ms": 2.718}, "counters": {"num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000}, "done": false, "episodes_total": 150, "training_iteration": 9, "trial_id": "2154c_00000", "date": "2024-03-07_13-05-37", "timestamp": 1709834737, "time_this_iter_s": 7.320563077926636, "time_total_s": 66.08343029022217, "pid": 116529, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7efea6399f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 66.08343029022217, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 28.47, "ram_util_percent": 50.5, "gpu_util_percent0": 0.08700000000000001, "vram_util_percent0": 0.1037109375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.10000000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 6.657769888318995, "policy_loss": -0.007268274415244338, "vf_loss": 6.66441081454677, "vf_explained_var": -0.011232494667012205, "kl": 0.006273547350776341, "entropy": 1.0151678481409627, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 8835.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000}, "sampler_results": {"episode_reward_max": -3.200000000000001, "episode_reward_min": -55.00000000000025, "episode_reward_mean": -18.858000000000054, "episode_len_mean": 167.42, "episode_media": {}, "episodes_this_iter": 31, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-17.79999999999998, -27.900000000000098, -48.80000000000026, -48.600000000000236, -3.200000000000001, -10.499999999999984, -42.00000000000014, -46.70000000000035, -6.49999999999999, -8.599999999999993, -40.80000000000016, -4.799999999999995, -46.70000000000029, -19.099999999999962, -44.80000000000032, -21.39999999999998, -6.999999999999995, -13.799999999999963, -9.599999999999978, -14.099999999999962, -15.799999999999972, -5.199999999999994, -7.199999999999987, -46.600000000000335, -7.699999999999987, -7.099999999999991, -5.399999999999993, -11.79999999999997, -54.50000000000029, -8.799999999999986, -11.399999999999975, -6.699999999999989, -5.699999999999993, -3.200000000000001, -48.30000000000037, -9.199999999999983, -4.299999999999997, -37.600000000000165, -24.50000000000009, -4.099999999999998, -21.099999999999987, -13.599999999999973, -15.799999999999965, -50.90000000000023, -35.10000000000022, -4.999999999999995, -8.599999999999987, -12.299999999999969, -4.099999999999998, -35.700000000000216, -7.699999999999987, -12.699999999999969, -28.200000000000017, -55.00000000000025, -11.99999999999997, -5.499999999999993, -5.7999999999999945, -39.50000000000023, -5.399999999999993, -7.899999999999984, -27.3000000000001, -49.500000000000306, -54.800000000000246, -7.399999999999986, -45.90000000000032, -5.199999999999994, -8.399999999999986, -4.999999999999995, -45.10000000000033, -50.000000000000234, -4.599999999999996, -7.199999999999987, -5.299999999999994, -4.999999999999995, -32.80000000000006, -11.399999999999974, -46.000000000000334, -8.89999999999998, -35.80000000000008, -32.400000000000034, -3.5999999999999996, -9.79999999999998, -8.99999999999998, -6.899999999999988, -5.699999999999992, -14.699999999999973, -10.099999999999989, -5.099999999999994, -7.399999999999995, -13.199999999999967, -8.299999999999983, -5.699999999999992, -9.599999999999987, -28.10000000000007, -6.099999999999991, -4.699999999999996, -5.4999999999999964, -5.399999999999993, -13.19999999999997, -36.00000000000011], "episode_lengths": [140, 244, 400, 400, 43, 93, 299, 400, 75, 85, 349, 59, 400, 159, 400, 159, 73, 130, 100, 136, 138, 63, 83, 400, 86, 79, 65, 120, 400, 86, 109, 78, 67, 43, 400, 95, 54, 318, 248, 52, 184, 110, 142, 400, 314, 61, 85, 125, 52, 334, 77, 114, 221, 394, 130, 66, 66, 352, 65, 82, 266, 400, 361, 85, 394, 63, 88, 61, 400, 400, 57, 83, 64, 61, 262, 113, 400, 100, 280, 251, 47, 105, 94, 80, 68, 136, 89, 62, 76, 120, 89, 68, 96, 250, 72, 58, 62, 65, 122, 292]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2403074815310837, "mean_inference_ms": 0.722831104388219, "mean_action_processing_ms": 0.07644230669222254, "mean_env_wait_ms": 6.348878210439225, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006662130355834961, "StateBufferConnector_ms": 0.0038819313049316406, "ViewRequirementAgentConnector_ms": 0.09002208709716797}}, "episode_reward_max": -3.200000000000001, "episode_reward_min": -55.00000000000025, "episode_reward_mean": -18.858000000000054, "episode_len_mean": 167.42, "episodes_this_iter": 31, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-17.79999999999998, -27.900000000000098, -48.80000000000026, -48.600000000000236, -3.200000000000001, -10.499999999999984, -42.00000000000014, -46.70000000000035, -6.49999999999999, -8.599999999999993, -40.80000000000016, -4.799999999999995, -46.70000000000029, -19.099999999999962, -44.80000000000032, -21.39999999999998, -6.999999999999995, -13.799999999999963, -9.599999999999978, -14.099999999999962, -15.799999999999972, -5.199999999999994, -7.199999999999987, -46.600000000000335, -7.699999999999987, -7.099999999999991, -5.399999999999993, -11.79999999999997, -54.50000000000029, -8.799999999999986, -11.399999999999975, -6.699999999999989, -5.699999999999993, -3.200000000000001, -48.30000000000037, -9.199999999999983, -4.299999999999997, -37.600000000000165, -24.50000000000009, -4.099999999999998, -21.099999999999987, -13.599999999999973, -15.799999999999965, -50.90000000000023, -35.10000000000022, -4.999999999999995, -8.599999999999987, -12.299999999999969, -4.099999999999998, -35.700000000000216, -7.699999999999987, -12.699999999999969, -28.200000000000017, -55.00000000000025, -11.99999999999997, -5.499999999999993, -5.7999999999999945, -39.50000000000023, -5.399999999999993, -7.899999999999984, -27.3000000000001, -49.500000000000306, -54.800000000000246, -7.399999999999986, -45.90000000000032, -5.199999999999994, -8.399999999999986, -4.999999999999995, -45.10000000000033, -50.000000000000234, -4.599999999999996, -7.199999999999987, -5.299999999999994, -4.999999999999995, -32.80000000000006, -11.399999999999974, -46.000000000000334, -8.89999999999998, -35.80000000000008, -32.400000000000034, -3.5999999999999996, -9.79999999999998, -8.99999999999998, -6.899999999999988, -5.699999999999992, -14.699999999999973, -10.099999999999989, -5.099999999999994, -7.399999999999995, -13.199999999999967, -8.299999999999983, -5.699999999999992, -9.599999999999987, -28.10000000000007, -6.099999999999991, -4.699999999999996, -5.4999999999999964, -5.399999999999993, -13.19999999999997, -36.00000000000011], "episode_lengths": [140, 244, 400, 400, 43, 93, 299, 400, 75, 85, 349, 59, 400, 159, 400, 159, 73, 130, 100, 136, 138, 63, 83, 400, 86, 79, 65, 120, 400, 86, 109, 78, 67, 43, 400, 95, 54, 318, 248, 52, 184, 110, 142, 400, 314, 61, 85, 125, 52, 334, 77, 114, 221, 394, 130, 66, 66, 352, 65, 82, 266, 400, 361, 85, 394, 63, 88, 61, 400, 400, 57, 83, 64, 61, 262, 113, 400, 100, 280, 251, 47, 105, 94, 80, 68, 136, 89, 62, 76, 120, 89, 68, 96, 250, 72, 58, 62, 65, 122, 292]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2403074815310837, "mean_inference_ms": 0.722831104388219, "mean_action_processing_ms": 0.07644230669222254, "mean_env_wait_ms": 6.348878210439225, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006662130355834961, "StateBufferConnector_ms": 0.0038819313049316406, "ViewRequirementAgentConnector_ms": 0.09002208709716797}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 544.8528935612708, "num_env_steps_trained_throughput_per_sec": 544.8528935612708, "timesteps_total": 40000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 40000, "timers": {"training_iteration_time_ms": 7340.275, "sample_time_ms": 3822.323, "load_time_ms": 0.904, "load_throughput": 4426939.68, "learn_time_ms": 3513.695, "learn_throughput": 1138.403, "synch_weights_time_ms": 2.695}, "counters": {"num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000}, "done": false, "episodes_total": 181, "training_iteration": 10, "trial_id": "2154c_00000", "date": "2024-03-07_13-05-45", "timestamp": 1709834745, "time_this_iter_s": 7.343913555145264, "time_total_s": 73.42734384536743, "pid": 116529, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7efea6399f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 73.42734384536743, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 31.244444444444444, "ram_util_percent": 50.611111111111114, "gpu_util_percent0": 0.07555555555555556, "vram_util_percent0": 0.10370551215277778}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.10000000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 5.544811013525211, "policy_loss": -0.026655870071181687, "vf_loss": 5.57063795437095, "vf_explained_var": 0.03570234448679032, "kl": 0.008289216448565607, "entropy": 1.0250538267756022, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 9765.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_agent_steps_sampled": 44000, "num_agent_steps_trained": 44000}, "sampler_results": {"episode_reward_max": -3.5999999999999996, "episode_reward_min": -55.00000000000025, "episode_reward_mean": -16.155000000000033, "episode_len_mean": 148.4, "episode_media": {}, "episodes_this_iter": 34, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-48.30000000000037, -9.199999999999983, -4.299999999999997, -37.600000000000165, -24.50000000000009, -4.099999999999998, -21.099999999999987, -13.599999999999973, -15.799999999999965, -50.90000000000023, -35.10000000000022, -4.999999999999995, -8.599999999999987, -12.299999999999969, -4.099999999999998, -35.700000000000216, -7.699999999999987, -12.699999999999969, -28.200000000000017, -55.00000000000025, -11.99999999999997, -5.499999999999993, -5.7999999999999945, -39.50000000000023, -5.399999999999993, -7.899999999999984, -27.3000000000001, -49.500000000000306, -54.800000000000246, -7.399999999999986, -45.90000000000032, -5.199999999999994, -8.399999999999986, -4.999999999999995, -45.10000000000033, -50.000000000000234, -4.599999999999996, -7.199999999999987, -5.299999999999994, -4.999999999999995, -32.80000000000006, -11.399999999999974, -46.000000000000334, -8.89999999999998, -35.80000000000008, -32.400000000000034, -3.5999999999999996, -9.79999999999998, -8.99999999999998, -6.899999999999988, -5.699999999999992, -14.699999999999973, -10.099999999999989, -5.099999999999994, -7.399999999999995, -13.199999999999967, -8.299999999999983, -5.699999999999992, -9.599999999999987, -28.10000000000007, -6.099999999999991, -4.699999999999996, -5.4999999999999964, -5.399999999999993, -13.19999999999997, -36.00000000000011, -16.299999999999965, -16.799999999999983, -9.699999999999978, -14.099999999999964, -4.4999999999999964, -10.399999999999977, -8.599999999999982, -9.499999999999982, -22.30000000000002, -7.79999999999999, -7.799999999999985, -6.29999999999999, -7.299999999999988, -6.89999999999999, -10.399999999999975, -12.599999999999968, -9.099999999999982, -9.499999999999982, -42.70000000000008, -5.999999999999991, -15.499999999999972, -6.399999999999995, -7.499999999999988, -8.199999999999987, -6.999999999999988, -8.799999999999981, -7.799999999999985, -12.999999999999966, -25.700000000000102, -34.000000000000156, -10.499999999999975, -7.399999999999986, -13.599999999999964, -5.499999999999993], "episode_lengths": [400, 95, 54, 318, 248, 52, 184, 110, 142, 400, 314, 61, 85, 125, 52, 334, 77, 114, 221, 394, 130, 66, 66, 352, 65, 82, 266, 400, 361, 85, 394, 63, 88, 61, 400, 400, 57, 83, 64, 61, 262, 113, 400, 100, 280, 251, 47, 105, 94, 80, 68, 136, 89, 62, 76, 120, 89, 68, 96, 250, 72, 58, 62, 65, 122, 292, 163, 173, 108, 132, 56, 103, 97, 100, 201, 79, 89, 74, 82, 78, 115, 130, 97, 97, 263, 71, 144, 69, 84, 86, 81, 96, 89, 130, 243, 321, 116, 85, 141, 66]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24299032137363072, "mean_inference_ms": 0.7228532380773754, "mean_action_processing_ms": 0.07649603574930124, "mean_env_wait_ms": 6.345036041734323, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006701469421386719, "StateBufferConnector_ms": 0.003997087478637695, "ViewRequirementAgentConnector_ms": 0.09141230583190918}}, "episode_reward_max": -3.5999999999999996, "episode_reward_min": -55.00000000000025, "episode_reward_mean": -16.155000000000033, "episode_len_mean": 148.4, "episodes_this_iter": 34, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-48.30000000000037, -9.199999999999983, -4.299999999999997, -37.600000000000165, -24.50000000000009, -4.099999999999998, -21.099999999999987, -13.599999999999973, -15.799999999999965, -50.90000000000023, -35.10000000000022, -4.999999999999995, -8.599999999999987, -12.299999999999969, -4.099999999999998, -35.700000000000216, -7.699999999999987, -12.699999999999969, -28.200000000000017, -55.00000000000025, -11.99999999999997, -5.499999999999993, -5.7999999999999945, -39.50000000000023, -5.399999999999993, -7.899999999999984, -27.3000000000001, -49.500000000000306, -54.800000000000246, -7.399999999999986, -45.90000000000032, -5.199999999999994, -8.399999999999986, -4.999999999999995, -45.10000000000033, -50.000000000000234, -4.599999999999996, -7.199999999999987, -5.299999999999994, -4.999999999999995, -32.80000000000006, -11.399999999999974, -46.000000000000334, -8.89999999999998, -35.80000000000008, -32.400000000000034, -3.5999999999999996, -9.79999999999998, -8.99999999999998, -6.899999999999988, -5.699999999999992, -14.699999999999973, -10.099999999999989, -5.099999999999994, -7.399999999999995, -13.199999999999967, -8.299999999999983, -5.699999999999992, -9.599999999999987, -28.10000000000007, -6.099999999999991, -4.699999999999996, -5.4999999999999964, -5.399999999999993, -13.19999999999997, -36.00000000000011, -16.299999999999965, -16.799999999999983, -9.699999999999978, -14.099999999999964, -4.4999999999999964, -10.399999999999977, -8.599999999999982, -9.499999999999982, -22.30000000000002, -7.79999999999999, -7.799999999999985, -6.29999999999999, -7.299999999999988, -6.89999999999999, -10.399999999999975, -12.599999999999968, -9.099999999999982, -9.499999999999982, -42.70000000000008, -5.999999999999991, -15.499999999999972, -6.399999999999995, -7.499999999999988, -8.199999999999987, -6.999999999999988, -8.799999999999981, -7.799999999999985, -12.999999999999966, -25.700000000000102, -34.000000000000156, -10.499999999999975, -7.399999999999986, -13.599999999999964, -5.499999999999993], "episode_lengths": [400, 95, 54, 318, 248, 52, 184, 110, 142, 400, 314, 61, 85, 125, 52, 334, 77, 114, 221, 394, 130, 66, 66, 352, 65, 82, 266, 400, 361, 85, 394, 63, 88, 61, 400, 400, 57, 83, 64, 61, 262, 113, 400, 100, 280, 251, 47, 105, 94, 80, 68, 136, 89, 62, 76, 120, 89, 68, 96, 250, 72, 58, 62, 65, 122, 292, 163, 173, 108, 132, 56, 103, 97, 100, 201, 79, 89, 74, 82, 78, 115, 130, 97, 97, 263, 71, 144, 69, 84, 86, 81, 96, 89, 130, 243, 321, 116, 85, 141, 66]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24299032137363072, "mean_inference_ms": 0.7228532380773754, "mean_action_processing_ms": 0.07649603574930124, "mean_env_wait_ms": 6.345036041734323, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006701469421386719, "StateBufferConnector_ms": 0.003997087478637695, "ViewRequirementAgentConnector_ms": 0.09141230583190918}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 44000, "num_agent_steps_trained": 44000, "num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 534.726564365021, "num_env_steps_trained_throughput_per_sec": 534.726564365021, "timesteps_total": 44000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 44000, "timers": {"training_iteration_time_ms": 7362.104, "sample_time_ms": 3836.998, "load_time_ms": 0.912, "load_throughput": 4385168.457, "learn_time_ms": 3520.827, "learn_throughput": 1136.097, "synch_weights_time_ms": 2.726}, "counters": {"num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_agent_steps_sampled": 44000, "num_agent_steps_trained": 44000}, "done": false, "episodes_total": 215, "training_iteration": 11, "trial_id": "2154c_00000", "date": "2024-03-07_13-05-52", "timestamp": 1709834752, "time_this_iter_s": 7.483099460601807, "time_total_s": 80.91044330596924, "pid": 116529, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7efea6399f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 80.91044330596924, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 29.499999999999993, "ram_util_percent": 50.650000000000006, "gpu_util_percent0": 0.093, "vram_util_percent0": 0.1037353515625}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.10000000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 4.8321822207001714, "policy_loss": -0.006119665327251598, "vf_loss": 4.837461707124146, "vf_explained_var": 0.015028007568851594, "kl": 0.00840183789156189, "entropy": 1.0050762665528123, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 10695.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000}, "sampler_results": {"episode_reward_max": -3.5999999999999996, "episode_reward_min": -50.000000000000234, "episode_reward_mean": -12.516000000000004, "episode_len_mean": 121.73, "episode_media": {}, "episodes_this_iter": 31, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-5.199999999999994, -8.399999999999986, -4.999999999999995, -45.10000000000033, -50.000000000000234, -4.599999999999996, -7.199999999999987, -5.299999999999994, -4.999999999999995, -32.80000000000006, -11.399999999999974, -46.000000000000334, -8.89999999999998, -35.80000000000008, -32.400000000000034, -3.5999999999999996, -9.79999999999998, -8.99999999999998, -6.899999999999988, -5.699999999999992, -14.699999999999973, -10.099999999999989, -5.099999999999994, -7.399999999999995, -13.199999999999967, -8.299999999999983, -5.699999999999992, -9.599999999999987, -28.10000000000007, -6.099999999999991, -4.699999999999996, -5.4999999999999964, -5.399999999999993, -13.19999999999997, -36.00000000000011, -16.299999999999965, -16.799999999999983, -9.699999999999978, -14.099999999999964, -4.4999999999999964, -10.399999999999977, -8.599999999999982, -9.499999999999982, -22.30000000000002, -7.79999999999999, -7.799999999999985, -6.29999999999999, -7.299999999999988, -6.89999999999999, -10.399999999999975, -12.599999999999968, -9.099999999999982, -9.499999999999982, -42.70000000000008, -5.999999999999991, -15.499999999999972, -6.399999999999995, -7.499999999999988, -8.199999999999987, -6.999999999999988, -8.799999999999981, -7.799999999999985, -12.999999999999966, -25.700000000000102, -34.000000000000156, -10.499999999999975, -7.399999999999986, -13.599999999999964, -5.499999999999993, -16.499999999999968, -9.199999999999982, -27.600000000000076, -8.89999999999998, -6.499999999999989, -7.699999999999985, -23.80000000000004, -34.60000000000013, -7.099999999999989, -4.299999999999997, -6.499999999999989, -9.19999999999998, -10.899999999999974, -6.19999999999999, -6.499999999999991, -5.499999999999993, -6.499999999999989, -19.5, -5.199999999999994, -6.799999999999988, -3.9999999999999982, -5.799999999999992, -5.399999999999993, -11.79999999999997, -12.699999999999983, -19.999999999999964, -7.899999999999995, -18.09999999999998, -4.599999999999996, -6.099999999999991, -5.499999999999993], "episode_lengths": [63, 88, 61, 400, 400, 57, 83, 64, 61, 262, 113, 400, 100, 280, 251, 47, 105, 94, 80, 68, 136, 89, 62, 76, 120, 89, 68, 96, 250, 72, 58, 62, 65, 122, 292, 163, 173, 108, 132, 56, 103, 97, 100, 201, 79, 89, 74, 82, 78, 115, 130, 97, 97, 263, 71, 144, 69, 84, 86, 81, 96, 89, 130, 243, 321, 116, 85, 141, 66, 140, 100, 265, 100, 76, 88, 229, 318, 81, 54, 76, 99, 119, 73, 74, 66, 76, 183, 63, 79, 51, 69, 65, 128, 102, 155, 79, 177, 57, 72, 66]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24502503242206372, "mean_inference_ms": 0.7227078808570763, "mean_action_processing_ms": 0.07638039209027343, "mean_env_wait_ms": 6.333618272227214, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00660395622253418, "StateBufferConnector_ms": 0.0039675235748291016, "ViewRequirementAgentConnector_ms": 0.09075069427490234}}, "episode_reward_max": -3.5999999999999996, "episode_reward_min": -50.000000000000234, "episode_reward_mean": -12.516000000000004, "episode_len_mean": 121.73, "episodes_this_iter": 31, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-5.199999999999994, -8.399999999999986, -4.999999999999995, -45.10000000000033, -50.000000000000234, -4.599999999999996, -7.199999999999987, -5.299999999999994, -4.999999999999995, -32.80000000000006, -11.399999999999974, -46.000000000000334, -8.89999999999998, -35.80000000000008, -32.400000000000034, -3.5999999999999996, -9.79999999999998, -8.99999999999998, -6.899999999999988, -5.699999999999992, -14.699999999999973, -10.099999999999989, -5.099999999999994, -7.399999999999995, -13.199999999999967, -8.299999999999983, -5.699999999999992, -9.599999999999987, -28.10000000000007, -6.099999999999991, -4.699999999999996, -5.4999999999999964, -5.399999999999993, -13.19999999999997, -36.00000000000011, -16.299999999999965, -16.799999999999983, -9.699999999999978, -14.099999999999964, -4.4999999999999964, -10.399999999999977, -8.599999999999982, -9.499999999999982, -22.30000000000002, -7.79999999999999, -7.799999999999985, -6.29999999999999, -7.299999999999988, -6.89999999999999, -10.399999999999975, -12.599999999999968, -9.099999999999982, -9.499999999999982, -42.70000000000008, -5.999999999999991, -15.499999999999972, -6.399999999999995, -7.499999999999988, -8.199999999999987, -6.999999999999988, -8.799999999999981, -7.799999999999985, -12.999999999999966, -25.700000000000102, -34.000000000000156, -10.499999999999975, -7.399999999999986, -13.599999999999964, -5.499999999999993, -16.499999999999968, -9.199999999999982, -27.600000000000076, -8.89999999999998, -6.499999999999989, -7.699999999999985, -23.80000000000004, -34.60000000000013, -7.099999999999989, -4.299999999999997, -6.499999999999989, -9.19999999999998, -10.899999999999974, -6.19999999999999, -6.499999999999991, -5.499999999999993, -6.499999999999989, -19.5, -5.199999999999994, -6.799999999999988, -3.9999999999999982, -5.799999999999992, -5.399999999999993, -11.79999999999997, -12.699999999999983, -19.999999999999964, -7.899999999999995, -18.09999999999998, -4.599999999999996, -6.099999999999991, -5.499999999999993], "episode_lengths": [63, 88, 61, 400, 400, 57, 83, 64, 61, 262, 113, 400, 100, 280, 251, 47, 105, 94, 80, 68, 136, 89, 62, 76, 120, 89, 68, 96, 250, 72, 58, 62, 65, 122, 292, 163, 173, 108, 132, 56, 103, 97, 100, 201, 79, 89, 74, 82, 78, 115, 130, 97, 97, 263, 71, 144, 69, 84, 86, 81, 96, 89, 130, 243, 321, 116, 85, 141, 66, 140, 100, 265, 100, 76, 88, 229, 318, 81, 54, 76, 99, 119, 73, 74, 66, 76, 183, 63, 79, 51, 69, 65, 128, 102, 155, 79, 177, 57, 72, 66]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24502503242206372, "mean_inference_ms": 0.7227078808570763, "mean_action_processing_ms": 0.07638039209027343, "mean_env_wait_ms": 6.333618272227214, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00660395622253418, "StateBufferConnector_ms": 0.0039675235748291016, "ViewRequirementAgentConnector_ms": 0.09075069427490234}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000, "num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 548.5683195329268, "num_env_steps_trained_throughput_per_sec": 548.5683195329268, "timesteps_total": 48000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 48000, "timers": {"training_iteration_time_ms": 7359.627, "sample_time_ms": 3840.499, "load_time_ms": 0.919, "load_throughput": 4353760.477, "learn_time_ms": 3514.755, "learn_throughput": 1138.059, "synch_weights_time_ms": 2.8}, "counters": {"num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000}, "done": false, "episodes_total": 246, "training_iteration": 12, "trial_id": "2154c_00000", "date": "2024-03-07_13-06-00", "timestamp": 1709834760, "time_this_iter_s": 7.294527530670166, "time_total_s": 88.2049708366394, "pid": 116529, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7efea6399f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 88.2049708366394, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 28.27, "ram_util_percent": 50.60000000000001, "gpu_util_percent0": 0.089, "vram_util_percent0": 0.1037353515625}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.10000000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 4.446280299863147, "policy_loss": -0.010452815433663706, "vf_loss": 4.455968508060261, "vf_explained_var": 0.28769822223212127, "kl": 0.007646078595180671, "entropy": 0.9903296784047158, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 11625.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_agent_steps_sampled": 52000, "num_agent_steps_trained": 52000}, "sampler_results": {"episode_reward_max": -3.5999999999999996, "episode_reward_min": -57.10000000000031, "episode_reward_mean": -12.039000000000003, "episode_len_mean": 119.54, "episode_media": {}, "episodes_this_iter": 35, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-16.299999999999965, -16.799999999999983, -9.699999999999978, -14.099999999999964, -4.4999999999999964, -10.399999999999977, -8.599999999999982, -9.499999999999982, -22.30000000000002, -7.79999999999999, -7.799999999999985, -6.29999999999999, -7.299999999999988, -6.89999999999999, -10.399999999999975, -12.599999999999968, -9.099999999999982, -9.499999999999982, -42.70000000000008, -5.999999999999991, -15.499999999999972, -6.399999999999995, -7.499999999999988, -8.199999999999987, -6.999999999999988, -8.799999999999981, -7.799999999999985, -12.999999999999966, -25.700000000000102, -34.000000000000156, -10.499999999999975, -7.399999999999986, -13.599999999999964, -5.499999999999993, -16.499999999999968, -9.199999999999982, -27.600000000000076, -8.89999999999998, -6.499999999999989, -7.699999999999985, -23.80000000000004, -34.60000000000013, -7.099999999999989, -4.299999999999997, -6.499999999999989, -9.19999999999998, -10.899999999999974, -6.19999999999999, -6.499999999999991, -5.499999999999993, -6.499999999999989, -19.5, -5.199999999999994, -6.799999999999988, -3.9999999999999982, -5.799999999999992, -5.399999999999993, -11.79999999999997, -12.699999999999983, -19.999999999999964, -7.899999999999995, -18.09999999999998, -4.599999999999996, -6.099999999999991, -5.499999999999993, -41.70000000000024, -7.399999999999988, -6.699999999999992, -4.999999999999995, -3.799999999999999, -9.699999999999978, -24.40000000000006, -3.5999999999999996, -5.699999999999992, -21.300000000000054, -14.699999999999966, -43.00000000000034, -57.10000000000031, -10.09999999999998, -9.199999999999983, -11.599999999999978, -11.899999999999974, -9.199999999999983, -4.699999999999996, -10.199999999999976, -7.799999999999985, -13.199999999999966, -4.999999999999995, -5.699999999999992, -13.799999999999967, -13.599999999999966, -41.70000000000026, -4.299999999999997, -4.699999999999996, -3.9999999999999982, -12.39999999999997, -5.2999999999999945, -10.799999999999974, -4.399999999999997, -5.7999999999999945], "episode_lengths": [163, 173, 108, 132, 56, 103, 97, 100, 201, 79, 89, 74, 82, 78, 115, 130, 97, 97, 263, 71, 144, 69, 84, 86, 81, 96, 89, 130, 243, 321, 116, 85, 141, 66, 140, 100, 265, 100, 76, 88, 229, 318, 81, 54, 76, 99, 119, 73, 74, 66, 76, 183, 63, 79, 51, 69, 65, 128, 102, 155, 79, 177, 57, 72, 66, 390, 84, 74, 61, 49, 108, 226, 47, 68, 213, 127, 400, 400, 107, 100, 105, 117, 91, 58, 113, 87, 143, 60, 68, 137, 129, 385, 54, 58, 51, 108, 63, 113, 55, 66]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24753728319334412, "mean_inference_ms": 0.7228377178223796, "mean_action_processing_ms": 0.0763559153363943, "mean_env_wait_ms": 6.334349152268325, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006602764129638672, "StateBufferConnector_ms": 0.003940105438232422, "ViewRequirementAgentConnector_ms": 0.09048843383789062}}, "episode_reward_max": -3.5999999999999996, "episode_reward_min": -57.10000000000031, "episode_reward_mean": -12.039000000000003, "episode_len_mean": 119.54, "episodes_this_iter": 35, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-16.299999999999965, -16.799999999999983, -9.699999999999978, -14.099999999999964, -4.4999999999999964, -10.399999999999977, -8.599999999999982, -9.499999999999982, -22.30000000000002, -7.79999999999999, -7.799999999999985, -6.29999999999999, -7.299999999999988, -6.89999999999999, -10.399999999999975, -12.599999999999968, -9.099999999999982, -9.499999999999982, -42.70000000000008, -5.999999999999991, -15.499999999999972, -6.399999999999995, -7.499999999999988, -8.199999999999987, -6.999999999999988, -8.799999999999981, -7.799999999999985, -12.999999999999966, -25.700000000000102, -34.000000000000156, -10.499999999999975, -7.399999999999986, -13.599999999999964, -5.499999999999993, -16.499999999999968, -9.199999999999982, -27.600000000000076, -8.89999999999998, -6.499999999999989, -7.699999999999985, -23.80000000000004, -34.60000000000013, -7.099999999999989, -4.299999999999997, -6.499999999999989, -9.19999999999998, -10.899999999999974, -6.19999999999999, -6.499999999999991, -5.499999999999993, -6.499999999999989, -19.5, -5.199999999999994, -6.799999999999988, -3.9999999999999982, -5.799999999999992, -5.399999999999993, -11.79999999999997, -12.699999999999983, -19.999999999999964, -7.899999999999995, -18.09999999999998, -4.599999999999996, -6.099999999999991, -5.499999999999993, -41.70000000000024, -7.399999999999988, -6.699999999999992, -4.999999999999995, -3.799999999999999, -9.699999999999978, -24.40000000000006, -3.5999999999999996, -5.699999999999992, -21.300000000000054, -14.699999999999966, -43.00000000000034, -57.10000000000031, -10.09999999999998, -9.199999999999983, -11.599999999999978, -11.899999999999974, -9.199999999999983, -4.699999999999996, -10.199999999999976, -7.799999999999985, -13.199999999999966, -4.999999999999995, -5.699999999999992, -13.799999999999967, -13.599999999999966, -41.70000000000026, -4.299999999999997, -4.699999999999996, -3.9999999999999982, -12.39999999999997, -5.2999999999999945, -10.799999999999974, -4.399999999999997, -5.7999999999999945], "episode_lengths": [163, 173, 108, 132, 56, 103, 97, 100, 201, 79, 89, 74, 82, 78, 115, 130, 97, 97, 263, 71, 144, 69, 84, 86, 81, 96, 89, 130, 243, 321, 116, 85, 141, 66, 140, 100, 265, 100, 76, 88, 229, 318, 81, 54, 76, 99, 119, 73, 74, 66, 76, 183, 63, 79, 51, 69, 65, 128, 102, 155, 79, 177, 57, 72, 66, 390, 84, 74, 61, 49, 108, 226, 47, 68, 213, 127, 400, 400, 107, 100, 105, 117, 91, 58, 113, 87, 143, 60, 68, 137, 129, 385, 54, 58, 51, 108, 63, 113, 55, 66]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24753728319334412, "mean_inference_ms": 0.7228377178223796, "mean_action_processing_ms": 0.0763559153363943, "mean_env_wait_ms": 6.334349152268325, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006602764129638672, "StateBufferConnector_ms": 0.003940105438232422, "ViewRequirementAgentConnector_ms": 0.09048843383789062}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 52000, "num_agent_steps_trained": 52000, "num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 540.2029181722734, "num_env_steps_trained_throughput_per_sec": 540.2029181722734, "timesteps_total": 52000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 52000, "timers": {"training_iteration_time_ms": 7364.769, "sample_time_ms": 3841.463, "load_time_ms": 0.921, "load_throughput": 4340806.21, "learn_time_ms": 3518.97, "learn_throughput": 1136.696, "synch_weights_time_ms": 2.759}, "counters": {"num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_agent_steps_sampled": 52000, "num_agent_steps_trained": 52000}, "done": false, "episodes_total": 281, "training_iteration": 13, "trial_id": "2154c_00000", "date": "2024-03-07_13-06-07", "timestamp": 1709834767, "time_this_iter_s": 7.407140254974365, "time_total_s": 95.61211109161377, "pid": 116529, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7efea6399f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 95.61211109161377, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 31.04444444444444, "ram_util_percent": 50.6, "gpu_util_percent0": 0.0811111111111111, "vram_util_percent0": 0.10363317418981481}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.10000000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 4.324952960566252, "policy_loss": -0.004722983868772625, "vf_loss": 4.328930195461037, "vf_explained_var": -0.00017443363384533954, "kl": 0.007457301035034434, "entropy": 0.9784870625183146, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 12555.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 56000}, "sampler_results": {"episode_reward_max": -3.5999999999999996, "episode_reward_min": -59.40000000000032, "episode_reward_mean": -11.749000000000015, "episode_len_mean": 115.83, "episode_media": {}, "episodes_this_iter": 34, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-16.499999999999968, -9.199999999999982, -27.600000000000076, -8.89999999999998, -6.499999999999989, -7.699999999999985, -23.80000000000004, -34.60000000000013, -7.099999999999989, -4.299999999999997, -6.499999999999989, -9.19999999999998, -10.899999999999974, -6.19999999999999, -6.499999999999991, -5.499999999999993, -6.499999999999989, -19.5, -5.199999999999994, -6.799999999999988, -3.9999999999999982, -5.799999999999992, -5.399999999999993, -11.79999999999997, -12.699999999999983, -19.999999999999964, -7.899999999999995, -18.09999999999998, -4.599999999999996, -6.099999999999991, -5.499999999999993, -41.70000000000024, -7.399999999999988, -6.699999999999992, -4.999999999999995, -3.799999999999999, -9.699999999999978, -24.40000000000006, -3.5999999999999996, -5.699999999999992, -21.300000000000054, -14.699999999999966, -43.00000000000034, -57.10000000000031, -10.09999999999998, -9.199999999999983, -11.599999999999978, -11.899999999999974, -9.199999999999983, -4.699999999999996, -10.199999999999976, -7.799999999999985, -13.199999999999966, -4.999999999999995, -5.699999999999992, -13.799999999999967, -13.599999999999966, -41.70000000000026, -4.299999999999997, -4.699999999999996, -3.9999999999999982, -12.39999999999997, -5.2999999999999945, -10.799999999999974, -4.399999999999997, -5.7999999999999945, -5.699999999999992, -5.999999999999991, -18.199999999999992, -3.9999999999999982, -4.899999999999995, -44.300000000000296, -4.099999999999998, -4.999999999999995, -8.599999999999985, -6.29999999999999, -7.399999999999986, -59.40000000000032, -5.8999999999999915, -5.399999999999993, -11.699999999999985, -6.29999999999999, -14.49999999999997, -3.8999999999999986, -4.4999999999999964, -6.999999999999999, -6.89999999999999, -6.699999999999992, -4.399999999999997, -29.500000000000057, -4.699999999999996, -8.699999999999985, -4.299999999999999, -4.299999999999997, -33.800000000000146, -9.29999999999998, -7.499999999999986, -4.999999999999995, -16.89999999999999, -5.399999999999993], "episode_lengths": [140, 100, 265, 100, 76, 88, 229, 318, 81, 54, 76, 99, 119, 73, 74, 66, 76, 183, 63, 79, 51, 69, 65, 128, 102, 155, 79, 177, 57, 72, 66, 390, 84, 74, 61, 49, 108, 226, 47, 68, 213, 127, 400, 400, 107, 100, 105, 117, 91, 58, 113, 87, 143, 60, 68, 137, 129, 385, 54, 58, 51, 108, 63, 113, 55, 66, 68, 71, 187, 51, 60, 400, 52, 61, 91, 74, 85, 400, 70, 65, 98, 74, 125, 50, 56, 68, 78, 74, 55, 264, 58, 94, 52, 54, 280, 97, 86, 61, 164, 65]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2494579009569979, "mean_inference_ms": 0.7226904248100432, "mean_action_processing_ms": 0.07629573772942849, "mean_env_wait_ms": 6.334573401960888, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006624460220336914, "StateBufferConnector_ms": 0.0038785934448242188, "ViewRequirementAgentConnector_ms": 0.08985781669616699}}, "episode_reward_max": -3.5999999999999996, "episode_reward_min": -59.40000000000032, "episode_reward_mean": -11.749000000000015, "episode_len_mean": 115.83, "episodes_this_iter": 34, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-16.499999999999968, -9.199999999999982, -27.600000000000076, -8.89999999999998, -6.499999999999989, -7.699999999999985, -23.80000000000004, -34.60000000000013, -7.099999999999989, -4.299999999999997, -6.499999999999989, -9.19999999999998, -10.899999999999974, -6.19999999999999, -6.499999999999991, -5.499999999999993, -6.499999999999989, -19.5, -5.199999999999994, -6.799999999999988, -3.9999999999999982, -5.799999999999992, -5.399999999999993, -11.79999999999997, -12.699999999999983, -19.999999999999964, -7.899999999999995, -18.09999999999998, -4.599999999999996, -6.099999999999991, -5.499999999999993, -41.70000000000024, -7.399999999999988, -6.699999999999992, -4.999999999999995, -3.799999999999999, -9.699999999999978, -24.40000000000006, -3.5999999999999996, -5.699999999999992, -21.300000000000054, -14.699999999999966, -43.00000000000034, -57.10000000000031, -10.09999999999998, -9.199999999999983, -11.599999999999978, -11.899999999999974, -9.199999999999983, -4.699999999999996, -10.199999999999976, -7.799999999999985, -13.199999999999966, -4.999999999999995, -5.699999999999992, -13.799999999999967, -13.599999999999966, -41.70000000000026, -4.299999999999997, -4.699999999999996, -3.9999999999999982, -12.39999999999997, -5.2999999999999945, -10.799999999999974, -4.399999999999997, -5.7999999999999945, -5.699999999999992, -5.999999999999991, -18.199999999999992, -3.9999999999999982, -4.899999999999995, -44.300000000000296, -4.099999999999998, -4.999999999999995, -8.599999999999985, -6.29999999999999, -7.399999999999986, -59.40000000000032, -5.8999999999999915, -5.399999999999993, -11.699999999999985, -6.29999999999999, -14.49999999999997, -3.8999999999999986, -4.4999999999999964, -6.999999999999999, -6.89999999999999, -6.699999999999992, -4.399999999999997, -29.500000000000057, -4.699999999999996, -8.699999999999985, -4.299999999999999, -4.299999999999997, -33.800000000000146, -9.29999999999998, -7.499999999999986, -4.999999999999995, -16.89999999999999, -5.399999999999993], "episode_lengths": [140, 100, 265, 100, 76, 88, 229, 318, 81, 54, 76, 99, 119, 73, 74, 66, 76, 183, 63, 79, 51, 69, 65, 128, 102, 155, 79, 177, 57, 72, 66, 390, 84, 74, 61, 49, 108, 226, 47, 68, 213, 127, 400, 400, 107, 100, 105, 117, 91, 58, 113, 87, 143, 60, 68, 137, 129, 385, 54, 58, 51, 108, 63, 113, 55, 66, 68, 71, 187, 51, 60, 400, 52, 61, 91, 74, 85, 400, 70, 65, 98, 74, 125, 50, 56, 68, 78, 74, 55, 264, 58, 94, 52, 54, 280, 97, 86, 61, 164, 65]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2494579009569979, "mean_inference_ms": 0.7226904248100432, "mean_action_processing_ms": 0.07629573772942849, "mean_env_wait_ms": 6.334573401960888, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006624460220336914, "StateBufferConnector_ms": 0.0038785934448242188, "ViewRequirementAgentConnector_ms": 0.08985781669616699}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 56000, "num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 535.1320496368536, "num_env_steps_trained_throughput_per_sec": 535.1320496368536, "timesteps_total": 56000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 56000, "timers": {"training_iteration_time_ms": 7376.055, "sample_time_ms": 3840.057, "load_time_ms": 0.913, "load_throughput": 4381618.177, "learn_time_ms": 3531.709, "learn_throughput": 1132.596, "synch_weights_time_ms": 2.726}, "counters": {"num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 56000}, "done": false, "episodes_total": 315, "training_iteration": 14, "trial_id": "2154c_00000", "date": "2024-03-07_13-06-15", "timestamp": 1709834775, "time_this_iter_s": 7.477351903915405, "time_total_s": 103.08946299552917, "pid": 116529, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7efea6399f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 103.08946299552917, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 28.2, "ram_util_percent": 50.60000000000001, "gpu_util_percent0": 0.083, "vram_util_percent0": 0.10362955729166667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.10000000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 3.2979255789405824, "policy_loss": -0.006735440427737851, "vf_loss": 3.3039213826579434, "vf_explained_var": 0.2930425100429084, "kl": 0.007396381068773657, "entropy": 0.9299098110327156, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 13485.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000}, "sampler_results": {"episode_reward_max": -2.600000000000002, "episode_reward_min": -60.60000000000037, "episode_reward_mean": -10.464000000000016, "episode_len_mean": 102.56, "episode_media": {}, "episodes_this_iter": 47, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-11.899999999999974, -9.199999999999983, -4.699999999999996, -10.199999999999976, -7.799999999999985, -13.199999999999966, -4.999999999999995, -5.699999999999992, -13.799999999999967, -13.599999999999966, -41.70000000000026, -4.299999999999997, -4.699999999999996, -3.9999999999999982, -12.39999999999997, -5.2999999999999945, -10.799999999999974, -4.399999999999997, -5.7999999999999945, -5.699999999999992, -5.999999999999991, -18.199999999999992, -3.9999999999999982, -4.899999999999995, -44.300000000000296, -4.099999999999998, -4.999999999999995, -8.599999999999985, -6.29999999999999, -7.399999999999986, -59.40000000000032, -5.8999999999999915, -5.399999999999993, -11.699999999999985, -6.29999999999999, -14.49999999999997, -3.8999999999999986, -4.4999999999999964, -6.999999999999999, -6.89999999999999, -6.699999999999992, -4.399999999999997, -29.500000000000057, -4.699999999999996, -8.699999999999985, -4.299999999999999, -4.299999999999997, -33.800000000000146, -9.29999999999998, -7.499999999999986, -4.999999999999995, -16.89999999999999, -5.399999999999993, -14.899999999999968, -4.1999999999999975, -3.8999999999999986, -7.5999999999999925, -4.399999999999997, -5.000000000000003, -3.799999999999999, -4.1999999999999975, -10.199999999999976, -4.599999999999996, -2.600000000000002, -7.499999999999995, -7.299999999999992, -3.4000000000000004, -7.0999999999999925, -7.1, -60.60000000000037, -4.1999999999999975, -7.899999999999988, -4.999999999999995, -6.29999999999999, -4.099999999999998, -6.899999999999988, -5.099999999999994, -4.999999999999995, -42.20000000000018, -25.700000000000074, -5.899999999999992, -49.000000000000334, -36.600000000000115, -3.5, -5.199999999999994, -5.5999999999999925, -4.799999999999995, -6.6999999999999895, -23.099999999999984, -10.799999999999976, -2.800000000000002, -3.5999999999999996, -5.799999999999992, -6.8999999999999915, -10.099999999999984, -6.699999999999991, -4.399999999999997, -3.9999999999999982, -5.699999999999992, -5.4], "episode_lengths": [117, 91, 58, 113, 87, 143, 60, 68, 137, 129, 385, 54, 58, 51, 108, 63, 113, 55, 66, 68, 71, 187, 51, 60, 400, 52, 61, 91, 74, 85, 400, 70, 65, 98, 74, 125, 50, 56, 68, 78, 74, 55, 264, 58, 94, 52, 54, 280, 97, 86, 61, 164, 65, 150, 53, 50, 77, 55, 52, 49, 53, 104, 57, 37, 75, 78, 45, 76, 68, 400, 53, 86, 61, 74, 52, 80, 62, 61, 345, 249, 69, 400, 291, 46, 63, 67, 59, 76, 201, 111, 39, 47, 69, 76, 90, 75, 55, 51, 68, 57]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2523941174100833, "mean_inference_ms": 0.7227513093630684, "mean_action_processing_ms": 0.07625967038226218, "mean_env_wait_ms": 6.3446255850397915, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006714582443237305, "StateBufferConnector_ms": 0.003888368606567383, "ViewRequirementAgentConnector_ms": 0.09019804000854492}}, "episode_reward_max": -2.600000000000002, "episode_reward_min": -60.60000000000037, "episode_reward_mean": -10.464000000000016, "episode_len_mean": 102.56, "episodes_this_iter": 47, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-11.899999999999974, -9.199999999999983, -4.699999999999996, -10.199999999999976, -7.799999999999985, -13.199999999999966, -4.999999999999995, -5.699999999999992, -13.799999999999967, -13.599999999999966, -41.70000000000026, -4.299999999999997, -4.699999999999996, -3.9999999999999982, -12.39999999999997, -5.2999999999999945, -10.799999999999974, -4.399999999999997, -5.7999999999999945, -5.699999999999992, -5.999999999999991, -18.199999999999992, -3.9999999999999982, -4.899999999999995, -44.300000000000296, -4.099999999999998, -4.999999999999995, -8.599999999999985, -6.29999999999999, -7.399999999999986, -59.40000000000032, -5.8999999999999915, -5.399999999999993, -11.699999999999985, -6.29999999999999, -14.49999999999997, -3.8999999999999986, -4.4999999999999964, -6.999999999999999, -6.89999999999999, -6.699999999999992, -4.399999999999997, -29.500000000000057, -4.699999999999996, -8.699999999999985, -4.299999999999999, -4.299999999999997, -33.800000000000146, -9.29999999999998, -7.499999999999986, -4.999999999999995, -16.89999999999999, -5.399999999999993, -14.899999999999968, -4.1999999999999975, -3.8999999999999986, -7.5999999999999925, -4.399999999999997, -5.000000000000003, -3.799999999999999, -4.1999999999999975, -10.199999999999976, -4.599999999999996, -2.600000000000002, -7.499999999999995, -7.299999999999992, -3.4000000000000004, -7.0999999999999925, -7.1, -60.60000000000037, -4.1999999999999975, -7.899999999999988, -4.999999999999995, -6.29999999999999, -4.099999999999998, -6.899999999999988, -5.099999999999994, -4.999999999999995, -42.20000000000018, -25.700000000000074, -5.899999999999992, -49.000000000000334, -36.600000000000115, -3.5, -5.199999999999994, -5.5999999999999925, -4.799999999999995, -6.6999999999999895, -23.099999999999984, -10.799999999999976, -2.800000000000002, -3.5999999999999996, -5.799999999999992, -6.8999999999999915, -10.099999999999984, -6.699999999999991, -4.399999999999997, -3.9999999999999982, -5.699999999999992, -5.4], "episode_lengths": [117, 91, 58, 113, 87, 143, 60, 68, 137, 129, 385, 54, 58, 51, 108, 63, 113, 55, 66, 68, 71, 187, 51, 60, 400, 52, 61, 91, 74, 85, 400, 70, 65, 98, 74, 125, 50, 56, 68, 78, 74, 55, 264, 58, 94, 52, 54, 280, 97, 86, 61, 164, 65, 150, 53, 50, 77, 55, 52, 49, 53, 104, 57, 37, 75, 78, 45, 76, 68, 400, 53, 86, 61, 74, 52, 80, 62, 61, 345, 249, 69, 400, 291, 46, 63, 67, 59, 76, 201, 111, 39, 47, 69, 76, 90, 75, 55, 51, 68, 57]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2523941174100833, "mean_inference_ms": 0.7227513093630684, "mean_action_processing_ms": 0.07625967038226218, "mean_env_wait_ms": 6.3446255850397915, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006714582443237305, "StateBufferConnector_ms": 0.003888368606567383, "ViewRequirementAgentConnector_ms": 0.09019804000854492}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000, "num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 535.1734275156687, "num_env_steps_trained_throughput_per_sec": 535.1734275156687, "timesteps_total": 60000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 60000, "timers": {"training_iteration_time_ms": 7396.603, "sample_time_ms": 3860.233, "load_time_ms": 0.923, "load_throughput": 4335421.986, "learn_time_ms": 3532.069, "learn_throughput": 1132.481, "synch_weights_time_ms": 2.727}, "counters": {"num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000}, "done": false, "episodes_total": 362, "training_iteration": 15, "trial_id": "2154c_00000", "date": "2024-03-07_13-06-22", "timestamp": 1709834782, "time_this_iter_s": 7.4768242835998535, "time_total_s": 110.56628727912903, "pid": 116529, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7efea6399f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 110.56628727912903, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 28.97, "ram_util_percent": 50.69, "gpu_util_percent0": 0.093, "vram_util_percent0": 0.10364583333333335}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.10000000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 4.006427788775244, "policy_loss": -0.012556289977604343, "vf_loss": 4.018124981336697, "vf_explained_var": 0.056470718563243906, "kl": 0.008590923310852022, "entropy": 0.950731699441069, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 14415.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000}, "sampler_results": {"episode_reward_max": -2.600000000000002, "episode_reward_min": -60.60000000000037, "episode_reward_mean": -10.069000000000008, "episode_len_mean": 97.83, "episode_media": {}, "episodes_this_iter": 41, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4.399999999999997, -29.500000000000057, -4.699999999999996, -8.699999999999985, -4.299999999999999, -4.299999999999997, -33.800000000000146, -9.29999999999998, -7.499999999999986, -4.999999999999995, -16.89999999999999, -5.399999999999993, -14.899999999999968, -4.1999999999999975, -3.8999999999999986, -7.5999999999999925, -4.399999999999997, -5.000000000000003, -3.799999999999999, -4.1999999999999975, -10.199999999999976, -4.599999999999996, -2.600000000000002, -7.499999999999995, -7.299999999999992, -3.4000000000000004, -7.0999999999999925, -7.1, -60.60000000000037, -4.1999999999999975, -7.899999999999988, -4.999999999999995, -6.29999999999999, -4.099999999999998, -6.899999999999988, -5.099999999999994, -4.999999999999995, -42.20000000000018, -25.700000000000074, -5.899999999999992, -49.000000000000334, -36.600000000000115, -3.5, -5.199999999999994, -5.5999999999999925, -4.799999999999995, -6.6999999999999895, -23.099999999999984, -10.799999999999976, -2.800000000000002, -3.5999999999999996, -5.799999999999992, -6.8999999999999915, -10.099999999999984, -6.699999999999991, -4.399999999999997, -3.9999999999999982, -5.699999999999992, -5.4, -3.6999999999999993, -10.199999999999983, -4.799999999999995, -7.499999999999986, -7.69999999999999, -3.5, -4.899999999999995, -5.199999999999996, -5.299999999999994, -3.1000000000000014, -14.499999999999972, -23.000000000000078, -3.5, -6.099999999999991, -4.599999999999996, -20.99999999999997, -5.399999999999993, -10.899999999999977, -18.19999999999999, -16.29999999999997, -5.5999999999999925, -8.199999999999983, -3.5999999999999996, -29.200000000000003, -2.700000000000002, -14.59999999999996, -3.1000000000000014, -14.199999999999964, -27.000000000000007, -5.399999999999993, -4.1999999999999975, -3.6999999999999993, -7.299999999999992, -7.099999999999994, -4.099999999999998, -4.399999999999997, -5.299999999999994, -7.2999999999999865, -3.8999999999999986, -4.099999999999998, -51.30000000000019], "episode_lengths": [55, 264, 58, 94, 52, 54, 280, 97, 86, 61, 164, 65, 150, 53, 50, 77, 55, 52, 49, 53, 104, 57, 37, 75, 78, 45, 76, 68, 400, 53, 86, 61, 74, 52, 80, 62, 61, 345, 249, 69, 400, 291, 46, 63, 67, 59, 76, 201, 111, 39, 47, 69, 76, 90, 75, 55, 51, 68, 57, 48, 93, 59, 86, 82, 46, 60, 61, 64, 42, 111, 219, 46, 72, 57, 186, 65, 107, 187, 145, 67, 92, 47, 198, 38, 156, 42, 129, 214, 65, 53, 48, 79, 74, 52, 55, 64, 84, 50, 52, 346]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.25463524217551975, "mean_inference_ms": 0.7229460583256399, "mean_action_processing_ms": 0.07630292207246789, "mean_env_wait_ms": 6.357069279199976, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006637096405029297, "StateBufferConnector_ms": 0.003957033157348633, "ViewRequirementAgentConnector_ms": 0.09111309051513672}}, "episode_reward_max": -2.600000000000002, "episode_reward_min": -60.60000000000037, "episode_reward_mean": -10.069000000000008, "episode_len_mean": 97.83, "episodes_this_iter": 41, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-4.399999999999997, -29.500000000000057, -4.699999999999996, -8.699999999999985, -4.299999999999999, -4.299999999999997, -33.800000000000146, -9.29999999999998, -7.499999999999986, -4.999999999999995, -16.89999999999999, -5.399999999999993, -14.899999999999968, -4.1999999999999975, -3.8999999999999986, -7.5999999999999925, -4.399999999999997, -5.000000000000003, -3.799999999999999, -4.1999999999999975, -10.199999999999976, -4.599999999999996, -2.600000000000002, -7.499999999999995, -7.299999999999992, -3.4000000000000004, -7.0999999999999925, -7.1, -60.60000000000037, -4.1999999999999975, -7.899999999999988, -4.999999999999995, -6.29999999999999, -4.099999999999998, -6.899999999999988, -5.099999999999994, -4.999999999999995, -42.20000000000018, -25.700000000000074, -5.899999999999992, -49.000000000000334, -36.600000000000115, -3.5, -5.199999999999994, -5.5999999999999925, -4.799999999999995, -6.6999999999999895, -23.099999999999984, -10.799999999999976, -2.800000000000002, -3.5999999999999996, -5.799999999999992, -6.8999999999999915, -10.099999999999984, -6.699999999999991, -4.399999999999997, -3.9999999999999982, -5.699999999999992, -5.4, -3.6999999999999993, -10.199999999999983, -4.799999999999995, -7.499999999999986, -7.69999999999999, -3.5, -4.899999999999995, -5.199999999999996, -5.299999999999994, -3.1000000000000014, -14.499999999999972, -23.000000000000078, -3.5, -6.099999999999991, -4.599999999999996, -20.99999999999997, -5.399999999999993, -10.899999999999977, -18.19999999999999, -16.29999999999997, -5.5999999999999925, -8.199999999999983, -3.5999999999999996, -29.200000000000003, -2.700000000000002, -14.59999999999996, -3.1000000000000014, -14.199999999999964, -27.000000000000007, -5.399999999999993, -4.1999999999999975, -3.6999999999999993, -7.299999999999992, -7.099999999999994, -4.099999999999998, -4.399999999999997, -5.299999999999994, -7.2999999999999865, -3.8999999999999986, -4.099999999999998, -51.30000000000019], "episode_lengths": [55, 264, 58, 94, 52, 54, 280, 97, 86, 61, 164, 65, 150, 53, 50, 77, 55, 52, 49, 53, 104, 57, 37, 75, 78, 45, 76, 68, 400, 53, 86, 61, 74, 52, 80, 62, 61, 345, 249, 69, 400, 291, 46, 63, 67, 59, 76, 201, 111, 39, 47, 69, 76, 90, 75, 55, 51, 68, 57, 48, 93, 59, 86, 82, 46, 60, 61, 64, 42, 111, 219, 46, 72, 57, 186, 65, 107, 187, 145, 67, 92, 47, 198, 38, 156, 42, 129, 214, 65, 53, 48, 79, 74, 52, 55, 64, 84, 50, 52, 346]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.25463524217551975, "mean_inference_ms": 0.7229460583256399, "mean_action_processing_ms": 0.07630292207246789, "mean_env_wait_ms": 6.357069279199976, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006637096405029297, "StateBufferConnector_ms": 0.003957033157348633, "ViewRequirementAgentConnector_ms": 0.09111309051513672}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000, "num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 538.3209332658449, "num_env_steps_trained_throughput_per_sec": 538.3209332658449, "timesteps_total": 64000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 64000, "timers": {"training_iteration_time_ms": 7384.797, "sample_time_ms": 3864.808, "load_time_ms": 0.937, "load_throughput": 4268360.047, "learn_time_ms": 3515.69, "learn_throughput": 1137.757, "synch_weights_time_ms": 2.714}, "counters": {"num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000}, "done": false, "episodes_total": 403, "training_iteration": 16, "trial_id": "2154c_00000", "date": "2024-03-07_13-06-29", "timestamp": 1709834789, "time_this_iter_s": 7.433265209197998, "time_total_s": 117.99955248832703, "pid": 116529, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7efea6399f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 117.99955248832703, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 31.699999999999996, "ram_util_percent": 50.66666666666667, "gpu_util_percent0": 0.08333333333333333, "vram_util_percent0": 0.10364221643518517}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.10000000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 4.9882099343624, "policy_loss": -0.009277103576929338, "vf_loss": 4.9965041957875735, "vf_explained_var": 0.037872790649373045, "kl": 0.009828342482600448, "entropy": 0.9203155727796657, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 15345.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_agent_steps_sampled": 68000, "num_agent_steps_trained": 68000}, "sampler_results": {"episode_reward_max": -2.700000000000002, "episode_reward_min": -51.30000000000019, "episode_reward_mean": -8.829, "episode_len_mean": 88.02, "episode_media": {}, "episodes_this_iter": 43, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-5.199999999999994, -5.5999999999999925, -4.799999999999995, -6.6999999999999895, -23.099999999999984, -10.799999999999976, -2.800000000000002, -3.5999999999999996, -5.799999999999992, -6.8999999999999915, -10.099999999999984, -6.699999999999991, -4.399999999999997, -3.9999999999999982, -5.699999999999992, -5.4, -3.6999999999999993, -10.199999999999983, -4.799999999999995, -7.499999999999986, -7.69999999999999, -3.5, -4.899999999999995, -5.199999999999996, -5.299999999999994, -3.1000000000000014, -14.499999999999972, -23.000000000000078, -3.5, -6.099999999999991, -4.599999999999996, -20.99999999999997, -5.399999999999993, -10.899999999999977, -18.19999999999999, -16.29999999999997, -5.5999999999999925, -8.199999999999983, -3.5999999999999996, -29.200000000000003, -2.700000000000002, -14.59999999999996, -3.1000000000000014, -14.199999999999964, -27.000000000000007, -5.399999999999993, -4.1999999999999975, -3.6999999999999993, -7.299999999999992, -7.099999999999994, -4.099999999999998, -4.399999999999997, -5.299999999999994, -7.2999999999999865, -3.8999999999999986, -4.099999999999998, -51.30000000000019, -6.29999999999999, -13.399999999999967, -5.3999999999999995, -4.899999999999995, -10.899999999999977, -5.1000000000000005, -12.699999999999974, -48.50000000000024, -6.699999999999989, -6.799999999999991, -3.799999999999999, -19.299999999999986, -4.899999999999995, -3.799999999999999, -3.8999999999999986, -8.099999999999984, -5.899999999999992, -13.799999999999976, -3.8999999999999986, -3.5, -4.099999999999998, -3.200000000000001, -43.80000000000028, -4.099999999999998, -3.799999999999999, -4.399999999999997, -15.799999999999976, -4.4999999999999964, -4.899999999999996, -10.699999999999976, -4.599999999999996, -8.29999999999999, -4.4999999999999964, -4.899999999999995, -3.5, -4.899999999999995, -4.999999999999995, -10.099999999999984, -3.9999999999999982, -2.900000000000002, -6.999999999999989, -7.5999999999999925, -17.399999999999984], "episode_lengths": [63, 67, 59, 76, 201, 111, 39, 47, 69, 76, 90, 75, 55, 51, 68, 57, 48, 93, 59, 86, 82, 46, 60, 61, 64, 42, 111, 219, 46, 72, 57, 186, 65, 107, 187, 145, 67, 92, 47, 198, 38, 156, 42, 129, 214, 65, 53, 48, 79, 74, 52, 55, 64, 84, 50, 52, 346, 74, 118, 58, 60, 104, 55, 126, 336, 78, 76, 49, 154, 60, 49, 50, 92, 69, 104, 50, 46, 52, 43, 400, 52, 49, 55, 137, 56, 59, 117, 57, 82, 56, 60, 46, 60, 61, 100, 51, 40, 79, 79, 158]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.25697755017488233, "mean_inference_ms": 0.7224936342209196, "mean_action_processing_ms": 0.0763990669934169, "mean_env_wait_ms": 6.359107882802569, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006749629974365234, "StateBufferConnector_ms": 0.003943920135498047, "ViewRequirementAgentConnector_ms": 0.09023690223693848}}, "episode_reward_max": -2.700000000000002, "episode_reward_min": -51.30000000000019, "episode_reward_mean": -8.829, "episode_len_mean": 88.02, "episodes_this_iter": 43, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-5.199999999999994, -5.5999999999999925, -4.799999999999995, -6.6999999999999895, -23.099999999999984, -10.799999999999976, -2.800000000000002, -3.5999999999999996, -5.799999999999992, -6.8999999999999915, -10.099999999999984, -6.699999999999991, -4.399999999999997, -3.9999999999999982, -5.699999999999992, -5.4, -3.6999999999999993, -10.199999999999983, -4.799999999999995, -7.499999999999986, -7.69999999999999, -3.5, -4.899999999999995, -5.199999999999996, -5.299999999999994, -3.1000000000000014, -14.499999999999972, -23.000000000000078, -3.5, -6.099999999999991, -4.599999999999996, -20.99999999999997, -5.399999999999993, -10.899999999999977, -18.19999999999999, -16.29999999999997, -5.5999999999999925, -8.199999999999983, -3.5999999999999996, -29.200000000000003, -2.700000000000002, -14.59999999999996, -3.1000000000000014, -14.199999999999964, -27.000000000000007, -5.399999999999993, -4.1999999999999975, -3.6999999999999993, -7.299999999999992, -7.099999999999994, -4.099999999999998, -4.399999999999997, -5.299999999999994, -7.2999999999999865, -3.8999999999999986, -4.099999999999998, -51.30000000000019, -6.29999999999999, -13.399999999999967, -5.3999999999999995, -4.899999999999995, -10.899999999999977, -5.1000000000000005, -12.699999999999974, -48.50000000000024, -6.699999999999989, -6.799999999999991, -3.799999999999999, -19.299999999999986, -4.899999999999995, -3.799999999999999, -3.8999999999999986, -8.099999999999984, -5.899999999999992, -13.799999999999976, -3.8999999999999986, -3.5, -4.099999999999998, -3.200000000000001, -43.80000000000028, -4.099999999999998, -3.799999999999999, -4.399999999999997, -15.799999999999976, -4.4999999999999964, -4.899999999999996, -10.699999999999976, -4.599999999999996, -8.29999999999999, -4.4999999999999964, -4.899999999999995, -3.5, -4.899999999999995, -4.999999999999995, -10.099999999999984, -3.9999999999999982, -2.900000000000002, -6.999999999999989, -7.5999999999999925, -17.399999999999984], "episode_lengths": [63, 67, 59, 76, 201, 111, 39, 47, 69, 76, 90, 75, 55, 51, 68, 57, 48, 93, 59, 86, 82, 46, 60, 61, 64, 42, 111, 219, 46, 72, 57, 186, 65, 107, 187, 145, 67, 92, 47, 198, 38, 156, 42, 129, 214, 65, 53, 48, 79, 74, 52, 55, 64, 84, 50, 52, 346, 74, 118, 58, 60, 104, 55, 126, 336, 78, 76, 49, 154, 60, 49, 50, 92, 69, 104, 50, 46, 52, 43, 400, 52, 49, 55, 137, 56, 59, 117, 57, 82, 56, 60, 46, 60, 61, 100, 51, 40, 79, 79, 158]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.25697755017488233, "mean_inference_ms": 0.7224936342209196, "mean_action_processing_ms": 0.0763990669934169, "mean_env_wait_ms": 6.359107882802569, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006749629974365234, "StateBufferConnector_ms": 0.003943920135498047, "ViewRequirementAgentConnector_ms": 0.09023690223693848}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 68000, "num_agent_steps_trained": 68000, "num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 538.9359420705127, "num_env_steps_trained_throughput_per_sec": 538.9359420705127, "timesteps_total": 68000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 68000, "timers": {"training_iteration_time_ms": 7391.564, "sample_time_ms": 3870.458, "load_time_ms": 0.936, "load_throughput": 4275757.174, "learn_time_ms": 3516.848, "learn_throughput": 1137.382, "synch_weights_time_ms": 2.677}, "counters": {"num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_agent_steps_sampled": 68000, "num_agent_steps_trained": 68000}, "done": false, "episodes_total": 446, "training_iteration": 17, "trial_id": "2154c_00000", "date": "2024-03-07_13-06-37", "timestamp": 1709834797, "time_this_iter_s": 7.424482583999634, "time_total_s": 125.42403507232666, "pid": 116529, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7efea6399f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 125.42403507232666, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 29.28000000000001, "ram_util_percent": 50.68, "gpu_util_percent0": 0.077, "vram_util_percent0": 0.10362141927083332}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.10000000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 3.116018288990142, "policy_loss": -0.0054287779655668045, "vf_loss": 3.120734751496905, "vf_explained_var": 0.33136910277028236, "kl": 0.007123212890847267, "entropy": 0.8798371784148677, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 16275.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000}, "sampler_results": {"episode_reward_max": -2.5000000000000018, "episode_reward_min": -55.9000000000003, "episode_reward_mean": -8.97700000000001, "episode_len_mean": 87.96, "episode_media": {}, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-7.2999999999999865, -3.8999999999999986, -4.099999999999998, -51.30000000000019, -6.29999999999999, -13.399999999999967, -5.3999999999999995, -4.899999999999995, -10.899999999999977, -5.1000000000000005, -12.699999999999974, -48.50000000000024, -6.699999999999989, -6.799999999999991, -3.799999999999999, -19.299999999999986, -4.899999999999995, -3.799999999999999, -3.8999999999999986, -8.099999999999984, -5.899999999999992, -13.799999999999976, -3.8999999999999986, -3.5, -4.099999999999998, -3.200000000000001, -43.80000000000028, -4.099999999999998, -3.799999999999999, -4.399999999999997, -15.799999999999976, -4.4999999999999964, -4.899999999999996, -10.699999999999976, -4.599999999999996, -8.29999999999999, -4.4999999999999964, -4.899999999999995, -3.5, -4.899999999999995, -4.999999999999995, -10.099999999999984, -3.9999999999999982, -2.900000000000002, -6.999999999999989, -7.5999999999999925, -17.399999999999984, -27.900000000000087, -3.1000000000000014, -5.199999999999994, -42.60000000000013, -10.49999999999998, -2.800000000000002, -8.799999999999985, -5.199999999999994, -3.6999999999999993, -3.5, -3.5999999999999996, -5.699999999999992, -5.099999999999994, -5.499999999999993, -5.099999999999994, -32.10000000000006, -2.900000000000002, -2.5000000000000018, -2.5000000000000018, -20.1, -3.8999999999999986, -3.5, -3.0000000000000018, -3.8999999999999986, -55.9000000000003, -22.500000000000007, -6.799999999999999, -4.999999999999995, -3.1000000000000014, -4.399999999999997, -3.5999999999999996, -2.900000000000002, -3.200000000000001, -22.200000000000035, -9.399999999999995, -4.299999999999997, -12.499999999999972, -3.6999999999999993, -5.8999999999999915, -3.8999999999999986, -16.099999999999977, -5.199999999999997, -3.799999999999999, -11.299999999999976, -3.0000000000000018, -3.3000000000000007, -4.1999999999999975, -4.599999999999996, -3.4000000000000004, -3.5, -6.2999999999999945, -4.599999999999996, -4.1999999999999975], "episode_lengths": [84, 50, 52, 346, 74, 118, 58, 60, 104, 55, 126, 336, 78, 76, 49, 154, 60, 49, 50, 92, 69, 104, 50, 46, 52, 43, 400, 52, 49, 55, 137, 56, 59, 117, 57, 82, 56, 60, 46, 60, 61, 100, 51, 40, 79, 79, 158, 228, 42, 63, 317, 100, 39, 93, 63, 48, 46, 47, 68, 62, 66, 62, 248, 40, 36, 36, 196, 50, 46, 41, 50, 400, 203, 67, 61, 42, 55, 47, 40, 43, 197, 84, 54, 108, 48, 70, 50, 162, 60, 49, 115, 41, 44, 53, 57, 45, 46, 69, 57, 53]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2588735511035789, "mean_inference_ms": 0.722310110663023, "mean_action_processing_ms": 0.07630540930405137, "mean_env_wait_ms": 6.363840933039055, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006809234619140625, "StateBufferConnector_ms": 0.0039119720458984375, "ViewRequirementAgentConnector_ms": 0.0894312858581543}}, "episode_reward_max": -2.5000000000000018, "episode_reward_min": -55.9000000000003, "episode_reward_mean": -8.97700000000001, "episode_len_mean": 87.96, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-7.2999999999999865, -3.8999999999999986, -4.099999999999998, -51.30000000000019, -6.29999999999999, -13.399999999999967, -5.3999999999999995, -4.899999999999995, -10.899999999999977, -5.1000000000000005, -12.699999999999974, -48.50000000000024, -6.699999999999989, -6.799999999999991, -3.799999999999999, -19.299999999999986, -4.899999999999995, -3.799999999999999, -3.8999999999999986, -8.099999999999984, -5.899999999999992, -13.799999999999976, -3.8999999999999986, -3.5, -4.099999999999998, -3.200000000000001, -43.80000000000028, -4.099999999999998, -3.799999999999999, -4.399999999999997, -15.799999999999976, -4.4999999999999964, -4.899999999999996, -10.699999999999976, -4.599999999999996, -8.29999999999999, -4.4999999999999964, -4.899999999999995, -3.5, -4.899999999999995, -4.999999999999995, -10.099999999999984, -3.9999999999999982, -2.900000000000002, -6.999999999999989, -7.5999999999999925, -17.399999999999984, -27.900000000000087, -3.1000000000000014, -5.199999999999994, -42.60000000000013, -10.49999999999998, -2.800000000000002, -8.799999999999985, -5.199999999999994, -3.6999999999999993, -3.5, -3.5999999999999996, -5.699999999999992, -5.099999999999994, -5.499999999999993, -5.099999999999994, -32.10000000000006, -2.900000000000002, -2.5000000000000018, -2.5000000000000018, -20.1, -3.8999999999999986, -3.5, -3.0000000000000018, -3.8999999999999986, -55.9000000000003, -22.500000000000007, -6.799999999999999, -4.999999999999995, -3.1000000000000014, -4.399999999999997, -3.5999999999999996, -2.900000000000002, -3.200000000000001, -22.200000000000035, -9.399999999999995, -4.299999999999997, -12.499999999999972, -3.6999999999999993, -5.8999999999999915, -3.8999999999999986, -16.099999999999977, -5.199999999999997, -3.799999999999999, -11.299999999999976, -3.0000000000000018, -3.3000000000000007, -4.1999999999999975, -4.599999999999996, -3.4000000000000004, -3.5, -6.2999999999999945, -4.599999999999996, -4.1999999999999975], "episode_lengths": [84, 50, 52, 346, 74, 118, 58, 60, 104, 55, 126, 336, 78, 76, 49, 154, 60, 49, 50, 92, 69, 104, 50, 46, 52, 43, 400, 52, 49, 55, 137, 56, 59, 117, 57, 82, 56, 60, 46, 60, 61, 100, 51, 40, 79, 79, 158, 228, 42, 63, 317, 100, 39, 93, 63, 48, 46, 47, 68, 62, 66, 62, 248, 40, 36, 36, 196, 50, 46, 41, 50, 400, 203, 67, 61, 42, 55, 47, 40, 43, 197, 84, 54, 108, 48, 70, 50, 162, 60, 49, 115, 41, 44, 53, 57, 45, 46, 69, 57, 53]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2588735511035789, "mean_inference_ms": 0.722310110663023, "mean_action_processing_ms": 0.07630540930405137, "mean_env_wait_ms": 6.363840933039055, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006809234619140625, "StateBufferConnector_ms": 0.0039119720458984375, "ViewRequirementAgentConnector_ms": 0.0894312858581543}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000, "num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 530.3413157782934, "num_env_steps_trained_throughput_per_sec": 530.3413157782934, "timesteps_total": 72000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 72000, "timers": {"training_iteration_time_ms": 7417.969, "sample_time_ms": 3885.639, "load_time_ms": 0.927, "load_throughput": 4315793.59, "learn_time_ms": 3528.036, "learn_throughput": 1133.775, "synch_weights_time_ms": 2.718}, "counters": {"num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000}, "done": false, "episodes_total": 499, "training_iteration": 18, "trial_id": "2154c_00000", "date": "2024-03-07_13-06-44", "timestamp": 1709834804, "time_this_iter_s": 7.544982433319092, "time_total_s": 132.96901750564575, "pid": 116529, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7efea6399f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 132.96901750564575, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 30.060000000000002, "ram_util_percent": 50.7, "gpu_util_percent0": 0.09, "vram_util_percent0": 0.10362955729166667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.10000000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 2.2341092787247705, "policy_loss": -0.01623124136659567, "vf_loss": 2.2492457496062404, "vf_explained_var": 0.46143686918802157, "kl": 0.010947653692575488, "entropy": 0.8342329435451057, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 17205.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_agent_steps_sampled": 76000, "num_agent_steps_trained": 76000}, "sampler_results": {"episode_reward_max": -2.1000000000000014, "episode_reward_min": -55.9000000000003, "episode_reward_mean": -6.073, "episode_len_mean": 66.11, "episode_media": {}, "episodes_this_iter": 65, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2.5000000000000018, -20.1, -3.8999999999999986, -3.5, -3.0000000000000018, -3.8999999999999986, -55.9000000000003, -22.500000000000007, -6.799999999999999, -4.999999999999995, -3.1000000000000014, -4.399999999999997, -3.5999999999999996, -2.900000000000002, -3.200000000000001, -22.200000000000035, -9.399999999999995, -4.299999999999997, -12.499999999999972, -3.6999999999999993, -5.8999999999999915, -3.8999999999999986, -16.099999999999977, -5.199999999999997, -3.799999999999999, -11.299999999999976, -3.0000000000000018, -3.3000000000000007, -4.1999999999999975, -4.599999999999996, -3.4000000000000004, -3.5, -6.2999999999999945, -4.599999999999996, -4.1999999999999975, -3.9999999999999982, -3.8999999999999986, -2.900000000000002, -11.599999999999971, -4.799999999999999, -2.1000000000000014, -3.0000000000000018, -3.4000000000000004, -3.3000000000000007, -32.900000000000105, -10.799999999999983, -3.3000000000000007, -2.3000000000000016, -3.0000000000000018, -12.799999999999967, -3.5, -6.199999999999998, -4.299999999999997, -8.39999999999999, -5.8999999999999915, -3.9999999999999982, -8.799999999999988, -3.200000000000001, -3.3000000000000007, -16.79999999999997, -3.9999999999999982, -2.700000000000002, -2.4000000000000017, -3.5, -4.399999999999997, -3.0000000000000018, -3.5999999999999996, -5.499999999999998, -3.9999999999999982, -2.800000000000002, -3.9999999999999982, -4.299999999999997, -2.900000000000002, -3.200000000000001, -3.5, -4.699999999999996, -12.999999999999977, -6.099999999999996, -4.399999999999997, -3.9999999999999982, -4.8999999999999995, -2.3000000000000016, -3.1000000000000014, -3.6999999999999993, -3.5999999999999996, -2.5000000000000018, -3.5999999999999996, -3.5, -7.399999999999995, -3.5999999999999996, -3.5999999999999996, -3.4000000000000004, -2.800000000000002, -3.0000000000000018, -3.4000000000000004, -3.0000000000000018, -4.4999999999999964, -2.4000000000000017, -5.299999999999996, -3.5], "episode_lengths": [36, 196, 50, 46, 41, 50, 400, 203, 67, 61, 42, 55, 47, 40, 43, 197, 84, 54, 108, 48, 70, 50, 162, 60, 49, 115, 41, 44, 53, 57, 45, 46, 69, 57, 53, 51, 50, 40, 125, 55, 32, 41, 45, 44, 266, 102, 44, 34, 41, 127, 46, 64, 54, 87, 70, 51, 84, 43, 44, 147, 51, 38, 35, 46, 55, 41, 47, 60, 51, 39, 51, 54, 40, 43, 46, 58, 125, 66, 55, 51, 55, 34, 42, 48, 47, 36, 47, 46, 75, 47, 47, 45, 39, 41, 45, 41, 56, 35, 61, 46]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.26244896124419376, "mean_inference_ms": 0.7220109096733637, "mean_action_processing_ms": 0.07626107064683593, "mean_env_wait_ms": 6.381101788657654, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006728649139404297, "StateBufferConnector_ms": 0.003934383392333984, "ViewRequirementAgentConnector_ms": 0.09019327163696289}}, "episode_reward_max": -2.1000000000000014, "episode_reward_min": -55.9000000000003, "episode_reward_mean": -6.073, "episode_len_mean": 66.11, "episodes_this_iter": 65, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-2.5000000000000018, -20.1, -3.8999999999999986, -3.5, -3.0000000000000018, -3.8999999999999986, -55.9000000000003, -22.500000000000007, -6.799999999999999, -4.999999999999995, -3.1000000000000014, -4.399999999999997, -3.5999999999999996, -2.900000000000002, -3.200000000000001, -22.200000000000035, -9.399999999999995, -4.299999999999997, -12.499999999999972, -3.6999999999999993, -5.8999999999999915, -3.8999999999999986, -16.099999999999977, -5.199999999999997, -3.799999999999999, -11.299999999999976, -3.0000000000000018, -3.3000000000000007, -4.1999999999999975, -4.599999999999996, -3.4000000000000004, -3.5, -6.2999999999999945, -4.599999999999996, -4.1999999999999975, -3.9999999999999982, -3.8999999999999986, -2.900000000000002, -11.599999999999971, -4.799999999999999, -2.1000000000000014, -3.0000000000000018, -3.4000000000000004, -3.3000000000000007, -32.900000000000105, -10.799999999999983, -3.3000000000000007, -2.3000000000000016, -3.0000000000000018, -12.799999999999967, -3.5, -6.199999999999998, -4.299999999999997, -8.39999999999999, -5.8999999999999915, -3.9999999999999982, -8.799999999999988, -3.200000000000001, -3.3000000000000007, -16.79999999999997, -3.9999999999999982, -2.700000000000002, -2.4000000000000017, -3.5, -4.399999999999997, -3.0000000000000018, -3.5999999999999996, -5.499999999999998, -3.9999999999999982, -2.800000000000002, -3.9999999999999982, -4.299999999999997, -2.900000000000002, -3.200000000000001, -3.5, -4.699999999999996, -12.999999999999977, -6.099999999999996, -4.399999999999997, -3.9999999999999982, -4.8999999999999995, -2.3000000000000016, -3.1000000000000014, -3.6999999999999993, -3.5999999999999996, -2.5000000000000018, -3.5999999999999996, -3.5, -7.399999999999995, -3.5999999999999996, -3.5999999999999996, -3.4000000000000004, -2.800000000000002, -3.0000000000000018, -3.4000000000000004, -3.0000000000000018, -4.4999999999999964, -2.4000000000000017, -5.299999999999996, -3.5], "episode_lengths": [36, 196, 50, 46, 41, 50, 400, 203, 67, 61, 42, 55, 47, 40, 43, 197, 84, 54, 108, 48, 70, 50, 162, 60, 49, 115, 41, 44, 53, 57, 45, 46, 69, 57, 53, 51, 50, 40, 125, 55, 32, 41, 45, 44, 266, 102, 44, 34, 41, 127, 46, 64, 54, 87, 70, 51, 84, 43, 44, 147, 51, 38, 35, 46, 55, 41, 47, 60, 51, 39, 51, 54, 40, 43, 46, 58, 125, 66, 55, 51, 55, 34, 42, 48, 47, 36, 47, 46, 75, 47, 47, 45, 39, 41, 45, 41, 56, 35, 61, 46]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.26244896124419376, "mean_inference_ms": 0.7220109096733637, "mean_action_processing_ms": 0.07626107064683593, "mean_env_wait_ms": 6.381101788657654, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006728649139404297, "StateBufferConnector_ms": 0.003934383392333984, "ViewRequirementAgentConnector_ms": 0.09019327163696289}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 76000, "num_agent_steps_trained": 76000, "num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 523.3590213820773, "num_env_steps_trained_throughput_per_sec": 523.3590213820773, "timesteps_total": 76000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 76000, "timers": {"training_iteration_time_ms": 7450.468, "sample_time_ms": 3921.234, "load_time_ms": 0.936, "load_throughput": 4272272.982, "learn_time_ms": 3524.953, "learn_throughput": 1134.767, "synch_weights_time_ms": 2.688}, "counters": {"num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_agent_steps_sampled": 76000, "num_agent_steps_trained": 76000}, "done": false, "episodes_total": 564, "training_iteration": 19, "trial_id": "2154c_00000", "date": "2024-03-07_13-06-52", "timestamp": 1709834812, "time_this_iter_s": 7.6454997062683105, "time_total_s": 140.61451721191406, "pid": 116529, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7efea6399f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 140.61451721191406, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 31.159999999999997, "ram_util_percent": 50.72, "gpu_util_percent0": 0.09, "vram_util_percent0": 0.10365397135416668}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.10000000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 1.8981104187870157, "policy_loss": -0.002547516824016648, "vf_loss": 1.899902894476088, "vf_explained_var": 0.5900570067026282, "kl": 0.007550478369565157, "entropy": 0.8312682325481087, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 18135.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000}, "sampler_results": {"episode_reward_max": -1.9000000000000012, "episode_reward_min": -72.80000000000048, "episode_reward_mean": -5.189000000000002, "episode_len_mean": 57.21, "episode_media": {}, "episodes_this_iter": 70, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.9999999999999982, -4.299999999999997, -2.900000000000002, -3.200000000000001, -3.5, -4.699999999999996, -12.999999999999977, -6.099999999999996, -4.399999999999997, -3.9999999999999982, -4.8999999999999995, -2.3000000000000016, -3.1000000000000014, -3.6999999999999993, -3.5999999999999996, -2.5000000000000018, -3.5999999999999996, -3.5, -7.399999999999995, -3.5999999999999996, -3.5999999999999996, -3.4000000000000004, -2.800000000000002, -3.0000000000000018, -3.4000000000000004, -3.0000000000000018, -4.4999999999999964, -2.4000000000000017, -5.299999999999996, -3.5, -13.799999999999963, -3.0000000000000018, -5.099999999999999, -4.599999999999996, -4.399999999999998, -4.899999999999995, -10.499999999999993, -3.8999999999999986, -3.1000000000000014, -3.5, -5.399999999999998, -3.4000000000000004, -3.3000000000000007, -12.499999999999972, -3.3000000000000007, -4.799999999999995, -5.499999999999994, -3.1000000000000014, -3.8000000000000007, -7.5999999999999925, -12.499999999999977, -2.900000000000002, -4.599999999999996, -4.599999999999997, -4.399999999999997, -16.199999999999985, -8.399999999999988, -4.899999999999995, -2.4000000000000017, -3.6999999999999993, -2.900000000000002, -2.700000000000002, -2.4000000000000017, -2.5000000000000018, -2.4000000000000017, -3.5999999999999996, -3.5, -3.5999999999999996, -4.699999999999996, -1.9000000000000012, -3.4000000000000004, -4.4999999999999964, -5.599999999999996, -4.5, -4.899999999999995, -6.199999999999991, -5.899999999999999, -3.8999999999999995, -5.999999999999999, -3.1000000000000014, -2.1000000000000014, -4.1999999999999975, -3.5000000000000018, -4.299999999999997, -3.0000000000000018, -2.900000000000002, -2.600000000000002, -4.399999999999997, -4.899999999999995, -5.599999999999998, -2.5000000000000018, -4.299999999999997, -3.5, -4.500000000000003, -72.80000000000048, -4.0, -2.900000000000002, -3.6999999999999993, -3.4000000000000004, -4.299999999999997], "episode_lengths": [51, 54, 40, 43, 46, 58, 125, 66, 55, 51, 55, 34, 42, 48, 47, 36, 47, 46, 75, 47, 47, 45, 39, 41, 45, 41, 56, 35, 61, 46, 141, 41, 57, 57, 54, 60, 86, 50, 42, 46, 60, 45, 44, 121, 44, 59, 65, 42, 43, 79, 103, 40, 57, 56, 55, 156, 84, 60, 35, 48, 40, 38, 35, 36, 35, 47, 46, 47, 58, 30, 45, 56, 63, 52, 60, 72, 62, 47, 62, 42, 32, 53, 43, 54, 41, 40, 37, 55, 60, 61, 36, 54, 46, 49, 400, 48, 40, 48, 45, 54]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.26673958458733443, "mean_inference_ms": 0.7224927898866579, "mean_action_processing_ms": 0.07629736981730476, "mean_env_wait_ms": 6.419913865270632, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006479740142822266, "StateBufferConnector_ms": 0.003924369812011719, "ViewRequirementAgentConnector_ms": 0.08965373039245605}}, "episode_reward_max": -1.9000000000000012, "episode_reward_min": -72.80000000000048, "episode_reward_mean": -5.189000000000002, "episode_len_mean": 57.21, "episodes_this_iter": 70, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3.9999999999999982, -4.299999999999997, -2.900000000000002, -3.200000000000001, -3.5, -4.699999999999996, -12.999999999999977, -6.099999999999996, -4.399999999999997, -3.9999999999999982, -4.8999999999999995, -2.3000000000000016, -3.1000000000000014, -3.6999999999999993, -3.5999999999999996, -2.5000000000000018, -3.5999999999999996, -3.5, -7.399999999999995, -3.5999999999999996, -3.5999999999999996, -3.4000000000000004, -2.800000000000002, -3.0000000000000018, -3.4000000000000004, -3.0000000000000018, -4.4999999999999964, -2.4000000000000017, -5.299999999999996, -3.5, -13.799999999999963, -3.0000000000000018, -5.099999999999999, -4.599999999999996, -4.399999999999998, -4.899999999999995, -10.499999999999993, -3.8999999999999986, -3.1000000000000014, -3.5, -5.399999999999998, -3.4000000000000004, -3.3000000000000007, -12.499999999999972, -3.3000000000000007, -4.799999999999995, -5.499999999999994, -3.1000000000000014, -3.8000000000000007, -7.5999999999999925, -12.499999999999977, -2.900000000000002, -4.599999999999996, -4.599999999999997, -4.399999999999997, -16.199999999999985, -8.399999999999988, -4.899999999999995, -2.4000000000000017, -3.6999999999999993, -2.900000000000002, -2.700000000000002, -2.4000000000000017, -2.5000000000000018, -2.4000000000000017, -3.5999999999999996, -3.5, -3.5999999999999996, -4.699999999999996, -1.9000000000000012, -3.4000000000000004, -4.4999999999999964, -5.599999999999996, -4.5, -4.899999999999995, -6.199999999999991, -5.899999999999999, -3.8999999999999995, -5.999999999999999, -3.1000000000000014, -2.1000000000000014, -4.1999999999999975, -3.5000000000000018, -4.299999999999997, -3.0000000000000018, -2.900000000000002, -2.600000000000002, -4.399999999999997, -4.899999999999995, -5.599999999999998, -2.5000000000000018, -4.299999999999997, -3.5, -4.500000000000003, -72.80000000000048, -4.0, -2.900000000000002, -3.6999999999999993, -3.4000000000000004, -4.299999999999997], "episode_lengths": [51, 54, 40, 43, 46, 58, 125, 66, 55, 51, 55, 34, 42, 48, 47, 36, 47, 46, 75, 47, 47, 45, 39, 41, 45, 41, 56, 35, 61, 46, 141, 41, 57, 57, 54, 60, 86, 50, 42, 46, 60, 45, 44, 121, 44, 59, 65, 42, 43, 79, 103, 40, 57, 56, 55, 156, 84, 60, 35, 48, 40, 38, 35, 36, 35, 47, 46, 47, 58, 30, 45, 56, 63, 52, 60, 72, 62, 47, 62, 42, 32, 53, 43, 54, 41, 40, 37, 55, 60, 61, 36, 54, 46, 49, 400, 48, 40, 48, 45, 54]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.26673958458733443, "mean_inference_ms": 0.7224927898866579, "mean_action_processing_ms": 0.07629736981730476, "mean_env_wait_ms": 6.419913865270632, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006479740142822266, "StateBufferConnector_ms": 0.003924369812011719, "ViewRequirementAgentConnector_ms": 0.08965373039245605}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000, "num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 503.4386998131536, "num_env_steps_trained_throughput_per_sec": 503.4386998131536, "timesteps_total": 80000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 80000, "timers": {"training_iteration_time_ms": 7510.861, "sample_time_ms": 3990.706, "load_time_ms": 0.945, "load_throughput": 4234638.936, "learn_time_ms": 3515.789, "learn_throughput": 1137.725, "synch_weights_time_ms": 2.762}, "counters": {"num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000}, "done": false, "episodes_total": 634, "training_iteration": 20, "trial_id": "2154c_00000", "date": "2024-03-07_13-07-00", "timestamp": 1709834820, "time_this_iter_s": 7.948293209075928, "time_total_s": 148.56281042099, "pid": 116529, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7efea6399f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 148.56281042099, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 30.240000000000002, "ram_util_percent": 50.7, "gpu_util_percent0": 0.074, "vram_util_percent0": 0.10364583333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.10000000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 1.3106433618697964, "policy_loss": -0.014402744502470057, "vf_loss": 1.3242816006143887, "vf_explained_var": 0.5594371932168161, "kl": 0.0076449914255077136, "entropy": 0.7654664802935816, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 19065.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 84000}, "sampler_results": {"episode_reward_max": -1.9000000000000012, "episode_reward_min": -72.80000000000048, "episode_reward_mean": -4.513000000000004, "episode_len_mean": 51.46, "episode_media": {}, "episodes_this_iter": 78, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-5.999999999999999, -3.1000000000000014, -2.1000000000000014, -4.1999999999999975, -3.5000000000000018, -4.299999999999997, -3.0000000000000018, -2.900000000000002, -2.600000000000002, -4.399999999999997, -4.899999999999995, -5.599999999999998, -2.5000000000000018, -4.299999999999997, -3.5, -4.500000000000003, -72.80000000000048, -4.0, -2.900000000000002, -3.6999999999999993, -3.4000000000000004, -4.299999999999997, -3.1000000000000014, -3.0000000000000018, -3.200000000000001, -6.69999999999999, -2.900000000000002, -5.299999999999995, -3.6000000000000023, -3.200000000000001, -3.200000000000001, -3.6999999999999993, -2.600000000000002, -4.4999999999999964, -4.099999999999998, -2.900000000000002, -3.5, -4.399999999999997, -2.0000000000000013, -3.4000000000000004, -4.899999999999996, -8.899999999999983, -2.700000000000002, -2.5000000000000018, -3.799999999999999, -2.800000000000002, -3.8999999999999986, -6.19999999999999, -4.099999999999998, -3.9999999999999982, -3.4000000000000004, -5.000000000000001, -2.1000000000000014, -3.3000000000000007, -4.899999999999999, -2.600000000000002, -3.8999999999999986, -6.1999999999999975, -3.8999999999999986, -2.3000000000000016, -5.199999999999994, -3.4000000000000012, -6.499999999999989, -5.500000000000003, -3.0000000000000018, -2.600000000000002, -2.1000000000000014, -6.3, -3.500000000000001, -1.9000000000000012, -9.999999999999986, -4.099999999999998, -3.200000000000001, -4.899999999999999, -2.2000000000000015, -2.1000000000000014, -4.299999999999997, -3.6999999999999993, -3.4000000000000004, -3.6999999999999993, -3.4000000000000004, -3.1000000000000014, -4.399999999999997, -3.5, -3.5999999999999996, -2.600000000000002, -3.0000000000000018, -2.5000000000000018, -4.499999999999999, -3.5, -2.5000000000000018, -5.700000000000001, -3.9999999999999982, -2.5000000000000018, -6.0999999999999925, -3.3000000000000007, -3.799999999999999, -2.700000000000002, -3.799999999999999, -2.0000000000000013], "episode_lengths": [62, 42, 32, 53, 43, 54, 41, 40, 37, 55, 60, 61, 36, 54, 46, 49, 400, 48, 40, 48, 45, 54, 42, 41, 43, 76, 40, 62, 44, 43, 43, 48, 37, 56, 52, 40, 46, 55, 31, 45, 59, 98, 38, 36, 49, 39, 50, 73, 52, 51, 45, 54, 32, 44, 55, 37, 50, 65, 50, 34, 63, 44, 76, 55, 41, 37, 32, 63, 43, 30, 88, 52, 43, 54, 33, 32, 54, 48, 45, 48, 45, 42, 55, 46, 47, 37, 41, 36, 53, 46, 36, 58, 51, 36, 70, 44, 49, 38, 49, 31]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2708827769052275, "mean_inference_ms": 0.722681708213633, "mean_action_processing_ms": 0.0763220743313246, "mean_env_wait_ms": 6.45463457849957, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0065042972564697266, "StateBufferConnector_ms": 0.0038399696350097656, "ViewRequirementAgentConnector_ms": 0.08847713470458984}}, "episode_reward_max": -1.9000000000000012, "episode_reward_min": -72.80000000000048, "episode_reward_mean": -4.513000000000004, "episode_len_mean": 51.46, "episodes_this_iter": 78, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-5.999999999999999, -3.1000000000000014, -2.1000000000000014, -4.1999999999999975, -3.5000000000000018, -4.299999999999997, -3.0000000000000018, -2.900000000000002, -2.600000000000002, -4.399999999999997, -4.899999999999995, -5.599999999999998, -2.5000000000000018, -4.299999999999997, -3.5, -4.500000000000003, -72.80000000000048, -4.0, -2.900000000000002, -3.6999999999999993, -3.4000000000000004, -4.299999999999997, -3.1000000000000014, -3.0000000000000018, -3.200000000000001, -6.69999999999999, -2.900000000000002, -5.299999999999995, -3.6000000000000023, -3.200000000000001, -3.200000000000001, -3.6999999999999993, -2.600000000000002, -4.4999999999999964, -4.099999999999998, -2.900000000000002, -3.5, -4.399999999999997, -2.0000000000000013, -3.4000000000000004, -4.899999999999996, -8.899999999999983, -2.700000000000002, -2.5000000000000018, -3.799999999999999, -2.800000000000002, -3.8999999999999986, -6.19999999999999, -4.099999999999998, -3.9999999999999982, -3.4000000000000004, -5.000000000000001, -2.1000000000000014, -3.3000000000000007, -4.899999999999999, -2.600000000000002, -3.8999999999999986, -6.1999999999999975, -3.8999999999999986, -2.3000000000000016, -5.199999999999994, -3.4000000000000012, -6.499999999999989, -5.500000000000003, -3.0000000000000018, -2.600000000000002, -2.1000000000000014, -6.3, -3.500000000000001, -1.9000000000000012, -9.999999999999986, -4.099999999999998, -3.200000000000001, -4.899999999999999, -2.2000000000000015, -2.1000000000000014, -4.299999999999997, -3.6999999999999993, -3.4000000000000004, -3.6999999999999993, -3.4000000000000004, -3.1000000000000014, -4.399999999999997, -3.5, -3.5999999999999996, -2.600000000000002, -3.0000000000000018, -2.5000000000000018, -4.499999999999999, -3.5, -2.5000000000000018, -5.700000000000001, -3.9999999999999982, -2.5000000000000018, -6.0999999999999925, -3.3000000000000007, -3.799999999999999, -2.700000000000002, -3.799999999999999, -2.0000000000000013], "episode_lengths": [62, 42, 32, 53, 43, 54, 41, 40, 37, 55, 60, 61, 36, 54, 46, 49, 400, 48, 40, 48, 45, 54, 42, 41, 43, 76, 40, 62, 44, 43, 43, 48, 37, 56, 52, 40, 46, 55, 31, 45, 59, 98, 38, 36, 49, 39, 50, 73, 52, 51, 45, 54, 32, 44, 55, 37, 50, 65, 50, 34, 63, 44, 76, 55, 41, 37, 32, 63, 43, 30, 88, 52, 43, 54, 33, 32, 54, 48, 45, 48, 45, 42, 55, 46, 47, 37, 41, 36, 53, 46, 36, 58, 51, 36, 70, 44, 49, 38, 49, 31]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2708827769052275, "mean_inference_ms": 0.722681708213633, "mean_action_processing_ms": 0.0763220743313246, "mean_env_wait_ms": 6.45463457849957, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0065042972564697266, "StateBufferConnector_ms": 0.0038399696350097656, "ViewRequirementAgentConnector_ms": 0.08847713470458984}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 84000, "num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 522.3710289166332, "num_env_steps_trained_throughput_per_sec": 522.3710289166332, "timesteps_total": 84000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 84000, "timers": {"training_iteration_time_ms": 7528.554, "sample_time_ms": 4011.717, "load_time_ms": 0.941, "load_throughput": 4252671.922, "learn_time_ms": 3512.493, "learn_throughput": 1138.792, "synch_weights_time_ms": 2.746}, "counters": {"num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 84000}, "done": false, "episodes_total": 712, "training_iteration": 21, "trial_id": "2154c_00000", "date": "2024-03-07_13-07-08", "timestamp": 1709834828, "time_this_iter_s": 7.6601738929748535, "time_total_s": 156.22298431396484, "pid": 116529, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7efea6399f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 156.22298431396484, "iterations_since_restore": 21, "perf": {"cpu_util_percent": 30.589999999999996, "ram_util_percent": 50.7, "gpu_util_percent0": 0.07300000000000001, "vram_util_percent0": 0.09898274739583332}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.10000000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 0.7189252221396366, "policy_loss": -0.008722636976369446, "vf_loss": 0.7267613832748705, "vf_explained_var": 0.7873685661182609, "kl": 0.008864744922093791, "entropy": 0.7467713688650439, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 19995.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_agent_steps_sampled": 88000, "num_agent_steps_trained": 88000}, "sampler_results": {"episode_reward_max": -2.0000000000000013, "episode_reward_min": -47.60000000000015, "episode_reward_mean": -4.347000000000001, "episode_len_mean": 51.12, "episode_media": {}, "episodes_this_iter": 83, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.5, -3.5999999999999996, -2.600000000000002, -3.0000000000000018, -2.5000000000000018, -4.499999999999999, -3.5, -2.5000000000000018, -5.700000000000001, -3.9999999999999982, -2.5000000000000018, -6.0999999999999925, -3.3000000000000007, -3.799999999999999, -2.700000000000002, -3.799999999999999, -2.0000000000000013, -3.4000000000000004, -2.1000000000000014, -2.700000000000002, -2.1000000000000014, -6.300000000000002, -3.1000000000000014, -4.4999999999999964, -2.700000000000002, -4.699999999999996, -3.0000000000000018, -3.200000000000001, -47.60000000000015, -3.3000000000000007, -2.800000000000002, -3.5, -4.4999999999999964, -2.900000000000002, -3.3000000000000007, -2.800000000000002, -3.1000000000000014, -3.200000000000001, -5.299999999999994, -3.6999999999999993, -2.800000000000002, -2.3000000000000016, -2.900000000000002, -6.599999999999999, -2.900000000000002, -5.199999999999994, -4.699999999999999, -3.5999999999999996, -4.3999999999999995, -4.099999999999999, -3.3000000000000007, -2.800000000000002, -4.599999999999998, -3.200000000000001, -6.499999999999993, -3.8999999999999986, -7.799999999999992, -3.1000000000000014, -2.800000000000002, -5.8999999999999915, -4.599999999999996, -5.099999999999994, -3.999999999999999, -2.700000000000002, -3.200000000000001, -3.1000000000000014, -4.000000000000001, -2.5000000000000018, -2.4000000000000017, -3.8999999999999986, -3.5, -4.299999999999997, -3.4000000000000004, -4.999999999999998, -3.3000000000000007, -2.800000000000002, -4.099999999999998, -4.099999999999998, -4.599999999999996, -3.8999999999999986, -3.6999999999999993, -2.800000000000002, -3.9999999999999982, -3.0000000000000018, -2.600000000000002, -2.0000000000000013, -3.1000000000000014, -2.700000000000002, -3.4000000000000004, -35.700000000000045, -2.800000000000002, -4.299999999999997, -3.1000000000000014, -2.1000000000000014, -2.600000000000002, -3.200000000000001, -3.4000000000000004, -2.900000000000002, -2.900000000000002, -3.1000000000000014], "episode_lengths": [46, 47, 37, 41, 36, 53, 46, 36, 58, 51, 36, 70, 44, 49, 38, 49, 31, 45, 32, 38, 32, 61, 42, 56, 38, 58, 41, 43, 334, 44, 39, 43, 56, 40, 44, 39, 42, 43, 64, 48, 39, 34, 40, 66, 40, 63, 54, 47, 52, 51, 44, 39, 55, 43, 72, 50, 82, 42, 39, 70, 57, 62, 50, 38, 43, 42, 48, 36, 35, 50, 46, 54, 45, 57, 44, 39, 52, 52, 57, 50, 48, 39, 51, 41, 37, 31, 42, 38, 45, 257, 39, 54, 42, 32, 37, 43, 45, 40, 40, 42]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.27470709779230407, "mean_inference_ms": 0.7228539976438617, "mean_action_processing_ms": 0.07625166333430144, "mean_env_wait_ms": 6.477418308982854, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006747245788574219, "StateBufferConnector_ms": 0.0038971900939941406, "ViewRequirementAgentConnector_ms": 0.09008908271789551}}, "episode_reward_max": -2.0000000000000013, "episode_reward_min": -47.60000000000015, "episode_reward_mean": -4.347000000000001, "episode_len_mean": 51.12, "episodes_this_iter": 83, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3.5, -3.5999999999999996, -2.600000000000002, -3.0000000000000018, -2.5000000000000018, -4.499999999999999, -3.5, -2.5000000000000018, -5.700000000000001, -3.9999999999999982, -2.5000000000000018, -6.0999999999999925, -3.3000000000000007, -3.799999999999999, -2.700000000000002, -3.799999999999999, -2.0000000000000013, -3.4000000000000004, -2.1000000000000014, -2.700000000000002, -2.1000000000000014, -6.300000000000002, -3.1000000000000014, -4.4999999999999964, -2.700000000000002, -4.699999999999996, -3.0000000000000018, -3.200000000000001, -47.60000000000015, -3.3000000000000007, -2.800000000000002, -3.5, -4.4999999999999964, -2.900000000000002, -3.3000000000000007, -2.800000000000002, -3.1000000000000014, -3.200000000000001, -5.299999999999994, -3.6999999999999993, -2.800000000000002, -2.3000000000000016, -2.900000000000002, -6.599999999999999, -2.900000000000002, -5.199999999999994, -4.699999999999999, -3.5999999999999996, -4.3999999999999995, -4.099999999999999, -3.3000000000000007, -2.800000000000002, -4.599999999999998, -3.200000000000001, -6.499999999999993, -3.8999999999999986, -7.799999999999992, -3.1000000000000014, -2.800000000000002, -5.8999999999999915, -4.599999999999996, -5.099999999999994, -3.999999999999999, -2.700000000000002, -3.200000000000001, -3.1000000000000014, -4.000000000000001, -2.5000000000000018, -2.4000000000000017, -3.8999999999999986, -3.5, -4.299999999999997, -3.4000000000000004, -4.999999999999998, -3.3000000000000007, -2.800000000000002, -4.099999999999998, -4.099999999999998, -4.599999999999996, -3.8999999999999986, -3.6999999999999993, -2.800000000000002, -3.9999999999999982, -3.0000000000000018, -2.600000000000002, -2.0000000000000013, -3.1000000000000014, -2.700000000000002, -3.4000000000000004, -35.700000000000045, -2.800000000000002, -4.299999999999997, -3.1000000000000014, -2.1000000000000014, -2.600000000000002, -3.200000000000001, -3.4000000000000004, -2.900000000000002, -2.900000000000002, -3.1000000000000014], "episode_lengths": [46, 47, 37, 41, 36, 53, 46, 36, 58, 51, 36, 70, 44, 49, 38, 49, 31, 45, 32, 38, 32, 61, 42, 56, 38, 58, 41, 43, 334, 44, 39, 43, 56, 40, 44, 39, 42, 43, 64, 48, 39, 34, 40, 66, 40, 63, 54, 47, 52, 51, 44, 39, 55, 43, 72, 50, 82, 42, 39, 70, 57, 62, 50, 38, 43, 42, 48, 36, 35, 50, 46, 54, 45, 57, 44, 39, 52, 52, 57, 50, 48, 39, 51, 41, 37, 31, 42, 38, 45, 257, 39, 54, 42, 32, 37, 43, 45, 40, 40, 42]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.27470709779230407, "mean_inference_ms": 0.7228539976438617, "mean_action_processing_ms": 0.07625166333430144, "mean_env_wait_ms": 6.477418308982854, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006747245788574219, "StateBufferConnector_ms": 0.0038971900939941406, "ViewRequirementAgentConnector_ms": 0.09008908271789551}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 88000, "num_agent_steps_trained": 88000, "num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 508.6832973471645, "num_env_steps_trained_throughput_per_sec": 508.6832973471645, "timesteps_total": 88000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 88000, "timers": {"training_iteration_time_ms": 7585.728, "sample_time_ms": 4065.267, "load_time_ms": 0.938, "load_throughput": 4264454.273, "learn_time_ms": 3516.202, "learn_throughput": 1137.591, "synch_weights_time_ms": 2.679}, "counters": {"num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_agent_steps_sampled": 88000, "num_agent_steps_trained": 88000}, "done": false, "episodes_total": 795, "training_iteration": 22, "trial_id": "2154c_00000", "date": "2024-03-07_13-07-16", "timestamp": 1709834836, "time_this_iter_s": 7.8661065101623535, "time_total_s": 164.0890908241272, "pid": 116529, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7efea6399f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 164.0890908241272, "iterations_since_restore": 22, "perf": {"cpu_util_percent": 30.640000000000004, "ram_util_percent": 50.71, "gpu_util_percent0": 0.072, "vram_util_percent0": 0.09434407552083335}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.10000000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 0.41264162646958313, "policy_loss": -0.009007774629900532, "vf_loss": 0.4208419820153585, "vf_explained_var": 0.8312400367311252, "kl": 0.008074172176072125, "entropy": 0.6880680350847141, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 20925.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_agent_steps_sampled": 92000, "num_agent_steps_trained": 92000}, "sampler_results": {"episode_reward_max": -1.600000000000001, "episode_reward_min": -7.199999999999996, "episode_reward_mean": -3.309000000000001, "episode_len_mean": 43.66, "episode_media": {}, "episodes_this_iter": 90, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2.800000000000002, -4.299999999999997, -3.1000000000000014, -2.1000000000000014, -2.600000000000002, -3.200000000000001, -3.4000000000000004, -2.900000000000002, -2.900000000000002, -3.1000000000000014, -3.0000000000000018, -2.1000000000000014, -2.900000000000002, -2.5000000000000018, -4.800000000000001, -2.700000000000002, -5.5999999999999925, -3.4000000000000004, -3.200000000000001, -3.5999999999999996, -4.1999999999999975, -2.4000000000000017, -2.1000000000000014, -3.6999999999999993, -7.199999999999996, -3.3000000000000007, -2.4000000000000017, -2.4000000000000017, -3.0000000000000018, -4.099999999999998, -2.700000000000002, -4.299999999999997, -3.799999999999999, -2.800000000000002, -2.700000000000002, -3.5, -3.1000000000000014, -2.4000000000000017, -2.900000000000002, -3.0000000000000018, -2.5000000000000018, -2.800000000000002, -2.3000000000000016, -2.800000000000002, -3.8000000000000016, -2.600000000000002, -3.6999999999999993, -3.200000000000001, -5.800000000000001, -3.200000000000001, -2.800000000000002, -3.6999999999999993, -5.799999999999992, -4.4999999999999964, -2.600000000000002, -3.5, -1.600000000000001, -2.5000000000000018, -3.5999999999999996, -3.5999999999999996, -3.8999999999999986, -3.0000000000000018, -3.4000000000000004, -3.6999999999999993, -2.700000000000002, -2.800000000000002, -3.1000000000000014, -4.700000000000002, -3.1000000000000014, -3.3000000000000007, -3.1000000000000014, -5.899999999999992, -3.4000000000000004, -4.299999999999998, -3.1000000000000014, -4.100000000000001, -3.1000000000000014, -3.1000000000000014, -3.0000000000000018, -2.3000000000000016, -3.9999999999999982, -2.800000000000002, -3.0000000000000018, -3.3000000000000007, -3.3000000000000007, -4.599999999999996, -2.700000000000002, -4.699999999999996, -4.099999999999998, -3.1000000000000014, -2.900000000000002, -2.900000000000002, -3.0000000000000018, -2.4000000000000017, -2.900000000000002, -3.8999999999999986, -3.1000000000000014, -2.2000000000000015, -2.600000000000002, -3.200000000000001], "episode_lengths": [39, 54, 42, 32, 37, 43, 45, 40, 40, 42, 41, 32, 40, 36, 52, 38, 67, 45, 43, 47, 53, 35, 32, 48, 74, 44, 35, 35, 41, 52, 38, 54, 49, 39, 38, 46, 42, 35, 40, 41, 36, 39, 34, 39, 46, 37, 48, 43, 59, 43, 39, 48, 69, 56, 37, 46, 27, 36, 47, 47, 50, 41, 45, 48, 38, 39, 42, 51, 42, 44, 42, 69, 45, 53, 42, 47, 42, 42, 41, 34, 51, 39, 41, 44, 44, 57, 38, 58, 52, 42, 40, 40, 41, 35, 40, 50, 42, 33, 37, 43]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2775874214806914, "mean_inference_ms": 0.723503308314081, "mean_action_processing_ms": 0.07616516706001292, "mean_env_wait_ms": 6.497758033106054, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006711483001708984, "StateBufferConnector_ms": 0.003904581069946289, "ViewRequirementAgentConnector_ms": 0.08996319770812988}}, "episode_reward_max": -1.600000000000001, "episode_reward_min": -7.199999999999996, "episode_reward_mean": -3.309000000000001, "episode_len_mean": 43.66, "episodes_this_iter": 90, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-2.800000000000002, -4.299999999999997, -3.1000000000000014, -2.1000000000000014, -2.600000000000002, -3.200000000000001, -3.4000000000000004, -2.900000000000002, -2.900000000000002, -3.1000000000000014, -3.0000000000000018, -2.1000000000000014, -2.900000000000002, -2.5000000000000018, -4.800000000000001, -2.700000000000002, -5.5999999999999925, -3.4000000000000004, -3.200000000000001, -3.5999999999999996, -4.1999999999999975, -2.4000000000000017, -2.1000000000000014, -3.6999999999999993, -7.199999999999996, -3.3000000000000007, -2.4000000000000017, -2.4000000000000017, -3.0000000000000018, -4.099999999999998, -2.700000000000002, -4.299999999999997, -3.799999999999999, -2.800000000000002, -2.700000000000002, -3.5, -3.1000000000000014, -2.4000000000000017, -2.900000000000002, -3.0000000000000018, -2.5000000000000018, -2.800000000000002, -2.3000000000000016, -2.800000000000002, -3.8000000000000016, -2.600000000000002, -3.6999999999999993, -3.200000000000001, -5.800000000000001, -3.200000000000001, -2.800000000000002, -3.6999999999999993, -5.799999999999992, -4.4999999999999964, -2.600000000000002, -3.5, -1.600000000000001, -2.5000000000000018, -3.5999999999999996, -3.5999999999999996, -3.8999999999999986, -3.0000000000000018, -3.4000000000000004, -3.6999999999999993, -2.700000000000002, -2.800000000000002, -3.1000000000000014, -4.700000000000002, -3.1000000000000014, -3.3000000000000007, -3.1000000000000014, -5.899999999999992, -3.4000000000000004, -4.299999999999998, -3.1000000000000014, -4.100000000000001, -3.1000000000000014, -3.1000000000000014, -3.0000000000000018, -2.3000000000000016, -3.9999999999999982, -2.800000000000002, -3.0000000000000018, -3.3000000000000007, -3.3000000000000007, -4.599999999999996, -2.700000000000002, -4.699999999999996, -4.099999999999998, -3.1000000000000014, -2.900000000000002, -2.900000000000002, -3.0000000000000018, -2.4000000000000017, -2.900000000000002, -3.8999999999999986, -3.1000000000000014, -2.2000000000000015, -2.600000000000002, -3.200000000000001], "episode_lengths": [39, 54, 42, 32, 37, 43, 45, 40, 40, 42, 41, 32, 40, 36, 52, 38, 67, 45, 43, 47, 53, 35, 32, 48, 74, 44, 35, 35, 41, 52, 38, 54, 49, 39, 38, 46, 42, 35, 40, 41, 36, 39, 34, 39, 46, 37, 48, 43, 59, 43, 39, 48, 69, 56, 37, 46, 27, 36, 47, 47, 50, 41, 45, 48, 38, 39, 42, 51, 42, 44, 42, 69, 45, 53, 42, 47, 42, 42, 41, 34, 51, 39, 41, 44, 44, 57, 38, 58, 52, 42, 40, 40, 41, 35, 40, 50, 42, 33, 37, 43]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2775874214806914, "mean_inference_ms": 0.723503308314081, "mean_action_processing_ms": 0.07616516706001292, "mean_env_wait_ms": 6.497758033106054, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006711483001708984, "StateBufferConnector_ms": 0.003904581069946289, "ViewRequirementAgentConnector_ms": 0.08996319770812988}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 92000, "num_agent_steps_trained": 92000, "num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 521.5570296010658, "num_env_steps_trained_throughput_per_sec": 521.5570296010658, "timesteps_total": 92000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 92000, "timers": {"training_iteration_time_ms": 7612.201, "sample_time_ms": 4095.574, "load_time_ms": 0.941, "load_throughput": 4252348.558, "learn_time_ms": 3512.366, "learn_throughput": 1138.833, "synch_weights_time_ms": 2.678}, "counters": {"num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_agent_steps_sampled": 92000, "num_agent_steps_trained": 92000}, "done": false, "episodes_total": 885, "training_iteration": 23, "trial_id": "2154c_00000", "date": "2024-03-07_13-07-23", "timestamp": 1709834843, "time_this_iter_s": 7.672101020812988, "time_total_s": 171.76119184494019, "pid": 116529, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7efea6399f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 171.76119184494019, "iterations_since_restore": 23, "perf": {"cpu_util_percent": 30.45, "ram_util_percent": 50.8, "gpu_util_percent0": 0.074, "vram_util_percent0": 0.09436848958333335}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.10000000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 0.48183414931834667, "policy_loss": -0.013923818933006416, "vf_loss": 0.4947457271397755, "vf_explained_var": 0.8026956214699694, "kl": 0.010122410894216973, "entropy": 0.6504601191448909, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 21855.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000}, "sampler_results": {"episode_reward_max": -1.700000000000001, "episode_reward_min": -12.799999999999967, "episode_reward_mean": -3.1290000000000004, "episode_len_mean": 42.17, "episode_media": {}, "episodes_this_iter": 95, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.8999999999999986, -3.1000000000000014, -2.2000000000000015, -2.600000000000002, -3.200000000000001, -2.4000000000000017, -3.5999999999999996, -3.5999999999999996, -2.5000000000000018, -2.700000000000002, -2.2000000000000015, -2.4000000000000017, -2.600000000000002, -2.4000000000000017, -2.5000000000000018, -2.600000000000002, -2.5000000000000018, -2.4000000000000017, -3.9999999999999982, -2.900000000000002, -4.4999999999999964, -2.5000000000000018, -3.5, -3.1000000000000014, -3.5, -2.4000000000000017, -3.0000000000000018, -2.800000000000002, -1.9000000000000012, -2.600000000000002, -2.900000000000002, -3.0000000000000018, -2.800000000000002, -2.900000000000002, -1.700000000000001, -2.900000000000002, -4.099999999999998, -12.799999999999967, -3.5999999999999996, -2.900000000000002, -3.1000000000000014, -3.799999999999999, -5.099999999999994, -5.399999999999993, -3.3000000000000007, -2.4000000000000017, -2.800000000000002, -3.6999999999999993, -2.900000000000002, -2.900000000000002, -3.3000000000000007, -2.4000000000000017, -3.799999999999999, -2.1000000000000014, -2.800000000000002, -3.799999999999999, -2.5000000000000018, -2.900000000000002, -3.5, -3.1000000000000014, -2.700000000000002, -2.0000000000000013, -2.900000000000002, -3.4000000000000004, -4.099999999999998, -1.8000000000000012, -2.5000000000000018, -3.5999999999999996, -2.5000000000000018, -2.800000000000002, -1.8000000000000012, -2.4000000000000017, -3.6999999999999993, -3.1000000000000014, -3.6999999999999993, -3.1000000000000014, -3.4000000000000004, -2.3000000000000016, -4.999999999999996, -2.4000000000000017, -2.2000000000000015, -3.200000000000001, -3.799999999999999, -6.59999999999999, -4.1, -3.0000000000000018, -3.1000000000000014, -3.5, -3.0000000000000018, -3.1000000000000014, -3.4000000000000012, -2.3000000000000016, -3.1000000000000014, -2.4000000000000017, -2.600000000000002, -1.9000000000000012, -2.700000000000002, -2.3000000000000016, -2.600000000000002, -3.5], "episode_lengths": [50, 42, 33, 37, 43, 35, 47, 47, 36, 38, 33, 35, 37, 35, 36, 37, 36, 35, 51, 40, 56, 36, 46, 42, 46, 35, 41, 39, 30, 37, 40, 41, 39, 40, 28, 40, 52, 139, 47, 40, 42, 49, 62, 65, 44, 35, 39, 44, 40, 40, 44, 35, 49, 32, 39, 49, 36, 40, 46, 42, 38, 31, 40, 45, 52, 29, 36, 47, 36, 39, 29, 35, 48, 42, 48, 42, 45, 34, 60, 35, 33, 43, 49, 76, 47, 41, 42, 46, 41, 42, 44, 34, 42, 35, 37, 30, 38, 34, 37, 46]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.28194092098410023, "mean_inference_ms": 0.7237991803517008, "mean_action_processing_ms": 0.07622273407709003, "mean_env_wait_ms": 6.5247746332054355, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0068285465240478516, "StateBufferConnector_ms": 0.003963947296142578, "ViewRequirementAgentConnector_ms": 0.09112691879272461}}, "episode_reward_max": -1.700000000000001, "episode_reward_min": -12.799999999999967, "episode_reward_mean": -3.1290000000000004, "episode_len_mean": 42.17, "episodes_this_iter": 95, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3.8999999999999986, -3.1000000000000014, -2.2000000000000015, -2.600000000000002, -3.200000000000001, -2.4000000000000017, -3.5999999999999996, -3.5999999999999996, -2.5000000000000018, -2.700000000000002, -2.2000000000000015, -2.4000000000000017, -2.600000000000002, -2.4000000000000017, -2.5000000000000018, -2.600000000000002, -2.5000000000000018, -2.4000000000000017, -3.9999999999999982, -2.900000000000002, -4.4999999999999964, -2.5000000000000018, -3.5, -3.1000000000000014, -3.5, -2.4000000000000017, -3.0000000000000018, -2.800000000000002, -1.9000000000000012, -2.600000000000002, -2.900000000000002, -3.0000000000000018, -2.800000000000002, -2.900000000000002, -1.700000000000001, -2.900000000000002, -4.099999999999998, -12.799999999999967, -3.5999999999999996, -2.900000000000002, -3.1000000000000014, -3.799999999999999, -5.099999999999994, -5.399999999999993, -3.3000000000000007, -2.4000000000000017, -2.800000000000002, -3.6999999999999993, -2.900000000000002, -2.900000000000002, -3.3000000000000007, -2.4000000000000017, -3.799999999999999, -2.1000000000000014, -2.800000000000002, -3.799999999999999, -2.5000000000000018, -2.900000000000002, -3.5, -3.1000000000000014, -2.700000000000002, -2.0000000000000013, -2.900000000000002, -3.4000000000000004, -4.099999999999998, -1.8000000000000012, -2.5000000000000018, -3.5999999999999996, -2.5000000000000018, -2.800000000000002, -1.8000000000000012, -2.4000000000000017, -3.6999999999999993, -3.1000000000000014, -3.6999999999999993, -3.1000000000000014, -3.4000000000000004, -2.3000000000000016, -4.999999999999996, -2.4000000000000017, -2.2000000000000015, -3.200000000000001, -3.799999999999999, -6.59999999999999, -4.1, -3.0000000000000018, -3.1000000000000014, -3.5, -3.0000000000000018, -3.1000000000000014, -3.4000000000000012, -2.3000000000000016, -3.1000000000000014, -2.4000000000000017, -2.600000000000002, -1.9000000000000012, -2.700000000000002, -2.3000000000000016, -2.600000000000002, -3.5], "episode_lengths": [50, 42, 33, 37, 43, 35, 47, 47, 36, 38, 33, 35, 37, 35, 36, 37, 36, 35, 51, 40, 56, 36, 46, 42, 46, 35, 41, 39, 30, 37, 40, 41, 39, 40, 28, 40, 52, 139, 47, 40, 42, 49, 62, 65, 44, 35, 39, 44, 40, 40, 44, 35, 49, 32, 39, 49, 36, 40, 46, 42, 38, 31, 40, 45, 52, 29, 36, 47, 36, 39, 29, 35, 48, 42, 48, 42, 45, 34, 60, 35, 33, 43, 49, 76, 47, 41, 42, 46, 41, 42, 44, 34, 42, 35, 37, 30, 38, 34, 37, 46]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.28194092098410023, "mean_inference_ms": 0.7237991803517008, "mean_action_processing_ms": 0.07622273407709003, "mean_env_wait_ms": 6.5247746332054355, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0068285465240478516, "StateBufferConnector_ms": 0.003963947296142578, "ViewRequirementAgentConnector_ms": 0.09112691879272461}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000, "num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 516.2808867903249, "num_env_steps_trained_throughput_per_sec": 516.2808867903249, "timesteps_total": 96000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 96000, "timers": {"training_iteration_time_ms": 7639.493, "sample_time_ms": 4136.119, "load_time_ms": 0.953, "load_throughput": 4197557.107, "learn_time_ms": 3499.12, "learn_throughput": 1143.144, "synch_weights_time_ms": 2.65}, "counters": {"num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000}, "done": false, "episodes_total": 980, "training_iteration": 24, "trial_id": "2154c_00000", "date": "2024-03-07_13-07-31", "timestamp": 1709834851, "time_this_iter_s": 7.750708818435669, "time_total_s": 179.51190066337585, "pid": 116529, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7efea6399f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 179.51190066337585, "iterations_since_restore": 24, "perf": {"cpu_util_percent": 31.590000000000003, "ram_util_percent": 50.8, "gpu_util_percent0": 0.073, "vram_util_percent0": 0.09437662760416665}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.10000000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 0.9402471771209641, "policy_loss": -0.003548084519883638, "vf_loss": 0.9422977252653049, "vf_explained_var": 0.8095425944174489, "kl": 0.01497529881643801, "entropy": 0.5996921275251655, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 22785.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_agent_steps_sampled": 100000, "num_agent_steps_trained": 100000}, "sampler_results": {"episode_reward_max": -1.600000000000001, "episode_reward_min": -69.10000000000038, "episode_reward_mean": -3.3260000000000054, "episode_len_mean": 41.22, "episode_media": {}, "episodes_this_iter": 99, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.5, -2.900000000000002, -2.700000000000002, -3.0000000000000018, -2.5000000000000018, -1.700000000000001, -2.1000000000000014, -2.600000000000002, -2.5000000000000018, -2.1000000000000014, -2.3000000000000016, -2.1000000000000014, -2.600000000000002, -2.2000000000000015, -2.3000000000000016, -2.1000000000000014, -2.5000000000000018, -3.9999999999999982, -2.1000000000000014, -3.0000000000000018, -3.799999999999999, -2.700000000000002, -4.099999999999998, -2.3000000000000016, -2.3000000000000016, -2.2000000000000015, -2.600000000000002, -2.800000000000002, -2.1000000000000014, -2.600000000000002, -2.5000000000000018, -2.4000000000000017, -2.4000000000000017, -3.1000000000000014, -3.3000000000000007, -3.0000000000000018, -2.700000000000002, -2.2000000000000015, -2.800000000000002, -3.0000000000000018, -2.4000000000000017, -2.4000000000000017, -69.10000000000038, -4.099999999999998, -3.3000000000000007, -3.5999999999999996, -2.4000000000000017, -2.900000000000002, -2.1000000000000014, -2.1000000000000014, -2.600000000000002, -1.9000000000000012, -3.6999999999999993, -3.4000000000000004, -2.3000000000000016, -2.3000000000000016, -3.1000000000000014, -3.1000000000000014, -2.3000000000000016, -2.5000000000000018, -2.600000000000002, -2.5000000000000018, -1.600000000000001, -2.800000000000002, -2.700000000000002, -1.9000000000000012, -3.0000000000000018, -2.3000000000000016, -3.6999999999999993, -2.0000000000000013, -2.3000000000000016, -2.900000000000002, -3.3000000000000007, -2.4000000000000017, -2.700000000000002, -1.9000000000000012, -3.0000000000000018, -2.600000000000002, -2.600000000000002, -3.0000000000000018, -3.3000000000000007, -2.700000000000002, -2.4000000000000017, -2.1000000000000014, -3.200000000000001, -2.700000000000002, -3.4000000000000012, -2.900000000000002, -3.4000000000000004, -2.4000000000000017, -1.9000000000000012, -2.700000000000002, -2.2000000000000015, -2.900000000000002, -2.800000000000002, -2.800000000000002, -1.700000000000001, -3.3000000000000007, -2.700000000000002, -2.0000000000000013], "episode_lengths": [46, 40, 38, 41, 36, 28, 32, 37, 36, 32, 34, 32, 37, 33, 34, 32, 36, 51, 32, 41, 49, 38, 52, 34, 34, 33, 37, 39, 32, 37, 36, 35, 35, 42, 44, 41, 38, 33, 39, 41, 35, 35, 400, 52, 44, 47, 35, 40, 32, 32, 37, 30, 48, 45, 34, 34, 42, 42, 34, 36, 37, 36, 27, 39, 38, 30, 41, 34, 48, 31, 34, 40, 44, 35, 38, 30, 41, 37, 37, 41, 44, 38, 35, 32, 43, 38, 43, 40, 45, 35, 30, 38, 33, 40, 39, 39, 28, 44, 38, 31]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.287163297538067, "mean_inference_ms": 0.7247483486259668, "mean_action_processing_ms": 0.0762232312831115, "mean_env_wait_ms": 6.568743220061164, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0066509246826171875, "StateBufferConnector_ms": 0.003909587860107422, "ViewRequirementAgentConnector_ms": 0.0895388126373291}}, "episode_reward_max": -1.600000000000001, "episode_reward_min": -69.10000000000038, "episode_reward_mean": -3.3260000000000054, "episode_len_mean": 41.22, "episodes_this_iter": 99, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3.5, -2.900000000000002, -2.700000000000002, -3.0000000000000018, -2.5000000000000018, -1.700000000000001, -2.1000000000000014, -2.600000000000002, -2.5000000000000018, -2.1000000000000014, -2.3000000000000016, -2.1000000000000014, -2.600000000000002, -2.2000000000000015, -2.3000000000000016, -2.1000000000000014, -2.5000000000000018, -3.9999999999999982, -2.1000000000000014, -3.0000000000000018, -3.799999999999999, -2.700000000000002, -4.099999999999998, -2.3000000000000016, -2.3000000000000016, -2.2000000000000015, -2.600000000000002, -2.800000000000002, -2.1000000000000014, -2.600000000000002, -2.5000000000000018, -2.4000000000000017, -2.4000000000000017, -3.1000000000000014, -3.3000000000000007, -3.0000000000000018, -2.700000000000002, -2.2000000000000015, -2.800000000000002, -3.0000000000000018, -2.4000000000000017, -2.4000000000000017, -69.10000000000038, -4.099999999999998, -3.3000000000000007, -3.5999999999999996, -2.4000000000000017, -2.900000000000002, -2.1000000000000014, -2.1000000000000014, -2.600000000000002, -1.9000000000000012, -3.6999999999999993, -3.4000000000000004, -2.3000000000000016, -2.3000000000000016, -3.1000000000000014, -3.1000000000000014, -2.3000000000000016, -2.5000000000000018, -2.600000000000002, -2.5000000000000018, -1.600000000000001, -2.800000000000002, -2.700000000000002, -1.9000000000000012, -3.0000000000000018, -2.3000000000000016, -3.6999999999999993, -2.0000000000000013, -2.3000000000000016, -2.900000000000002, -3.3000000000000007, -2.4000000000000017, -2.700000000000002, -1.9000000000000012, -3.0000000000000018, -2.600000000000002, -2.600000000000002, -3.0000000000000018, -3.3000000000000007, -2.700000000000002, -2.4000000000000017, -2.1000000000000014, -3.200000000000001, -2.700000000000002, -3.4000000000000012, -2.900000000000002, -3.4000000000000004, -2.4000000000000017, -1.9000000000000012, -2.700000000000002, -2.2000000000000015, -2.900000000000002, -2.800000000000002, -2.800000000000002, -1.700000000000001, -3.3000000000000007, -2.700000000000002, -2.0000000000000013], "episode_lengths": [46, 40, 38, 41, 36, 28, 32, 37, 36, 32, 34, 32, 37, 33, 34, 32, 36, 51, 32, 41, 49, 38, 52, 34, 34, 33, 37, 39, 32, 37, 36, 35, 35, 42, 44, 41, 38, 33, 39, 41, 35, 35, 400, 52, 44, 47, 35, 40, 32, 32, 37, 30, 48, 45, 34, 34, 42, 42, 34, 36, 37, 36, 27, 39, 38, 30, 41, 34, 48, 31, 34, 40, 44, 35, 38, 30, 41, 37, 37, 41, 44, 38, 35, 32, 43, 38, 43, 40, 45, 35, 30, 38, 33, 40, 39, 39, 28, 44, 38, 31]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.287163297538067, "mean_inference_ms": 0.7247483486259668, "mean_action_processing_ms": 0.0762232312831115, "mean_env_wait_ms": 6.568743220061164, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0066509246826171875, "StateBufferConnector_ms": 0.003909587860107422, "ViewRequirementAgentConnector_ms": 0.0895388126373291}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 100000, "num_agent_steps_trained": 100000, "num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 498.0520351250854, "num_env_steps_trained_throughput_per_sec": 498.0520351250854, "timesteps_total": 100000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 100000, "timers": {"training_iteration_time_ms": 7695.2, "sample_time_ms": 4192.364, "load_time_ms": 0.953, "load_throughput": 4197977.23, "learn_time_ms": 3498.57, "learn_throughput": 1143.324, "synch_weights_time_ms": 2.666}, "counters": {"num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_agent_steps_sampled": 100000, "num_agent_steps_trained": 100000}, "done": false, "episodes_total": 1079, "training_iteration": 25, "trial_id": "2154c_00000", "date": "2024-03-07_13-07-39", "timestamp": 1709834859, "time_this_iter_s": 8.034132480621338, "time_total_s": 187.5460331439972, "pid": 116529, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7efea6399f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 187.5460331439972, "iterations_since_restore": 25, "perf": {"cpu_util_percent": 29.40909090909091, "ram_util_percent": 50.809090909090905, "gpu_util_percent0": 0.08545454545454546, "vram_util_percent0": 0.0943566524621212}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.10000000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 1.253660144683935, "policy_loss": -0.007423418588055077, "vf_loss": 1.2603477938280951, "vf_explained_var": 0.665425609068204, "kl": 0.007357652239936156, "entropy": 0.5748151053344049, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 23715.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 104000, "num_env_steps_trained": 104000, "num_agent_steps_sampled": 104000, "num_agent_steps_trained": 104000}, "sampler_results": {"episode_reward_max": -1.5000000000000009, "episode_reward_min": -45.800000000000125, "episode_reward_mean": -3.376000000000003, "episode_len_mean": 41.69, "episode_media": {}, "episodes_this_iter": 95, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2.800000000000002, -1.700000000000001, -3.3000000000000007, -2.700000000000002, -2.0000000000000013, -2.4000000000000017, -2.1000000000000014, -2.700000000000002, -2.700000000000002, -4.999999999999999, -3.5, -2.2000000000000015, -2.1000000000000014, -3.1000000000000014, -1.5000000000000009, -2.3000000000000016, -2.1000000000000014, -2.2000000000000015, -2.3000000000000016, -2.3000000000000016, -2.0000000000000013, -2.5000000000000018, -2.5000000000000018, -1.9000000000000012, -15.699999999999985, -2.3000000000000016, -2.5000000000000018, -6.19999999999999, -2.1000000000000014, -1.600000000000001, -2.5000000000000018, -2.2000000000000015, -2.0000000000000013, -1.9000000000000012, -2.4000000000000017, -1.600000000000001, -2.900000000000002, -2.900000000000002, -2.800000000000002, -3.7, -2.600000000000002, -3.3000000000000007, -2.600000000000002, -2.700000000000002, -2.2000000000000015, -3.4000000000000004, -6.300000000000001, -3.6000000000000005, -2.0000000000000013, -2.1000000000000014, -1.600000000000001, -2.2000000000000015, -1.600000000000001, -2.800000000000002, -2.0000000000000013, -4.599999999999996, -2.3000000000000016, -2.4000000000000017, -2.0000000000000013, -45.800000000000125, -2.700000000000002, -3.0000000000000018, -3.6999999999999993, -3.0000000000000018, -3.4000000000000004, -2.800000000000002, -2.900000000000002, -4.999999999999997, -2.600000000000002, -2.2000000000000015, -3.4000000000000004, -1.8000000000000012, -2.700000000000002, -1.9000000000000012, -2.3000000000000016, -2.900000000000002, -2.4000000000000017, -2.5000000000000018, -1.9000000000000012, -2.4000000000000017, -2.4000000000000017, -21.300000000000026, -2.1000000000000014, -2.4000000000000017, -2.2000000000000015, -1.600000000000001, -3.0000000000000018, -2.1000000000000014, -2.0000000000000013, -2.800000000000002, -2.3000000000000016, -3.200000000000001, -2.600000000000002, -2.2000000000000015, -2.2000000000000015, -2.3000000000000016, -2.3000000000000016, -3.5, -1.8000000000000012, -4.499999999999998], "episode_lengths": [39, 28, 44, 38, 31, 35, 32, 38, 38, 53, 46, 33, 32, 42, 26, 34, 32, 33, 34, 34, 31, 36, 36, 30, 120, 34, 36, 69, 32, 27, 36, 33, 31, 30, 35, 27, 40, 40, 39, 47, 37, 44, 37, 38, 33, 45, 62, 46, 31, 32, 27, 33, 27, 39, 31, 57, 34, 35, 31, 281, 38, 41, 48, 41, 45, 39, 40, 55, 37, 33, 44, 29, 38, 30, 34, 40, 35, 36, 30, 35, 35, 193, 32, 35, 33, 27, 41, 32, 31, 39, 34, 43, 37, 33, 33, 34, 34, 46, 29, 49]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2896341288041326, "mean_inference_ms": 0.7242670631213493, "mean_action_processing_ms": 0.07632342630086245, "mean_env_wait_ms": 6.581103167640176, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006697654724121094, "StateBufferConnector_ms": 0.0038957595825195312, "ViewRequirementAgentConnector_ms": 0.08925199508666992}}, "episode_reward_max": -1.5000000000000009, "episode_reward_min": -45.800000000000125, "episode_reward_mean": -3.376000000000003, "episode_len_mean": 41.69, "episodes_this_iter": 95, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-2.800000000000002, -1.700000000000001, -3.3000000000000007, -2.700000000000002, -2.0000000000000013, -2.4000000000000017, -2.1000000000000014, -2.700000000000002, -2.700000000000002, -4.999999999999999, -3.5, -2.2000000000000015, -2.1000000000000014, -3.1000000000000014, -1.5000000000000009, -2.3000000000000016, -2.1000000000000014, -2.2000000000000015, -2.3000000000000016, -2.3000000000000016, -2.0000000000000013, -2.5000000000000018, -2.5000000000000018, -1.9000000000000012, -15.699999999999985, -2.3000000000000016, -2.5000000000000018, -6.19999999999999, -2.1000000000000014, -1.600000000000001, -2.5000000000000018, -2.2000000000000015, -2.0000000000000013, -1.9000000000000012, -2.4000000000000017, -1.600000000000001, -2.900000000000002, -2.900000000000002, -2.800000000000002, -3.7, -2.600000000000002, -3.3000000000000007, -2.600000000000002, -2.700000000000002, -2.2000000000000015, -3.4000000000000004, -6.300000000000001, -3.6000000000000005, -2.0000000000000013, -2.1000000000000014, -1.600000000000001, -2.2000000000000015, -1.600000000000001, -2.800000000000002, -2.0000000000000013, -4.599999999999996, -2.3000000000000016, -2.4000000000000017, -2.0000000000000013, -45.800000000000125, -2.700000000000002, -3.0000000000000018, -3.6999999999999993, -3.0000000000000018, -3.4000000000000004, -2.800000000000002, -2.900000000000002, -4.999999999999997, -2.600000000000002, -2.2000000000000015, -3.4000000000000004, -1.8000000000000012, -2.700000000000002, -1.9000000000000012, -2.3000000000000016, -2.900000000000002, -2.4000000000000017, -2.5000000000000018, -1.9000000000000012, -2.4000000000000017, -2.4000000000000017, -21.300000000000026, -2.1000000000000014, -2.4000000000000017, -2.2000000000000015, -1.600000000000001, -3.0000000000000018, -2.1000000000000014, -2.0000000000000013, -2.800000000000002, -2.3000000000000016, -3.200000000000001, -2.600000000000002, -2.2000000000000015, -2.2000000000000015, -2.3000000000000016, -2.3000000000000016, -3.5, -1.8000000000000012, -4.499999999999998], "episode_lengths": [39, 28, 44, 38, 31, 35, 32, 38, 38, 53, 46, 33, 32, 42, 26, 34, 32, 33, 34, 34, 31, 36, 36, 30, 120, 34, 36, 69, 32, 27, 36, 33, 31, 30, 35, 27, 40, 40, 39, 47, 37, 44, 37, 38, 33, 45, 62, 46, 31, 32, 27, 33, 27, 39, 31, 57, 34, 35, 31, 281, 38, 41, 48, 41, 45, 39, 40, 55, 37, 33, 44, 29, 38, 30, 34, 40, 35, 36, 30, 35, 35, 193, 32, 35, 33, 27, 41, 32, 31, 39, 34, 43, 37, 33, 33, 34, 34, 46, 29, 49]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2896341288041326, "mean_inference_ms": 0.7242670631213493, "mean_action_processing_ms": 0.07632342630086245, "mean_env_wait_ms": 6.581103167640176, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006697654724121094, "StateBufferConnector_ms": 0.0038957595825195312, "ViewRequirementAgentConnector_ms": 0.08925199508666992}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 104000, "num_agent_steps_trained": 104000, "num_env_steps_sampled": 104000, "num_env_steps_trained": 104000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 511.8006245430819, "num_env_steps_trained_throughput_per_sec": 511.8006245430819, "timesteps_total": 104000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 104000, "timers": {"training_iteration_time_ms": 7733.703, "sample_time_ms": 4223.223, "load_time_ms": 0.95, "load_throughput": 4212734.714, "learn_time_ms": 3506.221, "learn_throughput": 1140.829, "synch_weights_time_ms": 2.661}, "counters": {"num_env_steps_sampled": 104000, "num_env_steps_trained": 104000, "num_agent_steps_sampled": 104000, "num_agent_steps_trained": 104000}, "done": false, "episodes_total": 1174, "training_iteration": 26, "trial_id": "2154c_00000", "date": "2024-03-07_13-07-47", "timestamp": 1709834867, "time_this_iter_s": 7.818441867828369, "time_total_s": 195.36447501182556, "pid": 116529, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7efea6399f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 195.36447501182556, "iterations_since_restore": 26, "perf": {"cpu_util_percent": 32.260000000000005, "ram_util_percent": 50.8, "gpu_util_percent0": 0.089, "vram_util_percent0": 0.09435221354166665}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.10000000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 0.6408678110907986, "policy_loss": -0.000629829046546772, "vf_loss": 0.6403377316892147, "vf_explained_var": 0.7708255408912577, "kl": 0.011599021206018948, "entropy": 0.5204779407670421, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 24645.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_agent_steps_sampled": 108000, "num_agent_steps_trained": 108000}, "sampler_results": {"episode_reward_max": -1.5000000000000009, "episode_reward_min": -21.499999999999996, "episode_reward_mean": -2.7392523364485983, "episode_len_mean": 37.38317757009346, "episode_media": {}, "episodes_this_iter": 107, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1.9000000000000012, -1.9000000000000012, -1.8000000000000012, -2.4000000000000017, -2.0000000000000013, -4.299999999999997, -1.9000000000000012, -2.5000000000000018, -1.8000000000000012, -2.1000000000000014, -1.8000000000000012, -2.900000000000002, -2.700000000000002, -2.4000000000000017, -4.1000000000000005, -4.3, -2.3000000000000016, -1.5000000000000009, -2.0000000000000013, -3.1000000000000014, -2.5000000000000018, -2.600000000000002, -2.800000000000002, -2.3000000000000016, -2.0000000000000013, -3.5, -2.3000000000000016, -2.1000000000000014, -1.9000000000000012, -3.1000000000000014, -2.3000000000000016, -3.6999999999999993, -2.700000000000002, -3.3000000000000007, -1.8000000000000012, -2.3000000000000016, -2.0000000000000013, -2.700000000000002, -2.1000000000000014, -4.999999999999995, -1.700000000000001, -1.600000000000001, -21.499999999999996, -2.0000000000000013, -3.8000000000000007, -2.1000000000000014, -2.0000000000000013, -2.5000000000000018, -3.6999999999999993, -2.1000000000000014, -2.800000000000002, -1.9000000000000012, -3.0000000000000018, -3.5, -2.2000000000000015, -5.699999999999994, -3.1000000000000014, -1.9000000000000012, -2.0000000000000013, -5.799999999999992, -2.1000000000000014, -2.800000000000002, -1.9000000000000012, -2.5000000000000018, -1.5000000000000009, -2.1000000000000014, -2.2000000000000015, -2.2000000000000015, -4.999999999999995, -1.9000000000000012, -2.1000000000000014, -2.4000000000000017, -3.8, -2.0000000000000013, -1.8000000000000012, -2.700000000000002, -2.5000000000000018, -2.4000000000000017, -1.700000000000001, -2.4000000000000017, -2.1000000000000014, -2.600000000000002, -1.9000000000000012, -3.1000000000000014, -2.3000000000000016, -3.1000000000000014, -2.0000000000000013, -2.2000000000000015, -2.4000000000000017, -2.0000000000000013, -2.4000000000000017, -3.3000000000000007, -2.1000000000000014, -2.600000000000002, -4.5, -2.5000000000000018, -2.4000000000000017, -2.5000000000000018, -1.9000000000000012, -2.4000000000000017, -2.700000000000002, -4.099999999999998, -2.1000000000000014, -2.3000000000000016, -1.700000000000001, -1.9000000000000012, -2.4000000000000017], "episode_lengths": [30, 30, 29, 35, 31, 54, 30, 36, 29, 32, 29, 40, 38, 35, 49, 51, 34, 26, 31, 42, 36, 37, 39, 34, 31, 46, 34, 32, 30, 42, 34, 48, 38, 42, 29, 34, 31, 38, 32, 61, 28, 27, 143, 31, 45, 32, 31, 36, 48, 32, 39, 30, 41, 46, 33, 66, 42, 30, 31, 69, 32, 39, 30, 36, 26, 32, 33, 33, 61, 30, 32, 35, 44, 31, 29, 38, 36, 35, 28, 35, 32, 37, 30, 41, 34, 42, 31, 33, 35, 31, 35, 44, 32, 37, 52, 36, 35, 36, 30, 35, 38, 51, 32, 34, 28, 30, 35]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.29368286751938616, "mean_inference_ms": 0.7243693007642225, "mean_action_processing_ms": 0.07629656186368178, "mean_env_wait_ms": 6.609624741195847, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006662796590929833, "StateBufferConnector_ms": 0.003912738550489194, "ViewRequirementAgentConnector_ms": 0.08969106406809013}}, "episode_reward_max": -1.5000000000000009, "episode_reward_min": -21.499999999999996, "episode_reward_mean": -2.7392523364485983, "episode_len_mean": 37.38317757009346, "episodes_this_iter": 107, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1.9000000000000012, -1.9000000000000012, -1.8000000000000012, -2.4000000000000017, -2.0000000000000013, -4.299999999999997, -1.9000000000000012, -2.5000000000000018, -1.8000000000000012, -2.1000000000000014, -1.8000000000000012, -2.900000000000002, -2.700000000000002, -2.4000000000000017, -4.1000000000000005, -4.3, -2.3000000000000016, -1.5000000000000009, -2.0000000000000013, -3.1000000000000014, -2.5000000000000018, -2.600000000000002, -2.800000000000002, -2.3000000000000016, -2.0000000000000013, -3.5, -2.3000000000000016, -2.1000000000000014, -1.9000000000000012, -3.1000000000000014, -2.3000000000000016, -3.6999999999999993, -2.700000000000002, -3.3000000000000007, -1.8000000000000012, -2.3000000000000016, -2.0000000000000013, -2.700000000000002, -2.1000000000000014, -4.999999999999995, -1.700000000000001, -1.600000000000001, -21.499999999999996, -2.0000000000000013, -3.8000000000000007, -2.1000000000000014, -2.0000000000000013, -2.5000000000000018, -3.6999999999999993, -2.1000000000000014, -2.800000000000002, -1.9000000000000012, -3.0000000000000018, -3.5, -2.2000000000000015, -5.699999999999994, -3.1000000000000014, -1.9000000000000012, -2.0000000000000013, -5.799999999999992, -2.1000000000000014, -2.800000000000002, -1.9000000000000012, -2.5000000000000018, -1.5000000000000009, -2.1000000000000014, -2.2000000000000015, -2.2000000000000015, -4.999999999999995, -1.9000000000000012, -2.1000000000000014, -2.4000000000000017, -3.8, -2.0000000000000013, -1.8000000000000012, -2.700000000000002, -2.5000000000000018, -2.4000000000000017, -1.700000000000001, -2.4000000000000017, -2.1000000000000014, -2.600000000000002, -1.9000000000000012, -3.1000000000000014, -2.3000000000000016, -3.1000000000000014, -2.0000000000000013, -2.2000000000000015, -2.4000000000000017, -2.0000000000000013, -2.4000000000000017, -3.3000000000000007, -2.1000000000000014, -2.600000000000002, -4.5, -2.5000000000000018, -2.4000000000000017, -2.5000000000000018, -1.9000000000000012, -2.4000000000000017, -2.700000000000002, -4.099999999999998, -2.1000000000000014, -2.3000000000000016, -1.700000000000001, -1.9000000000000012, -2.4000000000000017], "episode_lengths": [30, 30, 29, 35, 31, 54, 30, 36, 29, 32, 29, 40, 38, 35, 49, 51, 34, 26, 31, 42, 36, 37, 39, 34, 31, 46, 34, 32, 30, 42, 34, 48, 38, 42, 29, 34, 31, 38, 32, 61, 28, 27, 143, 31, 45, 32, 31, 36, 48, 32, 39, 30, 41, 46, 33, 66, 42, 30, 31, 69, 32, 39, 30, 36, 26, 32, 33, 33, 61, 30, 32, 35, 44, 31, 29, 38, 36, 35, 28, 35, 32, 37, 30, 41, 34, 42, 31, 33, 35, 31, 35, 44, 32, 37, 52, 36, 35, 36, 30, 35, 38, 51, 32, 34, 28, 30, 35]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.29368286751938616, "mean_inference_ms": 0.7243693007642225, "mean_action_processing_ms": 0.07629656186368178, "mean_env_wait_ms": 6.609624741195847, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006662796590929833, "StateBufferConnector_ms": 0.003912738550489194, "ViewRequirementAgentConnector_ms": 0.08969106406809013}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 108000, "num_agent_steps_trained": 108000, "num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 505.24691731674545, "num_env_steps_trained_throughput_per_sec": 505.24691731674545, "timesteps_total": 108000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 108000, "timers": {"training_iteration_time_ms": 7783.192, "sample_time_ms": 4274.496, "load_time_ms": 0.958, "load_throughput": 4175825.97, "learn_time_ms": 3504.426, "learn_throughput": 1141.414, "synch_weights_time_ms": 2.662}, "counters": {"num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_agent_steps_sampled": 108000, "num_agent_steps_trained": 108000}, "done": false, "episodes_total": 1281, "training_iteration": 27, "trial_id": "2154c_00000", "date": "2024-03-07_13-07-55", "timestamp": 1709834875, "time_this_iter_s": 7.919713020324707, "time_total_s": 203.28418803215027, "pid": 116529, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7efea6399f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 203.28418803215027, "iterations_since_restore": 27, "perf": {"cpu_util_percent": 31.939999999999998, "ram_util_percent": 50.8, "gpu_util_percent0": 0.072, "vram_util_percent0": 0.0943603515625}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.10000000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 0.593888883445611, "policy_loss": -0.003106108103548327, "vf_loss": 0.5964271408696008, "vf_explained_var": 0.7478450386114018, "kl": 0.005678471093140768, "entropy": 0.5068637824827625, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 25575.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_agent_steps_sampled": 112000, "num_agent_steps_trained": 112000}, "sampler_results": {"episode_reward_max": -1.5000000000000009, "episode_reward_min": -32.20000000000004, "episode_reward_mean": -2.79056603773585, "episode_len_mean": 37.924528301886795, "episode_media": {}, "episodes_this_iter": 106, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2.4000000000000017, -2.3000000000000016, -2.900000000000002, -2.2000000000000015, -2.1000000000000014, -1.700000000000001, -2.700000000000002, -2.600000000000002, -4.4999999999999964, -2.5000000000000018, -2.0000000000000013, -1.700000000000001, -2.4000000000000017, -4.699999999999996, -2.4000000000000017, -2.0000000000000013, -2.1000000000000014, -2.700000000000002, -2.1000000000000014, -4.399999999999997, -2.3000000000000016, -2.0000000000000013, -4.299999999999998, -3.1000000000000014, -2.5000000000000018, -1.700000000000001, -1.8000000000000012, -3.9999999999999982, -1.700000000000001, -3.200000000000001, -32.20000000000004, -2.3000000000000016, -2.800000000000002, -2.0000000000000013, -2.800000000000002, -2.600000000000002, -2.4000000000000017, -2.3000000000000016, -1.9000000000000012, -2.3000000000000016, -2.800000000000002, -2.800000000000002, -2.5000000000000018, -2.2000000000000015, -2.2000000000000015, -2.5000000000000018, -4.299999999999997, -1.700000000000001, -2.1000000000000014, -2.700000000000002, -2.0000000000000013, -4.599999999999996, -2.700000000000002, -2.2000000000000015, -2.700000000000002, -2.5000000000000018, -2.3000000000000016, -2.5000000000000018, -2.3000000000000016, -2.5000000000000018, -3.0000000000000018, -1.8000000000000012, -2.3000000000000016, -3.6999999999999993, -3.0000000000000018, -2.4000000000000017, -2.5000000000000018, -2.3000000000000016, -1.5000000000000009, -1.700000000000001, -2.700000000000002, -2.3000000000000016, -3.8, -2.4000000000000017, -1.5000000000000009, -3.9999999999999982, -4.6000000000000005, -1.9000000000000012, -1.9000000000000012, -2.900000000000002, -2.800000000000002, -2.700000000000002, -2.3000000000000016, -2.2000000000000015, -1.700000000000001, -2.3000000000000016, -2.1000000000000014, -2.4000000000000017, -2.5000000000000018, -1.600000000000001, -2.2000000000000015, -2.600000000000002, -1.700000000000001, -2.4000000000000017, -2.0000000000000013, -2.4000000000000017, -2.0000000000000013, -2.0000000000000013, -2.1000000000000014, -2.700000000000002, -2.1000000000000014, -2.700000000000002, -2.2000000000000015, -2.5000000000000018, -2.4000000000000017, -2.3000000000000016], "episode_lengths": [35, 34, 38, 33, 32, 28, 38, 37, 56, 36, 31, 28, 35, 58, 35, 31, 32, 38, 32, 55, 34, 31, 53, 42, 36, 28, 29, 51, 28, 38, 247, 34, 38, 31, 39, 37, 35, 34, 30, 34, 39, 39, 36, 33, 33, 36, 54, 28, 32, 38, 31, 57, 38, 33, 38, 36, 34, 36, 34, 36, 41, 29, 34, 48, 41, 35, 36, 34, 26, 28, 38, 34, 46, 35, 26, 51, 51, 30, 30, 40, 39, 38, 34, 33, 28, 34, 32, 35, 36, 27, 33, 37, 28, 35, 31, 35, 31, 31, 32, 38, 32, 38, 33, 36, 35, 34]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.29712082693876785, "mean_inference_ms": 0.7240986244835544, "mean_action_processing_ms": 0.0763014559252259, "mean_env_wait_ms": 6.629916406256225, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006698437456814748, "StateBufferConnector_ms": 0.003939979481247236, "ViewRequirementAgentConnector_ms": 0.0903770608722039}}, "episode_reward_max": -1.5000000000000009, "episode_reward_min": -32.20000000000004, "episode_reward_mean": -2.79056603773585, "episode_len_mean": 37.924528301886795, "episodes_this_iter": 106, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-2.4000000000000017, -2.3000000000000016, -2.900000000000002, -2.2000000000000015, -2.1000000000000014, -1.700000000000001, -2.700000000000002, -2.600000000000002, -4.4999999999999964, -2.5000000000000018, -2.0000000000000013, -1.700000000000001, -2.4000000000000017, -4.699999999999996, -2.4000000000000017, -2.0000000000000013, -2.1000000000000014, -2.700000000000002, -2.1000000000000014, -4.399999999999997, -2.3000000000000016, -2.0000000000000013, -4.299999999999998, -3.1000000000000014, -2.5000000000000018, -1.700000000000001, -1.8000000000000012, -3.9999999999999982, -1.700000000000001, -3.200000000000001, -32.20000000000004, -2.3000000000000016, -2.800000000000002, -2.0000000000000013, -2.800000000000002, -2.600000000000002, -2.4000000000000017, -2.3000000000000016, -1.9000000000000012, -2.3000000000000016, -2.800000000000002, -2.800000000000002, -2.5000000000000018, -2.2000000000000015, -2.2000000000000015, -2.5000000000000018, -4.299999999999997, -1.700000000000001, -2.1000000000000014, -2.700000000000002, -2.0000000000000013, -4.599999999999996, -2.700000000000002, -2.2000000000000015, -2.700000000000002, -2.5000000000000018, -2.3000000000000016, -2.5000000000000018, -2.3000000000000016, -2.5000000000000018, -3.0000000000000018, -1.8000000000000012, -2.3000000000000016, -3.6999999999999993, -3.0000000000000018, -2.4000000000000017, -2.5000000000000018, -2.3000000000000016, -1.5000000000000009, -1.700000000000001, -2.700000000000002, -2.3000000000000016, -3.8, -2.4000000000000017, -1.5000000000000009, -3.9999999999999982, -4.6000000000000005, -1.9000000000000012, -1.9000000000000012, -2.900000000000002, -2.800000000000002, -2.700000000000002, -2.3000000000000016, -2.2000000000000015, -1.700000000000001, -2.3000000000000016, -2.1000000000000014, -2.4000000000000017, -2.5000000000000018, -1.600000000000001, -2.2000000000000015, -2.600000000000002, -1.700000000000001, -2.4000000000000017, -2.0000000000000013, -2.4000000000000017, -2.0000000000000013, -2.0000000000000013, -2.1000000000000014, -2.700000000000002, -2.1000000000000014, -2.700000000000002, -2.2000000000000015, -2.5000000000000018, -2.4000000000000017, -2.3000000000000016], "episode_lengths": [35, 34, 38, 33, 32, 28, 38, 37, 56, 36, 31, 28, 35, 58, 35, 31, 32, 38, 32, 55, 34, 31, 53, 42, 36, 28, 29, 51, 28, 38, 247, 34, 38, 31, 39, 37, 35, 34, 30, 34, 39, 39, 36, 33, 33, 36, 54, 28, 32, 38, 31, 57, 38, 33, 38, 36, 34, 36, 34, 36, 41, 29, 34, 48, 41, 35, 36, 34, 26, 28, 38, 34, 46, 35, 26, 51, 51, 30, 30, 40, 39, 38, 34, 33, 28, 34, 32, 35, 36, 27, 33, 37, 28, 35, 31, 35, 31, 31, 32, 38, 32, 38, 33, 36, 35, 34]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.29712082693876785, "mean_inference_ms": 0.7240986244835544, "mean_action_processing_ms": 0.0763014559252259, "mean_env_wait_ms": 6.629916406256225, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006698437456814748, "StateBufferConnector_ms": 0.003939979481247236, "ViewRequirementAgentConnector_ms": 0.0903770608722039}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 112000, "num_agent_steps_trained": 112000, "num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 506.2892433615688, "num_env_steps_trained_throughput_per_sec": 506.2892433615688, "timesteps_total": 112000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 112000, "timers": {"training_iteration_time_ms": 7819.023, "sample_time_ms": 4316.766, "load_time_ms": 0.968, "load_throughput": 4130284.589, "learn_time_ms": 3497.853, "learn_throughput": 1143.559, "synch_weights_time_ms": 2.773}, "counters": {"num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_agent_steps_sampled": 112000, "num_agent_steps_trained": 112000}, "done": false, "episodes_total": 1387, "training_iteration": 28, "trial_id": "2154c_00000", "date": "2024-03-07_13-08-03", "timestamp": 1709834883, "time_this_iter_s": 7.903761148452759, "time_total_s": 211.18794918060303, "pid": 116529, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7efea6399f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 211.18794918060303, "iterations_since_restore": 28, "perf": {"cpu_util_percent": 29.400000000000002, "ram_util_percent": 50.8, "gpu_util_percent0": 0.0881818181818182, "vram_util_percent0": 0.0943640506628788}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.10000000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 0.20727252210603064, "policy_loss": -0.014220671658153815, "vf_loss": 0.22068968883925869, "vf_explained_var": 0.8593036469592843, "kl": 0.008035049865164243, "entropy": 0.4707966456169723, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 26505.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 116000, "num_env_steps_trained": 116000, "num_agent_steps_sampled": 116000, "num_agent_steps_trained": 116000}, "sampler_results": {"episode_reward_max": -1.5000000000000009, "episode_reward_min": -5.799999999999997, "episode_reward_mean": -2.4230088495575233, "episode_len_mean": 34.97345132743363, "episode_media": {}, "episodes_this_iter": 113, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2.2000000000000015, -2.1000000000000014, -2.2000000000000015, -2.600000000000002, -2.3000000000000016, -2.1000000000000014, -1.9000000000000012, -1.9000000000000012, -3.200000000000001, -1.5000000000000009, -2.0000000000000013, -3.1000000000000014, -2.3000000000000016, -3.1000000000000014, -1.8000000000000012, -2.800000000000002, -1.8000000000000012, -2.2000000000000015, -2.2000000000000015, -2.0000000000000013, -2.1000000000000014, -2.800000000000002, -2.4000000000000017, -2.4000000000000017, -2.0000000000000013, -2.700000000000002, -2.3000000000000016, -2.2000000000000015, -3.1000000000000014, -1.9000000000000012, -2.3000000000000016, -1.8000000000000012, -2.1000000000000014, -2.1000000000000014, -2.700000000000002, -2.1000000000000014, -2.4000000000000017, -2.3000000000000016, -2.800000000000002, -2.1000000000000014, -3.799999999999999, -1.9000000000000012, -2.5000000000000018, -2.0000000000000013, -2.2000000000000015, -2.4000000000000017, -2.4000000000000017, -2.1000000000000014, -3.4000000000000004, -5.799999999999997, -1.700000000000001, -2.600000000000002, -3.200000000000001, -1.9000000000000012, -2.4000000000000017, -2.0000000000000013, -2.0000000000000013, -2.4000000000000017, -2.0000000000000013, -2.700000000000002, -1.9000000000000012, -1.700000000000001, -1.600000000000001, -1.8000000000000012, -2.4000000000000017, -2.800000000000002, -1.700000000000001, -2.1000000000000014, -3.4000000000000004, -2.3000000000000016, -2.5000000000000018, -2.5000000000000018, -2.700000000000002, -2.5000000000000018, -1.9000000000000012, -2.3000000000000016, -2.600000000000002, -3.5999999999999996, -2.800000000000002, -1.600000000000001, -2.600000000000002, -2.3000000000000016, -4.6999999999999975, -1.700000000000001, -3.1000000000000014, -3.0000000000000018, -2.3000000000000016, -2.2000000000000015, -1.700000000000001, -2.5000000000000018, -2.1000000000000014, -2.0000000000000013, -3.0000000000000018, -3.0000000000000018, -2.5000000000000018, -2.600000000000002, -3.9999999999999982, -1.9000000000000012, -1.700000000000001, -2.600000000000002, -2.2000000000000015, -2.1000000000000014, -1.700000000000001, -2.3000000000000016, -1.9000000000000012, -2.700000000000002, -4.300000000000002, -2.900000000000002, -1.8000000000000012, -2.0000000000000013, -2.900000000000002, -2.600000000000002, -2.900000000000002], "episode_lengths": [33, 32, 33, 37, 34, 32, 30, 30, 43, 26, 31, 42, 34, 38, 29, 39, 29, 33, 33, 31, 32, 39, 35, 35, 31, 38, 34, 33, 42, 30, 34, 29, 32, 32, 38, 32, 35, 34, 39, 32, 45, 30, 36, 31, 33, 35, 35, 32, 45, 63, 28, 37, 43, 30, 35, 31, 31, 35, 31, 38, 30, 28, 27, 29, 35, 39, 28, 32, 45, 34, 36, 36, 38, 36, 30, 34, 37, 42, 39, 27, 37, 34, 56, 28, 42, 41, 34, 33, 28, 36, 32, 31, 41, 41, 36, 37, 51, 30, 28, 37, 33, 32, 28, 34, 30, 37, 47, 40, 29, 31, 40, 37, 40]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.30039474503637964, "mean_inference_ms": 0.7246026215750928, "mean_action_processing_ms": 0.07628048464911674, "mean_env_wait_ms": 6.655107708348111, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006730577587026411, "StateBufferConnector_ms": 0.0039026800510102667, "ViewRequirementAgentConnector_ms": 0.08944051455607456}}, "episode_reward_max": -1.5000000000000009, "episode_reward_min": -5.799999999999997, "episode_reward_mean": -2.4230088495575233, "episode_len_mean": 34.97345132743363, "episodes_this_iter": 113, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-2.2000000000000015, -2.1000000000000014, -2.2000000000000015, -2.600000000000002, -2.3000000000000016, -2.1000000000000014, -1.9000000000000012, -1.9000000000000012, -3.200000000000001, -1.5000000000000009, -2.0000000000000013, -3.1000000000000014, -2.3000000000000016, -3.1000000000000014, -1.8000000000000012, -2.800000000000002, -1.8000000000000012, -2.2000000000000015, -2.2000000000000015, -2.0000000000000013, -2.1000000000000014, -2.800000000000002, -2.4000000000000017, -2.4000000000000017, -2.0000000000000013, -2.700000000000002, -2.3000000000000016, -2.2000000000000015, -3.1000000000000014, -1.9000000000000012, -2.3000000000000016, -1.8000000000000012, -2.1000000000000014, -2.1000000000000014, -2.700000000000002, -2.1000000000000014, -2.4000000000000017, -2.3000000000000016, -2.800000000000002, -2.1000000000000014, -3.799999999999999, -1.9000000000000012, -2.5000000000000018, -2.0000000000000013, -2.2000000000000015, -2.4000000000000017, -2.4000000000000017, -2.1000000000000014, -3.4000000000000004, -5.799999999999997, -1.700000000000001, -2.600000000000002, -3.200000000000001, -1.9000000000000012, -2.4000000000000017, -2.0000000000000013, -2.0000000000000013, -2.4000000000000017, -2.0000000000000013, -2.700000000000002, -1.9000000000000012, -1.700000000000001, -1.600000000000001, -1.8000000000000012, -2.4000000000000017, -2.800000000000002, -1.700000000000001, -2.1000000000000014, -3.4000000000000004, -2.3000000000000016, -2.5000000000000018, -2.5000000000000018, -2.700000000000002, -2.5000000000000018, -1.9000000000000012, -2.3000000000000016, -2.600000000000002, -3.5999999999999996, -2.800000000000002, -1.600000000000001, -2.600000000000002, -2.3000000000000016, -4.6999999999999975, -1.700000000000001, -3.1000000000000014, -3.0000000000000018, -2.3000000000000016, -2.2000000000000015, -1.700000000000001, -2.5000000000000018, -2.1000000000000014, -2.0000000000000013, -3.0000000000000018, -3.0000000000000018, -2.5000000000000018, -2.600000000000002, -3.9999999999999982, -1.9000000000000012, -1.700000000000001, -2.600000000000002, -2.2000000000000015, -2.1000000000000014, -1.700000000000001, -2.3000000000000016, -1.9000000000000012, -2.700000000000002, -4.300000000000002, -2.900000000000002, -1.8000000000000012, -2.0000000000000013, -2.900000000000002, -2.600000000000002, -2.900000000000002], "episode_lengths": [33, 32, 33, 37, 34, 32, 30, 30, 43, 26, 31, 42, 34, 38, 29, 39, 29, 33, 33, 31, 32, 39, 35, 35, 31, 38, 34, 33, 42, 30, 34, 29, 32, 32, 38, 32, 35, 34, 39, 32, 45, 30, 36, 31, 33, 35, 35, 32, 45, 63, 28, 37, 43, 30, 35, 31, 31, 35, 31, 38, 30, 28, 27, 29, 35, 39, 28, 32, 45, 34, 36, 36, 38, 36, 30, 34, 37, 42, 39, 27, 37, 34, 56, 28, 42, 41, 34, 33, 28, 36, 32, 31, 41, 41, 36, 37, 51, 30, 28, 37, 33, 32, 28, 34, 30, 37, 47, 40, 29, 31, 40, 37, 40]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.30039474503637964, "mean_inference_ms": 0.7246026215750928, "mean_action_processing_ms": 0.07628048464911674, "mean_env_wait_ms": 6.655107708348111, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006730577587026411, "StateBufferConnector_ms": 0.0039026800510102667, "ViewRequirementAgentConnector_ms": 0.08944051455607456}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 116000, "num_agent_steps_trained": 116000, "num_env_steps_sampled": 116000, "num_env_steps_trained": 116000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 498.3191709088002, "num_env_steps_trained_throughput_per_sec": 498.3191709088002, "timesteps_total": 116000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 116000, "timers": {"training_iteration_time_ms": 7857.429, "sample_time_ms": 4341.571, "load_time_ms": 0.971, "load_throughput": 4117916.646, "learn_time_ms": 3511.466, "learn_throughput": 1139.125, "synch_weights_time_ms": 2.765}, "counters": {"num_env_steps_sampled": 116000, "num_env_steps_trained": 116000, "num_agent_steps_sampled": 116000, "num_agent_steps_trained": 116000}, "done": false, "episodes_total": 1500, "training_iteration": 29, "trial_id": "2154c_00000", "date": "2024-03-07_13-08-11", "timestamp": 1709834891, "time_this_iter_s": 8.03008770942688, "time_total_s": 219.2180368900299, "pid": 116529, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7efea6399f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 219.2180368900299, "iterations_since_restore": 29, "perf": {"cpu_util_percent": 31.279999999999994, "ram_util_percent": 50.79, "gpu_util_percent0": 0.081, "vram_util_percent0": 0.09437662760416665}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.10000000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 0.1492257032688627, "policy_loss": -0.00989221191854887, "vf_loss": 0.1582992776216919, "vf_explained_var": 0.8714807757126388, "kl": 0.008186383876595609, "entropy": 0.3997828140053698, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 27435.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 120000, "num_env_steps_trained": 120000, "num_agent_steps_sampled": 120000, "num_agent_steps_trained": 120000}, "sampler_results": {"episode_reward_max": -1.4000000000000008, "episode_reward_min": -4.6000000000000005, "episode_reward_mean": -2.2675000000000014, "episode_len_mean": 33.425, "episode_media": {}, "episodes_this_iter": 120, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2.0000000000000013, -2.2000000000000015, -2.2000000000000015, -1.8000000000000012, -2.700000000000002, -3.1000000000000014, -1.8000000000000012, -2.4000000000000017, -2.4000000000000017, -2.1000000000000014, -2.1000000000000014, -2.2000000000000015, -2.5000000000000018, -2.4000000000000017, -1.9000000000000012, -2.3000000000000016, -2.0000000000000013, -2.4000000000000017, -2.600000000000002, -3.0000000000000018, -2.5000000000000018, -2.900000000000002, -1.8000000000000012, -1.9000000000000012, -2.0000000000000013, -1.5000000000000009, -2.700000000000002, -2.700000000000002, -2.3000000000000016, -2.4000000000000017, -2.0000000000000013, -1.8000000000000012, -2.2000000000000015, -2.1000000000000014, -4.6000000000000005, -2.700000000000002, -1.9000000000000012, -2.0000000000000013, -2.800000000000002, -2.1000000000000014, -2.2000000000000015, -2.2000000000000015, -1.5000000000000009, -1.600000000000001, -4.200000000000002, -2.800000000000002, -2.1000000000000014, -1.700000000000001, -2.3000000000000016, -2.600000000000002, -1.600000000000001, -3.400000000000002, -2.700000000000002, -4.300000000000001, -1.9000000000000012, -2.1000000000000014, -2.0000000000000013, -2.5000000000000018, -2.3000000000000016, -2.900000000000002, -2.2000000000000015, -2.4000000000000017, -1.8000000000000012, -2.1000000000000014, -3.4000000000000004, -2.700000000000002, -2.5000000000000018, -2.1000000000000014, -1.9000000000000012, -2.4000000000000017, -1.700000000000001, -1.8000000000000012, -1.4000000000000008, -2.1000000000000014, -1.9000000000000012, -2.2000000000000015, -1.700000000000001, -2.5000000000000018, -1.700000000000001, -2.700000000000002, -1.8000000000000012, -2.1000000000000014, -2.1000000000000014, -1.8000000000000012, -3.0000000000000018, -2.3000000000000016, -2.2000000000000015, -2.1000000000000014, -1.9000000000000012, -1.9000000000000012, -2.0000000000000013, -2.4000000000000017, -2.2000000000000015, -2.600000000000002, -2.900000000000002, -1.9000000000000012, -3.400000000000002, -2.700000000000002, -1.600000000000001, -1.5000000000000009, -2.2000000000000015, -1.600000000000001, -1.8000000000000012, -2.700000000000002, -2.2000000000000015, -2.3000000000000016, -2.4000000000000017, -1.700000000000001, -2.1000000000000014, -1.600000000000001, -2.600000000000002, -1.5000000000000009, -2.0000000000000013, -2.5000000000000018, -2.0000000000000013, -2.0000000000000013, -2.4000000000000017, -1.9000000000000012, -2.5000000000000018, -2.600000000000002], "episode_lengths": [31, 33, 33, 29, 38, 42, 29, 35, 35, 32, 32, 33, 36, 35, 30, 34, 31, 35, 37, 41, 36, 40, 29, 30, 31, 26, 38, 38, 34, 35, 31, 29, 33, 32, 52, 38, 30, 31, 39, 32, 33, 33, 26, 27, 46, 39, 32, 28, 34, 37, 27, 41, 38, 50, 30, 32, 31, 36, 34, 40, 33, 35, 29, 32, 41, 38, 36, 32, 30, 35, 28, 29, 25, 32, 30, 33, 28, 36, 28, 38, 29, 32, 32, 29, 41, 34, 33, 32, 30, 30, 31, 35, 33, 37, 40, 30, 39, 38, 27, 26, 33, 27, 29, 38, 33, 34, 35, 28, 32, 27, 37, 26, 31, 36, 31, 31, 35, 30, 36, 37]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.30434450512395617, "mean_inference_ms": 0.7247786520534182, "mean_action_processing_ms": 0.07633808821865556, "mean_env_wait_ms": 6.684158902786743, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006719430287679036, "StateBufferConnector_ms": 0.004012584686279297, "ViewRequirementAgentConnector_ms": 0.09060998757680257}}, "episode_reward_max": -1.4000000000000008, "episode_reward_min": -4.6000000000000005, "episode_reward_mean": -2.2675000000000014, "episode_len_mean": 33.425, "episodes_this_iter": 120, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-2.0000000000000013, -2.2000000000000015, -2.2000000000000015, -1.8000000000000012, -2.700000000000002, -3.1000000000000014, -1.8000000000000012, -2.4000000000000017, -2.4000000000000017, -2.1000000000000014, -2.1000000000000014, -2.2000000000000015, -2.5000000000000018, -2.4000000000000017, -1.9000000000000012, -2.3000000000000016, -2.0000000000000013, -2.4000000000000017, -2.600000000000002, -3.0000000000000018, -2.5000000000000018, -2.900000000000002, -1.8000000000000012, -1.9000000000000012, -2.0000000000000013, -1.5000000000000009, -2.700000000000002, -2.700000000000002, -2.3000000000000016, -2.4000000000000017, -2.0000000000000013, -1.8000000000000012, -2.2000000000000015, -2.1000000000000014, -4.6000000000000005, -2.700000000000002, -1.9000000000000012, -2.0000000000000013, -2.800000000000002, -2.1000000000000014, -2.2000000000000015, -2.2000000000000015, -1.5000000000000009, -1.600000000000001, -4.200000000000002, -2.800000000000002, -2.1000000000000014, -1.700000000000001, -2.3000000000000016, -2.600000000000002, -1.600000000000001, -3.400000000000002, -2.700000000000002, -4.300000000000001, -1.9000000000000012, -2.1000000000000014, -2.0000000000000013, -2.5000000000000018, -2.3000000000000016, -2.900000000000002, -2.2000000000000015, -2.4000000000000017, -1.8000000000000012, -2.1000000000000014, -3.4000000000000004, -2.700000000000002, -2.5000000000000018, -2.1000000000000014, -1.9000000000000012, -2.4000000000000017, -1.700000000000001, -1.8000000000000012, -1.4000000000000008, -2.1000000000000014, -1.9000000000000012, -2.2000000000000015, -1.700000000000001, -2.5000000000000018, -1.700000000000001, -2.700000000000002, -1.8000000000000012, -2.1000000000000014, -2.1000000000000014, -1.8000000000000012, -3.0000000000000018, -2.3000000000000016, -2.2000000000000015, -2.1000000000000014, -1.9000000000000012, -1.9000000000000012, -2.0000000000000013, -2.4000000000000017, -2.2000000000000015, -2.600000000000002, -2.900000000000002, -1.9000000000000012, -3.400000000000002, -2.700000000000002, -1.600000000000001, -1.5000000000000009, -2.2000000000000015, -1.600000000000001, -1.8000000000000012, -2.700000000000002, -2.2000000000000015, -2.3000000000000016, -2.4000000000000017, -1.700000000000001, -2.1000000000000014, -1.600000000000001, -2.600000000000002, -1.5000000000000009, -2.0000000000000013, -2.5000000000000018, -2.0000000000000013, -2.0000000000000013, -2.4000000000000017, -1.9000000000000012, -2.5000000000000018, -2.600000000000002], "episode_lengths": [31, 33, 33, 29, 38, 42, 29, 35, 35, 32, 32, 33, 36, 35, 30, 34, 31, 35, 37, 41, 36, 40, 29, 30, 31, 26, 38, 38, 34, 35, 31, 29, 33, 32, 52, 38, 30, 31, 39, 32, 33, 33, 26, 27, 46, 39, 32, 28, 34, 37, 27, 41, 38, 50, 30, 32, 31, 36, 34, 40, 33, 35, 29, 32, 41, 38, 36, 32, 30, 35, 28, 29, 25, 32, 30, 33, 28, 36, 28, 38, 29, 32, 32, 29, 41, 34, 33, 32, 30, 30, 31, 35, 33, 37, 40, 30, 39, 38, 27, 26, 33, 27, 29, 38, 33, 34, 35, 28, 32, 27, 37, 26, 31, 36, 31, 31, 35, 30, 36, 37]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.30434450512395617, "mean_inference_ms": 0.7247786520534182, "mean_action_processing_ms": 0.07633808821865556, "mean_env_wait_ms": 6.684158902786743, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006719430287679036, "StateBufferConnector_ms": 0.004012584686279297, "ViewRequirementAgentConnector_ms": 0.09060998757680257}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 120000, "num_agent_steps_trained": 120000, "num_env_steps_sampled": 120000, "num_env_steps_trained": 120000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 487.9557311737952, "num_env_steps_trained_throughput_per_sec": 487.9557311737952, "timesteps_total": 120000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 120000, "timers": {"training_iteration_time_ms": 7882.639, "sample_time_ms": 4364.878, "load_time_ms": 0.975, "load_throughput": 4101306.867, "learn_time_ms": 3513.448, "learn_throughput": 1138.483, "synch_weights_time_ms": 2.682}, "counters": {"num_env_steps_sampled": 120000, "num_env_steps_trained": 120000, "num_agent_steps_sampled": 120000, "num_agent_steps_trained": 120000}, "done": false, "episodes_total": 1620, "training_iteration": 30, "trial_id": "2154c_00000", "date": "2024-03-07_13-08-19", "timestamp": 1709834899, "time_this_iter_s": 8.200490951538086, "time_total_s": 227.418527841568, "pid": 116529, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7efea6399f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 227.418527841568, "iterations_since_restore": 30, "perf": {"cpu_util_percent": 30.7, "ram_util_percent": 50.71818181818182, "gpu_util_percent0": 0.08454545454545453, "vram_util_percent0": 0.0943566524621212}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.10000000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 0.17091880020615394, "policy_loss": -0.008918717257448182, "vf_loss": 0.17886035903907752, "vf_explained_var": 0.8761823882338822, "kl": 0.009771590647572992, "entropy": 0.3767547981232725, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 28365.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 124000, "num_env_steps_trained": 124000, "num_agent_steps_sampled": 124000, "num_agent_steps_trained": 124000}, "sampler_results": {"episode_reward_max": -1.5000000000000009, "episode_reward_min": -4.999999999999996, "episode_reward_mean": -2.193495934959351, "episode_len_mean": 32.699186991869915, "episode_media": {}, "episodes_this_iter": 123, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2.800000000000002, -2.1000000000000014, -2.2000000000000015, -2.5000000000000018, -1.700000000000001, -2.2000000000000015, -2.800000000000002, -2.5000000000000018, -4.600000000000001, -2.4000000000000017, -1.700000000000001, -3.5, -2.2000000000000015, -2.700000000000002, -1.8000000000000012, -2.2000000000000015, -2.1000000000000014, -1.700000000000001, -1.600000000000001, -1.700000000000001, -1.9000000000000012, -2.3000000000000016, -2.2000000000000015, -2.1000000000000014, -1.700000000000001, -2.2000000000000015, -1.600000000000001, -2.1000000000000014, -2.0000000000000013, -1.8000000000000012, -1.600000000000001, -1.8000000000000012, -1.5000000000000009, -2.4000000000000017, -1.700000000000001, -1.8000000000000012, -1.700000000000001, -1.700000000000001, -1.5000000000000009, -2.0000000000000013, -2.0000000000000013, -1.600000000000001, -1.8000000000000012, -1.5000000000000009, -3.1000000000000014, -1.8000000000000012, -1.700000000000001, -2.800000000000002, -2.2000000000000015, -2.600000000000002, -2.1000000000000014, -2.2000000000000015, -2.1000000000000014, -2.0000000000000013, -1.700000000000001, -2.3000000000000016, -2.1000000000000014, -2.4000000000000017, -1.9000000000000012, -2.0000000000000013, -2.2000000000000015, -2.3000000000000016, -2.2000000000000015, -1.9000000000000012, -2.600000000000002, -2.3000000000000016, -2.2000000000000015, -1.9000000000000012, -1.9000000000000012, -2.3000000000000016, -2.5000000000000018, -1.9000000000000012, -1.700000000000001, -1.700000000000001, -2.0000000000000013, -4.700000000000002, -2.0000000000000013, -2.5000000000000018, -2.3000000000000016, -2.5000000000000018, -2.4000000000000017, -2.700000000000002, -2.1000000000000014, -1.5000000000000009, -4.999999999999996, -1.700000000000001, -2.1000000000000014, -2.600000000000002, -2.1000000000000014, -2.0000000000000013, -2.5000000000000018, -2.2000000000000015, -2.1000000000000014, -2.600000000000002, -2.2000000000000015, -2.0000000000000013, -1.9000000000000012, -1.8000000000000012, -2.3000000000000016, -1.8000000000000012, -2.3000000000000016, -2.2000000000000015, -3.6999999999999993, -1.600000000000001, -2.2000000000000015, -3.200000000000001, -1.700000000000001, -2.1000000000000014, -3.0000000000000018, -2.0000000000000013, -2.0000000000000013, -2.5000000000000018, -2.1000000000000014, -2.700000000000002, -1.9000000000000012, -2.4000000000000017, -1.9000000000000012, -1.9000000000000012, -2.1000000000000014, -2.900000000000002, -2.3000000000000016, -1.5000000000000009, -1.9000000000000012], "episode_lengths": [36, 32, 33, 36, 28, 33, 39, 36, 50, 35, 28, 45, 33, 38, 29, 33, 32, 28, 27, 28, 30, 34, 33, 32, 28, 33, 27, 32, 31, 29, 27, 29, 26, 35, 28, 29, 28, 28, 26, 31, 31, 27, 29, 26, 42, 29, 28, 39, 33, 37, 32, 33, 32, 31, 28, 34, 32, 35, 30, 31, 33, 33, 33, 30, 37, 34, 33, 30, 30, 34, 36, 30, 28, 28, 31, 46, 31, 36, 34, 36, 35, 38, 32, 26, 60, 28, 32, 37, 32, 31, 36, 33, 32, 37, 33, 31, 30, 29, 34, 29, 34, 33, 44, 27, 33, 43, 28, 32, 41, 31, 31, 36, 32, 38, 30, 35, 30, 30, 32, 40, 34, 26, 30]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3078696893719575, "mean_inference_ms": 0.7249483332614762, "mean_action_processing_ms": 0.07631082298345085, "mean_env_wait_ms": 6.708906462488919, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006735227941497554, "StateBufferConnector_ms": 0.003928479140366965, "ViewRequirementAgentConnector_ms": 0.08924763377119856}}, "episode_reward_max": -1.5000000000000009, "episode_reward_min": -4.999999999999996, "episode_reward_mean": -2.193495934959351, "episode_len_mean": 32.699186991869915, "episodes_this_iter": 123, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-2.800000000000002, -2.1000000000000014, -2.2000000000000015, -2.5000000000000018, -1.700000000000001, -2.2000000000000015, -2.800000000000002, -2.5000000000000018, -4.600000000000001, -2.4000000000000017, -1.700000000000001, -3.5, -2.2000000000000015, -2.700000000000002, -1.8000000000000012, -2.2000000000000015, -2.1000000000000014, -1.700000000000001, -1.600000000000001, -1.700000000000001, -1.9000000000000012, -2.3000000000000016, -2.2000000000000015, -2.1000000000000014, -1.700000000000001, -2.2000000000000015, -1.600000000000001, -2.1000000000000014, -2.0000000000000013, -1.8000000000000012, -1.600000000000001, -1.8000000000000012, -1.5000000000000009, -2.4000000000000017, -1.700000000000001, -1.8000000000000012, -1.700000000000001, -1.700000000000001, -1.5000000000000009, -2.0000000000000013, -2.0000000000000013, -1.600000000000001, -1.8000000000000012, -1.5000000000000009, -3.1000000000000014, -1.8000000000000012, -1.700000000000001, -2.800000000000002, -2.2000000000000015, -2.600000000000002, -2.1000000000000014, -2.2000000000000015, -2.1000000000000014, -2.0000000000000013, -1.700000000000001, -2.3000000000000016, -2.1000000000000014, -2.4000000000000017, -1.9000000000000012, -2.0000000000000013, -2.2000000000000015, -2.3000000000000016, -2.2000000000000015, -1.9000000000000012, -2.600000000000002, -2.3000000000000016, -2.2000000000000015, -1.9000000000000012, -1.9000000000000012, -2.3000000000000016, -2.5000000000000018, -1.9000000000000012, -1.700000000000001, -1.700000000000001, -2.0000000000000013, -4.700000000000002, -2.0000000000000013, -2.5000000000000018, -2.3000000000000016, -2.5000000000000018, -2.4000000000000017, -2.700000000000002, -2.1000000000000014, -1.5000000000000009, -4.999999999999996, -1.700000000000001, -2.1000000000000014, -2.600000000000002, -2.1000000000000014, -2.0000000000000013, -2.5000000000000018, -2.2000000000000015, -2.1000000000000014, -2.600000000000002, -2.2000000000000015, -2.0000000000000013, -1.9000000000000012, -1.8000000000000012, -2.3000000000000016, -1.8000000000000012, -2.3000000000000016, -2.2000000000000015, -3.6999999999999993, -1.600000000000001, -2.2000000000000015, -3.200000000000001, -1.700000000000001, -2.1000000000000014, -3.0000000000000018, -2.0000000000000013, -2.0000000000000013, -2.5000000000000018, -2.1000000000000014, -2.700000000000002, -1.9000000000000012, -2.4000000000000017, -1.9000000000000012, -1.9000000000000012, -2.1000000000000014, -2.900000000000002, -2.3000000000000016, -1.5000000000000009, -1.9000000000000012], "episode_lengths": [36, 32, 33, 36, 28, 33, 39, 36, 50, 35, 28, 45, 33, 38, 29, 33, 32, 28, 27, 28, 30, 34, 33, 32, 28, 33, 27, 32, 31, 29, 27, 29, 26, 35, 28, 29, 28, 28, 26, 31, 31, 27, 29, 26, 42, 29, 28, 39, 33, 37, 32, 33, 32, 31, 28, 34, 32, 35, 30, 31, 33, 33, 33, 30, 37, 34, 33, 30, 30, 34, 36, 30, 28, 28, 31, 46, 31, 36, 34, 36, 35, 38, 32, 26, 60, 28, 32, 37, 32, 31, 36, 33, 32, 37, 33, 31, 30, 29, 34, 29, 34, 33, 44, 27, 33, 43, 28, 32, 41, 31, 31, 36, 32, 38, 30, 35, 30, 30, 32, 40, 34, 26, 30]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3078696893719575, "mean_inference_ms": 0.7249483332614762, "mean_action_processing_ms": 0.07631082298345085, "mean_env_wait_ms": 6.708906462488919, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006735227941497554, "StateBufferConnector_ms": 0.003928479140366965, "ViewRequirementAgentConnector_ms": 0.08924763377119856}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 124000, "num_agent_steps_trained": 124000, "num_env_steps_sampled": 124000, "num_env_steps_trained": 124000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 498.7835451176418, "num_env_steps_trained_throughput_per_sec": 498.7835451176418, "timesteps_total": 124000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 124000, "timers": {"training_iteration_time_ms": 7918.851, "sample_time_ms": 4399.1, "load_time_ms": 0.979, "load_throughput": 4085924.844, "learn_time_ms": 3515.461, "learn_throughput": 1137.831, "synch_weights_time_ms": 2.658}, "counters": {"num_env_steps_sampled": 124000, "num_env_steps_trained": 124000, "num_agent_steps_sampled": 124000, "num_agent_steps_trained": 124000}, "done": false, "episodes_total": 1743, "training_iteration": 31, "trial_id": "2154c_00000", "date": "2024-03-07_13-08-27", "timestamp": 1709834907, "time_this_iter_s": 8.022429466247559, "time_total_s": 235.44095730781555, "pid": 116529, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7efea6399f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 235.44095730781555, "iterations_since_restore": 31, "perf": {"cpu_util_percent": 32.43, "ram_util_percent": 50.61, "gpu_util_percent0": 0.073, "vram_util_percent0": 0.09435221354166665}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.10000000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 0.10168431709553065, "policy_loss": -0.00914725540506263, "vf_loss": 0.10969409407767397, "vf_explained_var": 0.9213037951659131, "kl": 0.011374780517135611, "entropy": 0.358966280279621, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 29295.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 128000, "num_env_steps_trained": 128000, "num_agent_steps_sampled": 128000, "num_agent_steps_trained": 128000}, "sampler_results": {"episode_reward_max": -1.5000000000000009, "episode_reward_min": -4.599999999999996, "episode_reward_mean": -2.1370967741935494, "episode_len_mean": 32.21774193548387, "episode_media": {}, "episodes_this_iter": 124, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2.3000000000000016, -2.4000000000000017, -2.1000000000000014, -1.700000000000001, -1.9000000000000012, -2.600000000000002, -1.9000000000000012, -2.0000000000000013, -1.700000000000001, -2.3000000000000016, -1.9000000000000012, -2.1000000000000014, -1.9000000000000012, -2.0000000000000013, -1.8000000000000012, -2.600000000000002, -1.700000000000001, -2.800000000000002, -2.2000000000000015, -2.600000000000002, -2.4000000000000017, -2.4000000000000017, -2.1000000000000014, -2.3000000000000016, -2.1000000000000014, -1.600000000000001, -2.0000000000000013, -2.4000000000000017, -4.000000000000001, -2.0000000000000013, -2.5000000000000018, -1.5000000000000009, -1.700000000000001, -3.6999999999999993, -1.9000000000000012, -2.2000000000000015, -1.9000000000000012, -2.800000000000002, -2.4000000000000017, -1.9000000000000012, -1.5000000000000009, -2.3000000000000016, -2.700000000000002, -1.5000000000000009, -1.9000000000000012, -2.1000000000000014, -2.3000000000000016, -1.8000000000000012, -2.0000000000000013, -1.600000000000001, -2.0000000000000013, -1.600000000000001, -2.2000000000000015, -2.2000000000000015, -2.3000000000000016, -2.4000000000000017, -2.2000000000000015, -1.600000000000001, -2.700000000000002, -2.4000000000000017, -2.1000000000000014, -2.1000000000000014, -1.600000000000001, -2.900000000000002, -2.3000000000000016, -2.800000000000002, -1.600000000000001, -1.700000000000001, -2.3000000000000016, -2.800000000000002, -2.4000000000000017, -2.0000000000000013, -1.9000000000000012, -1.8000000000000012, -1.9000000000000012, -1.9000000000000012, -2.1000000000000014, -2.0000000000000013, -1.5000000000000009, -4.500000000000002, -2.1000000000000014, -1.700000000000001, -1.700000000000001, -2.0000000000000013, -1.8000000000000012, -1.9000000000000012, -2.2000000000000015, -2.3000000000000016, -2.0000000000000013, -2.3000000000000016, -1.9000000000000012, -2.0000000000000013, -2.3000000000000016, -2.5000000000000018, -1.8000000000000012, -1.9000000000000012, -2.5000000000000018, -2.800000000000002, -2.0000000000000013, -1.9000000000000012, -2.4000000000000017, -2.5000000000000018, -1.8000000000000012, -1.9000000000000012, -1.8000000000000012, -1.9000000000000012, -1.600000000000001, -1.8000000000000012, -1.700000000000001, -2.1000000000000014, -1.700000000000001, -1.600000000000001, -4.599999999999996, -2.0000000000000013, -2.1000000000000014, -1.8000000000000012, -2.5000000000000018, -1.600000000000001, -2.0000000000000013, -1.8000000000000012, -2.4000000000000017, -1.8000000000000012, -2.2000000000000015, -2.0000000000000013], "episode_lengths": [34, 35, 32, 28, 30, 37, 30, 31, 28, 34, 30, 32, 30, 31, 29, 37, 28, 39, 33, 37, 35, 35, 32, 34, 32, 27, 31, 35, 46, 31, 36, 26, 28, 48, 30, 33, 30, 39, 35, 30, 26, 34, 38, 26, 30, 32, 34, 29, 31, 27, 31, 27, 33, 33, 34, 35, 33, 27, 35, 35, 32, 32, 27, 40, 34, 39, 27, 28, 34, 39, 35, 31, 30, 29, 30, 30, 32, 31, 26, 46, 32, 28, 28, 31, 29, 30, 33, 34, 31, 34, 30, 31, 34, 36, 29, 30, 36, 39, 31, 30, 35, 36, 29, 30, 29, 30, 27, 29, 28, 32, 28, 27, 56, 31, 32, 29, 36, 27, 31, 29, 35, 29, 33, 31]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.31169875223837423, "mean_inference_ms": 0.7248755302648296, "mean_action_processing_ms": 0.07631656734626413, "mean_env_wait_ms": 6.734262996775992, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006690909785609092, "StateBufferConnector_ms": 0.0039342911012711064, "ViewRequirementAgentConnector_ms": 0.09045927755294307}}, "episode_reward_max": -1.5000000000000009, "episode_reward_min": -4.599999999999996, "episode_reward_mean": -2.1370967741935494, "episode_len_mean": 32.21774193548387, "episodes_this_iter": 124, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-2.3000000000000016, -2.4000000000000017, -2.1000000000000014, -1.700000000000001, -1.9000000000000012, -2.600000000000002, -1.9000000000000012, -2.0000000000000013, -1.700000000000001, -2.3000000000000016, -1.9000000000000012, -2.1000000000000014, -1.9000000000000012, -2.0000000000000013, -1.8000000000000012, -2.600000000000002, -1.700000000000001, -2.800000000000002, -2.2000000000000015, -2.600000000000002, -2.4000000000000017, -2.4000000000000017, -2.1000000000000014, -2.3000000000000016, -2.1000000000000014, -1.600000000000001, -2.0000000000000013, -2.4000000000000017, -4.000000000000001, -2.0000000000000013, -2.5000000000000018, -1.5000000000000009, -1.700000000000001, -3.6999999999999993, -1.9000000000000012, -2.2000000000000015, -1.9000000000000012, -2.800000000000002, -2.4000000000000017, -1.9000000000000012, -1.5000000000000009, -2.3000000000000016, -2.700000000000002, -1.5000000000000009, -1.9000000000000012, -2.1000000000000014, -2.3000000000000016, -1.8000000000000012, -2.0000000000000013, -1.600000000000001, -2.0000000000000013, -1.600000000000001, -2.2000000000000015, -2.2000000000000015, -2.3000000000000016, -2.4000000000000017, -2.2000000000000015, -1.600000000000001, -2.700000000000002, -2.4000000000000017, -2.1000000000000014, -2.1000000000000014, -1.600000000000001, -2.900000000000002, -2.3000000000000016, -2.800000000000002, -1.600000000000001, -1.700000000000001, -2.3000000000000016, -2.800000000000002, -2.4000000000000017, -2.0000000000000013, -1.9000000000000012, -1.8000000000000012, -1.9000000000000012, -1.9000000000000012, -2.1000000000000014, -2.0000000000000013, -1.5000000000000009, -4.500000000000002, -2.1000000000000014, -1.700000000000001, -1.700000000000001, -2.0000000000000013, -1.8000000000000012, -1.9000000000000012, -2.2000000000000015, -2.3000000000000016, -2.0000000000000013, -2.3000000000000016, -1.9000000000000012, -2.0000000000000013, -2.3000000000000016, -2.5000000000000018, -1.8000000000000012, -1.9000000000000012, -2.5000000000000018, -2.800000000000002, -2.0000000000000013, -1.9000000000000012, -2.4000000000000017, -2.5000000000000018, -1.8000000000000012, -1.9000000000000012, -1.8000000000000012, -1.9000000000000012, -1.600000000000001, -1.8000000000000012, -1.700000000000001, -2.1000000000000014, -1.700000000000001, -1.600000000000001, -4.599999999999996, -2.0000000000000013, -2.1000000000000014, -1.8000000000000012, -2.5000000000000018, -1.600000000000001, -2.0000000000000013, -1.8000000000000012, -2.4000000000000017, -1.8000000000000012, -2.2000000000000015, -2.0000000000000013], "episode_lengths": [34, 35, 32, 28, 30, 37, 30, 31, 28, 34, 30, 32, 30, 31, 29, 37, 28, 39, 33, 37, 35, 35, 32, 34, 32, 27, 31, 35, 46, 31, 36, 26, 28, 48, 30, 33, 30, 39, 35, 30, 26, 34, 38, 26, 30, 32, 34, 29, 31, 27, 31, 27, 33, 33, 34, 35, 33, 27, 35, 35, 32, 32, 27, 40, 34, 39, 27, 28, 34, 39, 35, 31, 30, 29, 30, 30, 32, 31, 26, 46, 32, 28, 28, 31, 29, 30, 33, 34, 31, 34, 30, 31, 34, 36, 29, 30, 36, 39, 31, 30, 35, 36, 29, 30, 29, 30, 27, 29, 28, 32, 28, 27, 56, 31, 32, 29, 36, 27, 31, 29, 35, 29, 33, 31]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.31169875223837423, "mean_inference_ms": 0.7248755302648296, "mean_action_processing_ms": 0.07631656734626413, "mean_env_wait_ms": 6.734262996775992, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006690909785609092, "StateBufferConnector_ms": 0.0039342911012711064, "ViewRequirementAgentConnector_ms": 0.09045927755294307}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 128000, "num_agent_steps_trained": 128000, "num_env_steps_sampled": 128000, "num_env_steps_trained": 128000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 503.70664109005554, "num_env_steps_trained_throughput_per_sec": 503.70664109005554, "timesteps_total": 128000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 128000, "timers": {"training_iteration_time_ms": 7926.62, "sample_time_ms": 4412.912, "load_time_ms": 0.981, "load_throughput": 4078673.603, "learn_time_ms": 3509.409, "learn_throughput": 1139.793, "synch_weights_time_ms": 2.663}, "counters": {"num_env_steps_sampled": 128000, "num_env_steps_trained": 128000, "num_agent_steps_sampled": 128000, "num_agent_steps_trained": 128000}, "done": false, "episodes_total": 1867, "training_iteration": 32, "trial_id": "2154c_00000", "date": "2024-03-07_13-08-35", "timestamp": 1709834915, "time_this_iter_s": 7.944267988204956, "time_total_s": 243.3852252960205, "pid": 116529, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7efea6399f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 243.3852252960205, "iterations_since_restore": 32, "perf": {"cpu_util_percent": 32.38, "ram_util_percent": 50.60000000000001, "gpu_util_percent0": 0.07400000000000001, "vram_util_percent0": 0.0943603515625}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.10000000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 0.17021449747199935, "policy_loss": -0.00612881550745618, "vf_loss": 0.17556937158368127, "vf_explained_var": 0.8973936967311367, "kl": 0.007739452742606837, "entropy": 0.3144741158652049, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 30225.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 132000, "num_env_steps_trained": 132000, "num_agent_steps_sampled": 132000, "num_agent_steps_trained": 132000}, "sampler_results": {"episode_reward_max": -1.5000000000000009, "episode_reward_min": -7.300000000000001, "episode_reward_mean": -2.0456692913385837, "episode_len_mean": 31.20472440944882, "episode_media": {}, "episodes_this_iter": 127, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2.2000000000000015, -1.8000000000000012, -1.700000000000001, -1.700000000000001, -2.700000000000002, -2.1000000000000014, -1.600000000000001, -1.8000000000000012, -2.2000000000000015, -2.1000000000000014, -2.900000000000002, -2.3000000000000016, -1.8000000000000012, -1.9000000000000012, -1.5000000000000009, -2.0000000000000013, -1.600000000000001, -1.700000000000001, -2.0000000000000013, -1.9000000000000012, -1.9000000000000012, -2.800000000000002, -1.600000000000001, -1.5000000000000009, -2.0000000000000013, -1.600000000000001, -1.8000000000000012, -1.8000000000000012, -2.2000000000000015, -1.600000000000001, -2.4000000000000017, -2.2000000000000015, -2.0000000000000013, -1.9000000000000012, -1.700000000000001, -1.8000000000000012, -1.9000000000000012, -2.2000000000000015, -2.0000000000000013, -3.0000000000000018, -1.700000000000001, -2.0000000000000013, -1.8000000000000012, -3.1000000000000014, -1.9000000000000012, -1.700000000000001, -1.700000000000001, -2.1000000000000014, -1.9000000000000012, -2.1000000000000014, -2.1000000000000014, -2.3000000000000016, -1.600000000000001, -2.1000000000000014, -1.9000000000000012, -3.0000000000000018, -1.8000000000000012, -2.4000000000000017, -1.5000000000000009, -2.5000000000000018, -2.0000000000000013, -1.9000000000000012, -1.8000000000000012, -2.1000000000000014, -1.9000000000000012, -2.0000000000000013, -2.1000000000000014, -2.0000000000000013, -1.600000000000001, -1.8000000000000012, -2.700000000000002, -2.2000000000000015, -2.2000000000000015, -1.9000000000000012, -1.700000000000001, -7.300000000000001, -2.2000000000000015, -2.3000000000000016, -2.0000000000000013, -1.8000000000000012, -1.8000000000000012, -1.700000000000001, -2.0000000000000013, -2.0000000000000013, -2.0000000000000013, -2.5000000000000018, -2.0000000000000013, -2.3000000000000016, -2.0000000000000013, -1.8000000000000012, -2.4000000000000017, -2.0000000000000013, -2.0000000000000013, -1.600000000000001, -1.8000000000000012, -2.5000000000000018, -2.1000000000000014, -2.600000000000002, -1.8000000000000012, -1.9000000000000012, -1.8000000000000012, -1.9000000000000012, -2.1000000000000014, -2.4000000000000017, -2.1000000000000014, -2.3000000000000016, -1.700000000000001, -1.5000000000000009, -2.0000000000000013, -1.600000000000001, -1.700000000000001, -3.200000000000001, -1.9000000000000012, -2.2000000000000015, -1.5000000000000009, -2.0000000000000013, -2.5000000000000018, -2.1000000000000014, -1.9000000000000012, -2.1000000000000014, -1.700000000000001, -1.9000000000000012, -2.1000000000000014, -1.600000000000001, -1.8000000000000012, -1.600000000000001, -1.700000000000001], "episode_lengths": [33, 29, 28, 28, 38, 32, 27, 29, 33, 32, 40, 34, 29, 30, 26, 31, 27, 28, 31, 30, 30, 39, 27, 26, 31, 27, 29, 29, 33, 27, 35, 33, 31, 30, 28, 29, 30, 33, 31, 41, 28, 31, 29, 39, 30, 28, 28, 32, 30, 32, 32, 34, 27, 32, 30, 36, 29, 35, 26, 36, 31, 30, 29, 32, 30, 31, 32, 31, 27, 29, 38, 33, 33, 30, 28, 66, 33, 34, 31, 29, 29, 28, 31, 31, 31, 36, 31, 34, 31, 29, 35, 31, 31, 27, 29, 36, 32, 37, 29, 30, 29, 30, 32, 35, 32, 34, 28, 26, 31, 27, 28, 37, 30, 33, 26, 31, 36, 32, 30, 32, 28, 30, 32, 27, 29, 27, 28]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3152819404207717, "mean_inference_ms": 0.7252586900702699, "mean_action_processing_ms": 0.07633937566274276, "mean_env_wait_ms": 6.762929354181778, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006795492697888472, "StateBufferConnector_ms": 0.004038472813884105, "ViewRequirementAgentConnector_ms": 0.09179716035137027}}, "episode_reward_max": -1.5000000000000009, "episode_reward_min": -7.300000000000001, "episode_reward_mean": -2.0456692913385837, "episode_len_mean": 31.20472440944882, "episodes_this_iter": 127, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-2.2000000000000015, -1.8000000000000012, -1.700000000000001, -1.700000000000001, -2.700000000000002, -2.1000000000000014, -1.600000000000001, -1.8000000000000012, -2.2000000000000015, -2.1000000000000014, -2.900000000000002, -2.3000000000000016, -1.8000000000000012, -1.9000000000000012, -1.5000000000000009, -2.0000000000000013, -1.600000000000001, -1.700000000000001, -2.0000000000000013, -1.9000000000000012, -1.9000000000000012, -2.800000000000002, -1.600000000000001, -1.5000000000000009, -2.0000000000000013, -1.600000000000001, -1.8000000000000012, -1.8000000000000012, -2.2000000000000015, -1.600000000000001, -2.4000000000000017, -2.2000000000000015, -2.0000000000000013, -1.9000000000000012, -1.700000000000001, -1.8000000000000012, -1.9000000000000012, -2.2000000000000015, -2.0000000000000013, -3.0000000000000018, -1.700000000000001, -2.0000000000000013, -1.8000000000000012, -3.1000000000000014, -1.9000000000000012, -1.700000000000001, -1.700000000000001, -2.1000000000000014, -1.9000000000000012, -2.1000000000000014, -2.1000000000000014, -2.3000000000000016, -1.600000000000001, -2.1000000000000014, -1.9000000000000012, -3.0000000000000018, -1.8000000000000012, -2.4000000000000017, -1.5000000000000009, -2.5000000000000018, -2.0000000000000013, -1.9000000000000012, -1.8000000000000012, -2.1000000000000014, -1.9000000000000012, -2.0000000000000013, -2.1000000000000014, -2.0000000000000013, -1.600000000000001, -1.8000000000000012, -2.700000000000002, -2.2000000000000015, -2.2000000000000015, -1.9000000000000012, -1.700000000000001, -7.300000000000001, -2.2000000000000015, -2.3000000000000016, -2.0000000000000013, -1.8000000000000012, -1.8000000000000012, -1.700000000000001, -2.0000000000000013, -2.0000000000000013, -2.0000000000000013, -2.5000000000000018, -2.0000000000000013, -2.3000000000000016, -2.0000000000000013, -1.8000000000000012, -2.4000000000000017, -2.0000000000000013, -2.0000000000000013, -1.600000000000001, -1.8000000000000012, -2.5000000000000018, -2.1000000000000014, -2.600000000000002, -1.8000000000000012, -1.9000000000000012, -1.8000000000000012, -1.9000000000000012, -2.1000000000000014, -2.4000000000000017, -2.1000000000000014, -2.3000000000000016, -1.700000000000001, -1.5000000000000009, -2.0000000000000013, -1.600000000000001, -1.700000000000001, -3.200000000000001, -1.9000000000000012, -2.2000000000000015, -1.5000000000000009, -2.0000000000000013, -2.5000000000000018, -2.1000000000000014, -1.9000000000000012, -2.1000000000000014, -1.700000000000001, -1.9000000000000012, -2.1000000000000014, -1.600000000000001, -1.8000000000000012, -1.600000000000001, -1.700000000000001], "episode_lengths": [33, 29, 28, 28, 38, 32, 27, 29, 33, 32, 40, 34, 29, 30, 26, 31, 27, 28, 31, 30, 30, 39, 27, 26, 31, 27, 29, 29, 33, 27, 35, 33, 31, 30, 28, 29, 30, 33, 31, 41, 28, 31, 29, 39, 30, 28, 28, 32, 30, 32, 32, 34, 27, 32, 30, 36, 29, 35, 26, 36, 31, 30, 29, 32, 30, 31, 32, 31, 27, 29, 38, 33, 33, 30, 28, 66, 33, 34, 31, 29, 29, 28, 31, 31, 31, 36, 31, 34, 31, 29, 35, 31, 31, 27, 29, 36, 32, 37, 29, 30, 29, 30, 32, 35, 32, 34, 28, 26, 31, 27, 28, 37, 30, 33, 26, 31, 36, 32, 30, 32, 28, 30, 32, 27, 29, 27, 28]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3152819404207717, "mean_inference_ms": 0.7252586900702699, "mean_action_processing_ms": 0.07633937566274276, "mean_env_wait_ms": 6.762929354181778, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006795492697888472, "StateBufferConnector_ms": 0.004038472813884105, "ViewRequirementAgentConnector_ms": 0.09179716035137027}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 132000, "num_agent_steps_trained": 132000, "num_env_steps_sampled": 132000, "num_env_steps_trained": 132000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 486.9859703868042, "num_env_steps_trained_throughput_per_sec": 486.9859703868042, "timesteps_total": 132000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 132000, "timers": {"training_iteration_time_ms": 7981.064, "sample_time_ms": 4465.525, "load_time_ms": 0.984, "load_throughput": 4066021.036, "learn_time_ms": 3511.2, "learn_throughput": 1139.212, "synch_weights_time_ms": 2.696}, "counters": {"num_env_steps_sampled": 132000, "num_env_steps_trained": 132000, "num_agent_steps_sampled": 132000, "num_agent_steps_trained": 132000}, "done": false, "episodes_total": 1994, "training_iteration": 33, "trial_id": "2154c_00000", "date": "2024-03-07_13-08-43", "timestamp": 1709834923, "time_this_iter_s": 8.21684217453003, "time_total_s": 251.60206747055054, "pid": 116529, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7efea6399f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 251.60206747055054, "iterations_since_restore": 33, "perf": {"cpu_util_percent": 30.154545454545453, "ram_util_percent": 50.62727272727273, "gpu_util_percent0": 0.07363636363636364, "vram_util_percent0": 0.09437144886363637}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.10000000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 0.2802045516205341, "policy_loss": -0.0026494100689888, "vf_loss": 0.28155450208152655, "vf_explained_var": 0.8482930183410644, "kl": 0.012994563841653343, "entropy": 0.31733146221727454, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 31155.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 136000, "num_env_steps_trained": 136000, "num_agent_steps_sampled": 136000, "num_agent_steps_trained": 136000}, "sampler_results": {"episode_reward_max": -1.4000000000000008, "episode_reward_min": -7.499999999999986, "episode_reward_mean": -2.054615384615386, "episode_len_mean": 31.284615384615385, "episode_media": {}, "episodes_this_iter": 130, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1.9000000000000012, -1.9000000000000012, -1.5000000000000009, -2.3000000000000016, -1.4000000000000008, -1.9000000000000012, -2.0000000000000013, -2.1000000000000014, -1.8000000000000012, -1.700000000000001, -7.499999999999986, -1.700000000000001, -1.9000000000000012, -1.9000000000000012, -2.0000000000000013, -3.5999999999999996, -1.700000000000001, -2.1000000000000014, -1.9000000000000012, -1.5000000000000009, -1.5000000000000009, -2.0000000000000013, -2.3000000000000016, -2.2000000000000015, -2.0000000000000013, -1.5000000000000009, -3.0000000000000018, -2.5000000000000018, -2.2000000000000015, -1.600000000000001, -1.700000000000001, -2.0000000000000013, -2.0000000000000013, -2.1000000000000014, -1.8000000000000012, -2.0000000000000013, -2.3000000000000016, -1.600000000000001, -2.5000000000000018, -2.800000000000002, -2.4000000000000017, -1.700000000000001, -2.800000000000002, -1.600000000000001, -2.2000000000000015, -1.9000000000000012, -1.8000000000000012, -1.9000000000000012, -1.8000000000000012, -1.9000000000000012, -1.9000000000000012, -2.700000000000002, -1.600000000000001, -2.600000000000002, -1.9000000000000012, -1.8000000000000012, -1.8000000000000012, -2.5000000000000018, -1.4000000000000008, -1.8000000000000012, -4.900000000000003, -1.9000000000000012, -1.4000000000000008, -1.8000000000000012, -1.700000000000001, -1.5000000000000009, -2.1000000000000014, -1.8000000000000012, -2.2000000000000015, -2.1000000000000014, -1.8000000000000012, -1.700000000000001, -4.1000000000000005, -1.9000000000000012, -1.8000000000000012, -1.5000000000000009, -2.0000000000000013, -2.0000000000000013, -1.9000000000000012, -2.0000000000000013, -1.600000000000001, -2.2000000000000015, -1.5000000000000009, -2.2000000000000015, -1.4000000000000008, -1.600000000000001, -2.0000000000000013, -1.600000000000001, -1.8000000000000012, -1.9000000000000012, -2.600000000000002, -2.0000000000000013, -2.700000000000002, -1.700000000000001, -1.8000000000000012, -1.8000000000000012, -2.2000000000000015, -1.4000000000000008, -1.9000000000000012, -1.700000000000001, -1.8000000000000012, -1.9000000000000012, -1.8000000000000012, -1.600000000000001, -1.5000000000000009, -1.9000000000000012, -1.9000000000000012, -1.8000000000000012, -2.0000000000000013, -1.5000000000000009, -2.0000000000000013, -2.0000000000000013, -1.9000000000000012, -3.8000000000000016, -1.700000000000001, -2.0000000000000013, -2.0000000000000013, -1.8000000000000012, -2.1000000000000014, -1.9000000000000012, -2.3000000000000016, -2.1000000000000014, -2.1000000000000014, -2.2000000000000015, -2.0000000000000013, -4.1999999999999975, -2.0000000000000013, -1.8000000000000012, -1.8000000000000012, -2.1000000000000014], "episode_lengths": [30, 30, 26, 34, 25, 30, 31, 32, 29, 28, 82, 28, 30, 30, 31, 47, 28, 32, 30, 26, 26, 31, 34, 33, 31, 26, 36, 36, 33, 27, 28, 31, 31, 32, 29, 31, 34, 27, 36, 39, 35, 28, 37, 27, 33, 30, 29, 30, 29, 30, 30, 38, 27, 37, 30, 29, 29, 36, 25, 29, 48, 30, 25, 29, 28, 26, 32, 29, 33, 32, 29, 28, 45, 30, 29, 26, 31, 31, 30, 31, 27, 33, 26, 33, 25, 27, 31, 27, 29, 30, 37, 31, 38, 28, 29, 29, 33, 25, 30, 28, 29, 30, 29, 27, 26, 30, 30, 29, 31, 26, 31, 31, 30, 46, 28, 31, 31, 29, 32, 30, 34, 32, 32, 33, 31, 52, 31, 29, 29, 32]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3193180738833487, "mean_inference_ms": 0.726171931512883, "mean_action_processing_ms": 0.07644262496497341, "mean_env_wait_ms": 6.802504141067191, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006851416367750902, "StateBufferConnector_ms": 0.004182962270883413, "ViewRequirementAgentConnector_ms": 0.09383183259230393}}, "episode_reward_max": -1.4000000000000008, "episode_reward_min": -7.499999999999986, "episode_reward_mean": -2.054615384615386, "episode_len_mean": 31.284615384615385, "episodes_this_iter": 130, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1.9000000000000012, -1.9000000000000012, -1.5000000000000009, -2.3000000000000016, -1.4000000000000008, -1.9000000000000012, -2.0000000000000013, -2.1000000000000014, -1.8000000000000012, -1.700000000000001, -7.499999999999986, -1.700000000000001, -1.9000000000000012, -1.9000000000000012, -2.0000000000000013, -3.5999999999999996, -1.700000000000001, -2.1000000000000014, -1.9000000000000012, -1.5000000000000009, -1.5000000000000009, -2.0000000000000013, -2.3000000000000016, -2.2000000000000015, -2.0000000000000013, -1.5000000000000009, -3.0000000000000018, -2.5000000000000018, -2.2000000000000015, -1.600000000000001, -1.700000000000001, -2.0000000000000013, -2.0000000000000013, -2.1000000000000014, -1.8000000000000012, -2.0000000000000013, -2.3000000000000016, -1.600000000000001, -2.5000000000000018, -2.800000000000002, -2.4000000000000017, -1.700000000000001, -2.800000000000002, -1.600000000000001, -2.2000000000000015, -1.9000000000000012, -1.8000000000000012, -1.9000000000000012, -1.8000000000000012, -1.9000000000000012, -1.9000000000000012, -2.700000000000002, -1.600000000000001, -2.600000000000002, -1.9000000000000012, -1.8000000000000012, -1.8000000000000012, -2.5000000000000018, -1.4000000000000008, -1.8000000000000012, -4.900000000000003, -1.9000000000000012, -1.4000000000000008, -1.8000000000000012, -1.700000000000001, -1.5000000000000009, -2.1000000000000014, -1.8000000000000012, -2.2000000000000015, -2.1000000000000014, -1.8000000000000012, -1.700000000000001, -4.1000000000000005, -1.9000000000000012, -1.8000000000000012, -1.5000000000000009, -2.0000000000000013, -2.0000000000000013, -1.9000000000000012, -2.0000000000000013, -1.600000000000001, -2.2000000000000015, -1.5000000000000009, -2.2000000000000015, -1.4000000000000008, -1.600000000000001, -2.0000000000000013, -1.600000000000001, -1.8000000000000012, -1.9000000000000012, -2.600000000000002, -2.0000000000000013, -2.700000000000002, -1.700000000000001, -1.8000000000000012, -1.8000000000000012, -2.2000000000000015, -1.4000000000000008, -1.9000000000000012, -1.700000000000001, -1.8000000000000012, -1.9000000000000012, -1.8000000000000012, -1.600000000000001, -1.5000000000000009, -1.9000000000000012, -1.9000000000000012, -1.8000000000000012, -2.0000000000000013, -1.5000000000000009, -2.0000000000000013, -2.0000000000000013, -1.9000000000000012, -3.8000000000000016, -1.700000000000001, -2.0000000000000013, -2.0000000000000013, -1.8000000000000012, -2.1000000000000014, -1.9000000000000012, -2.3000000000000016, -2.1000000000000014, -2.1000000000000014, -2.2000000000000015, -2.0000000000000013, -4.1999999999999975, -2.0000000000000013, -1.8000000000000012, -1.8000000000000012, -2.1000000000000014], "episode_lengths": [30, 30, 26, 34, 25, 30, 31, 32, 29, 28, 82, 28, 30, 30, 31, 47, 28, 32, 30, 26, 26, 31, 34, 33, 31, 26, 36, 36, 33, 27, 28, 31, 31, 32, 29, 31, 34, 27, 36, 39, 35, 28, 37, 27, 33, 30, 29, 30, 29, 30, 30, 38, 27, 37, 30, 29, 29, 36, 25, 29, 48, 30, 25, 29, 28, 26, 32, 29, 33, 32, 29, 28, 45, 30, 29, 26, 31, 31, 30, 31, 27, 33, 26, 33, 25, 27, 31, 27, 29, 30, 37, 31, 38, 28, 29, 29, 33, 25, 30, 28, 29, 30, 29, 27, 26, 30, 30, 29, 31, 26, 31, 31, 30, 46, 28, 31, 31, 29, 32, 30, 34, 32, 32, 33, 31, 52, 31, 29, 29, 32]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3193180738833487, "mean_inference_ms": 0.726171931512883, "mean_action_processing_ms": 0.07644262496497341, "mean_env_wait_ms": 6.802504141067191, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006851416367750902, "StateBufferConnector_ms": 0.004182962270883413, "ViewRequirementAgentConnector_ms": 0.09383183259230393}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 136000, "num_agent_steps_trained": 136000, "num_env_steps_sampled": 136000, "num_env_steps_trained": 136000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 444.78708925659345, "num_env_steps_trained_throughput_per_sec": 444.78708925659345, "timesteps_total": 136000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 136000, "timers": {"training_iteration_time_ms": 8105.599, "sample_time_ms": 4591.997, "load_time_ms": 0.981, "load_throughput": 4075701.098, "learn_time_ms": 3509.212, "learn_throughput": 1139.857, "synch_weights_time_ms": 2.755}, "counters": {"num_env_steps_sampled": 136000, "num_env_steps_trained": 136000, "num_agent_steps_sampled": 136000, "num_agent_steps_trained": 136000}, "done": false, "episodes_total": 2124, "training_iteration": 34, "trial_id": "2154c_00000", "date": "2024-03-07_13-08-52", "timestamp": 1709834932, "time_this_iter_s": 8.99636960029602, "time_total_s": 260.59843707084656, "pid": 116529, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7efea6399f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 260.59843707084656, "iterations_since_restore": 34, "perf": {"cpu_util_percent": 31.00833333333333, "ram_util_percent": 50.70000000000001, "gpu_util_percent0": 0.07166666666666666, "vram_util_percent0": 0.09436713324652775}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.10000000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 0.058560021214440004, "policy_loss": -0.009419581376176368, "vf_loss": 0.06723694557233924, "vf_explained_var": 0.9400416337033753, "kl": 0.007426587352435285, "entropy": 0.3069860658017538, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 32085.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 140000, "num_env_steps_trained": 140000, "num_agent_steps_sampled": 140000, "num_agent_steps_trained": 140000}, "sampler_results": {"episode_reward_max": -1.4000000000000008, "episode_reward_min": -3.5, "episode_reward_mean": -1.9812500000000013, "episode_len_mean": 30.7734375, "episode_media": {}, "episodes_this_iter": 128, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2.700000000000002, -3.5, -1.700000000000001, -1.700000000000001, -2.0000000000000013, -1.8000000000000012, -1.8000000000000012, -1.700000000000001, -1.9000000000000012, -2.2000000000000015, -1.8000000000000012, -1.700000000000001, -1.9000000000000012, -2.0000000000000013, -2.0000000000000013, -2.0000000000000013, -2.4000000000000017, -1.700000000000001, -1.700000000000001, -1.5000000000000009, -2.900000000000002, -2.0000000000000013, -2.0000000000000013, -1.5000000000000009, -1.9000000000000012, -2.2000000000000015, -1.700000000000001, -2.0000000000000013, -1.8000000000000012, -1.9000000000000012, -1.600000000000001, -2.2000000000000015, -2.1000000000000014, -2.2000000000000015, -2.600000000000002, -1.5000000000000009, -1.8000000000000012, -1.700000000000001, -1.9000000000000012, -1.700000000000001, -1.9000000000000012, -1.9000000000000012, -1.700000000000001, -1.9000000000000012, -1.600000000000001, -1.700000000000001, -1.8000000000000012, -1.5000000000000009, -1.9000000000000012, -2.700000000000002, -1.8000000000000012, -1.9000000000000012, -2.3000000000000016, -2.1000000000000014, -1.8000000000000012, -1.600000000000001, -2.1000000000000014, -1.8000000000000012, -2.1000000000000014, -1.5000000000000009, -2.2000000000000015, -1.600000000000001, -2.0000000000000013, -1.600000000000001, -1.5000000000000009, -1.5000000000000009, -1.8000000000000012, -2.0000000000000013, -1.8000000000000012, -1.9000000000000012, -2.2000000000000015, -2.800000000000002, -1.700000000000001, -1.8000000000000012, -1.600000000000001, -1.600000000000001, -1.600000000000001, -1.4000000000000008, -1.700000000000001, -2.4000000000000017, -2.0000000000000013, -2.0000000000000013, -2.900000000000002, -1.8000000000000012, -1.8000000000000012, -2.1000000000000014, -2.2000000000000015, -1.700000000000001, -1.9000000000000012, -3.200000000000001, -2.2000000000000015, -1.700000000000001, -2.600000000000002, -2.4000000000000017, -1.700000000000001, -2.3000000000000016, -2.0000000000000013, -1.8000000000000012, -1.600000000000001, -1.9000000000000012, -2.3000000000000016, -2.0000000000000013, -2.3000000000000016, -2.0000000000000013, -1.600000000000001, -2.2000000000000015, -1.700000000000001, -2.1000000000000014, -1.700000000000001, -2.1000000000000014, -3.200000000000001, -2.2000000000000015, -1.8000000000000012, -1.700000000000001, -2.0000000000000013, -1.700000000000001, -1.8000000000000012, -2.4000000000000017, -3.4000000000000004, -1.8000000000000012, -1.8000000000000012, -2.0000000000000013, -1.700000000000001, -2.0000000000000013, -1.8000000000000012, -2.3000000000000016, -2.600000000000002, -2.4000000000000017], "episode_lengths": [38, 46, 28, 28, 31, 29, 29, 28, 30, 33, 29, 28, 30, 31, 31, 31, 35, 28, 28, 26, 40, 31, 31, 26, 30, 33, 28, 31, 29, 30, 27, 33, 32, 33, 37, 26, 29, 28, 30, 28, 30, 30, 28, 30, 27, 28, 29, 26, 30, 38, 29, 30, 34, 32, 29, 27, 32, 29, 32, 26, 33, 27, 31, 27, 26, 26, 29, 31, 29, 30, 33, 39, 28, 29, 27, 27, 27, 25, 28, 35, 31, 31, 40, 29, 29, 32, 33, 28, 30, 43, 33, 28, 37, 35, 28, 34, 31, 29, 27, 30, 34, 31, 34, 31, 27, 33, 28, 32, 28, 32, 43, 33, 29, 28, 31, 28, 29, 35, 40, 29, 29, 31, 28, 31, 29, 34, 37, 35]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.32228987503699535, "mean_inference_ms": 0.7263726685348357, "mean_action_processing_ms": 0.07642431280543602, "mean_env_wait_ms": 6.8226309181235445, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0067116692662239075, "StateBufferConnector_ms": 0.003949180245399475, "ViewRequirementAgentConnector_ms": 0.09031873196363449}}, "episode_reward_max": -1.4000000000000008, "episode_reward_min": -3.5, "episode_reward_mean": -1.9812500000000013, "episode_len_mean": 30.7734375, "episodes_this_iter": 128, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-2.700000000000002, -3.5, -1.700000000000001, -1.700000000000001, -2.0000000000000013, -1.8000000000000012, -1.8000000000000012, -1.700000000000001, -1.9000000000000012, -2.2000000000000015, -1.8000000000000012, -1.700000000000001, -1.9000000000000012, -2.0000000000000013, -2.0000000000000013, -2.0000000000000013, -2.4000000000000017, -1.700000000000001, -1.700000000000001, -1.5000000000000009, -2.900000000000002, -2.0000000000000013, -2.0000000000000013, -1.5000000000000009, -1.9000000000000012, -2.2000000000000015, -1.700000000000001, -2.0000000000000013, -1.8000000000000012, -1.9000000000000012, -1.600000000000001, -2.2000000000000015, -2.1000000000000014, -2.2000000000000015, -2.600000000000002, -1.5000000000000009, -1.8000000000000012, -1.700000000000001, -1.9000000000000012, -1.700000000000001, -1.9000000000000012, -1.9000000000000012, -1.700000000000001, -1.9000000000000012, -1.600000000000001, -1.700000000000001, -1.8000000000000012, -1.5000000000000009, -1.9000000000000012, -2.700000000000002, -1.8000000000000012, -1.9000000000000012, -2.3000000000000016, -2.1000000000000014, -1.8000000000000012, -1.600000000000001, -2.1000000000000014, -1.8000000000000012, -2.1000000000000014, -1.5000000000000009, -2.2000000000000015, -1.600000000000001, -2.0000000000000013, -1.600000000000001, -1.5000000000000009, -1.5000000000000009, -1.8000000000000012, -2.0000000000000013, -1.8000000000000012, -1.9000000000000012, -2.2000000000000015, -2.800000000000002, -1.700000000000001, -1.8000000000000012, -1.600000000000001, -1.600000000000001, -1.600000000000001, -1.4000000000000008, -1.700000000000001, -2.4000000000000017, -2.0000000000000013, -2.0000000000000013, -2.900000000000002, -1.8000000000000012, -1.8000000000000012, -2.1000000000000014, -2.2000000000000015, -1.700000000000001, -1.9000000000000012, -3.200000000000001, -2.2000000000000015, -1.700000000000001, -2.600000000000002, -2.4000000000000017, -1.700000000000001, -2.3000000000000016, -2.0000000000000013, -1.8000000000000012, -1.600000000000001, -1.9000000000000012, -2.3000000000000016, -2.0000000000000013, -2.3000000000000016, -2.0000000000000013, -1.600000000000001, -2.2000000000000015, -1.700000000000001, -2.1000000000000014, -1.700000000000001, -2.1000000000000014, -3.200000000000001, -2.2000000000000015, -1.8000000000000012, -1.700000000000001, -2.0000000000000013, -1.700000000000001, -1.8000000000000012, -2.4000000000000017, -3.4000000000000004, -1.8000000000000012, -1.8000000000000012, -2.0000000000000013, -1.700000000000001, -2.0000000000000013, -1.8000000000000012, -2.3000000000000016, -2.600000000000002, -2.4000000000000017], "episode_lengths": [38, 46, 28, 28, 31, 29, 29, 28, 30, 33, 29, 28, 30, 31, 31, 31, 35, 28, 28, 26, 40, 31, 31, 26, 30, 33, 28, 31, 29, 30, 27, 33, 32, 33, 37, 26, 29, 28, 30, 28, 30, 30, 28, 30, 27, 28, 29, 26, 30, 38, 29, 30, 34, 32, 29, 27, 32, 29, 32, 26, 33, 27, 31, 27, 26, 26, 29, 31, 29, 30, 33, 39, 28, 29, 27, 27, 27, 25, 28, 35, 31, 31, 40, 29, 29, 32, 33, 28, 30, 43, 33, 28, 37, 35, 28, 34, 31, 29, 27, 30, 34, 31, 34, 31, 27, 33, 28, 32, 28, 32, 43, 33, 29, 28, 31, 28, 29, 35, 40, 29, 29, 31, 28, 31, 29, 34, 37, 35]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.32228987503699535, "mean_inference_ms": 0.7263726685348357, "mean_action_processing_ms": 0.07642431280543602, "mean_env_wait_ms": 6.8226309181235445, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0067116692662239075, "StateBufferConnector_ms": 0.003949180245399475, "ViewRequirementAgentConnector_ms": 0.09031873196363449}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 140000, "num_agent_steps_trained": 140000, "num_env_steps_sampled": 140000, "num_env_steps_trained": 140000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 504.3320686165352, "num_env_steps_trained_throughput_per_sec": 504.3320686165352, "timesteps_total": 140000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 140000, "timers": {"training_iteration_time_ms": 8095.599, "sample_time_ms": 4583.783, "load_time_ms": 0.982, "load_throughput": 4074018.601, "learn_time_ms": 3507.469, "learn_throughput": 1140.424, "synch_weights_time_ms": 2.716}, "counters": {"num_env_steps_sampled": 140000, "num_env_steps_trained": 140000, "num_agent_steps_sampled": 140000, "num_agent_steps_trained": 140000}, "done": false, "episodes_total": 2252, "training_iteration": 35, "trial_id": "2154c_00000", "date": "2024-03-07_13-09-00", "timestamp": 1709834940, "time_this_iter_s": 7.934123516082764, "time_total_s": 268.5325605869293, "pid": 116529, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7efea6399f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 268.5325605869293, "iterations_since_restore": 35, "perf": {"cpu_util_percent": 32.64, "ram_util_percent": 50.67, "gpu_util_percent0": 0.07400000000000001, "vram_util_percent0": 0.0943603515625}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.10000000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 0.0018067948563369892, "policy_loss": -0.014146176883850687, "vf_loss": 0.015324247073161826, "vf_explained_var": 0.9810510964803798, "kl": 0.006287261682929614, "entropy": 0.2457556070339295, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 33015.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_agent_steps_sampled": 144000, "num_agent_steps_trained": 144000}, "sampler_results": {"episode_reward_max": -1.4000000000000008, "episode_reward_min": -3.5, "episode_reward_mean": -1.810000000000001, "episode_len_mean": 29.1, "episode_media": {}, "episodes_this_iter": 140, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2.1000000000000014, -1.9000000000000012, -1.8000000000000012, -1.9000000000000012, -1.5000000000000009, -1.700000000000001, -1.8000000000000012, -1.4000000000000008, -1.600000000000001, -1.9000000000000012, -1.600000000000001, -1.9000000000000012, -1.8000000000000012, -1.8000000000000012, -1.600000000000001, -1.700000000000001, -1.8000000000000012, -1.9000000000000012, -2.2000000000000015, -1.8000000000000012, -3.1000000000000014, -1.5000000000000009, -2.0000000000000013, -1.600000000000001, -1.600000000000001, -1.700000000000001, -1.600000000000001, -1.8000000000000012, -1.600000000000001, -2.0000000000000013, -2.1000000000000014, -1.5000000000000009, -2.3000000000000016, -2.1000000000000014, -2.3000000000000016, -2.0000000000000013, -2.1000000000000014, -1.600000000000001, -1.8000000000000012, -1.8000000000000012, -1.700000000000001, -1.600000000000001, -2.1000000000000014, -2.0000000000000013, -1.600000000000001, -1.8000000000000012, -1.700000000000001, -2.0000000000000013, -2.1000000000000014, -1.700000000000001, -2.0000000000000013, -1.700000000000001, -1.9000000000000012, -1.600000000000001, -1.600000000000001, -2.1000000000000014, -1.700000000000001, -1.8000000000000012, -2.2000000000000015, -1.700000000000001, -1.700000000000001, -1.700000000000001, -1.8000000000000012, -1.9000000000000012, -1.600000000000001, -2.1000000000000014, -1.8000000000000012, -1.5000000000000009, -1.600000000000001, -1.5000000000000009, -3.1000000000000014, -1.600000000000001, -1.700000000000001, -1.600000000000001, -1.4000000000000008, -1.8000000000000012, -1.5000000000000009, -1.9000000000000012, -1.8000000000000012, -1.700000000000001, -1.600000000000001, -1.700000000000001, -1.5000000000000009, -1.9000000000000012, -2.0000000000000013, -1.600000000000001, -1.8000000000000012, -1.4000000000000008, -1.5000000000000009, -2.1000000000000014, -1.8000000000000012, -1.9000000000000012, -1.4000000000000008, -2.1000000000000014, -1.9000000000000012, -1.9000000000000012, -1.5000000000000009, -1.8000000000000012, -2.1000000000000014, -2.0000000000000013, -1.4000000000000008, -1.700000000000001, -1.9000000000000012, -1.9000000000000012, -1.8000000000000012, -3.5, -1.700000000000001, -1.8000000000000012, -1.600000000000001, -1.4000000000000008, -1.8000000000000012, -1.9000000000000012, -1.600000000000001, -1.4000000000000008, -1.8000000000000012, -1.700000000000001, -1.700000000000001, -2.0000000000000013, -1.8000000000000012, -1.8000000000000012, -1.600000000000001, -1.4000000000000008, -1.700000000000001, -1.9000000000000012, -2.1000000000000014, -1.8000000000000012, -2.1000000000000014, -1.700000000000001, -1.9000000000000012, -2.0000000000000013, -2.0000000000000013, -1.8000000000000012, -1.9000000000000012, -1.600000000000001, -1.600000000000001, -1.9000000000000012, -1.700000000000001, -1.700000000000001, -1.700000000000001, -1.9000000000000012], "episode_lengths": [32, 30, 29, 30, 26, 28, 29, 25, 27, 30, 27, 30, 29, 29, 27, 28, 29, 30, 33, 29, 42, 26, 31, 27, 27, 28, 27, 29, 27, 31, 32, 26, 34, 32, 34, 31, 32, 27, 29, 29, 28, 27, 32, 31, 27, 29, 28, 31, 32, 28, 31, 28, 30, 27, 27, 32, 28, 29, 33, 28, 28, 28, 29, 30, 27, 32, 29, 26, 27, 26, 42, 27, 28, 27, 25, 29, 26, 30, 29, 28, 27, 28, 26, 30, 31, 27, 29, 25, 26, 32, 29, 30, 25, 32, 30, 30, 26, 29, 32, 31, 25, 28, 30, 30, 29, 46, 28, 29, 27, 25, 29, 30, 27, 25, 29, 28, 28, 31, 29, 29, 27, 25, 28, 30, 32, 29, 32, 28, 30, 31, 31, 29, 30, 27, 27, 30, 28, 28, 28, 30]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3259478332123976, "mean_inference_ms": 0.7263696824617757, "mean_action_processing_ms": 0.07644920943545061, "mean_env_wait_ms": 6.847189322057346, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006685427256992885, "StateBufferConnector_ms": 0.003970180238996234, "ViewRequirementAgentConnector_ms": 0.09022712707519531}}, "episode_reward_max": -1.4000000000000008, "episode_reward_min": -3.5, "episode_reward_mean": -1.810000000000001, "episode_len_mean": 29.1, "episodes_this_iter": 140, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-2.1000000000000014, -1.9000000000000012, -1.8000000000000012, -1.9000000000000012, -1.5000000000000009, -1.700000000000001, -1.8000000000000012, -1.4000000000000008, -1.600000000000001, -1.9000000000000012, -1.600000000000001, -1.9000000000000012, -1.8000000000000012, -1.8000000000000012, -1.600000000000001, -1.700000000000001, -1.8000000000000012, -1.9000000000000012, -2.2000000000000015, -1.8000000000000012, -3.1000000000000014, -1.5000000000000009, -2.0000000000000013, -1.600000000000001, -1.600000000000001, -1.700000000000001, -1.600000000000001, -1.8000000000000012, -1.600000000000001, -2.0000000000000013, -2.1000000000000014, -1.5000000000000009, -2.3000000000000016, -2.1000000000000014, -2.3000000000000016, -2.0000000000000013, -2.1000000000000014, -1.600000000000001, -1.8000000000000012, -1.8000000000000012, -1.700000000000001, -1.600000000000001, -2.1000000000000014, -2.0000000000000013, -1.600000000000001, -1.8000000000000012, -1.700000000000001, -2.0000000000000013, -2.1000000000000014, -1.700000000000001, -2.0000000000000013, -1.700000000000001, -1.9000000000000012, -1.600000000000001, -1.600000000000001, -2.1000000000000014, -1.700000000000001, -1.8000000000000012, -2.2000000000000015, -1.700000000000001, -1.700000000000001, -1.700000000000001, -1.8000000000000012, -1.9000000000000012, -1.600000000000001, -2.1000000000000014, -1.8000000000000012, -1.5000000000000009, -1.600000000000001, -1.5000000000000009, -3.1000000000000014, -1.600000000000001, -1.700000000000001, -1.600000000000001, -1.4000000000000008, -1.8000000000000012, -1.5000000000000009, -1.9000000000000012, -1.8000000000000012, -1.700000000000001, -1.600000000000001, -1.700000000000001, -1.5000000000000009, -1.9000000000000012, -2.0000000000000013, -1.600000000000001, -1.8000000000000012, -1.4000000000000008, -1.5000000000000009, -2.1000000000000014, -1.8000000000000012, -1.9000000000000012, -1.4000000000000008, -2.1000000000000014, -1.9000000000000012, -1.9000000000000012, -1.5000000000000009, -1.8000000000000012, -2.1000000000000014, -2.0000000000000013, -1.4000000000000008, -1.700000000000001, -1.9000000000000012, -1.9000000000000012, -1.8000000000000012, -3.5, -1.700000000000001, -1.8000000000000012, -1.600000000000001, -1.4000000000000008, -1.8000000000000012, -1.9000000000000012, -1.600000000000001, -1.4000000000000008, -1.8000000000000012, -1.700000000000001, -1.700000000000001, -2.0000000000000013, -1.8000000000000012, -1.8000000000000012, -1.600000000000001, -1.4000000000000008, -1.700000000000001, -1.9000000000000012, -2.1000000000000014, -1.8000000000000012, -2.1000000000000014, -1.700000000000001, -1.9000000000000012, -2.0000000000000013, -2.0000000000000013, -1.8000000000000012, -1.9000000000000012, -1.600000000000001, -1.600000000000001, -1.9000000000000012, -1.700000000000001, -1.700000000000001, -1.700000000000001, -1.9000000000000012], "episode_lengths": [32, 30, 29, 30, 26, 28, 29, 25, 27, 30, 27, 30, 29, 29, 27, 28, 29, 30, 33, 29, 42, 26, 31, 27, 27, 28, 27, 29, 27, 31, 32, 26, 34, 32, 34, 31, 32, 27, 29, 29, 28, 27, 32, 31, 27, 29, 28, 31, 32, 28, 31, 28, 30, 27, 27, 32, 28, 29, 33, 28, 28, 28, 29, 30, 27, 32, 29, 26, 27, 26, 42, 27, 28, 27, 25, 29, 26, 30, 29, 28, 27, 28, 26, 30, 31, 27, 29, 25, 26, 32, 29, 30, 25, 32, 30, 30, 26, 29, 32, 31, 25, 28, 30, 30, 29, 46, 28, 29, 27, 25, 29, 30, 27, 25, 29, 28, 28, 31, 29, 29, 27, 25, 28, 30, 32, 29, 32, 28, 30, 31, 31, 29, 30, 27, 27, 30, 28, 28, 28, 30]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3259478332123976, "mean_inference_ms": 0.7263696824617757, "mean_action_processing_ms": 0.07644920943545061, "mean_env_wait_ms": 6.847189322057346, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006685427256992885, "StateBufferConnector_ms": 0.003970180238996234, "ViewRequirementAgentConnector_ms": 0.09022712707519531}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 144000, "num_agent_steps_trained": 144000, "num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 496.55902669172406, "num_env_steps_trained_throughput_per_sec": 496.55902669172406, "timesteps_total": 144000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 144000, "timers": {"training_iteration_time_ms": 8119.587, "sample_time_ms": 4609.278, "load_time_ms": 0.985, "load_throughput": 4061689.827, "learn_time_ms": 3505.961, "learn_throughput": 1140.914, "synch_weights_time_ms": 2.712}, "counters": {"num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_agent_steps_sampled": 144000, "num_agent_steps_trained": 144000}, "done": false, "episodes_total": 2392, "training_iteration": 36, "trial_id": "2154c_00000", "date": "2024-03-07_13-09-08", "timestamp": 1709834948, "time_this_iter_s": 8.058443546295166, "time_total_s": 276.5910041332245, "pid": 116529, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7efea6399f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 276.5910041332245, "iterations_since_restore": 36, "perf": {"cpu_util_percent": 30.509090909090904, "ram_util_percent": 50.60909090909092, "gpu_util_percent0": 0.09090909090909091, "vram_util_percent0": 0.09434925426136363}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.10000000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 0.003891991402312953, "policy_loss": -0.01893611234883147, "vf_loss": 0.02158018401648689, "vf_explained_var": 0.9760827854756386, "kl": 0.012479198441751774, "entropy": 0.23918158875037265, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 33945.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 148000, "num_env_steps_trained": 148000, "num_agent_steps_sampled": 148000, "num_agent_steps_trained": 148000}, "sampler_results": {"episode_reward_max": -1.4000000000000008, "episode_reward_min": -3.200000000000001, "episode_reward_mean": -1.796376811594204, "episode_len_mean": 28.963768115942027, "episode_media": {}, "episodes_this_iter": 138, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1.9000000000000012, -1.5000000000000009, -1.600000000000001, -1.700000000000001, -1.600000000000001, -1.5000000000000009, -1.700000000000001, -2.5000000000000018, -1.8000000000000012, -1.700000000000001, -1.700000000000001, -1.9000000000000012, -1.8000000000000012, -2.0000000000000013, -1.9000000000000012, -1.5000000000000009, -1.4000000000000008, -1.8000000000000012, -2.0000000000000013, -1.600000000000001, -2.0000000000000013, -1.8000000000000012, -1.4000000000000008, -1.9000000000000012, -2.2000000000000015, -3.200000000000001, -1.600000000000001, -2.0000000000000013, -1.8000000000000012, -1.5000000000000009, -1.5000000000000009, -2.0000000000000013, -1.8000000000000012, -1.700000000000001, -1.4000000000000008, -1.9000000000000012, -1.700000000000001, -2.2000000000000015, -1.600000000000001, -1.9000000000000012, -1.700000000000001, -1.9000000000000012, -2.2000000000000015, -1.8000000000000012, -1.600000000000001, -1.5000000000000009, -1.5000000000000009, -1.600000000000001, -1.4000000000000008, -1.5000000000000009, -1.600000000000001, -1.9000000000000012, -1.600000000000001, -1.5000000000000009, -1.8000000000000012, -1.700000000000001, -1.8000000000000012, -2.5000000000000018, -2.0000000000000013, -2.900000000000002, -1.600000000000001, -1.700000000000001, -2.4000000000000017, -1.8000000000000012, -2.1000000000000014, -1.4000000000000008, -1.8000000000000012, -2.0000000000000013, -1.8000000000000012, -1.8000000000000012, -1.5000000000000009, -1.9000000000000012, -2.1000000000000014, -1.600000000000001, -2.2000000000000015, -2.0000000000000013, -2.0000000000000013, -1.5000000000000009, -2.0000000000000013, -1.4000000000000008, -1.600000000000001, -1.9000000000000012, -1.9000000000000012, -1.9000000000000012, -2.1000000000000014, -1.5000000000000009, -2.0000000000000013, -1.600000000000001, -1.8000000000000012, -1.5000000000000009, -1.8000000000000012, -1.4000000000000008, -1.700000000000001, -1.600000000000001, -1.4000000000000008, -2.2000000000000015, -1.700000000000001, -1.9000000000000012, -1.700000000000001, -1.5000000000000009, -1.8000000000000012, -1.5000000000000009, -1.8000000000000012, -1.700000000000001, -1.8000000000000012, -1.600000000000001, -1.9000000000000012, -1.8000000000000012, -1.8000000000000012, -1.8000000000000012, -2.0000000000000013, -1.700000000000001, -1.8000000000000012, -1.700000000000001, -1.9000000000000012, -1.700000000000001, -1.600000000000001, -1.4000000000000008, -2.2000000000000015, -2.0000000000000013, -1.700000000000001, -1.600000000000001, -1.8000000000000012, -2.0000000000000013, -1.8000000000000012, -1.700000000000001, -1.600000000000001, -2.3000000000000016, -1.5000000000000009, -2.1000000000000014, -1.4000000000000008, -1.5000000000000009, -2.1000000000000014, -2.4000000000000017, -1.4000000000000008, -1.9000000000000012, -1.9000000000000012, -2.2000000000000015], "episode_lengths": [30, 26, 27, 28, 27, 26, 28, 36, 29, 28, 28, 30, 29, 31, 30, 26, 25, 29, 31, 27, 31, 29, 25, 30, 33, 43, 27, 31, 29, 26, 26, 31, 29, 28, 25, 30, 28, 33, 27, 30, 28, 30, 33, 29, 27, 26, 26, 27, 25, 26, 27, 30, 27, 26, 29, 28, 29, 36, 31, 40, 27, 28, 35, 29, 32, 25, 29, 31, 29, 29, 26, 30, 32, 27, 33, 31, 31, 26, 31, 25, 27, 30, 30, 30, 32, 26, 31, 27, 29, 26, 29, 25, 28, 27, 25, 33, 28, 30, 28, 26, 29, 26, 29, 28, 29, 27, 30, 29, 29, 29, 31, 28, 29, 28, 30, 28, 27, 25, 33, 31, 28, 27, 29, 31, 29, 28, 27, 34, 26, 32, 25, 26, 32, 35, 25, 30, 30, 33]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.32917743298002633, "mean_inference_ms": 0.7264362713752603, "mean_action_processing_ms": 0.07640870912497193, "mean_env_wait_ms": 6.8689864960998035, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006686950075453607, "StateBufferConnector_ms": 0.00396949657495471, "ViewRequirementAgentConnector_ms": 0.0902127528536147}}, "episode_reward_max": -1.4000000000000008, "episode_reward_min": -3.200000000000001, "episode_reward_mean": -1.796376811594204, "episode_len_mean": 28.963768115942027, "episodes_this_iter": 138, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1.9000000000000012, -1.5000000000000009, -1.600000000000001, -1.700000000000001, -1.600000000000001, -1.5000000000000009, -1.700000000000001, -2.5000000000000018, -1.8000000000000012, -1.700000000000001, -1.700000000000001, -1.9000000000000012, -1.8000000000000012, -2.0000000000000013, -1.9000000000000012, -1.5000000000000009, -1.4000000000000008, -1.8000000000000012, -2.0000000000000013, -1.600000000000001, -2.0000000000000013, -1.8000000000000012, -1.4000000000000008, -1.9000000000000012, -2.2000000000000015, -3.200000000000001, -1.600000000000001, -2.0000000000000013, -1.8000000000000012, -1.5000000000000009, -1.5000000000000009, -2.0000000000000013, -1.8000000000000012, -1.700000000000001, -1.4000000000000008, -1.9000000000000012, -1.700000000000001, -2.2000000000000015, -1.600000000000001, -1.9000000000000012, -1.700000000000001, -1.9000000000000012, -2.2000000000000015, -1.8000000000000012, -1.600000000000001, -1.5000000000000009, -1.5000000000000009, -1.600000000000001, -1.4000000000000008, -1.5000000000000009, -1.600000000000001, -1.9000000000000012, -1.600000000000001, -1.5000000000000009, -1.8000000000000012, -1.700000000000001, -1.8000000000000012, -2.5000000000000018, -2.0000000000000013, -2.900000000000002, -1.600000000000001, -1.700000000000001, -2.4000000000000017, -1.8000000000000012, -2.1000000000000014, -1.4000000000000008, -1.8000000000000012, -2.0000000000000013, -1.8000000000000012, -1.8000000000000012, -1.5000000000000009, -1.9000000000000012, -2.1000000000000014, -1.600000000000001, -2.2000000000000015, -2.0000000000000013, -2.0000000000000013, -1.5000000000000009, -2.0000000000000013, -1.4000000000000008, -1.600000000000001, -1.9000000000000012, -1.9000000000000012, -1.9000000000000012, -2.1000000000000014, -1.5000000000000009, -2.0000000000000013, -1.600000000000001, -1.8000000000000012, -1.5000000000000009, -1.8000000000000012, -1.4000000000000008, -1.700000000000001, -1.600000000000001, -1.4000000000000008, -2.2000000000000015, -1.700000000000001, -1.9000000000000012, -1.700000000000001, -1.5000000000000009, -1.8000000000000012, -1.5000000000000009, -1.8000000000000012, -1.700000000000001, -1.8000000000000012, -1.600000000000001, -1.9000000000000012, -1.8000000000000012, -1.8000000000000012, -1.8000000000000012, -2.0000000000000013, -1.700000000000001, -1.8000000000000012, -1.700000000000001, -1.9000000000000012, -1.700000000000001, -1.600000000000001, -1.4000000000000008, -2.2000000000000015, -2.0000000000000013, -1.700000000000001, -1.600000000000001, -1.8000000000000012, -2.0000000000000013, -1.8000000000000012, -1.700000000000001, -1.600000000000001, -2.3000000000000016, -1.5000000000000009, -2.1000000000000014, -1.4000000000000008, -1.5000000000000009, -2.1000000000000014, -2.4000000000000017, -1.4000000000000008, -1.9000000000000012, -1.9000000000000012, -2.2000000000000015], "episode_lengths": [30, 26, 27, 28, 27, 26, 28, 36, 29, 28, 28, 30, 29, 31, 30, 26, 25, 29, 31, 27, 31, 29, 25, 30, 33, 43, 27, 31, 29, 26, 26, 31, 29, 28, 25, 30, 28, 33, 27, 30, 28, 30, 33, 29, 27, 26, 26, 27, 25, 26, 27, 30, 27, 26, 29, 28, 29, 36, 31, 40, 27, 28, 35, 29, 32, 25, 29, 31, 29, 29, 26, 30, 32, 27, 33, 31, 31, 26, 31, 25, 27, 30, 30, 30, 32, 26, 31, 27, 29, 26, 29, 25, 28, 27, 25, 33, 28, 30, 28, 26, 29, 26, 29, 28, 29, 27, 30, 29, 29, 29, 31, 28, 29, 28, 30, 28, 27, 25, 33, 31, 28, 27, 29, 31, 29, 28, 27, 34, 26, 32, 25, 26, 32, 35, 25, 30, 30, 33]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.32917743298002633, "mean_inference_ms": 0.7264362713752603, "mean_action_processing_ms": 0.07640870912497193, "mean_env_wait_ms": 6.8689864960998035, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006686950075453607, "StateBufferConnector_ms": 0.00396949657495471, "ViewRequirementAgentConnector_ms": 0.0902127528536147}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 148000, "num_agent_steps_trained": 148000, "num_env_steps_sampled": 148000, "num_env_steps_trained": 148000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 490.05078563093906, "num_env_steps_trained_throughput_per_sec": 490.05078563093906, "timesteps_total": 148000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 148000, "timers": {"training_iteration_time_ms": 8144.138, "sample_time_ms": 4617.099, "load_time_ms": 0.987, "load_throughput": 4051293.345, "learn_time_ms": 3522.643, "learn_throughput": 1135.511, "synch_weights_time_ms": 2.759}, "counters": {"num_env_steps_sampled": 148000, "num_env_steps_trained": 148000, "num_agent_steps_sampled": 148000, "num_agent_steps_trained": 148000}, "done": false, "episodes_total": 2530, "training_iteration": 37, "trial_id": "2154c_00000", "date": "2024-03-07_13-09-16", "timestamp": 1709834956, "time_this_iter_s": 8.165375232696533, "time_total_s": 284.756379365921, "pid": 116529, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7efea6399f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 284.756379365921, "iterations_since_restore": 37, "perf": {"cpu_util_percent": 32.61, "ram_util_percent": 50.7, "gpu_util_percent0": 0.08, "vram_util_percent0": 0.09434407552083335}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.10000000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 0.03022401589788847, "policy_loss": -0.0038580061852811804, "vf_loss": 0.03300754249331251, "vf_explained_var": 0.9684494720992222, "kl": 0.010744798029056351, "entropy": 0.23366736812937644, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 34875.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 152000, "num_env_steps_trained": 152000, "num_agent_steps_sampled": 152000, "num_agent_steps_trained": 152000}, "sampler_results": {"episode_reward_max": -1.4000000000000008, "episode_reward_min": -3.1000000000000014, "episode_reward_mean": -1.7726618705035981, "episode_len_mean": 28.654676258992804, "episode_media": {}, "episodes_this_iter": 139, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2.4000000000000017, -1.9000000000000012, -1.5000000000000009, -1.600000000000001, -2.0000000000000013, -2.0000000000000013, -1.8000000000000012, -1.600000000000001, -1.5000000000000009, -1.5000000000000009, -1.700000000000001, -1.600000000000001, -1.700000000000001, -2.1000000000000014, -1.600000000000001, -1.700000000000001, -1.700000000000001, -2.0000000000000013, -1.5000000000000009, -1.5000000000000009, -1.600000000000001, -1.5000000000000009, -2.0000000000000013, -1.700000000000001, -1.8000000000000012, -1.4000000000000008, -1.9000000000000012, -1.700000000000001, -1.8000000000000012, -1.700000000000001, -1.600000000000001, -1.700000000000001, -1.600000000000001, -2.1000000000000014, -1.700000000000001, -1.5000000000000009, -1.5000000000000009, -1.8000000000000012, -3.1000000000000014, -1.8000000000000012, -1.8000000000000012, -2.0000000000000013, -1.600000000000001, -1.4000000000000008, -1.5000000000000009, -1.5000000000000009, -2.0000000000000013, -1.700000000000001, -2.1000000000000014, -1.700000000000001, -1.9000000000000012, -1.9000000000000012, -1.600000000000001, -1.9000000000000012, -1.5000000000000009, -1.8000000000000012, -1.8000000000000012, -2.0000000000000013, -1.8000000000000012, -2.5000000000000018, -1.8000000000000012, -1.9000000000000012, -1.700000000000001, -2.0000000000000013, -1.8000000000000012, -2.2000000000000015, -2.0000000000000013, -1.700000000000001, -1.9000000000000012, -1.8000000000000012, -1.5000000000000009, -1.4000000000000008, -1.4000000000000008, -1.600000000000001, -1.600000000000001, -1.700000000000001, -1.700000000000001, -1.5000000000000009, -2.0000000000000013, -1.700000000000001, -1.8000000000000012, -1.8000000000000012, -2.2000000000000015, -1.4000000000000008, -1.5000000000000009, -1.9000000000000012, -1.9000000000000012, -1.9000000000000012, -1.9000000000000012, -1.9000000000000012, -1.600000000000001, -2.0000000000000013, -2.4000000000000017, -1.5000000000000009, -1.9000000000000012, -1.600000000000001, -2.1000000000000014, -1.700000000000001, -1.4000000000000008, -1.600000000000001, -1.5000000000000009, -2.800000000000002, -1.700000000000001, -2.1000000000000014, -2.0000000000000013, -1.600000000000001, -1.700000000000001, -2.2000000000000015, -1.8000000000000012, -1.9000000000000012, -1.8000000000000012, -1.5000000000000009, -1.9000000000000012, -1.5000000000000009, -1.8000000000000012, -1.700000000000001, -2.0000000000000013, -1.600000000000001, -2.0000000000000013, -1.8000000000000012, -1.9000000000000012, -1.700000000000001, -1.700000000000001, -1.4000000000000008, -1.700000000000001, -1.600000000000001, -1.4000000000000008, -1.9000000000000012, -1.600000000000001, -1.700000000000001, -1.700000000000001, -1.5000000000000009, -2.3000000000000016, -1.600000000000001, -1.5000000000000009, -1.700000000000001, -1.9000000000000012, -1.600000000000001, -1.8000000000000012], "episode_lengths": [35, 30, 26, 27, 31, 31, 29, 27, 26, 26, 28, 27, 28, 32, 27, 28, 28, 31, 26, 26, 27, 26, 31, 28, 29, 25, 30, 28, 29, 28, 27, 28, 27, 32, 28, 26, 26, 29, 37, 29, 29, 31, 27, 25, 26, 26, 31, 28, 32, 28, 30, 30, 27, 30, 26, 29, 29, 31, 29, 36, 29, 30, 28, 31, 29, 33, 31, 28, 30, 29, 26, 25, 25, 27, 27, 28, 28, 26, 31, 28, 29, 29, 33, 25, 26, 30, 30, 30, 30, 30, 27, 31, 35, 26, 30, 27, 32, 28, 25, 27, 26, 34, 28, 32, 31, 27, 28, 33, 29, 30, 29, 26, 30, 26, 29, 28, 31, 27, 31, 29, 30, 28, 28, 25, 28, 27, 25, 30, 27, 28, 28, 26, 34, 27, 26, 28, 30, 27, 29]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3321944916955853, "mean_inference_ms": 0.7265637916952524, "mean_action_processing_ms": 0.07640690319149245, "mean_env_wait_ms": 6.891304086512479, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0067119118121030516, "StateBufferConnector_ms": 0.003975929973794402, "ViewRequirementAgentConnector_ms": 0.09047144608531925}}, "episode_reward_max": -1.4000000000000008, "episode_reward_min": -3.1000000000000014, "episode_reward_mean": -1.7726618705035981, "episode_len_mean": 28.654676258992804, "episodes_this_iter": 139, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-2.4000000000000017, -1.9000000000000012, -1.5000000000000009, -1.600000000000001, -2.0000000000000013, -2.0000000000000013, -1.8000000000000012, -1.600000000000001, -1.5000000000000009, -1.5000000000000009, -1.700000000000001, -1.600000000000001, -1.700000000000001, -2.1000000000000014, -1.600000000000001, -1.700000000000001, -1.700000000000001, -2.0000000000000013, -1.5000000000000009, -1.5000000000000009, -1.600000000000001, -1.5000000000000009, -2.0000000000000013, -1.700000000000001, -1.8000000000000012, -1.4000000000000008, -1.9000000000000012, -1.700000000000001, -1.8000000000000012, -1.700000000000001, -1.600000000000001, -1.700000000000001, -1.600000000000001, -2.1000000000000014, -1.700000000000001, -1.5000000000000009, -1.5000000000000009, -1.8000000000000012, -3.1000000000000014, -1.8000000000000012, -1.8000000000000012, -2.0000000000000013, -1.600000000000001, -1.4000000000000008, -1.5000000000000009, -1.5000000000000009, -2.0000000000000013, -1.700000000000001, -2.1000000000000014, -1.700000000000001, -1.9000000000000012, -1.9000000000000012, -1.600000000000001, -1.9000000000000012, -1.5000000000000009, -1.8000000000000012, -1.8000000000000012, -2.0000000000000013, -1.8000000000000012, -2.5000000000000018, -1.8000000000000012, -1.9000000000000012, -1.700000000000001, -2.0000000000000013, -1.8000000000000012, -2.2000000000000015, -2.0000000000000013, -1.700000000000001, -1.9000000000000012, -1.8000000000000012, -1.5000000000000009, -1.4000000000000008, -1.4000000000000008, -1.600000000000001, -1.600000000000001, -1.700000000000001, -1.700000000000001, -1.5000000000000009, -2.0000000000000013, -1.700000000000001, -1.8000000000000012, -1.8000000000000012, -2.2000000000000015, -1.4000000000000008, -1.5000000000000009, -1.9000000000000012, -1.9000000000000012, -1.9000000000000012, -1.9000000000000012, -1.9000000000000012, -1.600000000000001, -2.0000000000000013, -2.4000000000000017, -1.5000000000000009, -1.9000000000000012, -1.600000000000001, -2.1000000000000014, -1.700000000000001, -1.4000000000000008, -1.600000000000001, -1.5000000000000009, -2.800000000000002, -1.700000000000001, -2.1000000000000014, -2.0000000000000013, -1.600000000000001, -1.700000000000001, -2.2000000000000015, -1.8000000000000012, -1.9000000000000012, -1.8000000000000012, -1.5000000000000009, -1.9000000000000012, -1.5000000000000009, -1.8000000000000012, -1.700000000000001, -2.0000000000000013, -1.600000000000001, -2.0000000000000013, -1.8000000000000012, -1.9000000000000012, -1.700000000000001, -1.700000000000001, -1.4000000000000008, -1.700000000000001, -1.600000000000001, -1.4000000000000008, -1.9000000000000012, -1.600000000000001, -1.700000000000001, -1.700000000000001, -1.5000000000000009, -2.3000000000000016, -1.600000000000001, -1.5000000000000009, -1.700000000000001, -1.9000000000000012, -1.600000000000001, -1.8000000000000012], "episode_lengths": [35, 30, 26, 27, 31, 31, 29, 27, 26, 26, 28, 27, 28, 32, 27, 28, 28, 31, 26, 26, 27, 26, 31, 28, 29, 25, 30, 28, 29, 28, 27, 28, 27, 32, 28, 26, 26, 29, 37, 29, 29, 31, 27, 25, 26, 26, 31, 28, 32, 28, 30, 30, 27, 30, 26, 29, 29, 31, 29, 36, 29, 30, 28, 31, 29, 33, 31, 28, 30, 29, 26, 25, 25, 27, 27, 28, 28, 26, 31, 28, 29, 29, 33, 25, 26, 30, 30, 30, 30, 30, 27, 31, 35, 26, 30, 27, 32, 28, 25, 27, 26, 34, 28, 32, 31, 27, 28, 33, 29, 30, 29, 26, 30, 26, 29, 28, 31, 27, 31, 29, 30, 28, 28, 25, 28, 27, 25, 30, 27, 28, 28, 26, 34, 27, 26, 28, 30, 27, 29]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3321944916955853, "mean_inference_ms": 0.7265637916952524, "mean_action_processing_ms": 0.07640690319149245, "mean_env_wait_ms": 6.891304086512479, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0067119118121030516, "StateBufferConnector_ms": 0.003975929973794402, "ViewRequirementAgentConnector_ms": 0.09047144608531925}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 152000, "num_agent_steps_trained": 152000, "num_env_steps_sampled": 152000, "num_env_steps_trained": 152000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 496.13660439986506, "num_env_steps_trained_throughput_per_sec": 496.13660439986506, "timesteps_total": 152000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 152000, "timers": {"training_iteration_time_ms": 8160.305, "sample_time_ms": 4628.284, "load_time_ms": 0.99, "load_throughput": 4040463.358, "learn_time_ms": 3527.748, "learn_throughput": 1133.868, "synch_weights_time_ms": 2.644}, "counters": {"num_env_steps_sampled": 152000, "num_env_steps_trained": 152000, "num_agent_steps_sampled": 152000, "num_agent_steps_trained": 152000}, "done": false, "episodes_total": 2669, "training_iteration": 38, "trial_id": "2154c_00000", "date": "2024-03-07_13-09-25", "timestamp": 1709834965, "time_this_iter_s": 8.06521463394165, "time_total_s": 292.82159399986267, "pid": 116529, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7efea6399f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 292.82159399986267, "iterations_since_restore": 38, "perf": {"cpu_util_percent": 30.727272727272727, "ram_util_percent": 50.7, "gpu_util_percent0": 0.08272727272727272, "vram_util_percent0": 0.0943640506628788}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.10000000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 0.11426123968483279, "policy_loss": -0.0026308226278953014, "vf_loss": 0.11511565446478104, "vf_explained_var": 0.9357034385204315, "kl": 0.017764078108627464, "entropy": 0.22547316868459025, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 35805.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 156000, "num_env_steps_trained": 156000, "num_agent_steps_sampled": 156000, "num_agent_steps_trained": 156000}, "sampler_results": {"episode_reward_max": -1.4000000000000008, "episode_reward_min": -5.8000000000000025, "episode_reward_mean": -1.8000000000000012, "episode_len_mean": 28.847826086956523, "episode_media": {}, "episodes_this_iter": 138, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2.1000000000000014, -1.600000000000001, -1.700000000000001, -1.9000000000000012, -2.3000000000000016, -1.9000000000000012, -1.600000000000001, -1.9000000000000012, -1.700000000000001, -1.700000000000001, -1.4000000000000008, -1.4000000000000008, -2.0000000000000013, -1.700000000000001, -1.5000000000000009, -1.700000000000001, -1.8000000000000012, -1.9000000000000012, -2.0000000000000013, -1.5000000000000009, -1.9000000000000012, -1.700000000000001, -1.5000000000000009, -1.600000000000001, -2.700000000000002, -1.700000000000001, -1.600000000000001, -1.700000000000001, -2.1000000000000014, -1.4000000000000008, -1.8000000000000012, -1.9000000000000012, -1.5000000000000009, -1.5000000000000009, -2.0000000000000013, -1.4000000000000008, -1.600000000000001, -1.9000000000000012, -1.700000000000001, -1.700000000000001, -2.1000000000000014, -1.600000000000001, -2.0000000000000013, -2.0000000000000013, -2.600000000000002, -1.9000000000000012, -1.600000000000001, -1.4000000000000008, -1.700000000000001, -1.600000000000001, -1.9000000000000012, -2.0000000000000013, -2.0000000000000013, -1.600000000000001, -1.700000000000001, -1.700000000000001, -1.9000000000000012, -1.8000000000000012, -1.600000000000001, -1.700000000000001, -1.600000000000001, -1.4000000000000008, -1.5000000000000009, -1.600000000000001, -1.5000000000000009, -1.600000000000001, -1.700000000000001, -1.8000000000000012, -1.8000000000000012, -1.9000000000000012, -1.700000000000001, -1.5000000000000009, -1.4000000000000008, -2.0000000000000013, -2.1000000000000014, -2.0000000000000013, -1.700000000000001, -2.1000000000000014, -1.600000000000001, -1.600000000000001, -1.600000000000001, -1.9000000000000012, -2.0000000000000013, -1.700000000000001, -1.5000000000000009, -1.600000000000001, -1.700000000000001, -1.9000000000000012, -2.4000000000000017, -1.700000000000001, -1.4000000000000008, -1.5000000000000009, -1.5000000000000009, -1.600000000000001, -1.5000000000000009, -1.600000000000001, -2.3000000000000016, -2.0000000000000013, -1.700000000000001, -1.8000000000000012, -1.5000000000000009, -1.700000000000001, -1.9000000000000012, -1.600000000000001, -1.5000000000000009, -2.1000000000000014, -1.9000000000000012, -1.9000000000000012, -1.5000000000000009, -1.5000000000000009, -1.4000000000000008, -1.9000000000000012, -1.700000000000001, -1.700000000000001, -1.8000000000000012, -1.8000000000000012, -1.5000000000000009, -1.700000000000001, -1.5000000000000009, -3.5, -1.5000000000000009, -1.600000000000001, -1.9000000000000012, -2.0000000000000013, -2.3000000000000016, -1.700000000000001, -1.9000000000000012, -1.700000000000001, -1.5000000000000009, -1.700000000000001, -1.8000000000000012, -5.8000000000000025, -2.4000000000000017, -1.600000000000001, -1.9000000000000012, -1.8000000000000012, -2.5000000000000018, -1.600000000000001], "episode_lengths": [32, 27, 28, 30, 34, 30, 27, 30, 28, 28, 25, 25, 31, 28, 26, 28, 29, 30, 31, 26, 30, 28, 26, 27, 38, 28, 27, 28, 32, 25, 29, 30, 26, 26, 31, 25, 27, 30, 28, 28, 32, 27, 31, 31, 37, 30, 27, 25, 28, 27, 30, 31, 31, 27, 28, 28, 30, 29, 27, 28, 27, 25, 26, 27, 26, 27, 28, 29, 29, 30, 28, 26, 25, 31, 32, 31, 28, 32, 27, 27, 27, 30, 31, 28, 26, 27, 28, 30, 35, 28, 25, 26, 26, 27, 26, 27, 34, 31, 28, 29, 26, 28, 30, 27, 26, 32, 30, 30, 26, 26, 25, 30, 28, 28, 29, 29, 26, 28, 26, 45, 26, 27, 30, 31, 34, 28, 30, 28, 26, 28, 29, 51, 35, 27, 30, 29, 34, 27]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3350163884554697, "mean_inference_ms": 0.7272022884310713, "mean_action_processing_ms": 0.07642667643276793, "mean_env_wait_ms": 6.909411857670958, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006713037905485734, "StateBufferConnector_ms": 0.0040088874706323595, "ViewRequirementAgentConnector_ms": 0.09082503940748132}}, "episode_reward_max": -1.4000000000000008, "episode_reward_min": -5.8000000000000025, "episode_reward_mean": -1.8000000000000012, "episode_len_mean": 28.847826086956523, "episodes_this_iter": 138, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-2.1000000000000014, -1.600000000000001, -1.700000000000001, -1.9000000000000012, -2.3000000000000016, -1.9000000000000012, -1.600000000000001, -1.9000000000000012, -1.700000000000001, -1.700000000000001, -1.4000000000000008, -1.4000000000000008, -2.0000000000000013, -1.700000000000001, -1.5000000000000009, -1.700000000000001, -1.8000000000000012, -1.9000000000000012, -2.0000000000000013, -1.5000000000000009, -1.9000000000000012, -1.700000000000001, -1.5000000000000009, -1.600000000000001, -2.700000000000002, -1.700000000000001, -1.600000000000001, -1.700000000000001, -2.1000000000000014, -1.4000000000000008, -1.8000000000000012, -1.9000000000000012, -1.5000000000000009, -1.5000000000000009, -2.0000000000000013, -1.4000000000000008, -1.600000000000001, -1.9000000000000012, -1.700000000000001, -1.700000000000001, -2.1000000000000014, -1.600000000000001, -2.0000000000000013, -2.0000000000000013, -2.600000000000002, -1.9000000000000012, -1.600000000000001, -1.4000000000000008, -1.700000000000001, -1.600000000000001, -1.9000000000000012, -2.0000000000000013, -2.0000000000000013, -1.600000000000001, -1.700000000000001, -1.700000000000001, -1.9000000000000012, -1.8000000000000012, -1.600000000000001, -1.700000000000001, -1.600000000000001, -1.4000000000000008, -1.5000000000000009, -1.600000000000001, -1.5000000000000009, -1.600000000000001, -1.700000000000001, -1.8000000000000012, -1.8000000000000012, -1.9000000000000012, -1.700000000000001, -1.5000000000000009, -1.4000000000000008, -2.0000000000000013, -2.1000000000000014, -2.0000000000000013, -1.700000000000001, -2.1000000000000014, -1.600000000000001, -1.600000000000001, -1.600000000000001, -1.9000000000000012, -2.0000000000000013, -1.700000000000001, -1.5000000000000009, -1.600000000000001, -1.700000000000001, -1.9000000000000012, -2.4000000000000017, -1.700000000000001, -1.4000000000000008, -1.5000000000000009, -1.5000000000000009, -1.600000000000001, -1.5000000000000009, -1.600000000000001, -2.3000000000000016, -2.0000000000000013, -1.700000000000001, -1.8000000000000012, -1.5000000000000009, -1.700000000000001, -1.9000000000000012, -1.600000000000001, -1.5000000000000009, -2.1000000000000014, -1.9000000000000012, -1.9000000000000012, -1.5000000000000009, -1.5000000000000009, -1.4000000000000008, -1.9000000000000012, -1.700000000000001, -1.700000000000001, -1.8000000000000012, -1.8000000000000012, -1.5000000000000009, -1.700000000000001, -1.5000000000000009, -3.5, -1.5000000000000009, -1.600000000000001, -1.9000000000000012, -2.0000000000000013, -2.3000000000000016, -1.700000000000001, -1.9000000000000012, -1.700000000000001, -1.5000000000000009, -1.700000000000001, -1.8000000000000012, -5.8000000000000025, -2.4000000000000017, -1.600000000000001, -1.9000000000000012, -1.8000000000000012, -2.5000000000000018, -1.600000000000001], "episode_lengths": [32, 27, 28, 30, 34, 30, 27, 30, 28, 28, 25, 25, 31, 28, 26, 28, 29, 30, 31, 26, 30, 28, 26, 27, 38, 28, 27, 28, 32, 25, 29, 30, 26, 26, 31, 25, 27, 30, 28, 28, 32, 27, 31, 31, 37, 30, 27, 25, 28, 27, 30, 31, 31, 27, 28, 28, 30, 29, 27, 28, 27, 25, 26, 27, 26, 27, 28, 29, 29, 30, 28, 26, 25, 31, 32, 31, 28, 32, 27, 27, 27, 30, 31, 28, 26, 27, 28, 30, 35, 28, 25, 26, 26, 27, 26, 27, 34, 31, 28, 29, 26, 28, 30, 27, 26, 32, 30, 30, 26, 26, 25, 30, 28, 28, 29, 29, 26, 28, 26, 45, 26, 27, 30, 31, 34, 28, 30, 28, 26, 28, 29, 51, 35, 27, 30, 29, 34, 27]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3350163884554697, "mean_inference_ms": 0.7272022884310713, "mean_action_processing_ms": 0.07642667643276793, "mean_env_wait_ms": 6.909411857670958, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006713037905485734, "StateBufferConnector_ms": 0.0040088874706323595, "ViewRequirementAgentConnector_ms": 0.09082503940748132}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 156000, "num_agent_steps_trained": 156000, "num_env_steps_sampled": 156000, "num_env_steps_trained": 156000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 498.76068024408727, "num_env_steps_trained_throughput_per_sec": 498.76068024408727, "timesteps_total": 156000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 156000, "timers": {"training_iteration_time_ms": 8159.594, "sample_time_ms": 4642.758, "load_time_ms": 0.988, "load_throughput": 4048946.81, "learn_time_ms": 3512.552, "learn_throughput": 1138.773, "synch_weights_time_ms": 2.65}, "counters": {"num_env_steps_sampled": 156000, "num_env_steps_trained": 156000, "num_agent_steps_sampled": 156000, "num_agent_steps_trained": 156000}, "done": false, "episodes_total": 2807, "training_iteration": 39, "trial_id": "2154c_00000", "date": "2024-03-07_13-09-33", "timestamp": 1709834973, "time_this_iter_s": 8.022940874099731, "time_total_s": 300.8445348739624, "pid": 116529, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7efea6399f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 300.8445348739624, "iterations_since_restore": 39, "perf": {"cpu_util_percent": 32.800000000000004, "ram_util_percent": 50.7, "gpu_util_percent0": 0.074, "vram_util_percent0": 0.09409179687500001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.10000000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 0.5960479742757255, "policy_loss": 0.00035697651165787894, "vf_loss": 0.5942957807752874, "vf_explained_var": 0.8331913392389975, "kl": 0.01395219574313919, "entropy": 0.23312167840939696, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 36735.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 160000, "num_env_steps_trained": 160000, "num_agent_steps_sampled": 160000, "num_agent_steps_trained": 160000}, "sampler_results": {"episode_reward_max": -1.4000000000000008, "episode_reward_min": -44.00000000000009, "episode_reward_mean": -2.090151515151517, "episode_len_mean": 30.37878787878788, "episode_media": {}, "episodes_this_iter": 132, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2.2000000000000015, -1.9000000000000012, -2.0000000000000013, -1.9000000000000012, -1.700000000000001, -2.3000000000000016, -1.9000000000000012, -1.8000000000000012, -1.700000000000001, -2.1000000000000014, -1.5000000000000009, -2.0000000000000013, -1.9000000000000012, -1.5000000000000009, -1.700000000000001, -1.700000000000001, -2.1000000000000014, -44.00000000000009, -1.700000000000001, -1.5000000000000009, -1.700000000000001, -1.5000000000000009, -2.0000000000000013, -1.8000000000000012, -2.3000000000000016, -2.1000000000000014, -1.600000000000001, -1.5000000000000009, -3.0000000000000018, -2.2000000000000015, -1.5000000000000009, -1.700000000000001, -1.5000000000000009, -1.5000000000000009, -1.5000000000000009, -1.600000000000001, -1.600000000000001, -2.0000000000000013, -1.8000000000000012, -1.4000000000000008, -1.8000000000000012, -1.700000000000001, -1.600000000000001, -2.2000000000000015, -1.8000000000000012, -1.4000000000000008, -1.5000000000000009, -1.5000000000000009, -1.600000000000001, -1.8000000000000012, -2.0000000000000013, -1.700000000000001, -1.700000000000001, -1.8000000000000012, -1.8000000000000012, -1.5000000000000009, -1.600000000000001, -2.1000000000000014, -2.2000000000000015, -2.2000000000000015, -1.5000000000000009, -1.5000000000000009, -1.700000000000001, -1.700000000000001, -3.3000000000000025, -2.0000000000000013, -1.9000000000000012, -1.8000000000000012, -1.600000000000001, -1.8000000000000012, -1.600000000000001, -1.9000000000000012, -1.600000000000001, -1.8000000000000012, -2.1000000000000014, -1.4000000000000008, -1.5000000000000009, -1.5000000000000009, -1.9000000000000012, -1.600000000000001, -1.600000000000001, -1.9000000000000012, -2.0000000000000013, -1.8000000000000012, -2.1000000000000014, -1.5000000000000009, -1.600000000000001, -1.5000000000000009, -1.8000000000000012, -1.9000000000000012, -1.600000000000001, -1.700000000000001, -1.8000000000000012, -1.4000000000000008, -1.600000000000001, -2.1000000000000014, -1.5000000000000009, -1.5000000000000009, -1.4000000000000008, -2.0000000000000013, -1.8000000000000012, -1.600000000000001, -1.9000000000000012, -1.8000000000000012, -1.9000000000000012, -1.9000000000000012, -1.600000000000001, -1.600000000000001, -1.600000000000001, -2.1000000000000014, -1.8000000000000012, -2.0000000000000013, -2.1000000000000014, -1.5000000000000009, -2.0000000000000013, -1.600000000000001, -1.5000000000000009, -1.700000000000001, -1.4000000000000008, -2.0000000000000013, -1.600000000000001, -1.700000000000001, -2.0000000000000013, -1.5000000000000009, -1.5000000000000009, -1.5000000000000009, -1.8000000000000012, -1.9000000000000012, -1.700000000000001, -1.600000000000001, -1.700000000000001, -1.600000000000001], "episode_lengths": [33, 30, 31, 30, 28, 34, 30, 29, 28, 32, 26, 31, 30, 26, 28, 28, 32, 261, 28, 26, 28, 26, 31, 29, 34, 32, 27, 26, 41, 33, 26, 28, 26, 26, 26, 27, 27, 31, 29, 25, 29, 28, 27, 31, 29, 25, 26, 26, 27, 29, 31, 28, 28, 29, 29, 26, 27, 32, 33, 33, 26, 26, 28, 28, 35, 31, 30, 29, 27, 29, 27, 30, 27, 29, 32, 25, 26, 26, 30, 27, 27, 30, 31, 29, 32, 26, 27, 26, 29, 30, 27, 28, 29, 25, 27, 32, 26, 26, 25, 31, 29, 27, 30, 29, 30, 30, 27, 27, 27, 32, 29, 31, 32, 26, 31, 27, 26, 28, 25, 31, 27, 28, 31, 26, 26, 26, 29, 30, 28, 27, 28, 27]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.33800945297327156, "mean_inference_ms": 0.7308783043148862, "mean_action_processing_ms": 0.07646029554537795, "mean_env_wait_ms": 6.92909876518538, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006802515550093217, "StateBufferConnector_ms": 0.004002542206735322, "ViewRequirementAgentConnector_ms": 0.09176929791768391}}, "episode_reward_max": -1.4000000000000008, "episode_reward_min": -44.00000000000009, "episode_reward_mean": -2.090151515151517, "episode_len_mean": 30.37878787878788, "episodes_this_iter": 132, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-2.2000000000000015, -1.9000000000000012, -2.0000000000000013, -1.9000000000000012, -1.700000000000001, -2.3000000000000016, -1.9000000000000012, -1.8000000000000012, -1.700000000000001, -2.1000000000000014, -1.5000000000000009, -2.0000000000000013, -1.9000000000000012, -1.5000000000000009, -1.700000000000001, -1.700000000000001, -2.1000000000000014, -44.00000000000009, -1.700000000000001, -1.5000000000000009, -1.700000000000001, -1.5000000000000009, -2.0000000000000013, -1.8000000000000012, -2.3000000000000016, -2.1000000000000014, -1.600000000000001, -1.5000000000000009, -3.0000000000000018, -2.2000000000000015, -1.5000000000000009, -1.700000000000001, -1.5000000000000009, -1.5000000000000009, -1.5000000000000009, -1.600000000000001, -1.600000000000001, -2.0000000000000013, -1.8000000000000012, -1.4000000000000008, -1.8000000000000012, -1.700000000000001, -1.600000000000001, -2.2000000000000015, -1.8000000000000012, -1.4000000000000008, -1.5000000000000009, -1.5000000000000009, -1.600000000000001, -1.8000000000000012, -2.0000000000000013, -1.700000000000001, -1.700000000000001, -1.8000000000000012, -1.8000000000000012, -1.5000000000000009, -1.600000000000001, -2.1000000000000014, -2.2000000000000015, -2.2000000000000015, -1.5000000000000009, -1.5000000000000009, -1.700000000000001, -1.700000000000001, -3.3000000000000025, -2.0000000000000013, -1.9000000000000012, -1.8000000000000012, -1.600000000000001, -1.8000000000000012, -1.600000000000001, -1.9000000000000012, -1.600000000000001, -1.8000000000000012, -2.1000000000000014, -1.4000000000000008, -1.5000000000000009, -1.5000000000000009, -1.9000000000000012, -1.600000000000001, -1.600000000000001, -1.9000000000000012, -2.0000000000000013, -1.8000000000000012, -2.1000000000000014, -1.5000000000000009, -1.600000000000001, -1.5000000000000009, -1.8000000000000012, -1.9000000000000012, -1.600000000000001, -1.700000000000001, -1.8000000000000012, -1.4000000000000008, -1.600000000000001, -2.1000000000000014, -1.5000000000000009, -1.5000000000000009, -1.4000000000000008, -2.0000000000000013, -1.8000000000000012, -1.600000000000001, -1.9000000000000012, -1.8000000000000012, -1.9000000000000012, -1.9000000000000012, -1.600000000000001, -1.600000000000001, -1.600000000000001, -2.1000000000000014, -1.8000000000000012, -2.0000000000000013, -2.1000000000000014, -1.5000000000000009, -2.0000000000000013, -1.600000000000001, -1.5000000000000009, -1.700000000000001, -1.4000000000000008, -2.0000000000000013, -1.600000000000001, -1.700000000000001, -2.0000000000000013, -1.5000000000000009, -1.5000000000000009, -1.5000000000000009, -1.8000000000000012, -1.9000000000000012, -1.700000000000001, -1.600000000000001, -1.700000000000001, -1.600000000000001], "episode_lengths": [33, 30, 31, 30, 28, 34, 30, 29, 28, 32, 26, 31, 30, 26, 28, 28, 32, 261, 28, 26, 28, 26, 31, 29, 34, 32, 27, 26, 41, 33, 26, 28, 26, 26, 26, 27, 27, 31, 29, 25, 29, 28, 27, 31, 29, 25, 26, 26, 27, 29, 31, 28, 28, 29, 29, 26, 27, 32, 33, 33, 26, 26, 28, 28, 35, 31, 30, 29, 27, 29, 27, 30, 27, 29, 32, 25, 26, 26, 30, 27, 27, 30, 31, 29, 32, 26, 27, 26, 29, 30, 27, 28, 29, 25, 27, 32, 26, 26, 25, 31, 29, 27, 30, 29, 30, 30, 27, 27, 27, 32, 29, 31, 32, 26, 31, 27, 26, 28, 25, 31, 27, 28, 31, 26, 26, 26, 29, 30, 28, 27, 28, 27]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.33800945297327156, "mean_inference_ms": 0.7308783043148862, "mean_action_processing_ms": 0.07646029554537795, "mean_env_wait_ms": 6.92909876518538, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006802515550093217, "StateBufferConnector_ms": 0.004002542206735322, "ViewRequirementAgentConnector_ms": 0.09176929791768391}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 160000, "num_agent_steps_trained": 160000, "num_env_steps_sampled": 160000, "num_env_steps_trained": 160000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 490.17638058677596, "num_env_steps_trained_throughput_per_sec": 490.17638058677596, "timesteps_total": 160000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 160000, "timers": {"training_iteration_time_ms": 8155.88, "sample_time_ms": 4633.422, "load_time_ms": 0.986, "load_throughput": 4058349.299, "learn_time_ms": 3518.137, "learn_throughput": 1136.965, "synch_weights_time_ms": 2.676}, "counters": {"num_env_steps_sampled": 160000, "num_env_steps_trained": 160000, "num_agent_steps_sampled": 160000, "num_agent_steps_trained": 160000}, "done": false, "episodes_total": 2939, "training_iteration": 40, "trial_id": "2154c_00000", "date": "2024-03-07_13-09-41", "timestamp": 1709834981, "time_this_iter_s": 8.163236379623413, "time_total_s": 309.0077712535858, "pid": 116529, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7efea6399f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 309.0077712535858, "iterations_since_restore": 40, "perf": {"cpu_util_percent": 31.12727272727273, "ram_util_percent": 50.7, "gpu_util_percent0": 0.08090909090909092, "vram_util_percent0": 0.09159712357954546}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.10000000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 0.06317148578268106, "policy_loss": -0.004509713452669882, "vf_loss": 0.06687727434089988, "vf_explained_var": 0.9536890834890386, "kl": 0.008039251624667312, "entropy": 0.23481549527696383, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 37665.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 164000, "num_env_steps_trained": 164000, "num_agent_steps_sampled": 164000, "num_agent_steps_trained": 164000}, "sampler_results": {"episode_reward_max": -1.4000000000000008, "episode_reward_min": -4.699999999999998, "episode_reward_mean": -1.8204379562043806, "episode_len_mean": 29.131386861313867, "episode_media": {}, "episodes_this_iter": 137, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1.600000000000001, -1.700000000000001, -1.600000000000001, -1.700000000000001, -1.600000000000001, -1.600000000000001, -1.9000000000000012, -2.4000000000000017, -1.9000000000000012, -2.1000000000000014, -1.600000000000001, -1.8000000000000012, -1.5000000000000009, -1.5000000000000009, -2.5000000000000018, -1.700000000000001, -1.5000000000000009, -1.700000000000001, -1.5000000000000009, -1.700000000000001, -1.700000000000001, -1.9000000000000012, -1.600000000000001, -2.0000000000000013, -2.3000000000000016, -1.700000000000001, -2.3000000000000016, -1.700000000000001, -1.600000000000001, -2.1000000000000014, -1.9000000000000012, -1.5000000000000009, -1.700000000000001, -1.700000000000001, -1.600000000000001, -1.700000000000001, -2.0000000000000013, -1.700000000000001, -1.600000000000001, -1.600000000000001, -2.0000000000000013, -1.700000000000001, -1.8000000000000012, -1.5000000000000009, -2.0000000000000013, -1.9000000000000012, -1.8000000000000012, -2.0000000000000013, -1.5000000000000009, -1.5000000000000009, -1.700000000000001, -1.700000000000001, -1.9000000000000012, -1.5000000000000009, -1.700000000000001, -1.5000000000000009, -2.600000000000002, -1.9000000000000012, -1.700000000000001, -2.2000000000000015, -1.600000000000001, -1.8000000000000012, -1.8000000000000012, -1.5000000000000009, -1.8000000000000012, -1.5000000000000009, -1.9000000000000012, -1.700000000000001, -1.8000000000000012, -1.9000000000000012, -1.5000000000000009, -1.700000000000001, -4.699999999999998, -1.700000000000001, -1.4000000000000008, -2.0000000000000013, -1.8000000000000012, -1.700000000000001, -2.3000000000000016, -1.600000000000001, -2.4000000000000017, -1.8000000000000012, -1.700000000000001, -2.0000000000000013, -1.600000000000001, -1.700000000000001, -1.8000000000000012, -1.8000000000000012, -1.4000000000000008, -1.9000000000000012, -1.600000000000001, -1.8000000000000012, -1.600000000000001, -2.2000000000000015, -1.5000000000000009, -1.9000000000000012, -2.2000000000000015, -1.8000000000000012, -1.5000000000000009, -1.9000000000000012, -2.0000000000000013, -1.8000000000000012, -2.0000000000000013, -2.5000000000000018, -1.700000000000001, -2.1000000000000014, -1.5000000000000009, -1.600000000000001, -1.9000000000000012, -1.8000000000000012, -2.0000000000000013, -2.800000000000002, -1.600000000000001, -2.0000000000000013, -1.600000000000001, -1.700000000000001, -1.700000000000001, -1.600000000000001, -1.5000000000000009, -2.2000000000000015, -1.8000000000000012, -1.5000000000000009, -1.600000000000001, -2.4000000000000017, -1.9000000000000012, -2.0000000000000013, -1.700000000000001, -1.600000000000001, -1.5000000000000009, -1.8000000000000012, -1.9000000000000012, -2.3000000000000016, -1.9000000000000012, -2.1000000000000014, -1.8000000000000012, -1.600000000000001, -1.5000000000000009], "episode_lengths": [27, 28, 27, 28, 27, 27, 30, 35, 30, 32, 27, 29, 26, 26, 36, 28, 26, 28, 26, 28, 28, 30, 27, 31, 34, 28, 34, 28, 27, 32, 30, 26, 28, 28, 27, 28, 31, 28, 27, 27, 31, 28, 29, 26, 31, 30, 29, 31, 26, 26, 28, 28, 30, 26, 28, 26, 37, 30, 28, 33, 27, 29, 29, 26, 29, 26, 30, 28, 29, 30, 26, 28, 51, 28, 25, 31, 29, 28, 34, 27, 35, 29, 28, 31, 27, 28, 29, 29, 25, 30, 27, 29, 27, 33, 26, 30, 33, 29, 26, 30, 31, 29, 31, 36, 28, 32, 26, 27, 30, 29, 31, 36, 27, 31, 27, 28, 28, 27, 26, 33, 29, 26, 27, 35, 30, 31, 28, 27, 26, 29, 30, 34, 30, 32, 29, 27, 26]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3412220477724253, "mean_inference_ms": 0.7330565520745554, "mean_action_processing_ms": 0.0765966959080756, "mean_env_wait_ms": 6.96760208325673, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007322234828976819, "StateBufferConnector_ms": 0.0044065670375406304, "ViewRequirementAgentConnector_ms": 0.09943272945654653}}, "episode_reward_max": -1.4000000000000008, "episode_reward_min": -4.699999999999998, "episode_reward_mean": -1.8204379562043806, "episode_len_mean": 29.131386861313867, "episodes_this_iter": 137, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1.600000000000001, -1.700000000000001, -1.600000000000001, -1.700000000000001, -1.600000000000001, -1.600000000000001, -1.9000000000000012, -2.4000000000000017, -1.9000000000000012, -2.1000000000000014, -1.600000000000001, -1.8000000000000012, -1.5000000000000009, -1.5000000000000009, -2.5000000000000018, -1.700000000000001, -1.5000000000000009, -1.700000000000001, -1.5000000000000009, -1.700000000000001, -1.700000000000001, -1.9000000000000012, -1.600000000000001, -2.0000000000000013, -2.3000000000000016, -1.700000000000001, -2.3000000000000016, -1.700000000000001, -1.600000000000001, -2.1000000000000014, -1.9000000000000012, -1.5000000000000009, -1.700000000000001, -1.700000000000001, -1.600000000000001, -1.700000000000001, -2.0000000000000013, -1.700000000000001, -1.600000000000001, -1.600000000000001, -2.0000000000000013, -1.700000000000001, -1.8000000000000012, -1.5000000000000009, -2.0000000000000013, -1.9000000000000012, -1.8000000000000012, -2.0000000000000013, -1.5000000000000009, -1.5000000000000009, -1.700000000000001, -1.700000000000001, -1.9000000000000012, -1.5000000000000009, -1.700000000000001, -1.5000000000000009, -2.600000000000002, -1.9000000000000012, -1.700000000000001, -2.2000000000000015, -1.600000000000001, -1.8000000000000012, -1.8000000000000012, -1.5000000000000009, -1.8000000000000012, -1.5000000000000009, -1.9000000000000012, -1.700000000000001, -1.8000000000000012, -1.9000000000000012, -1.5000000000000009, -1.700000000000001, -4.699999999999998, -1.700000000000001, -1.4000000000000008, -2.0000000000000013, -1.8000000000000012, -1.700000000000001, -2.3000000000000016, -1.600000000000001, -2.4000000000000017, -1.8000000000000012, -1.700000000000001, -2.0000000000000013, -1.600000000000001, -1.700000000000001, -1.8000000000000012, -1.8000000000000012, -1.4000000000000008, -1.9000000000000012, -1.600000000000001, -1.8000000000000012, -1.600000000000001, -2.2000000000000015, -1.5000000000000009, -1.9000000000000012, -2.2000000000000015, -1.8000000000000012, -1.5000000000000009, -1.9000000000000012, -2.0000000000000013, -1.8000000000000012, -2.0000000000000013, -2.5000000000000018, -1.700000000000001, -2.1000000000000014, -1.5000000000000009, -1.600000000000001, -1.9000000000000012, -1.8000000000000012, -2.0000000000000013, -2.800000000000002, -1.600000000000001, -2.0000000000000013, -1.600000000000001, -1.700000000000001, -1.700000000000001, -1.600000000000001, -1.5000000000000009, -2.2000000000000015, -1.8000000000000012, -1.5000000000000009, -1.600000000000001, -2.4000000000000017, -1.9000000000000012, -2.0000000000000013, -1.700000000000001, -1.600000000000001, -1.5000000000000009, -1.8000000000000012, -1.9000000000000012, -2.3000000000000016, -1.9000000000000012, -2.1000000000000014, -1.8000000000000012, -1.600000000000001, -1.5000000000000009], "episode_lengths": [27, 28, 27, 28, 27, 27, 30, 35, 30, 32, 27, 29, 26, 26, 36, 28, 26, 28, 26, 28, 28, 30, 27, 31, 34, 28, 34, 28, 27, 32, 30, 26, 28, 28, 27, 28, 31, 28, 27, 27, 31, 28, 29, 26, 31, 30, 29, 31, 26, 26, 28, 28, 30, 26, 28, 26, 37, 30, 28, 33, 27, 29, 29, 26, 29, 26, 30, 28, 29, 30, 26, 28, 51, 28, 25, 31, 29, 28, 34, 27, 35, 29, 28, 31, 27, 28, 29, 29, 25, 30, 27, 29, 27, 33, 26, 30, 33, 29, 26, 30, 31, 29, 31, 36, 28, 32, 26, 27, 30, 29, 31, 36, 27, 31, 27, 28, 28, 27, 26, 33, 29, 26, 27, 35, 30, 31, 28, 27, 26, 29, 30, 34, 30, 32, 29, 27, 26]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3412220477724253, "mean_inference_ms": 0.7330565520745554, "mean_action_processing_ms": 0.0765966959080756, "mean_env_wait_ms": 6.96760208325673, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007322234828976819, "StateBufferConnector_ms": 0.0044065670375406304, "ViewRequirementAgentConnector_ms": 0.09943272945654653}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 164000, "num_agent_steps_trained": 164000, "num_env_steps_sampled": 164000, "num_env_steps_trained": 164000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 446.2319617766299, "num_env_steps_trained_throughput_per_sec": 446.2319617766299, "timesteps_total": 164000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 164000, "timers": {"training_iteration_time_ms": 8250.324, "sample_time_ms": 4717.261, "load_time_ms": 0.989, "load_throughput": 4045432.099, "learn_time_ms": 3528.69, "learn_throughput": 1133.565, "synch_weights_time_ms": 2.721}, "counters": {"num_env_steps_sampled": 164000, "num_env_steps_trained": 164000, "num_agent_steps_sampled": 164000, "num_agent_steps_trained": 164000}, "done": false, "episodes_total": 3076, "training_iteration": 41, "trial_id": "2154c_00000", "date": "2024-03-07_13-09-50", "timestamp": 1709834990, "time_this_iter_s": 8.967122077941895, "time_total_s": 317.9748933315277, "pid": 116529, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7efea6399f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 317.9748933315277, "iterations_since_restore": 41, "perf": {"cpu_util_percent": 40.92727272727273, "ram_util_percent": 50.76363636363636, "gpu_util_percent0": 0.06727272727272728, "vram_util_percent0": 0.09351325757575758}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.10000000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 0.1763183881345916, "policy_loss": -0.01883546775907919, "vf_loss": 0.19151427568917873, "vf_explained_var": 0.8871073231902173, "kl": 0.03639580447155627, "entropy": 0.3194024397320645, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 38595.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 168000, "num_env_steps_trained": 168000, "num_agent_steps_sampled": 168000, "num_agent_steps_trained": 168000}, "sampler_results": {"episode_reward_max": -1.4000000000000008, "episode_reward_min": -5.1, "episode_reward_mean": -1.8800000000000012, "episode_len_mean": 29.51851851851852, "episode_media": {}, "episodes_this_iter": 135, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1.8000000000000012, -1.8000000000000012, -2.0000000000000013, -1.9000000000000012, -1.600000000000001, -2.3000000000000016, -1.5000000000000009, -1.4000000000000008, -2.0000000000000013, -1.9000000000000012, -1.4000000000000008, -1.8000000000000012, -1.5000000000000009, -2.0000000000000013, -2.3000000000000016, -1.9000000000000012, -1.5000000000000009, -2.0000000000000013, -1.600000000000001, -1.8000000000000012, -1.8000000000000012, -2.0000000000000013, -1.8000000000000012, -1.9000000000000012, -2.1000000000000014, -1.4000000000000008, -1.700000000000001, -1.9000000000000012, -1.8000000000000012, -2.0000000000000013, -1.9000000000000012, -1.5000000000000009, -1.700000000000001, -1.700000000000001, -2.1000000000000014, -2.2000000000000015, -1.5000000000000009, -2.0000000000000013, -1.700000000000001, -2.0000000000000013, -1.5000000000000009, -2.0000000000000013, -3.1000000000000014, -1.4000000000000008, -2.0000000000000013, -2.2000000000000015, -1.700000000000001, -1.8000000000000012, -1.700000000000001, -1.9000000000000012, -1.5000000000000009, -2.600000000000002, -1.8000000000000012, -1.4000000000000008, -1.600000000000001, -1.8000000000000012, -1.5000000000000009, -1.9000000000000012, -1.8000000000000012, -1.700000000000001, -1.8000000000000012, -1.600000000000001, -1.8000000000000012, -2.700000000000002, -1.700000000000001, -2.1000000000000014, -1.600000000000001, -1.8000000000000012, -1.5000000000000009, -1.600000000000001, -2.1000000000000014, -1.4000000000000008, -1.8000000000000012, -1.600000000000001, -2.1000000000000014, -1.700000000000001, -2.1000000000000014, -1.700000000000001, -1.9000000000000012, -1.700000000000001, -5.1, -2.2000000000000015, -1.8000000000000012, -1.8000000000000012, -2.1000000000000014, -1.8000000000000012, -1.5000000000000009, -1.9000000000000012, -1.700000000000001, -1.4000000000000008, -1.9000000000000012, -1.600000000000001, -1.8000000000000012, -1.5000000000000009, -2.700000000000002, -2.2000000000000015, -1.5000000000000009, -1.9000000000000012, -1.5000000000000009, -2.2000000000000015, -1.700000000000001, -2.1000000000000014, -1.700000000000001, -1.4000000000000008, -1.600000000000001, -1.8000000000000012, -1.5000000000000009, -4.2, -4.1999999999999975, -1.5000000000000009, -1.700000000000001, -1.8000000000000012, -1.4000000000000008, -1.600000000000001, -1.4000000000000008, -1.5000000000000009, -1.700000000000001, -1.600000000000001, -1.700000000000001, -3.5, -1.700000000000001, -2.5000000000000018, -1.5000000000000009, -2.600000000000002, -1.8000000000000012, -1.4000000000000008, -1.5000000000000009, -1.700000000000001, -2.600000000000002, -1.700000000000001, -1.5000000000000009, -3.0000000000000018, -1.600000000000001, -1.4000000000000008, -1.700000000000001], "episode_lengths": [29, 29, 31, 30, 27, 32, 26, 25, 31, 30, 25, 29, 26, 31, 34, 30, 26, 31, 27, 29, 29, 31, 29, 30, 32, 25, 28, 30, 29, 31, 30, 26, 28, 28, 32, 33, 26, 31, 28, 31, 26, 31, 40, 25, 31, 33, 28, 29, 28, 30, 26, 37, 29, 25, 27, 29, 26, 30, 29, 28, 29, 27, 29, 37, 28, 32, 27, 29, 26, 27, 32, 25, 29, 27, 32, 28, 32, 28, 30, 28, 50, 33, 29, 29, 32, 29, 26, 30, 28, 25, 30, 27, 29, 26, 33, 32, 26, 30, 26, 33, 28, 32, 28, 25, 27, 29, 26, 44, 53, 26, 28, 29, 25, 27, 25, 26, 28, 27, 28, 46, 28, 36, 26, 37, 29, 25, 26, 28, 37, 28, 26, 35, 27, 25, 28]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3435265242207342, "mean_inference_ms": 0.7329766992405224, "mean_action_processing_ms": 0.07660298473723857, "mean_env_wait_ms": 6.983352761117525, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006735413162796585, "StateBufferConnector_ms": 0.003976998505768953, "ViewRequirementAgentConnector_ms": 0.09054713779025608}}, "episode_reward_max": -1.4000000000000008, "episode_reward_min": -5.1, "episode_reward_mean": -1.8800000000000012, "episode_len_mean": 29.51851851851852, "episodes_this_iter": 135, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1.8000000000000012, -1.8000000000000012, -2.0000000000000013, -1.9000000000000012, -1.600000000000001, -2.3000000000000016, -1.5000000000000009, -1.4000000000000008, -2.0000000000000013, -1.9000000000000012, -1.4000000000000008, -1.8000000000000012, -1.5000000000000009, -2.0000000000000013, -2.3000000000000016, -1.9000000000000012, -1.5000000000000009, -2.0000000000000013, -1.600000000000001, -1.8000000000000012, -1.8000000000000012, -2.0000000000000013, -1.8000000000000012, -1.9000000000000012, -2.1000000000000014, -1.4000000000000008, -1.700000000000001, -1.9000000000000012, -1.8000000000000012, -2.0000000000000013, -1.9000000000000012, -1.5000000000000009, -1.700000000000001, -1.700000000000001, -2.1000000000000014, -2.2000000000000015, -1.5000000000000009, -2.0000000000000013, -1.700000000000001, -2.0000000000000013, -1.5000000000000009, -2.0000000000000013, -3.1000000000000014, -1.4000000000000008, -2.0000000000000013, -2.2000000000000015, -1.700000000000001, -1.8000000000000012, -1.700000000000001, -1.9000000000000012, -1.5000000000000009, -2.600000000000002, -1.8000000000000012, -1.4000000000000008, -1.600000000000001, -1.8000000000000012, -1.5000000000000009, -1.9000000000000012, -1.8000000000000012, -1.700000000000001, -1.8000000000000012, -1.600000000000001, -1.8000000000000012, -2.700000000000002, -1.700000000000001, -2.1000000000000014, -1.600000000000001, -1.8000000000000012, -1.5000000000000009, -1.600000000000001, -2.1000000000000014, -1.4000000000000008, -1.8000000000000012, -1.600000000000001, -2.1000000000000014, -1.700000000000001, -2.1000000000000014, -1.700000000000001, -1.9000000000000012, -1.700000000000001, -5.1, -2.2000000000000015, -1.8000000000000012, -1.8000000000000012, -2.1000000000000014, -1.8000000000000012, -1.5000000000000009, -1.9000000000000012, -1.700000000000001, -1.4000000000000008, -1.9000000000000012, -1.600000000000001, -1.8000000000000012, -1.5000000000000009, -2.700000000000002, -2.2000000000000015, -1.5000000000000009, -1.9000000000000012, -1.5000000000000009, -2.2000000000000015, -1.700000000000001, -2.1000000000000014, -1.700000000000001, -1.4000000000000008, -1.600000000000001, -1.8000000000000012, -1.5000000000000009, -4.2, -4.1999999999999975, -1.5000000000000009, -1.700000000000001, -1.8000000000000012, -1.4000000000000008, -1.600000000000001, -1.4000000000000008, -1.5000000000000009, -1.700000000000001, -1.600000000000001, -1.700000000000001, -3.5, -1.700000000000001, -2.5000000000000018, -1.5000000000000009, -2.600000000000002, -1.8000000000000012, -1.4000000000000008, -1.5000000000000009, -1.700000000000001, -2.600000000000002, -1.700000000000001, -1.5000000000000009, -3.0000000000000018, -1.600000000000001, -1.4000000000000008, -1.700000000000001], "episode_lengths": [29, 29, 31, 30, 27, 32, 26, 25, 31, 30, 25, 29, 26, 31, 34, 30, 26, 31, 27, 29, 29, 31, 29, 30, 32, 25, 28, 30, 29, 31, 30, 26, 28, 28, 32, 33, 26, 31, 28, 31, 26, 31, 40, 25, 31, 33, 28, 29, 28, 30, 26, 37, 29, 25, 27, 29, 26, 30, 29, 28, 29, 27, 29, 37, 28, 32, 27, 29, 26, 27, 32, 25, 29, 27, 32, 28, 32, 28, 30, 28, 50, 33, 29, 29, 32, 29, 26, 30, 28, 25, 30, 27, 29, 26, 33, 32, 26, 30, 26, 33, 28, 32, 28, 25, 27, 29, 26, 44, 53, 26, 28, 29, 25, 27, 25, 26, 28, 27, 28, 46, 28, 36, 26, 37, 29, 25, 26, 28, 37, 28, 26, 35, 27, 25, 28]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3435265242207342, "mean_inference_ms": 0.7329766992405224, "mean_action_processing_ms": 0.07660298473723857, "mean_env_wait_ms": 6.983352761117525, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006735413162796585, "StateBufferConnector_ms": 0.003976998505768953, "ViewRequirementAgentConnector_ms": 0.09054713779025608}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 168000, "num_agent_steps_trained": 168000, "num_env_steps_sampled": 168000, "num_env_steps_trained": 168000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 493.6497225304694, "num_env_steps_trained_throughput_per_sec": 493.6497225304694, "timesteps_total": 168000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 168000, "timers": {"training_iteration_time_ms": 8266.502, "sample_time_ms": 4732.851, "load_time_ms": 0.982, "load_throughput": 4071250.455, "learn_time_ms": 3529.272, "learn_throughput": 1133.378, "synch_weights_time_ms": 2.733}, "counters": {"num_env_steps_sampled": 168000, "num_env_steps_trained": 168000, "num_agent_steps_sampled": 168000, "num_agent_steps_trained": 168000}, "done": false, "episodes_total": 3211, "training_iteration": 42, "trial_id": "2154c_00000", "date": "2024-03-07_13-09-58", "timestamp": 1709834998, "time_this_iter_s": 8.105977058410645, "time_total_s": 326.08087038993835, "pid": 116529, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7efea6399f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 326.08087038993835, "iterations_since_restore": 42, "perf": {"cpu_util_percent": 30.863636363636363, "ram_util_percent": 50.71818181818182, "gpu_util_percent0": 0.08454545454545453, "vram_util_percent0": 0.09394235321969696}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.15, "cur_lr": 0.0010000000000000005, "total_loss": 0.07690555327071218, "policy_loss": -0.0059588639416121025, "vf_loss": 0.08119318065238536, "vf_explained_var": 0.936522457420185, "kl": 0.011141587748036993, "entropy": 0.22815321175962366, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 39525.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 172000, "num_env_steps_trained": 172000, "num_agent_steps_sampled": 172000, "num_agent_steps_trained": 172000}, "sampler_results": {"episode_reward_max": -1.4000000000000008, "episode_reward_min": -3.8999999999999986, "episode_reward_mean": -1.762937062937064, "episode_len_mean": 28.475524475524477, "episode_media": {}, "episodes_this_iter": 143, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2.0000000000000013, -1.600000000000001, -1.700000000000001, -1.8000000000000012, -2.0000000000000013, -1.700000000000001, -1.700000000000001, -2.2000000000000015, -1.600000000000001, -1.9000000000000012, -1.8000000000000012, -1.5000000000000009, -1.5000000000000009, -1.8000000000000012, -1.5000000000000009, -1.8000000000000012, -1.600000000000001, -1.600000000000001, -1.8000000000000012, -1.700000000000001, -3.8999999999999986, -2.4000000000000017, -1.9000000000000012, -3.4000000000000004, -1.5000000000000009, -2.4000000000000017, -2.0000000000000013, -2.2000000000000015, -1.9000000000000012, -1.700000000000001, -1.700000000000001, -1.600000000000001, -1.4000000000000008, -1.600000000000001, -1.600000000000001, -1.4000000000000008, -1.5000000000000009, -1.700000000000001, -1.600000000000001, -1.9000000000000012, -2.700000000000002, -1.8000000000000012, -1.5000000000000009, -1.600000000000001, -1.600000000000001, -1.600000000000001, -1.5000000000000009, -2.3000000000000016, -2.3000000000000016, -1.4000000000000008, -1.5000000000000009, -2.2000000000000015, -1.700000000000001, -1.600000000000001, -1.4000000000000008, -1.700000000000001, -1.4000000000000008, -1.700000000000001, -1.5000000000000009, -1.700000000000001, -2.5000000000000018, -1.8000000000000012, -1.9000000000000012, -2.2000000000000015, -1.600000000000001, -1.600000000000001, -1.700000000000001, -1.600000000000001, -1.700000000000001, -1.9000000000000012, -1.9000000000000012, -1.5000000000000009, -1.9000000000000012, -1.4000000000000008, -1.4000000000000008, -1.5000000000000009, -1.4000000000000008, -1.700000000000001, -1.700000000000001, -1.8000000000000012, -3.3000000000000007, -1.5000000000000009, -1.5000000000000009, -1.700000000000001, -1.700000000000001, -1.4000000000000008, -1.5000000000000009, -2.0000000000000013, -1.8000000000000012, -1.600000000000001, -1.600000000000001, -1.5000000000000009, -2.0000000000000013, -1.700000000000001, -2.0000000000000013, -1.9000000000000012, -1.8000000000000012, -1.700000000000001, -1.8000000000000012, -1.5000000000000009, -1.8000000000000012, -2.0000000000000013, -1.600000000000001, -1.5000000000000009, -1.5000000000000009, -1.600000000000001, -1.600000000000001, -1.9000000000000012, -1.9000000000000012, -1.4000000000000008, -1.700000000000001, -1.600000000000001, -2.0000000000000013, -1.9000000000000012, -1.700000000000001, -1.700000000000001, -1.4000000000000008, -1.700000000000001, -1.600000000000001, -1.5000000000000009, -1.4000000000000008, -1.4000000000000008, -1.600000000000001, -1.8000000000000012, -1.9000000000000012, -1.700000000000001, -2.1000000000000014, -2.1000000000000014, -1.700000000000001, -1.4000000000000008, -1.700000000000001, -1.5000000000000009, -2.2000000000000015, -1.600000000000001, -1.700000000000001, -1.700000000000001, -1.5000000000000009, -2.0000000000000013, -1.5000000000000009, -1.700000000000001, -1.5000000000000009, -2.0000000000000013, -1.8000000000000012], "episode_lengths": [31, 27, 28, 29, 31, 28, 28, 33, 27, 30, 29, 26, 26, 29, 26, 29, 27, 27, 29, 28, 44, 35, 30, 39, 26, 35, 31, 33, 30, 28, 28, 27, 25, 27, 27, 25, 26, 28, 27, 30, 33, 29, 26, 27, 27, 27, 26, 34, 34, 25, 26, 33, 28, 27, 25, 28, 25, 28, 26, 28, 35, 29, 30, 33, 27, 27, 28, 27, 28, 30, 30, 26, 30, 25, 25, 26, 25, 28, 28, 29, 40, 26, 26, 28, 28, 25, 26, 31, 29, 27, 27, 26, 31, 28, 31, 30, 29, 28, 29, 26, 29, 31, 27, 26, 26, 27, 27, 30, 30, 25, 28, 27, 31, 30, 28, 28, 25, 28, 27, 26, 25, 25, 27, 29, 30, 28, 32, 32, 28, 25, 28, 26, 33, 27, 28, 28, 26, 31, 26, 28, 26, 31, 29]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3462935368104394, "mean_inference_ms": 0.7328875149543638, "mean_action_processing_ms": 0.07659581261968237, "mean_env_wait_ms": 7.001135194786093, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0066200336376270215, "StateBufferConnector_ms": 0.0039590822233186735, "ViewRequirementAgentConnector_ms": 0.09090166825514573}}, "episode_reward_max": -1.4000000000000008, "episode_reward_min": -3.8999999999999986, "episode_reward_mean": -1.762937062937064, "episode_len_mean": 28.475524475524477, "episodes_this_iter": 143, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-2.0000000000000013, -1.600000000000001, -1.700000000000001, -1.8000000000000012, -2.0000000000000013, -1.700000000000001, -1.700000000000001, -2.2000000000000015, -1.600000000000001, -1.9000000000000012, -1.8000000000000012, -1.5000000000000009, -1.5000000000000009, -1.8000000000000012, -1.5000000000000009, -1.8000000000000012, -1.600000000000001, -1.600000000000001, -1.8000000000000012, -1.700000000000001, -3.8999999999999986, -2.4000000000000017, -1.9000000000000012, -3.4000000000000004, -1.5000000000000009, -2.4000000000000017, -2.0000000000000013, -2.2000000000000015, -1.9000000000000012, -1.700000000000001, -1.700000000000001, -1.600000000000001, -1.4000000000000008, -1.600000000000001, -1.600000000000001, -1.4000000000000008, -1.5000000000000009, -1.700000000000001, -1.600000000000001, -1.9000000000000012, -2.700000000000002, -1.8000000000000012, -1.5000000000000009, -1.600000000000001, -1.600000000000001, -1.600000000000001, -1.5000000000000009, -2.3000000000000016, -2.3000000000000016, -1.4000000000000008, -1.5000000000000009, -2.2000000000000015, -1.700000000000001, -1.600000000000001, -1.4000000000000008, -1.700000000000001, -1.4000000000000008, -1.700000000000001, -1.5000000000000009, -1.700000000000001, -2.5000000000000018, -1.8000000000000012, -1.9000000000000012, -2.2000000000000015, -1.600000000000001, -1.600000000000001, -1.700000000000001, -1.600000000000001, -1.700000000000001, -1.9000000000000012, -1.9000000000000012, -1.5000000000000009, -1.9000000000000012, -1.4000000000000008, -1.4000000000000008, -1.5000000000000009, -1.4000000000000008, -1.700000000000001, -1.700000000000001, -1.8000000000000012, -3.3000000000000007, -1.5000000000000009, -1.5000000000000009, -1.700000000000001, -1.700000000000001, -1.4000000000000008, -1.5000000000000009, -2.0000000000000013, -1.8000000000000012, -1.600000000000001, -1.600000000000001, -1.5000000000000009, -2.0000000000000013, -1.700000000000001, -2.0000000000000013, -1.9000000000000012, -1.8000000000000012, -1.700000000000001, -1.8000000000000012, -1.5000000000000009, -1.8000000000000012, -2.0000000000000013, -1.600000000000001, -1.5000000000000009, -1.5000000000000009, -1.600000000000001, -1.600000000000001, -1.9000000000000012, -1.9000000000000012, -1.4000000000000008, -1.700000000000001, -1.600000000000001, -2.0000000000000013, -1.9000000000000012, -1.700000000000001, -1.700000000000001, -1.4000000000000008, -1.700000000000001, -1.600000000000001, -1.5000000000000009, -1.4000000000000008, -1.4000000000000008, -1.600000000000001, -1.8000000000000012, -1.9000000000000012, -1.700000000000001, -2.1000000000000014, -2.1000000000000014, -1.700000000000001, -1.4000000000000008, -1.700000000000001, -1.5000000000000009, -2.2000000000000015, -1.600000000000001, -1.700000000000001, -1.700000000000001, -1.5000000000000009, -2.0000000000000013, -1.5000000000000009, -1.700000000000001, -1.5000000000000009, -2.0000000000000013, -1.8000000000000012], "episode_lengths": [31, 27, 28, 29, 31, 28, 28, 33, 27, 30, 29, 26, 26, 29, 26, 29, 27, 27, 29, 28, 44, 35, 30, 39, 26, 35, 31, 33, 30, 28, 28, 27, 25, 27, 27, 25, 26, 28, 27, 30, 33, 29, 26, 27, 27, 27, 26, 34, 34, 25, 26, 33, 28, 27, 25, 28, 25, 28, 26, 28, 35, 29, 30, 33, 27, 27, 28, 27, 28, 30, 30, 26, 30, 25, 25, 26, 25, 28, 28, 29, 40, 26, 26, 28, 28, 25, 26, 31, 29, 27, 27, 26, 31, 28, 31, 30, 29, 28, 29, 26, 29, 31, 27, 26, 26, 27, 27, 30, 30, 25, 28, 27, 31, 30, 28, 28, 25, 28, 27, 26, 25, 25, 27, 29, 30, 28, 32, 32, 28, 25, 28, 26, 33, 27, 28, 28, 26, 31, 26, 28, 26, 31, 29]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3462935368104394, "mean_inference_ms": 0.7328875149543638, "mean_action_processing_ms": 0.07659581261968237, "mean_env_wait_ms": 7.001135194786093, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0066200336376270215, "StateBufferConnector_ms": 0.0039590822233186735, "ViewRequirementAgentConnector_ms": 0.09090166825514573}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 172000, "num_agent_steps_trained": 172000, "num_env_steps_sampled": 172000, "num_env_steps_trained": 172000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 491.2613585706713, "num_env_steps_trained_throughput_per_sec": 491.2613585706713, "timesteps_total": 172000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 172000, "timers": {"training_iteration_time_ms": 8259.354, "sample_time_ms": 4727.618, "load_time_ms": 0.977, "load_throughput": 4093102.052, "learn_time_ms": 3527.445, "learn_throughput": 1133.965, "synch_weights_time_ms": 2.655}, "counters": {"num_env_steps_sampled": 172000, "num_env_steps_trained": 172000, "num_agent_steps_sampled": 172000, "num_agent_steps_trained": 172000}, "done": false, "episodes_total": 3354, "training_iteration": 43, "trial_id": "2154c_00000", "date": "2024-03-07_13-10-06", "timestamp": 1709835006, "time_this_iter_s": 8.145456075668335, "time_total_s": 334.2263264656067, "pid": 116529, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7efea6399f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 334.2263264656067, "iterations_since_restore": 43, "perf": {"cpu_util_percent": 33.089999999999996, "ram_util_percent": 50.720000000000006, "gpu_util_percent0": 0.074, "vram_util_percent0": 0.0939453125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.15, "cur_lr": 0.0010000000000000005, "total_loss": 0.012808509135458578, "policy_loss": -0.0027713881264771183, "vf_loss": 0.014688626165071161, "vf_explained_var": 0.9814305504804016, "kl": 0.005941806643402485, "entropy": 0.224340438089704, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 40455.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 176000, "num_env_steps_trained": 176000, "num_agent_steps_sampled": 176000, "num_agent_steps_trained": 176000}, "sampler_results": {"episode_reward_max": -1.4000000000000008, "episode_reward_min": -2.600000000000002, "episode_reward_mean": -1.7948905109489062, "episode_len_mean": 28.94890510948905, "episode_media": {}, "episodes_this_iter": 137, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1.5000000000000009, -1.600000000000001, -1.600000000000001, -2.0000000000000013, -1.9000000000000012, -1.700000000000001, -1.8000000000000012, -2.1000000000000014, -2.1000000000000014, -1.8000000000000012, -1.600000000000001, -1.700000000000001, -1.8000000000000012, -2.1000000000000014, -1.4000000000000008, -1.9000000000000012, -1.9000000000000012, -1.9000000000000012, -2.2000000000000015, -1.5000000000000009, -1.8000000000000012, -2.1000000000000014, -1.9000000000000012, -1.8000000000000012, -1.5000000000000009, -1.600000000000001, -1.5000000000000009, -1.700000000000001, -1.8000000000000012, -1.5000000000000009, -1.8000000000000012, -2.2000000000000015, -1.600000000000001, -1.8000000000000012, -1.9000000000000012, -1.5000000000000009, -1.9000000000000012, -2.0000000000000013, -1.8000000000000012, -2.2000000000000015, -1.700000000000001, -2.0000000000000013, -1.700000000000001, -2.2000000000000015, -1.700000000000001, -1.700000000000001, -1.700000000000001, -1.5000000000000009, -1.8000000000000012, -1.5000000000000009, -1.8000000000000012, -1.9000000000000012, -2.1000000000000014, -2.4000000000000017, -2.4000000000000017, -1.700000000000001, -1.5000000000000009, -1.5000000000000009, -1.700000000000001, -2.3000000000000016, -1.5000000000000009, -1.700000000000001, -2.0000000000000013, -1.9000000000000012, -1.5000000000000009, -1.700000000000001, -2.1000000000000014, -2.1000000000000014, -1.8000000000000012, -1.700000000000001, -1.700000000000001, -1.4000000000000008, -2.2000000000000015, -1.700000000000001, -1.600000000000001, -1.9000000000000012, -1.9000000000000012, -1.600000000000001, -1.600000000000001, -2.1000000000000014, -1.700000000000001, -2.600000000000002, -2.0000000000000013, -1.5000000000000009, -2.0000000000000013, -2.2000000000000015, -1.9000000000000012, -1.700000000000001, -2.0000000000000013, -1.4000000000000008, -1.600000000000001, -1.700000000000001, -1.700000000000001, -1.5000000000000009, -1.8000000000000012, -1.700000000000001, -1.600000000000001, -1.5000000000000009, -1.700000000000001, -1.5000000000000009, -1.600000000000001, -1.600000000000001, -1.5000000000000009, -1.8000000000000012, -1.8000000000000012, -1.700000000000001, -1.700000000000001, -1.600000000000001, -1.8000000000000012, -2.5000000000000018, -1.8000000000000012, -1.5000000000000009, -1.700000000000001, -1.8000000000000012, -1.600000000000001, -1.8000000000000012, -2.2000000000000015, -1.600000000000001, -1.8000000000000012, -1.8000000000000012, -1.700000000000001, -1.8000000000000012, -1.9000000000000012, -1.700000000000001, -2.3000000000000016, -2.2000000000000015, -1.5000000000000009, -2.0000000000000013, -1.9000000000000012, -1.5000000000000009, -1.8000000000000012, -1.700000000000001, -1.600000000000001, -1.700000000000001, -2.0000000000000013, -2.1000000000000014, -1.5000000000000009], "episode_lengths": [26, 27, 27, 31, 30, 28, 29, 32, 32, 29, 27, 28, 29, 32, 25, 30, 30, 30, 33, 26, 29, 32, 30, 29, 26, 27, 26, 28, 29, 26, 29, 33, 27, 29, 30, 26, 30, 31, 29, 33, 28, 31, 28, 33, 28, 28, 28, 26, 29, 26, 29, 30, 32, 35, 35, 28, 26, 26, 28, 34, 26, 28, 31, 30, 26, 28, 32, 32, 29, 28, 28, 25, 33, 28, 27, 30, 30, 27, 27, 32, 28, 37, 31, 26, 31, 33, 30, 28, 31, 25, 27, 28, 28, 26, 29, 28, 27, 26, 28, 26, 27, 27, 26, 29, 29, 28, 28, 27, 29, 36, 29, 26, 28, 29, 27, 29, 33, 27, 29, 29, 28, 29, 30, 28, 34, 33, 26, 31, 30, 26, 29, 28, 27, 28, 31, 32, 26]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3485751089462475, "mean_inference_ms": 0.7330704369228233, "mean_action_processing_ms": 0.07661714703196171, "mean_env_wait_ms": 7.021871075531647, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006900390569310989, "StateBufferConnector_ms": 0.0040821785474345635, "ViewRequirementAgentConnector_ms": 0.09192585074988595}}, "episode_reward_max": -1.4000000000000008, "episode_reward_min": -2.600000000000002, "episode_reward_mean": -1.7948905109489062, "episode_len_mean": 28.94890510948905, "episodes_this_iter": 137, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1.5000000000000009, -1.600000000000001, -1.600000000000001, -2.0000000000000013, -1.9000000000000012, -1.700000000000001, -1.8000000000000012, -2.1000000000000014, -2.1000000000000014, -1.8000000000000012, -1.600000000000001, -1.700000000000001, -1.8000000000000012, -2.1000000000000014, -1.4000000000000008, -1.9000000000000012, -1.9000000000000012, -1.9000000000000012, -2.2000000000000015, -1.5000000000000009, -1.8000000000000012, -2.1000000000000014, -1.9000000000000012, -1.8000000000000012, -1.5000000000000009, -1.600000000000001, -1.5000000000000009, -1.700000000000001, -1.8000000000000012, -1.5000000000000009, -1.8000000000000012, -2.2000000000000015, -1.600000000000001, -1.8000000000000012, -1.9000000000000012, -1.5000000000000009, -1.9000000000000012, -2.0000000000000013, -1.8000000000000012, -2.2000000000000015, -1.700000000000001, -2.0000000000000013, -1.700000000000001, -2.2000000000000015, -1.700000000000001, -1.700000000000001, -1.700000000000001, -1.5000000000000009, -1.8000000000000012, -1.5000000000000009, -1.8000000000000012, -1.9000000000000012, -2.1000000000000014, -2.4000000000000017, -2.4000000000000017, -1.700000000000001, -1.5000000000000009, -1.5000000000000009, -1.700000000000001, -2.3000000000000016, -1.5000000000000009, -1.700000000000001, -2.0000000000000013, -1.9000000000000012, -1.5000000000000009, -1.700000000000001, -2.1000000000000014, -2.1000000000000014, -1.8000000000000012, -1.700000000000001, -1.700000000000001, -1.4000000000000008, -2.2000000000000015, -1.700000000000001, -1.600000000000001, -1.9000000000000012, -1.9000000000000012, -1.600000000000001, -1.600000000000001, -2.1000000000000014, -1.700000000000001, -2.600000000000002, -2.0000000000000013, -1.5000000000000009, -2.0000000000000013, -2.2000000000000015, -1.9000000000000012, -1.700000000000001, -2.0000000000000013, -1.4000000000000008, -1.600000000000001, -1.700000000000001, -1.700000000000001, -1.5000000000000009, -1.8000000000000012, -1.700000000000001, -1.600000000000001, -1.5000000000000009, -1.700000000000001, -1.5000000000000009, -1.600000000000001, -1.600000000000001, -1.5000000000000009, -1.8000000000000012, -1.8000000000000012, -1.700000000000001, -1.700000000000001, -1.600000000000001, -1.8000000000000012, -2.5000000000000018, -1.8000000000000012, -1.5000000000000009, -1.700000000000001, -1.8000000000000012, -1.600000000000001, -1.8000000000000012, -2.2000000000000015, -1.600000000000001, -1.8000000000000012, -1.8000000000000012, -1.700000000000001, -1.8000000000000012, -1.9000000000000012, -1.700000000000001, -2.3000000000000016, -2.2000000000000015, -1.5000000000000009, -2.0000000000000013, -1.9000000000000012, -1.5000000000000009, -1.8000000000000012, -1.700000000000001, -1.600000000000001, -1.700000000000001, -2.0000000000000013, -2.1000000000000014, -1.5000000000000009], "episode_lengths": [26, 27, 27, 31, 30, 28, 29, 32, 32, 29, 27, 28, 29, 32, 25, 30, 30, 30, 33, 26, 29, 32, 30, 29, 26, 27, 26, 28, 29, 26, 29, 33, 27, 29, 30, 26, 30, 31, 29, 33, 28, 31, 28, 33, 28, 28, 28, 26, 29, 26, 29, 30, 32, 35, 35, 28, 26, 26, 28, 34, 26, 28, 31, 30, 26, 28, 32, 32, 29, 28, 28, 25, 33, 28, 27, 30, 30, 27, 27, 32, 28, 37, 31, 26, 31, 33, 30, 28, 31, 25, 27, 28, 28, 26, 29, 28, 27, 26, 28, 26, 27, 27, 26, 29, 29, 28, 28, 27, 29, 36, 29, 26, 28, 29, 27, 29, 33, 27, 29, 29, 28, 29, 30, 28, 34, 33, 26, 31, 30, 26, 29, 28, 27, 28, 31, 32, 26]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3485751089462475, "mean_inference_ms": 0.7330704369228233, "mean_action_processing_ms": 0.07661714703196171, "mean_env_wait_ms": 7.021871075531647, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006900390569310989, "StateBufferConnector_ms": 0.0040821785474345635, "ViewRequirementAgentConnector_ms": 0.09192585074988595}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 176000, "num_agent_steps_trained": 176000, "num_env_steps_sampled": 176000, "num_env_steps_trained": 176000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 470.6776798832054, "num_env_steps_trained_throughput_per_sec": 470.6776798832054, "timesteps_total": 176000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 176000, "timers": {"training_iteration_time_ms": 8209.884, "sample_time_ms": 4676.612, "load_time_ms": 0.978, "load_throughput": 4088613.345, "learn_time_ms": 3528.99, "learn_throughput": 1133.469, "synch_weights_time_ms": 2.64}, "counters": {"num_env_steps_sampled": 176000, "num_env_steps_trained": 176000, "num_agent_steps_sampled": 176000, "num_agent_steps_trained": 176000}, "done": false, "episodes_total": 3491, "training_iteration": 44, "trial_id": "2154c_00000", "date": "2024-03-07_13-10-15", "timestamp": 1709835015, "time_this_iter_s": 8.501752853393555, "time_total_s": 342.72807931900024, "pid": 116529, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7efea6399f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 342.72807931900024, "iterations_since_restore": 44, "perf": {"cpu_util_percent": 31.072727272727274, "ram_util_percent": 50.75454545454545, "gpu_util_percent0": 0.07181818181818182, "vram_util_percent0": 0.09395714962121211}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.15, "cur_lr": 0.0010000000000000005, "total_loss": 0.02121382759162976, "policy_loss": -0.0042896355692577616, "vf_loss": 0.024200981741230334, "vf_explained_var": 0.9705170638458703, "kl": 0.00868320968611173, "entropy": 0.18574521466288516, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 41385.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 180000, "num_env_steps_trained": 180000, "num_agent_steps_sampled": 180000, "num_agent_steps_trained": 180000}, "sampler_results": {"episode_reward_max": -1.4000000000000008, "episode_reward_min": -2.900000000000002, "episode_reward_mean": -1.7147887323943671, "episode_len_mean": 28.08450704225352, "episode_media": {}, "episodes_this_iter": 142, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1.9000000000000012, -1.5000000000000009, -2.2000000000000015, -1.5000000000000009, -2.1000000000000014, -1.8000000000000012, -1.600000000000001, -1.600000000000001, -1.600000000000001, -1.4000000000000008, -1.9000000000000012, -1.600000000000001, -1.9000000000000012, -1.5000000000000009, -1.700000000000001, -1.700000000000001, -2.1000000000000014, -1.600000000000001, -1.700000000000001, -1.5000000000000009, -1.4000000000000008, -2.0000000000000013, -1.600000000000001, -1.4000000000000008, -1.5000000000000009, -1.700000000000001, -1.700000000000001, -1.4000000000000008, -1.700000000000001, -1.600000000000001, -1.600000000000001, -1.600000000000001, -1.600000000000001, -1.4000000000000008, -1.8000000000000012, -2.5000000000000018, -1.8000000000000012, -2.3000000000000016, -1.700000000000001, -2.3000000000000016, -1.600000000000001, -1.700000000000001, -1.8000000000000012, -1.5000000000000009, -1.9000000000000012, -1.8000000000000012, -1.600000000000001, -1.5000000000000009, -2.0000000000000013, -1.600000000000001, -1.700000000000001, -1.5000000000000009, -1.5000000000000009, -1.600000000000001, -1.700000000000001, -1.9000000000000012, -1.4000000000000008, -1.700000000000001, -1.700000000000001, -1.600000000000001, -1.4000000000000008, -1.600000000000001, -1.9000000000000012, -1.700000000000001, -1.8000000000000012, -1.5000000000000009, -1.600000000000001, -1.4000000000000008, -1.600000000000001, -1.600000000000001, -1.600000000000001, -1.9000000000000012, -1.8000000000000012, -1.5000000000000009, -1.5000000000000009, -2.4000000000000017, -1.600000000000001, -1.600000000000001, -2.1000000000000014, -1.4000000000000008, -1.5000000000000009, -1.5000000000000009, -2.2000000000000015, -1.5000000000000009, -1.8000000000000012, -1.8000000000000012, -1.9000000000000012, -1.9000000000000012, -2.1000000000000014, -1.5000000000000009, -2.4000000000000017, -1.4000000000000008, -1.600000000000001, -1.8000000000000012, -1.600000000000001, -1.9000000000000012, -1.5000000000000009, -1.9000000000000012, -1.700000000000001, -1.9000000000000012, -1.600000000000001, -1.700000000000001, -1.700000000000001, -1.600000000000001, -1.4000000000000008, -1.5000000000000009, -1.700000000000001, -1.8000000000000012, -1.700000000000001, -1.9000000000000012, -2.0000000000000013, -1.5000000000000009, -1.600000000000001, -1.9000000000000012, -1.600000000000001, -1.9000000000000012, -1.5000000000000009, -1.5000000000000009, -1.600000000000001, -1.4000000000000008, -1.5000000000000009, -1.8000000000000012, -1.9000000000000012, -1.700000000000001, -1.5000000000000009, -1.9000000000000012, -1.600000000000001, -1.9000000000000012, -2.900000000000002, -2.2000000000000015, -1.8000000000000012, -1.700000000000001, -1.5000000000000009, -1.700000000000001, -1.5000000000000009, -1.600000000000001, -1.4000000000000008, -2.0000000000000013, -1.600000000000001, -1.9000000000000012, -1.600000000000001, -2.0000000000000013], "episode_lengths": [30, 26, 33, 26, 32, 29, 27, 27, 27, 25, 30, 27, 30, 26, 28, 28, 32, 27, 28, 26, 25, 31, 27, 25, 26, 28, 28, 25, 28, 27, 27, 27, 27, 25, 29, 36, 29, 34, 28, 34, 27, 28, 29, 26, 30, 29, 27, 26, 31, 27, 28, 26, 26, 27, 28, 30, 25, 28, 28, 27, 25, 27, 30, 28, 29, 26, 27, 25, 27, 27, 27, 30, 29, 26, 26, 32, 27, 27, 31, 25, 26, 26, 33, 26, 29, 29, 30, 30, 32, 26, 35, 25, 27, 29, 27, 30, 26, 30, 28, 30, 27, 28, 28, 27, 25, 26, 28, 29, 28, 30, 31, 26, 27, 30, 27, 30, 26, 26, 27, 25, 26, 29, 30, 28, 26, 30, 27, 30, 35, 33, 29, 28, 26, 28, 26, 27, 25, 31, 27, 30, 27, 31]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3508988638428518, "mean_inference_ms": 0.7331537082629265, "mean_action_processing_ms": 0.07663428684882244, "mean_env_wait_ms": 7.040505473126602, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006794090002355441, "StateBufferConnector_ms": 0.004045896127190389, "ViewRequirementAgentConnector_ms": 0.09175203215907997}}, "episode_reward_max": -1.4000000000000008, "episode_reward_min": -2.900000000000002, "episode_reward_mean": -1.7147887323943671, "episode_len_mean": 28.08450704225352, "episodes_this_iter": 142, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1.9000000000000012, -1.5000000000000009, -2.2000000000000015, -1.5000000000000009, -2.1000000000000014, -1.8000000000000012, -1.600000000000001, -1.600000000000001, -1.600000000000001, -1.4000000000000008, -1.9000000000000012, -1.600000000000001, -1.9000000000000012, -1.5000000000000009, -1.700000000000001, -1.700000000000001, -2.1000000000000014, -1.600000000000001, -1.700000000000001, -1.5000000000000009, -1.4000000000000008, -2.0000000000000013, -1.600000000000001, -1.4000000000000008, -1.5000000000000009, -1.700000000000001, -1.700000000000001, -1.4000000000000008, -1.700000000000001, -1.600000000000001, -1.600000000000001, -1.600000000000001, -1.600000000000001, -1.4000000000000008, -1.8000000000000012, -2.5000000000000018, -1.8000000000000012, -2.3000000000000016, -1.700000000000001, -2.3000000000000016, -1.600000000000001, -1.700000000000001, -1.8000000000000012, -1.5000000000000009, -1.9000000000000012, -1.8000000000000012, -1.600000000000001, -1.5000000000000009, -2.0000000000000013, -1.600000000000001, -1.700000000000001, -1.5000000000000009, -1.5000000000000009, -1.600000000000001, -1.700000000000001, -1.9000000000000012, -1.4000000000000008, -1.700000000000001, -1.700000000000001, -1.600000000000001, -1.4000000000000008, -1.600000000000001, -1.9000000000000012, -1.700000000000001, -1.8000000000000012, -1.5000000000000009, -1.600000000000001, -1.4000000000000008, -1.600000000000001, -1.600000000000001, -1.600000000000001, -1.9000000000000012, -1.8000000000000012, -1.5000000000000009, -1.5000000000000009, -2.4000000000000017, -1.600000000000001, -1.600000000000001, -2.1000000000000014, -1.4000000000000008, -1.5000000000000009, -1.5000000000000009, -2.2000000000000015, -1.5000000000000009, -1.8000000000000012, -1.8000000000000012, -1.9000000000000012, -1.9000000000000012, -2.1000000000000014, -1.5000000000000009, -2.4000000000000017, -1.4000000000000008, -1.600000000000001, -1.8000000000000012, -1.600000000000001, -1.9000000000000012, -1.5000000000000009, -1.9000000000000012, -1.700000000000001, -1.9000000000000012, -1.600000000000001, -1.700000000000001, -1.700000000000001, -1.600000000000001, -1.4000000000000008, -1.5000000000000009, -1.700000000000001, -1.8000000000000012, -1.700000000000001, -1.9000000000000012, -2.0000000000000013, -1.5000000000000009, -1.600000000000001, -1.9000000000000012, -1.600000000000001, -1.9000000000000012, -1.5000000000000009, -1.5000000000000009, -1.600000000000001, -1.4000000000000008, -1.5000000000000009, -1.8000000000000012, -1.9000000000000012, -1.700000000000001, -1.5000000000000009, -1.9000000000000012, -1.600000000000001, -1.9000000000000012, -2.900000000000002, -2.2000000000000015, -1.8000000000000012, -1.700000000000001, -1.5000000000000009, -1.700000000000001, -1.5000000000000009, -1.600000000000001, -1.4000000000000008, -2.0000000000000013, -1.600000000000001, -1.9000000000000012, -1.600000000000001, -2.0000000000000013], "episode_lengths": [30, 26, 33, 26, 32, 29, 27, 27, 27, 25, 30, 27, 30, 26, 28, 28, 32, 27, 28, 26, 25, 31, 27, 25, 26, 28, 28, 25, 28, 27, 27, 27, 27, 25, 29, 36, 29, 34, 28, 34, 27, 28, 29, 26, 30, 29, 27, 26, 31, 27, 28, 26, 26, 27, 28, 30, 25, 28, 28, 27, 25, 27, 30, 28, 29, 26, 27, 25, 27, 27, 27, 30, 29, 26, 26, 32, 27, 27, 31, 25, 26, 26, 33, 26, 29, 29, 30, 30, 32, 26, 35, 25, 27, 29, 27, 30, 26, 30, 28, 30, 27, 28, 28, 27, 25, 26, 28, 29, 28, 30, 31, 26, 27, 30, 27, 30, 26, 26, 27, 25, 26, 29, 30, 28, 26, 30, 27, 30, 35, 33, 29, 28, 26, 28, 26, 27, 25, 31, 27, 30, 27, 31]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3508988638428518, "mean_inference_ms": 0.7331537082629265, "mean_action_processing_ms": 0.07663428684882244, "mean_env_wait_ms": 7.040505473126602, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006794090002355441, "StateBufferConnector_ms": 0.004045896127190389, "ViewRequirementAgentConnector_ms": 0.09175203215907997}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 180000, "num_agent_steps_trained": 180000, "num_env_steps_sampled": 180000, "num_env_steps_trained": 180000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 478.373870270794, "num_env_steps_trained_throughput_per_sec": 478.373870270794, "timesteps_total": 180000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 180000, "timers": {"training_iteration_time_ms": 8252.922, "sample_time_ms": 4707.558, "load_time_ms": 0.979, "load_throughput": 4087019.732, "learn_time_ms": 3541.022, "learn_throughput": 1129.617, "synch_weights_time_ms": 2.696}, "counters": {"num_env_steps_sampled": 180000, "num_env_steps_trained": 180000, "num_agent_steps_sampled": 180000, "num_agent_steps_trained": 180000}, "done": false, "episodes_total": 3633, "training_iteration": 45, "trial_id": "2154c_00000", "date": "2024-03-07_13-10-23", "timestamp": 1709835023, "time_this_iter_s": 8.364985704421997, "time_total_s": 351.09306502342224, "pid": 116529, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7efea6399f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 351.09306502342224, "iterations_since_restore": 45, "perf": {"cpu_util_percent": 31.299999999999997, "ram_util_percent": 50.72727272727273, "gpu_util_percent0": 0.06454545454545454, "vram_util_percent0": 0.09395714962121211}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.15, "cur_lr": 0.0010000000000000005, "total_loss": 0.03906364524787072, "policy_loss": -0.003977180921262311, "vf_loss": 0.04184211243384628, "vf_explained_var": 0.9658319229079831, "kl": 0.00799142071819299, "entropy": 0.19409561299027936, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 42315.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 184000, "num_env_steps_trained": 184000, "num_agent_steps_sampled": 184000, "num_agent_steps_trained": 184000}, "sampler_results": {"episode_reward_max": -1.4000000000000008, "episode_reward_min": -4.0, "episode_reward_mean": -1.7195804195804205, "episode_len_mean": 28.146853146853147, "episode_media": {}, "episodes_this_iter": 143, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1.600000000000001, -1.5000000000000009, -1.4000000000000008, -1.5000000000000009, -1.600000000000001, -2.4000000000000017, -1.5000000000000009, -1.600000000000001, -2.0000000000000013, -1.5000000000000009, -1.8000000000000012, -1.5000000000000009, -1.600000000000001, -1.600000000000001, -1.700000000000001, -1.5000000000000009, -1.4000000000000008, -1.4000000000000008, -1.600000000000001, -1.8000000000000012, -2.1000000000000014, -1.600000000000001, -1.700000000000001, -1.600000000000001, -1.600000000000001, -1.700000000000001, -1.8000000000000012, -1.700000000000001, -1.9000000000000012, -2.2000000000000015, -1.700000000000001, -1.700000000000001, -1.5000000000000009, -2.0000000000000013, -1.700000000000001, -1.8000000000000012, -2.1000000000000014, -1.700000000000001, -2.0000000000000013, -1.8000000000000012, -1.600000000000001, -1.5000000000000009, -1.700000000000001, -1.4000000000000008, -1.600000000000001, -1.700000000000001, -1.8000000000000012, -2.0000000000000013, -1.9000000000000012, -1.5000000000000009, -1.5000000000000009, -1.9000000000000012, -2.2000000000000015, -1.5000000000000009, -1.700000000000001, -1.8000000000000012, -1.600000000000001, -1.9000000000000012, -2.0000000000000013, -2.0000000000000013, -1.600000000000001, -1.700000000000001, -1.4000000000000008, -1.8000000000000012, -1.9000000000000012, -1.600000000000001, -1.700000000000001, -1.700000000000001, -1.5000000000000009, -1.9000000000000012, -1.9000000000000012, -1.8000000000000012, -1.700000000000001, -1.9000000000000012, -1.600000000000001, -2.4000000000000017, -1.600000000000001, -1.8000000000000012, -1.5000000000000009, -1.5000000000000009, -1.700000000000001, -1.600000000000001, -1.600000000000001, -1.8000000000000012, -2.0000000000000013, -4.0, -1.600000000000001, -1.8000000000000012, -1.5000000000000009, -1.5000000000000009, -1.5000000000000009, -1.600000000000001, -1.700000000000001, -2.600000000000002, -1.700000000000001, -1.700000000000001, -1.600000000000001, -1.8000000000000012, -1.8000000000000012, -1.8000000000000012, -1.600000000000001, -1.600000000000001, -1.600000000000001, -1.600000000000001, -1.5000000000000009, -1.700000000000001, -1.600000000000001, -1.5000000000000009, -1.8000000000000012, -1.8000000000000012, -2.1000000000000014, -1.5000000000000009, -1.8000000000000012, -1.9000000000000012, -1.5000000000000009, -1.5000000000000009, -1.700000000000001, -1.600000000000001, -1.600000000000001, -1.4000000000000008, -1.8000000000000012, -1.5000000000000009, -1.5000000000000009, -1.700000000000001, -2.0000000000000013, -1.5000000000000009, -1.600000000000001, -1.5000000000000009, -1.700000000000001, -2.0000000000000013, -1.600000000000001, -1.8000000000000012, -1.4000000000000008, -2.0000000000000013, -1.9000000000000012, -2.0000000000000013, -1.5000000000000009, -1.5000000000000009, -1.600000000000001, -1.5000000000000009, -1.5000000000000009, -1.9000000000000012, -1.4000000000000008], "episode_lengths": [27, 26, 25, 26, 27, 35, 26, 27, 31, 26, 29, 26, 27, 27, 28, 26, 25, 25, 27, 29, 32, 27, 28, 27, 27, 28, 29, 28, 30, 33, 28, 28, 26, 31, 28, 29, 32, 28, 31, 29, 27, 26, 28, 25, 27, 28, 29, 31, 30, 26, 26, 30, 33, 26, 28, 29, 27, 30, 31, 31, 27, 28, 25, 29, 30, 27, 28, 28, 26, 30, 30, 29, 28, 30, 27, 35, 27, 29, 26, 26, 28, 27, 27, 29, 31, 44, 27, 29, 26, 26, 26, 27, 28, 37, 28, 28, 27, 29, 29, 29, 27, 27, 27, 27, 26, 28, 27, 26, 29, 29, 32, 26, 29, 30, 26, 26, 28, 27, 27, 25, 29, 26, 26, 28, 31, 26, 27, 26, 28, 31, 27, 29, 25, 31, 30, 31, 26, 26, 27, 26, 26, 30, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.35323911818727083, "mean_inference_ms": 0.73321731831424, "mean_action_processing_ms": 0.07664783081008147, "mean_env_wait_ms": 7.058990381388308, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006789927716021771, "StateBufferConnector_ms": 0.00403460922774735, "ViewRequirementAgentConnector_ms": 0.09076411907489483}}, "episode_reward_max": -1.4000000000000008, "episode_reward_min": -4.0, "episode_reward_mean": -1.7195804195804205, "episode_len_mean": 28.146853146853147, "episodes_this_iter": 143, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1.600000000000001, -1.5000000000000009, -1.4000000000000008, -1.5000000000000009, -1.600000000000001, -2.4000000000000017, -1.5000000000000009, -1.600000000000001, -2.0000000000000013, -1.5000000000000009, -1.8000000000000012, -1.5000000000000009, -1.600000000000001, -1.600000000000001, -1.700000000000001, -1.5000000000000009, -1.4000000000000008, -1.4000000000000008, -1.600000000000001, -1.8000000000000012, -2.1000000000000014, -1.600000000000001, -1.700000000000001, -1.600000000000001, -1.600000000000001, -1.700000000000001, -1.8000000000000012, -1.700000000000001, -1.9000000000000012, -2.2000000000000015, -1.700000000000001, -1.700000000000001, -1.5000000000000009, -2.0000000000000013, -1.700000000000001, -1.8000000000000012, -2.1000000000000014, -1.700000000000001, -2.0000000000000013, -1.8000000000000012, -1.600000000000001, -1.5000000000000009, -1.700000000000001, -1.4000000000000008, -1.600000000000001, -1.700000000000001, -1.8000000000000012, -2.0000000000000013, -1.9000000000000012, -1.5000000000000009, -1.5000000000000009, -1.9000000000000012, -2.2000000000000015, -1.5000000000000009, -1.700000000000001, -1.8000000000000012, -1.600000000000001, -1.9000000000000012, -2.0000000000000013, -2.0000000000000013, -1.600000000000001, -1.700000000000001, -1.4000000000000008, -1.8000000000000012, -1.9000000000000012, -1.600000000000001, -1.700000000000001, -1.700000000000001, -1.5000000000000009, -1.9000000000000012, -1.9000000000000012, -1.8000000000000012, -1.700000000000001, -1.9000000000000012, -1.600000000000001, -2.4000000000000017, -1.600000000000001, -1.8000000000000012, -1.5000000000000009, -1.5000000000000009, -1.700000000000001, -1.600000000000001, -1.600000000000001, -1.8000000000000012, -2.0000000000000013, -4.0, -1.600000000000001, -1.8000000000000012, -1.5000000000000009, -1.5000000000000009, -1.5000000000000009, -1.600000000000001, -1.700000000000001, -2.600000000000002, -1.700000000000001, -1.700000000000001, -1.600000000000001, -1.8000000000000012, -1.8000000000000012, -1.8000000000000012, -1.600000000000001, -1.600000000000001, -1.600000000000001, -1.600000000000001, -1.5000000000000009, -1.700000000000001, -1.600000000000001, -1.5000000000000009, -1.8000000000000012, -1.8000000000000012, -2.1000000000000014, -1.5000000000000009, -1.8000000000000012, -1.9000000000000012, -1.5000000000000009, -1.5000000000000009, -1.700000000000001, -1.600000000000001, -1.600000000000001, -1.4000000000000008, -1.8000000000000012, -1.5000000000000009, -1.5000000000000009, -1.700000000000001, -2.0000000000000013, -1.5000000000000009, -1.600000000000001, -1.5000000000000009, -1.700000000000001, -2.0000000000000013, -1.600000000000001, -1.8000000000000012, -1.4000000000000008, -2.0000000000000013, -1.9000000000000012, -2.0000000000000013, -1.5000000000000009, -1.5000000000000009, -1.600000000000001, -1.5000000000000009, -1.5000000000000009, -1.9000000000000012, -1.4000000000000008], "episode_lengths": [27, 26, 25, 26, 27, 35, 26, 27, 31, 26, 29, 26, 27, 27, 28, 26, 25, 25, 27, 29, 32, 27, 28, 27, 27, 28, 29, 28, 30, 33, 28, 28, 26, 31, 28, 29, 32, 28, 31, 29, 27, 26, 28, 25, 27, 28, 29, 31, 30, 26, 26, 30, 33, 26, 28, 29, 27, 30, 31, 31, 27, 28, 25, 29, 30, 27, 28, 28, 26, 30, 30, 29, 28, 30, 27, 35, 27, 29, 26, 26, 28, 27, 27, 29, 31, 44, 27, 29, 26, 26, 26, 27, 28, 37, 28, 28, 27, 29, 29, 29, 27, 27, 27, 27, 26, 28, 27, 26, 29, 29, 32, 26, 29, 30, 26, 26, 28, 27, 27, 25, 29, 26, 26, 28, 31, 26, 27, 26, 28, 31, 27, 29, 25, 31, 30, 31, 26, 26, 27, 26, 26, 30, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.35323911818727083, "mean_inference_ms": 0.73321731831424, "mean_action_processing_ms": 0.07664783081008147, "mean_env_wait_ms": 7.058990381388308, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006789927716021771, "StateBufferConnector_ms": 0.00403460922774735, "ViewRequirementAgentConnector_ms": 0.09076411907489483}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 184000, "num_agent_steps_trained": 184000, "num_env_steps_sampled": 184000, "num_env_steps_trained": 184000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 477.8119348804573, "num_env_steps_trained_throughput_per_sec": 477.8119348804573, "timesteps_total": 184000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 184000, "timers": {"training_iteration_time_ms": 8284.529, "sample_time_ms": 4744.506, "load_time_ms": 0.98, "load_throughput": 4080657.684, "learn_time_ms": 3535.644, "learn_throughput": 1131.336, "synch_weights_time_ms": 2.73}, "counters": {"num_env_steps_sampled": 184000, "num_env_steps_trained": 184000, "num_agent_steps_sampled": 184000, "num_agent_steps_trained": 184000}, "done": false, "episodes_total": 3776, "training_iteration": 46, "trial_id": "2154c_00000", "date": "2024-03-07_13-10-31", "timestamp": 1709835031, "time_this_iter_s": 8.374381065368652, "time_total_s": 359.4674460887909, "pid": 116529, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7efea6399f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 359.4674460887909, "iterations_since_restore": 46, "perf": {"cpu_util_percent": 31.28181818181819, "ram_util_percent": 50.7, "gpu_util_percent0": 0.06727272727272728, "vram_util_percent0": 0.09395714962121214}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.15, "cur_lr": 0.0010000000000000005, "total_loss": 0.1300598112980194, "policy_loss": -0.005316465402082089, "vf_loss": 0.132889519684938, "vf_explained_var": 0.9360811811621471, "kl": 0.016578395695256647, "entropy": 0.17747717081539094, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 43245.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 188000, "num_env_steps_trained": 188000, "num_agent_steps_sampled": 188000, "num_agent_steps_trained": 188000}, "sampler_results": {"episode_reward_max": -1.4000000000000008, "episode_reward_min": -5.900000000000005, "episode_reward_mean": -1.7489361702127673, "episode_len_mean": 28.30496453900709, "episode_media": {}, "episodes_this_iter": 141, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1.5000000000000009, -1.700000000000001, -2.0000000000000013, -1.700000000000001, -1.5000000000000009, -1.700000000000001, -1.8000000000000012, -1.8000000000000012, -1.8000000000000012, -1.8000000000000012, -1.700000000000001, -1.700000000000001, -1.700000000000001, -1.8000000000000012, -1.600000000000001, -1.600000000000001, -1.700000000000001, -1.4000000000000008, -1.600000000000001, -1.4000000000000008, -1.8000000000000012, -1.4000000000000008, -1.5000000000000009, -1.8000000000000012, -1.4000000000000008, -1.5000000000000009, -1.700000000000001, -1.8000000000000012, -1.600000000000001, -1.4000000000000008, -2.3000000000000016, -1.700000000000001, -1.8000000000000012, -1.8000000000000012, -1.700000000000001, -1.5000000000000009, -1.600000000000001, -1.600000000000001, -2.3000000000000016, -1.9000000000000012, -2.0000000000000013, -1.4000000000000008, -1.9000000000000012, -1.9000000000000012, -1.700000000000001, -1.9000000000000012, -1.700000000000001, -1.5000000000000009, -5.900000000000005, -1.5000000000000009, -1.700000000000001, -1.600000000000001, -1.600000000000001, -1.5000000000000009, -1.700000000000001, -4.699999999999996, -1.700000000000001, -1.700000000000001, -1.4000000000000008, -1.5000000000000009, -1.700000000000001, -2.0000000000000013, -1.9000000000000012, -1.8000000000000012, -1.700000000000001, -1.4000000000000008, -1.700000000000001, -1.600000000000001, -1.700000000000001, -1.5000000000000009, -2.0000000000000013, -1.4000000000000008, -1.700000000000001, -2.1000000000000014, -1.5000000000000009, -1.4000000000000008, -1.8000000000000012, -1.5000000000000009, -1.8000000000000012, -1.5000000000000009, -1.4000000000000008, -1.600000000000001, -1.700000000000001, -2.3000000000000016, -1.8000000000000012, -1.5000000000000009, -1.9000000000000012, -1.5000000000000009, -2.1000000000000014, -1.4000000000000008, -1.8000000000000012, -2.3000000000000016, -1.8000000000000012, -1.600000000000001, -1.5000000000000009, -1.5000000000000009, -1.700000000000001, -1.8000000000000012, -1.5000000000000009, -1.700000000000001, -1.8000000000000012, -1.8000000000000012, -2.600000000000002, -1.600000000000001, -1.700000000000001, -1.700000000000001, -1.9000000000000012, -1.600000000000001, -1.600000000000001, -1.4000000000000008, -1.5000000000000009, -1.600000000000001, -1.5000000000000009, -1.700000000000001, -2.1000000000000014, -1.700000000000001, -2.1000000000000014, -1.700000000000001, -1.600000000000001, -1.700000000000001, -1.600000000000001, -1.600000000000001, -1.600000000000001, -1.700000000000001, -1.700000000000001, -1.9000000000000012, -1.8000000000000012, -1.9000000000000012, -1.8000000000000012, -1.600000000000001, -1.600000000000001, -1.9000000000000012, -1.5000000000000009, -1.700000000000001, -1.700000000000001, -1.5000000000000009, -1.5000000000000009, -1.5000000000000009, -1.5000000000000009, -2.1000000000000014, -1.8000000000000012], "episode_lengths": [26, 28, 31, 28, 26, 28, 29, 29, 29, 29, 28, 28, 28, 29, 27, 27, 28, 25, 27, 25, 29, 25, 26, 29, 25, 26, 28, 29, 27, 25, 34, 28, 29, 29, 28, 26, 27, 27, 34, 30, 31, 25, 30, 30, 28, 30, 28, 26, 49, 26, 28, 27, 27, 26, 28, 54, 28, 28, 25, 26, 28, 31, 30, 29, 28, 25, 28, 27, 28, 26, 31, 25, 28, 32, 26, 25, 29, 26, 29, 26, 25, 27, 28, 34, 29, 26, 30, 26, 32, 25, 29, 34, 29, 27, 26, 26, 28, 29, 26, 28, 29, 29, 37, 27, 28, 28, 30, 27, 27, 25, 26, 27, 26, 28, 31, 28, 32, 28, 27, 28, 27, 27, 27, 28, 28, 30, 29, 30, 29, 27, 27, 30, 26, 28, 28, 26, 26, 26, 26, 32, 29]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.35528008909194303, "mean_inference_ms": 0.7331258040522539, "mean_action_processing_ms": 0.07661702993239317, "mean_env_wait_ms": 7.0721295310393275, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006862227798353696, "StateBufferConnector_ms": 0.00400002121079898, "ViewRequirementAgentConnector_ms": 0.091392605017263}}, "episode_reward_max": -1.4000000000000008, "episode_reward_min": -5.900000000000005, "episode_reward_mean": -1.7489361702127673, "episode_len_mean": 28.30496453900709, "episodes_this_iter": 141, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1.5000000000000009, -1.700000000000001, -2.0000000000000013, -1.700000000000001, -1.5000000000000009, -1.700000000000001, -1.8000000000000012, -1.8000000000000012, -1.8000000000000012, -1.8000000000000012, -1.700000000000001, -1.700000000000001, -1.700000000000001, -1.8000000000000012, -1.600000000000001, -1.600000000000001, -1.700000000000001, -1.4000000000000008, -1.600000000000001, -1.4000000000000008, -1.8000000000000012, -1.4000000000000008, -1.5000000000000009, -1.8000000000000012, -1.4000000000000008, -1.5000000000000009, -1.700000000000001, -1.8000000000000012, -1.600000000000001, -1.4000000000000008, -2.3000000000000016, -1.700000000000001, -1.8000000000000012, -1.8000000000000012, -1.700000000000001, -1.5000000000000009, -1.600000000000001, -1.600000000000001, -2.3000000000000016, -1.9000000000000012, -2.0000000000000013, -1.4000000000000008, -1.9000000000000012, -1.9000000000000012, -1.700000000000001, -1.9000000000000012, -1.700000000000001, -1.5000000000000009, -5.900000000000005, -1.5000000000000009, -1.700000000000001, -1.600000000000001, -1.600000000000001, -1.5000000000000009, -1.700000000000001, -4.699999999999996, -1.700000000000001, -1.700000000000001, -1.4000000000000008, -1.5000000000000009, -1.700000000000001, -2.0000000000000013, -1.9000000000000012, -1.8000000000000012, -1.700000000000001, -1.4000000000000008, -1.700000000000001, -1.600000000000001, -1.700000000000001, -1.5000000000000009, -2.0000000000000013, -1.4000000000000008, -1.700000000000001, -2.1000000000000014, -1.5000000000000009, -1.4000000000000008, -1.8000000000000012, -1.5000000000000009, -1.8000000000000012, -1.5000000000000009, -1.4000000000000008, -1.600000000000001, -1.700000000000001, -2.3000000000000016, -1.8000000000000012, -1.5000000000000009, -1.9000000000000012, -1.5000000000000009, -2.1000000000000014, -1.4000000000000008, -1.8000000000000012, -2.3000000000000016, -1.8000000000000012, -1.600000000000001, -1.5000000000000009, -1.5000000000000009, -1.700000000000001, -1.8000000000000012, -1.5000000000000009, -1.700000000000001, -1.8000000000000012, -1.8000000000000012, -2.600000000000002, -1.600000000000001, -1.700000000000001, -1.700000000000001, -1.9000000000000012, -1.600000000000001, -1.600000000000001, -1.4000000000000008, -1.5000000000000009, -1.600000000000001, -1.5000000000000009, -1.700000000000001, -2.1000000000000014, -1.700000000000001, -2.1000000000000014, -1.700000000000001, -1.600000000000001, -1.700000000000001, -1.600000000000001, -1.600000000000001, -1.600000000000001, -1.700000000000001, -1.700000000000001, -1.9000000000000012, -1.8000000000000012, -1.9000000000000012, -1.8000000000000012, -1.600000000000001, -1.600000000000001, -1.9000000000000012, -1.5000000000000009, -1.700000000000001, -1.700000000000001, -1.5000000000000009, -1.5000000000000009, -1.5000000000000009, -1.5000000000000009, -2.1000000000000014, -1.8000000000000012], "episode_lengths": [26, 28, 31, 28, 26, 28, 29, 29, 29, 29, 28, 28, 28, 29, 27, 27, 28, 25, 27, 25, 29, 25, 26, 29, 25, 26, 28, 29, 27, 25, 34, 28, 29, 29, 28, 26, 27, 27, 34, 30, 31, 25, 30, 30, 28, 30, 28, 26, 49, 26, 28, 27, 27, 26, 28, 54, 28, 28, 25, 26, 28, 31, 30, 29, 28, 25, 28, 27, 28, 26, 31, 25, 28, 32, 26, 25, 29, 26, 29, 26, 25, 27, 28, 34, 29, 26, 30, 26, 32, 25, 29, 34, 29, 27, 26, 26, 28, 29, 26, 28, 29, 29, 37, 27, 28, 28, 30, 27, 27, 25, 26, 27, 26, 28, 31, 28, 32, 28, 27, 28, 27, 27, 27, 28, 28, 30, 29, 30, 29, 27, 27, 30, 26, 28, 28, 26, 26, 26, 26, 32, 29]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.35528008909194303, "mean_inference_ms": 0.7331258040522539, "mean_action_processing_ms": 0.07661702993239317, "mean_env_wait_ms": 7.0721295310393275, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006862227798353696, "StateBufferConnector_ms": 0.00400002121079898, "ViewRequirementAgentConnector_ms": 0.091392605017263}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 188000, "num_agent_steps_trained": 188000, "num_env_steps_sampled": 188000, "num_env_steps_trained": 188000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 497.364597440762, "num_env_steps_trained_throughput_per_sec": 497.364597440762, "timesteps_total": 188000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 188000, "timers": {"training_iteration_time_ms": 8272.525, "sample_time_ms": 4748.699, "load_time_ms": 0.973, "load_throughput": 4109142.031, "learn_time_ms": 3519.463, "learn_throughput": 1136.537, "synch_weights_time_ms": 2.715}, "counters": {"num_env_steps_sampled": 188000, "num_env_steps_trained": 188000, "num_agent_steps_sampled": 188000, "num_agent_steps_trained": 188000}, "done": false, "episodes_total": 3917, "training_iteration": 47, "trial_id": "2154c_00000", "date": "2024-03-07_13-10-39", "timestamp": 1709835039, "time_this_iter_s": 8.045613527297974, "time_total_s": 367.51305961608887, "pid": 116529, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7efea6399f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 367.51305961608887, "iterations_since_restore": 47, "perf": {"cpu_util_percent": 32.7, "ram_util_percent": 50.7, "gpu_util_percent0": 0.07400000000000001, "vram_util_percent0": 0.09393717447916668}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.15, "cur_lr": 0.0010000000000000005, "total_loss": 0.2553524733470973, "policy_loss": -0.008766704445244163, "vf_loss": 0.26178994754063944, "vf_explained_var": 0.884974847237269, "kl": 0.015528200521430214, "entropy": 0.18391785170602543, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 44175.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 192000, "num_env_steps_trained": 192000, "num_agent_steps_sampled": 192000, "num_agent_steps_trained": 192000}, "sampler_results": {"episode_reward_max": -1.4000000000000008, "episode_reward_min": -10.699999999999985, "episode_reward_mean": -1.7638297872340434, "episode_len_mean": 28.354609929078013, "episode_media": {}, "episodes_this_iter": 141, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1.4000000000000008, -1.600000000000001, -1.9000000000000012, -2.0000000000000013, -1.8000000000000012, -10.699999999999985, -1.9000000000000012, -1.4000000000000008, -1.4000000000000008, -2.0000000000000013, -1.5000000000000009, -1.8000000000000012, -1.700000000000001, -1.600000000000001, -1.700000000000001, -1.5000000000000009, -1.700000000000001, -1.700000000000001, -1.700000000000001, -1.600000000000001, -1.600000000000001, -2.0000000000000013, -3.5999999999999996, -1.600000000000001, -1.4000000000000008, -1.600000000000001, -1.4000000000000008, -1.700000000000001, -1.4000000000000008, -6.599999999999989, -1.600000000000001, -1.4000000000000008, -1.5000000000000009, -1.700000000000001, -1.700000000000001, -1.4000000000000008, -1.600000000000001, -1.4000000000000008, -1.5000000000000009, -1.600000000000001, -1.5000000000000009, -2.4000000000000017, -1.9000000000000012, -1.5000000000000009, -1.9000000000000012, -1.5000000000000009, -1.4000000000000008, -1.9000000000000012, -1.5000000000000009, -1.700000000000001, -1.9000000000000012, -1.600000000000001, -1.600000000000001, -1.5000000000000009, -1.700000000000001, -1.5000000000000009, -1.5000000000000009, -1.5000000000000009, -2.1000000000000014, -1.700000000000001, -1.700000000000001, -1.5000000000000009, -2.2000000000000015, -1.5000000000000009, -1.4000000000000008, -1.5000000000000009, -1.4000000000000008, -2.0000000000000013, -1.600000000000001, -2.4000000000000017, -1.5000000000000009, -1.5000000000000009, -2.2000000000000015, -1.4000000000000008, -1.5000000000000009, -1.9000000000000012, -1.4000000000000008, -1.9000000000000012, -1.4000000000000008, -2.0000000000000013, -1.600000000000001, -1.5000000000000009, -2.2000000000000015, -1.700000000000001, -1.5000000000000009, -1.700000000000001, -2.0000000000000013, -1.5000000000000009, -1.700000000000001, -1.600000000000001, -1.5000000000000009, -1.5000000000000009, -1.4000000000000008, -1.600000000000001, -1.5000000000000009, -1.700000000000001, -1.700000000000001, -1.8000000000000012, -1.5000000000000009, -1.700000000000001, -1.9000000000000012, -1.5000000000000009, -1.600000000000001, -1.600000000000001, -1.600000000000001, -1.600000000000001, -2.1000000000000014, -1.4000000000000008, -1.700000000000001, -1.9000000000000012, -1.5000000000000009, -1.8000000000000012, -1.4000000000000008, -1.600000000000001, -1.5000000000000009, -1.700000000000001, -1.700000000000001, -1.600000000000001, -1.8000000000000012, -1.600000000000001, -1.4000000000000008, -1.5000000000000009, -1.600000000000001, -1.9000000000000012, -1.4000000000000008, -1.600000000000001, -1.600000000000001, -1.5000000000000009, -1.600000000000001, -2.0000000000000013, -1.600000000000001, -1.700000000000001, -1.5000000000000009, -1.600000000000001, -1.600000000000001, -1.700000000000001, -1.5000000000000009, -1.9000000000000012, -1.600000000000001, -1.9000000000000012, -1.4000000000000008], "episode_lengths": [25, 27, 30, 31, 29, 85, 30, 25, 25, 31, 26, 29, 28, 27, 28, 26, 28, 28, 28, 27, 27, 31, 44, 27, 25, 27, 25, 28, 25, 76, 27, 25, 26, 28, 28, 25, 27, 25, 26, 27, 26, 32, 30, 26, 30, 26, 25, 30, 26, 28, 30, 27, 27, 26, 28, 26, 26, 26, 32, 28, 28, 26, 33, 26, 25, 26, 25, 31, 27, 35, 26, 26, 33, 25, 26, 30, 25, 30, 25, 31, 27, 26, 33, 28, 26, 28, 31, 26, 28, 27, 26, 26, 25, 27, 26, 28, 28, 29, 26, 28, 30, 26, 27, 27, 27, 27, 32, 25, 28, 30, 26, 29, 25, 27, 26, 28, 28, 27, 29, 27, 25, 26, 27, 30, 25, 27, 27, 26, 27, 31, 27, 28, 26, 27, 27, 28, 26, 30, 27, 30, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3572667371840637, "mean_inference_ms": 0.7329122377626298, "mean_action_processing_ms": 0.07662030603525573, "mean_env_wait_ms": 7.084142495015012, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0068216459125491746, "StateBufferConnector_ms": 0.003973812076216894, "ViewRequirementAgentConnector_ms": 0.0911754919282088}}, "episode_reward_max": -1.4000000000000008, "episode_reward_min": -10.699999999999985, "episode_reward_mean": -1.7638297872340434, "episode_len_mean": 28.354609929078013, "episodes_this_iter": 141, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1.4000000000000008, -1.600000000000001, -1.9000000000000012, -2.0000000000000013, -1.8000000000000012, -10.699999999999985, -1.9000000000000012, -1.4000000000000008, -1.4000000000000008, -2.0000000000000013, -1.5000000000000009, -1.8000000000000012, -1.700000000000001, -1.600000000000001, -1.700000000000001, -1.5000000000000009, -1.700000000000001, -1.700000000000001, -1.700000000000001, -1.600000000000001, -1.600000000000001, -2.0000000000000013, -3.5999999999999996, -1.600000000000001, -1.4000000000000008, -1.600000000000001, -1.4000000000000008, -1.700000000000001, -1.4000000000000008, -6.599999999999989, -1.600000000000001, -1.4000000000000008, -1.5000000000000009, -1.700000000000001, -1.700000000000001, -1.4000000000000008, -1.600000000000001, -1.4000000000000008, -1.5000000000000009, -1.600000000000001, -1.5000000000000009, -2.4000000000000017, -1.9000000000000012, -1.5000000000000009, -1.9000000000000012, -1.5000000000000009, -1.4000000000000008, -1.9000000000000012, -1.5000000000000009, -1.700000000000001, -1.9000000000000012, -1.600000000000001, -1.600000000000001, -1.5000000000000009, -1.700000000000001, -1.5000000000000009, -1.5000000000000009, -1.5000000000000009, -2.1000000000000014, -1.700000000000001, -1.700000000000001, -1.5000000000000009, -2.2000000000000015, -1.5000000000000009, -1.4000000000000008, -1.5000000000000009, -1.4000000000000008, -2.0000000000000013, -1.600000000000001, -2.4000000000000017, -1.5000000000000009, -1.5000000000000009, -2.2000000000000015, -1.4000000000000008, -1.5000000000000009, -1.9000000000000012, -1.4000000000000008, -1.9000000000000012, -1.4000000000000008, -2.0000000000000013, -1.600000000000001, -1.5000000000000009, -2.2000000000000015, -1.700000000000001, -1.5000000000000009, -1.700000000000001, -2.0000000000000013, -1.5000000000000009, -1.700000000000001, -1.600000000000001, -1.5000000000000009, -1.5000000000000009, -1.4000000000000008, -1.600000000000001, -1.5000000000000009, -1.700000000000001, -1.700000000000001, -1.8000000000000012, -1.5000000000000009, -1.700000000000001, -1.9000000000000012, -1.5000000000000009, -1.600000000000001, -1.600000000000001, -1.600000000000001, -1.600000000000001, -2.1000000000000014, -1.4000000000000008, -1.700000000000001, -1.9000000000000012, -1.5000000000000009, -1.8000000000000012, -1.4000000000000008, -1.600000000000001, -1.5000000000000009, -1.700000000000001, -1.700000000000001, -1.600000000000001, -1.8000000000000012, -1.600000000000001, -1.4000000000000008, -1.5000000000000009, -1.600000000000001, -1.9000000000000012, -1.4000000000000008, -1.600000000000001, -1.600000000000001, -1.5000000000000009, -1.600000000000001, -2.0000000000000013, -1.600000000000001, -1.700000000000001, -1.5000000000000009, -1.600000000000001, -1.600000000000001, -1.700000000000001, -1.5000000000000009, -1.9000000000000012, -1.600000000000001, -1.9000000000000012, -1.4000000000000008], "episode_lengths": [25, 27, 30, 31, 29, 85, 30, 25, 25, 31, 26, 29, 28, 27, 28, 26, 28, 28, 28, 27, 27, 31, 44, 27, 25, 27, 25, 28, 25, 76, 27, 25, 26, 28, 28, 25, 27, 25, 26, 27, 26, 32, 30, 26, 30, 26, 25, 30, 26, 28, 30, 27, 27, 26, 28, 26, 26, 26, 32, 28, 28, 26, 33, 26, 25, 26, 25, 31, 27, 35, 26, 26, 33, 25, 26, 30, 25, 30, 25, 31, 27, 26, 33, 28, 26, 28, 31, 26, 28, 27, 26, 26, 25, 27, 26, 28, 28, 29, 26, 28, 30, 26, 27, 27, 27, 27, 32, 25, 28, 30, 26, 29, 25, 27, 26, 28, 28, 27, 29, 27, 25, 26, 27, 30, 25, 27, 27, 26, 27, 31, 27, 28, 26, 27, 27, 28, 26, 30, 27, 30, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3572667371840637, "mean_inference_ms": 0.7329122377626298, "mean_action_processing_ms": 0.07662030603525573, "mean_env_wait_ms": 7.084142495015012, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0068216459125491746, "StateBufferConnector_ms": 0.003973812076216894, "ViewRequirementAgentConnector_ms": 0.0911754919282088}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 192000, "num_agent_steps_trained": 192000, "num_env_steps_sampled": 192000, "num_env_steps_trained": 192000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 484.48818858300393, "num_env_steps_trained_throughput_per_sec": 484.48818858300393, "timesteps_total": 192000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 192000, "timers": {"training_iteration_time_ms": 8291.909, "sample_time_ms": 4769.818, "load_time_ms": 0.966, "load_throughput": 4141295.419, "learn_time_ms": 3517.787, "learn_throughput": 1137.078, "synch_weights_time_ms": 2.668}, "counters": {"num_env_steps_sampled": 192000, "num_env_steps_trained": 192000, "num_agent_steps_sampled": 192000, "num_agent_steps_trained": 192000}, "done": false, "episodes_total": 4058, "training_iteration": 48, "trial_id": "2154c_00000", "date": "2024-03-07_13-10-48", "timestamp": 1709835048, "time_this_iter_s": 8.259278774261475, "time_total_s": 375.77233839035034, "pid": 116529, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7efea6399f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 375.77233839035034, "iterations_since_restore": 48, "perf": {"cpu_util_percent": 31.91818181818182, "ram_util_percent": 50.75454545454545, "gpu_util_percent0": 0.08636363636363636, "vram_util_percent0": 0.09394235321969696}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.15, "cur_lr": 0.0010000000000000005, "total_loss": 1.2011175710327362, "policy_loss": -0.013954345273074284, "vf_loss": 1.2117834478897114, "vf_explained_var": 0.6704830729192303, "kl": 0.021923137347655074, "entropy": 0.24918907869567153, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 45105.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 196000, "num_env_steps_trained": 196000, "num_agent_steps_sampled": 196000, "num_agent_steps_trained": 196000}, "sampler_results": {"episode_reward_max": -1.4000000000000008, "episode_reward_min": -17.899999999999974, "episode_reward_mean": -1.991129032258065, "episode_len_mean": 29.846774193548388, "episode_media": {}, "episodes_this_iter": 124, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1.5000000000000009, -1.700000000000001, -1.700000000000001, -1.8000000000000012, -1.4000000000000008, -1.8000000000000012, -1.8000000000000012, -1.700000000000001, -1.700000000000001, -2.3000000000000016, -1.8000000000000012, -1.9000000000000012, -1.600000000000001, -1.700000000000001, -1.9000000000000012, -1.700000000000001, -1.5000000000000009, -1.4000000000000008, -1.4000000000000008, -1.5000000000000009, -1.600000000000001, -1.9000000000000012, -1.600000000000001, -4.000000000000001, -1.600000000000001, -2.1000000000000014, -1.600000000000001, -1.600000000000001, -1.4000000000000008, -6.0, -1.600000000000001, -2.0000000000000013, -2.1000000000000014, -1.4000000000000008, -17.899999999999974, -3.3000000000000007, -1.9000000000000012, -1.5000000000000009, -1.4000000000000008, -1.5000000000000009, -1.700000000000001, -1.600000000000001, -1.700000000000001, -2.600000000000002, -1.5000000000000009, -1.5000000000000009, -1.700000000000001, -1.5000000000000009, -1.5000000000000009, -1.700000000000001, -1.600000000000001, -1.600000000000001, -1.700000000000001, -1.9000000000000012, -1.9000000000000012, -1.700000000000001, -1.9000000000000012, -1.4000000000000008, -1.8000000000000012, -2.1000000000000014, -1.700000000000001, -2.0000000000000013, -1.5000000000000009, -1.600000000000001, -1.600000000000001, -1.700000000000001, -1.5000000000000009, -1.700000000000001, -1.600000000000001, -2.0000000000000013, -1.600000000000001, -1.9000000000000012, -2.0000000000000013, -12.099999999999985, -1.600000000000001, -1.600000000000001, -1.8000000000000012, -2.2000000000000015, -1.5000000000000009, -1.600000000000001, -1.5000000000000009, -1.4000000000000008, -1.5000000000000009, -1.8000000000000012, -1.600000000000001, -2.0000000000000013, -2.0000000000000013, -1.5000000000000009, -1.600000000000001, -1.4000000000000008, -1.700000000000001, -1.8000000000000012, -1.9000000000000012, -1.600000000000001, -1.600000000000001, -1.8000000000000012, -1.5000000000000009, -1.700000000000001, -1.5000000000000009, -1.600000000000001, -1.600000000000001, -1.8000000000000012, -1.5000000000000009, -1.700000000000001, -1.700000000000001, -1.8000000000000012, -1.8000000000000012, -1.4000000000000008, -2.0000000000000013, -1.8000000000000012, -1.700000000000001, -1.600000000000001, -1.4000000000000008, -1.9000000000000012, -2.5000000000000018, -1.4000000000000008, -1.8000000000000012, -1.5000000000000009, -2.3000000000000016, -1.8000000000000012, -2.700000000000002, -1.700000000000001, -1.600000000000001, -1.700000000000001], "episode_lengths": [26, 28, 28, 29, 25, 29, 29, 28, 28, 34, 29, 30, 27, 28, 30, 28, 26, 25, 25, 26, 27, 30, 27, 41, 27, 32, 27, 27, 25, 59, 27, 31, 32, 25, 127, 44, 30, 26, 25, 26, 28, 27, 28, 32, 26, 26, 28, 26, 26, 28, 27, 27, 28, 30, 30, 28, 30, 25, 29, 32, 28, 31, 26, 27, 27, 28, 26, 28, 27, 31, 27, 30, 31, 93, 27, 27, 29, 33, 26, 27, 26, 25, 26, 29, 27, 31, 31, 26, 27, 25, 28, 29, 30, 27, 27, 29, 26, 28, 26, 27, 27, 29, 26, 28, 28, 29, 29, 25, 31, 29, 28, 27, 25, 30, 36, 25, 29, 26, 34, 29, 35, 28, 27, 28]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.35849149960377463, "mean_inference_ms": 0.7332533471247326, "mean_action_processing_ms": 0.07664420612801355, "mean_env_wait_ms": 7.0982568128536725, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006776279018771264, "StateBufferConnector_ms": 0.0040025480331913115, "ViewRequirementAgentConnector_ms": 0.09067289290889617}}, "episode_reward_max": -1.4000000000000008, "episode_reward_min": -17.899999999999974, "episode_reward_mean": -1.991129032258065, "episode_len_mean": 29.846774193548388, "episodes_this_iter": 124, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1.5000000000000009, -1.700000000000001, -1.700000000000001, -1.8000000000000012, -1.4000000000000008, -1.8000000000000012, -1.8000000000000012, -1.700000000000001, -1.700000000000001, -2.3000000000000016, -1.8000000000000012, -1.9000000000000012, -1.600000000000001, -1.700000000000001, -1.9000000000000012, -1.700000000000001, -1.5000000000000009, -1.4000000000000008, -1.4000000000000008, -1.5000000000000009, -1.600000000000001, -1.9000000000000012, -1.600000000000001, -4.000000000000001, -1.600000000000001, -2.1000000000000014, -1.600000000000001, -1.600000000000001, -1.4000000000000008, -6.0, -1.600000000000001, -2.0000000000000013, -2.1000000000000014, -1.4000000000000008, -17.899999999999974, -3.3000000000000007, -1.9000000000000012, -1.5000000000000009, -1.4000000000000008, -1.5000000000000009, -1.700000000000001, -1.600000000000001, -1.700000000000001, -2.600000000000002, -1.5000000000000009, -1.5000000000000009, -1.700000000000001, -1.5000000000000009, -1.5000000000000009, -1.700000000000001, -1.600000000000001, -1.600000000000001, -1.700000000000001, -1.9000000000000012, -1.9000000000000012, -1.700000000000001, -1.9000000000000012, -1.4000000000000008, -1.8000000000000012, -2.1000000000000014, -1.700000000000001, -2.0000000000000013, -1.5000000000000009, -1.600000000000001, -1.600000000000001, -1.700000000000001, -1.5000000000000009, -1.700000000000001, -1.600000000000001, -2.0000000000000013, -1.600000000000001, -1.9000000000000012, -2.0000000000000013, -12.099999999999985, -1.600000000000001, -1.600000000000001, -1.8000000000000012, -2.2000000000000015, -1.5000000000000009, -1.600000000000001, -1.5000000000000009, -1.4000000000000008, -1.5000000000000009, -1.8000000000000012, -1.600000000000001, -2.0000000000000013, -2.0000000000000013, -1.5000000000000009, -1.600000000000001, -1.4000000000000008, -1.700000000000001, -1.8000000000000012, -1.9000000000000012, -1.600000000000001, -1.600000000000001, -1.8000000000000012, -1.5000000000000009, -1.700000000000001, -1.5000000000000009, -1.600000000000001, -1.600000000000001, -1.8000000000000012, -1.5000000000000009, -1.700000000000001, -1.700000000000001, -1.8000000000000012, -1.8000000000000012, -1.4000000000000008, -2.0000000000000013, -1.8000000000000012, -1.700000000000001, -1.600000000000001, -1.4000000000000008, -1.9000000000000012, -2.5000000000000018, -1.4000000000000008, -1.8000000000000012, -1.5000000000000009, -2.3000000000000016, -1.8000000000000012, -2.700000000000002, -1.700000000000001, -1.600000000000001, -1.700000000000001], "episode_lengths": [26, 28, 28, 29, 25, 29, 29, 28, 28, 34, 29, 30, 27, 28, 30, 28, 26, 25, 25, 26, 27, 30, 27, 41, 27, 32, 27, 27, 25, 59, 27, 31, 32, 25, 127, 44, 30, 26, 25, 26, 28, 27, 28, 32, 26, 26, 28, 26, 26, 28, 27, 27, 28, 30, 30, 28, 30, 25, 29, 32, 28, 31, 26, 27, 27, 28, 26, 28, 27, 31, 27, 30, 31, 93, 27, 27, 29, 33, 26, 27, 26, 25, 26, 29, 27, 31, 31, 26, 27, 25, 28, 29, 30, 27, 27, 29, 26, 28, 26, 27, 27, 29, 26, 28, 28, 29, 29, 25, 31, 29, 28, 27, 25, 30, 36, 25, 29, 26, 34, 29, 35, 28, 27, 28]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.35849149960377463, "mean_inference_ms": 0.7332533471247326, "mean_action_processing_ms": 0.07664420612801355, "mean_env_wait_ms": 7.0982568128536725, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006776279018771264, "StateBufferConnector_ms": 0.0040025480331913115, "ViewRequirementAgentConnector_ms": 0.09067289290889617}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 196000, "num_agent_steps_trained": 196000, "num_env_steps_sampled": 196000, "num_env_steps_trained": 196000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 492.4764961228359, "num_env_steps_trained_throughput_per_sec": 492.4764961228359, "timesteps_total": 196000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 196000, "timers": {"training_iteration_time_ms": 8302.144, "sample_time_ms": 4777.164, "load_time_ms": 0.971, "load_throughput": 4121355.999, "learn_time_ms": 3520.713, "learn_throughput": 1136.133, "synch_weights_time_ms": 2.633}, "counters": {"num_env_steps_sampled": 196000, "num_env_steps_trained": 196000, "num_agent_steps_sampled": 196000, "num_agent_steps_trained": 196000}, "done": false, "episodes_total": 4182, "training_iteration": 49, "trial_id": "2154c_00000", "date": "2024-03-07_13-10-56", "timestamp": 1709835056, "time_this_iter_s": 8.125262260437012, "time_total_s": 383.89760065078735, "pid": 116529, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7efea6399f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 383.89760065078735, "iterations_since_restore": 49, "perf": {"cpu_util_percent": 30.7, "ram_util_percent": 50.7, "gpu_util_percent0": 0.08272727272727275, "vram_util_percent0": 0.09394975142045454}}
{"evaluation": {"sampler_results": {"episode_reward_max": -1.4000000000000008, "episode_reward_min": -2.2000000000000015, "episode_reward_mean": -1.7400000000000013, "episode_len_mean": 28.4, "episode_media": {}, "episodes_this_iter": 20, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1.8000000000000012, -2.2000000000000015, -1.8000000000000012, -1.8000000000000012, -2.2000000000000015, -1.700000000000001, -1.8000000000000012, -1.9000000000000012, -1.8000000000000012, -2.1000000000000014, -1.700000000000001, -1.600000000000001, -1.5000000000000009, -1.600000000000001, -1.600000000000001, -1.600000000000001, -1.600000000000001, -1.4000000000000008, -1.5000000000000009, -1.600000000000001], "episode_lengths": [29, 33, 29, 29, 33, 28, 29, 30, 29, 32, 28, 27, 26, 27, 27, 27, 27, 25, 26, 27]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3731141819476243, "mean_inference_ms": 1.051245758110274, "mean_action_processing_ms": 0.06511173684064867, "mean_env_wait_ms": 7.077054943895926, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036513805389404297, "StateBufferConnector_ms": 0.0031995773315429688, "ViewRequirementAgentConnector_ms": 0.06354212760925293}}, "episode_reward_max": -1.4000000000000008, "episode_reward_min": -2.2000000000000015, "episode_reward_mean": -1.7400000000000013, "episode_len_mean": 28.4, "episode_media": {}, "episodes_this_iter": 20, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1.8000000000000012, -2.2000000000000015, -1.8000000000000012, -1.8000000000000012, -2.2000000000000015, -1.700000000000001, -1.8000000000000012, -1.9000000000000012, -1.8000000000000012, -2.1000000000000014, -1.700000000000001, -1.600000000000001, -1.5000000000000009, -1.600000000000001, -1.600000000000001, -1.600000000000001, -1.600000000000001, -1.4000000000000008, -1.5000000000000009, -1.600000000000001], "episode_lengths": [29, 33, 29, 29, 33, 28, 29, 30, 29, 32, 28, 27, 26, 27, 27, 27, 27, 25, 26, 27]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3731141819476243, "mean_inference_ms": 1.051245758110274, "mean_action_processing_ms": 0.06511173684064867, "mean_env_wait_ms": 7.077054943895926, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036513805389404297, "StateBufferConnector_ms": 0.0031995773315429688, "ViewRequirementAgentConnector_ms": 0.06354212760925293}, "num_agent_steps_sampled_this_iter": 568, "num_env_steps_sampled_this_iter": 568, "timesteps_this_iter": 568, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.22500000000000006, "cur_lr": 0.0010000000000000005, "total_loss": 1.0048781986077946, "policy_loss": -0.004142827442496695, "vf_loss": 1.0057446097599603, "vf_explained_var": 0.6624890577408575, "kl": 0.014561845075276273, "entropy": 0.2391445733406531, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 46035.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 200000, "num_env_steps_trained": 200000, "num_agent_steps_sampled": 200000, "num_agent_steps_trained": 200000}, "sampler_results": {"episode_reward_max": -1.4000000000000008, "episode_reward_min": -47.80000000000039, "episode_reward_mean": -2.3828125000000036, "episode_len_mean": 33.4453125, "episode_media": {}, "episodes_this_iter": 128, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1.4000000000000008, -2.1000000000000014, -1.700000000000001, -1.5000000000000009, -1.4000000000000008, -12.899999999999984, -1.8000000000000012, -1.600000000000001, -1.700000000000001, -2.1000000000000014, -1.600000000000001, -2.0000000000000013, -1.600000000000001, -1.700000000000001, -1.8000000000000012, -2.0000000000000013, -1.8000000000000012, -1.700000000000001, -1.8000000000000012, -1.5000000000000009, -1.8000000000000012, -2.0000000000000013, -1.700000000000001, -1.600000000000001, -1.5000000000000009, -5.400000000000004, -1.9000000000000012, -1.5000000000000009, -2.1000000000000014, -1.600000000000001, -1.700000000000001, -1.600000000000001, -1.600000000000001, -1.600000000000001, -1.600000000000001, -1.700000000000001, -1.600000000000001, -18.500000000000007, -1.600000000000001, -1.5000000000000009, -1.5000000000000009, -1.4000000000000008, -1.700000000000001, -1.4000000000000008, -1.600000000000001, -6.899999999999995, -1.700000000000001, -1.5000000000000009, -1.5000000000000009, -1.600000000000001, -1.700000000000001, -2.1000000000000014, -1.9000000000000012, -2.2000000000000015, -1.600000000000001, -1.5000000000000009, -11.89999999999997, -1.5000000000000009, -1.4000000000000008, -2.0000000000000013, -1.9000000000000012, -1.5000000000000009, -1.4000000000000008, -1.700000000000001, -1.700000000000001, -1.600000000000001, -1.5000000000000009, -1.600000000000001, -1.5000000000000009, -1.4000000000000008, -1.5000000000000009, -1.600000000000001, -1.600000000000001, -1.5000000000000009, -1.700000000000001, -1.8000000000000012, -1.700000000000001, -1.4000000000000008, -1.5000000000000009, -1.700000000000001, -1.5000000000000009, -1.600000000000001, -1.5000000000000009, -1.600000000000001, -1.8000000000000012, -1.600000000000001, -1.600000000000001, -1.5000000000000009, -1.700000000000001, -1.5000000000000009, -1.700000000000001, -1.9000000000000012, -1.4000000000000008, -1.600000000000001, -47.80000000000039, -1.600000000000001, -1.700000000000001, -1.4000000000000008, -1.700000000000001, -1.5000000000000009, -1.5000000000000009, -1.600000000000001, -1.700000000000001, -1.5000000000000009, -1.700000000000001, -1.5000000000000009, -1.4000000000000008, -1.8000000000000012, -1.9000000000000012, -2.0000000000000013, -1.8000000000000012, -1.8000000000000012, -1.5000000000000009, -1.5000000000000009, -1.5000000000000009, -1.600000000000001, -1.700000000000001, -1.9000000000000012, -1.8000000000000012, -1.700000000000001, -1.5000000000000009, -1.5000000000000009, -1.5000000000000009, -1.600000000000001, -2.0000000000000013, -1.5000000000000009, -1.5000000000000009, -2.1000000000000014], "episode_lengths": [25, 32, 28, 26, 25, 84, 29, 27, 28, 32, 27, 31, 27, 28, 29, 31, 29, 28, 29, 26, 29, 31, 28, 27, 26, 48, 30, 26, 32, 27, 28, 27, 27, 27, 27, 28, 27, 193, 27, 26, 26, 25, 28, 25, 27, 72, 28, 26, 26, 27, 28, 32, 30, 33, 27, 26, 128, 26, 25, 31, 30, 26, 25, 28, 28, 27, 26, 27, 26, 25, 26, 27, 27, 26, 28, 29, 28, 25, 26, 28, 26, 27, 26, 27, 29, 27, 27, 26, 28, 26, 28, 30, 25, 27, 400, 27, 28, 25, 28, 26, 26, 27, 28, 26, 28, 26, 25, 29, 30, 31, 29, 29, 26, 26, 26, 27, 28, 30, 27, 28, 26, 26, 26, 27, 31, 26, 26, 32]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.36011476947779103, "mean_inference_ms": 0.7328274962480181, "mean_action_processing_ms": 0.07651548304131908, "mean_env_wait_ms": 7.112395930849767, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006741657853126526, "StateBufferConnector_ms": 0.003974884748458862, "ViewRequirementAgentConnector_ms": 0.0908268615603447}}, "episode_reward_max": -1.4000000000000008, "episode_reward_min": -47.80000000000039, "episode_reward_mean": -2.3828125000000036, "episode_len_mean": 33.4453125, "episodes_this_iter": 128, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1.4000000000000008, -2.1000000000000014, -1.700000000000001, -1.5000000000000009, -1.4000000000000008, -12.899999999999984, -1.8000000000000012, -1.600000000000001, -1.700000000000001, -2.1000000000000014, -1.600000000000001, -2.0000000000000013, -1.600000000000001, -1.700000000000001, -1.8000000000000012, -2.0000000000000013, -1.8000000000000012, -1.700000000000001, -1.8000000000000012, -1.5000000000000009, -1.8000000000000012, -2.0000000000000013, -1.700000000000001, -1.600000000000001, -1.5000000000000009, -5.400000000000004, -1.9000000000000012, -1.5000000000000009, -2.1000000000000014, -1.600000000000001, -1.700000000000001, -1.600000000000001, -1.600000000000001, -1.600000000000001, -1.600000000000001, -1.700000000000001, -1.600000000000001, -18.500000000000007, -1.600000000000001, -1.5000000000000009, -1.5000000000000009, -1.4000000000000008, -1.700000000000001, -1.4000000000000008, -1.600000000000001, -6.899999999999995, -1.700000000000001, -1.5000000000000009, -1.5000000000000009, -1.600000000000001, -1.700000000000001, -2.1000000000000014, -1.9000000000000012, -2.2000000000000015, -1.600000000000001, -1.5000000000000009, -11.89999999999997, -1.5000000000000009, -1.4000000000000008, -2.0000000000000013, -1.9000000000000012, -1.5000000000000009, -1.4000000000000008, -1.700000000000001, -1.700000000000001, -1.600000000000001, -1.5000000000000009, -1.600000000000001, -1.5000000000000009, -1.4000000000000008, -1.5000000000000009, -1.600000000000001, -1.600000000000001, -1.5000000000000009, -1.700000000000001, -1.8000000000000012, -1.700000000000001, -1.4000000000000008, -1.5000000000000009, -1.700000000000001, -1.5000000000000009, -1.600000000000001, -1.5000000000000009, -1.600000000000001, -1.8000000000000012, -1.600000000000001, -1.600000000000001, -1.5000000000000009, -1.700000000000001, -1.5000000000000009, -1.700000000000001, -1.9000000000000012, -1.4000000000000008, -1.600000000000001, -47.80000000000039, -1.600000000000001, -1.700000000000001, -1.4000000000000008, -1.700000000000001, -1.5000000000000009, -1.5000000000000009, -1.600000000000001, -1.700000000000001, -1.5000000000000009, -1.700000000000001, -1.5000000000000009, -1.4000000000000008, -1.8000000000000012, -1.9000000000000012, -2.0000000000000013, -1.8000000000000012, -1.8000000000000012, -1.5000000000000009, -1.5000000000000009, -1.5000000000000009, -1.600000000000001, -1.700000000000001, -1.9000000000000012, -1.8000000000000012, -1.700000000000001, -1.5000000000000009, -1.5000000000000009, -1.5000000000000009, -1.600000000000001, -2.0000000000000013, -1.5000000000000009, -1.5000000000000009, -2.1000000000000014], "episode_lengths": [25, 32, 28, 26, 25, 84, 29, 27, 28, 32, 27, 31, 27, 28, 29, 31, 29, 28, 29, 26, 29, 31, 28, 27, 26, 48, 30, 26, 32, 27, 28, 27, 27, 27, 27, 28, 27, 193, 27, 26, 26, 25, 28, 25, 27, 72, 28, 26, 26, 27, 28, 32, 30, 33, 27, 26, 128, 26, 25, 31, 30, 26, 25, 28, 28, 27, 26, 27, 26, 25, 26, 27, 27, 26, 28, 29, 28, 25, 26, 28, 26, 27, 26, 27, 29, 27, 27, 26, 28, 26, 28, 30, 25, 27, 400, 27, 28, 25, 28, 26, 26, 27, 28, 26, 28, 26, 25, 29, 30, 31, 29, 29, 26, 26, 26, 27, 28, 30, 27, 28, 26, 26, 26, 27, 31, 26, 26, 32]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.36011476947779103, "mean_inference_ms": 0.7328274962480181, "mean_action_processing_ms": 0.07651548304131908, "mean_env_wait_ms": 7.112395930849767, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006741657853126526, "StateBufferConnector_ms": 0.003974884748458862, "ViewRequirementAgentConnector_ms": 0.0908268615603447}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 200000, "num_agent_steps_trained": 200000, "num_env_steps_sampled": 200000, "num_env_steps_trained": 200000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 496.81666238320685, "num_env_steps_trained_throughput_per_sec": 496.81666238320685, "timesteps_total": 200000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 200000, "timers": {"training_iteration_time_ms": 8291.236, "sample_time_ms": 4773.887, "load_time_ms": 0.975, "load_throughput": 4103814.882, "learn_time_ms": 3513.102, "learn_throughput": 1138.595, "synch_weights_time_ms": 2.622}, "counters": {"num_env_steps_sampled": 200000, "num_env_steps_trained": 200000, "num_agent_steps_sampled": 200000, "num_agent_steps_trained": 200000}, "done": true, "episodes_total": 4310, "training_iteration": 50, "trial_id": "2154c_00000", "date": "2024-03-07_13-11-09", "timestamp": 1709835069, "time_this_iter_s": 12.953779458999634, "time_total_s": 396.851380109787, "pid": 116529, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7efea6399f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 396.851380109787, "iterations_since_restore": 50, "perf": {"cpu_util_percent": 22.441176470588236, "ram_util_percent": 50.71764705882353, "gpu_util_percent0": 0.050588235294117656, "vram_util_percent0": 0.09396063112745098}}
