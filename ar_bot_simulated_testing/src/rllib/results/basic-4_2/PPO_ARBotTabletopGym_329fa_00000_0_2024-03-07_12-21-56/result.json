{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 8.282777716267493, "policy_loss": 0.00746287565718415, "vf_loss": 8.274030566856425, "vf_explained_var": -0.06783954430651921, "kl": 0.006421409582200873, "entropy": 1.0922843157604176, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 465.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000}, "sampler_results": {"episode_reward_max": -7.199999999999987, "episode_reward_min": -62.50000000000042, "episode_reward_mean": -45.027272727273015, "episode_len_mean": 320.8181818181818, "episode_media": {}, "episodes_this_iter": 11, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-62.50000000000042, -57.10000000000038, -9.599999999999984, -56.90000000000043, -54.40000000000025, -57.900000000000404, -55.30000000000044, -18.600000000000005, -55.700000000000394, -7.199999999999987, -60.100000000000435], "episode_lengths": [400, 400, 98, 400, 393, 400, 379, 176, 400, 83, 400]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19657632417049167, "mean_inference_ms": 0.6231483673921626, "mean_action_processing_ms": 0.06953568476312395, "mean_env_wait_ms": 6.156721531711475, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006348436528986151, "StateBufferConnector_ms": 0.0031731345436789775, "ViewRequirementAgentConnector_ms": 0.07225166667591441}}, "episode_reward_max": -7.199999999999987, "episode_reward_min": -62.50000000000042, "episode_reward_mean": -45.027272727273015, "episode_len_mean": 320.8181818181818, "episodes_this_iter": 11, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-62.50000000000042, -57.10000000000038, -9.599999999999984, -56.90000000000043, -54.40000000000025, -57.900000000000404, -55.30000000000044, -18.600000000000005, -55.700000000000394, -7.199999999999987, -60.100000000000435], "episode_lengths": [400, 400, 98, 400, 393, 400, 379, 176, 400, 83, 400]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19657632417049167, "mean_inference_ms": 0.6231483673921626, "mean_action_processing_ms": 0.06953568476312395, "mean_env_wait_ms": 6.156721531711475, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006348436528986151, "StateBufferConnector_ms": 0.0031731345436789775, "ViewRequirementAgentConnector_ms": 0.07225166667591441}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 374.78874982519613, "num_env_steps_trained_throughput_per_sec": 374.78874982519613, "timesteps_total": 4000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 4000, "timers": {"training_iteration_time_ms": 10672.613, "sample_time_ms": 7147.805, "load_time_ms": 0.904, "load_throughput": 4425538.38, "learn_time_ms": 3521.329, "learn_throughput": 1135.935, "synch_weights_time_ms": 1.802}, "counters": {"num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000}, "done": false, "episodes_total": 11, "training_iteration": 1, "trial_id": "329fa_00000", "date": "2024-03-07_12-22-13", "timestamp": 1709832133, "time_this_iter_s": 10.674562215805054, "time_total_s": 10.674562215805054, "pid": 105400, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fcd19c36f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 10.674562215805054, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 18.821428571428577, "ram_util_percent": 43.11428571428571, "gpu_util_percent0": 0.07357142857142855, "vram_util_percent0": 0.10000465029761904}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 5.973884084916884, "policy_loss": 0.0014304723630669297, "vf_loss": 5.9713983579348495, "vf_explained_var": -0.1159399208202157, "kl": 0.005276347989470335, "entropy": 1.080844380394105, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 1395.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000}, "sampler_results": {"episode_reward_max": -7.199999999999987, "episode_reward_min": -68.7000000000004, "episode_reward_mean": -46.34545454545481, "episode_len_mean": 327.3636363636364, "episode_media": {}, "episodes_this_iter": 11, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-62.50000000000042, -57.10000000000038, -9.599999999999984, -56.90000000000043, -54.40000000000025, -57.900000000000404, -55.30000000000044, -18.600000000000005, -55.700000000000394, -7.199999999999987, -60.100000000000435, -67.10000000000035, -50.00000000000029, -43.50000000000011, -68.7000000000004, -52.10000000000028, -12.699999999999967, -51.10000000000035, -49.900000000000226, -42.40000000000009, -23.400000000000034, -63.400000000000446], "episode_lengths": [400, 400, 98, 400, 393, 400, 379, 176, 400, 83, 400, 400, 400, 318, 400, 400, 129, 400, 330, 292, 204, 400]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19581326507746202, "mean_inference_ms": 0.6212952990939986, "mean_action_processing_ms": 0.06913152996969706, "mean_env_wait_ms": 6.14169617199203, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005554069172252308, "StateBufferConnector_ms": 0.003172050822864879, "ViewRequirementAgentConnector_ms": 0.07174773649735884}}, "episode_reward_max": -7.199999999999987, "episode_reward_min": -68.7000000000004, "episode_reward_mean": -46.34545454545481, "episode_len_mean": 327.3636363636364, "episodes_this_iter": 11, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-62.50000000000042, -57.10000000000038, -9.599999999999984, -56.90000000000043, -54.40000000000025, -57.900000000000404, -55.30000000000044, -18.600000000000005, -55.700000000000394, -7.199999999999987, -60.100000000000435, -67.10000000000035, -50.00000000000029, -43.50000000000011, -68.7000000000004, -52.10000000000028, -12.699999999999967, -51.10000000000035, -49.900000000000226, -42.40000000000009, -23.400000000000034, -63.400000000000446], "episode_lengths": [400, 400, 98, 400, 393, 400, 379, 176, 400, 83, 400, 400, 400, 318, 400, 400, 129, 400, 330, 292, 204, 400]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19581326507746202, "mean_inference_ms": 0.6212952990939986, "mean_action_processing_ms": 0.06913152996969706, "mean_env_wait_ms": 6.14169617199203, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005554069172252308, "StateBufferConnector_ms": 0.003172050822864879, "ViewRequirementAgentConnector_ms": 0.07174773649735884}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 381.2554101575478, "num_env_steps_trained_throughput_per_sec": 381.2554101575478, "timesteps_total": 8000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 8000, "timers": {"training_iteration_time_ms": 10582.107, "sample_time_ms": 7106.916, "load_time_ms": 0.904, "load_throughput": 4426122.147, "learn_time_ms": 3471.896, "learn_throughput": 1152.108, "synch_weights_time_ms": 1.704}, "counters": {"num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000}, "done": false, "episodes_total": 22, "training_iteration": 2, "trial_id": "329fa_00000", "date": "2024-03-07_12-22-24", "timestamp": 1709832144, "time_this_iter_s": 10.493701934814453, "time_total_s": 21.168264150619507, "pid": 105400, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fcd19c36f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 21.168264150619507, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 19.328571428571426, "ram_util_percent": 43.478571428571435, "gpu_util_percent0": 0.08857142857142856, "vram_util_percent0": 0.1005859375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 5.088484093771186, "policy_loss": -0.015631460895140965, "vf_loss": 5.102486019172976, "vf_explained_var": -0.09902681387880798, "kl": 0.008147583722351592, "entropy": 1.0718290350770439, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 2325.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000}, "sampler_results": {"episode_reward_max": -7.199999999999987, "episode_reward_min": -68.7000000000004, "episode_reward_mean": -46.0617647058826, "episode_len_mean": 326.4117647058824, "episode_media": {}, "episodes_this_iter": 12, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-62.50000000000042, -57.10000000000038, -9.599999999999984, -56.90000000000043, -54.40000000000025, -57.900000000000404, -55.30000000000044, -18.600000000000005, -55.700000000000394, -7.199999999999987, -60.100000000000435, -67.10000000000035, -50.00000000000029, -43.50000000000011, -68.7000000000004, -52.10000000000028, -12.699999999999967, -51.10000000000035, -49.900000000000226, -42.40000000000009, -23.400000000000034, -63.400000000000446, -61.800000000000345, -63.1000000000004, -34.30000000000002, -62.6000000000004, -56.200000000000294, -50.100000000000286, -8.699999999999982, -54.30000000000039, -14.099999999999973, -54.400000000000276, -59.500000000000355, -27.400000000000002], "episode_lengths": [400, 400, 98, 400, 393, 400, 379, 176, 400, 83, 400, 400, 400, 318, 400, 400, 129, 400, 330, 292, 204, 400, 400, 400, 251, 400, 400, 400, 98, 400, 138, 400, 400, 209]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19557824026264026, "mean_inference_ms": 0.6200112056331579, "mean_action_processing_ms": 0.06883311068169849, "mean_env_wait_ms": 6.129230651566606, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0052928924560546875, "StateBufferConnector_ms": 0.0032382852890912223, "ViewRequirementAgentConnector_ms": 0.07200802073759191}}, "episode_reward_max": -7.199999999999987, "episode_reward_min": -68.7000000000004, "episode_reward_mean": -46.0617647058826, "episode_len_mean": 326.4117647058824, "episodes_this_iter": 12, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-62.50000000000042, -57.10000000000038, -9.599999999999984, -56.90000000000043, -54.40000000000025, -57.900000000000404, -55.30000000000044, -18.600000000000005, -55.700000000000394, -7.199999999999987, -60.100000000000435, -67.10000000000035, -50.00000000000029, -43.50000000000011, -68.7000000000004, -52.10000000000028, -12.699999999999967, -51.10000000000035, -49.900000000000226, -42.40000000000009, -23.400000000000034, -63.400000000000446, -61.800000000000345, -63.1000000000004, -34.30000000000002, -62.6000000000004, -56.200000000000294, -50.100000000000286, -8.699999999999982, -54.30000000000039, -14.099999999999973, -54.400000000000276, -59.500000000000355, -27.400000000000002], "episode_lengths": [400, 400, 98, 400, 393, 400, 379, 176, 400, 83, 400, 400, 400, 318, 400, 400, 129, 400, 330, 292, 204, 400, 400, 400, 251, 400, 400, 400, 98, 400, 138, 400, 400, 209]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19557824026264026, "mean_inference_ms": 0.6200112056331579, "mean_action_processing_ms": 0.06883311068169849, "mean_env_wait_ms": 6.129230651566606, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0052928924560546875, "StateBufferConnector_ms": 0.0032382852890912223, "ViewRequirementAgentConnector_ms": 0.07200802073759191}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 381.44127150970724, "num_env_steps_trained_throughput_per_sec": 381.44127150970724, "timesteps_total": 12000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 12000, "timers": {"training_iteration_time_ms": 10550.238, "sample_time_ms": 7088.314, "load_time_ms": 0.911, "load_throughput": 4392324.636, "learn_time_ms": 3458.649, "learn_throughput": 1156.521, "synch_weights_time_ms": 1.698}, "counters": {"num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000}, "done": false, "episodes_total": 34, "training_iteration": 3, "trial_id": "329fa_00000", "date": "2024-03-07_12-22-34", "timestamp": 1709832154, "time_this_iter_s": 10.48890495300293, "time_total_s": 31.657169103622437, "pid": 105400, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fcd19c36f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 31.657169103622437, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 19.35714285714286, "ram_util_percent": 43.5, "gpu_util_percent0": 0.07785714285714285, "vram_util_percent0": 0.1005859375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 6.094215389990038, "policy_loss": 0.0011074476745179904, "vf_loss": 6.092111692056861, "vf_explained_var": -0.21978774198921777, "kl": 0.004981263179604483, "entropy": 1.0804032430853896, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 3255.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000}, "sampler_results": {"episode_reward_max": -7.199999999999987, "episode_reward_min": -69.40000000000042, "episode_reward_mean": -46.24375000000024, "episode_len_mean": 327.7916666666667, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-62.50000000000042, -57.10000000000038, -9.599999999999984, -56.90000000000043, -54.40000000000025, -57.900000000000404, -55.30000000000044, -18.600000000000005, -55.700000000000394, -7.199999999999987, -60.100000000000435, -67.10000000000035, -50.00000000000029, -43.50000000000011, -68.7000000000004, -52.10000000000028, -12.699999999999967, -51.10000000000035, -49.900000000000226, -42.40000000000009, -23.400000000000034, -63.400000000000446, -61.800000000000345, -63.1000000000004, -34.30000000000002, -62.6000000000004, -56.200000000000294, -50.100000000000286, -8.699999999999982, -54.30000000000039, -14.099999999999973, -54.400000000000276, -59.500000000000355, -27.400000000000002, -57.100000000000314, -47.90000000000022, -23.000000000000004, -20.00000000000001, -43.0000000000003, -60.300000000000345, -21.5, -24.69999999999996, -61.60000000000037, -64.60000000000038, -36.10000000000005, -69.40000000000042, -65.40000000000038, -59.0000000000003], "episode_lengths": [400, 400, 98, 400, 393, 400, 379, 176, 400, 83, 400, 400, 400, 318, 400, 400, 129, 400, 330, 292, 204, 400, 400, 400, 251, 400, 400, 400, 98, 400, 138, 400, 400, 209, 400, 371, 222, 191, 400, 383, 184, 193, 400, 400, 292, 400, 400, 400]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1955107986358154, "mean_inference_ms": 0.619102875281728, "mean_action_processing_ms": 0.06868248962529178, "mean_env_wait_ms": 6.11817132236975, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005269050598144531, "StateBufferConnector_ms": 0.0032166639963785806, "ViewRequirementAgentConnector_ms": 0.07265408833821614}}, "episode_reward_max": -7.199999999999987, "episode_reward_min": -69.40000000000042, "episode_reward_mean": -46.24375000000024, "episode_len_mean": 327.7916666666667, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-62.50000000000042, -57.10000000000038, -9.599999999999984, -56.90000000000043, -54.40000000000025, -57.900000000000404, -55.30000000000044, -18.600000000000005, -55.700000000000394, -7.199999999999987, -60.100000000000435, -67.10000000000035, -50.00000000000029, -43.50000000000011, -68.7000000000004, -52.10000000000028, -12.699999999999967, -51.10000000000035, -49.900000000000226, -42.40000000000009, -23.400000000000034, -63.400000000000446, -61.800000000000345, -63.1000000000004, -34.30000000000002, -62.6000000000004, -56.200000000000294, -50.100000000000286, -8.699999999999982, -54.30000000000039, -14.099999999999973, -54.400000000000276, -59.500000000000355, -27.400000000000002, -57.100000000000314, -47.90000000000022, -23.000000000000004, -20.00000000000001, -43.0000000000003, -60.300000000000345, -21.5, -24.69999999999996, -61.60000000000037, -64.60000000000038, -36.10000000000005, -69.40000000000042, -65.40000000000038, -59.0000000000003], "episode_lengths": [400, 400, 98, 400, 393, 400, 379, 176, 400, 83, 400, 400, 400, 318, 400, 400, 129, 400, 330, 292, 204, 400, 400, 400, 251, 400, 400, 400, 98, 400, 138, 400, 400, 209, 400, 371, 222, 191, 400, 383, 184, 193, 400, 400, 292, 400, 400, 400]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1955107986358154, "mean_inference_ms": 0.619102875281728, "mean_action_processing_ms": 0.06868248962529178, "mean_env_wait_ms": 6.11817132236975, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005269050598144531, "StateBufferConnector_ms": 0.0032166639963785806, "ViewRequirementAgentConnector_ms": 0.07265408833821614}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 370.16884795106006, "num_env_steps_trained_throughput_per_sec": 370.16884795106006, "timesteps_total": 16000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 16000, "timers": {"training_iteration_time_ms": 10614.136, "sample_time_ms": 7084.993, "load_time_ms": 0.907, "load_throughput": 4408965.508, "learn_time_ms": 3525.858, "learn_throughput": 1134.476, "synch_weights_time_ms": 1.718}, "counters": {"num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000}, "done": false, "episodes_total": 48, "training_iteration": 4, "trial_id": "329fa_00000", "date": "2024-03-07_12-22-45", "timestamp": 1709832165, "time_this_iter_s": 10.808021783828735, "time_total_s": 42.46519088745117, "pid": 105400, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fcd19c36f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 42.46519088745117, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 20.61428571428571, "ram_util_percent": 43.5, "gpu_util_percent0": 0.07999999999999999, "vram_util_percent0": 0.1005859375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.10000000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 6.6660093544631875, "policy_loss": -0.020201692322609564, "vf_loss": 6.68531408370823, "vf_explained_var": -0.43692574539492207, "kl": 0.00896947098242639, "entropy": 1.068277662031112, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 4185.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 20000}, "sampler_results": {"episode_reward_max": -5.2999999999999945, "episode_reward_min": -69.40000000000042, "episode_reward_mean": -39.986567164179284, "episode_len_mean": 291.17910447761193, "episode_media": {}, "episodes_this_iter": 19, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-62.50000000000042, -57.10000000000038, -9.599999999999984, -56.90000000000043, -54.40000000000025, -57.900000000000404, -55.30000000000044, -18.600000000000005, -55.700000000000394, -7.199999999999987, -60.100000000000435, -67.10000000000035, -50.00000000000029, -43.50000000000011, -68.7000000000004, -52.10000000000028, -12.699999999999967, -51.10000000000035, -49.900000000000226, -42.40000000000009, -23.400000000000034, -63.400000000000446, -61.800000000000345, -63.1000000000004, -34.30000000000002, -62.6000000000004, -56.200000000000294, -50.100000000000286, -8.699999999999982, -54.30000000000039, -14.099999999999973, -54.400000000000276, -59.500000000000355, -27.400000000000002, -57.100000000000314, -47.90000000000022, -23.000000000000004, -20.00000000000001, -43.0000000000003, -60.300000000000345, -21.5, -24.69999999999996, -61.60000000000037, -64.60000000000038, -36.10000000000005, -69.40000000000042, -65.40000000000038, -59.0000000000003, -20.80000000000004, -14.399999999999965, -23.400000000000013, -19.59999999999997, -10.599999999999975, -21.199999999999992, -5.2999999999999945, -46.100000000000186, -16.999999999999975, -53.70000000000026, -15.599999999999966, -12.499999999999968, -41.200000000000074, -49.40000000000028, -53.8000000000003, -13.799999999999963, -9.999999999999977, -19.899999999999963, -11.09999999999998], "episode_lengths": [400, 400, 98, 400, 393, 400, 379, 176, 400, 83, 400, 400, 400, 318, 400, 400, 129, 400, 330, 292, 204, 400, 400, 400, 251, 400, 400, 400, 98, 400, 138, 400, 400, 209, 400, 371, 222, 191, 400, 383, 184, 193, 400, 400, 292, 400, 400, 400, 197, 126, 200, 155, 104, 177, 63, 329, 167, 387, 140, 125, 287, 400, 400, 149, 104, 157, 108]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19630305212090832, "mean_inference_ms": 0.6185022704727132, "mean_action_processing_ms": 0.06853371891292259, "mean_env_wait_ms": 6.104578292886949, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005223857822702892, "StateBufferConnector_ms": 0.0031745255883060285, "ViewRequirementAgentConnector_ms": 0.07260984449244257}}, "episode_reward_max": -5.2999999999999945, "episode_reward_min": -69.40000000000042, "episode_reward_mean": -39.986567164179284, "episode_len_mean": 291.17910447761193, "episodes_this_iter": 19, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-62.50000000000042, -57.10000000000038, -9.599999999999984, -56.90000000000043, -54.40000000000025, -57.900000000000404, -55.30000000000044, -18.600000000000005, -55.700000000000394, -7.199999999999987, -60.100000000000435, -67.10000000000035, -50.00000000000029, -43.50000000000011, -68.7000000000004, -52.10000000000028, -12.699999999999967, -51.10000000000035, -49.900000000000226, -42.40000000000009, -23.400000000000034, -63.400000000000446, -61.800000000000345, -63.1000000000004, -34.30000000000002, -62.6000000000004, -56.200000000000294, -50.100000000000286, -8.699999999999982, -54.30000000000039, -14.099999999999973, -54.400000000000276, -59.500000000000355, -27.400000000000002, -57.100000000000314, -47.90000000000022, -23.000000000000004, -20.00000000000001, -43.0000000000003, -60.300000000000345, -21.5, -24.69999999999996, -61.60000000000037, -64.60000000000038, -36.10000000000005, -69.40000000000042, -65.40000000000038, -59.0000000000003, -20.80000000000004, -14.399999999999965, -23.400000000000013, -19.59999999999997, -10.599999999999975, -21.199999999999992, -5.2999999999999945, -46.100000000000186, -16.999999999999975, -53.70000000000026, -15.599999999999966, -12.499999999999968, -41.200000000000074, -49.40000000000028, -53.8000000000003, -13.799999999999963, -9.999999999999977, -19.899999999999963, -11.09999999999998], "episode_lengths": [400, 400, 98, 400, 393, 400, 379, 176, 400, 83, 400, 400, 400, 318, 400, 400, 129, 400, 330, 292, 204, 400, 400, 400, 251, 400, 400, 400, 98, 400, 138, 400, 400, 209, 400, 371, 222, 191, 400, 383, 184, 193, 400, 400, 292, 400, 400, 400, 197, 126, 200, 155, 104, 177, 63, 329, 167, 387, 140, 125, 287, 400, 400, 149, 104, 157, 108]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19630305212090832, "mean_inference_ms": 0.6185022704727132, "mean_action_processing_ms": 0.06853371891292259, "mean_env_wait_ms": 6.104578292886949, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005223857822702892, "StateBufferConnector_ms": 0.0031745255883060285, "ViewRequirementAgentConnector_ms": 0.07260984449244257}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 20000, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 380.6221468736548, "num_env_steps_trained_throughput_per_sec": 380.6221468736548, "timesteps_total": 20000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 20000, "timers": {"training_iteration_time_ms": 10593.124, "sample_time_ms": 7072.273, "load_time_ms": 0.924, "load_throughput": 4329827.604, "learn_time_ms": 3517.556, "learn_throughput": 1137.153, "synch_weights_time_ms": 1.716}, "counters": {"num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 20000}, "done": false, "episodes_total": 67, "training_iteration": 5, "trial_id": "329fa_00000", "date": "2024-03-07_12-22-56", "timestamp": 1709832176, "time_this_iter_s": 10.511231422424316, "time_total_s": 52.97642230987549, "pid": 105400, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fcd19c36f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 52.97642230987549, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 20.185714285714287, "ram_util_percent": 43.5, "gpu_util_percent0": 0.08357142857142856, "vram_util_percent0": 0.1005859375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.10000000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 5.714948835488289, "policy_loss": -0.014114960907928405, "vf_loss": 5.728315671989995, "vf_explained_var": -0.3775749232820285, "kl": 0.007481443724771364, "entropy": 1.0556664683485544, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 5115.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000}, "sampler_results": {"episode_reward_max": -5.2999999999999945, "episode_reward_min": -69.40000000000042, "episode_reward_mean": -38.14642857142874, "episode_len_mean": 282.6666666666667, "episode_media": {}, "episodes_this_iter": 17, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-62.50000000000042, -57.10000000000038, -9.599999999999984, -56.90000000000043, -54.40000000000025, -57.900000000000404, -55.30000000000044, -18.600000000000005, -55.700000000000394, -7.199999999999987, -60.100000000000435, -67.10000000000035, -50.00000000000029, -43.50000000000011, -68.7000000000004, -52.10000000000028, -12.699999999999967, -51.10000000000035, -49.900000000000226, -42.40000000000009, -23.400000000000034, -63.400000000000446, -61.800000000000345, -63.1000000000004, -34.30000000000002, -62.6000000000004, -56.200000000000294, -50.100000000000286, -8.699999999999982, -54.30000000000039, -14.099999999999973, -54.400000000000276, -59.500000000000355, -27.400000000000002, -57.100000000000314, -47.90000000000022, -23.000000000000004, -20.00000000000001, -43.0000000000003, -60.300000000000345, -21.5, -24.69999999999996, -61.60000000000037, -64.60000000000038, -36.10000000000005, -69.40000000000042, -65.40000000000038, -59.0000000000003, -20.80000000000004, -14.399999999999965, -23.400000000000013, -19.59999999999997, -10.599999999999975, -21.199999999999992, -5.2999999999999945, -46.100000000000186, -16.999999999999975, -53.70000000000026, -15.599999999999966, -12.499999999999968, -41.200000000000074, -49.40000000000028, -53.8000000000003, -13.799999999999963, -9.999999999999977, -19.899999999999963, -11.09999999999998, -9.19999999999998, -62.20000000000046, -44.300000000000296, -13.199999999999973, -51.70000000000029, -12.49999999999998, -45.500000000000284, -14.399999999999963, -55.100000000000264, -52.900000000000304, -14.399999999999965, -26.500000000000107, -29.40000000000001, -11.599999999999977, -8.199999999999983, -58.00000000000037, -16.099999999999962], "episode_lengths": [400, 400, 98, 400, 393, 400, 379, 176, 400, 83, 400, 400, 400, 318, 400, 400, 129, 400, 330, 292, 204, 400, 400, 400, 251, 400, 400, 400, 98, 400, 138, 400, 400, 209, 400, 371, 222, 191, 400, 383, 184, 193, 400, 400, 292, 400, 400, 400, 197, 126, 200, 155, 104, 177, 63, 329, 167, 387, 140, 125, 287, 400, 400, 149, 104, 157, 108, 103, 400, 344, 114, 400, 110, 400, 153, 400, 400, 133, 256, 262, 113, 93, 392, 162]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19679616759595114, "mean_inference_ms": 0.6181285539374949, "mean_action_processing_ms": 0.06846133956871799, "mean_env_wait_ms": 6.0981221473592715, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005159491584414528, "StateBufferConnector_ms": 0.003152234213692801, "ViewRequirementAgentConnector_ms": 0.07266175179254442}}, "episode_reward_max": -5.2999999999999945, "episode_reward_min": -69.40000000000042, "episode_reward_mean": -38.14642857142874, "episode_len_mean": 282.6666666666667, "episodes_this_iter": 17, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-62.50000000000042, -57.10000000000038, -9.599999999999984, -56.90000000000043, -54.40000000000025, -57.900000000000404, -55.30000000000044, -18.600000000000005, -55.700000000000394, -7.199999999999987, -60.100000000000435, -67.10000000000035, -50.00000000000029, -43.50000000000011, -68.7000000000004, -52.10000000000028, -12.699999999999967, -51.10000000000035, -49.900000000000226, -42.40000000000009, -23.400000000000034, -63.400000000000446, -61.800000000000345, -63.1000000000004, -34.30000000000002, -62.6000000000004, -56.200000000000294, -50.100000000000286, -8.699999999999982, -54.30000000000039, -14.099999999999973, -54.400000000000276, -59.500000000000355, -27.400000000000002, -57.100000000000314, -47.90000000000022, -23.000000000000004, -20.00000000000001, -43.0000000000003, -60.300000000000345, -21.5, -24.69999999999996, -61.60000000000037, -64.60000000000038, -36.10000000000005, -69.40000000000042, -65.40000000000038, -59.0000000000003, -20.80000000000004, -14.399999999999965, -23.400000000000013, -19.59999999999997, -10.599999999999975, -21.199999999999992, -5.2999999999999945, -46.100000000000186, -16.999999999999975, -53.70000000000026, -15.599999999999966, -12.499999999999968, -41.200000000000074, -49.40000000000028, -53.8000000000003, -13.799999999999963, -9.999999999999977, -19.899999999999963, -11.09999999999998, -9.19999999999998, -62.20000000000046, -44.300000000000296, -13.199999999999973, -51.70000000000029, -12.49999999999998, -45.500000000000284, -14.399999999999963, -55.100000000000264, -52.900000000000304, -14.399999999999965, -26.500000000000107, -29.40000000000001, -11.599999999999977, -8.199999999999983, -58.00000000000037, -16.099999999999962], "episode_lengths": [400, 400, 98, 400, 393, 400, 379, 176, 400, 83, 400, 400, 400, 318, 400, 400, 129, 400, 330, 292, 204, 400, 400, 400, 251, 400, 400, 400, 98, 400, 138, 400, 400, 209, 400, 371, 222, 191, 400, 383, 184, 193, 400, 400, 292, 400, 400, 400, 197, 126, 200, 155, 104, 177, 63, 329, 167, 387, 140, 125, 287, 400, 400, 149, 104, 157, 108, 103, 400, 344, 114, 400, 110, 400, 153, 400, 400, 133, 256, 262, 113, 93, 392, 162]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19679616759595114, "mean_inference_ms": 0.6181285539374949, "mean_action_processing_ms": 0.06846133956871799, "mean_env_wait_ms": 6.0981221473592715, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005159491584414528, "StateBufferConnector_ms": 0.003152234213692801, "ViewRequirementAgentConnector_ms": 0.07266175179254442}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 381.8430059390537, "num_env_steps_trained_throughput_per_sec": 381.8430059390537, "timesteps_total": 24000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 24000, "timers": {"training_iteration_time_ms": 10573.516, "sample_time_ms": 7064.392, "load_time_ms": 0.928, "load_throughput": 4309216.438, "learn_time_ms": 3505.854, "learn_throughput": 1140.949, "synch_weights_time_ms": 1.701}, "counters": {"num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000}, "done": false, "episodes_total": 84, "training_iteration": 6, "trial_id": "329fa_00000", "date": "2024-03-07_12-23-06", "timestamp": 1709832186, "time_this_iter_s": 10.477808237075806, "time_total_s": 63.454230546951294, "pid": 105400, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fcd19c36f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 63.454230546951294, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 20.200000000000003, "ram_util_percent": 43.49230769230769, "gpu_util_percent0": 0.08, "vram_util_percent0": 0.1005859375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.10000000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 5.580672595129218, "policy_loss": -0.02252816903975702, "vf_loss": 5.602313655614853, "vf_explained_var": -0.35760932551917207, "kl": 0.008871070677434078, "entropy": 1.0279016405664465, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 6045.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 28000}, "sampler_results": {"episode_reward_max": -3.799999999999999, "episode_reward_min": -69.40000000000042, "episode_reward_mean": -34.13500000000013, "episode_len_mean": 261.64, "episode_media": {}, "episodes_this_iter": 20, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-54.40000000000025, -57.900000000000404, -55.30000000000044, -18.600000000000005, -55.700000000000394, -7.199999999999987, -60.100000000000435, -67.10000000000035, -50.00000000000029, -43.50000000000011, -68.7000000000004, -52.10000000000028, -12.699999999999967, -51.10000000000035, -49.900000000000226, -42.40000000000009, -23.400000000000034, -63.400000000000446, -61.800000000000345, -63.1000000000004, -34.30000000000002, -62.6000000000004, -56.200000000000294, -50.100000000000286, -8.699999999999982, -54.30000000000039, -14.099999999999973, -54.400000000000276, -59.500000000000355, -27.400000000000002, -57.100000000000314, -47.90000000000022, -23.000000000000004, -20.00000000000001, -43.0000000000003, -60.300000000000345, -21.5, -24.69999999999996, -61.60000000000037, -64.60000000000038, -36.10000000000005, -69.40000000000042, -65.40000000000038, -59.0000000000003, -20.80000000000004, -14.399999999999965, -23.400000000000013, -19.59999999999997, -10.599999999999975, -21.199999999999992, -5.2999999999999945, -46.100000000000186, -16.999999999999975, -53.70000000000026, -15.599999999999966, -12.499999999999968, -41.200000000000074, -49.40000000000028, -53.8000000000003, -13.799999999999963, -9.999999999999977, -19.899999999999963, -11.09999999999998, -9.19999999999998, -62.20000000000046, -44.300000000000296, -13.199999999999973, -51.70000000000029, -12.49999999999998, -45.500000000000284, -14.399999999999963, -55.100000000000264, -52.900000000000304, -14.399999999999965, -26.500000000000107, -29.40000000000001, -11.599999999999977, -8.199999999999983, -58.00000000000037, -16.099999999999962, -48.20000000000019, -9.799999999999978, -4.699999999999996, -9.599999999999978, -4.799999999999995, -7.699999999999985, -3.799999999999999, -23.900000000000027, -29.20000000000011, -47.70000000000019, -8.99999999999998, -9.09999999999998, -12.399999999999968, -21.900000000000023, -43.100000000000335, -15.19999999999996, -15.599999999999962, -22.099999999999945, -18.200000000000003, -39.30000000000021], "episode_lengths": [393, 400, 379, 176, 400, 83, 400, 400, 400, 318, 400, 400, 129, 400, 330, 292, 204, 400, 400, 400, 251, 400, 400, 400, 98, 400, 138, 400, 400, 209, 400, 371, 222, 191, 400, 383, 184, 193, 400, 400, 292, 400, 400, 400, 197, 126, 200, 155, 104, 177, 63, 329, 167, 387, 140, 125, 287, 400, 400, 149, 104, 157, 108, 103, 400, 344, 114, 400, 110, 400, 153, 400, 400, 133, 256, 262, 113, 93, 392, 162, 357, 109, 58, 107, 59, 88, 49, 229, 283, 400, 101, 102, 135, 207, 400, 163, 145, 193, 189, 344]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19770587561584926, "mean_inference_ms": 0.6178517753157147, "mean_action_processing_ms": 0.06837585441913721, "mean_env_wait_ms": 6.089486758673551, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005080699920654297, "StateBufferConnector_ms": 0.0031816959381103516, "ViewRequirementAgentConnector_ms": 0.0732884407043457}}, "episode_reward_max": -3.799999999999999, "episode_reward_min": -69.40000000000042, "episode_reward_mean": -34.13500000000013, "episode_len_mean": 261.64, "episodes_this_iter": 20, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-54.40000000000025, -57.900000000000404, -55.30000000000044, -18.600000000000005, -55.700000000000394, -7.199999999999987, -60.100000000000435, -67.10000000000035, -50.00000000000029, -43.50000000000011, -68.7000000000004, -52.10000000000028, -12.699999999999967, -51.10000000000035, -49.900000000000226, -42.40000000000009, -23.400000000000034, -63.400000000000446, -61.800000000000345, -63.1000000000004, -34.30000000000002, -62.6000000000004, -56.200000000000294, -50.100000000000286, -8.699999999999982, -54.30000000000039, -14.099999999999973, -54.400000000000276, -59.500000000000355, -27.400000000000002, -57.100000000000314, -47.90000000000022, -23.000000000000004, -20.00000000000001, -43.0000000000003, -60.300000000000345, -21.5, -24.69999999999996, -61.60000000000037, -64.60000000000038, -36.10000000000005, -69.40000000000042, -65.40000000000038, -59.0000000000003, -20.80000000000004, -14.399999999999965, -23.400000000000013, -19.59999999999997, -10.599999999999975, -21.199999999999992, -5.2999999999999945, -46.100000000000186, -16.999999999999975, -53.70000000000026, -15.599999999999966, -12.499999999999968, -41.200000000000074, -49.40000000000028, -53.8000000000003, -13.799999999999963, -9.999999999999977, -19.899999999999963, -11.09999999999998, -9.19999999999998, -62.20000000000046, -44.300000000000296, -13.199999999999973, -51.70000000000029, -12.49999999999998, -45.500000000000284, -14.399999999999963, -55.100000000000264, -52.900000000000304, -14.399999999999965, -26.500000000000107, -29.40000000000001, -11.599999999999977, -8.199999999999983, -58.00000000000037, -16.099999999999962, -48.20000000000019, -9.799999999999978, -4.699999999999996, -9.599999999999978, -4.799999999999995, -7.699999999999985, -3.799999999999999, -23.900000000000027, -29.20000000000011, -47.70000000000019, -8.99999999999998, -9.09999999999998, -12.399999999999968, -21.900000000000023, -43.100000000000335, -15.19999999999996, -15.599999999999962, -22.099999999999945, -18.200000000000003, -39.30000000000021], "episode_lengths": [393, 400, 379, 176, 400, 83, 400, 400, 400, 318, 400, 400, 129, 400, 330, 292, 204, 400, 400, 400, 251, 400, 400, 400, 98, 400, 138, 400, 400, 209, 400, 371, 222, 191, 400, 383, 184, 193, 400, 400, 292, 400, 400, 400, 197, 126, 200, 155, 104, 177, 63, 329, 167, 387, 140, 125, 287, 400, 400, 149, 104, 157, 108, 103, 400, 344, 114, 400, 110, 400, 153, 400, 400, 133, 256, 262, 113, 93, 392, 162, 357, 109, 58, 107, 59, 88, 49, 229, 283, 400, 101, 102, 135, 207, 400, 163, 145, 193, 189, 344]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19770587561584926, "mean_inference_ms": 0.6178517753157147, "mean_action_processing_ms": 0.06837585441913721, "mean_env_wait_ms": 6.089486758673551, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005080699920654297, "StateBufferConnector_ms": 0.0031816959381103516, "ViewRequirementAgentConnector_ms": 0.0732884407043457}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 28000, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 378.35950419643933, "num_env_steps_trained_throughput_per_sec": 378.35950419643933, "timesteps_total": 28000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 28000, "timers": {"training_iteration_time_ms": 10573.284, "sample_time_ms": 7067.975, "load_time_ms": 0.934, "load_throughput": 4283804.924, "learn_time_ms": 3502.028, "learn_throughput": 1142.195, "synch_weights_time_ms": 1.711}, "counters": {"num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 28000}, "done": false, "episodes_total": 104, "training_iteration": 7, "trial_id": "329fa_00000", "date": "2024-03-07_12-23-17", "timestamp": 1709832197, "time_this_iter_s": 10.574151039123535, "time_total_s": 74.02838158607483, "pid": 105400, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fcd19c36f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 74.02838158607483, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 19.249999999999996, "ram_util_percent": 43.5, "gpu_util_percent0": 0.08857142857142856, "vram_util_percent0": 0.1005859375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.10000000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 5.929068711816623, "policy_loss": -0.012739498032036648, "vf_loss": 5.941029414438432, "vf_explained_var": -0.4434403616254048, "kl": 0.007787990556003689, "entropy": 1.0132686329144303, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 6975.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000}, "sampler_results": {"episode_reward_max": -3.799999999999999, "episode_reward_min": -69.40000000000042, "episode_reward_mean": -30.421000000000113, "episode_len_mean": 243.04, "episode_media": {}, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-23.400000000000034, -63.400000000000446, -61.800000000000345, -63.1000000000004, -34.30000000000002, -62.6000000000004, -56.200000000000294, -50.100000000000286, -8.699999999999982, -54.30000000000039, -14.099999999999973, -54.400000000000276, -59.500000000000355, -27.400000000000002, -57.100000000000314, -47.90000000000022, -23.000000000000004, -20.00000000000001, -43.0000000000003, -60.300000000000345, -21.5, -24.69999999999996, -61.60000000000037, -64.60000000000038, -36.10000000000005, -69.40000000000042, -65.40000000000038, -59.0000000000003, -20.80000000000004, -14.399999999999965, -23.400000000000013, -19.59999999999997, -10.599999999999975, -21.199999999999992, -5.2999999999999945, -46.100000000000186, -16.999999999999975, -53.70000000000026, -15.599999999999966, -12.499999999999968, -41.200000000000074, -49.40000000000028, -53.8000000000003, -13.799999999999963, -9.999999999999977, -19.899999999999963, -11.09999999999998, -9.19999999999998, -62.20000000000046, -44.300000000000296, -13.199999999999973, -51.70000000000029, -12.49999999999998, -45.500000000000284, -14.399999999999963, -55.100000000000264, -52.900000000000304, -14.399999999999965, -26.500000000000107, -29.40000000000001, -11.599999999999977, -8.199999999999983, -58.00000000000037, -16.099999999999962, -48.20000000000019, -9.799999999999978, -4.699999999999996, -9.599999999999978, -4.799999999999995, -7.699999999999985, -3.799999999999999, -23.900000000000027, -29.20000000000011, -47.70000000000019, -8.99999999999998, -9.09999999999998, -12.399999999999968, -21.900000000000023, -43.100000000000335, -15.19999999999996, -15.599999999999962, -22.099999999999945, -18.200000000000003, -39.30000000000021, -8.699999999999982, -54.3000000000004, -9.799999999999978, -16.799999999999983, -4.4999999999999964, -46.80000000000024, -17.29999999999998, -8.799999999999983, -39.800000000000225, -8.699999999999982, -15.999999999999972, -20.60000000000003, -17.399999999999984, -38.30000000000022, -25.40000000000003, -42.10000000000031], "episode_lengths": [204, 400, 400, 400, 251, 400, 400, 400, 98, 400, 138, 400, 400, 209, 400, 371, 222, 191, 400, 383, 184, 193, 400, 400, 292, 400, 400, 400, 197, 126, 200, 155, 104, 177, 63, 329, 167, 387, 140, 125, 287, 400, 400, 149, 104, 157, 108, 103, 400, 344, 114, 400, 110, 400, 153, 400, 400, 133, 256, 262, 113, 93, 392, 162, 357, 109, 58, 107, 59, 88, 49, 229, 283, 400, 101, 102, 135, 207, 400, 163, 145, 193, 189, 344, 82, 400, 109, 179, 56, 400, 177, 93, 385, 98, 138, 210, 171, 323, 219, 400]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19846216071545392, "mean_inference_ms": 0.6172959709640379, "mean_action_processing_ms": 0.06823239438000737, "mean_env_wait_ms": 6.078256792103702, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0050106048583984375, "StateBufferConnector_ms": 0.0031890869140625, "ViewRequirementAgentConnector_ms": 0.07364463806152344}}, "episode_reward_max": -3.799999999999999, "episode_reward_min": -69.40000000000042, "episode_reward_mean": -30.421000000000113, "episode_len_mean": 243.04, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-23.400000000000034, -63.400000000000446, -61.800000000000345, -63.1000000000004, -34.30000000000002, -62.6000000000004, -56.200000000000294, -50.100000000000286, -8.699999999999982, -54.30000000000039, -14.099999999999973, -54.400000000000276, -59.500000000000355, -27.400000000000002, -57.100000000000314, -47.90000000000022, -23.000000000000004, -20.00000000000001, -43.0000000000003, -60.300000000000345, -21.5, -24.69999999999996, -61.60000000000037, -64.60000000000038, -36.10000000000005, -69.40000000000042, -65.40000000000038, -59.0000000000003, -20.80000000000004, -14.399999999999965, -23.400000000000013, -19.59999999999997, -10.599999999999975, -21.199999999999992, -5.2999999999999945, -46.100000000000186, -16.999999999999975, -53.70000000000026, -15.599999999999966, -12.499999999999968, -41.200000000000074, -49.40000000000028, -53.8000000000003, -13.799999999999963, -9.999999999999977, -19.899999999999963, -11.09999999999998, -9.19999999999998, -62.20000000000046, -44.300000000000296, -13.199999999999973, -51.70000000000029, -12.49999999999998, -45.500000000000284, -14.399999999999963, -55.100000000000264, -52.900000000000304, -14.399999999999965, -26.500000000000107, -29.40000000000001, -11.599999999999977, -8.199999999999983, -58.00000000000037, -16.099999999999962, -48.20000000000019, -9.799999999999978, -4.699999999999996, -9.599999999999978, -4.799999999999995, -7.699999999999985, -3.799999999999999, -23.900000000000027, -29.20000000000011, -47.70000000000019, -8.99999999999998, -9.09999999999998, -12.399999999999968, -21.900000000000023, -43.100000000000335, -15.19999999999996, -15.599999999999962, -22.099999999999945, -18.200000000000003, -39.30000000000021, -8.699999999999982, -54.3000000000004, -9.799999999999978, -16.799999999999983, -4.4999999999999964, -46.80000000000024, -17.29999999999998, -8.799999999999983, -39.800000000000225, -8.699999999999982, -15.999999999999972, -20.60000000000003, -17.399999999999984, -38.30000000000022, -25.40000000000003, -42.10000000000031], "episode_lengths": [204, 400, 400, 400, 251, 400, 400, 400, 98, 400, 138, 400, 400, 209, 400, 371, 222, 191, 400, 383, 184, 193, 400, 400, 292, 400, 400, 400, 197, 126, 200, 155, 104, 177, 63, 329, 167, 387, 140, 125, 287, 400, 400, 149, 104, 157, 108, 103, 400, 344, 114, 400, 110, 400, 153, 400, 400, 133, 256, 262, 113, 93, 392, 162, 357, 109, 58, 107, 59, 88, 49, 229, 283, 400, 101, 102, 135, 207, 400, 163, 145, 193, 189, 344, 82, 400, 109, 179, 56, 400, 177, 93, 385, 98, 138, 210, 171, 323, 219, 400]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19846216071545392, "mean_inference_ms": 0.6172959709640379, "mean_action_processing_ms": 0.06823239438000737, "mean_env_wait_ms": 6.078256792103702, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0050106048583984375, "StateBufferConnector_ms": 0.0031890869140625, "ViewRequirementAgentConnector_ms": 0.07364463806152344}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 380.47790012466913, "num_env_steps_trained_throughput_per_sec": 380.47790012466913, "timesteps_total": 32000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 32000, "timers": {"training_iteration_time_ms": 10565.757, "sample_time_ms": 7058.845, "load_time_ms": 0.937, "load_throughput": 4269554.905, "learn_time_ms": 3503.646, "learn_throughput": 1141.668, "synch_weights_time_ms": 1.698}, "counters": {"num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000}, "done": false, "episodes_total": 120, "training_iteration": 8, "trial_id": "329fa_00000", "date": "2024-03-07_12-23-27", "timestamp": 1709832207, "time_this_iter_s": 10.515133619308472, "time_total_s": 84.5435152053833, "pid": 105400, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fcd19c36f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 84.5435152053833, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 19.25, "ram_util_percent": 43.50714285714286, "gpu_util_percent0": 0.08357142857142856, "vram_util_percent0": 0.1005859375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.10000000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 5.4416903288454135, "policy_loss": -0.007858977989564019, "vf_loss": 5.448822041160317, "vf_explained_var": -0.17826315100475024, "kl": 0.007272597319223786, "entropy": 1.0134711184168375, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 7905.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000}, "sampler_results": {"episode_reward_max": -3.799999999999999, "episode_reward_min": -69.40000000000042, "episode_reward_mean": -25.584000000000078, "episode_len_mean": 218.59, "episode_media": {}, "episodes_this_iter": 23, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-64.60000000000038, -36.10000000000005, -69.40000000000042, -65.40000000000038, -59.0000000000003, -20.80000000000004, -14.399999999999965, -23.400000000000013, -19.59999999999997, -10.599999999999975, -21.199999999999992, -5.2999999999999945, -46.100000000000186, -16.999999999999975, -53.70000000000026, -15.599999999999966, -12.499999999999968, -41.200000000000074, -49.40000000000028, -53.8000000000003, -13.799999999999963, -9.999999999999977, -19.899999999999963, -11.09999999999998, -9.19999999999998, -62.20000000000046, -44.300000000000296, -13.199999999999973, -51.70000000000029, -12.49999999999998, -45.500000000000284, -14.399999999999963, -55.100000000000264, -52.900000000000304, -14.399999999999965, -26.500000000000107, -29.40000000000001, -11.599999999999977, -8.199999999999983, -58.00000000000037, -16.099999999999962, -48.20000000000019, -9.799999999999978, -4.699999999999996, -9.599999999999978, -4.799999999999995, -7.699999999999985, -3.799999999999999, -23.900000000000027, -29.20000000000011, -47.70000000000019, -8.99999999999998, -9.09999999999998, -12.399999999999968, -21.900000000000023, -43.100000000000335, -15.19999999999996, -15.599999999999962, -22.099999999999945, -18.200000000000003, -39.30000000000021, -8.699999999999982, -54.3000000000004, -9.799999999999978, -16.799999999999983, -4.4999999999999964, -46.80000000000024, -17.29999999999998, -8.799999999999983, -39.800000000000225, -8.699999999999982, -15.999999999999972, -20.60000000000003, -17.399999999999984, -38.30000000000022, -25.40000000000003, -42.10000000000031, -33.700000000000095, -11.899999999999972, -5.199999999999994, -23.200000000000003, -11.899999999999977, -8.199999999999983, -20.50000000000003, -5.499999999999993, -35.300000000000196, -30.200000000000063, -21.40000000000005, -8.599999999999982, -34.30000000000011, -43.70000000000028, -7.999999999999984, -7.099999999999989, -10.699999999999974, -28.00000000000003, -33.20000000000017, -47.4000000000002, -43.40000000000032, -16.499999999999986, -20.799999999999997], "episode_lengths": [400, 292, 400, 400, 400, 197, 126, 200, 155, 104, 177, 63, 329, 167, 387, 140, 125, 287, 400, 400, 149, 104, 157, 108, 103, 400, 344, 114, 400, 110, 400, 153, 400, 400, 133, 256, 262, 113, 93, 392, 162, 357, 109, 58, 107, 59, 88, 49, 229, 283, 400, 101, 102, 135, 207, 400, 163, 145, 193, 189, 344, 82, 400, 109, 179, 56, 400, 177, 93, 385, 98, 138, 210, 171, 323, 219, 400, 309, 122, 63, 223, 121, 93, 187, 66, 333, 256, 225, 97, 302, 400, 91, 81, 117, 237, 318, 400, 400, 163, 195]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20020144847557145, "mean_inference_ms": 0.6174247793621709, "mean_action_processing_ms": 0.06819054640491538, "mean_env_wait_ms": 6.070209968350027, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0050127506256103516, "StateBufferConnector_ms": 0.0031783580780029297, "ViewRequirementAgentConnector_ms": 0.07375955581665039}}, "episode_reward_max": -3.799999999999999, "episode_reward_min": -69.40000000000042, "episode_reward_mean": -25.584000000000078, "episode_len_mean": 218.59, "episodes_this_iter": 23, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-64.60000000000038, -36.10000000000005, -69.40000000000042, -65.40000000000038, -59.0000000000003, -20.80000000000004, -14.399999999999965, -23.400000000000013, -19.59999999999997, -10.599999999999975, -21.199999999999992, -5.2999999999999945, -46.100000000000186, -16.999999999999975, -53.70000000000026, -15.599999999999966, -12.499999999999968, -41.200000000000074, -49.40000000000028, -53.8000000000003, -13.799999999999963, -9.999999999999977, -19.899999999999963, -11.09999999999998, -9.19999999999998, -62.20000000000046, -44.300000000000296, -13.199999999999973, -51.70000000000029, -12.49999999999998, -45.500000000000284, -14.399999999999963, -55.100000000000264, -52.900000000000304, -14.399999999999965, -26.500000000000107, -29.40000000000001, -11.599999999999977, -8.199999999999983, -58.00000000000037, -16.099999999999962, -48.20000000000019, -9.799999999999978, -4.699999999999996, -9.599999999999978, -4.799999999999995, -7.699999999999985, -3.799999999999999, -23.900000000000027, -29.20000000000011, -47.70000000000019, -8.99999999999998, -9.09999999999998, -12.399999999999968, -21.900000000000023, -43.100000000000335, -15.19999999999996, -15.599999999999962, -22.099999999999945, -18.200000000000003, -39.30000000000021, -8.699999999999982, -54.3000000000004, -9.799999999999978, -16.799999999999983, -4.4999999999999964, -46.80000000000024, -17.29999999999998, -8.799999999999983, -39.800000000000225, -8.699999999999982, -15.999999999999972, -20.60000000000003, -17.399999999999984, -38.30000000000022, -25.40000000000003, -42.10000000000031, -33.700000000000095, -11.899999999999972, -5.199999999999994, -23.200000000000003, -11.899999999999977, -8.199999999999983, -20.50000000000003, -5.499999999999993, -35.300000000000196, -30.200000000000063, -21.40000000000005, -8.599999999999982, -34.30000000000011, -43.70000000000028, -7.999999999999984, -7.099999999999989, -10.699999999999974, -28.00000000000003, -33.20000000000017, -47.4000000000002, -43.40000000000032, -16.499999999999986, -20.799999999999997], "episode_lengths": [400, 292, 400, 400, 400, 197, 126, 200, 155, 104, 177, 63, 329, 167, 387, 140, 125, 287, 400, 400, 149, 104, 157, 108, 103, 400, 344, 114, 400, 110, 400, 153, 400, 400, 133, 256, 262, 113, 93, 392, 162, 357, 109, 58, 107, 59, 88, 49, 229, 283, 400, 101, 102, 135, 207, 400, 163, 145, 193, 189, 344, 82, 400, 109, 179, 56, 400, 177, 93, 385, 98, 138, 210, 171, 323, 219, 400, 309, 122, 63, 223, 121, 93, 187, 66, 333, 256, 225, 97, 302, 400, 91, 81, 117, 237, 318, 400, 400, 163, 195]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20020144847557145, "mean_inference_ms": 0.6174247793621709, "mean_action_processing_ms": 0.06819054640491538, "mean_env_wait_ms": 6.070209968350027, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0050127506256103516, "StateBufferConnector_ms": 0.0031783580780029297, "ViewRequirementAgentConnector_ms": 0.07375955581665039}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 381.2530102795187, "num_env_steps_trained_throughput_per_sec": 381.2530102795187, "timesteps_total": 36000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 36000, "timers": {"training_iteration_time_ms": 10557.527, "sample_time_ms": 7050.738, "load_time_ms": 0.938, "load_throughput": 4265755.403, "learn_time_ms": 3503.519, "learn_throughput": 1141.709, "synch_weights_time_ms": 1.701}, "counters": {"num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000}, "done": false, "episodes_total": 143, "training_iteration": 9, "trial_id": "329fa_00000", "date": "2024-03-07_12-23-38", "timestamp": 1709832218, "time_this_iter_s": 10.494531154632568, "time_total_s": 95.03804636001587, "pid": 105400, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fcd19c36f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 95.03804636001587, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 19.12142857142857, "ram_util_percent": 43.5, "gpu_util_percent0": 0.08714285714285715, "vram_util_percent0": 0.1005859375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.10000000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 5.2122200819974145, "policy_loss": 0.0030336267324865504, "vf_loss": 5.208565732548314, "vf_explained_var": 0.0041207835879377135, "kl": 0.00620695088074525, "entropy": 1.0086125628922575, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 8835.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000}, "sampler_results": {"episode_reward_max": -3.799999999999999, "episode_reward_min": -62.20000000000046, "episode_reward_mean": -22.291000000000064, "episode_len_mean": 201.78, "episode_media": {}, "episodes_this_iter": 21, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-9.999999999999977, -19.899999999999963, -11.09999999999998, -9.19999999999998, -62.20000000000046, -44.300000000000296, -13.199999999999973, -51.70000000000029, -12.49999999999998, -45.500000000000284, -14.399999999999963, -55.100000000000264, -52.900000000000304, -14.399999999999965, -26.500000000000107, -29.40000000000001, -11.599999999999977, -8.199999999999983, -58.00000000000037, -16.099999999999962, -48.20000000000019, -9.799999999999978, -4.699999999999996, -9.599999999999978, -4.799999999999995, -7.699999999999985, -3.799999999999999, -23.900000000000027, -29.20000000000011, -47.70000000000019, -8.99999999999998, -9.09999999999998, -12.399999999999968, -21.900000000000023, -43.100000000000335, -15.19999999999996, -15.599999999999962, -22.099999999999945, -18.200000000000003, -39.30000000000021, -8.699999999999982, -54.3000000000004, -9.799999999999978, -16.799999999999983, -4.4999999999999964, -46.80000000000024, -17.29999999999998, -8.799999999999983, -39.800000000000225, -8.699999999999982, -15.999999999999972, -20.60000000000003, -17.399999999999984, -38.30000000000022, -25.40000000000003, -42.10000000000031, -33.700000000000095, -11.899999999999972, -5.199999999999994, -23.200000000000003, -11.899999999999977, -8.199999999999983, -20.50000000000003, -5.499999999999993, -35.300000000000196, -30.200000000000063, -21.40000000000005, -8.599999999999982, -34.30000000000011, -43.70000000000028, -7.999999999999984, -7.099999999999989, -10.699999999999974, -28.00000000000003, -33.20000000000017, -47.4000000000002, -43.40000000000032, -16.499999999999986, -20.799999999999997, -33.5000000000001, -12.599999999999968, -13.199999999999966, -11.099999999999973, -13.399999999999965, -10.19999999999998, -10.899999999999974, -53.60000000000023, -33.20000000000015, -9.79999999999998, -11.599999999999971, -16.899999999999967, -46.20000000000034, -26.900000000000063, -23.800000000000047, -6.999999999999988, -14.299999999999963, -7.399999999999986, -9.899999999999977, -11.69999999999997, -6.39999999999999], "episode_lengths": [104, 157, 108, 103, 400, 344, 114, 400, 110, 400, 153, 400, 400, 133, 256, 262, 113, 93, 392, 162, 357, 109, 58, 107, 59, 88, 49, 229, 283, 400, 101, 102, 135, 207, 400, 163, 145, 193, 189, 344, 82, 400, 109, 179, 56, 400, 177, 93, 385, 98, 138, 210, 171, 323, 219, 400, 309, 122, 63, 223, 121, 93, 187, 66, 333, 256, 225, 97, 302, 400, 91, 81, 117, 237, 318, 400, 400, 163, 195, 298, 127, 136, 117, 145, 107, 114, 400, 303, 97, 127, 149, 400, 256, 228, 81, 141, 85, 110, 121, 75]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2014023708062659, "mean_inference_ms": 0.617542244613475, "mean_action_processing_ms": 0.06817509803746978, "mean_env_wait_ms": 6.0646934043773335, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00493931770324707, "StateBufferConnector_ms": 0.0031659603118896484, "ViewRequirementAgentConnector_ms": 0.0737159252166748}}, "episode_reward_max": -3.799999999999999, "episode_reward_min": -62.20000000000046, "episode_reward_mean": -22.291000000000064, "episode_len_mean": 201.78, "episodes_this_iter": 21, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-9.999999999999977, -19.899999999999963, -11.09999999999998, -9.19999999999998, -62.20000000000046, -44.300000000000296, -13.199999999999973, -51.70000000000029, -12.49999999999998, -45.500000000000284, -14.399999999999963, -55.100000000000264, -52.900000000000304, -14.399999999999965, -26.500000000000107, -29.40000000000001, -11.599999999999977, -8.199999999999983, -58.00000000000037, -16.099999999999962, -48.20000000000019, -9.799999999999978, -4.699999999999996, -9.599999999999978, -4.799999999999995, -7.699999999999985, -3.799999999999999, -23.900000000000027, -29.20000000000011, -47.70000000000019, -8.99999999999998, -9.09999999999998, -12.399999999999968, -21.900000000000023, -43.100000000000335, -15.19999999999996, -15.599999999999962, -22.099999999999945, -18.200000000000003, -39.30000000000021, -8.699999999999982, -54.3000000000004, -9.799999999999978, -16.799999999999983, -4.4999999999999964, -46.80000000000024, -17.29999999999998, -8.799999999999983, -39.800000000000225, -8.699999999999982, -15.999999999999972, -20.60000000000003, -17.399999999999984, -38.30000000000022, -25.40000000000003, -42.10000000000031, -33.700000000000095, -11.899999999999972, -5.199999999999994, -23.200000000000003, -11.899999999999977, -8.199999999999983, -20.50000000000003, -5.499999999999993, -35.300000000000196, -30.200000000000063, -21.40000000000005, -8.599999999999982, -34.30000000000011, -43.70000000000028, -7.999999999999984, -7.099999999999989, -10.699999999999974, -28.00000000000003, -33.20000000000017, -47.4000000000002, -43.40000000000032, -16.499999999999986, -20.799999999999997, -33.5000000000001, -12.599999999999968, -13.199999999999966, -11.099999999999973, -13.399999999999965, -10.19999999999998, -10.899999999999974, -53.60000000000023, -33.20000000000015, -9.79999999999998, -11.599999999999971, -16.899999999999967, -46.20000000000034, -26.900000000000063, -23.800000000000047, -6.999999999999988, -14.299999999999963, -7.399999999999986, -9.899999999999977, -11.69999999999997, -6.39999999999999], "episode_lengths": [104, 157, 108, 103, 400, 344, 114, 400, 110, 400, 153, 400, 400, 133, 256, 262, 113, 93, 392, 162, 357, 109, 58, 107, 59, 88, 49, 229, 283, 400, 101, 102, 135, 207, 400, 163, 145, 193, 189, 344, 82, 400, 109, 179, 56, 400, 177, 93, 385, 98, 138, 210, 171, 323, 219, 400, 309, 122, 63, 223, 121, 93, 187, 66, 333, 256, 225, 97, 302, 400, 91, 81, 117, 237, 318, 400, 400, 163, 195, 298, 127, 136, 117, 145, 107, 114, 400, 303, 97, 127, 149, 400, 256, 228, 81, 141, 85, 110, 121, 75]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2014023708062659, "mean_inference_ms": 0.617542244613475, "mean_action_processing_ms": 0.06817509803746978, "mean_env_wait_ms": 6.0646934043773335, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00493931770324707, "StateBufferConnector_ms": 0.0031659603118896484, "ViewRequirementAgentConnector_ms": 0.0737159252166748}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 376.0901222009281, "num_env_steps_trained_throughput_per_sec": 376.0901222009281, "timesteps_total": 40000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 40000, "timers": {"training_iteration_time_ms": 10565.345, "sample_time_ms": 7056.689, "load_time_ms": 0.939, "load_throughput": 4261854.392, "learn_time_ms": 3505.379, "learn_throughput": 1141.104, "synch_weights_time_ms": 1.707}, "counters": {"num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000}, "done": false, "episodes_total": 164, "training_iteration": 10, "trial_id": "329fa_00000", "date": "2024-03-07_12-23-48", "timestamp": 1709832228, "time_this_iter_s": 10.637838363647461, "time_total_s": 105.67588472366333, "pid": 105400, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fcd19c36f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 105.67588472366333, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 21.23076923076923, "ram_util_percent": 43.5, "gpu_util_percent0": 0.07615384615384616, "vram_util_percent0": 0.1005859375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.10000000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 5.6465622769248105, "policy_loss": -0.007771130775411924, "vf_loss": 5.653625677349747, "vf_explained_var": -0.11696992413972014, "kl": 0.007077558551193097, "entropy": 1.0008165651752103, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 9765.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_agent_steps_sampled": 44000, "num_agent_steps_trained": 44000}, "sampler_results": {"episode_reward_max": -3.799999999999999, "episode_reward_min": -54.3000000000004, "episode_reward_mean": -20.458000000000048, "episode_len_mean": 192.29, "episode_media": {}, "episodes_this_iter": 21, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-9.799999999999978, -4.699999999999996, -9.599999999999978, -4.799999999999995, -7.699999999999985, -3.799999999999999, -23.900000000000027, -29.20000000000011, -47.70000000000019, -8.99999999999998, -9.09999999999998, -12.399999999999968, -21.900000000000023, -43.100000000000335, -15.19999999999996, -15.599999999999962, -22.099999999999945, -18.200000000000003, -39.30000000000021, -8.699999999999982, -54.3000000000004, -9.799999999999978, -16.799999999999983, -4.4999999999999964, -46.80000000000024, -17.29999999999998, -8.799999999999983, -39.800000000000225, -8.699999999999982, -15.999999999999972, -20.60000000000003, -17.399999999999984, -38.30000000000022, -25.40000000000003, -42.10000000000031, -33.700000000000095, -11.899999999999972, -5.199999999999994, -23.200000000000003, -11.899999999999977, -8.199999999999983, -20.50000000000003, -5.499999999999993, -35.300000000000196, -30.200000000000063, -21.40000000000005, -8.599999999999982, -34.30000000000011, -43.70000000000028, -7.999999999999984, -7.099999999999989, -10.699999999999974, -28.00000000000003, -33.20000000000017, -47.4000000000002, -43.40000000000032, -16.499999999999986, -20.799999999999997, -33.5000000000001, -12.599999999999968, -13.199999999999966, -11.099999999999973, -13.399999999999965, -10.19999999999998, -10.899999999999974, -53.60000000000023, -33.20000000000015, -9.79999999999998, -11.599999999999971, -16.899999999999967, -46.20000000000034, -26.900000000000063, -23.800000000000047, -6.999999999999988, -14.299999999999963, -7.399999999999986, -9.899999999999977, -11.69999999999997, -6.39999999999999, -33.500000000000156, -29.700000000000145, -21.29999999999998, -32.300000000000075, -38.700000000000045, -35.30000000000007, -10.199999999999976, -12.199999999999969, -12.499999999999968, -10.999999999999973, -35.10000000000011, -8.699999999999982, -13.699999999999966, -6.699999999999989, -23.60000000000006, -24.000000000000057, -9.399999999999979, -6.39999999999999, -10.999999999999973, -48.400000000000226, -7.399999999999986], "episode_lengths": [109, 58, 107, 59, 88, 49, 229, 283, 400, 101, 102, 135, 207, 400, 163, 145, 193, 189, 344, 82, 400, 109, 179, 56, 400, 177, 93, 385, 98, 138, 210, 171, 323, 219, 400, 309, 122, 63, 223, 121, 93, 187, 66, 333, 256, 225, 97, 302, 400, 91, 81, 117, 237, 318, 400, 400, 163, 195, 298, 127, 136, 117, 145, 107, 114, 400, 303, 97, 127, 149, 400, 256, 228, 81, 141, 85, 110, 121, 75, 321, 285, 199, 282, 302, 285, 113, 125, 136, 121, 303, 98, 136, 78, 227, 216, 105, 74, 121, 400, 85]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20242970743149474, "mean_inference_ms": 0.6182577761973195, "mean_action_processing_ms": 0.06823841965674304, "mean_env_wait_ms": 6.063014223167317, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004887819290161133, "StateBufferConnector_ms": 0.0031561851501464844, "ViewRequirementAgentConnector_ms": 0.07358670234680176}}, "episode_reward_max": -3.799999999999999, "episode_reward_min": -54.3000000000004, "episode_reward_mean": -20.458000000000048, "episode_len_mean": 192.29, "episodes_this_iter": 21, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-9.799999999999978, -4.699999999999996, -9.599999999999978, -4.799999999999995, -7.699999999999985, -3.799999999999999, -23.900000000000027, -29.20000000000011, -47.70000000000019, -8.99999999999998, -9.09999999999998, -12.399999999999968, -21.900000000000023, -43.100000000000335, -15.19999999999996, -15.599999999999962, -22.099999999999945, -18.200000000000003, -39.30000000000021, -8.699999999999982, -54.3000000000004, -9.799999999999978, -16.799999999999983, -4.4999999999999964, -46.80000000000024, -17.29999999999998, -8.799999999999983, -39.800000000000225, -8.699999999999982, -15.999999999999972, -20.60000000000003, -17.399999999999984, -38.30000000000022, -25.40000000000003, -42.10000000000031, -33.700000000000095, -11.899999999999972, -5.199999999999994, -23.200000000000003, -11.899999999999977, -8.199999999999983, -20.50000000000003, -5.499999999999993, -35.300000000000196, -30.200000000000063, -21.40000000000005, -8.599999999999982, -34.30000000000011, -43.70000000000028, -7.999999999999984, -7.099999999999989, -10.699999999999974, -28.00000000000003, -33.20000000000017, -47.4000000000002, -43.40000000000032, -16.499999999999986, -20.799999999999997, -33.5000000000001, -12.599999999999968, -13.199999999999966, -11.099999999999973, -13.399999999999965, -10.19999999999998, -10.899999999999974, -53.60000000000023, -33.20000000000015, -9.79999999999998, -11.599999999999971, -16.899999999999967, -46.20000000000034, -26.900000000000063, -23.800000000000047, -6.999999999999988, -14.299999999999963, -7.399999999999986, -9.899999999999977, -11.69999999999997, -6.39999999999999, -33.500000000000156, -29.700000000000145, -21.29999999999998, -32.300000000000075, -38.700000000000045, -35.30000000000007, -10.199999999999976, -12.199999999999969, -12.499999999999968, -10.999999999999973, -35.10000000000011, -8.699999999999982, -13.699999999999966, -6.699999999999989, -23.60000000000006, -24.000000000000057, -9.399999999999979, -6.39999999999999, -10.999999999999973, -48.400000000000226, -7.399999999999986], "episode_lengths": [109, 58, 107, 59, 88, 49, 229, 283, 400, 101, 102, 135, 207, 400, 163, 145, 193, 189, 344, 82, 400, 109, 179, 56, 400, 177, 93, 385, 98, 138, 210, 171, 323, 219, 400, 309, 122, 63, 223, 121, 93, 187, 66, 333, 256, 225, 97, 302, 400, 91, 81, 117, 237, 318, 400, 400, 163, 195, 298, 127, 136, 117, 145, 107, 114, 400, 303, 97, 127, 149, 400, 256, 228, 81, 141, 85, 110, 121, 75, 321, 285, 199, 282, 302, 285, 113, 125, 136, 121, 303, 98, 136, 78, 227, 216, 105, 74, 121, 400, 85]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20242970743149474, "mean_inference_ms": 0.6182577761973195, "mean_action_processing_ms": 0.06823841965674304, "mean_env_wait_ms": 6.063014223167317, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004887819290161133, "StateBufferConnector_ms": 0.0031561851501464844, "ViewRequirementAgentConnector_ms": 0.07358670234680176}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 44000, "num_agent_steps_trained": 44000, "num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 375.960241455827, "num_env_steps_trained_throughput_per_sec": 375.960241455827, "timesteps_total": 44000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 44000, "timers": {"training_iteration_time_ms": 10562.024, "sample_time_ms": 7043.944, "load_time_ms": 0.947, "load_throughput": 4223871.098, "learn_time_ms": 3514.839, "learn_throughput": 1138.032, "synch_weights_time_ms": 1.679}, "counters": {"num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_agent_steps_sampled": 44000, "num_agent_steps_trained": 44000}, "done": false, "episodes_total": 185, "training_iteration": 11, "trial_id": "329fa_00000", "date": "2024-03-07_12-23-59", "timestamp": 1709832239, "time_this_iter_s": 10.64186954498291, "time_total_s": 116.31775426864624, "pid": 105400, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fcd19c36f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 116.31775426864624, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 19.178571428571427, "ram_util_percent": 43.5, "gpu_util_percent0": 0.08571428571428572, "vram_util_percent0": 0.1005859375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.10000000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 4.867346425146185, "policy_loss": -0.012153101686929022, "vf_loss": 4.878585634628932, "vf_explained_var": 0.0741951459838498, "kl": 0.009138958146767583, "entropy": 1.0073770422448394, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 10695.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000}, "sampler_results": {"episode_reward_max": -5.199999999999994, "episode_reward_min": -53.60000000000023, "episode_reward_mean": -19.509000000000036, "episode_len_mean": 184.48, "episode_media": {}, "episodes_this_iter": 27, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-39.800000000000225, -8.699999999999982, -15.999999999999972, -20.60000000000003, -17.399999999999984, -38.30000000000022, -25.40000000000003, -42.10000000000031, -33.700000000000095, -11.899999999999972, -5.199999999999994, -23.200000000000003, -11.899999999999977, -8.199999999999983, -20.50000000000003, -5.499999999999993, -35.300000000000196, -30.200000000000063, -21.40000000000005, -8.599999999999982, -34.30000000000011, -43.70000000000028, -7.999999999999984, -7.099999999999989, -10.699999999999974, -28.00000000000003, -33.20000000000017, -47.4000000000002, -43.40000000000032, -16.499999999999986, -20.799999999999997, -33.5000000000001, -12.599999999999968, -13.199999999999966, -11.099999999999973, -13.399999999999965, -10.19999999999998, -10.899999999999974, -53.60000000000023, -33.20000000000015, -9.79999999999998, -11.599999999999971, -16.899999999999967, -46.20000000000034, -26.900000000000063, -23.800000000000047, -6.999999999999988, -14.299999999999963, -7.399999999999986, -9.899999999999977, -11.69999999999997, -6.39999999999999, -33.500000000000156, -29.700000000000145, -21.29999999999998, -32.300000000000075, -38.700000000000045, -35.30000000000007, -10.199999999999976, -12.199999999999969, -12.499999999999968, -10.999999999999973, -35.10000000000011, -8.699999999999982, -13.699999999999966, -6.699999999999989, -23.60000000000006, -24.000000000000057, -9.399999999999979, -6.39999999999999, -10.999999999999973, -48.400000000000226, -7.399999999999986, -9.799999999999978, -7.999999999999984, -18.59999999999997, -18.80000000000001, -27.6, -10.999999999999973, -8.89999999999998, -33.00000000000011, -6.499999999999989, -7.999999999999986, -6.099999999999991, -12.799999999999967, -14.399999999999961, -6.499999999999989, -17.79999999999999, -8.599999999999982, -27.600000000000048, -13.599999999999966, -9.399999999999986, -13.999999999999963, -44.50000000000033, -5.8999999999999915, -37.00000000000013, -6.19999999999999, -16.49999999999998, -9.799999999999978, -18.300000000000008], "episode_lengths": [385, 98, 138, 210, 171, 323, 219, 400, 309, 122, 63, 223, 121, 93, 187, 66, 333, 256, 225, 97, 302, 400, 91, 81, 117, 237, 318, 400, 400, 163, 195, 298, 127, 136, 117, 145, 107, 114, 400, 303, 97, 127, 149, 400, 256, 228, 81, 141, 85, 110, 121, 75, 321, 285, 199, 282, 302, 285, 113, 125, 136, 121, 303, 98, 136, 78, 227, 216, 105, 74, 121, 400, 85, 108, 86, 170, 199, 231, 116, 100, 283, 76, 90, 72, 130, 143, 76, 177, 97, 245, 125, 94, 150, 400, 70, 309, 73, 171, 109, 176]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20350914314792085, "mean_inference_ms": 0.6183917736445097, "mean_action_processing_ms": 0.06821926587526293, "mean_env_wait_ms": 6.058163768988716, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004870176315307617, "StateBufferConnector_ms": 0.00313568115234375, "ViewRequirementAgentConnector_ms": 0.07307815551757812}}, "episode_reward_max": -5.199999999999994, "episode_reward_min": -53.60000000000023, "episode_reward_mean": -19.509000000000036, "episode_len_mean": 184.48, "episodes_this_iter": 27, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-39.800000000000225, -8.699999999999982, -15.999999999999972, -20.60000000000003, -17.399999999999984, -38.30000000000022, -25.40000000000003, -42.10000000000031, -33.700000000000095, -11.899999999999972, -5.199999999999994, -23.200000000000003, -11.899999999999977, -8.199999999999983, -20.50000000000003, -5.499999999999993, -35.300000000000196, -30.200000000000063, -21.40000000000005, -8.599999999999982, -34.30000000000011, -43.70000000000028, -7.999999999999984, -7.099999999999989, -10.699999999999974, -28.00000000000003, -33.20000000000017, -47.4000000000002, -43.40000000000032, -16.499999999999986, -20.799999999999997, -33.5000000000001, -12.599999999999968, -13.199999999999966, -11.099999999999973, -13.399999999999965, -10.19999999999998, -10.899999999999974, -53.60000000000023, -33.20000000000015, -9.79999999999998, -11.599999999999971, -16.899999999999967, -46.20000000000034, -26.900000000000063, -23.800000000000047, -6.999999999999988, -14.299999999999963, -7.399999999999986, -9.899999999999977, -11.69999999999997, -6.39999999999999, -33.500000000000156, -29.700000000000145, -21.29999999999998, -32.300000000000075, -38.700000000000045, -35.30000000000007, -10.199999999999976, -12.199999999999969, -12.499999999999968, -10.999999999999973, -35.10000000000011, -8.699999999999982, -13.699999999999966, -6.699999999999989, -23.60000000000006, -24.000000000000057, -9.399999999999979, -6.39999999999999, -10.999999999999973, -48.400000000000226, -7.399999999999986, -9.799999999999978, -7.999999999999984, -18.59999999999997, -18.80000000000001, -27.6, -10.999999999999973, -8.89999999999998, -33.00000000000011, -6.499999999999989, -7.999999999999986, -6.099999999999991, -12.799999999999967, -14.399999999999961, -6.499999999999989, -17.79999999999999, -8.599999999999982, -27.600000000000048, -13.599999999999966, -9.399999999999986, -13.999999999999963, -44.50000000000033, -5.8999999999999915, -37.00000000000013, -6.19999999999999, -16.49999999999998, -9.799999999999978, -18.300000000000008], "episode_lengths": [385, 98, 138, 210, 171, 323, 219, 400, 309, 122, 63, 223, 121, 93, 187, 66, 333, 256, 225, 97, 302, 400, 91, 81, 117, 237, 318, 400, 400, 163, 195, 298, 127, 136, 117, 145, 107, 114, 400, 303, 97, 127, 149, 400, 256, 228, 81, 141, 85, 110, 121, 75, 321, 285, 199, 282, 302, 285, 113, 125, 136, 121, 303, 98, 136, 78, 227, 216, 105, 74, 121, 400, 85, 108, 86, 170, 199, 231, 116, 100, 283, 76, 90, 72, 130, 143, 76, 177, 97, 245, 125, 94, 150, 400, 70, 309, 73, 171, 109, 176]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20350914314792085, "mean_inference_ms": 0.6183917736445097, "mean_action_processing_ms": 0.06821926587526293, "mean_env_wait_ms": 6.058163768988716, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004870176315307617, "StateBufferConnector_ms": 0.00313568115234375, "ViewRequirementAgentConnector_ms": 0.07307815551757812}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000, "num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 376.11258294372806, "num_env_steps_trained_throughput_per_sec": 376.11258294372806, "timesteps_total": 48000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 48000, "timers": {"training_iteration_time_ms": 10576.372, "sample_time_ms": 7051.441, "load_time_ms": 0.954, "load_throughput": 4193884.612, "learn_time_ms": 3521.668, "learn_throughput": 1135.825, "synch_weights_time_ms": 1.692}, "counters": {"num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000}, "done": false, "episodes_total": 212, "training_iteration": 12, "trial_id": "329fa_00000", "date": "2024-03-07_12-24-10", "timestamp": 1709832250, "time_this_iter_s": 10.637213945388794, "time_total_s": 126.95496821403503, "pid": 105400, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fcd19c36f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 126.95496821403503, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 19.7, "ram_util_percent": 43.52857142857143, "gpu_util_percent0": 0.07714285714285714, "vram_util_percent0": 0.1005859375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.10000000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 4.525497877930281, "policy_loss": -0.004253229322612927, "vf_loss": 4.528995078065062, "vf_explained_var": 0.1765324313794413, "kl": 0.007560266870562366, "entropy": 0.9703619901211031, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 11625.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_agent_steps_sampled": 52000, "num_agent_steps_trained": 52000}, "sampler_results": {"episode_reward_max": -5.8999999999999915, "episode_reward_min": -66.70000000000041, "episode_reward_mean": -19.26500000000003, "episode_len_mean": 177.49, "episode_media": {}, "episodes_this_iter": 24, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10.699999999999974, -28.00000000000003, -33.20000000000017, -47.4000000000002, -43.40000000000032, -16.499999999999986, -20.799999999999997, -33.5000000000001, -12.599999999999968, -13.199999999999966, -11.099999999999973, -13.399999999999965, -10.19999999999998, -10.899999999999974, -53.60000000000023, -33.20000000000015, -9.79999999999998, -11.599999999999971, -16.899999999999967, -46.20000000000034, -26.900000000000063, -23.800000000000047, -6.999999999999988, -14.299999999999963, -7.399999999999986, -9.899999999999977, -11.69999999999997, -6.39999999999999, -33.500000000000156, -29.700000000000145, -21.29999999999998, -32.300000000000075, -38.700000000000045, -35.30000000000007, -10.199999999999976, -12.199999999999969, -12.499999999999968, -10.999999999999973, -35.10000000000011, -8.699999999999982, -13.699999999999966, -6.699999999999989, -23.60000000000006, -24.000000000000057, -9.399999999999979, -6.39999999999999, -10.999999999999973, -48.400000000000226, -7.399999999999986, -9.799999999999978, -7.999999999999984, -18.59999999999997, -18.80000000000001, -27.6, -10.999999999999973, -8.89999999999998, -33.00000000000011, -6.499999999999989, -7.999999999999986, -6.099999999999991, -12.799999999999967, -14.399999999999961, -6.499999999999989, -17.79999999999999, -8.599999999999982, -27.600000000000048, -13.599999999999966, -9.399999999999986, -13.999999999999963, -44.50000000000033, -5.8999999999999915, -37.00000000000013, -6.19999999999999, -16.49999999999998, -9.799999999999978, -18.300000000000008, -15.599999999999966, -11.399999999999972, -9.19999999999998, -15.599999999999959, -34.20000000000004, -11.099999999999973, -55.10000000000027, -8.799999999999981, -66.70000000000041, -13.399999999999965, -8.099999999999984, -15.599999999999966, -18.29999999999999, -12.699999999999967, -27.500000000000032, -7.7999999999999865, -9.399999999999979, -11.399999999999974, -12.699999999999967, -12.699999999999967, -10.099999999999977, -55.40000000000033, -42.2000000000001, -7.599999999999985], "episode_lengths": [117, 237, 318, 400, 400, 163, 195, 298, 127, 136, 117, 145, 107, 114, 400, 303, 97, 127, 149, 400, 256, 228, 81, 141, 85, 110, 121, 75, 321, 285, 199, 282, 302, 285, 113, 125, 136, 121, 303, 98, 136, 78, 227, 216, 105, 74, 121, 400, 85, 108, 86, 170, 199, 231, 116, 100, 283, 76, 90, 72, 130, 143, 76, 177, 97, 245, 125, 94, 150, 400, 70, 309, 73, 171, 109, 176, 166, 125, 103, 151, 263, 122, 400, 99, 400, 137, 92, 149, 165, 134, 232, 85, 105, 117, 125, 128, 108, 400, 321, 87]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20436992669052023, "mean_inference_ms": 0.6183748491462743, "mean_action_processing_ms": 0.068221323818854, "mean_env_wait_ms": 6.053019490505025, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0049283504486083984, "StateBufferConnector_ms": 0.003170490264892578, "ViewRequirementAgentConnector_ms": 0.07346391677856445}}, "episode_reward_max": -5.8999999999999915, "episode_reward_min": -66.70000000000041, "episode_reward_mean": -19.26500000000003, "episode_len_mean": 177.49, "episodes_this_iter": 24, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10.699999999999974, -28.00000000000003, -33.20000000000017, -47.4000000000002, -43.40000000000032, -16.499999999999986, -20.799999999999997, -33.5000000000001, -12.599999999999968, -13.199999999999966, -11.099999999999973, -13.399999999999965, -10.19999999999998, -10.899999999999974, -53.60000000000023, -33.20000000000015, -9.79999999999998, -11.599999999999971, -16.899999999999967, -46.20000000000034, -26.900000000000063, -23.800000000000047, -6.999999999999988, -14.299999999999963, -7.399999999999986, -9.899999999999977, -11.69999999999997, -6.39999999999999, -33.500000000000156, -29.700000000000145, -21.29999999999998, -32.300000000000075, -38.700000000000045, -35.30000000000007, -10.199999999999976, -12.199999999999969, -12.499999999999968, -10.999999999999973, -35.10000000000011, -8.699999999999982, -13.699999999999966, -6.699999999999989, -23.60000000000006, -24.000000000000057, -9.399999999999979, -6.39999999999999, -10.999999999999973, -48.400000000000226, -7.399999999999986, -9.799999999999978, -7.999999999999984, -18.59999999999997, -18.80000000000001, -27.6, -10.999999999999973, -8.89999999999998, -33.00000000000011, -6.499999999999989, -7.999999999999986, -6.099999999999991, -12.799999999999967, -14.399999999999961, -6.499999999999989, -17.79999999999999, -8.599999999999982, -27.600000000000048, -13.599999999999966, -9.399999999999986, -13.999999999999963, -44.50000000000033, -5.8999999999999915, -37.00000000000013, -6.19999999999999, -16.49999999999998, -9.799999999999978, -18.300000000000008, -15.599999999999966, -11.399999999999972, -9.19999999999998, -15.599999999999959, -34.20000000000004, -11.099999999999973, -55.10000000000027, -8.799999999999981, -66.70000000000041, -13.399999999999965, -8.099999999999984, -15.599999999999966, -18.29999999999999, -12.699999999999967, -27.500000000000032, -7.7999999999999865, -9.399999999999979, -11.399999999999974, -12.699999999999967, -12.699999999999967, -10.099999999999977, -55.40000000000033, -42.2000000000001, -7.599999999999985], "episode_lengths": [117, 237, 318, 400, 400, 163, 195, 298, 127, 136, 117, 145, 107, 114, 400, 303, 97, 127, 149, 400, 256, 228, 81, 141, 85, 110, 121, 75, 321, 285, 199, 282, 302, 285, 113, 125, 136, 121, 303, 98, 136, 78, 227, 216, 105, 74, 121, 400, 85, 108, 86, 170, 199, 231, 116, 100, 283, 76, 90, 72, 130, 143, 76, 177, 97, 245, 125, 94, 150, 400, 70, 309, 73, 171, 109, 176, 166, 125, 103, 151, 263, 122, 400, 99, 400, 137, 92, 149, 165, 134, 232, 85, 105, 117, 125, 128, 108, 400, 321, 87]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20436992669052023, "mean_inference_ms": 0.6183748491462743, "mean_action_processing_ms": 0.068221323818854, "mean_env_wait_ms": 6.053019490505025, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0049283504486083984, "StateBufferConnector_ms": 0.003170490264892578, "ViewRequirementAgentConnector_ms": 0.07346391677856445}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 52000, "num_agent_steps_trained": 52000, "num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 376.81177322974696, "num_env_steps_trained_throughput_per_sec": 376.81177322974696, "timesteps_total": 52000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 52000, "timers": {"training_iteration_time_ms": 10589.256, "sample_time_ms": 7061.253, "load_time_ms": 0.987, "load_throughput": 4054524.276, "learn_time_ms": 3524.709, "learn_throughput": 1134.845, "synch_weights_time_ms": 1.687}, "counters": {"num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_agent_steps_sampled": 52000, "num_agent_steps_trained": 52000}, "done": false, "episodes_total": 236, "training_iteration": 13, "trial_id": "329fa_00000", "date": "2024-03-07_12-24-20", "timestamp": 1709832260, "time_this_iter_s": 10.617393970489502, "time_total_s": 137.57236218452454, "pid": 105400, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fcd19c36f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 137.57236218452454, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 19.171428571428578, "ram_util_percent": 43.60000000000001, "gpu_util_percent0": 0.07571428571428572, "vram_util_percent0": 0.1005859375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.10000000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 3.279059740782325, "policy_loss": -0.01392379514472459, "vf_loss": 3.2923168639021534, "vf_explained_var": 0.4280095185643883, "kl": 0.006666768425897028, "entropy": 0.9938029039290643, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 12555.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 56000}, "sampler_results": {"episode_reward_max": -3.799999999999999, "episode_reward_min": -66.70000000000041, "episode_reward_mean": -15.065000000000008, "episode_len_mean": 142.33, "episode_media": {}, "episodes_this_iter": 37, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10.999999999999973, -35.10000000000011, -8.699999999999982, -13.699999999999966, -6.699999999999989, -23.60000000000006, -24.000000000000057, -9.399999999999979, -6.39999999999999, -10.999999999999973, -48.400000000000226, -7.399999999999986, -9.799999999999978, -7.999999999999984, -18.59999999999997, -18.80000000000001, -27.6, -10.999999999999973, -8.89999999999998, -33.00000000000011, -6.499999999999989, -7.999999999999986, -6.099999999999991, -12.799999999999967, -14.399999999999961, -6.499999999999989, -17.79999999999999, -8.599999999999982, -27.600000000000048, -13.599999999999966, -9.399999999999986, -13.999999999999963, -44.50000000000033, -5.8999999999999915, -37.00000000000013, -6.19999999999999, -16.49999999999998, -9.799999999999978, -18.300000000000008, -15.599999999999966, -11.399999999999972, -9.19999999999998, -15.599999999999959, -34.20000000000004, -11.099999999999973, -55.10000000000027, -8.799999999999981, -66.70000000000041, -13.399999999999965, -8.099999999999984, -15.599999999999966, -18.29999999999999, -12.699999999999967, -27.500000000000032, -7.7999999999999865, -9.399999999999979, -11.399999999999974, -12.699999999999967, -12.699999999999967, -10.099999999999977, -55.40000000000033, -42.2000000000001, -7.599999999999985, -20.000000000000025, -9.799999999999978, -35.5000000000001, -7.399999999999986, -44.200000000000166, -3.799999999999999, -7.199999999999987, -7.599999999999989, -11.099999999999973, -9.799999999999978, -8.299999999999983, -6.799999999999988, -8.599999999999982, -6.39999999999999, -9.599999999999978, -7.699999999999985, -19.99999999999999, -18.0, -15.699999999999967, -6.599999999999989, -6.19999999999999, -5.299999999999994, -7.499999999999993, -6.29999999999999, -4.799999999999995, -5.099999999999994, -11.499999999999973, -5.099999999999994, -9.699999999999978, -9.699999999999978, -6.699999999999989, -8.299999999999983, -9.499999999999979, -9.999999999999977, -6.799999999999992, -5.499999999999993, -7.199999999999989], "episode_lengths": [121, 303, 98, 136, 78, 227, 216, 105, 74, 121, 400, 85, 108, 86, 170, 199, 231, 116, 100, 283, 76, 90, 72, 130, 143, 76, 177, 97, 245, 125, 94, 150, 400, 70, 309, 73, 171, 109, 176, 166, 125, 103, 151, 263, 122, 400, 99, 400, 137, 92, 149, 165, 134, 232, 85, 105, 117, 125, 128, 108, 400, 321, 87, 196, 104, 279, 85, 331, 49, 83, 83, 112, 109, 94, 79, 97, 75, 107, 88, 187, 170, 162, 77, 73, 64, 79, 74, 59, 62, 115, 62, 108, 108, 78, 93, 104, 110, 75, 66, 82]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2061971775712707, "mean_inference_ms": 0.6188193243046287, "mean_action_processing_ms": 0.06828536002942723, "mean_env_wait_ms": 6.057550724531182, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005118608474731445, "StateBufferConnector_ms": 0.0032150745391845703, "ViewRequirementAgentConnector_ms": 0.07337355613708496}}, "episode_reward_max": -3.799999999999999, "episode_reward_min": -66.70000000000041, "episode_reward_mean": -15.065000000000008, "episode_len_mean": 142.33, "episodes_this_iter": 37, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10.999999999999973, -35.10000000000011, -8.699999999999982, -13.699999999999966, -6.699999999999989, -23.60000000000006, -24.000000000000057, -9.399999999999979, -6.39999999999999, -10.999999999999973, -48.400000000000226, -7.399999999999986, -9.799999999999978, -7.999999999999984, -18.59999999999997, -18.80000000000001, -27.6, -10.999999999999973, -8.89999999999998, -33.00000000000011, -6.499999999999989, -7.999999999999986, -6.099999999999991, -12.799999999999967, -14.399999999999961, -6.499999999999989, -17.79999999999999, -8.599999999999982, -27.600000000000048, -13.599999999999966, -9.399999999999986, -13.999999999999963, -44.50000000000033, -5.8999999999999915, -37.00000000000013, -6.19999999999999, -16.49999999999998, -9.799999999999978, -18.300000000000008, -15.599999999999966, -11.399999999999972, -9.19999999999998, -15.599999999999959, -34.20000000000004, -11.099999999999973, -55.10000000000027, -8.799999999999981, -66.70000000000041, -13.399999999999965, -8.099999999999984, -15.599999999999966, -18.29999999999999, -12.699999999999967, -27.500000000000032, -7.7999999999999865, -9.399999999999979, -11.399999999999974, -12.699999999999967, -12.699999999999967, -10.099999999999977, -55.40000000000033, -42.2000000000001, -7.599999999999985, -20.000000000000025, -9.799999999999978, -35.5000000000001, -7.399999999999986, -44.200000000000166, -3.799999999999999, -7.199999999999987, -7.599999999999989, -11.099999999999973, -9.799999999999978, -8.299999999999983, -6.799999999999988, -8.599999999999982, -6.39999999999999, -9.599999999999978, -7.699999999999985, -19.99999999999999, -18.0, -15.699999999999967, -6.599999999999989, -6.19999999999999, -5.299999999999994, -7.499999999999993, -6.29999999999999, -4.799999999999995, -5.099999999999994, -11.499999999999973, -5.099999999999994, -9.699999999999978, -9.699999999999978, -6.699999999999989, -8.299999999999983, -9.499999999999979, -9.999999999999977, -6.799999999999992, -5.499999999999993, -7.199999999999989], "episode_lengths": [121, 303, 98, 136, 78, 227, 216, 105, 74, 121, 400, 85, 108, 86, 170, 199, 231, 116, 100, 283, 76, 90, 72, 130, 143, 76, 177, 97, 245, 125, 94, 150, 400, 70, 309, 73, 171, 109, 176, 166, 125, 103, 151, 263, 122, 400, 99, 400, 137, 92, 149, 165, 134, 232, 85, 105, 117, 125, 128, 108, 400, 321, 87, 196, 104, 279, 85, 331, 49, 83, 83, 112, 109, 94, 79, 97, 75, 107, 88, 187, 170, 162, 77, 73, 64, 79, 74, 59, 62, 115, 62, 108, 108, 78, 93, 104, 110, 75, 66, 82]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2061971775712707, "mean_inference_ms": 0.6188193243046287, "mean_action_processing_ms": 0.06828536002942723, "mean_env_wait_ms": 6.057550724531182, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005118608474731445, "StateBufferConnector_ms": 0.0032150745391845703, "ViewRequirementAgentConnector_ms": 0.07337355613708496}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 56000, "num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 377.77000846475835, "num_env_steps_trained_throughput_per_sec": 377.77000846475835, "timesteps_total": 56000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 56000, "timers": {"training_iteration_time_ms": 10567.515, "sample_time_ms": 7069.144, "load_time_ms": 0.992, "load_throughput": 4032209.191, "learn_time_ms": 3495.077, "learn_throughput": 1144.467, "synch_weights_time_ms": 1.685}, "counters": {"num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 56000}, "done": false, "episodes_total": 273, "training_iteration": 14, "trial_id": "329fa_00000", "date": "2024-03-07_12-24-31", "timestamp": 1709832271, "time_this_iter_s": 10.590687274932861, "time_total_s": 148.1630494594574, "pid": 105400, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fcd19c36f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 148.1630494594574, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 19.62857142857143, "ram_util_percent": 43.60000000000001, "gpu_util_percent0": 0.07642857142857143, "vram_util_percent0": 0.1005859375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.10000000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 5.8936975033309125, "policy_loss": -0.004083750737450456, "vf_loss": 5.897167816501792, "vf_explained_var": -0.10615333209755601, "kl": 0.006134485543668083, "entropy": 0.9238383689875244, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 13485.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000}, "sampler_results": {"episode_reward_max": -3.3000000000000007, "episode_reward_min": -66.70000000000041, "episode_reward_mean": -15.723000000000015, "episode_len_mean": 144.54, "episode_media": {}, "episodes_this_iter": 24, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-14.399999999999961, -6.499999999999989, -17.79999999999999, -8.599999999999982, -27.600000000000048, -13.599999999999966, -9.399999999999986, -13.999999999999963, -44.50000000000033, -5.8999999999999915, -37.00000000000013, -6.19999999999999, -16.49999999999998, -9.799999999999978, -18.300000000000008, -15.599999999999966, -11.399999999999972, -9.19999999999998, -15.599999999999959, -34.20000000000004, -11.099999999999973, -55.10000000000027, -8.799999999999981, -66.70000000000041, -13.399999999999965, -8.099999999999984, -15.599999999999966, -18.29999999999999, -12.699999999999967, -27.500000000000032, -7.7999999999999865, -9.399999999999979, -11.399999999999974, -12.699999999999967, -12.699999999999967, -10.099999999999977, -55.40000000000033, -42.2000000000001, -7.599999999999985, -20.000000000000025, -9.799999999999978, -35.5000000000001, -7.399999999999986, -44.200000000000166, -3.799999999999999, -7.199999999999987, -7.599999999999989, -11.099999999999973, -9.799999999999978, -8.299999999999983, -6.799999999999988, -8.599999999999982, -6.39999999999999, -9.599999999999978, -7.699999999999985, -19.99999999999999, -18.0, -15.699999999999967, -6.599999999999989, -6.19999999999999, -5.299999999999994, -7.499999999999993, -6.29999999999999, -4.799999999999995, -5.099999999999994, -11.499999999999973, -5.099999999999994, -9.699999999999978, -9.699999999999978, -6.699999999999989, -8.299999999999983, -9.499999999999979, -9.999999999999977, -6.799999999999992, -5.499999999999993, -7.199999999999989, -6.599999999999989, -23.599999999999948, -9.19999999999998, -54.800000000000274, -8.499999999999984, -4.899999999999995, -5.299999999999994, -14.499999999999961, -6.799999999999988, -30.20000000000003, -63.90000000000038, -8.89999999999998, -4.899999999999995, -11.399999999999979, -21.90000000000005, -8.299999999999985, -10.399999999999975, -12.799999999999972, -6.599999999999989, -48.80000000000026, -12.599999999999968, -3.3000000000000007, -52.50000000000032, -9.599999999999978], "episode_lengths": [143, 76, 177, 97, 245, 125, 94, 150, 400, 70, 309, 73, 171, 109, 176, 166, 125, 103, 151, 263, 122, 400, 99, 400, 137, 92, 149, 165, 134, 232, 85, 105, 117, 125, 128, 108, 400, 321, 87, 196, 104, 279, 85, 331, 49, 83, 83, 112, 109, 94, 79, 97, 75, 107, 88, 187, 170, 162, 77, 73, 64, 79, 74, 59, 62, 115, 62, 108, 108, 78, 93, 104, 110, 75, 66, 82, 77, 177, 101, 400, 92, 60, 64, 144, 79, 265, 400, 100, 60, 109, 227, 91, 115, 124, 77, 400, 133, 44, 400, 107]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20708455707595114, "mean_inference_ms": 0.6186065794181868, "mean_action_processing_ms": 0.06826914327444282, "mean_env_wait_ms": 6.057783733194148, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0050814151763916016, "StateBufferConnector_ms": 0.0031914710998535156, "ViewRequirementAgentConnector_ms": 0.07303190231323242}}, "episode_reward_max": -3.3000000000000007, "episode_reward_min": -66.70000000000041, "episode_reward_mean": -15.723000000000015, "episode_len_mean": 144.54, "episodes_this_iter": 24, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-14.399999999999961, -6.499999999999989, -17.79999999999999, -8.599999999999982, -27.600000000000048, -13.599999999999966, -9.399999999999986, -13.999999999999963, -44.50000000000033, -5.8999999999999915, -37.00000000000013, -6.19999999999999, -16.49999999999998, -9.799999999999978, -18.300000000000008, -15.599999999999966, -11.399999999999972, -9.19999999999998, -15.599999999999959, -34.20000000000004, -11.099999999999973, -55.10000000000027, -8.799999999999981, -66.70000000000041, -13.399999999999965, -8.099999999999984, -15.599999999999966, -18.29999999999999, -12.699999999999967, -27.500000000000032, -7.7999999999999865, -9.399999999999979, -11.399999999999974, -12.699999999999967, -12.699999999999967, -10.099999999999977, -55.40000000000033, -42.2000000000001, -7.599999999999985, -20.000000000000025, -9.799999999999978, -35.5000000000001, -7.399999999999986, -44.200000000000166, -3.799999999999999, -7.199999999999987, -7.599999999999989, -11.099999999999973, -9.799999999999978, -8.299999999999983, -6.799999999999988, -8.599999999999982, -6.39999999999999, -9.599999999999978, -7.699999999999985, -19.99999999999999, -18.0, -15.699999999999967, -6.599999999999989, -6.19999999999999, -5.299999999999994, -7.499999999999993, -6.29999999999999, -4.799999999999995, -5.099999999999994, -11.499999999999973, -5.099999999999994, -9.699999999999978, -9.699999999999978, -6.699999999999989, -8.299999999999983, -9.499999999999979, -9.999999999999977, -6.799999999999992, -5.499999999999993, -7.199999999999989, -6.599999999999989, -23.599999999999948, -9.19999999999998, -54.800000000000274, -8.499999999999984, -4.899999999999995, -5.299999999999994, -14.499999999999961, -6.799999999999988, -30.20000000000003, -63.90000000000038, -8.89999999999998, -4.899999999999995, -11.399999999999979, -21.90000000000005, -8.299999999999985, -10.399999999999975, -12.799999999999972, -6.599999999999989, -48.80000000000026, -12.599999999999968, -3.3000000000000007, -52.50000000000032, -9.599999999999978], "episode_lengths": [143, 76, 177, 97, 245, 125, 94, 150, 400, 70, 309, 73, 171, 109, 176, 166, 125, 103, 151, 263, 122, 400, 99, 400, 137, 92, 149, 165, 134, 232, 85, 105, 117, 125, 128, 108, 400, 321, 87, 196, 104, 279, 85, 331, 49, 83, 83, 112, 109, 94, 79, 97, 75, 107, 88, 187, 170, 162, 77, 73, 64, 79, 74, 59, 62, 115, 62, 108, 108, 78, 93, 104, 110, 75, 66, 82, 77, 177, 101, 400, 92, 60, 64, 144, 79, 265, 400, 100, 60, 109, 227, 91, 115, 124, 77, 400, 133, 44, 400, 107]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20708455707595114, "mean_inference_ms": 0.6186065794181868, "mean_action_processing_ms": 0.06826914327444282, "mean_env_wait_ms": 6.057783733194148, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0050814151763916016, "StateBufferConnector_ms": 0.0031914710998535156, "ViewRequirementAgentConnector_ms": 0.07303190231323242}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000, "num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 379.7378201799681, "num_env_steps_trained_throughput_per_sec": 379.7378201799681, "timesteps_total": 60000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 60000, "timers": {"training_iteration_time_ms": 10569.962, "sample_time_ms": 7076.202, "load_time_ms": 1.007, "load_throughput": 3971408.687, "learn_time_ms": 3490.449, "learn_throughput": 1145.984, "synch_weights_time_ms": 1.688}, "counters": {"num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000}, "done": false, "episodes_total": 297, "training_iteration": 15, "trial_id": "329fa_00000", "date": "2024-03-07_12-24-42", "timestamp": 1709832282, "time_this_iter_s": 10.535895824432373, "time_total_s": 158.69894528388977, "pid": 105400, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fcd19c36f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 158.69894528388977, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 19.307142857142857, "ram_util_percent": 43.550000000000004, "gpu_util_percent0": 0.08928571428571429, "vram_util_percent0": 0.1005859375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.10000000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 3.2491796267829756, "policy_loss": -0.00823017351569668, "vf_loss": 3.2564463380043223, "vf_explained_var": 0.4799962027739453, "kl": 0.009634615001885118, "entropy": 0.9665872293133889, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 14415.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000}, "sampler_results": {"episode_reward_max": -3.3000000000000007, "episode_reward_min": -63.90000000000038, "episode_reward_mean": -13.139000000000008, "episode_len_mean": 125.13, "episode_media": {}, "episodes_this_iter": 37, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-42.2000000000001, -7.599999999999985, -20.000000000000025, -9.799999999999978, -35.5000000000001, -7.399999999999986, -44.200000000000166, -3.799999999999999, -7.199999999999987, -7.599999999999989, -11.099999999999973, -9.799999999999978, -8.299999999999983, -6.799999999999988, -8.599999999999982, -6.39999999999999, -9.599999999999978, -7.699999999999985, -19.99999999999999, -18.0, -15.699999999999967, -6.599999999999989, -6.19999999999999, -5.299999999999994, -7.499999999999993, -6.29999999999999, -4.799999999999995, -5.099999999999994, -11.499999999999973, -5.099999999999994, -9.699999999999978, -9.699999999999978, -6.699999999999989, -8.299999999999983, -9.499999999999979, -9.999999999999977, -6.799999999999992, -5.499999999999993, -7.199999999999989, -6.599999999999989, -23.599999999999948, -9.19999999999998, -54.800000000000274, -8.499999999999984, -4.899999999999995, -5.299999999999994, -14.499999999999961, -6.799999999999988, -30.20000000000003, -63.90000000000038, -8.89999999999998, -4.899999999999995, -11.399999999999979, -21.90000000000005, -8.299999999999985, -10.399999999999975, -12.799999999999972, -6.599999999999989, -48.80000000000026, -12.599999999999968, -3.3000000000000007, -52.50000000000032, -9.599999999999978, -10.099999999999977, -4.099999999999998, -14.599999999999962, -36.00000000000006, -4.699999999999996, -6.499999999999991, -6.099999999999991, -13.899999999999965, -16.89999999999999, -8.899999999999983, -9.999999999999977, -11.499999999999972, -15.799999999999962, -19.999999999999975, -8.19999999999999, -10.699999999999976, -10.199999999999976, -55.00000000000029, -10.899999999999977, -5.199999999999994, -15.999999999999961, -9.29999999999998, -8.299999999999983, -6.799999999999988, -6.599999999999989, -16.39999999999997, -8.89999999999998, -7.599999999999987, -19.000000000000007, -6.899999999999988, -3.5, -13.599999999999964, -6.899999999999988, -7.499999999999986, -4.999999999999995, -5.499999999999993, -7.399999999999995], "episode_lengths": [321, 87, 196, 104, 279, 85, 331, 49, 83, 83, 112, 109, 94, 79, 97, 75, 107, 88, 187, 170, 162, 77, 73, 64, 79, 74, 59, 62, 115, 62, 108, 108, 78, 93, 104, 110, 75, 66, 82, 77, 177, 101, 400, 92, 60, 64, 144, 79, 265, 400, 100, 60, 109, 227, 91, 115, 124, 77, 400, 133, 44, 400, 107, 110, 52, 127, 281, 58, 74, 72, 147, 156, 96, 111, 118, 158, 173, 86, 106, 113, 400, 111, 63, 150, 104, 94, 78, 77, 151, 100, 86, 196, 80, 46, 140, 80, 86, 61, 66, 73]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20892235073426654, "mean_inference_ms": 0.6186494113329577, "mean_action_processing_ms": 0.06825740308730498, "mean_env_wait_ms": 6.0614932977033735, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005059003829956055, "StateBufferConnector_ms": 0.0031316280364990234, "ViewRequirementAgentConnector_ms": 0.07282519340515137}}, "episode_reward_max": -3.3000000000000007, "episode_reward_min": -63.90000000000038, "episode_reward_mean": -13.139000000000008, "episode_len_mean": 125.13, "episodes_this_iter": 37, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-42.2000000000001, -7.599999999999985, -20.000000000000025, -9.799999999999978, -35.5000000000001, -7.399999999999986, -44.200000000000166, -3.799999999999999, -7.199999999999987, -7.599999999999989, -11.099999999999973, -9.799999999999978, -8.299999999999983, -6.799999999999988, -8.599999999999982, -6.39999999999999, -9.599999999999978, -7.699999999999985, -19.99999999999999, -18.0, -15.699999999999967, -6.599999999999989, -6.19999999999999, -5.299999999999994, -7.499999999999993, -6.29999999999999, -4.799999999999995, -5.099999999999994, -11.499999999999973, -5.099999999999994, -9.699999999999978, -9.699999999999978, -6.699999999999989, -8.299999999999983, -9.499999999999979, -9.999999999999977, -6.799999999999992, -5.499999999999993, -7.199999999999989, -6.599999999999989, -23.599999999999948, -9.19999999999998, -54.800000000000274, -8.499999999999984, -4.899999999999995, -5.299999999999994, -14.499999999999961, -6.799999999999988, -30.20000000000003, -63.90000000000038, -8.89999999999998, -4.899999999999995, -11.399999999999979, -21.90000000000005, -8.299999999999985, -10.399999999999975, -12.799999999999972, -6.599999999999989, -48.80000000000026, -12.599999999999968, -3.3000000000000007, -52.50000000000032, -9.599999999999978, -10.099999999999977, -4.099999999999998, -14.599999999999962, -36.00000000000006, -4.699999999999996, -6.499999999999991, -6.099999999999991, -13.899999999999965, -16.89999999999999, -8.899999999999983, -9.999999999999977, -11.499999999999972, -15.799999999999962, -19.999999999999975, -8.19999999999999, -10.699999999999976, -10.199999999999976, -55.00000000000029, -10.899999999999977, -5.199999999999994, -15.999999999999961, -9.29999999999998, -8.299999999999983, -6.799999999999988, -6.599999999999989, -16.39999999999997, -8.89999999999998, -7.599999999999987, -19.000000000000007, -6.899999999999988, -3.5, -13.599999999999964, -6.899999999999988, -7.499999999999986, -4.999999999999995, -5.499999999999993, -7.399999999999995], "episode_lengths": [321, 87, 196, 104, 279, 85, 331, 49, 83, 83, 112, 109, 94, 79, 97, 75, 107, 88, 187, 170, 162, 77, 73, 64, 79, 74, 59, 62, 115, 62, 108, 108, 78, 93, 104, 110, 75, 66, 82, 77, 177, 101, 400, 92, 60, 64, 144, 79, 265, 400, 100, 60, 109, 227, 91, 115, 124, 77, 400, 133, 44, 400, 107, 110, 52, 127, 281, 58, 74, 72, 147, 156, 96, 111, 118, 158, 173, 86, 106, 113, 400, 111, 63, 150, 104, 94, 78, 77, 151, 100, 86, 196, 80, 46, 140, 80, 86, 61, 66, 73]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20892235073426654, "mean_inference_ms": 0.6186494113329577, "mean_action_processing_ms": 0.06825740308730498, "mean_env_wait_ms": 6.0614932977033735, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005059003829956055, "StateBufferConnector_ms": 0.0031316280364990234, "ViewRequirementAgentConnector_ms": 0.07282519340515137}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000, "num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 374.03169519428855, "num_env_steps_trained_throughput_per_sec": 374.03169519428855, "timesteps_total": 64000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 64000, "timers": {"training_iteration_time_ms": 10591.839, "sample_time_ms": 7097.697, "load_time_ms": 1.007, "load_throughput": 3973007.483, "learn_time_ms": 3490.823, "learn_throughput": 1145.861, "synch_weights_time_ms": 1.687}, "counters": {"num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000}, "done": false, "episodes_total": 334, "training_iteration": 16, "trial_id": "329fa_00000", "date": "2024-03-07_12-24-52", "timestamp": 1709832292, "time_this_iter_s": 10.696505784988403, "time_total_s": 169.39545106887817, "pid": 105400, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fcd19c36f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 169.39545106887817, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 20.21428571428572, "ram_util_percent": 43.550000000000004, "gpu_util_percent0": 0.08785714285714286, "vram_util_percent0": 0.1005859375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.10000000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 3.0660081240509682, "policy_loss": -0.007685879311494289, "vf_loss": 3.072920249979342, "vf_explained_var": 0.4750158666923482, "kl": 0.007737697931775829, "entropy": 0.9558808671530857, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 15345.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_agent_steps_sampled": 68000, "num_agent_steps_trained": 68000}, "sampler_results": {"episode_reward_max": -2.2000000000000015, "episode_reward_min": -63.90000000000038, "episode_reward_mean": -11.843000000000004, "episode_len_mean": 114.04, "episode_media": {}, "episodes_this_iter": 44, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4.899999999999995, -5.299999999999994, -14.499999999999961, -6.799999999999988, -30.20000000000003, -63.90000000000038, -8.89999999999998, -4.899999999999995, -11.399999999999979, -21.90000000000005, -8.299999999999985, -10.399999999999975, -12.799999999999972, -6.599999999999989, -48.80000000000026, -12.599999999999968, -3.3000000000000007, -52.50000000000032, -9.599999999999978, -10.099999999999977, -4.099999999999998, -14.599999999999962, -36.00000000000006, -4.699999999999996, -6.499999999999991, -6.099999999999991, -13.899999999999965, -16.89999999999999, -8.899999999999983, -9.999999999999977, -11.499999999999972, -15.799999999999962, -19.999999999999975, -8.19999999999999, -10.699999999999976, -10.199999999999976, -55.00000000000029, -10.899999999999977, -5.199999999999994, -15.999999999999961, -9.29999999999998, -8.299999999999983, -6.799999999999988, -6.599999999999989, -16.39999999999997, -8.89999999999998, -7.599999999999987, -19.000000000000007, -6.899999999999988, -3.5, -13.599999999999964, -6.899999999999988, -7.499999999999986, -4.999999999999995, -5.499999999999993, -7.399999999999995, -14.299999999999962, -8.399999999999983, -5.499999999999993, -6.9999999999999885, -7.499999999999986, -8.799999999999981, -8.299999999999988, -7.199999999999987, -5.699999999999992, -4.299999999999997, -2.2000000000000015, -9.19999999999998, -12.09999999999997, -5.499999999999993, -10.399999999999979, -63.4000000000004, -4.599999999999996, -4.899999999999995, -6.799999999999994, -13.49999999999997, -6.699999999999989, -8.599999999999982, -6.299999999999993, -6.29999999999999, -5.199999999999994, -5.699999999999992, -8.599999999999982, -6.599999999999989, -6.5999999999999925, -7.099999999999987, -5.5999999999999925, -23.400000000000055, -5.699999999999992, -8.599999999999982, -8.399999999999988, -5.299999999999994, -3.5, -4.099999999999998, -15.099999999999959, -27.20000000000006, -5.099999999999999, -12.19999999999997, -4.099999999999998, -6.599999999999989], "episode_lengths": [60, 64, 144, 79, 265, 400, 100, 60, 109, 227, 91, 115, 124, 77, 400, 133, 44, 400, 107, 110, 52, 127, 281, 58, 74, 72, 147, 156, 96, 111, 118, 158, 173, 86, 106, 113, 400, 111, 63, 150, 104, 94, 78, 77, 151, 100, 86, 196, 80, 46, 140, 80, 86, 61, 66, 73, 141, 95, 66, 80, 86, 99, 89, 83, 68, 54, 33, 103, 132, 66, 103, 400, 57, 60, 73, 112, 78, 97, 71, 74, 63, 68, 96, 77, 73, 70, 67, 198, 68, 92, 85, 64, 45, 52, 155, 228, 57, 118, 52, 77]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2110574913812019, "mean_inference_ms": 0.6190893039757304, "mean_action_processing_ms": 0.06826370821309415, "mean_env_wait_ms": 6.068261264068144, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0050182342529296875, "StateBufferConnector_ms": 0.0031745433807373047, "ViewRequirementAgentConnector_ms": 0.07368993759155273}}, "episode_reward_max": -2.2000000000000015, "episode_reward_min": -63.90000000000038, "episode_reward_mean": -11.843000000000004, "episode_len_mean": 114.04, "episodes_this_iter": 44, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-4.899999999999995, -5.299999999999994, -14.499999999999961, -6.799999999999988, -30.20000000000003, -63.90000000000038, -8.89999999999998, -4.899999999999995, -11.399999999999979, -21.90000000000005, -8.299999999999985, -10.399999999999975, -12.799999999999972, -6.599999999999989, -48.80000000000026, -12.599999999999968, -3.3000000000000007, -52.50000000000032, -9.599999999999978, -10.099999999999977, -4.099999999999998, -14.599999999999962, -36.00000000000006, -4.699999999999996, -6.499999999999991, -6.099999999999991, -13.899999999999965, -16.89999999999999, -8.899999999999983, -9.999999999999977, -11.499999999999972, -15.799999999999962, -19.999999999999975, -8.19999999999999, -10.699999999999976, -10.199999999999976, -55.00000000000029, -10.899999999999977, -5.199999999999994, -15.999999999999961, -9.29999999999998, -8.299999999999983, -6.799999999999988, -6.599999999999989, -16.39999999999997, -8.89999999999998, -7.599999999999987, -19.000000000000007, -6.899999999999988, -3.5, -13.599999999999964, -6.899999999999988, -7.499999999999986, -4.999999999999995, -5.499999999999993, -7.399999999999995, -14.299999999999962, -8.399999999999983, -5.499999999999993, -6.9999999999999885, -7.499999999999986, -8.799999999999981, -8.299999999999988, -7.199999999999987, -5.699999999999992, -4.299999999999997, -2.2000000000000015, -9.19999999999998, -12.09999999999997, -5.499999999999993, -10.399999999999979, -63.4000000000004, -4.599999999999996, -4.899999999999995, -6.799999999999994, -13.49999999999997, -6.699999999999989, -8.599999999999982, -6.299999999999993, -6.29999999999999, -5.199999999999994, -5.699999999999992, -8.599999999999982, -6.599999999999989, -6.5999999999999925, -7.099999999999987, -5.5999999999999925, -23.400000000000055, -5.699999999999992, -8.599999999999982, -8.399999999999988, -5.299999999999994, -3.5, -4.099999999999998, -15.099999999999959, -27.20000000000006, -5.099999999999999, -12.19999999999997, -4.099999999999998, -6.599999999999989], "episode_lengths": [60, 64, 144, 79, 265, 400, 100, 60, 109, 227, 91, 115, 124, 77, 400, 133, 44, 400, 107, 110, 52, 127, 281, 58, 74, 72, 147, 156, 96, 111, 118, 158, 173, 86, 106, 113, 400, 111, 63, 150, 104, 94, 78, 77, 151, 100, 86, 196, 80, 46, 140, 80, 86, 61, 66, 73, 141, 95, 66, 80, 86, 99, 89, 83, 68, 54, 33, 103, 132, 66, 103, 400, 57, 60, 73, 112, 78, 97, 71, 74, 63, 68, 96, 77, 73, 70, 67, 198, 68, 92, 85, 64, 45, 52, 155, 228, 57, 118, 52, 77]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2110574913812019, "mean_inference_ms": 0.6190893039757304, "mean_action_processing_ms": 0.06826370821309415, "mean_env_wait_ms": 6.068261264068144, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0050182342529296875, "StateBufferConnector_ms": 0.0031745433807373047, "ViewRequirementAgentConnector_ms": 0.07368993759155273}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 68000, "num_agent_steps_trained": 68000, "num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 373.4194480274127, "num_env_steps_trained_throughput_per_sec": 373.4194480274127, "timesteps_total": 68000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 68000, "timers": {"training_iteration_time_ms": 10605.828, "sample_time_ms": 7115.928, "load_time_ms": 1.007, "load_throughput": 3972537.116, "learn_time_ms": 3486.595, "learn_throughput": 1147.251, "synch_weights_time_ms": 1.672}, "counters": {"num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_agent_steps_sampled": 68000, "num_agent_steps_trained": 68000}, "done": false, "episodes_total": 378, "training_iteration": 17, "trial_id": "329fa_00000", "date": "2024-03-07_12-25-03", "timestamp": 1709832303, "time_this_iter_s": 10.71402907371521, "time_total_s": 180.10948014259338, "pid": 105400, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fcd19c36f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 180.10948014259338, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 20.592307692307696, "ram_util_percent": 43.57692307692309, "gpu_util_percent0": 0.07846153846153846, "vram_util_percent0": 0.1005859375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.10000000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 4.278983965490554, "policy_loss": -0.009225100551241188, "vf_loss": 4.287369447834389, "vf_explained_var": 0.19890335291944525, "kl": 0.008396266721793949, "entropy": 0.9344318764184111, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 16275.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000}, "sampler_results": {"episode_reward_max": -2.2000000000000015, "episode_reward_min": -63.4000000000004, "episode_reward_mean": -11.156000000000008, "episode_len_mean": 108.56, "episode_media": {}, "episodes_this_iter": 31, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-15.799999999999962, -19.999999999999975, -8.19999999999999, -10.699999999999976, -10.199999999999976, -55.00000000000029, -10.899999999999977, -5.199999999999994, -15.999999999999961, -9.29999999999998, -8.299999999999983, -6.799999999999988, -6.599999999999989, -16.39999999999997, -8.89999999999998, -7.599999999999987, -19.000000000000007, -6.899999999999988, -3.5, -13.599999999999964, -6.899999999999988, -7.499999999999986, -4.999999999999995, -5.499999999999993, -7.399999999999995, -14.299999999999962, -8.399999999999983, -5.499999999999993, -6.9999999999999885, -7.499999999999986, -8.799999999999981, -8.299999999999988, -7.199999999999987, -5.699999999999992, -4.299999999999997, -2.2000000000000015, -9.19999999999998, -12.09999999999997, -5.499999999999993, -10.399999999999979, -63.4000000000004, -4.599999999999996, -4.899999999999995, -6.799999999999994, -13.49999999999997, -6.699999999999989, -8.599999999999982, -6.299999999999993, -6.29999999999999, -5.199999999999994, -5.699999999999992, -8.599999999999982, -6.599999999999989, -6.5999999999999925, -7.099999999999987, -5.5999999999999925, -23.400000000000055, -5.699999999999992, -8.599999999999982, -8.399999999999988, -5.299999999999994, -3.5, -4.099999999999998, -15.099999999999959, -27.20000000000006, -5.099999999999999, -12.19999999999997, -4.099999999999998, -6.599999999999989, -8.099999999999985, -6.699999999999989, -44.80000000000014, -6.999999999999988, -10.499999999999979, -5.399999999999999, -4.299999999999997, -8.399999999999983, -3.5, -3.5, -10.099999999999977, -15.999999999999964, -5.199999999999994, -4.899999999999995, -46.40000000000032, -7.599999999999985, -10.999999999999979, -6.099999999999991, -8.499999999999982, -10.399999999999975, -4.799999999999995, -3.9999999999999982, -4.399999999999997, -6.39999999999999, -62.20000000000043, -8.799999999999981, -12.899999999999967, -27.900000000000112, -40.100000000000186, -4.599999999999996, -7.699999999999985], "episode_lengths": [158, 173, 86, 106, 113, 400, 111, 63, 150, 104, 94, 78, 77, 151, 100, 86, 196, 80, 46, 140, 80, 86, 61, 66, 73, 141, 95, 66, 80, 86, 99, 89, 83, 68, 54, 33, 103, 132, 66, 103, 400, 57, 60, 73, 112, 78, 97, 71, 74, 63, 68, 96, 77, 73, 70, 67, 198, 68, 92, 85, 64, 45, 52, 155, 228, 57, 118, 52, 77, 91, 78, 357, 81, 102, 59, 54, 95, 46, 46, 104, 153, 63, 60, 400, 76, 99, 72, 96, 115, 59, 51, 55, 69, 400, 99, 126, 267, 335, 57, 88]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2124804320244268, "mean_inference_ms": 0.6195069108922276, "mean_action_processing_ms": 0.06827342265966405, "mean_env_wait_ms": 6.076792173512531, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0051267147064208984, "StateBufferConnector_ms": 0.003236055374145508, "ViewRequirementAgentConnector_ms": 0.07456779479980469}}, "episode_reward_max": -2.2000000000000015, "episode_reward_min": -63.4000000000004, "episode_reward_mean": -11.156000000000008, "episode_len_mean": 108.56, "episodes_this_iter": 31, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-15.799999999999962, -19.999999999999975, -8.19999999999999, -10.699999999999976, -10.199999999999976, -55.00000000000029, -10.899999999999977, -5.199999999999994, -15.999999999999961, -9.29999999999998, -8.299999999999983, -6.799999999999988, -6.599999999999989, -16.39999999999997, -8.89999999999998, -7.599999999999987, -19.000000000000007, -6.899999999999988, -3.5, -13.599999999999964, -6.899999999999988, -7.499999999999986, -4.999999999999995, -5.499999999999993, -7.399999999999995, -14.299999999999962, -8.399999999999983, -5.499999999999993, -6.9999999999999885, -7.499999999999986, -8.799999999999981, -8.299999999999988, -7.199999999999987, -5.699999999999992, -4.299999999999997, -2.2000000000000015, -9.19999999999998, -12.09999999999997, -5.499999999999993, -10.399999999999979, -63.4000000000004, -4.599999999999996, -4.899999999999995, -6.799999999999994, -13.49999999999997, -6.699999999999989, -8.599999999999982, -6.299999999999993, -6.29999999999999, -5.199999999999994, -5.699999999999992, -8.599999999999982, -6.599999999999989, -6.5999999999999925, -7.099999999999987, -5.5999999999999925, -23.400000000000055, -5.699999999999992, -8.599999999999982, -8.399999999999988, -5.299999999999994, -3.5, -4.099999999999998, -15.099999999999959, -27.20000000000006, -5.099999999999999, -12.19999999999997, -4.099999999999998, -6.599999999999989, -8.099999999999985, -6.699999999999989, -44.80000000000014, -6.999999999999988, -10.499999999999979, -5.399999999999999, -4.299999999999997, -8.399999999999983, -3.5, -3.5, -10.099999999999977, -15.999999999999964, -5.199999999999994, -4.899999999999995, -46.40000000000032, -7.599999999999985, -10.999999999999979, -6.099999999999991, -8.499999999999982, -10.399999999999975, -4.799999999999995, -3.9999999999999982, -4.399999999999997, -6.39999999999999, -62.20000000000043, -8.799999999999981, -12.899999999999967, -27.900000000000112, -40.100000000000186, -4.599999999999996, -7.699999999999985], "episode_lengths": [158, 173, 86, 106, 113, 400, 111, 63, 150, 104, 94, 78, 77, 151, 100, 86, 196, 80, 46, 140, 80, 86, 61, 66, 73, 141, 95, 66, 80, 86, 99, 89, 83, 68, 54, 33, 103, 132, 66, 103, 400, 57, 60, 73, 112, 78, 97, 71, 74, 63, 68, 96, 77, 73, 70, 67, 198, 68, 92, 85, 64, 45, 52, 155, 228, 57, 118, 52, 77, 91, 78, 357, 81, 102, 59, 54, 95, 46, 46, 104, 153, 63, 60, 400, 76, 99, 72, 96, 115, 59, 51, 55, 69, 400, 99, 126, 267, 335, 57, 88]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2124804320244268, "mean_inference_ms": 0.6195069108922276, "mean_action_processing_ms": 0.06827342265966405, "mean_env_wait_ms": 6.076792173512531, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0051267147064208984, "StateBufferConnector_ms": 0.003236055374145508, "ViewRequirementAgentConnector_ms": 0.07456779479980469}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000, "num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 369.8083343149502, "num_env_steps_trained_throughput_per_sec": 369.8083343149502, "timesteps_total": 72000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 72000, "timers": {"training_iteration_time_ms": 10636.157, "sample_time_ms": 7147.968, "load_time_ms": 1.009, "load_throughput": 3963995.842, "learn_time_ms": 3484.869, "learn_throughput": 1147.819, "synch_weights_time_ms": 1.677}, "counters": {"num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000}, "done": false, "episodes_total": 409, "training_iteration": 18, "trial_id": "329fa_00000", "date": "2024-03-07_12-25-14", "timestamp": 1709832314, "time_this_iter_s": 10.818938255310059, "time_total_s": 190.92841839790344, "pid": 105400, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fcd19c36f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 190.92841839790344, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 18.58, "ram_util_percent": 43.58666666666668, "gpu_util_percent0": 0.096, "vram_util_percent0": 0.1005859375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.10000000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 4.006195303221153, "policy_loss": -0.006064462069902689, "vf_loss": 4.011531176650396, "vf_explained_var": 0.2489065472797681, "kl": 0.007285868591632959, "entropy": 0.9092850399914608, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 17205.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_agent_steps_sampled": 76000, "num_agent_steps_trained": 76000}, "sampler_results": {"episode_reward_max": -3.4000000000000004, "episode_reward_min": -67.4000000000004, "episode_reward_mean": -11.370000000000015, "episode_len_mean": 108.58, "episode_media": {}, "episodes_this_iter": 38, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-5.499999999999993, -10.399999999999979, -63.4000000000004, -4.599999999999996, -4.899999999999995, -6.799999999999994, -13.49999999999997, -6.699999999999989, -8.599999999999982, -6.299999999999993, -6.29999999999999, -5.199999999999994, -5.699999999999992, -8.599999999999982, -6.599999999999989, -6.5999999999999925, -7.099999999999987, -5.5999999999999925, -23.400000000000055, -5.699999999999992, -8.599999999999982, -8.399999999999988, -5.299999999999994, -3.5, -4.099999999999998, -15.099999999999959, -27.20000000000006, -5.099999999999999, -12.19999999999997, -4.099999999999998, -6.599999999999989, -8.099999999999985, -6.699999999999989, -44.80000000000014, -6.999999999999988, -10.499999999999979, -5.399999999999999, -4.299999999999997, -8.399999999999983, -3.5, -3.5, -10.099999999999977, -15.999999999999964, -5.199999999999994, -4.899999999999995, -46.40000000000032, -7.599999999999985, -10.999999999999979, -6.099999999999991, -8.499999999999982, -10.399999999999975, -4.799999999999995, -3.9999999999999982, -4.399999999999997, -6.39999999999999, -62.20000000000043, -8.799999999999981, -12.899999999999967, -27.900000000000112, -40.100000000000186, -4.599999999999996, -7.699999999999985, -8.099999999999984, -5.099999999999994, -6.099999999999991, -4.699999999999996, -4.799999999999995, -4.1999999999999975, -28.50000000000015, -3.5, -7.199999999999987, -7.2999999999999865, -5.099999999999994, -5.199999999999994, -17.399999999999977, -4.899999999999995, -4.1999999999999975, -9.09999999999998, -3.5, -11.299999999999972, -10.799999999999974, -4.999999999999995, -9.899999999999977, -3.4000000000000004, -4.399999999999997, -67.4000000000004, -3.6999999999999993, -6.899999999999988, -6.2999999999999945, -43.40000000000035, -10.599999999999975, -8.199999999999983, -9.499999999999979, -5.099999999999994, -4.799999999999996, -11.399999999999986, -48.80000000000021, -5.999999999999991, -3.5, -3.799999999999999], "episode_lengths": [66, 103, 400, 57, 60, 73, 112, 78, 97, 71, 74, 63, 68, 96, 77, 73, 70, 67, 198, 68, 92, 85, 64, 45, 52, 155, 228, 57, 118, 52, 77, 91, 78, 357, 81, 102, 59, 54, 95, 46, 46, 104, 153, 63, 60, 400, 76, 99, 72, 96, 115, 59, 51, 55, 69, 400, 99, 126, 267, 335, 57, 88, 92, 62, 72, 58, 59, 53, 277, 46, 83, 84, 62, 63, 172, 60, 53, 102, 46, 118, 119, 59, 110, 45, 55, 400, 48, 80, 69, 400, 116, 93, 106, 62, 58, 94, 367, 71, 46, 49]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21382572689580254, "mean_inference_ms": 0.6198679395259352, "mean_action_processing_ms": 0.06837664035852757, "mean_env_wait_ms": 6.081641702414093, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005065202713012695, "StateBufferConnector_ms": 0.003210306167602539, "ViewRequirementAgentConnector_ms": 0.07451510429382324}}, "episode_reward_max": -3.4000000000000004, "episode_reward_min": -67.4000000000004, "episode_reward_mean": -11.370000000000015, "episode_len_mean": 108.58, "episodes_this_iter": 38, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-5.499999999999993, -10.399999999999979, -63.4000000000004, -4.599999999999996, -4.899999999999995, -6.799999999999994, -13.49999999999997, -6.699999999999989, -8.599999999999982, -6.299999999999993, -6.29999999999999, -5.199999999999994, -5.699999999999992, -8.599999999999982, -6.599999999999989, -6.5999999999999925, -7.099999999999987, -5.5999999999999925, -23.400000000000055, -5.699999999999992, -8.599999999999982, -8.399999999999988, -5.299999999999994, -3.5, -4.099999999999998, -15.099999999999959, -27.20000000000006, -5.099999999999999, -12.19999999999997, -4.099999999999998, -6.599999999999989, -8.099999999999985, -6.699999999999989, -44.80000000000014, -6.999999999999988, -10.499999999999979, -5.399999999999999, -4.299999999999997, -8.399999999999983, -3.5, -3.5, -10.099999999999977, -15.999999999999964, -5.199999999999994, -4.899999999999995, -46.40000000000032, -7.599999999999985, -10.999999999999979, -6.099999999999991, -8.499999999999982, -10.399999999999975, -4.799999999999995, -3.9999999999999982, -4.399999999999997, -6.39999999999999, -62.20000000000043, -8.799999999999981, -12.899999999999967, -27.900000000000112, -40.100000000000186, -4.599999999999996, -7.699999999999985, -8.099999999999984, -5.099999999999994, -6.099999999999991, -4.699999999999996, -4.799999999999995, -4.1999999999999975, -28.50000000000015, -3.5, -7.199999999999987, -7.2999999999999865, -5.099999999999994, -5.199999999999994, -17.399999999999977, -4.899999999999995, -4.1999999999999975, -9.09999999999998, -3.5, -11.299999999999972, -10.799999999999974, -4.999999999999995, -9.899999999999977, -3.4000000000000004, -4.399999999999997, -67.4000000000004, -3.6999999999999993, -6.899999999999988, -6.2999999999999945, -43.40000000000035, -10.599999999999975, -8.199999999999983, -9.499999999999979, -5.099999999999994, -4.799999999999996, -11.399999999999986, -48.80000000000021, -5.999999999999991, -3.5, -3.799999999999999], "episode_lengths": [66, 103, 400, 57, 60, 73, 112, 78, 97, 71, 74, 63, 68, 96, 77, 73, 70, 67, 198, 68, 92, 85, 64, 45, 52, 155, 228, 57, 118, 52, 77, 91, 78, 357, 81, 102, 59, 54, 95, 46, 46, 104, 153, 63, 60, 400, 76, 99, 72, 96, 115, 59, 51, 55, 69, 400, 99, 126, 267, 335, 57, 88, 92, 62, 72, 58, 59, 53, 277, 46, 83, 84, 62, 63, 172, 60, 53, 102, 46, 118, 119, 59, 110, 45, 55, 400, 48, 80, 69, 400, 116, 93, 106, 62, 58, 94, 367, 71, 46, 49]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21382572689580254, "mean_inference_ms": 0.6198679395259352, "mean_action_processing_ms": 0.06837664035852757, "mean_env_wait_ms": 6.081641702414093, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005065202713012695, "StateBufferConnector_ms": 0.003210306167602539, "ViewRequirementAgentConnector_ms": 0.07451510429382324}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 76000, "num_agent_steps_trained": 76000, "num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 368.2691190113824, "num_env_steps_trained_throughput_per_sec": 368.2691190113824, "timesteps_total": 76000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 76000, "timers": {"training_iteration_time_ms": 10673.148, "sample_time_ms": 7175.053, "load_time_ms": 1.016, "load_throughput": 3937851.426, "learn_time_ms": 3494.769, "learn_throughput": 1144.568, "synch_weights_time_ms": 1.678}, "counters": {"num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_agent_steps_sampled": 76000, "num_agent_steps_trained": 76000}, "done": false, "episodes_total": 447, "training_iteration": 19, "trial_id": "329fa_00000", "date": "2024-03-07_12-25-25", "timestamp": 1709832325, "time_this_iter_s": 10.864077806472778, "time_total_s": 201.79249620437622, "pid": 105400, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fcd19c36f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 201.79249620437622, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 19.771428571428572, "ram_util_percent": 43.59285714285715, "gpu_util_percent0": 0.08857142857142856, "vram_util_percent0": 0.1005859375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.10000000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 1.9564283090786287, "policy_loss": -0.008292278810654597, "vf_loss": 1.9638865198499413, "vf_explained_var": 0.5375077356574356, "kl": 0.008340682763592674, "entropy": 0.9261039750550383, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 18135.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000}, "sampler_results": {"episode_reward_max": -2.900000000000002, "episode_reward_min": -67.4000000000004, "episode_reward_mean": -9.951000000000011, "episode_len_mean": 99.81, "episode_media": {}, "episodes_this_iter": 49, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8.499999999999982, -10.399999999999975, -4.799999999999995, -3.9999999999999982, -4.399999999999997, -6.39999999999999, -62.20000000000043, -8.799999999999981, -12.899999999999967, -27.900000000000112, -40.100000000000186, -4.599999999999996, -7.699999999999985, -8.099999999999984, -5.099999999999994, -6.099999999999991, -4.699999999999996, -4.799999999999995, -4.1999999999999975, -28.50000000000015, -3.5, -7.199999999999987, -7.2999999999999865, -5.099999999999994, -5.199999999999994, -17.399999999999977, -4.899999999999995, -4.1999999999999975, -9.09999999999998, -3.5, -11.299999999999972, -10.799999999999974, -4.999999999999995, -9.899999999999977, -3.4000000000000004, -4.399999999999997, -67.4000000000004, -3.6999999999999993, -6.899999999999988, -6.2999999999999945, -43.40000000000035, -10.599999999999975, -8.199999999999983, -9.499999999999979, -5.099999999999994, -4.799999999999996, -11.399999999999986, -48.80000000000021, -5.999999999999991, -3.5, -3.799999999999999, -5.299999999999994, -5.099999999999994, -8.299999999999985, -8.89999999999998, -7.599999999999985, -25.700000000000056, -6.499999999999989, -7.8999999999999915, -5.899999999999993, -6.69999999999999, -7.999999999999984, -24.6, -11.699999999999974, -6.599999999999989, -11.399999999999972, -6.099999999999991, -4.799999999999995, -8.499999999999982, -7.599999999999985, -5.2999999999999945, -2.900000000000002, -4.599999999999996, -8.199999999999983, -4.599999999999996, -10.599999999999975, -4.999999999999995, -7.79999999999999, -6.39999999999999, -3.9999999999999982, -5.199999999999996, -3.6999999999999993, -9.499999999999979, -6.29999999999999, -9.29999999999998, -5.099999999999996, -7.999999999999986, -4.899999999999995, -5.099999999999994, -8.99999999999998, -2.900000000000002, -4.1000000000000005, -4.699999999999996, -3.5, -8.99999999999998, -20.20000000000002, -4.4999999999999964, -10.49999999999998, -11.599999999999978, -5.5999999999999925], "episode_lengths": [96, 115, 59, 51, 55, 69, 400, 99, 126, 267, 335, 57, 88, 92, 62, 72, 58, 59, 53, 277, 46, 83, 84, 62, 63, 172, 60, 53, 102, 46, 118, 119, 59, 110, 45, 55, 400, 48, 80, 69, 400, 116, 93, 106, 62, 58, 94, 367, 71, 46, 49, 64, 62, 93, 100, 87, 232, 76, 83, 68, 76, 91, 224, 106, 77, 115, 72, 59, 96, 87, 63, 40, 57, 91, 57, 117, 61, 83, 75, 51, 61, 48, 106, 74, 104, 60, 89, 60, 62, 101, 40, 49, 58, 46, 101, 198, 56, 110, 102, 67]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21577261543748186, "mean_inference_ms": 0.6199515966930916, "mean_action_processing_ms": 0.06834423065896583, "mean_env_wait_ms": 6.092302314534418, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0049016475677490234, "StateBufferConnector_ms": 0.0031685829162597656, "ViewRequirementAgentConnector_ms": 0.0745534896850586}}, "episode_reward_max": -2.900000000000002, "episode_reward_min": -67.4000000000004, "episode_reward_mean": -9.951000000000011, "episode_len_mean": 99.81, "episodes_this_iter": 49, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-8.499999999999982, -10.399999999999975, -4.799999999999995, -3.9999999999999982, -4.399999999999997, -6.39999999999999, -62.20000000000043, -8.799999999999981, -12.899999999999967, -27.900000000000112, -40.100000000000186, -4.599999999999996, -7.699999999999985, -8.099999999999984, -5.099999999999994, -6.099999999999991, -4.699999999999996, -4.799999999999995, -4.1999999999999975, -28.50000000000015, -3.5, -7.199999999999987, -7.2999999999999865, -5.099999999999994, -5.199999999999994, -17.399999999999977, -4.899999999999995, -4.1999999999999975, -9.09999999999998, -3.5, -11.299999999999972, -10.799999999999974, -4.999999999999995, -9.899999999999977, -3.4000000000000004, -4.399999999999997, -67.4000000000004, -3.6999999999999993, -6.899999999999988, -6.2999999999999945, -43.40000000000035, -10.599999999999975, -8.199999999999983, -9.499999999999979, -5.099999999999994, -4.799999999999996, -11.399999999999986, -48.80000000000021, -5.999999999999991, -3.5, -3.799999999999999, -5.299999999999994, -5.099999999999994, -8.299999999999985, -8.89999999999998, -7.599999999999985, -25.700000000000056, -6.499999999999989, -7.8999999999999915, -5.899999999999993, -6.69999999999999, -7.999999999999984, -24.6, -11.699999999999974, -6.599999999999989, -11.399999999999972, -6.099999999999991, -4.799999999999995, -8.499999999999982, -7.599999999999985, -5.2999999999999945, -2.900000000000002, -4.599999999999996, -8.199999999999983, -4.599999999999996, -10.599999999999975, -4.999999999999995, -7.79999999999999, -6.39999999999999, -3.9999999999999982, -5.199999999999996, -3.6999999999999993, -9.499999999999979, -6.29999999999999, -9.29999999999998, -5.099999999999996, -7.999999999999986, -4.899999999999995, -5.099999999999994, -8.99999999999998, -2.900000000000002, -4.1000000000000005, -4.699999999999996, -3.5, -8.99999999999998, -20.20000000000002, -4.4999999999999964, -10.49999999999998, -11.599999999999978, -5.5999999999999925], "episode_lengths": [96, 115, 59, 51, 55, 69, 400, 99, 126, 267, 335, 57, 88, 92, 62, 72, 58, 59, 53, 277, 46, 83, 84, 62, 63, 172, 60, 53, 102, 46, 118, 119, 59, 110, 45, 55, 400, 48, 80, 69, 400, 116, 93, 106, 62, 58, 94, 367, 71, 46, 49, 64, 62, 93, 100, 87, 232, 76, 83, 68, 76, 91, 224, 106, 77, 115, 72, 59, 96, 87, 63, 40, 57, 91, 57, 117, 61, 83, 75, 51, 61, 48, 106, 74, 104, 60, 89, 60, 62, 101, 40, 49, 58, 46, 101, 198, 56, 110, 102, 67]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21577261543748186, "mean_inference_ms": 0.6199515966930916, "mean_action_processing_ms": 0.06834423065896583, "mean_env_wait_ms": 6.092302314534418, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0049016475677490234, "StateBufferConnector_ms": 0.0031685829162597656, "ViewRequirementAgentConnector_ms": 0.0745534896850586}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000, "num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 372.7988966165775, "num_env_steps_trained_throughput_per_sec": 372.7988966165775, "timesteps_total": 80000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 80000, "timers": {"training_iteration_time_ms": 10682.536, "sample_time_ms": 7189.698, "load_time_ms": 1.016, "load_throughput": 3938590.981, "learn_time_ms": 3489.373, "learn_throughput": 1146.338, "synch_weights_time_ms": 1.778}, "counters": {"num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000}, "done": false, "episodes_total": 496, "training_iteration": 20, "trial_id": "329fa_00000", "date": "2024-03-07_12-25-35", "timestamp": 1709832335, "time_this_iter_s": 10.73215126991272, "time_total_s": 212.52464747428894, "pid": 105400, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fcd19c36f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 212.52464747428894, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 19.685714285714283, "ram_util_percent": 43.60000000000001, "gpu_util_percent0": 0.08, "vram_util_percent0": 0.1005859375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.10000000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 2.0839398665166513, "policy_loss": -0.015863607375211614, "vf_loss": 2.0989535081530772, "vf_explained_var": 0.5008634777479274, "kl": 0.008499683506727876, "entropy": 0.8851216844333115, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 19065.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 84000}, "sampler_results": {"episode_reward_max": -2.1000000000000014, "episode_reward_min": -25.700000000000056, "episode_reward_mean": -7.148999999999994, "episode_len_mean": 78.78, "episode_media": {}, "episodes_this_iter": 54, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8.89999999999998, -7.599999999999985, -25.700000000000056, -6.499999999999989, -7.8999999999999915, -5.899999999999993, -6.69999999999999, -7.999999999999984, -24.6, -11.699999999999974, -6.599999999999989, -11.399999999999972, -6.099999999999991, -4.799999999999995, -8.499999999999982, -7.599999999999985, -5.2999999999999945, -2.900000000000002, -4.599999999999996, -8.199999999999983, -4.599999999999996, -10.599999999999975, -4.999999999999995, -7.79999999999999, -6.39999999999999, -3.9999999999999982, -5.199999999999996, -3.6999999999999993, -9.499999999999979, -6.29999999999999, -9.29999999999998, -5.099999999999996, -7.999999999999986, -4.899999999999995, -5.099999999999994, -8.99999999999998, -2.900000000000002, -4.1000000000000005, -4.699999999999996, -3.5, -8.99999999999998, -20.20000000000002, -4.4999999999999964, -10.49999999999998, -11.599999999999978, -5.5999999999999925, -3.3000000000000007, -5.799999999999994, -4.700000000000001, -5.799999999999992, -6.9999999999999885, -4.699999999999996, -2.1000000000000014, -18.1, -10.499999999999977, -4.999999999999995, -5.399999999999998, -3.799999999999999, -14.999999999999961, -7.89999999999999, -4.299999999999997, -4.099999999999998, -3.6999999999999993, -5.099999999999994, -5.5999999999999925, -3.4000000000000004, -3.4000000000000004, -6.999999999999988, -14.59999999999996, -4.099999999999998, -6.899999999999988, -5.999999999999991, -3.0000000000000018, -5.199999999999994, -17.299999999999986, -6.199999999999991, -3.4000000000000004, -3.5, -6.599999999999989, -7.499999999999995, -8.99999999999998, -5.099999999999997, -4.499999999999999, -4.799999999999995, -6.099999999999993, -17.199999999999957, -4.4999999999999964, -3.1000000000000014, -23.600000000000048, -4.799999999999995, -7.599999999999985, -6.599999999999989, -4.999999999999995, -4.599999999999996, -3.0000000000000018, -4.699999999999996, -4.4999999999999964, -4.4999999999999964, -7.899999999999984, -3.200000000000001], "episode_lengths": [100, 87, 232, 76, 83, 68, 76, 91, 224, 106, 77, 115, 72, 59, 96, 87, 63, 40, 57, 91, 57, 117, 61, 83, 75, 51, 61, 48, 106, 74, 104, 60, 89, 60, 62, 101, 40, 49, 58, 46, 101, 198, 56, 110, 102, 67, 44, 67, 52, 69, 80, 58, 32, 168, 99, 61, 60, 49, 147, 84, 54, 52, 48, 62, 67, 45, 45, 81, 141, 52, 80, 71, 41, 63, 175, 72, 45, 46, 77, 76, 100, 59, 53, 59, 69, 138, 56, 42, 218, 59, 87, 77, 61, 57, 41, 58, 56, 56, 90, 43]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2180273329371648, "mean_inference_ms": 0.6202671426950842, "mean_action_processing_ms": 0.06841951707675768, "mean_env_wait_ms": 6.102247176132977, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004923343658447266, "StateBufferConnector_ms": 0.003142118453979492, "ViewRequirementAgentConnector_ms": 0.07386136054992676}}, "episode_reward_max": -2.1000000000000014, "episode_reward_min": -25.700000000000056, "episode_reward_mean": -7.148999999999994, "episode_len_mean": 78.78, "episodes_this_iter": 54, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-8.89999999999998, -7.599999999999985, -25.700000000000056, -6.499999999999989, -7.8999999999999915, -5.899999999999993, -6.69999999999999, -7.999999999999984, -24.6, -11.699999999999974, -6.599999999999989, -11.399999999999972, -6.099999999999991, -4.799999999999995, -8.499999999999982, -7.599999999999985, -5.2999999999999945, -2.900000000000002, -4.599999999999996, -8.199999999999983, -4.599999999999996, -10.599999999999975, -4.999999999999995, -7.79999999999999, -6.39999999999999, -3.9999999999999982, -5.199999999999996, -3.6999999999999993, -9.499999999999979, -6.29999999999999, -9.29999999999998, -5.099999999999996, -7.999999999999986, -4.899999999999995, -5.099999999999994, -8.99999999999998, -2.900000000000002, -4.1000000000000005, -4.699999999999996, -3.5, -8.99999999999998, -20.20000000000002, -4.4999999999999964, -10.49999999999998, -11.599999999999978, -5.5999999999999925, -3.3000000000000007, -5.799999999999994, -4.700000000000001, -5.799999999999992, -6.9999999999999885, -4.699999999999996, -2.1000000000000014, -18.1, -10.499999999999977, -4.999999999999995, -5.399999999999998, -3.799999999999999, -14.999999999999961, -7.89999999999999, -4.299999999999997, -4.099999999999998, -3.6999999999999993, -5.099999999999994, -5.5999999999999925, -3.4000000000000004, -3.4000000000000004, -6.999999999999988, -14.59999999999996, -4.099999999999998, -6.899999999999988, -5.999999999999991, -3.0000000000000018, -5.199999999999994, -17.299999999999986, -6.199999999999991, -3.4000000000000004, -3.5, -6.599999999999989, -7.499999999999995, -8.99999999999998, -5.099999999999997, -4.499999999999999, -4.799999999999995, -6.099999999999993, -17.199999999999957, -4.4999999999999964, -3.1000000000000014, -23.600000000000048, -4.799999999999995, -7.599999999999985, -6.599999999999989, -4.999999999999995, -4.599999999999996, -3.0000000000000018, -4.699999999999996, -4.4999999999999964, -4.4999999999999964, -7.899999999999984, -3.200000000000001], "episode_lengths": [100, 87, 232, 76, 83, 68, 76, 91, 224, 106, 77, 115, 72, 59, 96, 87, 63, 40, 57, 91, 57, 117, 61, 83, 75, 51, 61, 48, 106, 74, 104, 60, 89, 60, 62, 101, 40, 49, 58, 46, 101, 198, 56, 110, 102, 67, 44, 67, 52, 69, 80, 58, 32, 168, 99, 61, 60, 49, 147, 84, 54, 52, 48, 62, 67, 45, 45, 81, 141, 52, 80, 71, 41, 63, 175, 72, 45, 46, 77, 76, 100, 59, 53, 59, 69, 138, 56, 42, 218, 59, 87, 77, 61, 57, 41, 58, 56, 56, 90, 43]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2180273329371648, "mean_inference_ms": 0.6202671426950842, "mean_action_processing_ms": 0.06841951707675768, "mean_env_wait_ms": 6.102247176132977, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004923343658447266, "StateBufferConnector_ms": 0.003142118453979492, "ViewRequirementAgentConnector_ms": 0.07386136054992676}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 84000, "num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 365.03562081257184, "num_env_steps_trained_throughput_per_sec": 365.03562081257184, "timesteps_total": 84000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 84000, "timers": {"training_iteration_time_ms": 10714.375, "sample_time_ms": 7229.038, "load_time_ms": 1.013, "load_throughput": 3947580.235, "learn_time_ms": 3481.861, "learn_throughput": 1148.811, "synch_weights_time_ms": 1.788}, "counters": {"num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 84000}, "done": false, "episodes_total": 550, "training_iteration": 21, "trial_id": "329fa_00000", "date": "2024-03-07_12-25-47", "timestamp": 1709832347, "time_this_iter_s": 10.960131168365479, "time_total_s": 223.48477864265442, "pid": 105400, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fcd19c36f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 223.48477864265442, "iterations_since_restore": 21, "perf": {"cpu_util_percent": 20.52857142857143, "ram_util_percent": 43.60000000000001, "gpu_util_percent0": 0.08285714285714285, "vram_util_percent0": 0.1005859375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.10000000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 1.325861083807033, "policy_loss": -0.008963594068923305, "vf_loss": 1.3339740898660435, "vf_explained_var": 0.6534532154119143, "kl": 0.008505794498950349, "entropy": 0.8735877973418082, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 19995.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_agent_steps_sampled": 88000, "num_agent_steps_trained": 88000}, "sampler_results": {"episode_reward_max": -2.700000000000002, "episode_reward_min": -23.600000000000048, "episode_reward_mean": -6.0019999999999945, "episode_len_mean": 68.63, "episode_media": {}, "episodes_this_iter": 62, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.6999999999999993, -5.099999999999994, -5.5999999999999925, -3.4000000000000004, -3.4000000000000004, -6.999999999999988, -14.59999999999996, -4.099999999999998, -6.899999999999988, -5.999999999999991, -3.0000000000000018, -5.199999999999994, -17.299999999999986, -6.199999999999991, -3.4000000000000004, -3.5, -6.599999999999989, -7.499999999999995, -8.99999999999998, -5.099999999999997, -4.499999999999999, -4.799999999999995, -6.099999999999993, -17.199999999999957, -4.4999999999999964, -3.1000000000000014, -23.600000000000048, -4.799999999999995, -7.599999999999985, -6.599999999999989, -4.999999999999995, -4.599999999999996, -3.0000000000000018, -4.699999999999996, -4.4999999999999964, -4.4999999999999964, -7.899999999999984, -3.200000000000001, -6.699999999999989, -3.6999999999999993, -4.699999999999996, -4.1999999999999975, -4.299999999999997, -4.299999999999997, -4.299999999999998, -4.399999999999997, -6.199999999999996, -2.700000000000002, -4.899999999999995, -4.699999999999996, -4.299999999999997, -5.399999999999993, -9.09999999999998, -5.299999999999994, -5.999999999999991, -7.999999999999995, -6.499999999999991, -5.699999999999992, -5.399999999999993, -3.200000000000001, -5.099999999999996, -4.899999999999995, -3.3000000000000007, -3.9999999999999982, -4.799999999999995, -4.699999999999998, -3.6999999999999993, -6.19999999999999, -8.499999999999986, -4.799999999999995, -10.699999999999974, -3.200000000000001, -6.099999999999995, -5.299999999999994, -4.4999999999999964, -6.699999999999989, -6.199999999999992, -6.499999999999994, -18.200000000000006, -4.299999999999997, -3.8999999999999986, -8.399999999999984, -3.8999999999999986, -4.499999999999997, -2.900000000000002, -15.299999999999969, -4.299999999999997, -8.399999999999986, -3.4000000000000004, -4.299999999999997, -3.9999999999999982, -4.399999999999997, -5.399999999999993, -3.7, -5.499999999999993, -5.999999999999991, -12.199999999999969, -3.5, -8.599999999999987, -5.099999999999994], "episode_lengths": [48, 62, 67, 45, 45, 81, 141, 52, 80, 71, 41, 63, 175, 72, 45, 46, 77, 76, 100, 59, 53, 59, 69, 138, 56, 42, 218, 59, 87, 77, 61, 57, 41, 58, 56, 56, 90, 43, 78, 48, 58, 53, 54, 54, 53, 55, 67, 38, 60, 58, 54, 65, 96, 64, 71, 80, 74, 68, 65, 43, 59, 60, 44, 51, 59, 55, 48, 73, 90, 59, 112, 43, 67, 64, 56, 78, 71, 71, 184, 54, 50, 93, 50, 55, 40, 153, 54, 87, 45, 54, 51, 55, 65, 47, 66, 70, 114, 46, 86, 62]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2205988380959299, "mean_inference_ms": 0.6204939764715361, "mean_action_processing_ms": 0.06845069035359266, "mean_env_wait_ms": 6.11884426315145, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0049440860748291016, "StateBufferConnector_ms": 0.003141641616821289, "ViewRequirementAgentConnector_ms": 0.07380890846252441}}, "episode_reward_max": -2.700000000000002, "episode_reward_min": -23.600000000000048, "episode_reward_mean": -6.0019999999999945, "episode_len_mean": 68.63, "episodes_this_iter": 62, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3.6999999999999993, -5.099999999999994, -5.5999999999999925, -3.4000000000000004, -3.4000000000000004, -6.999999999999988, -14.59999999999996, -4.099999999999998, -6.899999999999988, -5.999999999999991, -3.0000000000000018, -5.199999999999994, -17.299999999999986, -6.199999999999991, -3.4000000000000004, -3.5, -6.599999999999989, -7.499999999999995, -8.99999999999998, -5.099999999999997, -4.499999999999999, -4.799999999999995, -6.099999999999993, -17.199999999999957, -4.4999999999999964, -3.1000000000000014, -23.600000000000048, -4.799999999999995, -7.599999999999985, -6.599999999999989, -4.999999999999995, -4.599999999999996, -3.0000000000000018, -4.699999999999996, -4.4999999999999964, -4.4999999999999964, -7.899999999999984, -3.200000000000001, -6.699999999999989, -3.6999999999999993, -4.699999999999996, -4.1999999999999975, -4.299999999999997, -4.299999999999997, -4.299999999999998, -4.399999999999997, -6.199999999999996, -2.700000000000002, -4.899999999999995, -4.699999999999996, -4.299999999999997, -5.399999999999993, -9.09999999999998, -5.299999999999994, -5.999999999999991, -7.999999999999995, -6.499999999999991, -5.699999999999992, -5.399999999999993, -3.200000000000001, -5.099999999999996, -4.899999999999995, -3.3000000000000007, -3.9999999999999982, -4.799999999999995, -4.699999999999998, -3.6999999999999993, -6.19999999999999, -8.499999999999986, -4.799999999999995, -10.699999999999974, -3.200000000000001, -6.099999999999995, -5.299999999999994, -4.4999999999999964, -6.699999999999989, -6.199999999999992, -6.499999999999994, -18.200000000000006, -4.299999999999997, -3.8999999999999986, -8.399999999999984, -3.8999999999999986, -4.499999999999997, -2.900000000000002, -15.299999999999969, -4.299999999999997, -8.399999999999986, -3.4000000000000004, -4.299999999999997, -3.9999999999999982, -4.399999999999997, -5.399999999999993, -3.7, -5.499999999999993, -5.999999999999991, -12.199999999999969, -3.5, -8.599999999999987, -5.099999999999994], "episode_lengths": [48, 62, 67, 45, 45, 81, 141, 52, 80, 71, 41, 63, 175, 72, 45, 46, 77, 76, 100, 59, 53, 59, 69, 138, 56, 42, 218, 59, 87, 77, 61, 57, 41, 58, 56, 56, 90, 43, 78, 48, 58, 53, 54, 54, 53, 55, 67, 38, 60, 58, 54, 65, 96, 64, 71, 80, 74, 68, 65, 43, 59, 60, 44, 51, 59, 55, 48, 73, 90, 59, 112, 43, 67, 64, 56, 78, 71, 71, 184, 54, 50, 93, 50, 55, 40, 153, 54, 87, 45, 54, 51, 55, 65, 47, 66, 70, 114, 46, 86, 62]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2205988380959299, "mean_inference_ms": 0.6204939764715361, "mean_action_processing_ms": 0.06845069035359266, "mean_env_wait_ms": 6.11884426315145, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0049440860748291016, "StateBufferConnector_ms": 0.003141641616821289, "ViewRequirementAgentConnector_ms": 0.07380890846252441}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 88000, "num_agent_steps_trained": 88000, "num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 365.49828613204244, "num_env_steps_trained_throughput_per_sec": 365.49828613204244, "timesteps_total": 88000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 88000, "timers": {"training_iteration_time_ms": 10745.261, "sample_time_ms": 7264.123, "load_time_ms": 1.012, "load_throughput": 3953906.486, "learn_time_ms": 3477.674, "learn_throughput": 1150.194, "synch_weights_time_ms": 1.777}, "counters": {"num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_agent_steps_sampled": 88000, "num_agent_steps_trained": 88000}, "done": false, "episodes_total": 612, "training_iteration": 22, "trial_id": "329fa_00000", "date": "2024-03-07_12-25-57", "timestamp": 1709832357, "time_this_iter_s": 10.946373224258423, "time_total_s": 234.43115186691284, "pid": 105400, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fcd19c36f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 234.43115186691284, "iterations_since_restore": 22, "perf": {"cpu_util_percent": 20.24285714285714, "ram_util_percent": 43.60000000000001, "gpu_util_percent0": 0.07714285714285715, "vram_util_percent0": 0.1005859375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.10000000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 2.2878003752625156, "policy_loss": -0.012833580723212612, "vf_loss": 2.299522142384642, "vf_explained_var": 0.44804985157905086, "kl": 0.011118092706902387, "entropy": 0.8477031948104982, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 20925.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_agent_steps_sampled": 92000, "num_agent_steps_trained": 92000}, "sampler_results": {"episode_reward_max": -2.5000000000000018, "episode_reward_min": -41.40000000000032, "episode_reward_mean": -5.869999999999999, "episode_len_mean": 67.57, "episode_media": {}, "episodes_this_iter": 59, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.200000000000001, -5.099999999999996, -4.899999999999995, -3.3000000000000007, -3.9999999999999982, -4.799999999999995, -4.699999999999998, -3.6999999999999993, -6.19999999999999, -8.499999999999986, -4.799999999999995, -10.699999999999974, -3.200000000000001, -6.099999999999995, -5.299999999999994, -4.4999999999999964, -6.699999999999989, -6.199999999999992, -6.499999999999994, -18.200000000000006, -4.299999999999997, -3.8999999999999986, -8.399999999999984, -3.8999999999999986, -4.499999999999997, -2.900000000000002, -15.299999999999969, -4.299999999999997, -8.399999999999986, -3.4000000000000004, -4.299999999999997, -3.9999999999999982, -4.399999999999997, -5.399999999999993, -3.7, -5.499999999999993, -5.999999999999991, -12.199999999999969, -3.5, -8.599999999999987, -5.099999999999994, -2.5000000000000018, -2.700000000000002, -4.099999999999998, -3.8999999999999986, -4.000000000000002, -4.299999999999997, -3.9999999999999982, -5.099999999999994, -5.099999999999994, -4.1999999999999975, -30.800000000000143, -7.599999999999987, -3.5, -3.8999999999999986, -41.40000000000032, -4.699999999999996, -3.0000000000000018, -2.800000000000002, -3.5, -2.5000000000000018, -4.1999999999999975, -3.5, -3.799999999999999, -3.0000000000000018, -4.799999999999995, -4.799999999999995, -3.1000000000000014, -5.799999999999992, -2.600000000000002, -3.6999999999999993, -3.8999999999999986, -9.099999999999982, -4.999999999999995, -3.1000000000000014, -5.699999999999992, -3.6999999999999993, -3.4000000000000004, -6.999999999999989, -3.0000000000000018, -4.899999999999995, -13.499999999999964, -6.899999999999988, -4.999999999999995, -3.3000000000000007, -6.699999999999996, -4.199999999999998, -2.700000000000002, -7.099999999999987, -4.399999999999997, -5.099999999999994, -4.399999999999998, -3.9999999999999982, -3.5, -5.5999999999999925, -6.999999999999991, -6.799999999999992, -3.5999999999999996, -7.1999999999999975, -11.69999999999997], "episode_lengths": [43, 59, 60, 44, 51, 59, 55, 48, 73, 90, 59, 112, 43, 67, 64, 56, 78, 71, 71, 184, 54, 50, 93, 50, 55, 40, 153, 54, 87, 45, 54, 51, 55, 65, 47, 66, 70, 114, 46, 86, 62, 36, 38, 52, 50, 47, 54, 51, 55, 62, 53, 299, 82, 46, 50, 400, 58, 41, 38, 46, 36, 53, 46, 49, 41, 59, 55, 42, 69, 37, 48, 50, 93, 61, 42, 68, 48, 45, 79, 41, 60, 132, 80, 61, 44, 70, 52, 38, 82, 55, 62, 54, 51, 46, 67, 77, 75, 47, 72, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.22281103102864108, "mean_inference_ms": 0.620717288437245, "mean_action_processing_ms": 0.06843316044776504, "mean_env_wait_ms": 6.1357398315871885, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005013227462768555, "StateBufferConnector_ms": 0.0031821727752685547, "ViewRequirementAgentConnector_ms": 0.0744783878326416}}, "episode_reward_max": -2.5000000000000018, "episode_reward_min": -41.40000000000032, "episode_reward_mean": -5.869999999999999, "episode_len_mean": 67.57, "episodes_this_iter": 59, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3.200000000000001, -5.099999999999996, -4.899999999999995, -3.3000000000000007, -3.9999999999999982, -4.799999999999995, -4.699999999999998, -3.6999999999999993, -6.19999999999999, -8.499999999999986, -4.799999999999995, -10.699999999999974, -3.200000000000001, -6.099999999999995, -5.299999999999994, -4.4999999999999964, -6.699999999999989, -6.199999999999992, -6.499999999999994, -18.200000000000006, -4.299999999999997, -3.8999999999999986, -8.399999999999984, -3.8999999999999986, -4.499999999999997, -2.900000000000002, -15.299999999999969, -4.299999999999997, -8.399999999999986, -3.4000000000000004, -4.299999999999997, -3.9999999999999982, -4.399999999999997, -5.399999999999993, -3.7, -5.499999999999993, -5.999999999999991, -12.199999999999969, -3.5, -8.599999999999987, -5.099999999999994, -2.5000000000000018, -2.700000000000002, -4.099999999999998, -3.8999999999999986, -4.000000000000002, -4.299999999999997, -3.9999999999999982, -5.099999999999994, -5.099999999999994, -4.1999999999999975, -30.800000000000143, -7.599999999999987, -3.5, -3.8999999999999986, -41.40000000000032, -4.699999999999996, -3.0000000000000018, -2.800000000000002, -3.5, -2.5000000000000018, -4.1999999999999975, -3.5, -3.799999999999999, -3.0000000000000018, -4.799999999999995, -4.799999999999995, -3.1000000000000014, -5.799999999999992, -2.600000000000002, -3.6999999999999993, -3.8999999999999986, -9.099999999999982, -4.999999999999995, -3.1000000000000014, -5.699999999999992, -3.6999999999999993, -3.4000000000000004, -6.999999999999989, -3.0000000000000018, -4.899999999999995, -13.499999999999964, -6.899999999999988, -4.999999999999995, -3.3000000000000007, -6.699999999999996, -4.199999999999998, -2.700000000000002, -7.099999999999987, -4.399999999999997, -5.099999999999994, -4.399999999999998, -3.9999999999999982, -3.5, -5.5999999999999925, -6.999999999999991, -6.799999999999992, -3.5999999999999996, -7.1999999999999975, -11.69999999999997], "episode_lengths": [43, 59, 60, 44, 51, 59, 55, 48, 73, 90, 59, 112, 43, 67, 64, 56, 78, 71, 71, 184, 54, 50, 93, 50, 55, 40, 153, 54, 87, 45, 54, 51, 55, 65, 47, 66, 70, 114, 46, 86, 62, 36, 38, 52, 50, 47, 54, 51, 55, 62, 53, 299, 82, 46, 50, 400, 58, 41, 38, 46, 36, 53, 46, 49, 41, 59, 55, 42, 69, 37, 48, 50, 93, 61, 42, 68, 48, 45, 79, 41, 60, 132, 80, 61, 44, 70, 52, 38, 82, 55, 62, 54, 51, 46, 67, 77, 75, 47, 72, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.22281103102864108, "mean_inference_ms": 0.620717288437245, "mean_action_processing_ms": 0.06843316044776504, "mean_env_wait_ms": 6.1357398315871885, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005013227462768555, "StateBufferConnector_ms": 0.0031821727752685547, "ViewRequirementAgentConnector_ms": 0.0744783878326416}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 92000, "num_agent_steps_trained": 92000, "num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 365.58851584391897, "num_env_steps_trained_throughput_per_sec": 365.58851584391897, "timesteps_total": 92000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 92000, "timers": {"training_iteration_time_ms": 10777.849, "sample_time_ms": 7300.774, "load_time_ms": 0.984, "load_throughput": 4064444.983, "learn_time_ms": 3473.646, "learn_throughput": 1151.528, "synch_weights_time_ms": 1.77}, "counters": {"num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_agent_steps_sampled": 92000, "num_agent_steps_trained": 92000}, "done": false, "episodes_total": 671, "training_iteration": 23, "trial_id": "329fa_00000", "date": "2024-03-07_12-26-08", "timestamp": 1709832368, "time_this_iter_s": 10.943610668182373, "time_total_s": 245.37476253509521, "pid": 105400, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fcd19c36f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 245.37476253509521, "iterations_since_restore": 23, "perf": {"cpu_util_percent": 20.128571428571433, "ram_util_percent": 43.592857142857156, "gpu_util_percent0": 0.075, "vram_util_percent0": 0.1005859375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.10000000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 1.3554279406626975, "policy_loss": -0.013954308592984754, "vf_loss": 1.368331100671522, "vf_explained_var": 0.643333904268921, "kl": 0.010511460598999909, "entropy": 0.8005175660374344, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 21855.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000}, "sampler_results": {"episode_reward_max": -2.4000000000000017, "episode_reward_min": -15.599999999999973, "episode_reward_mean": -4.835999999999996, "episode_len_mean": 57.83, "episode_media": {}, "episodes_this_iter": 73, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4.999999999999995, -3.1000000000000014, -5.699999999999992, -3.6999999999999993, -3.4000000000000004, -6.999999999999989, -3.0000000000000018, -4.899999999999995, -13.499999999999964, -6.899999999999988, -4.999999999999995, -3.3000000000000007, -6.699999999999996, -4.199999999999998, -2.700000000000002, -7.099999999999987, -4.399999999999997, -5.099999999999994, -4.399999999999998, -3.9999999999999982, -3.5, -5.5999999999999925, -6.999999999999991, -6.799999999999992, -3.5999999999999996, -7.1999999999999975, -11.69999999999997, -4.599999999999996, -3.200000000000001, -3.4000000000000004, -8.799999999999981, -3.0000000000000018, -2.800000000000002, -9.299999999999981, -2.700000000000002, -4.599999999999996, -3.1000000000000014, -3.4000000000000004, -4.999999999999995, -4.799999999999995, -4.1999999999999975, -4.1999999999999975, -4.000000000000002, -15.599999999999973, -3.8999999999999986, -4.7, -3.200000000000001, -5.099999999999996, -3.0000000000000018, -3.8999999999999986, -6.19999999999999, -4.799999999999995, -3.3000000000000007, -3.0000000000000018, -3.6999999999999993, -4.099999999999998, -4.699999999999996, -3.799999999999999, -4.299999999999997, -3.3000000000000007, -3.5, -4.4999999999999964, -4.599999999999996, -3.4000000000000004, -3.5, -7.499999999999986, -3.1000000000000014, -2.4000000000000017, -4.1999999999999975, -6.999999999999997, -3.5999999999999996, -3.6999999999999993, -3.6999999999999993, -3.200000000000001, -4.699999999999996, -5.199999999999994, -4.1999999999999975, -10.999999999999973, -3.4000000000000004, -2.600000000000002, -4.699999999999996, -3.3000000000000007, -4.1999999999999975, -4.699999999999996, -9.299999999999994, -3.3000000000000007, -3.799999999999999, -2.600000000000002, -10.99999999999998, -3.3000000000000007, -3.5999999999999996, -3.5999999999999996, -6.099999999999996, -3.8999999999999986, -3.5, -3.6999999999999993, -3.3000000000000007, -5.8999999999999915, -3.8999999999999986, -6.69999999999999], "episode_lengths": [61, 42, 68, 48, 45, 79, 41, 60, 132, 80, 61, 44, 70, 52, 38, 82, 55, 62, 54, 51, 46, 67, 77, 75, 47, 72, 128, 57, 43, 45, 99, 41, 39, 88, 38, 57, 42, 45, 61, 59, 53, 53, 46, 154, 50, 52, 43, 58, 41, 50, 73, 59, 44, 41, 48, 52, 58, 49, 54, 44, 46, 56, 57, 45, 46, 86, 42, 35, 53, 70, 47, 48, 48, 43, 58, 63, 53, 111, 45, 37, 58, 44, 53, 58, 79, 44, 49, 37, 111, 44, 47, 47, 66, 50, 46, 48, 44, 70, 50, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.22593549358947385, "mean_inference_ms": 0.6204507318886825, "mean_action_processing_ms": 0.06832438278236365, "mean_env_wait_ms": 6.154842441446128, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0050127506256103516, "StateBufferConnector_ms": 0.003173351287841797, "ViewRequirementAgentConnector_ms": 0.07403826713562012}}, "episode_reward_max": -2.4000000000000017, "episode_reward_min": -15.599999999999973, "episode_reward_mean": -4.835999999999996, "episode_len_mean": 57.83, "episodes_this_iter": 73, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-4.999999999999995, -3.1000000000000014, -5.699999999999992, -3.6999999999999993, -3.4000000000000004, -6.999999999999989, -3.0000000000000018, -4.899999999999995, -13.499999999999964, -6.899999999999988, -4.999999999999995, -3.3000000000000007, -6.699999999999996, -4.199999999999998, -2.700000000000002, -7.099999999999987, -4.399999999999997, -5.099999999999994, -4.399999999999998, -3.9999999999999982, -3.5, -5.5999999999999925, -6.999999999999991, -6.799999999999992, -3.5999999999999996, -7.1999999999999975, -11.69999999999997, -4.599999999999996, -3.200000000000001, -3.4000000000000004, -8.799999999999981, -3.0000000000000018, -2.800000000000002, -9.299999999999981, -2.700000000000002, -4.599999999999996, -3.1000000000000014, -3.4000000000000004, -4.999999999999995, -4.799999999999995, -4.1999999999999975, -4.1999999999999975, -4.000000000000002, -15.599999999999973, -3.8999999999999986, -4.7, -3.200000000000001, -5.099999999999996, -3.0000000000000018, -3.8999999999999986, -6.19999999999999, -4.799999999999995, -3.3000000000000007, -3.0000000000000018, -3.6999999999999993, -4.099999999999998, -4.699999999999996, -3.799999999999999, -4.299999999999997, -3.3000000000000007, -3.5, -4.4999999999999964, -4.599999999999996, -3.4000000000000004, -3.5, -7.499999999999986, -3.1000000000000014, -2.4000000000000017, -4.1999999999999975, -6.999999999999997, -3.5999999999999996, -3.6999999999999993, -3.6999999999999993, -3.200000000000001, -4.699999999999996, -5.199999999999994, -4.1999999999999975, -10.999999999999973, -3.4000000000000004, -2.600000000000002, -4.699999999999996, -3.3000000000000007, -4.1999999999999975, -4.699999999999996, -9.299999999999994, -3.3000000000000007, -3.799999999999999, -2.600000000000002, -10.99999999999998, -3.3000000000000007, -3.5999999999999996, -3.5999999999999996, -6.099999999999996, -3.8999999999999986, -3.5, -3.6999999999999993, -3.3000000000000007, -5.8999999999999915, -3.8999999999999986, -6.69999999999999], "episode_lengths": [61, 42, 68, 48, 45, 79, 41, 60, 132, 80, 61, 44, 70, 52, 38, 82, 55, 62, 54, 51, 46, 67, 77, 75, 47, 72, 128, 57, 43, 45, 99, 41, 39, 88, 38, 57, 42, 45, 61, 59, 53, 53, 46, 154, 50, 52, 43, 58, 41, 50, 73, 59, 44, 41, 48, 52, 58, 49, 54, 44, 46, 56, 57, 45, 46, 86, 42, 35, 53, 70, 47, 48, 48, 43, 58, 63, 53, 111, 45, 37, 58, 44, 53, 58, 79, 44, 49, 37, 111, 44, 47, 47, 66, 50, 46, 48, 44, 70, 50, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.22593549358947385, "mean_inference_ms": 0.6204507318886825, "mean_action_processing_ms": 0.06832438278236365, "mean_env_wait_ms": 6.154842441446128, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0050127506256103516, "StateBufferConnector_ms": 0.003173351287841797, "ViewRequirementAgentConnector_ms": 0.07403826713562012}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000, "num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 360.44389995063807, "num_env_steps_trained_throughput_per_sec": 360.44389995063807, "timesteps_total": 96000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 96000, "timers": {"training_iteration_time_ms": 10828.747, "sample_time_ms": 7347.651, "load_time_ms": 0.983, "load_throughput": 4067499.697, "learn_time_ms": 3477.67, "learn_throughput": 1150.195, "synch_weights_time_ms": 1.764}, "counters": {"num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000}, "done": false, "episodes_total": 744, "training_iteration": 24, "trial_id": "329fa_00000", "date": "2024-03-07_12-26-20", "timestamp": 1709832380, "time_this_iter_s": 11.099778175354004, "time_total_s": 256.4745407104492, "pid": 105400, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fcd19c36f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 256.4745407104492, "iterations_since_restore": 24, "perf": {"cpu_util_percent": 19.586666666666666, "ram_util_percent": 43.60000000000001, "gpu_util_percent0": 0.07866666666666666, "vram_util_percent0": 0.1005859375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.10000000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 1.4049751425016752, "policy_loss": -0.008369885625377778, "vf_loss": 1.4121352771597524, "vf_explained_var": 0.6632658507234307, "kl": 0.012097541755379306, "entropy": 0.7882899459331266, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 22785.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_agent_steps_sampled": 100000, "num_agent_steps_trained": 100000}, "sampler_results": {"episode_reward_max": -2.0000000000000013, "episode_reward_min": -13.999999999999963, "episode_reward_mean": -4.620999999999996, "episode_len_mean": 55.58, "episode_media": {}, "episodes_this_iter": 73, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.200000000000001, -4.699999999999996, -5.199999999999994, -4.1999999999999975, -10.999999999999973, -3.4000000000000004, -2.600000000000002, -4.699999999999996, -3.3000000000000007, -4.1999999999999975, -4.699999999999996, -9.299999999999994, -3.3000000000000007, -3.799999999999999, -2.600000000000002, -10.99999999999998, -3.3000000000000007, -3.5999999999999996, -3.5999999999999996, -6.099999999999996, -3.8999999999999986, -3.5, -3.6999999999999993, -3.3000000000000007, -5.8999999999999915, -3.8999999999999986, -6.69999999999999, -3.8999999999999986, -3.0000000000000018, -5.099999999999999, -3.4000000000000004, -4.699999999999996, -3.799999999999999, -3.799999999999999, -10.599999999999975, -3.0000000000000018, -3.4000000000000004, -4.1999999999999975, -4.599999999999996, -3.3000000000000007, -3.200000000000001, -13.999999999999963, -2.600000000000002, -3.5999999999999996, -4.499999999999999, -3.8999999999999986, -4.799999999999995, -3.3000000000000016, -2.5000000000000018, -3.200000000000001, -5.199999999999994, -3.9999999999999982, -3.8999999999999995, -5.199999999999994, -7.499999999999986, -2.800000000000002, -2.800000000000002, -3.1000000000000014, -9.099999999999985, -3.0000000000000018, -10.599999999999978, -3.799999999999999, -4.099999999999998, -2.0000000000000013, -4.099999999999998, -5.499999999999993, -4.4999999999999964, -2.4000000000000017, -3.799999999999999, -4.299999999999997, -3.3000000000000007, -3.6999999999999993, -2.3000000000000016, -11.399999999999972, -2.700000000000002, -3.3000000000000007, -3.6999999999999993, -3.3000000000000007, -2.600000000000002, -3.3000000000000007, -3.0000000000000018, -6.599999999999998, -4.799999999999995, -5.799999999999994, -7.899999999999984, -7.099999999999994, -3.4000000000000004, -3.4000000000000004, -4.399999999999997, -5.799999999999992, -3.6999999999999993, -3.3000000000000007, -6.99999999999999, -4.999999999999995, -7.39999999999999, -3.4000000000000004, -4.8, -7.199999999999987, -3.200000000000001, -2.5000000000000018], "episode_lengths": [43, 58, 63, 53, 111, 45, 37, 58, 44, 53, 58, 79, 44, 49, 37, 111, 44, 47, 47, 66, 50, 46, 48, 44, 70, 50, 76, 50, 41, 57, 45, 58, 49, 49, 112, 41, 45, 53, 57, 44, 43, 131, 37, 47, 53, 50, 59, 43, 36, 43, 63, 51, 49, 63, 85, 39, 39, 42, 89, 41, 101, 49, 52, 31, 52, 66, 56, 35, 49, 51, 44, 48, 34, 122, 38, 44, 48, 44, 37, 44, 41, 67, 59, 58, 90, 75, 45, 45, 55, 69, 48, 44, 78, 61, 82, 45, 54, 83, 43, 36]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.22867522064684487, "mean_inference_ms": 0.6204509557898212, "mean_action_processing_ms": 0.06829396950650611, "mean_env_wait_ms": 6.170407956224443, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005104780197143555, "StateBufferConnector_ms": 0.0032286643981933594, "ViewRequirementAgentConnector_ms": 0.07413768768310547}}, "episode_reward_max": -2.0000000000000013, "episode_reward_min": -13.999999999999963, "episode_reward_mean": -4.620999999999996, "episode_len_mean": 55.58, "episodes_this_iter": 73, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3.200000000000001, -4.699999999999996, -5.199999999999994, -4.1999999999999975, -10.999999999999973, -3.4000000000000004, -2.600000000000002, -4.699999999999996, -3.3000000000000007, -4.1999999999999975, -4.699999999999996, -9.299999999999994, -3.3000000000000007, -3.799999999999999, -2.600000000000002, -10.99999999999998, -3.3000000000000007, -3.5999999999999996, -3.5999999999999996, -6.099999999999996, -3.8999999999999986, -3.5, -3.6999999999999993, -3.3000000000000007, -5.8999999999999915, -3.8999999999999986, -6.69999999999999, -3.8999999999999986, -3.0000000000000018, -5.099999999999999, -3.4000000000000004, -4.699999999999996, -3.799999999999999, -3.799999999999999, -10.599999999999975, -3.0000000000000018, -3.4000000000000004, -4.1999999999999975, -4.599999999999996, -3.3000000000000007, -3.200000000000001, -13.999999999999963, -2.600000000000002, -3.5999999999999996, -4.499999999999999, -3.8999999999999986, -4.799999999999995, -3.3000000000000016, -2.5000000000000018, -3.200000000000001, -5.199999999999994, -3.9999999999999982, -3.8999999999999995, -5.199999999999994, -7.499999999999986, -2.800000000000002, -2.800000000000002, -3.1000000000000014, -9.099999999999985, -3.0000000000000018, -10.599999999999978, -3.799999999999999, -4.099999999999998, -2.0000000000000013, -4.099999999999998, -5.499999999999993, -4.4999999999999964, -2.4000000000000017, -3.799999999999999, -4.299999999999997, -3.3000000000000007, -3.6999999999999993, -2.3000000000000016, -11.399999999999972, -2.700000000000002, -3.3000000000000007, -3.6999999999999993, -3.3000000000000007, -2.600000000000002, -3.3000000000000007, -3.0000000000000018, -6.599999999999998, -4.799999999999995, -5.799999999999994, -7.899999999999984, -7.099999999999994, -3.4000000000000004, -3.4000000000000004, -4.399999999999997, -5.799999999999992, -3.6999999999999993, -3.3000000000000007, -6.99999999999999, -4.999999999999995, -7.39999999999999, -3.4000000000000004, -4.8, -7.199999999999987, -3.200000000000001, -2.5000000000000018], "episode_lengths": [43, 58, 63, 53, 111, 45, 37, 58, 44, 53, 58, 79, 44, 49, 37, 111, 44, 47, 47, 66, 50, 46, 48, 44, 70, 50, 76, 50, 41, 57, 45, 58, 49, 49, 112, 41, 45, 53, 57, 44, 43, 131, 37, 47, 53, 50, 59, 43, 36, 43, 63, 51, 49, 63, 85, 39, 39, 42, 89, 41, 101, 49, 52, 31, 52, 66, 56, 35, 49, 51, 44, 48, 34, 122, 38, 44, 48, 44, 37, 44, 41, 67, 59, 58, 90, 75, 45, 45, 55, 69, 48, 44, 78, 61, 82, 45, 54, 83, 43, 36]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.22867522064684487, "mean_inference_ms": 0.6204509557898212, "mean_action_processing_ms": 0.06829396950650611, "mean_env_wait_ms": 6.170407956224443, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005104780197143555, "StateBufferConnector_ms": 0.0032286643981933594, "ViewRequirementAgentConnector_ms": 0.07413768768310547}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 100000, "num_agent_steps_trained": 100000, "num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 360.7890160868067, "num_env_steps_trained_throughput_per_sec": 360.7890160868067, "timesteps_total": 100000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 100000, "timers": {"training_iteration_time_ms": 10884.07, "sample_time_ms": 7400.232, "load_time_ms": 0.969, "load_throughput": 4126627.312, "learn_time_ms": 3480.438, "learn_throughput": 1149.281, "synch_weights_time_ms": 1.755}, "counters": {"num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_agent_steps_sampled": 100000, "num_agent_steps_trained": 100000}, "done": false, "episodes_total": 817, "training_iteration": 25, "trial_id": "329fa_00000", "date": "2024-03-07_12-26-31", "timestamp": 1709832391, "time_this_iter_s": 11.089580535888672, "time_total_s": 267.5641212463379, "pid": 105400, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fcd19c36f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 267.5641212463379, "iterations_since_restore": 25, "perf": {"cpu_util_percent": 20.314285714285717, "ram_util_percent": 43.60000000000001, "gpu_util_percent0": 0.07571428571428572, "vram_util_percent0": 0.1005859375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.10000000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 0.7168140136723792, "policy_loss": -0.016268276921924084, "vf_loss": 0.7323218117958756, "vf_explained_var": 0.7570968694584344, "kl": 0.007604795460053816, "entropy": 0.7208190306540458, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 23715.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 104000, "num_env_steps_trained": 104000, "num_agent_steps_sampled": 104000, "num_agent_steps_trained": 104000}, "sampler_results": {"episode_reward_max": -2.0000000000000013, "episode_reward_min": -9.999999999999979, "episode_reward_mean": -3.993999999999998, "episode_len_mean": 50.07, "episode_media": {}, "episodes_this_iter": 82, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4.799999999999995, -5.799999999999994, -7.899999999999984, -7.099999999999994, -3.4000000000000004, -3.4000000000000004, -4.399999999999997, -5.799999999999992, -3.6999999999999993, -3.3000000000000007, -6.99999999999999, -4.999999999999995, -7.39999999999999, -3.4000000000000004, -4.8, -7.199999999999987, -3.200000000000001, -2.5000000000000018, -4.399999999999997, -3.6999999999999993, -4.899999999999995, -3.5, -4.899999999999999, -3.5, -3.0000000000000018, -4.599999999999996, -4.899999999999995, -4.299999999999997, -2.4000000000000017, -9.999999999999979, -6.099999999999991, -3.200000000000001, -2.900000000000002, -4.399999999999997, -2.900000000000002, -3.9999999999999982, -2.900000000000002, -2.900000000000002, -2.3000000000000016, -3.5, -2.700000000000002, -2.3000000000000016, -4.099999999999998, -2.700000000000002, -2.3000000000000016, -3.5999999999999996, -2.4000000000000017, -3.799999999999999, -4.1999999999999975, -2.800000000000002, -3.3000000000000007, -2.5000000000000018, -2.700000000000002, -3.0000000000000018, -4.999999999999995, -3.3000000000000007, -3.000000000000001, -2.700000000000002, -3.5999999999999996, -4.399999999999997, -4.799999999999995, -2.4000000000000017, -3.1000000000000014, -3.0000000000000018, -3.1000000000000014, -3.799999999999999, -3.1000000000000014, -3.5, -3.9999999999999982, -3.6999999999999993, -3.6999999999999993, -8.99999999999999, -3.5999999999999996, -5.099999999999994, -3.4000000000000004, -3.5, -3.700000000000002, -3.0000000000000018, -2.2000000000000015, -2.0000000000000013, -3.9999999999999982, -3.6999999999999993, -3.8999999999999986, -2.4000000000000017, -4.899999999999996, -3.200000000000001, -2.800000000000002, -6.599999999999994, -4.1999999999999975, -5.299999999999994, -3.200000000000001, -6.19999999999999, -3.500000000000001, -3.0000000000000018, -5.299999999999994, -3.0000000000000018, -6.699999999999992, -3.7, -2.700000000000002, -3.6999999999999993], "episode_lengths": [59, 58, 90, 75, 45, 45, 55, 69, 48, 44, 78, 61, 82, 45, 54, 83, 43, 36, 55, 48, 60, 46, 56, 46, 41, 57, 60, 54, 35, 107, 72, 43, 40, 55, 40, 51, 40, 40, 34, 46, 38, 34, 52, 38, 34, 47, 35, 49, 53, 39, 44, 36, 38, 41, 61, 44, 36, 38, 47, 55, 59, 35, 42, 41, 42, 49, 42, 46, 51, 48, 48, 76, 47, 62, 42, 46, 45, 41, 33, 31, 51, 48, 50, 35, 59, 43, 39, 71, 53, 64, 43, 72, 45, 41, 64, 41, 74, 47, 38, 48]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23186334204952572, "mean_inference_ms": 0.6206938902084683, "mean_action_processing_ms": 0.0684069505762036, "mean_env_wait_ms": 6.189418574874319, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005022764205932617, "StateBufferConnector_ms": 0.003122091293334961, "ViewRequirementAgentConnector_ms": 0.07415175437927246}}, "episode_reward_max": -2.0000000000000013, "episode_reward_min": -9.999999999999979, "episode_reward_mean": -3.993999999999998, "episode_len_mean": 50.07, "episodes_this_iter": 82, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-4.799999999999995, -5.799999999999994, -7.899999999999984, -7.099999999999994, -3.4000000000000004, -3.4000000000000004, -4.399999999999997, -5.799999999999992, -3.6999999999999993, -3.3000000000000007, -6.99999999999999, -4.999999999999995, -7.39999999999999, -3.4000000000000004, -4.8, -7.199999999999987, -3.200000000000001, -2.5000000000000018, -4.399999999999997, -3.6999999999999993, -4.899999999999995, -3.5, -4.899999999999999, -3.5, -3.0000000000000018, -4.599999999999996, -4.899999999999995, -4.299999999999997, -2.4000000000000017, -9.999999999999979, -6.099999999999991, -3.200000000000001, -2.900000000000002, -4.399999999999997, -2.900000000000002, -3.9999999999999982, -2.900000000000002, -2.900000000000002, -2.3000000000000016, -3.5, -2.700000000000002, -2.3000000000000016, -4.099999999999998, -2.700000000000002, -2.3000000000000016, -3.5999999999999996, -2.4000000000000017, -3.799999999999999, -4.1999999999999975, -2.800000000000002, -3.3000000000000007, -2.5000000000000018, -2.700000000000002, -3.0000000000000018, -4.999999999999995, -3.3000000000000007, -3.000000000000001, -2.700000000000002, -3.5999999999999996, -4.399999999999997, -4.799999999999995, -2.4000000000000017, -3.1000000000000014, -3.0000000000000018, -3.1000000000000014, -3.799999999999999, -3.1000000000000014, -3.5, -3.9999999999999982, -3.6999999999999993, -3.6999999999999993, -8.99999999999999, -3.5999999999999996, -5.099999999999994, -3.4000000000000004, -3.5, -3.700000000000002, -3.0000000000000018, -2.2000000000000015, -2.0000000000000013, -3.9999999999999982, -3.6999999999999993, -3.8999999999999986, -2.4000000000000017, -4.899999999999996, -3.200000000000001, -2.800000000000002, -6.599999999999994, -4.1999999999999975, -5.299999999999994, -3.200000000000001, -6.19999999999999, -3.500000000000001, -3.0000000000000018, -5.299999999999994, -3.0000000000000018, -6.699999999999992, -3.7, -2.700000000000002, -3.6999999999999993], "episode_lengths": [59, 58, 90, 75, 45, 45, 55, 69, 48, 44, 78, 61, 82, 45, 54, 83, 43, 36, 55, 48, 60, 46, 56, 46, 41, 57, 60, 54, 35, 107, 72, 43, 40, 55, 40, 51, 40, 40, 34, 46, 38, 34, 52, 38, 34, 47, 35, 49, 53, 39, 44, 36, 38, 41, 61, 44, 36, 38, 47, 55, 59, 35, 42, 41, 42, 49, 42, 46, 51, 48, 48, 76, 47, 62, 42, 46, 45, 41, 33, 31, 51, 48, 50, 35, 59, 43, 39, 71, 53, 64, 43, 72, 45, 41, 64, 41, 74, 47, 38, 48]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23186334204952572, "mean_inference_ms": 0.6206938902084683, "mean_action_processing_ms": 0.0684069505762036, "mean_env_wait_ms": 6.189418574874319, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005022764205932617, "StateBufferConnector_ms": 0.003122091293334961, "ViewRequirementAgentConnector_ms": 0.07415175437927246}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 104000, "num_agent_steps_trained": 104000, "num_env_steps_sampled": 104000, "num_env_steps_trained": 104000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 350.56751944421103, "num_env_steps_trained_throughput_per_sec": 350.56751944421103, "timesteps_total": 104000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 104000, "timers": {"training_iteration_time_ms": 10955.649, "sample_time_ms": 7470.353, "load_time_ms": 0.972, "load_throughput": 4116906.164, "learn_time_ms": 3481.891, "learn_throughput": 1148.801, "synch_weights_time_ms": 1.762}, "counters": {"num_env_steps_sampled": 104000, "num_env_steps_trained": 104000, "num_agent_steps_sampled": 104000, "num_agent_steps_trained": 104000}, "done": false, "episodes_total": 899, "training_iteration": 26, "trial_id": "329fa_00000", "date": "2024-03-07_12-26-42", "timestamp": 1709832402, "time_this_iter_s": 11.412399768829346, "time_total_s": 278.97652101516724, "pid": 105400, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fcd19c36f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 278.97652101516724, "iterations_since_restore": 26, "perf": {"cpu_util_percent": 19.633333333333333, "ram_util_percent": 43.58666666666668, "gpu_util_percent0": 0.07666666666666666, "vram_util_percent0": 0.1005859375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.10000000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 0.7383239974787269, "policy_loss": -0.011290851271941616, "vf_loss": 0.7482375803133172, "vf_explained_var": 0.7718048055325785, "kl": 0.013772747515729258, "entropy": 0.6984806474818979, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 24645.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_agent_steps_sampled": 108000, "num_agent_steps_trained": 108000}, "sampler_results": {"episode_reward_max": -2.1000000000000014, "episode_reward_min": -19.09999999999997, "episode_reward_mean": -3.722999999999999, "episode_len_mean": 46.97, "episode_media": {}, "episodes_this_iter": 86, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2.800000000000002, -6.599999999999994, -4.1999999999999975, -5.299999999999994, -3.200000000000001, -6.19999999999999, -3.500000000000001, -3.0000000000000018, -5.299999999999994, -3.0000000000000018, -6.699999999999992, -3.7, -2.700000000000002, -3.6999999999999993, -3.0000000000000018, -2.600000000000002, -3.3000000000000007, -3.4000000000000012, -4.499999999999999, -2.900000000000002, -2.700000000000002, -4.299999999999997, -4.099999999999998, -3.0000000000000018, -3.799999999999999, -2.800000000000002, -2.800000000000002, -2.700000000000002, -3.1000000000000014, -3.6999999999999993, -3.200000000000001, -4.099999999999998, -2.600000000000002, -3.0000000000000018, -6.19999999999999, -3.6999999999999993, -2.600000000000002, -2.800000000000002, -3.200000000000001, -2.900000000000002, -2.800000000000002, -3.0000000000000018, -4.099999999999998, -3.3000000000000016, -2.900000000000002, -2.700000000000002, -3.200000000000001, -3.6999999999999993, -4.1999999999999975, -3.6999999999999993, -4.1999999999999975, -3.1000000000000014, -3.8999999999999986, -2.700000000000002, -2.2000000000000015, -2.5000000000000018, -3.5, -4.299999999999997, -3.3000000000000007, -2.700000000000002, -2.700000000000002, -3.1000000000000014, -2.700000000000002, -3.6999999999999993, -2.2000000000000015, -6.700000000000002, -2.600000000000002, -2.600000000000002, -4.199999999999998, -2.5000000000000018, -4.299999999999997, -3.6999999999999993, -4.4999999999999964, -3.200000000000001, -3.4000000000000004, -3.200000000000001, -19.09999999999997, -2.4000000000000017, -2.700000000000002, -2.600000000000002, -3.6999999999999993, -3.200000000000001, -3.5999999999999996, -2.800000000000002, -2.1000000000000014, -2.4000000000000017, -3.5, -3.200000000000001, -4.799999999999995, -3.6999999999999993, -11.79999999999997, -3.799999999999999, -5.799999999999995, -2.800000000000002, -4.899999999999995, -4.099999999999998, -2.4000000000000017, -3.4000000000000004, -2.2000000000000015, -3.1000000000000014], "episode_lengths": [39, 71, 53, 64, 43, 72, 45, 41, 64, 41, 74, 47, 38, 48, 41, 37, 44, 42, 53, 40, 38, 54, 52, 41, 49, 39, 39, 38, 42, 48, 43, 52, 37, 41, 73, 42, 37, 39, 43, 40, 39, 41, 52, 42, 40, 38, 43, 48, 53, 48, 53, 42, 50, 38, 33, 36, 46, 54, 42, 38, 38, 42, 38, 48, 33, 63, 37, 37, 52, 36, 54, 48, 56, 43, 39, 43, 133, 35, 38, 37, 48, 43, 47, 39, 32, 35, 46, 43, 59, 48, 127, 49, 65, 39, 60, 52, 35, 45, 33, 42]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23522354306399657, "mean_inference_ms": 0.621304863285629, "mean_action_processing_ms": 0.06839652581492318, "mean_env_wait_ms": 6.2108799913108985, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005199432373046875, "StateBufferConnector_ms": 0.0032672882080078125, "ViewRequirementAgentConnector_ms": 0.0754082202911377}}, "episode_reward_max": -2.1000000000000014, "episode_reward_min": -19.09999999999997, "episode_reward_mean": -3.722999999999999, "episode_len_mean": 46.97, "episodes_this_iter": 86, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-2.800000000000002, -6.599999999999994, -4.1999999999999975, -5.299999999999994, -3.200000000000001, -6.19999999999999, -3.500000000000001, -3.0000000000000018, -5.299999999999994, -3.0000000000000018, -6.699999999999992, -3.7, -2.700000000000002, -3.6999999999999993, -3.0000000000000018, -2.600000000000002, -3.3000000000000007, -3.4000000000000012, -4.499999999999999, -2.900000000000002, -2.700000000000002, -4.299999999999997, -4.099999999999998, -3.0000000000000018, -3.799999999999999, -2.800000000000002, -2.800000000000002, -2.700000000000002, -3.1000000000000014, -3.6999999999999993, -3.200000000000001, -4.099999999999998, -2.600000000000002, -3.0000000000000018, -6.19999999999999, -3.6999999999999993, -2.600000000000002, -2.800000000000002, -3.200000000000001, -2.900000000000002, -2.800000000000002, -3.0000000000000018, -4.099999999999998, -3.3000000000000016, -2.900000000000002, -2.700000000000002, -3.200000000000001, -3.6999999999999993, -4.1999999999999975, -3.6999999999999993, -4.1999999999999975, -3.1000000000000014, -3.8999999999999986, -2.700000000000002, -2.2000000000000015, -2.5000000000000018, -3.5, -4.299999999999997, -3.3000000000000007, -2.700000000000002, -2.700000000000002, -3.1000000000000014, -2.700000000000002, -3.6999999999999993, -2.2000000000000015, -6.700000000000002, -2.600000000000002, -2.600000000000002, -4.199999999999998, -2.5000000000000018, -4.299999999999997, -3.6999999999999993, -4.4999999999999964, -3.200000000000001, -3.4000000000000004, -3.200000000000001, -19.09999999999997, -2.4000000000000017, -2.700000000000002, -2.600000000000002, -3.6999999999999993, -3.200000000000001, -3.5999999999999996, -2.800000000000002, -2.1000000000000014, -2.4000000000000017, -3.5, -3.200000000000001, -4.799999999999995, -3.6999999999999993, -11.79999999999997, -3.799999999999999, -5.799999999999995, -2.800000000000002, -4.899999999999995, -4.099999999999998, -2.4000000000000017, -3.4000000000000004, -2.2000000000000015, -3.1000000000000014], "episode_lengths": [39, 71, 53, 64, 43, 72, 45, 41, 64, 41, 74, 47, 38, 48, 41, 37, 44, 42, 53, 40, 38, 54, 52, 41, 49, 39, 39, 38, 42, 48, 43, 52, 37, 41, 73, 42, 37, 39, 43, 40, 39, 41, 52, 42, 40, 38, 43, 48, 53, 48, 53, 42, 50, 38, 33, 36, 46, 54, 42, 38, 38, 42, 38, 48, 33, 63, 37, 37, 52, 36, 54, 48, 56, 43, 39, 43, 133, 35, 38, 37, 48, 43, 47, 39, 32, 35, 46, 43, 59, 48, 127, 49, 65, 39, 60, 52, 35, 45, 33, 42]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23522354306399657, "mean_inference_ms": 0.621304863285629, "mean_action_processing_ms": 0.06839652581492318, "mean_env_wait_ms": 6.2108799913108985, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005199432373046875, "StateBufferConnector_ms": 0.0032672882080078125, "ViewRequirementAgentConnector_ms": 0.0754082202911377}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 108000, "num_agent_steps_trained": 108000, "num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 348.71408633585696, "num_env_steps_trained_throughput_per_sec": 348.71408633585696, "timesteps_total": 108000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 108000, "timers": {"training_iteration_time_ms": 11031.54, "sample_time_ms": 7532.528, "load_time_ms": 0.974, "load_throughput": 4104818.947, "learn_time_ms": 3495.612, "learn_throughput": 1144.292, "synch_weights_time_ms": 1.754}, "counters": {"num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_agent_steps_sampled": 108000, "num_agent_steps_trained": 108000}, "done": false, "episodes_total": 985, "training_iteration": 27, "trial_id": "329fa_00000", "date": "2024-03-07_12-26-54", "timestamp": 1709832414, "time_this_iter_s": 11.473197221755981, "time_total_s": 290.4497182369232, "pid": 105400, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fcd19c36f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 290.4497182369232, "iterations_since_restore": 27, "perf": {"cpu_util_percent": 20.68666666666667, "ram_util_percent": 43.63333333333334, "gpu_util_percent0": 0.08, "vram_util_percent0": 0.1005859375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.10000000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 0.32189781656585786, "policy_loss": -0.04064487370271837, "vf_loss": 0.36164354908890944, "vf_explained_var": 0.8534282469621268, "kl": 0.008991397729362222, "entropy": 0.6619867507488497, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 25575.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_agent_steps_sampled": 112000, "num_agent_steps_trained": 112000}, "sampler_results": {"episode_reward_max": -2.0000000000000013, "episode_reward_min": -9.099999999999987, "episode_reward_mean": -3.2300000000000004, "episode_len_mean": 42.91, "episode_media": {}, "episodes_this_iter": 94, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4.899999999999995, -4.099999999999998, -2.4000000000000017, -3.4000000000000004, -2.2000000000000015, -3.1000000000000014, -2.800000000000002, -2.800000000000002, -2.900000000000002, -4.099999999999998, -2.900000000000002, -2.900000000000002, -3.6999999999999993, -9.099999999999987, -2.5000000000000018, -2.2000000000000015, -3.3000000000000007, -3.5, -2.2000000000000015, -3.5999999999999996, -3.200000000000001, -2.700000000000002, -2.900000000000002, -3.8999999999999986, -2.5000000000000018, -3.3000000000000007, -2.4000000000000017, -3.6999999999999993, -2.9000000000000026, -4.599999999999996, -4.4999999999999964, -3.0000000000000018, -2.700000000000002, -3.200000000000001, -2.600000000000002, -3.6999999999999993, -2.4000000000000017, -3.8999999999999986, -2.5000000000000018, -3.1000000000000014, -3.5, -2.800000000000002, -3.1000000000000014, -2.900000000000002, -2.600000000000002, -3.6999999999999993, -3.1000000000000014, -2.600000000000002, -4.899999999999997, -3.9999999999999982, -4.099999999999998, -3.4000000000000004, -4.799999999999995, -2.800000000000002, -2.800000000000002, -2.3000000000000016, -2.900000000000002, -3.3000000000000007, -2.600000000000002, -4.200000000000001, -2.600000000000002, -2.900000000000002, -2.3000000000000016, -2.4000000000000017, -3.4000000000000004, -3.0000000000000018, -3.200000000000001, -3.799999999999999, -3.200000000000001, -2.600000000000002, -2.800000000000002, -3.3000000000000007, -5.500000000000002, -2.700000000000002, -3.200000000000001, -2.900000000000002, -4.1999999999999975, -3.1000000000000014, -2.900000000000002, -3.4000000000000004, -2.700000000000002, -3.5, -2.700000000000002, -3.8999999999999986, -2.0000000000000013, -2.900000000000002, -3.200000000000001, -3.9999999999999982, -2.900000000000002, -2.900000000000002, -3.3000000000000007, -2.600000000000002, -2.3000000000000016, -2.5000000000000018, -3.200000000000001, -2.900000000000002, -3.0000000000000018, -3.0000000000000018, -3.8999999999999986, -3.5], "episode_lengths": [60, 52, 35, 45, 33, 42, 39, 39, 40, 52, 40, 40, 48, 84, 36, 33, 44, 46, 33, 47, 42, 38, 40, 50, 36, 44, 35, 48, 39, 57, 56, 41, 38, 43, 37, 48, 35, 50, 36, 42, 46, 39, 42, 40, 37, 48, 42, 37, 58, 51, 52, 45, 59, 39, 39, 34, 40, 44, 37, 49, 37, 40, 34, 32, 45, 41, 43, 49, 43, 37, 39, 44, 56, 38, 43, 40, 53, 42, 40, 45, 38, 46, 38, 50, 31, 40, 43, 51, 40, 40, 44, 37, 34, 36, 43, 40, 41, 41, 50, 46]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2389570502120469, "mean_inference_ms": 0.6222022187100624, "mean_action_processing_ms": 0.06845488934064332, "mean_env_wait_ms": 6.237292752992199, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0052051544189453125, "StateBufferConnector_ms": 0.003242015838623047, "ViewRequirementAgentConnector_ms": 0.07548165321350098}}, "episode_reward_max": -2.0000000000000013, "episode_reward_min": -9.099999999999987, "episode_reward_mean": -3.2300000000000004, "episode_len_mean": 42.91, "episodes_this_iter": 94, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-4.899999999999995, -4.099999999999998, -2.4000000000000017, -3.4000000000000004, -2.2000000000000015, -3.1000000000000014, -2.800000000000002, -2.800000000000002, -2.900000000000002, -4.099999999999998, -2.900000000000002, -2.900000000000002, -3.6999999999999993, -9.099999999999987, -2.5000000000000018, -2.2000000000000015, -3.3000000000000007, -3.5, -2.2000000000000015, -3.5999999999999996, -3.200000000000001, -2.700000000000002, -2.900000000000002, -3.8999999999999986, -2.5000000000000018, -3.3000000000000007, -2.4000000000000017, -3.6999999999999993, -2.9000000000000026, -4.599999999999996, -4.4999999999999964, -3.0000000000000018, -2.700000000000002, -3.200000000000001, -2.600000000000002, -3.6999999999999993, -2.4000000000000017, -3.8999999999999986, -2.5000000000000018, -3.1000000000000014, -3.5, -2.800000000000002, -3.1000000000000014, -2.900000000000002, -2.600000000000002, -3.6999999999999993, -3.1000000000000014, -2.600000000000002, -4.899999999999997, -3.9999999999999982, -4.099999999999998, -3.4000000000000004, -4.799999999999995, -2.800000000000002, -2.800000000000002, -2.3000000000000016, -2.900000000000002, -3.3000000000000007, -2.600000000000002, -4.200000000000001, -2.600000000000002, -2.900000000000002, -2.3000000000000016, -2.4000000000000017, -3.4000000000000004, -3.0000000000000018, -3.200000000000001, -3.799999999999999, -3.200000000000001, -2.600000000000002, -2.800000000000002, -3.3000000000000007, -5.500000000000002, -2.700000000000002, -3.200000000000001, -2.900000000000002, -4.1999999999999975, -3.1000000000000014, -2.900000000000002, -3.4000000000000004, -2.700000000000002, -3.5, -2.700000000000002, -3.8999999999999986, -2.0000000000000013, -2.900000000000002, -3.200000000000001, -3.9999999999999982, -2.900000000000002, -2.900000000000002, -3.3000000000000007, -2.600000000000002, -2.3000000000000016, -2.5000000000000018, -3.200000000000001, -2.900000000000002, -3.0000000000000018, -3.0000000000000018, -3.8999999999999986, -3.5], "episode_lengths": [60, 52, 35, 45, 33, 42, 39, 39, 40, 52, 40, 40, 48, 84, 36, 33, 44, 46, 33, 47, 42, 38, 40, 50, 36, 44, 35, 48, 39, 57, 56, 41, 38, 43, 37, 48, 35, 50, 36, 42, 46, 39, 42, 40, 37, 48, 42, 37, 58, 51, 52, 45, 59, 39, 39, 34, 40, 44, 37, 49, 37, 40, 34, 32, 45, 41, 43, 49, 43, 37, 39, 44, 56, 38, 43, 40, 53, 42, 40, 45, 38, 46, 38, 50, 31, 40, 43, 51, 40, 40, 44, 37, 34, 36, 43, 40, 41, 41, 50, 46]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2389570502120469, "mean_inference_ms": 0.6222022187100624, "mean_action_processing_ms": 0.06845488934064332, "mean_env_wait_ms": 6.237292752992199, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0052051544189453125, "StateBufferConnector_ms": 0.003242015838623047, "ViewRequirementAgentConnector_ms": 0.07548165321350098}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 112000, "num_agent_steps_trained": 112000, "num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 346.22688033579425, "num_env_steps_trained_throughput_per_sec": 346.22688033579425, "timesteps_total": 112000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 112000, "timers": {"training_iteration_time_ms": 11105.213, "sample_time_ms": 7605.628, "load_time_ms": 0.973, "load_throughput": 4112970.018, "learn_time_ms": 3496.167, "learn_throughput": 1144.11, "synch_weights_time_ms": 1.775}, "counters": {"num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_agent_steps_sampled": 112000, "num_agent_steps_trained": 112000}, "done": false, "episodes_total": 1079, "training_iteration": 28, "trial_id": "329fa_00000", "date": "2024-03-07_12-27-05", "timestamp": 1709832425, "time_this_iter_s": 11.556205749511719, "time_total_s": 302.00592398643494, "pid": 105400, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fcd19c36f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 302.00592398643494, "iterations_since_restore": 28, "perf": {"cpu_util_percent": 20.046666666666663, "ram_util_percent": 43.60000000000001, "gpu_util_percent0": 0.072, "vram_util_percent0": 0.10022786458333335}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.10000000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 0.38036354722145954, "policy_loss": -0.008498706037719404, "vf_loss": 0.38795052808459085, "vf_explained_var": 0.8113187307952553, "kl": 0.009117239286565316, "entropy": 0.6340108016485809, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 26505.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 116000, "num_env_steps_trained": 116000, "num_agent_steps_sampled": 116000, "num_agent_steps_trained": 116000}, "sampler_results": {"episode_reward_max": -1.9000000000000012, "episode_reward_min": -9.499999999999995, "episode_reward_mean": -3.039000000000001, "episode_len_mean": 40.63, "episode_media": {}, "episodes_this_iter": 100, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2.3000000000000016, -2.900000000000002, -3.0000000000000018, -3.200000000000001, -5.299999999999997, -2.5000000000000018, -2.900000000000002, -3.4000000000000004, -2.3000000000000016, -2.4000000000000017, -2.2000000000000015, -2.700000000000002, -5.099999999999997, -4.1999999999999975, -3.799999999999999, -3.8999999999999986, -2.600000000000002, -3.5999999999999996, -3.1000000000000014, -2.4000000000000017, -3.1000000000000014, -4.4999999999999964, -2.2000000000000015, -2.900000000000002, -2.900000000000002, -3.200000000000001, -2.5000000000000018, -4.799999999999995, -2.4000000000000017, -2.1000000000000014, -2.4000000000000017, -1.9000000000000012, -2.800000000000002, -1.9000000000000012, -2.900000000000002, -2.0000000000000013, -2.4000000000000017, -2.0000000000000013, -2.900000000000002, -3.3, -3.6999999999999993, -3.1000000000000014, -6.200000000000003, -3.3000000000000007, -2.600000000000002, -2.5000000000000018, -2.2000000000000015, -2.5000000000000018, -3.1000000000000014, -3.5999999999999996, -3.799999999999999, -3.4000000000000004, -4.399999999999997, -3.0000000000000018, -3.6999999999999993, -2.800000000000002, -3.5, -2.5000000000000018, -3.5, -2.4000000000000017, -2.5000000000000018, -3.0000000000000018, -4.599999999999996, -2.2000000000000015, -2.1000000000000014, -3.3000000000000007, -2.0000000000000013, -3.1000000000000014, -2.900000000000002, -2.800000000000002, -3.8999999999999986, -3.3000000000000007, -2.4000000000000017, -2.700000000000002, -2.600000000000002, -5.099999999999994, -2.1000000000000014, -2.900000000000002, -2.4000000000000017, -1.9000000000000012, -2.600000000000002, -3.0000000000000018, -2.900000000000002, -2.1000000000000014, -2.900000000000002, -2.5000000000000018, -2.600000000000002, -2.2000000000000015, -2.5000000000000018, -3.3000000000000007, -3.0000000000000018, -3.4000000000000004, -2.600000000000002, -1.9000000000000012, -2.5000000000000018, -3.0000000000000018, -3.0000000000000018, -9.499999999999995, -2.700000000000002, -3.200000000000001], "episode_lengths": [34, 40, 41, 43, 60, 36, 40, 45, 34, 35, 33, 38, 49, 53, 49, 48, 37, 47, 42, 35, 42, 56, 33, 40, 40, 36, 36, 59, 35, 32, 35, 30, 39, 30, 40, 31, 35, 31, 40, 40, 48, 42, 59, 42, 37, 36, 33, 33, 42, 47, 44, 45, 55, 41, 48, 39, 46, 36, 46, 35, 36, 41, 56, 33, 32, 44, 31, 42, 40, 39, 50, 44, 35, 38, 37, 62, 32, 40, 35, 30, 37, 41, 40, 32, 40, 36, 37, 33, 36, 44, 41, 45, 37, 30, 36, 41, 41, 85, 38, 43]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24287592398331523, "mean_inference_ms": 0.6231259142159224, "mean_action_processing_ms": 0.0685538150890873, "mean_env_wait_ms": 6.262860791995024, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005164623260498047, "StateBufferConnector_ms": 0.0032923221588134766, "ViewRequirementAgentConnector_ms": 0.07577180862426758}}, "episode_reward_max": -1.9000000000000012, "episode_reward_min": -9.499999999999995, "episode_reward_mean": -3.039000000000001, "episode_len_mean": 40.63, "episodes_this_iter": 100, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-2.3000000000000016, -2.900000000000002, -3.0000000000000018, -3.200000000000001, -5.299999999999997, -2.5000000000000018, -2.900000000000002, -3.4000000000000004, -2.3000000000000016, -2.4000000000000017, -2.2000000000000015, -2.700000000000002, -5.099999999999997, -4.1999999999999975, -3.799999999999999, -3.8999999999999986, -2.600000000000002, -3.5999999999999996, -3.1000000000000014, -2.4000000000000017, -3.1000000000000014, -4.4999999999999964, -2.2000000000000015, -2.900000000000002, -2.900000000000002, -3.200000000000001, -2.5000000000000018, -4.799999999999995, -2.4000000000000017, -2.1000000000000014, -2.4000000000000017, -1.9000000000000012, -2.800000000000002, -1.9000000000000012, -2.900000000000002, -2.0000000000000013, -2.4000000000000017, -2.0000000000000013, -2.900000000000002, -3.3, -3.6999999999999993, -3.1000000000000014, -6.200000000000003, -3.3000000000000007, -2.600000000000002, -2.5000000000000018, -2.2000000000000015, -2.5000000000000018, -3.1000000000000014, -3.5999999999999996, -3.799999999999999, -3.4000000000000004, -4.399999999999997, -3.0000000000000018, -3.6999999999999993, -2.800000000000002, -3.5, -2.5000000000000018, -3.5, -2.4000000000000017, -2.5000000000000018, -3.0000000000000018, -4.599999999999996, -2.2000000000000015, -2.1000000000000014, -3.3000000000000007, -2.0000000000000013, -3.1000000000000014, -2.900000000000002, -2.800000000000002, -3.8999999999999986, -3.3000000000000007, -2.4000000000000017, -2.700000000000002, -2.600000000000002, -5.099999999999994, -2.1000000000000014, -2.900000000000002, -2.4000000000000017, -1.9000000000000012, -2.600000000000002, -3.0000000000000018, -2.900000000000002, -2.1000000000000014, -2.900000000000002, -2.5000000000000018, -2.600000000000002, -2.2000000000000015, -2.5000000000000018, -3.3000000000000007, -3.0000000000000018, -3.4000000000000004, -2.600000000000002, -1.9000000000000012, -2.5000000000000018, -3.0000000000000018, -3.0000000000000018, -9.499999999999995, -2.700000000000002, -3.200000000000001], "episode_lengths": [34, 40, 41, 43, 60, 36, 40, 45, 34, 35, 33, 38, 49, 53, 49, 48, 37, 47, 42, 35, 42, 56, 33, 40, 40, 36, 36, 59, 35, 32, 35, 30, 39, 30, 40, 31, 35, 31, 40, 40, 48, 42, 59, 42, 37, 36, 33, 33, 42, 47, 44, 45, 55, 41, 48, 39, 46, 36, 46, 35, 36, 41, 56, 33, 32, 44, 31, 42, 40, 39, 50, 44, 35, 38, 37, 62, 32, 40, 35, 30, 37, 41, 40, 32, 40, 36, 37, 33, 36, 44, 41, 45, 37, 30, 36, 41, 41, 85, 38, 43]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24287592398331523, "mean_inference_ms": 0.6231259142159224, "mean_action_processing_ms": 0.0685538150890873, "mean_env_wait_ms": 6.262860791995024, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005164623260498047, "StateBufferConnector_ms": 0.0032923221588134766, "ViewRequirementAgentConnector_ms": 0.07577180862426758}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 116000, "num_agent_steps_trained": 116000, "num_env_steps_sampled": 116000, "num_env_steps_trained": 116000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 344.1933622517411, "num_env_steps_trained_throughput_per_sec": 344.1933622517411, "timesteps_total": 116000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 116000, "timers": {"training_iteration_time_ms": 11181.187, "sample_time_ms": 7692.56, "load_time_ms": 0.97, "load_throughput": 4121963.54, "learn_time_ms": 3485.22, "learn_throughput": 1147.704, "synch_weights_time_ms": 1.77}, "counters": {"num_env_steps_sampled": 116000, "num_env_steps_trained": 116000, "num_agent_steps_sampled": 116000, "num_agent_steps_trained": 116000}, "done": false, "episodes_total": 1179, "training_iteration": 29, "trial_id": "329fa_00000", "date": "2024-03-07_12-27-17", "timestamp": 1709832437, "time_this_iter_s": 11.623766660690308, "time_total_s": 313.62969064712524, "pid": 105400, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fcd19c36f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 313.62969064712524, "iterations_since_restore": 29, "perf": {"cpu_util_percent": 20.160000000000004, "ram_util_percent": 43.606666666666676, "gpu_util_percent0": 0.06933333333333332, "vram_util_percent0": 0.09879557291666669}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.10000000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 0.25137819747198925, "policy_loss": -0.009088457747292455, "vf_loss": 0.25946224131771634, "vf_explained_var": 0.8771098228552008, "kl": 0.010044117857248736, "entropy": 0.580191419169467, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 27435.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 120000, "num_env_steps_trained": 120000, "num_agent_steps_sampled": 120000, "num_agent_steps_trained": 120000}, "sampler_results": {"episode_reward_max": -1.600000000000001, "episode_reward_min": -7.199999999999996, "episode_reward_mean": -2.759615384615386, "episode_len_mean": 38.29807692307692, "episode_media": {}, "episodes_this_iter": 104, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.8999999999999986, -2.600000000000002, -2.600000000000002, -2.900000000000002, -2.4000000000000017, -2.900000000000002, -3.0000000000000018, -3.1000000000000014, -2.800000000000002, -2.600000000000002, -2.800000000000002, -2.600000000000002, -1.700000000000001, -1.8000000000000012, -2.900000000000002, -2.2000000000000015, -1.9000000000000012, -2.5000000000000018, -3.0000000000000018, -2.2000000000000015, -2.3000000000000016, -2.4000000000000017, -6.099999999999991, -3.1000000000000014, -3.6999999999999993, -2.2000000000000015, -2.4000000000000017, -2.1000000000000014, -2.700000000000002, -3.6999999999999993, -2.3000000000000016, -2.600000000000002, -3.3000000000000007, -3.8999999999999986, -3.799999999999999, -2.700000000000002, -2.600000000000002, -7.199999999999996, -3.3000000000000007, -2.2000000000000015, -2.4000000000000017, -2.3000000000000016, -2.800000000000002, -3.5999999999999996, -3.1000000000000014, -2.5000000000000018, -2.600000000000002, -2.4000000000000017, -2.800000000000002, -2.1000000000000014, -3.0000000000000018, -2.600000000000002, -2.600000000000002, -2.600000000000002, -1.8000000000000012, -2.700000000000002, -3.1000000000000014, -3.0000000000000018, -2.600000000000002, -3.1000000000000014, -2.2000000000000015, -3.4000000000000004, -2.2000000000000015, -3.1000000000000014, -1.8000000000000012, -2.5000000000000018, -3.0000000000000018, -2.0000000000000013, -3.5, -2.4000000000000017, -2.4000000000000017, -2.3000000000000016, -2.600000000000002, -3.1000000000000014, -2.3000000000000016, -1.600000000000001, -2.4000000000000017, -2.600000000000002, -2.600000000000002, -2.3000000000000016, -2.900000000000002, -1.600000000000001, -2.2000000000000015, -3.3000000000000007, -2.700000000000002, -3.5, -3.3000000000000007, -2.600000000000002, -2.600000000000002, -2.2000000000000015, -2.5000000000000018, -2.0000000000000013, -2.2000000000000015, -5.4999999999999964, -2.4000000000000017, -2.1000000000000014, -3.0000000000000018, -2.700000000000002, -1.9000000000000012, -3.4000000000000004, -2.700000000000002, -3.1000000000000014, -2.900000000000002, -2.700000000000002], "episode_lengths": [50, 37, 37, 40, 35, 40, 41, 42, 39, 37, 39, 37, 28, 29, 40, 33, 30, 36, 41, 33, 34, 35, 72, 42, 48, 33, 35, 32, 38, 43, 34, 37, 44, 50, 49, 38, 37, 73, 44, 33, 35, 34, 39, 47, 40, 36, 37, 35, 39, 32, 41, 37, 37, 37, 29, 38, 42, 41, 37, 42, 33, 45, 33, 42, 29, 36, 41, 31, 46, 35, 35, 32, 37, 42, 34, 27, 35, 37, 37, 34, 40, 27, 33, 44, 38, 38, 44, 37, 37, 33, 36, 31, 33, 62, 35, 32, 41, 38, 30, 45, 38, 42, 40, 38]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24637525809392147, "mean_inference_ms": 0.6236673187419173, "mean_action_processing_ms": 0.0685559561137833, "mean_env_wait_ms": 6.2901760219238705, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005197066527146559, "StateBufferConnector_ms": 0.003308974779569186, "ViewRequirementAgentConnector_ms": 0.07626437223874606}}, "episode_reward_max": -1.600000000000001, "episode_reward_min": -7.199999999999996, "episode_reward_mean": -2.759615384615386, "episode_len_mean": 38.29807692307692, "episodes_this_iter": 104, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3.8999999999999986, -2.600000000000002, -2.600000000000002, -2.900000000000002, -2.4000000000000017, -2.900000000000002, -3.0000000000000018, -3.1000000000000014, -2.800000000000002, -2.600000000000002, -2.800000000000002, -2.600000000000002, -1.700000000000001, -1.8000000000000012, -2.900000000000002, -2.2000000000000015, -1.9000000000000012, -2.5000000000000018, -3.0000000000000018, -2.2000000000000015, -2.3000000000000016, -2.4000000000000017, -6.099999999999991, -3.1000000000000014, -3.6999999999999993, -2.2000000000000015, -2.4000000000000017, -2.1000000000000014, -2.700000000000002, -3.6999999999999993, -2.3000000000000016, -2.600000000000002, -3.3000000000000007, -3.8999999999999986, -3.799999999999999, -2.700000000000002, -2.600000000000002, -7.199999999999996, -3.3000000000000007, -2.2000000000000015, -2.4000000000000017, -2.3000000000000016, -2.800000000000002, -3.5999999999999996, -3.1000000000000014, -2.5000000000000018, -2.600000000000002, -2.4000000000000017, -2.800000000000002, -2.1000000000000014, -3.0000000000000018, -2.600000000000002, -2.600000000000002, -2.600000000000002, -1.8000000000000012, -2.700000000000002, -3.1000000000000014, -3.0000000000000018, -2.600000000000002, -3.1000000000000014, -2.2000000000000015, -3.4000000000000004, -2.2000000000000015, -3.1000000000000014, -1.8000000000000012, -2.5000000000000018, -3.0000000000000018, -2.0000000000000013, -3.5, -2.4000000000000017, -2.4000000000000017, -2.3000000000000016, -2.600000000000002, -3.1000000000000014, -2.3000000000000016, -1.600000000000001, -2.4000000000000017, -2.600000000000002, -2.600000000000002, -2.3000000000000016, -2.900000000000002, -1.600000000000001, -2.2000000000000015, -3.3000000000000007, -2.700000000000002, -3.5, -3.3000000000000007, -2.600000000000002, -2.600000000000002, -2.2000000000000015, -2.5000000000000018, -2.0000000000000013, -2.2000000000000015, -5.4999999999999964, -2.4000000000000017, -2.1000000000000014, -3.0000000000000018, -2.700000000000002, -1.9000000000000012, -3.4000000000000004, -2.700000000000002, -3.1000000000000014, -2.900000000000002, -2.700000000000002], "episode_lengths": [50, 37, 37, 40, 35, 40, 41, 42, 39, 37, 39, 37, 28, 29, 40, 33, 30, 36, 41, 33, 34, 35, 72, 42, 48, 33, 35, 32, 38, 43, 34, 37, 44, 50, 49, 38, 37, 73, 44, 33, 35, 34, 39, 47, 40, 36, 37, 35, 39, 32, 41, 37, 37, 37, 29, 38, 42, 41, 37, 42, 33, 45, 33, 42, 29, 36, 41, 31, 46, 35, 35, 32, 37, 42, 34, 27, 35, 37, 37, 34, 40, 27, 33, 44, 38, 38, 44, 37, 37, 33, 36, 31, 33, 62, 35, 32, 41, 38, 30, 45, 38, 42, 40, 38]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24637525809392147, "mean_inference_ms": 0.6236673187419173, "mean_action_processing_ms": 0.0685559561137833, "mean_env_wait_ms": 6.2901760219238705, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005197066527146559, "StateBufferConnector_ms": 0.003308974779569186, "ViewRequirementAgentConnector_ms": 0.07626437223874606}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 120000, "num_agent_steps_trained": 120000, "num_env_steps_sampled": 120000, "num_env_steps_trained": 120000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 342.5407700344774, "num_env_steps_trained_throughput_per_sec": 342.5407700344774, "timesteps_total": 120000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 120000, "timers": {"training_iteration_time_ms": 11275.969, "sample_time_ms": 7786.778, "load_time_ms": 0.974, "load_throughput": 4104919.38, "learn_time_ms": 3485.922, "learn_throughput": 1147.473, "synch_weights_time_ms": 1.667}, "counters": {"num_env_steps_sampled": 120000, "num_env_steps_trained": 120000, "num_agent_steps_sampled": 120000, "num_agent_steps_trained": 120000}, "done": false, "episodes_total": 1283, "training_iteration": 30, "trial_id": "329fa_00000", "date": "2024-03-07_12-27-28", "timestamp": 1709832448, "time_this_iter_s": 11.679917097091675, "time_total_s": 325.3096077442169, "pid": 105400, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fcd19c36f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 325.3096077442169, "iterations_since_restore": 30, "perf": {"cpu_util_percent": 20.48, "ram_util_percent": 43.70000000000001, "gpu_util_percent0": 0.07066666666666667, "vram_util_percent0": 0.09879557291666669}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.10000000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 0.24933376890533324, "policy_loss": -0.012424940774117106, "vf_loss": 0.2604829083727573, "vf_explained_var": 0.8817765166041671, "kl": 0.012758012408221095, "entropy": 0.5366525416733117, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 28365.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 124000, "num_env_steps_trained": 124000, "num_agent_steps_sampled": 124000, "num_agent_steps_trained": 124000}, "sampler_results": {"episode_reward_max": -1.5000000000000009, "episode_reward_min": -8.39999999999999, "episode_reward_mean": -2.5603603603603613, "episode_len_mean": 36.11711711711712, "episode_media": {}, "episodes_this_iter": 111, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.0000000000000018, -1.9000000000000012, -1.700000000000001, -2.700000000000002, -2.4000000000000017, -2.5000000000000018, -3.0000000000000018, -2.600000000000002, -2.900000000000002, -2.700000000000002, -1.9000000000000012, -3.6999999999999993, -3.3000000000000007, -2.5000000000000018, -2.700000000000002, -2.0000000000000013, -2.700000000000002, -2.4000000000000017, -2.1000000000000014, -3.6999999999999993, -3.200000000000001, -1.9000000000000012, -2.4000000000000017, -2.800000000000002, -3.4000000000000004, -1.9000000000000012, -1.9000000000000012, -1.700000000000001, -2.2000000000000015, -2.4000000000000017, -2.3000000000000016, -3.5999999999999996, -2.4000000000000017, -2.1000000000000014, -2.2000000000000015, -2.2000000000000015, -2.2000000000000015, -3.1000000000000014, -3.0000000000000018, -2.3000000000000016, -2.4000000000000017, -2.3000000000000016, -2.4000000000000017, -2.3000000000000016, -2.3000000000000016, -2.5000000000000018, -3.0000000000000018, -2.1000000000000014, -2.600000000000002, -3.200000000000001, -1.9000000000000012, -2.800000000000002, -5.4, -2.600000000000002, -3.8999999999999986, -2.2000000000000015, -2.800000000000002, -2.3000000000000016, -2.5000000000000018, -2.1000000000000014, -2.1000000000000014, -1.8000000000000012, -2.1000000000000014, -2.600000000000002, -2.5000000000000018, -1.9000000000000012, -3.9000000000000004, -2.3000000000000016, -2.5000000000000018, -2.2000000000000015, -2.0000000000000013, -2.3000000000000016, -8.39999999999999, -2.4000000000000012, -5.199999999999994, -3.0000000000000018, -3.5999999999999996, -2.0000000000000013, -2.5000000000000018, -2.2000000000000015, -2.2000000000000015, -2.900000000000002, -1.700000000000001, -2.3000000000000016, -1.5000000000000009, -1.600000000000001, -1.9000000000000012, -3.4000000000000004, -2.1000000000000014, -2.2000000000000015, -2.700000000000002, -2.0000000000000013, -2.4000000000000017, -1.8000000000000012, -3.8999999999999986, -2.3000000000000016, -2.4000000000000017, -2.1000000000000014, -1.600000000000001, -3.1000000000000014, -2.4000000000000017, -2.4000000000000017, -2.900000000000002, -3.200000000000002, -2.0000000000000013, -1.9000000000000012, -2.3000000000000016, -2.0000000000000013, -2.2000000000000015, -2.600000000000002, -1.5000000000000009], "episode_lengths": [41, 30, 28, 38, 35, 36, 41, 37, 40, 38, 30, 48, 44, 36, 38, 31, 38, 35, 32, 48, 43, 30, 35, 39, 45, 30, 30, 28, 33, 35, 34, 47, 35, 32, 33, 33, 33, 42, 40, 34, 35, 34, 35, 34, 34, 36, 41, 32, 37, 39, 30, 39, 57, 37, 50, 33, 39, 34, 36, 32, 32, 29, 32, 37, 36, 30, 48, 34, 36, 33, 31, 34, 63, 31, 63, 41, 47, 31, 36, 33, 33, 40, 28, 34, 26, 27, 30, 45, 32, 33, 38, 31, 35, 29, 50, 34, 35, 32, 27, 42, 35, 35, 40, 40, 31, 30, 34, 31, 33, 37, 26]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24997444694388485, "mean_inference_ms": 0.6240792877148172, "mean_action_processing_ms": 0.06857234888638204, "mean_env_wait_ms": 6.316171381532377, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005232965624010241, "StateBufferConnector_ms": 0.003206837284672368, "ViewRequirementAgentConnector_ms": 0.0762415361834002}}, "episode_reward_max": -1.5000000000000009, "episode_reward_min": -8.39999999999999, "episode_reward_mean": -2.5603603603603613, "episode_len_mean": 36.11711711711712, "episodes_this_iter": 111, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3.0000000000000018, -1.9000000000000012, -1.700000000000001, -2.700000000000002, -2.4000000000000017, -2.5000000000000018, -3.0000000000000018, -2.600000000000002, -2.900000000000002, -2.700000000000002, -1.9000000000000012, -3.6999999999999993, -3.3000000000000007, -2.5000000000000018, -2.700000000000002, -2.0000000000000013, -2.700000000000002, -2.4000000000000017, -2.1000000000000014, -3.6999999999999993, -3.200000000000001, -1.9000000000000012, -2.4000000000000017, -2.800000000000002, -3.4000000000000004, -1.9000000000000012, -1.9000000000000012, -1.700000000000001, -2.2000000000000015, -2.4000000000000017, -2.3000000000000016, -3.5999999999999996, -2.4000000000000017, -2.1000000000000014, -2.2000000000000015, -2.2000000000000015, -2.2000000000000015, -3.1000000000000014, -3.0000000000000018, -2.3000000000000016, -2.4000000000000017, -2.3000000000000016, -2.4000000000000017, -2.3000000000000016, -2.3000000000000016, -2.5000000000000018, -3.0000000000000018, -2.1000000000000014, -2.600000000000002, -3.200000000000001, -1.9000000000000012, -2.800000000000002, -5.4, -2.600000000000002, -3.8999999999999986, -2.2000000000000015, -2.800000000000002, -2.3000000000000016, -2.5000000000000018, -2.1000000000000014, -2.1000000000000014, -1.8000000000000012, -2.1000000000000014, -2.600000000000002, -2.5000000000000018, -1.9000000000000012, -3.9000000000000004, -2.3000000000000016, -2.5000000000000018, -2.2000000000000015, -2.0000000000000013, -2.3000000000000016, -8.39999999999999, -2.4000000000000012, -5.199999999999994, -3.0000000000000018, -3.5999999999999996, -2.0000000000000013, -2.5000000000000018, -2.2000000000000015, -2.2000000000000015, -2.900000000000002, -1.700000000000001, -2.3000000000000016, -1.5000000000000009, -1.600000000000001, -1.9000000000000012, -3.4000000000000004, -2.1000000000000014, -2.2000000000000015, -2.700000000000002, -2.0000000000000013, -2.4000000000000017, -1.8000000000000012, -3.8999999999999986, -2.3000000000000016, -2.4000000000000017, -2.1000000000000014, -1.600000000000001, -3.1000000000000014, -2.4000000000000017, -2.4000000000000017, -2.900000000000002, -3.200000000000002, -2.0000000000000013, -1.9000000000000012, -2.3000000000000016, -2.0000000000000013, -2.2000000000000015, -2.600000000000002, -1.5000000000000009], "episode_lengths": [41, 30, 28, 38, 35, 36, 41, 37, 40, 38, 30, 48, 44, 36, 38, 31, 38, 35, 32, 48, 43, 30, 35, 39, 45, 30, 30, 28, 33, 35, 34, 47, 35, 32, 33, 33, 33, 42, 40, 34, 35, 34, 35, 34, 34, 36, 41, 32, 37, 39, 30, 39, 57, 37, 50, 33, 39, 34, 36, 32, 32, 29, 32, 37, 36, 30, 48, 34, 36, 33, 31, 34, 63, 31, 63, 41, 47, 31, 36, 33, 33, 40, 28, 34, 26, 27, 30, 45, 32, 33, 38, 31, 35, 29, 50, 34, 35, 32, 27, 42, 35, 35, 40, 40, 31, 30, 34, 31, 33, 37, 26]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24997444694388485, "mean_inference_ms": 0.6240792877148172, "mean_action_processing_ms": 0.06857234888638204, "mean_env_wait_ms": 6.316171381532377, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005232965624010241, "StateBufferConnector_ms": 0.003206837284672368, "ViewRequirementAgentConnector_ms": 0.0762415361834002}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 124000, "num_agent_steps_trained": 124000, "num_env_steps_sampled": 124000, "num_env_steps_trained": 124000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 336.7603075890549, "num_env_steps_trained_throughput_per_sec": 336.7603075890549, "timesteps_total": 124000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 124000, "timers": {"training_iteration_time_ms": 11367.975, "sample_time_ms": 7883.31, "load_time_ms": 0.977, "load_throughput": 4092902.344, "learn_time_ms": 3481.401, "learn_throughput": 1148.963, "synch_weights_time_ms": 1.661}, "counters": {"num_env_steps_sampled": 124000, "num_env_steps_trained": 124000, "num_agent_steps_sampled": 124000, "num_agent_steps_trained": 124000}, "done": false, "episodes_total": 1394, "training_iteration": 31, "trial_id": "329fa_00000", "date": "2024-03-07_12-27-40", "timestamp": 1709832460, "time_this_iter_s": 11.880276679992676, "time_total_s": 337.1898844242096, "pid": 105400, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fcd19c36f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 337.1898844242096, "iterations_since_restore": 31, "perf": {"cpu_util_percent": 19.54375, "ram_util_percent": 43.650000000000006, "gpu_util_percent0": 0.076875, "vram_util_percent0": 0.09879557291666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.10000000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 0.3845784979182676, "policy_loss": -0.006862449020107267, "vf_loss": 0.3905480120321035, "vf_explained_var": 0.8161810271201595, "kl": 0.008929357653095752, "entropy": 0.4867189359921281, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 29295.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 128000, "num_env_steps_trained": 128000, "num_agent_steps_sampled": 128000, "num_agent_steps_trained": 128000}, "sampler_results": {"episode_reward_max": -1.5000000000000009, "episode_reward_min": -8.200000000000001, "episode_reward_mean": -2.6172727272727285, "episode_len_mean": 36.25454545454546, "episode_media": {}, "episodes_this_iter": 110, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.0000000000000027, -3.200000000000001, -2.700000000000002, -2.4000000000000017, -2.2000000000000015, -2.0000000000000013, -2.2000000000000015, -2.0000000000000013, -1.9000000000000012, -2.1000000000000014, -3.0000000000000018, -3.200000000000001, -2.4000000000000017, -2.5000000000000018, -2.3000000000000016, -2.800000000000002, -2.5000000000000018, -2.0000000000000013, -2.3000000000000016, -2.1000000000000014, -2.3000000000000016, -2.2000000000000015, -2.0000000000000013, -2.600000000000002, -2.700000000000002, -3.7, -2.3000000000000016, -2.3000000000000016, -5.500000000000003, -2.3000000000000016, -1.9000000000000012, -2.600000000000002, -2.600000000000002, -3.0000000000000018, -2.2000000000000015, -2.600000000000002, -2.700000000000002, -2.5000000000000018, -1.8000000000000012, -2.4000000000000017, -2.0000000000000013, -4.100000000000001, -2.4000000000000017, -2.2000000000000015, -2.4000000000000017, -2.1000000000000014, -2.1000000000000014, -4.800000000000002, -2.3000000000000016, -4.299999999999997, -4.8000000000000025, -2.0000000000000013, -2.3000000000000016, -3.3000000000000007, -2.2000000000000015, -7.699999999999999, -1.8000000000000012, -2.800000000000002, -2.800000000000002, -2.2000000000000015, -2.3000000000000016, -2.2000000000000015, -2.0000000000000013, -2.1000000000000014, -2.1000000000000014, -2.600000000000002, -3.1000000000000014, -2.700000000000002, -2.900000000000002, -1.600000000000001, -2.2000000000000015, -2.1000000000000014, -2.0000000000000013, -2.5000000000000018, -2.2000000000000015, -3.700000000000001, -1.700000000000001, -2.1000000000000014, -2.0000000000000013, -2.0000000000000013, -3.3000000000000007, -3.5, -8.200000000000001, -1.700000000000001, -2.1000000000000014, -2.600000000000002, -3.0000000000000018, -2.1000000000000014, -1.9000000000000012, -2.4000000000000017, -2.2000000000000015, -2.700000000000002, -4.000000000000003, -2.3000000000000016, -2.2000000000000015, -2.5000000000000018, -2.900000000000002, -2.0000000000000013, -2.4000000000000017, -2.600000000000002, -2.0000000000000013, -2.2000000000000015, -1.700000000000001, -2.4000000000000017, -2.1000000000000014, -2.4000000000000017, -2.4000000000000017, -2.0000000000000013, -4.899999999999995, -1.5000000000000009], "episode_lengths": [39, 43, 38, 35, 33, 31, 33, 31, 30, 32, 41, 43, 35, 36, 34, 39, 36, 31, 34, 32, 34, 33, 31, 37, 38, 44, 34, 34, 55, 34, 30, 37, 37, 41, 33, 37, 38, 36, 29, 35, 31, 46, 35, 33, 35, 32, 32, 52, 34, 54, 51, 31, 34, 40, 33, 68, 29, 39, 39, 33, 34, 33, 31, 32, 32, 37, 41, 37, 40, 27, 33, 32, 31, 36, 33, 46, 28, 32, 31, 31, 44, 46, 66, 28, 32, 37, 41, 32, 30, 35, 33, 38, 43, 34, 33, 36, 40, 31, 35, 37, 31, 33, 28, 35, 32, 35, 35, 31, 60, 26]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.25335805099961833, "mean_inference_ms": 0.6246380195433554, "mean_action_processing_ms": 0.06859083717583932, "mean_env_wait_ms": 6.341166495206714, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005109526894309304, "StateBufferConnector_ms": 0.0033710219643332743, "ViewRequirementAgentConnector_ms": 0.0757345286282626}}, "episode_reward_max": -1.5000000000000009, "episode_reward_min": -8.200000000000001, "episode_reward_mean": -2.6172727272727285, "episode_len_mean": 36.25454545454546, "episodes_this_iter": 110, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3.0000000000000027, -3.200000000000001, -2.700000000000002, -2.4000000000000017, -2.2000000000000015, -2.0000000000000013, -2.2000000000000015, -2.0000000000000013, -1.9000000000000012, -2.1000000000000014, -3.0000000000000018, -3.200000000000001, -2.4000000000000017, -2.5000000000000018, -2.3000000000000016, -2.800000000000002, -2.5000000000000018, -2.0000000000000013, -2.3000000000000016, -2.1000000000000014, -2.3000000000000016, -2.2000000000000015, -2.0000000000000013, -2.600000000000002, -2.700000000000002, -3.7, -2.3000000000000016, -2.3000000000000016, -5.500000000000003, -2.3000000000000016, -1.9000000000000012, -2.600000000000002, -2.600000000000002, -3.0000000000000018, -2.2000000000000015, -2.600000000000002, -2.700000000000002, -2.5000000000000018, -1.8000000000000012, -2.4000000000000017, -2.0000000000000013, -4.100000000000001, -2.4000000000000017, -2.2000000000000015, -2.4000000000000017, -2.1000000000000014, -2.1000000000000014, -4.800000000000002, -2.3000000000000016, -4.299999999999997, -4.8000000000000025, -2.0000000000000013, -2.3000000000000016, -3.3000000000000007, -2.2000000000000015, -7.699999999999999, -1.8000000000000012, -2.800000000000002, -2.800000000000002, -2.2000000000000015, -2.3000000000000016, -2.2000000000000015, -2.0000000000000013, -2.1000000000000014, -2.1000000000000014, -2.600000000000002, -3.1000000000000014, -2.700000000000002, -2.900000000000002, -1.600000000000001, -2.2000000000000015, -2.1000000000000014, -2.0000000000000013, -2.5000000000000018, -2.2000000000000015, -3.700000000000001, -1.700000000000001, -2.1000000000000014, -2.0000000000000013, -2.0000000000000013, -3.3000000000000007, -3.5, -8.200000000000001, -1.700000000000001, -2.1000000000000014, -2.600000000000002, -3.0000000000000018, -2.1000000000000014, -1.9000000000000012, -2.4000000000000017, -2.2000000000000015, -2.700000000000002, -4.000000000000003, -2.3000000000000016, -2.2000000000000015, -2.5000000000000018, -2.900000000000002, -2.0000000000000013, -2.4000000000000017, -2.600000000000002, -2.0000000000000013, -2.2000000000000015, -1.700000000000001, -2.4000000000000017, -2.1000000000000014, -2.4000000000000017, -2.4000000000000017, -2.0000000000000013, -4.899999999999995, -1.5000000000000009], "episode_lengths": [39, 43, 38, 35, 33, 31, 33, 31, 30, 32, 41, 43, 35, 36, 34, 39, 36, 31, 34, 32, 34, 33, 31, 37, 38, 44, 34, 34, 55, 34, 30, 37, 37, 41, 33, 37, 38, 36, 29, 35, 31, 46, 35, 33, 35, 32, 32, 52, 34, 54, 51, 31, 34, 40, 33, 68, 29, 39, 39, 33, 34, 33, 31, 32, 32, 37, 41, 37, 40, 27, 33, 32, 31, 36, 33, 46, 28, 32, 31, 31, 44, 46, 66, 28, 32, 37, 41, 32, 30, 35, 33, 38, 43, 34, 33, 36, 40, 31, 35, 37, 31, 33, 28, 35, 32, 35, 35, 31, 60, 26]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.25335805099961833, "mean_inference_ms": 0.6246380195433554, "mean_action_processing_ms": 0.06859083717583932, "mean_env_wait_ms": 6.341166495206714, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005109526894309304, "StateBufferConnector_ms": 0.0033710219643332743, "ViewRequirementAgentConnector_ms": 0.0757345286282626}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 128000, "num_agent_steps_trained": 128000, "num_env_steps_sampled": 128000, "num_env_steps_trained": 128000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 341.308876752443, "num_env_steps_trained_throughput_per_sec": 341.308876752443, "timesteps_total": 128000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 128000, "timers": {"training_iteration_time_ms": 11445.536, "sample_time_ms": 7960.475, "load_time_ms": 0.983, "load_throughput": 4070657.77, "learn_time_ms": 3481.769, "learn_throughput": 1148.841, "synch_weights_time_ms": 1.686}, "counters": {"num_env_steps_sampled": 128000, "num_env_steps_trained": 128000, "num_agent_steps_sampled": 128000, "num_agent_steps_trained": 128000}, "done": false, "episodes_total": 1504, "training_iteration": 32, "trial_id": "329fa_00000", "date": "2024-03-07_12-27-52", "timestamp": 1709832472, "time_this_iter_s": 11.722243309020996, "time_total_s": 348.9121277332306, "pid": 105400, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fcd19c36f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 348.9121277332306, "iterations_since_restore": 32, "perf": {"cpu_util_percent": 21.133333333333336, "ram_util_percent": 43.646666666666675, "gpu_util_percent0": 0.07133333333333332, "vram_util_percent0": 0.09879557291666669}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.10000000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 0.10355311461632961, "policy_loss": -0.009360795311870113, "vf_loss": 0.11227755965264415, "vf_explained_var": 0.9131614528035605, "kl": 0.006363510064974402, "entropy": 0.45775007458143335, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 30225.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 132000, "num_env_steps_trained": 132000, "num_agent_steps_sampled": 132000, "num_agent_steps_trained": 132000}, "sampler_results": {"episode_reward_max": -1.5000000000000009, "episode_reward_min": -5.400000000000004, "episode_reward_mean": -2.4339130434782623, "episode_len_mean": 34.93913043478261, "episode_media": {}, "episodes_this_iter": 115, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2.700000000000002, -1.9000000000000012, -2.800000000000002, -2.600000000000002, -2.700000000000002, -3.0000000000000018, -3.9000000000000012, -2.3000000000000016, -4.999999999999995, -1.700000000000001, -2.2000000000000015, -2.1000000000000014, -2.800000000000002, -1.700000000000001, -1.9000000000000012, -1.9000000000000012, -2.3000000000000016, -2.2000000000000015, -2.1000000000000014, -1.8000000000000012, -3.8, -2.2000000000000015, -2.800000000000002, -2.2000000000000015, -2.600000000000002, -2.4000000000000017, -2.2000000000000015, -2.3000000000000016, -4.6999999999999975, -2.0000000000000013, -2.900000000000002, -1.8000000000000012, -2.800000000000002, -2.700000000000002, -2.4000000000000017, -2.3000000000000016, -2.3000000000000016, -2.3000000000000016, -2.0000000000000013, -1.9000000000000012, -2.1000000000000014, -1.9000000000000012, -2.0000000000000013, -2.4000000000000017, -2.4000000000000017, -3.0000000000000018, -2.0000000000000013, -2.5000000000000018, -2.1000000000000014, -3.8000000000000007, -3.7, -2.1000000000000014, -1.8000000000000012, -2.0000000000000013, -1.700000000000001, -2.1000000000000014, -2.1000000000000014, -2.4000000000000017, -1.8000000000000012, -2.1000000000000014, -2.900000000000002, -3.6000000000000023, -1.9000000000000012, -1.9000000000000012, -2.600000000000002, -4.0, -2.900000000000002, -2.600000000000002, -2.2000000000000015, -3.3000000000000007, -2.4000000000000017, -2.1000000000000014, -2.3000000000000016, -2.1000000000000014, -2.1000000000000014, -2.3000000000000016, -1.700000000000001, -2.0000000000000013, -2.4000000000000017, -3.0000000000000018, -1.8000000000000012, -1.9000000000000012, -2.2000000000000015, -2.1000000000000014, -3.1000000000000014, -2.900000000000002, -5.400000000000004, -1.5000000000000009, -2.1000000000000014, -2.5000000000000018, -3.200000000000001, -1.9000000000000012, -2.700000000000002, -4.500000000000002, -2.3000000000000016, -2.5000000000000018, -2.2000000000000015, -2.1000000000000014, -2.1000000000000014, -2.5000000000000018, -1.8000000000000012, -2.5000000000000018, -1.9000000000000012, -2.3000000000000016, -2.4000000000000017, -2.0000000000000013, -2.0000000000000013, -2.2000000000000015, -2.1000000000000014, -1.9000000000000012, -2.2000000000000015, -2.0000000000000013, -2.2000000000000015, -2.800000000000002, -1.600000000000001], "episode_lengths": [38, 30, 39, 37, 38, 41, 44, 34, 59, 28, 33, 32, 39, 28, 30, 30, 34, 33, 32, 29, 48, 33, 39, 33, 37, 35, 33, 34, 56, 31, 40, 29, 39, 38, 35, 34, 34, 34, 31, 30, 32, 30, 31, 35, 35, 41, 31, 36, 32, 47, 46, 32, 29, 31, 28, 32, 32, 35, 29, 32, 40, 43, 30, 30, 37, 47, 40, 37, 33, 44, 35, 32, 34, 32, 32, 34, 28, 31, 35, 41, 29, 30, 33, 32, 42, 39, 51, 26, 32, 36, 42, 30, 38, 49, 34, 36, 33, 32, 32, 36, 29, 36, 30, 34, 35, 31, 31, 33, 32, 30, 33, 31, 33, 39, 27]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2566758653825438, "mean_inference_ms": 0.6250248236415221, "mean_action_processing_ms": 0.06865271533799996, "mean_env_wait_ms": 6.3635263586316375, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0054338703984799595, "StateBufferConnector_ms": 0.0032926642376443615, "ViewRequirementAgentConnector_ms": 0.07536390553350034}}, "episode_reward_max": -1.5000000000000009, "episode_reward_min": -5.400000000000004, "episode_reward_mean": -2.4339130434782623, "episode_len_mean": 34.93913043478261, "episodes_this_iter": 115, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-2.700000000000002, -1.9000000000000012, -2.800000000000002, -2.600000000000002, -2.700000000000002, -3.0000000000000018, -3.9000000000000012, -2.3000000000000016, -4.999999999999995, -1.700000000000001, -2.2000000000000015, -2.1000000000000014, -2.800000000000002, -1.700000000000001, -1.9000000000000012, -1.9000000000000012, -2.3000000000000016, -2.2000000000000015, -2.1000000000000014, -1.8000000000000012, -3.8, -2.2000000000000015, -2.800000000000002, -2.2000000000000015, -2.600000000000002, -2.4000000000000017, -2.2000000000000015, -2.3000000000000016, -4.6999999999999975, -2.0000000000000013, -2.900000000000002, -1.8000000000000012, -2.800000000000002, -2.700000000000002, -2.4000000000000017, -2.3000000000000016, -2.3000000000000016, -2.3000000000000016, -2.0000000000000013, -1.9000000000000012, -2.1000000000000014, -1.9000000000000012, -2.0000000000000013, -2.4000000000000017, -2.4000000000000017, -3.0000000000000018, -2.0000000000000013, -2.5000000000000018, -2.1000000000000014, -3.8000000000000007, -3.7, -2.1000000000000014, -1.8000000000000012, -2.0000000000000013, -1.700000000000001, -2.1000000000000014, -2.1000000000000014, -2.4000000000000017, -1.8000000000000012, -2.1000000000000014, -2.900000000000002, -3.6000000000000023, -1.9000000000000012, -1.9000000000000012, -2.600000000000002, -4.0, -2.900000000000002, -2.600000000000002, -2.2000000000000015, -3.3000000000000007, -2.4000000000000017, -2.1000000000000014, -2.3000000000000016, -2.1000000000000014, -2.1000000000000014, -2.3000000000000016, -1.700000000000001, -2.0000000000000013, -2.4000000000000017, -3.0000000000000018, -1.8000000000000012, -1.9000000000000012, -2.2000000000000015, -2.1000000000000014, -3.1000000000000014, -2.900000000000002, -5.400000000000004, -1.5000000000000009, -2.1000000000000014, -2.5000000000000018, -3.200000000000001, -1.9000000000000012, -2.700000000000002, -4.500000000000002, -2.3000000000000016, -2.5000000000000018, -2.2000000000000015, -2.1000000000000014, -2.1000000000000014, -2.5000000000000018, -1.8000000000000012, -2.5000000000000018, -1.9000000000000012, -2.3000000000000016, -2.4000000000000017, -2.0000000000000013, -2.0000000000000013, -2.2000000000000015, -2.1000000000000014, -1.9000000000000012, -2.2000000000000015, -2.0000000000000013, -2.2000000000000015, -2.800000000000002, -1.600000000000001], "episode_lengths": [38, 30, 39, 37, 38, 41, 44, 34, 59, 28, 33, 32, 39, 28, 30, 30, 34, 33, 32, 29, 48, 33, 39, 33, 37, 35, 33, 34, 56, 31, 40, 29, 39, 38, 35, 34, 34, 34, 31, 30, 32, 30, 31, 35, 35, 41, 31, 36, 32, 47, 46, 32, 29, 31, 28, 32, 32, 35, 29, 32, 40, 43, 30, 30, 37, 47, 40, 37, 33, 44, 35, 32, 34, 32, 32, 34, 28, 31, 35, 41, 29, 30, 33, 32, 42, 39, 51, 26, 32, 36, 42, 30, 38, 49, 34, 36, 33, 32, 32, 36, 29, 36, 30, 34, 35, 31, 31, 33, 32, 30, 33, 31, 33, 39, 27]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2566758653825438, "mean_inference_ms": 0.6250248236415221, "mean_action_processing_ms": 0.06865271533799996, "mean_env_wait_ms": 6.3635263586316375, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0054338703984799595, "StateBufferConnector_ms": 0.0032926642376443615, "ViewRequirementAgentConnector_ms": 0.07536390553350034}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 132000, "num_agent_steps_trained": 132000, "num_env_steps_sampled": 132000, "num_env_steps_trained": 132000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 340.0204994639634, "num_env_steps_trained_throughput_per_sec": 340.0204994639634, "timesteps_total": 132000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 132000, "timers": {"training_iteration_time_ms": 11527.81, "sample_time_ms": 8036.575, "load_time_ms": 0.983, "load_throughput": 4068486.068, "learn_time_ms": 3487.944, "learn_throughput": 1146.807, "synch_weights_time_ms": 1.693}, "counters": {"num_env_steps_sampled": 132000, "num_env_steps_trained": 132000, "num_agent_steps_sampled": 132000, "num_agent_steps_trained": 132000}, "done": false, "episodes_total": 1619, "training_iteration": 33, "trial_id": "329fa_00000", "date": "2024-03-07_12-28-04", "timestamp": 1709832484, "time_this_iter_s": 11.766945838928223, "time_total_s": 360.6790735721588, "pid": 105400, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fcd19c36f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 360.6790735721588, "iterations_since_restore": 33, "perf": {"cpu_util_percent": 20.38666666666666, "ram_util_percent": 43.67333333333333, "gpu_util_percent0": 0.06999999999999999, "vram_util_percent0": 0.09879557291666669}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.10000000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 0.14573750076715344, "policy_loss": -0.009406144767799364, "vf_loss": 0.1540321535040294, "vf_explained_var": 0.8963410647325618, "kl": 0.011114925462891721, "entropy": 0.42890169258399674, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 31155.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 136000, "num_env_steps_trained": 136000, "num_agent_steps_sampled": 136000, "num_agent_steps_trained": 136000}, "sampler_results": {"episode_reward_max": -1.4000000000000008, "episode_reward_min": -5.0000000000000036, "episode_reward_mean": -2.2666666666666675, "episode_len_mean": 33.391666666666666, "episode_media": {}, "episodes_this_iter": 120, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2.1000000000000014, -2.1000000000000014, -2.4000000000000017, -3.1000000000000014, -4.899999999999997, -2.1000000000000014, -2.700000000000002, -2.0000000000000013, -2.3000000000000016, -2.2000000000000015, -5.0000000000000036, -1.5000000000000009, -1.9000000000000012, -2.2000000000000015, -2.3000000000000016, -2.700000000000002, -3.0000000000000018, -3.5, -2.2000000000000015, -1.9000000000000012, -1.9000000000000012, -2.4000000000000017, -2.0000000000000013, -3.0000000000000018, -1.9000000000000012, -1.8000000000000012, -2.1000000000000014, -1.600000000000001, -2.900000000000002, -2.5000000000000018, -2.0000000000000013, -2.3000000000000016, -3.8000000000000016, -2.0000000000000013, -2.1000000000000014, -1.9000000000000012, -2.4000000000000017, -2.1000000000000014, -2.3000000000000016, -2.600000000000002, -2.5000000000000018, -2.5000000000000018, -2.3000000000000016, -2.0000000000000013, -2.1000000000000014, -2.600000000000002, -2.3000000000000016, -2.0000000000000013, -2.0000000000000013, -2.4000000000000017, -1.9000000000000012, -2.1000000000000014, -1.9000000000000012, -2.2000000000000015, -2.800000000000002, -2.0000000000000013, -2.600000000000002, -1.9000000000000012, -2.0000000000000013, -1.700000000000001, -2.0000000000000013, -1.9000000000000012, -2.4000000000000017, -2.600000000000002, -2.0000000000000013, -2.5000000000000018, -2.0000000000000013, -2.0000000000000013, -2.0000000000000013, -1.9000000000000012, -1.9000000000000012, -1.8000000000000012, -3.5000000000000018, -2.5000000000000018, -1.4000000000000008, -1.9000000000000012, -1.9000000000000012, -2.3000000000000016, -2.1000000000000014, -1.700000000000001, -2.2000000000000015, -2.5000000000000018, -2.5000000000000018, -1.8000000000000012, -2.700000000000002, -2.4000000000000017, -1.700000000000001, -1.700000000000001, -2.5000000000000018, -2.0000000000000013, -3.1000000000000014, -1.8000000000000012, -1.9000000000000012, -1.9000000000000012, -2.5000000000000018, -2.900000000000002, -2.3000000000000016, -2.4000000000000017, -1.8000000000000012, -1.8000000000000012, -2.4000000000000017, -2.1000000000000014, -3.0000000000000018, -2.3000000000000016, -1.8000000000000012, -2.700000000000002, -2.4000000000000017, -2.2000000000000015, -2.2000000000000015, -1.9000000000000012, -2.0000000000000013, -2.0000000000000013, -2.0000000000000013, -2.5000000000000018, -2.0000000000000013, -2.3000000000000016, -2.4000000000000017, -1.700000000000001, -2.4000000000000017, -1.5000000000000009], "episode_lengths": [32, 32, 35, 40, 54, 32, 38, 31, 34, 33, 48, 26, 30, 33, 34, 38, 41, 46, 33, 30, 30, 35, 31, 41, 30, 29, 32, 27, 40, 36, 31, 34, 43, 31, 32, 30, 35, 32, 34, 37, 36, 36, 34, 31, 32, 37, 34, 31, 31, 35, 30, 32, 30, 33, 39, 31, 37, 30, 31, 28, 31, 30, 35, 37, 31, 36, 31, 31, 31, 30, 30, 29, 41, 36, 25, 30, 30, 34, 32, 28, 33, 36, 36, 29, 38, 35, 28, 28, 36, 31, 42, 29, 30, 30, 36, 40, 34, 35, 29, 29, 35, 32, 40, 34, 29, 38, 35, 33, 33, 30, 31, 31, 31, 36, 31, 34, 35, 28, 35, 26]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2600955553861576, "mean_inference_ms": 0.6254432038424178, "mean_action_processing_ms": 0.06864300351780377, "mean_env_wait_ms": 6.388630743638095, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005195140838623047, "StateBufferConnector_ms": 0.0032842159271240234, "ViewRequirementAgentConnector_ms": 0.07574260234832764}}, "episode_reward_max": -1.4000000000000008, "episode_reward_min": -5.0000000000000036, "episode_reward_mean": -2.2666666666666675, "episode_len_mean": 33.391666666666666, "episodes_this_iter": 120, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-2.1000000000000014, -2.1000000000000014, -2.4000000000000017, -3.1000000000000014, -4.899999999999997, -2.1000000000000014, -2.700000000000002, -2.0000000000000013, -2.3000000000000016, -2.2000000000000015, -5.0000000000000036, -1.5000000000000009, -1.9000000000000012, -2.2000000000000015, -2.3000000000000016, -2.700000000000002, -3.0000000000000018, -3.5, -2.2000000000000015, -1.9000000000000012, -1.9000000000000012, -2.4000000000000017, -2.0000000000000013, -3.0000000000000018, -1.9000000000000012, -1.8000000000000012, -2.1000000000000014, -1.600000000000001, -2.900000000000002, -2.5000000000000018, -2.0000000000000013, -2.3000000000000016, -3.8000000000000016, -2.0000000000000013, -2.1000000000000014, -1.9000000000000012, -2.4000000000000017, -2.1000000000000014, -2.3000000000000016, -2.600000000000002, -2.5000000000000018, -2.5000000000000018, -2.3000000000000016, -2.0000000000000013, -2.1000000000000014, -2.600000000000002, -2.3000000000000016, -2.0000000000000013, -2.0000000000000013, -2.4000000000000017, -1.9000000000000012, -2.1000000000000014, -1.9000000000000012, -2.2000000000000015, -2.800000000000002, -2.0000000000000013, -2.600000000000002, -1.9000000000000012, -2.0000000000000013, -1.700000000000001, -2.0000000000000013, -1.9000000000000012, -2.4000000000000017, -2.600000000000002, -2.0000000000000013, -2.5000000000000018, -2.0000000000000013, -2.0000000000000013, -2.0000000000000013, -1.9000000000000012, -1.9000000000000012, -1.8000000000000012, -3.5000000000000018, -2.5000000000000018, -1.4000000000000008, -1.9000000000000012, -1.9000000000000012, -2.3000000000000016, -2.1000000000000014, -1.700000000000001, -2.2000000000000015, -2.5000000000000018, -2.5000000000000018, -1.8000000000000012, -2.700000000000002, -2.4000000000000017, -1.700000000000001, -1.700000000000001, -2.5000000000000018, -2.0000000000000013, -3.1000000000000014, -1.8000000000000012, -1.9000000000000012, -1.9000000000000012, -2.5000000000000018, -2.900000000000002, -2.3000000000000016, -2.4000000000000017, -1.8000000000000012, -1.8000000000000012, -2.4000000000000017, -2.1000000000000014, -3.0000000000000018, -2.3000000000000016, -1.8000000000000012, -2.700000000000002, -2.4000000000000017, -2.2000000000000015, -2.2000000000000015, -1.9000000000000012, -2.0000000000000013, -2.0000000000000013, -2.0000000000000013, -2.5000000000000018, -2.0000000000000013, -2.3000000000000016, -2.4000000000000017, -1.700000000000001, -2.4000000000000017, -1.5000000000000009], "episode_lengths": [32, 32, 35, 40, 54, 32, 38, 31, 34, 33, 48, 26, 30, 33, 34, 38, 41, 46, 33, 30, 30, 35, 31, 41, 30, 29, 32, 27, 40, 36, 31, 34, 43, 31, 32, 30, 35, 32, 34, 37, 36, 36, 34, 31, 32, 37, 34, 31, 31, 35, 30, 32, 30, 33, 39, 31, 37, 30, 31, 28, 31, 30, 35, 37, 31, 36, 31, 31, 31, 30, 30, 29, 41, 36, 25, 30, 30, 34, 32, 28, 33, 36, 36, 29, 38, 35, 28, 28, 36, 31, 42, 29, 30, 30, 36, 40, 34, 35, 29, 29, 35, 32, 40, 34, 29, 38, 35, 33, 33, 30, 31, 31, 31, 36, 31, 34, 35, 28, 35, 26]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2600955553861576, "mean_inference_ms": 0.6254432038424178, "mean_action_processing_ms": 0.06864300351780377, "mean_env_wait_ms": 6.388630743638095, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005195140838623047, "StateBufferConnector_ms": 0.0032842159271240234, "ViewRequirementAgentConnector_ms": 0.07574260234832764}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 136000, "num_agent_steps_trained": 136000, "num_env_steps_sampled": 136000, "num_env_steps_trained": 136000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 333.7749921177833, "num_env_steps_trained_throughput_per_sec": 333.7749921177833, "timesteps_total": 136000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 136000, "timers": {"training_iteration_time_ms": 11616.48, "sample_time_ms": 8111.253, "load_time_ms": 0.991, "load_throughput": 4036671.96, "learn_time_ms": 3501.933, "learn_throughput": 1142.226, "synch_weights_time_ms": 1.69}, "counters": {"num_env_steps_sampled": 136000, "num_env_steps_trained": 136000, "num_agent_steps_sampled": 136000, "num_agent_steps_trained": 136000}, "done": false, "episodes_total": 1739, "training_iteration": 34, "trial_id": "329fa_00000", "date": "2024-03-07_12-28-16", "timestamp": 1709832496, "time_this_iter_s": 11.9866304397583, "time_total_s": 372.6657040119171, "pid": 105400, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fcd19c36f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 372.6657040119171, "iterations_since_restore": 34, "perf": {"cpu_util_percent": 19.81875, "ram_util_percent": 43.6, "gpu_util_percent0": 0.08562499999999999, "vram_util_percent0": 0.09879557291666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.10000000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 0.037081381021147615, "policy_loss": -0.012819313710575462, "vf_loss": 0.048967939730413176, "vf_explained_var": 0.9544939112278723, "kl": 0.009327542124079354, "entropy": 0.38667867417617513, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 32085.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 140000, "num_env_steps_trained": 140000, "num_agent_steps_sampled": 140000, "num_agent_steps_trained": 140000}, "sampler_results": {"episode_reward_max": -1.5000000000000009, "episode_reward_min": -3.9000000000000004, "episode_reward_mean": -2.150806451612904, "episode_len_mean": 32.41935483870968, "episode_media": {}, "episodes_this_iter": 124, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2.1000000000000014, -1.700000000000001, -1.8000000000000012, -2.4000000000000017, -1.9000000000000012, -2.3000000000000016, -2.900000000000002, -2.1000000000000014, -1.8000000000000012, -2.600000000000002, -2.3000000000000016, -2.1000000000000014, -2.1000000000000014, -2.3000000000000016, -2.0000000000000013, -2.5000000000000018, -1.700000000000001, -2.4000000000000017, -2.600000000000002, -2.900000000000002, -1.9000000000000012, -1.700000000000001, -2.2000000000000015, -1.9000000000000012, -2.4000000000000017, -1.8000000000000012, -2.0000000000000013, -2.5000000000000018, -1.9000000000000012, -2.2000000000000015, -2.2000000000000015, -2.3000000000000016, -2.1000000000000014, -2.3000000000000016, -1.700000000000001, -1.8000000000000012, -2.0000000000000013, -2.0000000000000013, -1.5000000000000009, -2.0000000000000013, -2.600000000000002, -2.5000000000000018, -1.9000000000000012, -2.4000000000000017, -2.700000000000002, -1.9000000000000012, -2.0000000000000013, -2.2000000000000015, -1.8000000000000012, -1.8000000000000012, -2.1000000000000014, -1.9000000000000012, -2.1000000000000014, -1.8000000000000012, -1.700000000000001, -2.2000000000000015, -2.800000000000002, -2.4000000000000017, -1.5000000000000009, -2.0000000000000013, -2.2000000000000015, -2.0000000000000013, -2.600000000000002, -1.8000000000000012, -1.8000000000000012, -2.4000000000000017, -3.4000000000000004, -2.0000000000000013, -1.8000000000000012, -1.9000000000000012, -2.4000000000000017, -1.700000000000001, -1.700000000000001, -1.9000000000000012, -1.600000000000001, -1.8000000000000012, -1.600000000000001, -2.3000000000000016, -3.200000000000002, -2.3000000000000016, -1.9000000000000012, -2.2000000000000015, -2.5000000000000018, -1.8000000000000012, -3.8000000000000016, -2.0000000000000013, -2.1000000000000014, -2.4000000000000017, -3.9000000000000004, -2.3000000000000016, -2.1000000000000014, -2.1000000000000014, -1.700000000000001, -2.5000000000000018, -2.1000000000000014, -2.800000000000002, -2.700000000000002, -2.0000000000000013, -2.0000000000000013, -2.2000000000000015, -1.9000000000000012, -1.8000000000000012, -2.4000000000000017, -2.800000000000002, -2.3000000000000016, -1.9000000000000012, -1.8000000000000012, -2.0000000000000013, -1.700000000000001, -1.8000000000000012, -1.700000000000001, -2.600000000000002, -2.1000000000000014, -2.2000000000000015, -2.1000000000000014, -2.2000000000000015, -2.4000000000000017, -2.3000000000000016, -1.8000000000000012, -2.0000000000000013, -1.9000000000000012, -1.600000000000001, -2.800000000000002, -1.9000000000000012], "episode_lengths": [32, 28, 29, 35, 30, 34, 40, 32, 29, 37, 34, 32, 32, 34, 31, 36, 28, 35, 37, 40, 30, 28, 33, 30, 35, 29, 31, 36, 30, 33, 33, 34, 32, 34, 28, 29, 31, 31, 26, 31, 37, 36, 30, 35, 38, 30, 31, 33, 29, 29, 32, 30, 32, 29, 28, 33, 39, 35, 26, 31, 33, 31, 37, 29, 29, 35, 45, 31, 29, 30, 35, 28, 28, 30, 27, 29, 27, 34, 41, 34, 30, 33, 36, 29, 44, 31, 32, 35, 46, 34, 32, 32, 28, 36, 32, 39, 38, 31, 31, 33, 30, 29, 35, 39, 34, 30, 29, 31, 28, 29, 28, 37, 32, 33, 32, 33, 35, 34, 29, 31, 30, 27, 39, 30]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.26351228111481195, "mean_inference_ms": 0.6259269131690294, "mean_action_processing_ms": 0.06868887916396627, "mean_env_wait_ms": 6.412654042357012, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0053980658131261025, "StateBufferConnector_ms": 0.0032622967996904927, "ViewRequirementAgentConnector_ms": 0.07561733645777549}}, "episode_reward_max": -1.5000000000000009, "episode_reward_min": -3.9000000000000004, "episode_reward_mean": -2.150806451612904, "episode_len_mean": 32.41935483870968, "episodes_this_iter": 124, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-2.1000000000000014, -1.700000000000001, -1.8000000000000012, -2.4000000000000017, -1.9000000000000012, -2.3000000000000016, -2.900000000000002, -2.1000000000000014, -1.8000000000000012, -2.600000000000002, -2.3000000000000016, -2.1000000000000014, -2.1000000000000014, -2.3000000000000016, -2.0000000000000013, -2.5000000000000018, -1.700000000000001, -2.4000000000000017, -2.600000000000002, -2.900000000000002, -1.9000000000000012, -1.700000000000001, -2.2000000000000015, -1.9000000000000012, -2.4000000000000017, -1.8000000000000012, -2.0000000000000013, -2.5000000000000018, -1.9000000000000012, -2.2000000000000015, -2.2000000000000015, -2.3000000000000016, -2.1000000000000014, -2.3000000000000016, -1.700000000000001, -1.8000000000000012, -2.0000000000000013, -2.0000000000000013, -1.5000000000000009, -2.0000000000000013, -2.600000000000002, -2.5000000000000018, -1.9000000000000012, -2.4000000000000017, -2.700000000000002, -1.9000000000000012, -2.0000000000000013, -2.2000000000000015, -1.8000000000000012, -1.8000000000000012, -2.1000000000000014, -1.9000000000000012, -2.1000000000000014, -1.8000000000000012, -1.700000000000001, -2.2000000000000015, -2.800000000000002, -2.4000000000000017, -1.5000000000000009, -2.0000000000000013, -2.2000000000000015, -2.0000000000000013, -2.600000000000002, -1.8000000000000012, -1.8000000000000012, -2.4000000000000017, -3.4000000000000004, -2.0000000000000013, -1.8000000000000012, -1.9000000000000012, -2.4000000000000017, -1.700000000000001, -1.700000000000001, -1.9000000000000012, -1.600000000000001, -1.8000000000000012, -1.600000000000001, -2.3000000000000016, -3.200000000000002, -2.3000000000000016, -1.9000000000000012, -2.2000000000000015, -2.5000000000000018, -1.8000000000000012, -3.8000000000000016, -2.0000000000000013, -2.1000000000000014, -2.4000000000000017, -3.9000000000000004, -2.3000000000000016, -2.1000000000000014, -2.1000000000000014, -1.700000000000001, -2.5000000000000018, -2.1000000000000014, -2.800000000000002, -2.700000000000002, -2.0000000000000013, -2.0000000000000013, -2.2000000000000015, -1.9000000000000012, -1.8000000000000012, -2.4000000000000017, -2.800000000000002, -2.3000000000000016, -1.9000000000000012, -1.8000000000000012, -2.0000000000000013, -1.700000000000001, -1.8000000000000012, -1.700000000000001, -2.600000000000002, -2.1000000000000014, -2.2000000000000015, -2.1000000000000014, -2.2000000000000015, -2.4000000000000017, -2.3000000000000016, -1.8000000000000012, -2.0000000000000013, -1.9000000000000012, -1.600000000000001, -2.800000000000002, -1.9000000000000012], "episode_lengths": [32, 28, 29, 35, 30, 34, 40, 32, 29, 37, 34, 32, 32, 34, 31, 36, 28, 35, 37, 40, 30, 28, 33, 30, 35, 29, 31, 36, 30, 33, 33, 34, 32, 34, 28, 29, 31, 31, 26, 31, 37, 36, 30, 35, 38, 30, 31, 33, 29, 29, 32, 30, 32, 29, 28, 33, 39, 35, 26, 31, 33, 31, 37, 29, 29, 35, 45, 31, 29, 30, 35, 28, 28, 30, 27, 29, 27, 34, 41, 34, 30, 33, 36, 29, 44, 31, 32, 35, 46, 34, 32, 32, 28, 36, 32, 39, 38, 31, 31, 33, 30, 29, 35, 39, 34, 30, 29, 31, 28, 29, 28, 37, 32, 33, 32, 33, 35, 34, 29, 31, 30, 27, 39, 30]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.26351228111481195, "mean_inference_ms": 0.6259269131690294, "mean_action_processing_ms": 0.06868887916396627, "mean_env_wait_ms": 6.412654042357012, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0053980658131261025, "StateBufferConnector_ms": 0.0032622967996904927, "ViewRequirementAgentConnector_ms": 0.07561733645777549}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 140000, "num_agent_steps_trained": 140000, "num_env_steps_sampled": 140000, "num_env_steps_trained": 140000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 333.6140822980765, "num_env_steps_trained_throughput_per_sec": 333.6140822980765, "timesteps_total": 140000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 140000, "timers": {"training_iteration_time_ms": 11706.79, "sample_time_ms": 8198.338, "load_time_ms": 0.991, "load_throughput": 4038032.156, "learn_time_ms": 3505.168, "learn_throughput": 1141.172, "synch_weights_time_ms": 1.68}, "counters": {"num_env_steps_sampled": 140000, "num_env_steps_trained": 140000, "num_agent_steps_sampled": 140000, "num_agent_steps_trained": 140000}, "done": false, "episodes_total": 1863, "training_iteration": 35, "trial_id": "329fa_00000", "date": "2024-03-07_12-28-28", "timestamp": 1709832508, "time_this_iter_s": 11.992927312850952, "time_total_s": 384.65863132476807, "pid": 105400, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fcd19c36f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 384.65863132476807, "iterations_since_restore": 35, "perf": {"cpu_util_percent": 19.96875, "ram_util_percent": 43.6, "gpu_util_percent0": 0.078125, "vram_util_percent0": 0.09879557291666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.10000000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 0.401882849897944, "policy_loss": -0.0057308284766090815, "vf_loss": 0.40664162483386773, "vf_explained_var": 0.8046732658980995, "kl": 0.00972048954222463, "entropy": 0.38055997587019397, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 33015.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_agent_steps_sampled": 144000, "num_agent_steps_trained": 144000}, "sampler_results": {"episode_reward_max": -1.4000000000000008, "episode_reward_min": -13.599999999999982, "episode_reward_mean": -2.240983606557378, "episode_len_mean": 32.63934426229508, "episode_media": {}, "episodes_this_iter": 122, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1.8000000000000012, -1.600000000000001, -1.700000000000001, -1.700000000000001, -2.800000000000002, -1.5000000000000009, -1.600000000000001, -2.5000000000000018, -1.5000000000000009, -1.4000000000000008, -2.0000000000000013, -3.6999999999999993, -2.1000000000000014, -2.1000000000000014, -2.0000000000000013, -2.2000000000000015, -2.2000000000000015, -1.9000000000000012, -3.799999999999999, -1.4000000000000008, -2.1000000000000014, -1.700000000000001, -1.600000000000001, -2.700000000000002, -2.5000000000000018, -2.0000000000000013, -3.3000000000000016, -2.2000000000000015, -1.8000000000000012, -2.1000000000000014, -2.1000000000000014, -2.0000000000000013, -2.2000000000000015, -3.400000000000002, -1.8000000000000012, -2.800000000000002, -2.4000000000000017, -2.5000000000000018, -1.8000000000000012, -2.3000000000000016, -1.700000000000001, -2.0000000000000013, -2.1000000000000014, -2.1000000000000014, -1.700000000000001, -1.600000000000001, -1.9000000000000012, -1.600000000000001, -2.2000000000000015, -2.1000000000000014, -2.1000000000000014, -1.700000000000001, -1.9000000000000012, -2.3000000000000016, -2.3000000000000016, -1.9000000000000012, -8.099999999999996, -2.1000000000000014, -3.3000000000000007, -13.599999999999982, -1.9000000000000012, -1.8000000000000012, -1.9000000000000012, -2.800000000000002, -2.0000000000000013, -1.9000000000000012, -1.8000000000000012, -1.9000000000000012, -2.0000000000000013, -1.8000000000000012, -4.599999999999996, -1.600000000000001, -1.8000000000000012, -2.1000000000000014, -2.5000000000000018, -2.0000000000000013, -1.9000000000000012, -1.600000000000001, -1.5000000000000009, -1.9000000000000012, -1.700000000000001, -1.8000000000000012, -2.3000000000000016, -2.1000000000000014, -1.8000000000000012, -3.4000000000000004, -1.9000000000000012, -2.1000000000000014, -1.9000000000000012, -2.1000000000000014, -1.9000000000000012, -2.700000000000002, -2.600000000000002, -1.8000000000000012, -1.9000000000000012, -2.3000000000000016, -2.1000000000000014, -1.8000000000000012, -1.600000000000001, -1.9000000000000012, -2.0000000000000013, -1.9000000000000012, -2.0000000000000013, -2.600000000000002, -2.0000000000000013, -2.1000000000000014, -2.1000000000000014, -1.8000000000000012, -2.0000000000000013, -2.1000000000000014, -2.0000000000000013, -1.700000000000001, -1.5000000000000009, -1.8000000000000012, -2.1000000000000014, -1.8000000000000012, -2.0000000000000013, -3.6999999999999993, -1.600000000000001, -2.1000000000000014, -2.3000000000000016, -2.1000000000000014], "episode_lengths": [29, 27, 28, 28, 39, 26, 27, 36, 26, 25, 31, 43, 32, 32, 31, 33, 33, 30, 49, 25, 32, 28, 27, 38, 36, 31, 42, 33, 29, 32, 32, 31, 33, 37, 29, 39, 35, 36, 29, 34, 28, 31, 32, 32, 28, 27, 30, 27, 33, 32, 32, 28, 30, 33, 34, 30, 74, 32, 40, 91, 30, 29, 30, 39, 31, 30, 29, 30, 31, 29, 57, 27, 29, 32, 36, 31, 30, 27, 26, 30, 28, 29, 34, 32, 29, 45, 30, 32, 30, 32, 30, 38, 37, 29, 30, 34, 32, 29, 27, 30, 31, 30, 31, 37, 31, 32, 32, 29, 31, 32, 31, 28, 26, 29, 32, 29, 31, 48, 27, 32, 34, 32]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.26729013827960296, "mean_inference_ms": 0.627863554085148, "mean_action_processing_ms": 0.06877427255601451, "mean_env_wait_ms": 6.443302645668778, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005834219885654137, "StateBufferConnector_ms": 0.003826422769515241, "ViewRequirementAgentConnector_ms": 0.08397258696008901}}, "episode_reward_max": -1.4000000000000008, "episode_reward_min": -13.599999999999982, "episode_reward_mean": -2.240983606557378, "episode_len_mean": 32.63934426229508, "episodes_this_iter": 122, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1.8000000000000012, -1.600000000000001, -1.700000000000001, -1.700000000000001, -2.800000000000002, -1.5000000000000009, -1.600000000000001, -2.5000000000000018, -1.5000000000000009, -1.4000000000000008, -2.0000000000000013, -3.6999999999999993, -2.1000000000000014, -2.1000000000000014, -2.0000000000000013, -2.2000000000000015, -2.2000000000000015, -1.9000000000000012, -3.799999999999999, -1.4000000000000008, -2.1000000000000014, -1.700000000000001, -1.600000000000001, -2.700000000000002, -2.5000000000000018, -2.0000000000000013, -3.3000000000000016, -2.2000000000000015, -1.8000000000000012, -2.1000000000000014, -2.1000000000000014, -2.0000000000000013, -2.2000000000000015, -3.400000000000002, -1.8000000000000012, -2.800000000000002, -2.4000000000000017, -2.5000000000000018, -1.8000000000000012, -2.3000000000000016, -1.700000000000001, -2.0000000000000013, -2.1000000000000014, -2.1000000000000014, -1.700000000000001, -1.600000000000001, -1.9000000000000012, -1.600000000000001, -2.2000000000000015, -2.1000000000000014, -2.1000000000000014, -1.700000000000001, -1.9000000000000012, -2.3000000000000016, -2.3000000000000016, -1.9000000000000012, -8.099999999999996, -2.1000000000000014, -3.3000000000000007, -13.599999999999982, -1.9000000000000012, -1.8000000000000012, -1.9000000000000012, -2.800000000000002, -2.0000000000000013, -1.9000000000000012, -1.8000000000000012, -1.9000000000000012, -2.0000000000000013, -1.8000000000000012, -4.599999999999996, -1.600000000000001, -1.8000000000000012, -2.1000000000000014, -2.5000000000000018, -2.0000000000000013, -1.9000000000000012, -1.600000000000001, -1.5000000000000009, -1.9000000000000012, -1.700000000000001, -1.8000000000000012, -2.3000000000000016, -2.1000000000000014, -1.8000000000000012, -3.4000000000000004, -1.9000000000000012, -2.1000000000000014, -1.9000000000000012, -2.1000000000000014, -1.9000000000000012, -2.700000000000002, -2.600000000000002, -1.8000000000000012, -1.9000000000000012, -2.3000000000000016, -2.1000000000000014, -1.8000000000000012, -1.600000000000001, -1.9000000000000012, -2.0000000000000013, -1.9000000000000012, -2.0000000000000013, -2.600000000000002, -2.0000000000000013, -2.1000000000000014, -2.1000000000000014, -1.8000000000000012, -2.0000000000000013, -2.1000000000000014, -2.0000000000000013, -1.700000000000001, -1.5000000000000009, -1.8000000000000012, -2.1000000000000014, -1.8000000000000012, -2.0000000000000013, -3.6999999999999993, -1.600000000000001, -2.1000000000000014, -2.3000000000000016, -2.1000000000000014], "episode_lengths": [29, 27, 28, 28, 39, 26, 27, 36, 26, 25, 31, 43, 32, 32, 31, 33, 33, 30, 49, 25, 32, 28, 27, 38, 36, 31, 42, 33, 29, 32, 32, 31, 33, 37, 29, 39, 35, 36, 29, 34, 28, 31, 32, 32, 28, 27, 30, 27, 33, 32, 32, 28, 30, 33, 34, 30, 74, 32, 40, 91, 30, 29, 30, 39, 31, 30, 29, 30, 31, 29, 57, 27, 29, 32, 36, 31, 30, 27, 26, 30, 28, 29, 34, 32, 29, 45, 30, 32, 30, 32, 30, 38, 37, 29, 30, 34, 32, 29, 27, 30, 31, 30, 31, 37, 31, 32, 32, 29, 31, 32, 31, 28, 26, 29, 32, 29, 31, 48, 27, 32, 34, 32]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.26729013827960296, "mean_inference_ms": 0.627863554085148, "mean_action_processing_ms": 0.06877427255601451, "mean_env_wait_ms": 6.443302645668778, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005834219885654137, "StateBufferConnector_ms": 0.003826422769515241, "ViewRequirementAgentConnector_ms": 0.08397258696008901}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 144000, "num_agent_steps_trained": 144000, "num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 309.09155390613864, "num_env_steps_trained_throughput_per_sec": 309.09155390613864, "timesteps_total": 144000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 144000, "timers": {"training_iteration_time_ms": 11859.895, "sample_time_ms": 8301.539, "load_time_ms": 1.016, "load_throughput": 3936003.754, "learn_time_ms": 3555.059, "learn_throughput": 1125.157, "synch_weights_time_ms": 1.669}, "counters": {"num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_agent_steps_sampled": 144000, "num_agent_steps_trained": 144000}, "done": false, "episodes_total": 1985, "training_iteration": 36, "trial_id": "329fa_00000", "date": "2024-03-07_12-28-41", "timestamp": 1709832521, "time_this_iter_s": 12.943896055221558, "time_total_s": 397.6025273799896, "pid": 105400, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fcd19c36f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 397.6025273799896, "iterations_since_restore": 36, "perf": {"cpu_util_percent": 25.60625, "ram_util_percent": 43.818749999999994, "gpu_util_percent0": 0.09625, "vram_util_percent0": 0.106475830078125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.10000000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 0.16518210394364927, "policy_loss": -0.011003271028679866, "vf_loss": 0.17459930827320425, "vf_explained_var": 0.8873756813746627, "kl": 0.015860672295185434, "entropy": 0.37817541649264674, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 33945.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 148000, "num_env_steps_trained": 148000, "num_agent_steps_sampled": 148000, "num_agent_steps_trained": 148000}, "sampler_results": {"episode_reward_max": -1.4000000000000008, "episode_reward_min": -5.200000000000004, "episode_reward_mean": -2.126400000000002, "episode_len_mean": 31.984, "episode_media": {}, "episodes_this_iter": 125, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2.1000000000000014, -2.3000000000000016, -2.1000000000000014, -2.1000000000000014, -2.1000000000000014, -1.8000000000000012, -3.700000000000003, -1.8000000000000012, -2.4000000000000017, -2.4000000000000017, -2.2000000000000015, -2.2000000000000015, -2.2000000000000015, -2.0000000000000013, -1.600000000000001, -1.700000000000001, -2.1000000000000014, -1.9000000000000012, -2.0000000000000013, -2.600000000000002, -2.3000000000000016, -1.8000000000000012, -4.099999999999998, -2.5000000000000018, -2.600000000000002, -1.5000000000000009, -1.8000000000000012, -2.0000000000000013, -1.8000000000000012, -2.2000000000000015, -2.1000000000000014, -1.8000000000000012, -2.3000000000000016, -1.9000000000000012, -2.4000000000000017, -1.700000000000001, -1.700000000000001, -1.9000000000000012, -2.4000000000000017, -2.0000000000000013, -1.600000000000001, -2.900000000000002, -2.4000000000000017, -1.8000000000000012, -2.4000000000000017, -2.900000000000002, -1.4000000000000008, -2.0000000000000013, -2.2000000000000015, -1.5000000000000009, -3.4000000000000004, -1.8000000000000012, -2.4000000000000017, -1.700000000000001, -2.3000000000000016, -1.700000000000001, -1.8000000000000012, -2.700000000000002, -1.600000000000001, -2.0000000000000013, -2.2000000000000015, -1.9000000000000012, -1.600000000000001, -2.900000000000002, -1.4000000000000008, -2.600000000000002, -1.9000000000000012, -2.5000000000000018, -1.8000000000000012, -1.9000000000000012, -2.5000000000000018, -2.4000000000000017, -5.200000000000004, -2.3000000000000016, -2.0000000000000013, -4.399999999999999, -2.5000000000000018, -1.9000000000000012, -2.4000000000000017, -2.800000000000002, -2.0000000000000013, -1.600000000000001, -2.3000000000000016, -1.4000000000000008, -1.8000000000000012, -1.8000000000000012, -2.1000000000000014, -2.2000000000000015, -1.600000000000001, -2.0000000000000013, -2.2000000000000015, -1.700000000000001, -2.0000000000000013, -2.1000000000000014, -2.3000000000000016, -1.600000000000001, -2.0000000000000013, -2.3000000000000016, -1.8000000000000012, -2.3000000000000016, -2.3000000000000016, -1.9000000000000012, -1.4000000000000008, -1.4000000000000008, -2.3000000000000016, -1.9000000000000012, -2.0000000000000013, -3.3000000000000007, -1.600000000000001, -1.8000000000000012, -1.600000000000001, -2.0000000000000013, -2.0000000000000013, -1.4000000000000008, -2.0000000000000013, -1.8000000000000012, -2.600000000000002, -2.0000000000000013, -2.4000000000000017, -1.8000000000000012, -1.8000000000000012, -1.8000000000000012, -2.3000000000000016, -2.0000000000000013, -1.600000000000001], "episode_lengths": [32, 34, 32, 32, 32, 29, 40, 29, 35, 35, 33, 33, 33, 31, 27, 28, 32, 30, 31, 36, 34, 29, 50, 36, 37, 26, 29, 31, 29, 33, 32, 29, 34, 30, 35, 28, 28, 30, 35, 31, 27, 40, 35, 29, 35, 40, 25, 31, 33, 26, 42, 29, 35, 28, 33, 28, 29, 38, 27, 31, 33, 30, 27, 39, 25, 37, 30, 36, 29, 30, 36, 35, 49, 34, 31, 51, 36, 30, 35, 39, 31, 27, 34, 25, 29, 29, 32, 33, 27, 31, 33, 28, 31, 32, 33, 27, 31, 34, 29, 34, 34, 30, 25, 25, 34, 30, 31, 44, 27, 29, 27, 31, 31, 25, 31, 29, 37, 31, 35, 29, 29, 29, 34, 31, 27]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2716783356696851, "mean_inference_ms": 0.6313697813601143, "mean_action_processing_ms": 0.06905836633874167, "mean_env_wait_ms": 6.478823860240419, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00666961669921875, "StateBufferConnector_ms": 0.004033088684082031, "ViewRequirementAgentConnector_ms": 0.09085445404052735}}, "episode_reward_max": -1.4000000000000008, "episode_reward_min": -5.200000000000004, "episode_reward_mean": -2.126400000000002, "episode_len_mean": 31.984, "episodes_this_iter": 125, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-2.1000000000000014, -2.3000000000000016, -2.1000000000000014, -2.1000000000000014, -2.1000000000000014, -1.8000000000000012, -3.700000000000003, -1.8000000000000012, -2.4000000000000017, -2.4000000000000017, -2.2000000000000015, -2.2000000000000015, -2.2000000000000015, -2.0000000000000013, -1.600000000000001, -1.700000000000001, -2.1000000000000014, -1.9000000000000012, -2.0000000000000013, -2.600000000000002, -2.3000000000000016, -1.8000000000000012, -4.099999999999998, -2.5000000000000018, -2.600000000000002, -1.5000000000000009, -1.8000000000000012, -2.0000000000000013, -1.8000000000000012, -2.2000000000000015, -2.1000000000000014, -1.8000000000000012, -2.3000000000000016, -1.9000000000000012, -2.4000000000000017, -1.700000000000001, -1.700000000000001, -1.9000000000000012, -2.4000000000000017, -2.0000000000000013, -1.600000000000001, -2.900000000000002, -2.4000000000000017, -1.8000000000000012, -2.4000000000000017, -2.900000000000002, -1.4000000000000008, -2.0000000000000013, -2.2000000000000015, -1.5000000000000009, -3.4000000000000004, -1.8000000000000012, -2.4000000000000017, -1.700000000000001, -2.3000000000000016, -1.700000000000001, -1.8000000000000012, -2.700000000000002, -1.600000000000001, -2.0000000000000013, -2.2000000000000015, -1.9000000000000012, -1.600000000000001, -2.900000000000002, -1.4000000000000008, -2.600000000000002, -1.9000000000000012, -2.5000000000000018, -1.8000000000000012, -1.9000000000000012, -2.5000000000000018, -2.4000000000000017, -5.200000000000004, -2.3000000000000016, -2.0000000000000013, -4.399999999999999, -2.5000000000000018, -1.9000000000000012, -2.4000000000000017, -2.800000000000002, -2.0000000000000013, -1.600000000000001, -2.3000000000000016, -1.4000000000000008, -1.8000000000000012, -1.8000000000000012, -2.1000000000000014, -2.2000000000000015, -1.600000000000001, -2.0000000000000013, -2.2000000000000015, -1.700000000000001, -2.0000000000000013, -2.1000000000000014, -2.3000000000000016, -1.600000000000001, -2.0000000000000013, -2.3000000000000016, -1.8000000000000012, -2.3000000000000016, -2.3000000000000016, -1.9000000000000012, -1.4000000000000008, -1.4000000000000008, -2.3000000000000016, -1.9000000000000012, -2.0000000000000013, -3.3000000000000007, -1.600000000000001, -1.8000000000000012, -1.600000000000001, -2.0000000000000013, -2.0000000000000013, -1.4000000000000008, -2.0000000000000013, -1.8000000000000012, -2.600000000000002, -2.0000000000000013, -2.4000000000000017, -1.8000000000000012, -1.8000000000000012, -1.8000000000000012, -2.3000000000000016, -2.0000000000000013, -1.600000000000001], "episode_lengths": [32, 34, 32, 32, 32, 29, 40, 29, 35, 35, 33, 33, 33, 31, 27, 28, 32, 30, 31, 36, 34, 29, 50, 36, 37, 26, 29, 31, 29, 33, 32, 29, 34, 30, 35, 28, 28, 30, 35, 31, 27, 40, 35, 29, 35, 40, 25, 31, 33, 26, 42, 29, 35, 28, 33, 28, 29, 38, 27, 31, 33, 30, 27, 39, 25, 37, 30, 36, 29, 30, 36, 35, 49, 34, 31, 51, 36, 30, 35, 39, 31, 27, 34, 25, 29, 29, 32, 33, 27, 31, 33, 28, 31, 32, 33, 27, 31, 34, 29, 34, 34, 30, 25, 25, 34, 30, 31, 44, 27, 29, 27, 31, 31, 25, 31, 29, 37, 31, 35, 29, 29, 29, 34, 31, 27]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2716783356696851, "mean_inference_ms": 0.6313697813601143, "mean_action_processing_ms": 0.06905836633874167, "mean_env_wait_ms": 6.478823860240419, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00666961669921875, "StateBufferConnector_ms": 0.004033088684082031, "ViewRequirementAgentConnector_ms": 0.09085445404052735}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 148000, "num_agent_steps_trained": 148000, "num_env_steps_sampled": 148000, "num_env_steps_trained": 148000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 292.40513538861444, "num_env_steps_trained_throughput_per_sec": 292.40513538861444, "timesteps_total": 148000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 148000, "timers": {"training_iteration_time_ms": 12080.784, "sample_time_ms": 8429.798, "load_time_ms": 1.021, "load_throughput": 3918170.905, "learn_time_ms": 3647.658, "learn_throughput": 1096.594, "synch_weights_time_ms": 1.684}, "counters": {"num_env_steps_sampled": 148000, "num_env_steps_trained": 148000, "num_agent_steps_sampled": 148000, "num_agent_steps_trained": 148000}, "done": false, "episodes_total": 2110, "training_iteration": 37, "trial_id": "329fa_00000", "date": "2024-03-07_12-28-54", "timestamp": 1709832534, "time_this_iter_s": 13.682808876037598, "time_total_s": 411.2853362560272, "pid": 105400, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fcd19c36f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 411.2853362560272, "iterations_since_restore": 37, "perf": {"cpu_util_percent": 26.316666666666666, "ram_util_percent": 44.54444444444445, "gpu_util_percent0": 0.1388888888888889, "vram_util_percent0": 0.11010742187499999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.10000000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 1.0938436115673813, "policy_loss": 0.001563747355373957, "vf_loss": 1.091509737632668, "vf_explained_var": 0.7727013561033433, "kl": 0.007701245986592331, "entropy": 0.37704567747410905, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 34875.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 152000, "num_env_steps_trained": 152000, "num_agent_steps_sampled": 152000, "num_agent_steps_trained": 152000}, "sampler_results": {"episode_reward_max": -1.4000000000000008, "episode_reward_min": -76.60000000000055, "episode_reward_mean": -2.7086206896551785, "episode_len_mean": 34.6551724137931, "episode_media": {}, "episodes_this_iter": 116, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1.9000000000000012, -1.9000000000000012, -2.600000000000002, -2.800000000000002, -1.9000000000000012, -1.700000000000001, -1.700000000000001, -2.3000000000000016, -2.4000000000000017, -1.4000000000000008, -3.0000000000000018, -2.1000000000000014, -1.700000000000001, -1.8000000000000012, -1.5000000000000009, -2.2000000000000015, -1.8000000000000012, -2.0000000000000013, -2.2000000000000015, -1.5000000000000009, -1.8000000000000012, -2.5000000000000018, -2.0000000000000013, -1.600000000000001, -2.3000000000000016, -1.8000000000000012, -2.0000000000000013, -1.8000000000000012, -2.0000000000000013, -2.1000000000000014, -3.200000000000001, -1.9000000000000012, -1.8000000000000012, -3.0000000000000018, -1.8000000000000012, -1.600000000000001, -1.4000000000000008, -2.0000000000000013, -2.700000000000002, -1.600000000000001, -1.600000000000001, -1.600000000000001, -1.8000000000000012, -2.3000000000000016, -1.9000000000000012, -2.1000000000000014, -1.8000000000000012, -2.3000000000000016, -76.60000000000055, -2.0000000000000013, -2.700000000000002, -1.8000000000000012, -3.4000000000000012, -1.600000000000001, -2.3000000000000016, -1.700000000000001, -1.8000000000000012, -2.0000000000000013, -1.9000000000000012, -2.1000000000000014, -1.700000000000001, -2.0000000000000013, -2.1000000000000014, -2.4000000000000017, -2.3000000000000016, -1.9000000000000012, -1.8000000000000012, -1.9000000000000012, -2.1000000000000014, -1.9000000000000012, -1.600000000000001, -1.700000000000001, -1.9000000000000012, -2.0000000000000013, -1.8000000000000012, -2.600000000000002, -2.1000000000000014, -2.3000000000000016, -2.600000000000002, -2.1000000000000014, -1.8000000000000012, -1.600000000000001, -1.700000000000001, -2.2000000000000015, -1.9000000000000012, -1.700000000000001, -1.9000000000000012, -1.9000000000000012, -2.4000000000000017, -2.4000000000000017, -4.099999999999998, -2.0000000000000013, -1.600000000000001, -1.8000000000000012, -1.8000000000000012, -1.600000000000001, -1.600000000000001, -1.9000000000000012, -2.1000000000000014, -1.600000000000001, -1.600000000000001, -2.600000000000002, -2.1000000000000014, -3.0000000000000018, -2.1000000000000014, -2.0000000000000013, -1.700000000000001, -1.700000000000001, -1.8000000000000012, -5.399999999999993, -2.5000000000000018, -2.700000000000002, -1.8000000000000012, -1.700000000000001, -2.1000000000000014, -2.4000000000000017], "episode_lengths": [30, 30, 37, 39, 30, 28, 28, 34, 35, 25, 38, 32, 28, 29, 26, 33, 29, 31, 33, 26, 29, 36, 31, 27, 34, 29, 31, 29, 31, 32, 39, 30, 29, 41, 29, 27, 25, 31, 33, 27, 27, 27, 29, 34, 30, 32, 29, 34, 400, 31, 38, 29, 43, 27, 34, 28, 29, 31, 30, 32, 28, 31, 32, 35, 34, 30, 29, 30, 32, 30, 27, 28, 30, 31, 29, 37, 32, 34, 37, 32, 29, 27, 28, 33, 30, 28, 30, 30, 35, 35, 49, 31, 27, 29, 29, 27, 27, 30, 32, 27, 27, 37, 32, 41, 32, 31, 28, 28, 29, 61, 36, 38, 29, 28, 32, 35]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.27556247492863467, "mean_inference_ms": 0.6345071679748279, "mean_action_processing_ms": 0.06914168000534412, "mean_env_wait_ms": 6.5091018063077595, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006768415714132375, "StateBufferConnector_ms": 0.0042339851116311965, "ViewRequirementAgentConnector_ms": 0.09296762532201307}}, "episode_reward_max": -1.4000000000000008, "episode_reward_min": -76.60000000000055, "episode_reward_mean": -2.7086206896551785, "episode_len_mean": 34.6551724137931, "episodes_this_iter": 116, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1.9000000000000012, -1.9000000000000012, -2.600000000000002, -2.800000000000002, -1.9000000000000012, -1.700000000000001, -1.700000000000001, -2.3000000000000016, -2.4000000000000017, -1.4000000000000008, -3.0000000000000018, -2.1000000000000014, -1.700000000000001, -1.8000000000000012, -1.5000000000000009, -2.2000000000000015, -1.8000000000000012, -2.0000000000000013, -2.2000000000000015, -1.5000000000000009, -1.8000000000000012, -2.5000000000000018, -2.0000000000000013, -1.600000000000001, -2.3000000000000016, -1.8000000000000012, -2.0000000000000013, -1.8000000000000012, -2.0000000000000013, -2.1000000000000014, -3.200000000000001, -1.9000000000000012, -1.8000000000000012, -3.0000000000000018, -1.8000000000000012, -1.600000000000001, -1.4000000000000008, -2.0000000000000013, -2.700000000000002, -1.600000000000001, -1.600000000000001, -1.600000000000001, -1.8000000000000012, -2.3000000000000016, -1.9000000000000012, -2.1000000000000014, -1.8000000000000012, -2.3000000000000016, -76.60000000000055, -2.0000000000000013, -2.700000000000002, -1.8000000000000012, -3.4000000000000012, -1.600000000000001, -2.3000000000000016, -1.700000000000001, -1.8000000000000012, -2.0000000000000013, -1.9000000000000012, -2.1000000000000014, -1.700000000000001, -2.0000000000000013, -2.1000000000000014, -2.4000000000000017, -2.3000000000000016, -1.9000000000000012, -1.8000000000000012, -1.9000000000000012, -2.1000000000000014, -1.9000000000000012, -1.600000000000001, -1.700000000000001, -1.9000000000000012, -2.0000000000000013, -1.8000000000000012, -2.600000000000002, -2.1000000000000014, -2.3000000000000016, -2.600000000000002, -2.1000000000000014, -1.8000000000000012, -1.600000000000001, -1.700000000000001, -2.2000000000000015, -1.9000000000000012, -1.700000000000001, -1.9000000000000012, -1.9000000000000012, -2.4000000000000017, -2.4000000000000017, -4.099999999999998, -2.0000000000000013, -1.600000000000001, -1.8000000000000012, -1.8000000000000012, -1.600000000000001, -1.600000000000001, -1.9000000000000012, -2.1000000000000014, -1.600000000000001, -1.600000000000001, -2.600000000000002, -2.1000000000000014, -3.0000000000000018, -2.1000000000000014, -2.0000000000000013, -1.700000000000001, -1.700000000000001, -1.8000000000000012, -5.399999999999993, -2.5000000000000018, -2.700000000000002, -1.8000000000000012, -1.700000000000001, -2.1000000000000014, -2.4000000000000017], "episode_lengths": [30, 30, 37, 39, 30, 28, 28, 34, 35, 25, 38, 32, 28, 29, 26, 33, 29, 31, 33, 26, 29, 36, 31, 27, 34, 29, 31, 29, 31, 32, 39, 30, 29, 41, 29, 27, 25, 31, 33, 27, 27, 27, 29, 34, 30, 32, 29, 34, 400, 31, 38, 29, 43, 27, 34, 28, 29, 31, 30, 32, 28, 31, 32, 35, 34, 30, 29, 30, 32, 30, 27, 28, 30, 31, 29, 37, 32, 34, 37, 32, 29, 27, 28, 33, 30, 28, 30, 30, 35, 35, 49, 31, 27, 29, 29, 27, 27, 30, 32, 27, 27, 37, 32, 41, 32, 31, 28, 28, 29, 61, 36, 38, 29, 28, 32, 35]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.27556247492863467, "mean_inference_ms": 0.6345071679748279, "mean_action_processing_ms": 0.06914168000534412, "mean_env_wait_ms": 6.5091018063077595, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006768415714132375, "StateBufferConnector_ms": 0.0042339851116311965, "ViewRequirementAgentConnector_ms": 0.09296762532201307}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 152000, "num_agent_steps_trained": 152000, "num_env_steps_sampled": 152000, "num_env_steps_trained": 152000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 312.47186611394545, "num_env_steps_trained_throughput_per_sec": 312.47186611394545, "timesteps_total": 152000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 152000, "timers": {"training_iteration_time_ms": 12205.588, "sample_time_ms": 8533.259, "load_time_ms": 1.022, "load_throughput": 3913874.866, "learn_time_ms": 3669.006, "learn_throughput": 1090.214, "synch_weights_time_ms": 1.678}, "counters": {"num_env_steps_sampled": 152000, "num_env_steps_trained": 152000, "num_agent_steps_sampled": 152000, "num_agent_steps_trained": 152000}, "done": false, "episodes_total": 2226, "training_iteration": 38, "trial_id": "329fa_00000", "date": "2024-03-07_12-29-07", "timestamp": 1709832547, "time_this_iter_s": 12.8036527633667, "time_total_s": 424.0889890193939, "pid": 105400, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fcd19c36f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 424.0889890193939, "iterations_since_restore": 38, "perf": {"cpu_util_percent": 25.129411764705882, "ram_util_percent": 44.676470588235304, "gpu_util_percent0": 0.10470588235294118, "vram_util_percent0": 0.11086856617647059}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.10000000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 0.09388159174792549, "policy_loss": -0.003798997680586512, "vf_loss": 0.09680732538402882, "vf_explained_var": 0.9295237608494297, "kl": 0.00873265486939353, "entropy": 0.3324562769583477, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 35805.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 156000, "num_env_steps_trained": 156000, "num_agent_steps_sampled": 156000, "num_agent_steps_trained": 156000}, "sampler_results": {"episode_reward_max": -1.4000000000000008, "episode_reward_min": -4.600000000000001, "episode_reward_mean": -1.9852713178294583, "episode_len_mean": 30.713178294573645, "episode_media": {}, "episodes_this_iter": 129, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1.700000000000001, -1.600000000000001, -2.3000000000000016, -1.5000000000000009, -2.2000000000000015, -1.5000000000000009, -2.0000000000000013, -2.2000000000000015, -2.3000000000000016, -1.9000000000000012, -1.4000000000000008, -1.8000000000000012, -2.2000000000000015, -2.2000000000000015, -1.8000000000000012, -2.1000000000000014, -2.2000000000000015, -1.8000000000000012, -2.3000000000000016, -1.700000000000001, -1.600000000000001, -2.0000000000000013, -2.1000000000000014, -2.4000000000000017, -1.9000000000000012, -1.5000000000000009, -2.1000000000000014, -1.9000000000000012, -1.9000000000000012, -2.0000000000000013, -2.0000000000000013, -1.700000000000001, -2.0000000000000013, -1.9000000000000012, -1.9000000000000012, -1.700000000000001, -2.1000000000000014, -2.0000000000000013, -1.700000000000001, -2.0000000000000013, -2.4000000000000017, -2.2000000000000015, -1.700000000000001, -1.9000000000000012, -2.5000000000000018, -1.8000000000000012, -1.8000000000000012, -1.8000000000000012, -1.8000000000000012, -1.700000000000001, -1.600000000000001, -2.2000000000000015, -1.8000000000000012, -2.0000000000000013, -1.8000000000000012, -1.700000000000001, -2.0000000000000013, -2.0000000000000013, -1.8000000000000012, -1.5000000000000009, -2.0000000000000013, -1.600000000000001, -2.2000000000000015, -1.9000000000000012, -1.600000000000001, -1.700000000000001, -1.700000000000001, -4.1, -1.4000000000000008, -2.0000000000000013, -3.0000000000000018, -2.1000000000000014, -1.9000000000000012, -2.2000000000000015, -1.9000000000000012, -2.3000000000000016, -2.0000000000000013, -1.700000000000001, -4.600000000000001, -1.9000000000000012, -2.1000000000000014, -1.700000000000001, -1.8000000000000012, -2.5000000000000018, -1.700000000000001, -2.2000000000000015, -1.700000000000001, -1.700000000000001, -1.8000000000000012, -2.1000000000000014, -2.2000000000000015, -2.3000000000000016, -1.8000000000000012, -1.8000000000000012, -2.700000000000002, -2.2000000000000015, -1.8000000000000012, -1.700000000000001, -1.9000000000000012, -2.3000000000000016, -1.700000000000001, -1.5000000000000009, -1.5000000000000009, -1.4000000000000008, -2.0000000000000013, -1.600000000000001, -2.2000000000000015, -2.1000000000000014, -1.9000000000000012, -2.2000000000000015, -1.9000000000000012, -1.8000000000000012, -2.600000000000002, -2.3000000000000016, -2.1000000000000014, -2.3000000000000016, -1.9000000000000012, -1.9000000000000012, -2.0000000000000013, -1.9000000000000012, -2.2000000000000015, -1.9000000000000012, -1.9000000000000012, -2.1000000000000014, -1.600000000000001, -2.4000000000000017, -1.9000000000000012, -2.3000000000000016, -2.1000000000000014], "episode_lengths": [28, 27, 34, 26, 33, 26, 31, 33, 34, 30, 25, 29, 33, 33, 29, 32, 33, 29, 34, 28, 27, 31, 32, 35, 30, 26, 32, 30, 30, 31, 31, 28, 31, 30, 30, 28, 32, 31, 28, 31, 35, 33, 28, 30, 36, 29, 29, 29, 29, 28, 27, 33, 29, 31, 29, 28, 31, 31, 29, 26, 31, 27, 33, 30, 27, 28, 28, 45, 25, 31, 38, 32, 30, 33, 30, 34, 31, 28, 49, 30, 32, 28, 29, 36, 28, 33, 28, 28, 29, 32, 33, 34, 29, 29, 38, 33, 29, 28, 30, 34, 28, 26, 26, 25, 31, 27, 33, 32, 30, 33, 30, 29, 37, 34, 32, 34, 30, 30, 31, 30, 33, 30, 30, 32, 27, 35, 30, 34, 32]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2790367525544281, "mean_inference_ms": 0.6367916124526541, "mean_action_processing_ms": 0.06941447494196917, "mean_env_wait_ms": 6.535813892200187, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006322343220082364, "StateBufferConnector_ms": 0.0038117401359617246, "ViewRequirementAgentConnector_ms": 0.08600146271461664}}, "episode_reward_max": -1.4000000000000008, "episode_reward_min": -4.600000000000001, "episode_reward_mean": -1.9852713178294583, "episode_len_mean": 30.713178294573645, "episodes_this_iter": 129, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1.700000000000001, -1.600000000000001, -2.3000000000000016, -1.5000000000000009, -2.2000000000000015, -1.5000000000000009, -2.0000000000000013, -2.2000000000000015, -2.3000000000000016, -1.9000000000000012, -1.4000000000000008, -1.8000000000000012, -2.2000000000000015, -2.2000000000000015, -1.8000000000000012, -2.1000000000000014, -2.2000000000000015, -1.8000000000000012, -2.3000000000000016, -1.700000000000001, -1.600000000000001, -2.0000000000000013, -2.1000000000000014, -2.4000000000000017, -1.9000000000000012, -1.5000000000000009, -2.1000000000000014, -1.9000000000000012, -1.9000000000000012, -2.0000000000000013, -2.0000000000000013, -1.700000000000001, -2.0000000000000013, -1.9000000000000012, -1.9000000000000012, -1.700000000000001, -2.1000000000000014, -2.0000000000000013, -1.700000000000001, -2.0000000000000013, -2.4000000000000017, -2.2000000000000015, -1.700000000000001, -1.9000000000000012, -2.5000000000000018, -1.8000000000000012, -1.8000000000000012, -1.8000000000000012, -1.8000000000000012, -1.700000000000001, -1.600000000000001, -2.2000000000000015, -1.8000000000000012, -2.0000000000000013, -1.8000000000000012, -1.700000000000001, -2.0000000000000013, -2.0000000000000013, -1.8000000000000012, -1.5000000000000009, -2.0000000000000013, -1.600000000000001, -2.2000000000000015, -1.9000000000000012, -1.600000000000001, -1.700000000000001, -1.700000000000001, -4.1, -1.4000000000000008, -2.0000000000000013, -3.0000000000000018, -2.1000000000000014, -1.9000000000000012, -2.2000000000000015, -1.9000000000000012, -2.3000000000000016, -2.0000000000000013, -1.700000000000001, -4.600000000000001, -1.9000000000000012, -2.1000000000000014, -1.700000000000001, -1.8000000000000012, -2.5000000000000018, -1.700000000000001, -2.2000000000000015, -1.700000000000001, -1.700000000000001, -1.8000000000000012, -2.1000000000000014, -2.2000000000000015, -2.3000000000000016, -1.8000000000000012, -1.8000000000000012, -2.700000000000002, -2.2000000000000015, -1.8000000000000012, -1.700000000000001, -1.9000000000000012, -2.3000000000000016, -1.700000000000001, -1.5000000000000009, -1.5000000000000009, -1.4000000000000008, -2.0000000000000013, -1.600000000000001, -2.2000000000000015, -2.1000000000000014, -1.9000000000000012, -2.2000000000000015, -1.9000000000000012, -1.8000000000000012, -2.600000000000002, -2.3000000000000016, -2.1000000000000014, -2.3000000000000016, -1.9000000000000012, -1.9000000000000012, -2.0000000000000013, -1.9000000000000012, -2.2000000000000015, -1.9000000000000012, -1.9000000000000012, -2.1000000000000014, -1.600000000000001, -2.4000000000000017, -1.9000000000000012, -2.3000000000000016, -2.1000000000000014], "episode_lengths": [28, 27, 34, 26, 33, 26, 31, 33, 34, 30, 25, 29, 33, 33, 29, 32, 33, 29, 34, 28, 27, 31, 32, 35, 30, 26, 32, 30, 30, 31, 31, 28, 31, 30, 30, 28, 32, 31, 28, 31, 35, 33, 28, 30, 36, 29, 29, 29, 29, 28, 27, 33, 29, 31, 29, 28, 31, 31, 29, 26, 31, 27, 33, 30, 27, 28, 28, 45, 25, 31, 38, 32, 30, 33, 30, 34, 31, 28, 49, 30, 32, 28, 29, 36, 28, 33, 28, 28, 29, 32, 33, 34, 29, 29, 38, 33, 29, 28, 30, 34, 28, 26, 26, 25, 31, 27, 33, 32, 30, 33, 30, 29, 37, 34, 32, 34, 30, 30, 31, 30, 33, 30, 30, 32, 27, 35, 30, 34, 32]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2790367525544281, "mean_inference_ms": 0.6367916124526541, "mean_action_processing_ms": 0.06941447494196917, "mean_env_wait_ms": 6.535813892200187, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006322343220082364, "StateBufferConnector_ms": 0.0038117401359617246, "ViewRequirementAgentConnector_ms": 0.08600146271461664}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 156000, "num_agent_steps_trained": 156000, "num_env_steps_sampled": 156000, "num_env_steps_trained": 156000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 318.58243068523984, "num_env_steps_trained_throughput_per_sec": 318.58243068523984, "timesteps_total": 156000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 156000, "timers": {"training_iteration_time_ms": 12299.012, "sample_time_ms": 8607.338, "load_time_ms": 1.049, "load_throughput": 3814390.688, "learn_time_ms": 3688.321, "learn_throughput": 1084.504, "synch_weights_time_ms": 1.676}, "counters": {"num_env_steps_sampled": 156000, "num_env_steps_trained": 156000, "num_agent_steps_sampled": 156000, "num_agent_steps_trained": 156000}, "done": false, "episodes_total": 2355, "training_iteration": 39, "trial_id": "329fa_00000", "date": "2024-03-07_12-29-20", "timestamp": 1709832560, "time_this_iter_s": 12.5585458278656, "time_total_s": 436.6475348472595, "pid": 105400, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fcd19c36f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 436.6475348472595, "iterations_since_restore": 39, "perf": {"cpu_util_percent": 22.700000000000003, "ram_util_percent": 44.725, "gpu_util_percent0": 0.09125, "vram_util_percent0": 0.11100260416666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.10000000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 0.1211367187175339, "policy_loss": -0.013096493644820106, "vf_loss": 0.13319799876171015, "vf_explained_var": 0.9179011707664818, "kl": 0.010352117608749477, "entropy": 0.34937964809197253, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 36735.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 160000, "num_env_steps_trained": 160000, "num_agent_steps_sampled": 160000, "num_agent_steps_trained": 160000}, "sampler_results": {"episode_reward_max": -1.4000000000000008, "episode_reward_min": -5.600000000000004, "episode_reward_mean": -2.0968000000000013, "episode_len_mean": 31.8, "episode_media": {}, "episodes_this_iter": 125, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2.2000000000000015, -2.600000000000002, -2.3000000000000016, -2.1000000000000014, -2.0000000000000013, -2.4000000000000017, -2.0000000000000013, -2.2000000000000015, -1.700000000000001, -2.1000000000000014, -1.8000000000000012, -2.600000000000002, -2.4000000000000017, -1.700000000000001, -2.0000000000000013, -2.4000000000000017, -1.600000000000001, -2.5000000000000018, -1.8000000000000012, -2.2000000000000015, -1.9000000000000012, -2.3000000000000016, -1.700000000000001, -2.3000000000000016, -1.8000000000000012, -2.700000000000002, -1.700000000000001, -1.8000000000000012, -1.9000000000000012, -1.8000000000000012, -1.9000000000000012, -1.8000000000000012, -3.5999999999999996, -2.600000000000002, -2.4000000000000017, -5.600000000000004, -2.4000000000000017, -1.9000000000000012, -2.5000000000000018, -2.0000000000000013, -1.700000000000001, -1.600000000000001, -1.8000000000000012, -1.8000000000000012, -2.900000000000002, -2.1000000000000014, -1.8000000000000012, -1.600000000000001, -2.2000000000000015, -1.600000000000001, -1.8000000000000012, -1.4000000000000008, -2.0000000000000013, -1.9000000000000012, -1.700000000000001, -2.600000000000002, -2.3000000000000016, -2.0000000000000013, -1.8000000000000012, -3.3000000000000025, -2.1000000000000014, -2.5000000000000018, -2.0000000000000013, -1.9000000000000012, -2.3000000000000016, -1.600000000000001, -2.0000000000000013, -2.4000000000000017, -2.2000000000000015, -1.8000000000000012, -1.5000000000000009, -1.700000000000001, -4.0, -1.5000000000000009, -2.1000000000000014, -1.8000000000000012, -1.8000000000000012, -2.1000000000000014, -1.8000000000000012, -1.600000000000001, -1.9000000000000012, -2.3000000000000016, -1.600000000000001, -2.4000000000000017, -1.4000000000000008, -2.0000000000000013, -2.3000000000000016, -1.8000000000000012, -2.5000000000000018, -1.8000000000000012, -2.2000000000000015, -2.0000000000000013, -2.4000000000000017, -2.1000000000000014, -1.600000000000001, -1.9000000000000012, -2.600000000000002, -2.3000000000000016, -1.9000000000000012, -1.9000000000000012, -2.1000000000000014, -1.8000000000000012, -1.700000000000001, -2.1000000000000014, -1.700000000000001, -1.8000000000000012, -1.600000000000001, -3.1000000000000014, -2.1000000000000014, -1.9000000000000012, -1.9000000000000012, -1.700000000000001, -2.2000000000000015, -2.2000000000000015, -2.1000000000000014, -2.0000000000000013, -2.2000000000000015, -2.2000000000000015, -2.4000000000000017, -2.2000000000000015, -2.1000000000000014, -2.4000000000000017, -2.2000000000000015, -2.1000000000000014, -1.600000000000001], "episode_lengths": [33, 37, 34, 32, 31, 35, 31, 33, 28, 32, 29, 37, 35, 28, 31, 35, 27, 36, 29, 33, 30, 34, 28, 34, 29, 38, 28, 29, 30, 29, 30, 29, 47, 37, 35, 53, 35, 30, 36, 31, 28, 27, 29, 29, 40, 32, 29, 27, 33, 27, 29, 25, 31, 30, 28, 37, 34, 31, 29, 41, 32, 36, 31, 30, 34, 27, 31, 35, 33, 29, 26, 28, 47, 26, 32, 29, 29, 32, 29, 27, 30, 34, 27, 35, 25, 31, 34, 29, 36, 29, 33, 31, 35, 32, 27, 30, 37, 34, 30, 30, 32, 29, 28, 32, 28, 29, 27, 42, 32, 30, 30, 28, 33, 33, 32, 31, 33, 33, 35, 33, 32, 35, 33, 32, 27]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2822475886333583, "mean_inference_ms": 0.6386112377544105, "mean_action_processing_ms": 0.06949057874314557, "mean_env_wait_ms": 6.557447527406251, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006394767761230468, "StateBufferConnector_ms": 0.003879737854003906, "ViewRequirementAgentConnector_ms": 0.08630867004394531}}, "episode_reward_max": -1.4000000000000008, "episode_reward_min": -5.600000000000004, "episode_reward_mean": -2.0968000000000013, "episode_len_mean": 31.8, "episodes_this_iter": 125, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-2.2000000000000015, -2.600000000000002, -2.3000000000000016, -2.1000000000000014, -2.0000000000000013, -2.4000000000000017, -2.0000000000000013, -2.2000000000000015, -1.700000000000001, -2.1000000000000014, -1.8000000000000012, -2.600000000000002, -2.4000000000000017, -1.700000000000001, -2.0000000000000013, -2.4000000000000017, -1.600000000000001, -2.5000000000000018, -1.8000000000000012, -2.2000000000000015, -1.9000000000000012, -2.3000000000000016, -1.700000000000001, -2.3000000000000016, -1.8000000000000012, -2.700000000000002, -1.700000000000001, -1.8000000000000012, -1.9000000000000012, -1.8000000000000012, -1.9000000000000012, -1.8000000000000012, -3.5999999999999996, -2.600000000000002, -2.4000000000000017, -5.600000000000004, -2.4000000000000017, -1.9000000000000012, -2.5000000000000018, -2.0000000000000013, -1.700000000000001, -1.600000000000001, -1.8000000000000012, -1.8000000000000012, -2.900000000000002, -2.1000000000000014, -1.8000000000000012, -1.600000000000001, -2.2000000000000015, -1.600000000000001, -1.8000000000000012, -1.4000000000000008, -2.0000000000000013, -1.9000000000000012, -1.700000000000001, -2.600000000000002, -2.3000000000000016, -2.0000000000000013, -1.8000000000000012, -3.3000000000000025, -2.1000000000000014, -2.5000000000000018, -2.0000000000000013, -1.9000000000000012, -2.3000000000000016, -1.600000000000001, -2.0000000000000013, -2.4000000000000017, -2.2000000000000015, -1.8000000000000012, -1.5000000000000009, -1.700000000000001, -4.0, -1.5000000000000009, -2.1000000000000014, -1.8000000000000012, -1.8000000000000012, -2.1000000000000014, -1.8000000000000012, -1.600000000000001, -1.9000000000000012, -2.3000000000000016, -1.600000000000001, -2.4000000000000017, -1.4000000000000008, -2.0000000000000013, -2.3000000000000016, -1.8000000000000012, -2.5000000000000018, -1.8000000000000012, -2.2000000000000015, -2.0000000000000013, -2.4000000000000017, -2.1000000000000014, -1.600000000000001, -1.9000000000000012, -2.600000000000002, -2.3000000000000016, -1.9000000000000012, -1.9000000000000012, -2.1000000000000014, -1.8000000000000012, -1.700000000000001, -2.1000000000000014, -1.700000000000001, -1.8000000000000012, -1.600000000000001, -3.1000000000000014, -2.1000000000000014, -1.9000000000000012, -1.9000000000000012, -1.700000000000001, -2.2000000000000015, -2.2000000000000015, -2.1000000000000014, -2.0000000000000013, -2.2000000000000015, -2.2000000000000015, -2.4000000000000017, -2.2000000000000015, -2.1000000000000014, -2.4000000000000017, -2.2000000000000015, -2.1000000000000014, -1.600000000000001], "episode_lengths": [33, 37, 34, 32, 31, 35, 31, 33, 28, 32, 29, 37, 35, 28, 31, 35, 27, 36, 29, 33, 30, 34, 28, 34, 29, 38, 28, 29, 30, 29, 30, 29, 47, 37, 35, 53, 35, 30, 36, 31, 28, 27, 29, 29, 40, 32, 29, 27, 33, 27, 29, 25, 31, 30, 28, 37, 34, 31, 29, 41, 32, 36, 31, 30, 34, 27, 31, 35, 33, 29, 26, 28, 47, 26, 32, 29, 29, 32, 29, 27, 30, 34, 27, 35, 25, 31, 34, 29, 36, 29, 33, 31, 35, 32, 27, 30, 37, 34, 30, 30, 32, 29, 28, 32, 28, 29, 27, 42, 32, 30, 30, 28, 33, 33, 32, 31, 33, 33, 35, 33, 32, 35, 33, 32, 27]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2822475886333583, "mean_inference_ms": 0.6386112377544105, "mean_action_processing_ms": 0.06949057874314557, "mean_env_wait_ms": 6.557447527406251, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006394767761230468, "StateBufferConnector_ms": 0.003879737854003906, "ViewRequirementAgentConnector_ms": 0.08630867004394531}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 160000, "num_agent_steps_trained": 160000, "num_env_steps_sampled": 160000, "num_env_steps_trained": 160000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 322.02195475462645, "num_env_steps_trained_throughput_per_sec": 322.02195475462645, "timesteps_total": 160000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 160000, "timers": {"training_iteration_time_ms": 12373.418, "sample_time_ms": 8659.901, "load_time_ms": 1.05, "load_throughput": 3810838.387, "learn_time_ms": 3710.122, "learn_throughput": 1078.132, "synch_weights_time_ms": 1.705}, "counters": {"num_env_steps_sampled": 160000, "num_env_steps_trained": 160000, "num_agent_steps_sampled": 160000, "num_agent_steps_trained": 160000}, "done": false, "episodes_total": 2480, "training_iteration": 40, "trial_id": "329fa_00000", "date": "2024-03-07_12-29-32", "timestamp": 1709832572, "time_this_iter_s": 12.42397427558899, "time_total_s": 449.0715091228485, "pid": 105400, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fcd19c36f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 449.0715091228485, "iterations_since_restore": 40, "perf": {"cpu_util_percent": 22.18125, "ram_util_percent": 44.7, "gpu_util_percent0": 0.09, "vram_util_percent0": 0.11100260416666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.10000000000000002, "cur_lr": 0.0010000000000000005, "total_loss": -0.0020106890951082992, "policy_loss": -0.027837340477653728, "vf_loss": 0.024291236807281773, "vf_explained_var": 0.9722465049195034, "kl": 0.015354142340617827, "entropy": 0.353072946654853, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 37665.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 164000, "num_env_steps_trained": 164000, "num_agent_steps_sampled": 164000, "num_agent_steps_trained": 164000}, "sampler_results": {"episode_reward_max": -1.4000000000000008, "episode_reward_min": -2.800000000000002, "episode_reward_mean": -1.9750000000000012, "episode_len_mean": 30.75, "episode_media": {}, "episodes_this_iter": 132, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2.3000000000000016, -2.3000000000000016, -2.2000000000000015, -2.1000000000000014, -2.3000000000000016, -1.8000000000000012, -1.5000000000000009, -1.9000000000000012, -1.8000000000000012, -1.700000000000001, -2.2000000000000015, -2.0000000000000013, -1.600000000000001, -1.700000000000001, -1.8000000000000012, -1.700000000000001, -1.700000000000001, -1.700000000000001, -1.9000000000000012, -2.600000000000002, -1.9000000000000012, -2.3000000000000016, -2.1000000000000014, -2.0000000000000013, -1.5000000000000009, -2.2000000000000015, -2.3000000000000016, -2.0000000000000013, -2.2000000000000015, -2.2000000000000015, -2.0000000000000013, -1.8000000000000012, -1.8000000000000012, -2.2000000000000015, -2.1000000000000014, -2.1000000000000014, -2.4000000000000017, -1.8000000000000012, -2.0000000000000013, -1.5000000000000009, -2.2000000000000015, -2.0000000000000013, -2.0000000000000013, -1.600000000000001, -2.0000000000000013, -1.8000000000000012, -2.3000000000000016, -2.800000000000002, -2.2000000000000015, -1.8000000000000012, -1.600000000000001, -1.8000000000000012, -2.4000000000000017, -1.9000000000000012, -2.3000000000000016, -1.9000000000000012, -1.700000000000001, -2.700000000000002, -1.9000000000000012, -1.600000000000001, -2.0000000000000013, -1.4000000000000008, -1.600000000000001, -1.9000000000000012, -2.1000000000000014, -2.0000000000000013, -2.0000000000000013, -1.700000000000001, -2.4000000000000017, -1.700000000000001, -2.1000000000000014, -1.9000000000000012, -2.2000000000000015, -1.700000000000001, -1.8000000000000012, -2.5000000000000018, -1.9000000000000012, -2.0000000000000013, -2.1000000000000014, -2.0000000000000013, -1.600000000000001, -2.2000000000000015, -2.0000000000000013, -1.8000000000000012, -2.1000000000000014, -1.9000000000000012, -1.5000000000000009, -2.1000000000000014, -1.600000000000001, -2.700000000000002, -1.8000000000000012, -1.8000000000000012, -2.3000000000000016, -1.9000000000000012, -2.2000000000000015, -1.5000000000000009, -2.0000000000000013, -2.0000000000000013, -2.4000000000000017, -2.5000000000000018, -2.1000000000000014, -1.9000000000000012, -2.2000000000000015, -1.600000000000001, -2.1000000000000014, -2.0000000000000013, -2.3000000000000016, -2.0000000000000013, -2.4000000000000017, -1.8000000000000012, -2.0000000000000013, -1.9000000000000012, -2.1000000000000014, -2.2000000000000015, -1.9000000000000012, -1.9000000000000012, -1.9000000000000012, -1.600000000000001, -2.4000000000000017, -1.600000000000001, -1.9000000000000012, -1.700000000000001, -1.9000000000000012, -1.9000000000000012, -1.9000000000000012, -1.700000000000001, -1.5000000000000009, -1.9000000000000012, -1.9000000000000012, -1.600000000000001, -1.700000000000001, -2.600000000000002], "episode_lengths": [34, 34, 33, 32, 34, 29, 26, 30, 29, 28, 33, 31, 27, 28, 29, 28, 28, 28, 30, 37, 30, 34, 32, 31, 26, 33, 34, 31, 33, 33, 31, 29, 29, 33, 32, 32, 35, 29, 31, 26, 33, 31, 31, 27, 31, 29, 34, 39, 33, 29, 27, 29, 35, 30, 34, 30, 28, 38, 30, 27, 31, 25, 27, 30, 32, 31, 31, 28, 35, 28, 32, 30, 33, 28, 29, 36, 30, 31, 32, 31, 27, 33, 31, 29, 32, 30, 26, 32, 27, 38, 29, 29, 34, 30, 33, 26, 31, 31, 35, 36, 32, 30, 33, 27, 32, 31, 34, 31, 35, 29, 31, 30, 32, 33, 30, 30, 30, 27, 35, 27, 30, 28, 30, 30, 30, 28, 26, 30, 30, 27, 28, 37]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2855349117940653, "mean_inference_ms": 0.6402416658507322, "mean_action_processing_ms": 0.06961334635840925, "mean_env_wait_ms": 6.579168246829252, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006147767558242335, "StateBufferConnector_ms": 0.003826798814715761, "ViewRequirementAgentConnector_ms": 0.084866899432558}}, "episode_reward_max": -1.4000000000000008, "episode_reward_min": -2.800000000000002, "episode_reward_mean": -1.9750000000000012, "episode_len_mean": 30.75, "episodes_this_iter": 132, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-2.3000000000000016, -2.3000000000000016, -2.2000000000000015, -2.1000000000000014, -2.3000000000000016, -1.8000000000000012, -1.5000000000000009, -1.9000000000000012, -1.8000000000000012, -1.700000000000001, -2.2000000000000015, -2.0000000000000013, -1.600000000000001, -1.700000000000001, -1.8000000000000012, -1.700000000000001, -1.700000000000001, -1.700000000000001, -1.9000000000000012, -2.600000000000002, -1.9000000000000012, -2.3000000000000016, -2.1000000000000014, -2.0000000000000013, -1.5000000000000009, -2.2000000000000015, -2.3000000000000016, -2.0000000000000013, -2.2000000000000015, -2.2000000000000015, -2.0000000000000013, -1.8000000000000012, -1.8000000000000012, -2.2000000000000015, -2.1000000000000014, -2.1000000000000014, -2.4000000000000017, -1.8000000000000012, -2.0000000000000013, -1.5000000000000009, -2.2000000000000015, -2.0000000000000013, -2.0000000000000013, -1.600000000000001, -2.0000000000000013, -1.8000000000000012, -2.3000000000000016, -2.800000000000002, -2.2000000000000015, -1.8000000000000012, -1.600000000000001, -1.8000000000000012, -2.4000000000000017, -1.9000000000000012, -2.3000000000000016, -1.9000000000000012, -1.700000000000001, -2.700000000000002, -1.9000000000000012, -1.600000000000001, -2.0000000000000013, -1.4000000000000008, -1.600000000000001, -1.9000000000000012, -2.1000000000000014, -2.0000000000000013, -2.0000000000000013, -1.700000000000001, -2.4000000000000017, -1.700000000000001, -2.1000000000000014, -1.9000000000000012, -2.2000000000000015, -1.700000000000001, -1.8000000000000012, -2.5000000000000018, -1.9000000000000012, -2.0000000000000013, -2.1000000000000014, -2.0000000000000013, -1.600000000000001, -2.2000000000000015, -2.0000000000000013, -1.8000000000000012, -2.1000000000000014, -1.9000000000000012, -1.5000000000000009, -2.1000000000000014, -1.600000000000001, -2.700000000000002, -1.8000000000000012, -1.8000000000000012, -2.3000000000000016, -1.9000000000000012, -2.2000000000000015, -1.5000000000000009, -2.0000000000000013, -2.0000000000000013, -2.4000000000000017, -2.5000000000000018, -2.1000000000000014, -1.9000000000000012, -2.2000000000000015, -1.600000000000001, -2.1000000000000014, -2.0000000000000013, -2.3000000000000016, -2.0000000000000013, -2.4000000000000017, -1.8000000000000012, -2.0000000000000013, -1.9000000000000012, -2.1000000000000014, -2.2000000000000015, -1.9000000000000012, -1.9000000000000012, -1.9000000000000012, -1.600000000000001, -2.4000000000000017, -1.600000000000001, -1.9000000000000012, -1.700000000000001, -1.9000000000000012, -1.9000000000000012, -1.9000000000000012, -1.700000000000001, -1.5000000000000009, -1.9000000000000012, -1.9000000000000012, -1.600000000000001, -1.700000000000001, -2.600000000000002], "episode_lengths": [34, 34, 33, 32, 34, 29, 26, 30, 29, 28, 33, 31, 27, 28, 29, 28, 28, 28, 30, 37, 30, 34, 32, 31, 26, 33, 34, 31, 33, 33, 31, 29, 29, 33, 32, 32, 35, 29, 31, 26, 33, 31, 31, 27, 31, 29, 34, 39, 33, 29, 27, 29, 35, 30, 34, 30, 28, 38, 30, 27, 31, 25, 27, 30, 32, 31, 31, 28, 35, 28, 32, 30, 33, 28, 29, 36, 30, 31, 32, 31, 27, 33, 31, 29, 32, 30, 26, 32, 27, 38, 29, 29, 34, 30, 33, 26, 31, 31, 35, 36, 32, 30, 33, 27, 32, 31, 34, 31, 35, 29, 31, 30, 32, 33, 30, 30, 30, 27, 35, 27, 30, 28, 30, 30, 30, 28, 26, 30, 30, 27, 28, 37]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2855349117940653, "mean_inference_ms": 0.6402416658507322, "mean_action_processing_ms": 0.06961334635840925, "mean_env_wait_ms": 6.579168246829252, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006147767558242335, "StateBufferConnector_ms": 0.003826798814715761, "ViewRequirementAgentConnector_ms": 0.084866899432558}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 164000, "num_agent_steps_trained": 164000, "num_env_steps_sampled": 164000, "num_env_steps_trained": 164000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 319.3612689342656, "num_env_steps_trained_throughput_per_sec": 319.3612689342656, "timesteps_total": 164000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 164000, "timers": {"training_iteration_time_ms": 12438.129, "sample_time_ms": 8695.325, "load_time_ms": 1.066, "load_throughput": 3753880.026, "learn_time_ms": 3739.359, "learn_throughput": 1069.702, "synch_weights_time_ms": 1.728}, "counters": {"num_env_steps_sampled": 164000, "num_env_steps_trained": 164000, "num_agent_steps_sampled": 164000, "num_agent_steps_trained": 164000}, "done": false, "episodes_total": 2612, "training_iteration": 41, "trial_id": "329fa_00000", "date": "2024-03-07_12-29-45", "timestamp": 1709832585, "time_this_iter_s": 12.527726173400879, "time_total_s": 461.5992352962494, "pid": 105400, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fcd19c36f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 461.5992352962494, "iterations_since_restore": 41, "perf": {"cpu_util_percent": 22.79375, "ram_util_percent": 44.706250000000004, "gpu_util_percent0": 0.0775, "vram_util_percent0": 0.11100260416666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.10000000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 0.07499382751299098, "policy_loss": -0.0074077407453930185, "vf_loss": 0.08122742635258023, "vf_explained_var": 0.9520028383501115, "kl": 0.011741429922397446, "entropy": 0.2997977704931331, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 38595.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 168000, "num_env_steps_trained": 168000, "num_agent_steps_sampled": 168000, "num_agent_steps_trained": 168000}, "sampler_results": {"episode_reward_max": -1.4000000000000008, "episode_reward_min": -4.799999999999995, "episode_reward_mean": -1.9641221374045816, "episode_len_mean": 30.587786259541986, "episode_media": {}, "episodes_this_iter": 131, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1.8000000000000012, -1.5000000000000009, -1.600000000000001, -1.8000000000000012, -1.700000000000001, -1.8000000000000012, -1.9000000000000012, -1.8000000000000012, -2.1000000000000014, -1.600000000000001, -1.8000000000000012, -2.5000000000000018, -1.9000000000000012, -1.5000000000000009, -2.5000000000000018, -2.700000000000002, -2.3000000000000016, -2.2000000000000015, -1.600000000000001, -1.8000000000000012, -1.600000000000001, -2.0000000000000013, -1.9000000000000012, -2.1000000000000014, -1.600000000000001, -1.600000000000001, -2.0000000000000013, -1.600000000000001, -2.1000000000000014, -1.700000000000001, -2.700000000000002, -2.1000000000000014, -2.0000000000000013, -1.700000000000001, -1.5000000000000009, -2.2000000000000015, -2.1000000000000014, -2.0000000000000013, -1.9000000000000012, -2.2000000000000015, -2.900000000000002, -1.9000000000000012, -1.700000000000001, -2.3000000000000016, -1.700000000000001, -1.600000000000001, -1.600000000000001, -2.3000000000000016, -2.0000000000000013, -2.0000000000000013, -1.9000000000000012, -2.800000000000002, -2.2000000000000015, -4.799999999999995, -2.600000000000002, -1.600000000000001, -1.9000000000000012, -1.600000000000001, -1.9000000000000012, -1.8000000000000012, -2.4000000000000017, -1.5000000000000009, -1.4000000000000008, -2.5000000000000018, -1.600000000000001, -1.9000000000000012, -2.3000000000000016, -1.9000000000000012, -2.2000000000000015, -1.600000000000001, -1.4000000000000008, -1.5000000000000009, -1.8000000000000012, -2.1000000000000014, -1.9000000000000012, -2.3000000000000016, -2.5000000000000018, -1.600000000000001, -1.8000000000000012, -1.4000000000000008, -1.600000000000001, -1.8000000000000012, -1.600000000000001, -1.9000000000000012, -1.9000000000000012, -1.700000000000001, -1.700000000000001, -1.8000000000000012, -1.600000000000001, -1.600000000000001, -2.4000000000000017, -2.3000000000000016, -2.2000000000000015, -1.8000000000000012, -2.0000000000000013, -1.8000000000000012, -1.600000000000001, -1.700000000000001, -2.0000000000000013, -2.700000000000002, -2.0000000000000013, -2.3000000000000016, -2.5000000000000018, -1.8000000000000012, -2.0000000000000013, -2.4000000000000017, -1.700000000000001, -1.8000000000000012, -1.8000000000000012, -2.3000000000000016, -1.700000000000001, -2.0000000000000013, -2.0000000000000013, -2.2000000000000015, -2.0000000000000013, -1.8000000000000012, -2.2000000000000015, -2.0000000000000013, -2.0000000000000013, -1.8000000000000012, -2.2000000000000015, -1.8000000000000012, -1.9000000000000012, -1.8000000000000012, -1.4000000000000008, -1.8000000000000012, -2.5000000000000018, -1.8000000000000012, -2.0000000000000013, -1.9000000000000012, -2.5000000000000018], "episode_lengths": [29, 26, 27, 29, 28, 29, 30, 29, 32, 27, 29, 36, 30, 26, 36, 38, 34, 33, 27, 29, 27, 31, 30, 32, 27, 27, 31, 27, 32, 28, 38, 32, 31, 28, 26, 33, 32, 31, 30, 33, 40, 30, 28, 34, 28, 27, 27, 34, 31, 31, 30, 37, 33, 54, 37, 27, 30, 27, 30, 29, 35, 26, 25, 36, 27, 30, 34, 30, 33, 27, 25, 26, 29, 32, 30, 34, 36, 27, 29, 25, 27, 29, 27, 30, 30, 28, 28, 29, 27, 27, 35, 34, 33, 29, 31, 29, 27, 28, 31, 38, 31, 34, 36, 29, 31, 35, 28, 29, 29, 34, 28, 31, 31, 33, 31, 29, 33, 31, 31, 29, 33, 29, 30, 29, 25, 29, 36, 29, 31, 30, 36]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.28876101880340466, "mean_inference_ms": 0.642046251726506, "mean_action_processing_ms": 0.06970941365636588, "mean_env_wait_ms": 6.6015213829277615, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006396715877620318, "StateBufferConnector_ms": 0.003934270553006471, "ViewRequirementAgentConnector_ms": 0.08716601451844659}}, "episode_reward_max": -1.4000000000000008, "episode_reward_min": -4.799999999999995, "episode_reward_mean": -1.9641221374045816, "episode_len_mean": 30.587786259541986, "episodes_this_iter": 131, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1.8000000000000012, -1.5000000000000009, -1.600000000000001, -1.8000000000000012, -1.700000000000001, -1.8000000000000012, -1.9000000000000012, -1.8000000000000012, -2.1000000000000014, -1.600000000000001, -1.8000000000000012, -2.5000000000000018, -1.9000000000000012, -1.5000000000000009, -2.5000000000000018, -2.700000000000002, -2.3000000000000016, -2.2000000000000015, -1.600000000000001, -1.8000000000000012, -1.600000000000001, -2.0000000000000013, -1.9000000000000012, -2.1000000000000014, -1.600000000000001, -1.600000000000001, -2.0000000000000013, -1.600000000000001, -2.1000000000000014, -1.700000000000001, -2.700000000000002, -2.1000000000000014, -2.0000000000000013, -1.700000000000001, -1.5000000000000009, -2.2000000000000015, -2.1000000000000014, -2.0000000000000013, -1.9000000000000012, -2.2000000000000015, -2.900000000000002, -1.9000000000000012, -1.700000000000001, -2.3000000000000016, -1.700000000000001, -1.600000000000001, -1.600000000000001, -2.3000000000000016, -2.0000000000000013, -2.0000000000000013, -1.9000000000000012, -2.800000000000002, -2.2000000000000015, -4.799999999999995, -2.600000000000002, -1.600000000000001, -1.9000000000000012, -1.600000000000001, -1.9000000000000012, -1.8000000000000012, -2.4000000000000017, -1.5000000000000009, -1.4000000000000008, -2.5000000000000018, -1.600000000000001, -1.9000000000000012, -2.3000000000000016, -1.9000000000000012, -2.2000000000000015, -1.600000000000001, -1.4000000000000008, -1.5000000000000009, -1.8000000000000012, -2.1000000000000014, -1.9000000000000012, -2.3000000000000016, -2.5000000000000018, -1.600000000000001, -1.8000000000000012, -1.4000000000000008, -1.600000000000001, -1.8000000000000012, -1.600000000000001, -1.9000000000000012, -1.9000000000000012, -1.700000000000001, -1.700000000000001, -1.8000000000000012, -1.600000000000001, -1.600000000000001, -2.4000000000000017, -2.3000000000000016, -2.2000000000000015, -1.8000000000000012, -2.0000000000000013, -1.8000000000000012, -1.600000000000001, -1.700000000000001, -2.0000000000000013, -2.700000000000002, -2.0000000000000013, -2.3000000000000016, -2.5000000000000018, -1.8000000000000012, -2.0000000000000013, -2.4000000000000017, -1.700000000000001, -1.8000000000000012, -1.8000000000000012, -2.3000000000000016, -1.700000000000001, -2.0000000000000013, -2.0000000000000013, -2.2000000000000015, -2.0000000000000013, -1.8000000000000012, -2.2000000000000015, -2.0000000000000013, -2.0000000000000013, -1.8000000000000012, -2.2000000000000015, -1.8000000000000012, -1.9000000000000012, -1.8000000000000012, -1.4000000000000008, -1.8000000000000012, -2.5000000000000018, -1.8000000000000012, -2.0000000000000013, -1.9000000000000012, -2.5000000000000018], "episode_lengths": [29, 26, 27, 29, 28, 29, 30, 29, 32, 27, 29, 36, 30, 26, 36, 38, 34, 33, 27, 29, 27, 31, 30, 32, 27, 27, 31, 27, 32, 28, 38, 32, 31, 28, 26, 33, 32, 31, 30, 33, 40, 30, 28, 34, 28, 27, 27, 34, 31, 31, 30, 37, 33, 54, 37, 27, 30, 27, 30, 29, 35, 26, 25, 36, 27, 30, 34, 30, 33, 27, 25, 26, 29, 32, 30, 34, 36, 27, 29, 25, 27, 29, 27, 30, 30, 28, 28, 29, 27, 27, 35, 34, 33, 29, 31, 29, 27, 28, 31, 38, 31, 34, 36, 29, 31, 35, 28, 29, 29, 34, 28, 31, 31, 33, 31, 29, 33, 31, 31, 29, 33, 29, 30, 29, 25, 29, 36, 29, 31, 30, 36]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.28876101880340466, "mean_inference_ms": 0.642046251726506, "mean_action_processing_ms": 0.06970941365636588, "mean_env_wait_ms": 6.6015213829277615, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006396715877620318, "StateBufferConnector_ms": 0.003934270553006471, "ViewRequirementAgentConnector_ms": 0.08716601451844659}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 168000, "num_agent_steps_trained": 168000, "num_env_steps_sampled": 168000, "num_env_steps_trained": 168000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 317.3655814128048, "num_env_steps_trained_throughput_per_sec": 317.3655814128048, "timesteps_total": 168000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 168000, "timers": {"training_iteration_time_ms": 12526.546, "sample_time_ms": 8748.962, "load_time_ms": 1.065, "load_throughput": 3754552.087, "learn_time_ms": 3774.072, "learn_throughput": 1059.863, "synch_weights_time_ms": 1.776}, "counters": {"num_env_steps_sampled": 168000, "num_env_steps_trained": 168000, "num_agent_steps_sampled": 168000, "num_agent_steps_trained": 168000}, "done": false, "episodes_total": 2743, "training_iteration": 42, "trial_id": "329fa_00000", "date": "2024-03-07_12-29-57", "timestamp": 1709832597, "time_this_iter_s": 12.606950044631958, "time_total_s": 474.20618534088135, "pid": 105400, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fcd19c36f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 474.20618534088135, "iterations_since_restore": 42, "perf": {"cpu_util_percent": 21.970588235294116, "ram_util_percent": 44.71176470588235, "gpu_util_percent0": 0.08588235294117648, "vram_util_percent0": 0.11060049019607843}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.10000000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 0.20004396674039232, "policy_loss": -0.011087190440445337, "vf_loss": 0.20941663804333857, "vf_explained_var": 0.8616208946833046, "kl": 0.017145171454874084, "entropy": 0.2917595043938647, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 39525.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 172000, "num_env_steps_trained": 172000, "num_agent_steps_sampled": 172000, "num_agent_steps_trained": 172000}, "sampler_results": {"episode_reward_max": -1.4000000000000008, "episode_reward_min": -7.0000000000000036, "episode_reward_mean": -1.9659090909090917, "episode_len_mean": 30.136363636363637, "episode_media": {}, "episodes_this_iter": 132, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1.600000000000001, -1.9000000000000012, -1.5000000000000009, -2.4000000000000017, -1.5000000000000009, -2.0000000000000013, -1.600000000000001, -2.2000000000000015, -1.5000000000000009, -1.8000000000000012, -1.700000000000001, -1.4000000000000008, -2.700000000000002, -1.5000000000000009, -1.8000000000000012, -3.200000000000001, -1.5000000000000009, -2.1000000000000014, -1.700000000000001, -2.2000000000000015, -7.0000000000000036, -1.700000000000001, -1.600000000000001, -1.9000000000000012, -1.700000000000001, -1.700000000000001, -1.8000000000000012, -2.0000000000000013, -1.600000000000001, -1.4000000000000008, -1.5000000000000009, -1.700000000000001, -1.9000000000000012, -3.4000000000000004, -2.2000000000000015, -2.0000000000000013, -1.700000000000001, -3.3000000000000007, -1.5000000000000009, -2.3000000000000016, -1.8000000000000012, -3.1000000000000014, -2.1000000000000014, -1.600000000000001, -1.9000000000000012, -2.0000000000000013, -1.8000000000000012, -1.5000000000000009, -1.700000000000001, -1.700000000000001, -1.5000000000000009, -1.600000000000001, -2.2000000000000015, -3.4000000000000004, -1.700000000000001, -1.700000000000001, -1.8000000000000012, -1.700000000000001, -1.8000000000000012, -1.700000000000001, -1.700000000000001, -2.800000000000002, -1.8000000000000012, -1.700000000000001, -2.3000000000000016, -2.0000000000000013, -1.9000000000000012, -1.700000000000001, -1.600000000000001, -1.9000000000000012, -1.8000000000000012, -1.4000000000000008, -1.700000000000001, -1.8000000000000012, -1.700000000000001, -1.600000000000001, -1.600000000000001, -2.0000000000000013, -1.8000000000000012, -1.700000000000001, -1.9000000000000012, -1.700000000000001, -1.8000000000000012, -1.600000000000001, -1.8000000000000012, -2.2000000000000015, -1.600000000000001, -1.600000000000001, -1.8000000000000012, -2.2000000000000015, -1.600000000000001, -1.9000000000000012, -2.1000000000000014, -1.9000000000000012, -1.700000000000001, -4.000000000000001, -2.0000000000000013, -1.8000000000000012, -2.1000000000000014, -1.9000000000000012, -1.9000000000000012, -1.9000000000000012, -1.5000000000000009, -2.4000000000000017, -2.0000000000000013, -2.900000000000002, -2.0000000000000013, -1.8000000000000012, -2.0000000000000013, -2.3000000000000016, -2.4000000000000017, -1.8000000000000012, -1.9000000000000012, -1.9000000000000012, -1.8000000000000012, -1.700000000000001, -2.4000000000000017, -1.600000000000001, -1.8000000000000012, -2.1000000000000014, -1.700000000000001, -1.700000000000001, -1.700000000000001, -1.9000000000000012, -2.1000000000000014, -1.4000000000000008, -1.9000000000000012, -4.100000000000003, -1.600000000000001, -1.8000000000000012, -2.1000000000000014, -1.700000000000001], "episode_lengths": [27, 30, 26, 35, 26, 31, 27, 33, 26, 29, 28, 25, 38, 26, 29, 37, 26, 32, 28, 33, 58, 28, 27, 30, 28, 28, 29, 31, 27, 25, 26, 28, 30, 40, 33, 31, 28, 42, 26, 34, 29, 38, 32, 27, 30, 31, 29, 26, 28, 28, 26, 27, 33, 41, 28, 28, 29, 28, 29, 28, 28, 39, 29, 28, 34, 31, 30, 28, 27, 30, 29, 25, 28, 29, 28, 27, 27, 31, 29, 28, 30, 28, 29, 27, 29, 33, 27, 27, 29, 33, 27, 30, 32, 30, 28, 41, 31, 29, 32, 30, 30, 30, 26, 35, 31, 37, 31, 29, 31, 34, 35, 29, 30, 30, 29, 28, 35, 27, 29, 32, 28, 28, 28, 30, 32, 25, 30, 40, 27, 29, 32, 28]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2918066236151658, "mean_inference_ms": 0.643632446908911, "mean_action_processing_ms": 0.06980189117407533, "mean_env_wait_ms": 6.623567033709193, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006410208615389737, "StateBufferConnector_ms": 0.0038600329196814337, "ViewRequirementAgentConnector_ms": 0.08653691320708304}}, "episode_reward_max": -1.4000000000000008, "episode_reward_min": -7.0000000000000036, "episode_reward_mean": -1.9659090909090917, "episode_len_mean": 30.136363636363637, "episodes_this_iter": 132, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1.600000000000001, -1.9000000000000012, -1.5000000000000009, -2.4000000000000017, -1.5000000000000009, -2.0000000000000013, -1.600000000000001, -2.2000000000000015, -1.5000000000000009, -1.8000000000000012, -1.700000000000001, -1.4000000000000008, -2.700000000000002, -1.5000000000000009, -1.8000000000000012, -3.200000000000001, -1.5000000000000009, -2.1000000000000014, -1.700000000000001, -2.2000000000000015, -7.0000000000000036, -1.700000000000001, -1.600000000000001, -1.9000000000000012, -1.700000000000001, -1.700000000000001, -1.8000000000000012, -2.0000000000000013, -1.600000000000001, -1.4000000000000008, -1.5000000000000009, -1.700000000000001, -1.9000000000000012, -3.4000000000000004, -2.2000000000000015, -2.0000000000000013, -1.700000000000001, -3.3000000000000007, -1.5000000000000009, -2.3000000000000016, -1.8000000000000012, -3.1000000000000014, -2.1000000000000014, -1.600000000000001, -1.9000000000000012, -2.0000000000000013, -1.8000000000000012, -1.5000000000000009, -1.700000000000001, -1.700000000000001, -1.5000000000000009, -1.600000000000001, -2.2000000000000015, -3.4000000000000004, -1.700000000000001, -1.700000000000001, -1.8000000000000012, -1.700000000000001, -1.8000000000000012, -1.700000000000001, -1.700000000000001, -2.800000000000002, -1.8000000000000012, -1.700000000000001, -2.3000000000000016, -2.0000000000000013, -1.9000000000000012, -1.700000000000001, -1.600000000000001, -1.9000000000000012, -1.8000000000000012, -1.4000000000000008, -1.700000000000001, -1.8000000000000012, -1.700000000000001, -1.600000000000001, -1.600000000000001, -2.0000000000000013, -1.8000000000000012, -1.700000000000001, -1.9000000000000012, -1.700000000000001, -1.8000000000000012, -1.600000000000001, -1.8000000000000012, -2.2000000000000015, -1.600000000000001, -1.600000000000001, -1.8000000000000012, -2.2000000000000015, -1.600000000000001, -1.9000000000000012, -2.1000000000000014, -1.9000000000000012, -1.700000000000001, -4.000000000000001, -2.0000000000000013, -1.8000000000000012, -2.1000000000000014, -1.9000000000000012, -1.9000000000000012, -1.9000000000000012, -1.5000000000000009, -2.4000000000000017, -2.0000000000000013, -2.900000000000002, -2.0000000000000013, -1.8000000000000012, -2.0000000000000013, -2.3000000000000016, -2.4000000000000017, -1.8000000000000012, -1.9000000000000012, -1.9000000000000012, -1.8000000000000012, -1.700000000000001, -2.4000000000000017, -1.600000000000001, -1.8000000000000012, -2.1000000000000014, -1.700000000000001, -1.700000000000001, -1.700000000000001, -1.9000000000000012, -2.1000000000000014, -1.4000000000000008, -1.9000000000000012, -4.100000000000003, -1.600000000000001, -1.8000000000000012, -2.1000000000000014, -1.700000000000001], "episode_lengths": [27, 30, 26, 35, 26, 31, 27, 33, 26, 29, 28, 25, 38, 26, 29, 37, 26, 32, 28, 33, 58, 28, 27, 30, 28, 28, 29, 31, 27, 25, 26, 28, 30, 40, 33, 31, 28, 42, 26, 34, 29, 38, 32, 27, 30, 31, 29, 26, 28, 28, 26, 27, 33, 41, 28, 28, 29, 28, 29, 28, 28, 39, 29, 28, 34, 31, 30, 28, 27, 30, 29, 25, 28, 29, 28, 27, 27, 31, 29, 28, 30, 28, 29, 27, 29, 33, 27, 27, 29, 33, 27, 30, 32, 30, 28, 41, 31, 29, 32, 30, 30, 30, 26, 35, 31, 37, 31, 29, 31, 34, 35, 29, 30, 30, 29, 28, 35, 27, 29, 32, 28, 28, 28, 30, 32, 25, 30, 40, 27, 29, 32, 28]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2918066236151658, "mean_inference_ms": 0.643632446908911, "mean_action_processing_ms": 0.06980189117407533, "mean_env_wait_ms": 6.623567033709193, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006410208615389737, "StateBufferConnector_ms": 0.0038600329196814337, "ViewRequirementAgentConnector_ms": 0.08653691320708304}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 172000, "num_agent_steps_trained": 172000, "num_env_steps_sampled": 172000, "num_env_steps_trained": 172000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 319.7265765993422, "num_env_steps_trained_throughput_per_sec": 319.7265765993422, "timesteps_total": 172000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 172000, "timers": {"training_iteration_time_ms": 12601.215, "sample_time_ms": 8804.698, "load_time_ms": 1.066, "load_throughput": 3750774.871, "learn_time_ms": 3792.967, "learn_throughput": 1054.583, "synch_weights_time_ms": 1.808}, "counters": {"num_env_steps_sampled": 172000, "num_env_steps_trained": 172000, "num_agent_steps_sampled": 172000, "num_agent_steps_trained": 172000}, "done": false, "episodes_total": 2875, "training_iteration": 43, "trial_id": "329fa_00000", "date": "2024-03-07_12-30-10", "timestamp": 1709832610, "time_this_iter_s": 12.513776063919067, "time_total_s": 486.7199614048004, "pid": 105400, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fcd19c36f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 486.7199614048004, "iterations_since_restore": 43, "perf": {"cpu_util_percent": 22.425, "ram_util_percent": 44.66250000000001, "gpu_util_percent0": 0.091875, "vram_util_percent0": 0.11043294270833333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.10000000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 0.05387764319837574, "policy_loss": -0.007847421307877828, "vf_loss": 0.06061488506384194, "vf_explained_var": 0.9406941335047445, "kl": 0.011101793035647059, "entropy": 0.2816363932945395, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 40455.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 176000, "num_env_steps_trained": 176000, "num_agent_steps_sampled": 176000, "num_agent_steps_trained": 176000}, "sampler_results": {"episode_reward_max": -1.4000000000000008, "episode_reward_min": -3.6000000000000023, "episode_reward_mean": -1.872592592592594, "episode_len_mean": 29.59259259259259, "episode_media": {}, "episodes_this_iter": 135, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1.8000000000000012, -2.1000000000000014, -1.9000000000000012, -1.600000000000001, -1.8000000000000012, -1.600000000000001, -1.4000000000000008, -1.600000000000001, -1.700000000000001, -2.0000000000000013, -2.0000000000000013, -1.600000000000001, -1.700000000000001, -2.0000000000000013, -1.8000000000000012, -1.5000000000000009, -2.1000000000000014, -2.2000000000000015, -1.700000000000001, -2.0000000000000013, -1.700000000000001, -1.5000000000000009, -1.8000000000000012, -1.600000000000001, -2.0000000000000013, -1.9000000000000012, -1.9000000000000012, -1.5000000000000009, -1.700000000000001, -1.600000000000001, -1.8000000000000012, -2.0000000000000013, -1.8000000000000012, -3.4000000000000004, -2.1000000000000014, -1.700000000000001, -1.5000000000000009, -1.8000000000000012, -1.8000000000000012, -1.600000000000001, -1.5000000000000009, -1.8000000000000012, -1.700000000000001, -1.5000000000000009, -2.1000000000000014, -1.8000000000000012, -2.1000000000000014, -1.700000000000001, -2.0000000000000013, -1.8000000000000012, -1.9000000000000012, -1.700000000000001, -1.8000000000000012, -2.0000000000000013, -1.600000000000001, -1.600000000000001, -3.6000000000000023, -1.8000000000000012, -1.8000000000000012, -2.800000000000002, -2.0000000000000013, -1.600000000000001, -1.600000000000001, -1.9000000000000012, -1.4000000000000008, -2.0000000000000013, -1.5000000000000009, -2.800000000000002, -1.8000000000000012, -1.700000000000001, -2.1000000000000014, -1.600000000000001, -1.8000000000000012, -1.8000000000000012, -2.4000000000000017, -2.2000000000000015, -1.8000000000000012, -1.5000000000000009, -1.700000000000001, -1.8000000000000012, -3.5999999999999996, -2.2000000000000015, -1.9000000000000012, -2.4000000000000017, -2.3000000000000016, -1.700000000000001, -2.1000000000000014, -1.700000000000001, -1.9000000000000012, -1.5000000000000009, -1.8000000000000012, -1.8000000000000012, -1.9000000000000012, -1.9000000000000012, -1.600000000000001, -1.4000000000000008, -2.1000000000000014, -1.8000000000000012, -1.9000000000000012, -1.700000000000001, -1.9000000000000012, -2.3000000000000016, -1.600000000000001, -1.600000000000001, -1.700000000000001, -2.1000000000000014, -1.700000000000001, -1.9000000000000012, -2.2000000000000015, -2.3000000000000016, -1.9000000000000012, -1.8000000000000012, -1.600000000000001, -1.600000000000001, -1.9000000000000012, -1.5000000000000009, -1.8000000000000012, -1.8000000000000012, -2.0000000000000013, -1.700000000000001, -2.0000000000000013, -2.0000000000000013, -1.9000000000000012, -1.700000000000001, -2.900000000000002, -1.700000000000001, -1.8000000000000012, -1.600000000000001, -1.700000000000001, -1.700000000000001, -1.700000000000001, -1.9000000000000012, -1.9000000000000012, -1.8000000000000012, -2.0000000000000013], "episode_lengths": [29, 32, 30, 27, 29, 27, 25, 27, 28, 31, 31, 27, 28, 31, 29, 26, 32, 33, 28, 31, 28, 26, 29, 27, 31, 30, 30, 26, 28, 27, 29, 31, 29, 45, 32, 28, 26, 29, 29, 27, 26, 29, 28, 26, 32, 29, 32, 28, 31, 29, 30, 28, 29, 31, 27, 27, 37, 29, 29, 39, 31, 27, 27, 30, 25, 31, 26, 37, 29, 28, 32, 27, 29, 29, 35, 33, 29, 26, 28, 29, 43, 33, 30, 35, 34, 28, 32, 28, 30, 26, 29, 29, 30, 30, 27, 25, 32, 29, 30, 28, 30, 34, 27, 27, 28, 32, 28, 30, 33, 34, 30, 29, 27, 27, 30, 26, 29, 29, 31, 28, 31, 31, 30, 28, 38, 28, 29, 27, 28, 28, 28, 30, 30, 29, 31]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2947632234471186, "mean_inference_ms": 0.6451548305548935, "mean_action_processing_ms": 0.0699059761761177, "mean_env_wait_ms": 6.645186388741444, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006140249746817129, "StateBufferConnector_ms": 0.003848782292118779, "ViewRequirementAgentConnector_ms": 0.08630152101869937}}, "episode_reward_max": -1.4000000000000008, "episode_reward_min": -3.6000000000000023, "episode_reward_mean": -1.872592592592594, "episode_len_mean": 29.59259259259259, "episodes_this_iter": 135, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1.8000000000000012, -2.1000000000000014, -1.9000000000000012, -1.600000000000001, -1.8000000000000012, -1.600000000000001, -1.4000000000000008, -1.600000000000001, -1.700000000000001, -2.0000000000000013, -2.0000000000000013, -1.600000000000001, -1.700000000000001, -2.0000000000000013, -1.8000000000000012, -1.5000000000000009, -2.1000000000000014, -2.2000000000000015, -1.700000000000001, -2.0000000000000013, -1.700000000000001, -1.5000000000000009, -1.8000000000000012, -1.600000000000001, -2.0000000000000013, -1.9000000000000012, -1.9000000000000012, -1.5000000000000009, -1.700000000000001, -1.600000000000001, -1.8000000000000012, -2.0000000000000013, -1.8000000000000012, -3.4000000000000004, -2.1000000000000014, -1.700000000000001, -1.5000000000000009, -1.8000000000000012, -1.8000000000000012, -1.600000000000001, -1.5000000000000009, -1.8000000000000012, -1.700000000000001, -1.5000000000000009, -2.1000000000000014, -1.8000000000000012, -2.1000000000000014, -1.700000000000001, -2.0000000000000013, -1.8000000000000012, -1.9000000000000012, -1.700000000000001, -1.8000000000000012, -2.0000000000000013, -1.600000000000001, -1.600000000000001, -3.6000000000000023, -1.8000000000000012, -1.8000000000000012, -2.800000000000002, -2.0000000000000013, -1.600000000000001, -1.600000000000001, -1.9000000000000012, -1.4000000000000008, -2.0000000000000013, -1.5000000000000009, -2.800000000000002, -1.8000000000000012, -1.700000000000001, -2.1000000000000014, -1.600000000000001, -1.8000000000000012, -1.8000000000000012, -2.4000000000000017, -2.2000000000000015, -1.8000000000000012, -1.5000000000000009, -1.700000000000001, -1.8000000000000012, -3.5999999999999996, -2.2000000000000015, -1.9000000000000012, -2.4000000000000017, -2.3000000000000016, -1.700000000000001, -2.1000000000000014, -1.700000000000001, -1.9000000000000012, -1.5000000000000009, -1.8000000000000012, -1.8000000000000012, -1.9000000000000012, -1.9000000000000012, -1.600000000000001, -1.4000000000000008, -2.1000000000000014, -1.8000000000000012, -1.9000000000000012, -1.700000000000001, -1.9000000000000012, -2.3000000000000016, -1.600000000000001, -1.600000000000001, -1.700000000000001, -2.1000000000000014, -1.700000000000001, -1.9000000000000012, -2.2000000000000015, -2.3000000000000016, -1.9000000000000012, -1.8000000000000012, -1.600000000000001, -1.600000000000001, -1.9000000000000012, -1.5000000000000009, -1.8000000000000012, -1.8000000000000012, -2.0000000000000013, -1.700000000000001, -2.0000000000000013, -2.0000000000000013, -1.9000000000000012, -1.700000000000001, -2.900000000000002, -1.700000000000001, -1.8000000000000012, -1.600000000000001, -1.700000000000001, -1.700000000000001, -1.700000000000001, -1.9000000000000012, -1.9000000000000012, -1.8000000000000012, -2.0000000000000013], "episode_lengths": [29, 32, 30, 27, 29, 27, 25, 27, 28, 31, 31, 27, 28, 31, 29, 26, 32, 33, 28, 31, 28, 26, 29, 27, 31, 30, 30, 26, 28, 27, 29, 31, 29, 45, 32, 28, 26, 29, 29, 27, 26, 29, 28, 26, 32, 29, 32, 28, 31, 29, 30, 28, 29, 31, 27, 27, 37, 29, 29, 39, 31, 27, 27, 30, 25, 31, 26, 37, 29, 28, 32, 27, 29, 29, 35, 33, 29, 26, 28, 29, 43, 33, 30, 35, 34, 28, 32, 28, 30, 26, 29, 29, 30, 30, 27, 25, 32, 29, 30, 28, 30, 34, 27, 27, 28, 32, 28, 30, 33, 34, 30, 29, 27, 27, 30, 26, 29, 29, 31, 28, 31, 31, 30, 28, 38, 28, 29, 27, 28, 28, 28, 30, 30, 29, 31]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2947632234471186, "mean_inference_ms": 0.6451548305548935, "mean_action_processing_ms": 0.0699059761761177, "mean_env_wait_ms": 6.645186388741444, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006140249746817129, "StateBufferConnector_ms": 0.003848782292118779, "ViewRequirementAgentConnector_ms": 0.08630152101869937}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 176000, "num_agent_steps_trained": 176000, "num_env_steps_sampled": 176000, "num_env_steps_trained": 176000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 317.7877454084126, "num_env_steps_trained_throughput_per_sec": 317.7877454084126, "timesteps_total": 176000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 176000, "timers": {"training_iteration_time_ms": 12661.504, "sample_time_ms": 8856.299, "load_time_ms": 1.086, "load_throughput": 3682525.077, "learn_time_ms": 3801.629, "learn_throughput": 1052.18, "synch_weights_time_ms": 1.809}, "counters": {"num_env_steps_sampled": 176000, "num_env_steps_trained": 176000, "num_agent_steps_sampled": 176000, "num_agent_steps_trained": 176000}, "done": false, "episodes_total": 3010, "training_iteration": 44, "trial_id": "329fa_00000", "date": "2024-03-07_12-30-23", "timestamp": 1709832623, "time_this_iter_s": 12.590315341949463, "time_total_s": 499.3102767467499, "pid": 105400, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fcd19c36f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 499.3102767467499, "iterations_since_restore": 44, "perf": {"cpu_util_percent": 22.8875, "ram_util_percent": 44.6375, "gpu_util_percent0": 0.085625, "vram_util_percent0": 0.11043294270833333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.10000000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 0.14466836037494804, "policy_loss": -0.005256197761784318, "vf_loss": 0.14891355402657502, "vf_explained_var": 0.9190827397889988, "kl": 0.010110049088462381, "entropy": 0.26536962940327585, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 41385.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 180000, "num_env_steps_trained": 180000, "num_agent_steps_sampled": 180000, "num_agent_steps_trained": 180000}, "sampler_results": {"episode_reward_max": -1.4000000000000008, "episode_reward_min": -5.5000000000000036, "episode_reward_mean": -1.9353383458646631, "episode_len_mean": 30.045112781954888, "episode_media": {}, "episodes_this_iter": 133, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2.0000000000000013, -1.700000000000001, -1.700000000000001, -2.0000000000000013, -2.0000000000000013, -1.700000000000001, -2.3000000000000016, -1.4000000000000008, -1.700000000000001, -1.5000000000000009, -2.1000000000000014, -1.600000000000001, -1.5000000000000009, -1.9000000000000012, -2.3000000000000016, -1.9000000000000012, -1.9000000000000012, -1.5000000000000009, -2.3000000000000016, -2.2000000000000015, -1.9000000000000012, -4.800000000000003, -3.1000000000000014, -2.0000000000000013, -1.8000000000000012, -2.2000000000000015, -2.0000000000000013, -1.600000000000001, -2.0000000000000013, -2.2000000000000015, -1.700000000000001, -2.0000000000000013, -2.0000000000000013, -1.9000000000000012, -1.8000000000000012, -2.0000000000000013, -2.1000000000000014, -2.3000000000000016, -1.600000000000001, -1.5000000000000009, -1.700000000000001, -1.9000000000000012, -2.5000000000000018, -1.700000000000001, -1.700000000000001, -1.9000000000000012, -1.700000000000001, -1.9000000000000012, -2.5000000000000018, -1.700000000000001, -1.700000000000001, -1.9000000000000012, -1.5000000000000009, -1.700000000000001, -1.8000000000000012, -2.1000000000000014, -1.8000000000000012, -1.8000000000000012, -2.0000000000000013, -2.1000000000000014, -1.700000000000001, -2.2000000000000015, -2.0000000000000013, -1.700000000000001, -2.600000000000002, -1.9000000000000012, -1.600000000000001, -1.600000000000001, -1.5000000000000009, -2.0000000000000013, -1.600000000000001, -2.0000000000000013, -1.700000000000001, -1.5000000000000009, -2.5000000000000018, -2.0000000000000013, -1.700000000000001, -1.9000000000000012, -1.9000000000000012, -2.0000000000000013, -1.5000000000000009, -1.8000000000000012, -1.8000000000000012, -2.0000000000000013, -2.600000000000002, -1.5000000000000009, -1.9000000000000012, -1.600000000000001, -1.700000000000001, -1.600000000000001, -1.8000000000000012, -2.0000000000000013, -1.700000000000001, -1.8000000000000012, -2.1000000000000014, -1.8000000000000012, -1.5000000000000009, -2.2000000000000015, -1.600000000000001, -1.4000000000000008, -2.1000000000000014, -2.700000000000002, -1.700000000000001, -2.4000000000000017, -2.1000000000000014, -1.8000000000000012, -1.600000000000001, -2.2000000000000015, -2.1000000000000014, -2.1000000000000014, -2.1000000000000014, -1.8000000000000012, -1.8000000000000012, -2.1000000000000014, -2.1000000000000014, -2.2000000000000015, -1.600000000000001, -5.5000000000000036, -1.5000000000000009, -1.700000000000001, -1.700000000000001, -2.0000000000000013, -1.8000000000000012, -1.9000000000000012, -1.5000000000000009, -1.700000000000001, -1.5000000000000009, -2.0000000000000013, -1.9000000000000012, -2.0000000000000013, -1.5000000000000009, -2.0000000000000013, -1.9000000000000012], "episode_lengths": [31, 28, 28, 31, 31, 28, 34, 25, 28, 26, 32, 27, 26, 30, 34, 30, 30, 26, 34, 33, 30, 45, 39, 31, 29, 33, 31, 27, 31, 33, 28, 31, 31, 30, 29, 31, 32, 34, 27, 26, 28, 30, 34, 28, 28, 30, 28, 30, 36, 28, 28, 30, 26, 28, 29, 32, 29, 29, 31, 32, 28, 33, 31, 28, 36, 30, 27, 27, 26, 31, 27, 31, 28, 26, 36, 31, 28, 30, 30, 31, 26, 29, 29, 31, 34, 26, 30, 27, 28, 27, 29, 31, 28, 29, 32, 29, 26, 33, 27, 25, 32, 38, 28, 35, 32, 29, 27, 33, 32, 32, 32, 29, 29, 32, 32, 33, 27, 48, 26, 28, 28, 31, 29, 30, 26, 28, 26, 31, 30, 31, 26, 31, 30]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2975638644637589, "mean_inference_ms": 0.6465242663254784, "mean_action_processing_ms": 0.06998812957720592, "mean_env_wait_ms": 6.664805690650044, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006098317024403049, "StateBufferConnector_ms": 0.0038143387414459, "ViewRequirementAgentConnector_ms": 0.08588643898641256}}, "episode_reward_max": -1.4000000000000008, "episode_reward_min": -5.5000000000000036, "episode_reward_mean": -1.9353383458646631, "episode_len_mean": 30.045112781954888, "episodes_this_iter": 133, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-2.0000000000000013, -1.700000000000001, -1.700000000000001, -2.0000000000000013, -2.0000000000000013, -1.700000000000001, -2.3000000000000016, -1.4000000000000008, -1.700000000000001, -1.5000000000000009, -2.1000000000000014, -1.600000000000001, -1.5000000000000009, -1.9000000000000012, -2.3000000000000016, -1.9000000000000012, -1.9000000000000012, -1.5000000000000009, -2.3000000000000016, -2.2000000000000015, -1.9000000000000012, -4.800000000000003, -3.1000000000000014, -2.0000000000000013, -1.8000000000000012, -2.2000000000000015, -2.0000000000000013, -1.600000000000001, -2.0000000000000013, -2.2000000000000015, -1.700000000000001, -2.0000000000000013, -2.0000000000000013, -1.9000000000000012, -1.8000000000000012, -2.0000000000000013, -2.1000000000000014, -2.3000000000000016, -1.600000000000001, -1.5000000000000009, -1.700000000000001, -1.9000000000000012, -2.5000000000000018, -1.700000000000001, -1.700000000000001, -1.9000000000000012, -1.700000000000001, -1.9000000000000012, -2.5000000000000018, -1.700000000000001, -1.700000000000001, -1.9000000000000012, -1.5000000000000009, -1.700000000000001, -1.8000000000000012, -2.1000000000000014, -1.8000000000000012, -1.8000000000000012, -2.0000000000000013, -2.1000000000000014, -1.700000000000001, -2.2000000000000015, -2.0000000000000013, -1.700000000000001, -2.600000000000002, -1.9000000000000012, -1.600000000000001, -1.600000000000001, -1.5000000000000009, -2.0000000000000013, -1.600000000000001, -2.0000000000000013, -1.700000000000001, -1.5000000000000009, -2.5000000000000018, -2.0000000000000013, -1.700000000000001, -1.9000000000000012, -1.9000000000000012, -2.0000000000000013, -1.5000000000000009, -1.8000000000000012, -1.8000000000000012, -2.0000000000000013, -2.600000000000002, -1.5000000000000009, -1.9000000000000012, -1.600000000000001, -1.700000000000001, -1.600000000000001, -1.8000000000000012, -2.0000000000000013, -1.700000000000001, -1.8000000000000012, -2.1000000000000014, -1.8000000000000012, -1.5000000000000009, -2.2000000000000015, -1.600000000000001, -1.4000000000000008, -2.1000000000000014, -2.700000000000002, -1.700000000000001, -2.4000000000000017, -2.1000000000000014, -1.8000000000000012, -1.600000000000001, -2.2000000000000015, -2.1000000000000014, -2.1000000000000014, -2.1000000000000014, -1.8000000000000012, -1.8000000000000012, -2.1000000000000014, -2.1000000000000014, -2.2000000000000015, -1.600000000000001, -5.5000000000000036, -1.5000000000000009, -1.700000000000001, -1.700000000000001, -2.0000000000000013, -1.8000000000000012, -1.9000000000000012, -1.5000000000000009, -1.700000000000001, -1.5000000000000009, -2.0000000000000013, -1.9000000000000012, -2.0000000000000013, -1.5000000000000009, -2.0000000000000013, -1.9000000000000012], "episode_lengths": [31, 28, 28, 31, 31, 28, 34, 25, 28, 26, 32, 27, 26, 30, 34, 30, 30, 26, 34, 33, 30, 45, 39, 31, 29, 33, 31, 27, 31, 33, 28, 31, 31, 30, 29, 31, 32, 34, 27, 26, 28, 30, 34, 28, 28, 30, 28, 30, 36, 28, 28, 30, 26, 28, 29, 32, 29, 29, 31, 32, 28, 33, 31, 28, 36, 30, 27, 27, 26, 31, 27, 31, 28, 26, 36, 31, 28, 30, 30, 31, 26, 29, 29, 31, 34, 26, 30, 27, 28, 27, 29, 31, 28, 29, 32, 29, 26, 33, 27, 25, 32, 38, 28, 35, 32, 29, 27, 33, 32, 32, 32, 29, 29, 32, 32, 33, 27, 48, 26, 28, 28, 31, 29, 30, 26, 28, 26, 31, 30, 31, 26, 31, 30]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2975638644637589, "mean_inference_ms": 0.6465242663254784, "mean_action_processing_ms": 0.06998812957720592, "mean_env_wait_ms": 6.664805690650044, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006098317024403049, "StateBufferConnector_ms": 0.0038143387414459, "ViewRequirementAgentConnector_ms": 0.08588643898641256}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 180000, "num_agent_steps_trained": 180000, "num_env_steps_sampled": 180000, "num_env_steps_trained": 180000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 320.15988208833386, "num_env_steps_trained_throughput_per_sec": 320.15988208833386, "timesteps_total": 180000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 180000, "timers": {"training_iteration_time_ms": 12711.89, "sample_time_ms": 8886.153, "load_time_ms": 1.116, "load_throughput": 3585181.639, "learn_time_ms": 3822.098, "learn_throughput": 1046.546, "synch_weights_time_ms": 1.829}, "counters": {"num_env_steps_sampled": 180000, "num_env_steps_trained": 180000, "num_agent_steps_sampled": 180000, "num_agent_steps_trained": 180000}, "done": false, "episodes_total": 3143, "training_iteration": 45, "trial_id": "329fa_00000", "date": "2024-03-07_12-30-35", "timestamp": 1709832635, "time_this_iter_s": 12.496890306472778, "time_total_s": 511.80716705322266, "pid": 105400, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fcd19c36f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 511.80716705322266, "iterations_since_restore": 45, "perf": {"cpu_util_percent": 22.49375, "ram_util_percent": 44.65625000000001, "gpu_util_percent0": 0.080625, "vram_util_percent0": 0.11043294270833333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.10000000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 2.493822989322155, "policy_loss": -0.019569440358268318, "vf_loss": 2.509050563504539, "vf_explained_var": 0.2521801459532912, "kl": 0.04341876412694586, "entropy": 0.3284812420286158, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 42315.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 184000, "num_env_steps_trained": 184000, "num_agent_steps_sampled": 184000, "num_agent_steps_trained": 184000}, "sampler_results": {"episode_reward_max": -1.4000000000000008, "episode_reward_min": -40.0000000000003, "episode_reward_mean": -3.0120000000000084, "episode_len_mean": 40.18, "episode_media": {}, "episodes_this_iter": 97, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1.5000000000000009, -2.0000000000000013, -1.9000000000000012, -1.4000000000000008, -5.2999999999999945, -40.0000000000003, -2.3000000000000016, -2.0000000000000013, -1.5000000000000009, -1.700000000000001, -1.8000000000000012, -1.700000000000001, -1.600000000000001, -2.0000000000000013, -1.700000000000001, -1.9000000000000012, -1.5000000000000009, -1.8000000000000012, -1.600000000000001, -1.8000000000000012, -1.700000000000001, -1.8000000000000012, -2.2000000000000015, -1.600000000000001, -2.0000000000000013, -37.20000000000014, -1.4000000000000008, -1.5000000000000009, -2.2000000000000015, -1.600000000000001, -2.0000000000000013, -1.700000000000001, -1.8000000000000012, -1.8000000000000012, -1.700000000000001, -1.5000000000000009, -1.5000000000000009, -2.0000000000000013, -1.8000000000000012, -2.3000000000000016, -1.9000000000000012, -1.9000000000000012, -1.8000000000000012, -1.700000000000001, -1.600000000000001, -1.9000000000000012, -1.700000000000001, -1.8000000000000012, -1.700000000000001, -2.0000000000000013, -2.1000000000000014, -4.599999999999996, -40.0000000000003, -1.700000000000001, -1.9000000000000012, -1.8000000000000012, -1.700000000000001, -1.4000000000000008, -3.400000000000002, -1.8000000000000012, -3.0000000000000018, -1.700000000000001, -2.0000000000000013, -1.5000000000000009, -1.600000000000001, -2.2000000000000015, -2.0000000000000013, -1.4000000000000008, -1.700000000000001, -4.899999999999995, -1.600000000000001, -2.800000000000002, -1.600000000000001, -2.1000000000000014, -1.600000000000001, -1.600000000000001, -1.9000000000000012, -1.8000000000000012, -2.0000000000000013, -1.8000000000000012, -1.700000000000001, -1.4000000000000008, -1.8000000000000012, -1.700000000000001, -1.600000000000001, -1.600000000000001, -1.9000000000000012, -1.8000000000000012, -2.0000000000000013, -1.5000000000000009, -2.1000000000000014, -1.600000000000001, -1.8000000000000012, -1.4000000000000008, -1.5000000000000009, -1.600000000000001, -1.8000000000000012, -1.600000000000001, -1.8000000000000012, -1.5000000000000009], "episode_lengths": [26, 31, 30, 25, 62, 400, 30, 31, 26, 28, 29, 28, 27, 31, 28, 30, 26, 29, 27, 29, 28, 29, 33, 27, 31, 331, 25, 26, 32, 27, 31, 28, 29, 29, 28, 26, 26, 31, 29, 34, 30, 30, 29, 28, 27, 30, 28, 29, 28, 31, 32, 57, 400, 28, 30, 29, 28, 25, 38, 29, 41, 28, 31, 26, 27, 33, 31, 25, 28, 60, 27, 33, 27, 32, 27, 27, 30, 29, 31, 29, 28, 25, 29, 28, 27, 27, 30, 29, 31, 26, 32, 27, 29, 25, 26, 27, 29, 27, 29, 26]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.29906518764522977, "mean_inference_ms": 0.6477077448492103, "mean_action_processing_ms": 0.07012907901454715, "mean_env_wait_ms": 6.693403413431001, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006368160247802734, "StateBufferConnector_ms": 0.003821849822998047, "ViewRequirementAgentConnector_ms": 0.08636856079101562}}, "episode_reward_max": -1.4000000000000008, "episode_reward_min": -40.0000000000003, "episode_reward_mean": -3.0120000000000084, "episode_len_mean": 40.18, "episodes_this_iter": 97, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1.5000000000000009, -2.0000000000000013, -1.9000000000000012, -1.4000000000000008, -5.2999999999999945, -40.0000000000003, -2.3000000000000016, -2.0000000000000013, -1.5000000000000009, -1.700000000000001, -1.8000000000000012, -1.700000000000001, -1.600000000000001, -2.0000000000000013, -1.700000000000001, -1.9000000000000012, -1.5000000000000009, -1.8000000000000012, -1.600000000000001, -1.8000000000000012, -1.700000000000001, -1.8000000000000012, -2.2000000000000015, -1.600000000000001, -2.0000000000000013, -37.20000000000014, -1.4000000000000008, -1.5000000000000009, -2.2000000000000015, -1.600000000000001, -2.0000000000000013, -1.700000000000001, -1.8000000000000012, -1.8000000000000012, -1.700000000000001, -1.5000000000000009, -1.5000000000000009, -2.0000000000000013, -1.8000000000000012, -2.3000000000000016, -1.9000000000000012, -1.9000000000000012, -1.8000000000000012, -1.700000000000001, -1.600000000000001, -1.9000000000000012, -1.700000000000001, -1.8000000000000012, -1.700000000000001, -2.0000000000000013, -2.1000000000000014, -4.599999999999996, -40.0000000000003, -1.700000000000001, -1.9000000000000012, -1.8000000000000012, -1.700000000000001, -1.4000000000000008, -3.400000000000002, -1.8000000000000012, -3.0000000000000018, -1.700000000000001, -2.0000000000000013, -1.5000000000000009, -1.600000000000001, -2.2000000000000015, -2.0000000000000013, -1.4000000000000008, -1.700000000000001, -4.899999999999995, -1.600000000000001, -2.800000000000002, -1.600000000000001, -2.1000000000000014, -1.600000000000001, -1.600000000000001, -1.9000000000000012, -1.8000000000000012, -2.0000000000000013, -1.8000000000000012, -1.700000000000001, -1.4000000000000008, -1.8000000000000012, -1.700000000000001, -1.600000000000001, -1.600000000000001, -1.9000000000000012, -1.8000000000000012, -2.0000000000000013, -1.5000000000000009, -2.1000000000000014, -1.600000000000001, -1.8000000000000012, -1.4000000000000008, -1.5000000000000009, -1.600000000000001, -1.8000000000000012, -1.600000000000001, -1.8000000000000012, -1.5000000000000009], "episode_lengths": [26, 31, 30, 25, 62, 400, 30, 31, 26, 28, 29, 28, 27, 31, 28, 30, 26, 29, 27, 29, 28, 29, 33, 27, 31, 331, 25, 26, 32, 27, 31, 28, 29, 29, 28, 26, 26, 31, 29, 34, 30, 30, 29, 28, 27, 30, 28, 29, 28, 31, 32, 57, 400, 28, 30, 29, 28, 25, 38, 29, 41, 28, 31, 26, 27, 33, 31, 25, 28, 60, 27, 33, 27, 32, 27, 27, 30, 29, 31, 29, 28, 25, 29, 28, 27, 27, 30, 29, 31, 26, 32, 27, 29, 25, 26, 27, 29, 27, 29, 26]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.29906518764522977, "mean_inference_ms": 0.6477077448492103, "mean_action_processing_ms": 0.07012907901454715, "mean_env_wait_ms": 6.693403413431001, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006368160247802734, "StateBufferConnector_ms": 0.003821849822998047, "ViewRequirementAgentConnector_ms": 0.08636856079101562}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 184000, "num_agent_steps_trained": 184000, "num_env_steps_sampled": 184000, "num_env_steps_trained": 184000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 311.65272306334947, "num_env_steps_trained_throughput_per_sec": 311.65272306334947, "timesteps_total": 184000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 184000, "timers": {"training_iteration_time_ms": 12701.257, "sample_time_ms": 8888.658, "load_time_ms": 1.097, "load_throughput": 3646983.023, "learn_time_ms": 3808.972, "learn_throughput": 1050.152, "synch_weights_time_ms": 1.835}, "counters": {"num_env_steps_sampled": 184000, "num_env_steps_trained": 184000, "num_agent_steps_sampled": 184000, "num_agent_steps_trained": 184000}, "done": false, "episodes_total": 3240, "training_iteration": 46, "trial_id": "329fa_00000", "date": "2024-03-07_12-30-48", "timestamp": 1709832648, "time_this_iter_s": 12.837234258651733, "time_total_s": 524.6444013118744, "pid": 105400, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fcd19c36f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 524.6444013118744, "iterations_since_restore": 46, "perf": {"cpu_util_percent": 22.564705882352943, "ram_util_percent": 44.694117647058825, "gpu_util_percent0": 0.08764705882352941, "vram_util_percent0": 0.11029890471813726}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.15, "cur_lr": 0.0010000000000000005, "total_loss": 0.27313012890217286, "policy_loss": -0.010740298275104775, "vf_loss": 0.28238771010530733, "vf_explained_var": 0.8481793225452464, "kl": 0.009884798109854234, "entropy": 0.27690564334713, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 43245.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 188000, "num_env_steps_trained": 188000, "num_agent_steps_sampled": 188000, "num_agent_steps_trained": 188000}, "sampler_results": {"episode_reward_max": -1.4000000000000008, "episode_reward_min": -23.4, "episode_reward_mean": -2.0765151515151525, "episode_len_mean": 30.954545454545453, "episode_media": {}, "episodes_this_iter": 132, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-23.4, -1.8000000000000012, -2.0000000000000013, -1.600000000000001, -1.4000000000000008, -2.1000000000000014, -1.700000000000001, -1.8000000000000012, -2.2000000000000015, -1.5000000000000009, -2.2000000000000015, -1.9000000000000012, -1.8000000000000012, -1.600000000000001, -1.600000000000001, -1.700000000000001, -1.8000000000000012, -1.700000000000001, -1.700000000000001, -2.800000000000002, -2.1000000000000014, -3.900000000000003, -1.9000000000000012, -2.1000000000000014, -1.600000000000001, -2.2000000000000015, -1.9000000000000012, -1.600000000000001, -1.700000000000001, -2.0000000000000013, -2.2000000000000015, -1.5000000000000009, -1.8000000000000012, -1.8000000000000012, -1.700000000000001, -1.9000000000000012, -1.600000000000001, -1.700000000000001, -1.8000000000000012, -1.9000000000000012, -1.8000000000000012, -2.0000000000000013, -1.600000000000001, -10.399999999999975, -2.0000000000000013, -1.700000000000001, -2.0000000000000013, -1.4000000000000008, -1.4000000000000008, -2.4000000000000017, -1.9000000000000012, -2.0000000000000013, -1.600000000000001, -1.700000000000001, -2.1000000000000014, -1.600000000000001, -2.2000000000000015, -1.700000000000001, -1.700000000000001, -2.1000000000000014, -1.600000000000001, -1.600000000000001, -1.8000000000000012, -1.600000000000001, -1.9000000000000012, -1.8000000000000012, -2.3000000000000016, -1.5000000000000009, -4.799999999999995, -1.5000000000000009, -2.0000000000000013, -1.5000000000000009, -2.1000000000000014, -2.3000000000000016, -1.700000000000001, -1.600000000000001, -1.700000000000001, -1.700000000000001, -2.2000000000000015, -2.0000000000000013, -1.600000000000001, -1.4000000000000008, -1.8000000000000012, -2.1000000000000014, -1.700000000000001, -1.700000000000001, -1.600000000000001, -1.9000000000000012, -1.5000000000000009, -1.700000000000001, -2.0000000000000013, -1.8000000000000012, -1.5000000000000009, -1.9000000000000012, -1.5000000000000009, -2.2000000000000015, -2.0000000000000013, -1.600000000000001, -1.600000000000001, -1.5000000000000009, -2.0000000000000013, -2.0000000000000013, -1.8000000000000012, -1.8000000000000012, -2.1000000000000014, -1.700000000000001, -1.700000000000001, -1.700000000000001, -1.8000000000000012, -2.0000000000000013, -1.5000000000000009, -1.8000000000000012, -1.8000000000000012, -1.700000000000001, -1.9000000000000012, -1.700000000000001, -1.600000000000001, -2.0000000000000013, -1.700000000000001, -1.600000000000001, -1.9000000000000012, -1.700000000000001, -1.600000000000001, -1.4000000000000008, -1.700000000000001, -1.9000000000000012, -2.0000000000000013, -1.8000000000000012, -2.1000000000000014, -1.700000000000001, -1.8000000000000012, -2.3000000000000016], "episode_lengths": [154, 29, 31, 27, 25, 32, 28, 29, 33, 26, 33, 30, 29, 27, 27, 28, 29, 28, 28, 33, 32, 40, 30, 32, 27, 33, 30, 27, 28, 31, 33, 26, 29, 29, 28, 30, 27, 28, 29, 30, 29, 31, 27, 115, 31, 28, 31, 25, 25, 35, 30, 31, 27, 28, 32, 27, 33, 28, 28, 32, 27, 27, 29, 27, 30, 29, 34, 26, 59, 26, 31, 26, 32, 34, 28, 27, 28, 28, 33, 31, 27, 25, 29, 32, 28, 28, 27, 30, 26, 28, 31, 29, 26, 30, 26, 33, 31, 27, 27, 26, 31, 31, 29, 29, 32, 28, 28, 28, 29, 31, 26, 29, 29, 28, 30, 28, 27, 31, 28, 27, 30, 28, 27, 25, 28, 30, 31, 29, 32, 28, 29, 34]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3015438192137045, "mean_inference_ms": 0.6490585553402393, "mean_action_processing_ms": 0.07011354860242873, "mean_env_wait_ms": 6.706841470109012, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0063161055246988935, "StateBufferConnector_ms": 0.0038211995905095882, "ViewRequirementAgentConnector_ms": 0.08613864580790202}}, "episode_reward_max": -1.4000000000000008, "episode_reward_min": -23.4, "episode_reward_mean": -2.0765151515151525, "episode_len_mean": 30.954545454545453, "episodes_this_iter": 132, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-23.4, -1.8000000000000012, -2.0000000000000013, -1.600000000000001, -1.4000000000000008, -2.1000000000000014, -1.700000000000001, -1.8000000000000012, -2.2000000000000015, -1.5000000000000009, -2.2000000000000015, -1.9000000000000012, -1.8000000000000012, -1.600000000000001, -1.600000000000001, -1.700000000000001, -1.8000000000000012, -1.700000000000001, -1.700000000000001, -2.800000000000002, -2.1000000000000014, -3.900000000000003, -1.9000000000000012, -2.1000000000000014, -1.600000000000001, -2.2000000000000015, -1.9000000000000012, -1.600000000000001, -1.700000000000001, -2.0000000000000013, -2.2000000000000015, -1.5000000000000009, -1.8000000000000012, -1.8000000000000012, -1.700000000000001, -1.9000000000000012, -1.600000000000001, -1.700000000000001, -1.8000000000000012, -1.9000000000000012, -1.8000000000000012, -2.0000000000000013, -1.600000000000001, -10.399999999999975, -2.0000000000000013, -1.700000000000001, -2.0000000000000013, -1.4000000000000008, -1.4000000000000008, -2.4000000000000017, -1.9000000000000012, -2.0000000000000013, -1.600000000000001, -1.700000000000001, -2.1000000000000014, -1.600000000000001, -2.2000000000000015, -1.700000000000001, -1.700000000000001, -2.1000000000000014, -1.600000000000001, -1.600000000000001, -1.8000000000000012, -1.600000000000001, -1.9000000000000012, -1.8000000000000012, -2.3000000000000016, -1.5000000000000009, -4.799999999999995, -1.5000000000000009, -2.0000000000000013, -1.5000000000000009, -2.1000000000000014, -2.3000000000000016, -1.700000000000001, -1.600000000000001, -1.700000000000001, -1.700000000000001, -2.2000000000000015, -2.0000000000000013, -1.600000000000001, -1.4000000000000008, -1.8000000000000012, -2.1000000000000014, -1.700000000000001, -1.700000000000001, -1.600000000000001, -1.9000000000000012, -1.5000000000000009, -1.700000000000001, -2.0000000000000013, -1.8000000000000012, -1.5000000000000009, -1.9000000000000012, -1.5000000000000009, -2.2000000000000015, -2.0000000000000013, -1.600000000000001, -1.600000000000001, -1.5000000000000009, -2.0000000000000013, -2.0000000000000013, -1.8000000000000012, -1.8000000000000012, -2.1000000000000014, -1.700000000000001, -1.700000000000001, -1.700000000000001, -1.8000000000000012, -2.0000000000000013, -1.5000000000000009, -1.8000000000000012, -1.8000000000000012, -1.700000000000001, -1.9000000000000012, -1.700000000000001, -1.600000000000001, -2.0000000000000013, -1.700000000000001, -1.600000000000001, -1.9000000000000012, -1.700000000000001, -1.600000000000001, -1.4000000000000008, -1.700000000000001, -1.9000000000000012, -2.0000000000000013, -1.8000000000000012, -2.1000000000000014, -1.700000000000001, -1.8000000000000012, -2.3000000000000016], "episode_lengths": [154, 29, 31, 27, 25, 32, 28, 29, 33, 26, 33, 30, 29, 27, 27, 28, 29, 28, 28, 33, 32, 40, 30, 32, 27, 33, 30, 27, 28, 31, 33, 26, 29, 29, 28, 30, 27, 28, 29, 30, 29, 31, 27, 115, 31, 28, 31, 25, 25, 35, 30, 31, 27, 28, 32, 27, 33, 28, 28, 32, 27, 27, 29, 27, 30, 29, 34, 26, 59, 26, 31, 26, 32, 34, 28, 27, 28, 28, 33, 31, 27, 25, 29, 32, 28, 28, 27, 30, 26, 28, 31, 29, 26, 30, 26, 33, 31, 27, 27, 26, 31, 31, 29, 29, 32, 28, 28, 28, 29, 31, 26, 29, 29, 28, 30, 28, 27, 31, 28, 27, 30, 28, 27, 25, 28, 30, 31, 29, 32, 28, 29, 34]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3015438192137045, "mean_inference_ms": 0.6490585553402393, "mean_action_processing_ms": 0.07011354860242873, "mean_env_wait_ms": 6.706841470109012, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0063161055246988935, "StateBufferConnector_ms": 0.0038211995905095882, "ViewRequirementAgentConnector_ms": 0.08613864580790202}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 188000, "num_agent_steps_trained": 188000, "num_env_steps_sampled": 188000, "num_env_steps_trained": 188000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 318.11835632862505, "num_env_steps_trained_throughput_per_sec": 318.11835632862505, "timesteps_total": 188000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 188000, "timers": {"training_iteration_time_ms": 12590.689, "sample_time_ms": 8855.387, "load_time_ms": 1.093, "load_throughput": 3658275.223, "learn_time_ms": 3731.68, "learn_throughput": 1071.903, "synch_weights_time_ms": 1.84}, "counters": {"num_env_steps_sampled": 188000, "num_env_steps_trained": 188000, "num_agent_steps_sampled": 188000, "num_agent_steps_trained": 188000}, "done": false, "episodes_total": 3372, "training_iteration": 47, "trial_id": "329fa_00000", "date": "2024-03-07_12-31-01", "timestamp": 1709832661, "time_this_iter_s": 12.576521635055542, "time_total_s": 537.2209229469299, "pid": 105400, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fcd19c36f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 537.2209229469299, "iterations_since_restore": 47, "perf": {"cpu_util_percent": 22.700000000000003, "ram_util_percent": 44.70625, "gpu_util_percent0": 0.08, "vram_util_percent0": 0.11027018229166667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.15, "cur_lr": 0.0010000000000000005, "total_loss": 0.19526825503168266, "policy_loss": -0.039696122514664804, "vf_loss": 0.2333314851767594, "vf_explained_var": 0.8800305375488856, "kl": 0.010885939562623473, "entropy": 0.24790747771340033, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 44175.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 192000, "num_env_steps_trained": 192000, "num_agent_steps_sampled": 192000, "num_agent_steps_trained": 192000}, "sampler_results": {"episode_reward_max": -1.4000000000000008, "episode_reward_min": -4.600000000000003, "episode_reward_mean": -1.8333333333333341, "episode_len_mean": 29.14074074074074, "episode_media": {}, "episodes_this_iter": 135, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1.9000000000000012, -1.5000000000000009, -1.700000000000001, -2.1000000000000014, -1.600000000000001, -1.600000000000001, -1.8000000000000012, -1.600000000000001, -1.700000000000001, -2.0000000000000013, -1.8000000000000012, -1.8000000000000012, -2.1000000000000014, -1.700000000000001, -1.5000000000000009, -1.700000000000001, -2.3000000000000016, -1.700000000000001, -3.5, -1.600000000000001, -2.2000000000000015, -1.600000000000001, -2.0000000000000013, -1.8000000000000012, -1.4000000000000008, -1.9000000000000012, -2.2000000000000015, -2.1000000000000014, -1.5000000000000009, -1.8000000000000012, -2.1000000000000014, -1.5000000000000009, -2.2000000000000015, -1.9000000000000012, -2.0000000000000013, -1.700000000000001, -2.0000000000000013, -1.9000000000000012, -1.8000000000000012, -1.700000000000001, -1.700000000000001, -2.700000000000002, -2.5000000000000018, -2.1000000000000014, -1.8000000000000012, -1.600000000000001, -1.700000000000001, -2.2000000000000015, -1.8000000000000012, -1.5000000000000009, -1.9000000000000012, -1.9000000000000012, -1.8000000000000012, -1.4000000000000008, -1.9000000000000012, -1.600000000000001, -1.5000000000000009, -2.2000000000000015, -1.700000000000001, -1.9000000000000012, -1.600000000000001, -2.0000000000000013, -1.9000000000000012, -2.2000000000000015, -3.5000000000000018, -1.5000000000000009, -1.4000000000000008, -1.600000000000001, -1.700000000000001, -1.4000000000000008, -1.5000000000000009, -1.5000000000000009, -2.0000000000000013, -1.8000000000000012, -2.0000000000000013, -1.5000000000000009, -1.5000000000000009, -1.9000000000000012, -1.5000000000000009, -1.4000000000000008, -1.4000000000000008, -1.9000000000000012, -1.5000000000000009, -1.4000000000000008, -1.4000000000000008, -1.8000000000000012, -1.700000000000001, -1.600000000000001, -1.600000000000001, -1.700000000000001, -1.8000000000000012, -1.4000000000000008, -1.9000000000000012, -1.8000000000000012, -1.700000000000001, -1.600000000000001, -1.8000000000000012, -1.5000000000000009, -1.8000000000000012, -1.700000000000001, -1.700000000000001, -2.4000000000000017, -1.4000000000000008, -2.0000000000000013, -2.1000000000000014, -1.700000000000001, -2.1000000000000014, -1.700000000000001, -2.1000000000000014, -1.5000000000000009, -2.4000000000000017, -1.600000000000001, -1.700000000000001, -1.8000000000000012, -1.8000000000000012, -1.8000000000000012, -2.2000000000000015, -1.4000000000000008, -1.700000000000001, -1.8000000000000012, -1.4000000000000008, -1.5000000000000009, -2.2000000000000015, -1.8000000000000012, -1.5000000000000009, -3.4000000000000004, -1.600000000000001, -4.600000000000003, -2.0000000000000013, -1.600000000000001, -1.5000000000000009, -1.600000000000001, -2.0000000000000013, -1.700000000000001, -1.9000000000000012], "episode_lengths": [30, 26, 28, 32, 27, 27, 29, 27, 28, 31, 29, 29, 32, 28, 26, 28, 31, 28, 46, 27, 32, 27, 31, 29, 25, 30, 33, 32, 26, 29, 32, 26, 33, 30, 31, 28, 31, 30, 29, 28, 28, 38, 36, 32, 29, 27, 28, 33, 29, 26, 30, 30, 29, 25, 30, 27, 26, 33, 28, 30, 27, 31, 30, 33, 37, 26, 25, 27, 28, 25, 26, 26, 31, 29, 31, 26, 26, 30, 26, 25, 25, 30, 26, 25, 25, 29, 28, 27, 27, 28, 29, 25, 30, 29, 28, 27, 29, 26, 29, 28, 28, 35, 25, 31, 32, 28, 32, 28, 32, 26, 35, 27, 28, 29, 29, 29, 33, 25, 28, 29, 25, 26, 33, 29, 26, 45, 27, 44, 31, 27, 26, 27, 31, 28, 30]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.30404787371395026, "mean_inference_ms": 0.6504741325921267, "mean_action_processing_ms": 0.07021684790250646, "mean_env_wait_ms": 6.725097079125702, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006378315113208912, "StateBufferConnector_ms": 0.003943090085630064, "ViewRequirementAgentConnector_ms": 0.08705916228117766}}, "episode_reward_max": -1.4000000000000008, "episode_reward_min": -4.600000000000003, "episode_reward_mean": -1.8333333333333341, "episode_len_mean": 29.14074074074074, "episodes_this_iter": 135, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1.9000000000000012, -1.5000000000000009, -1.700000000000001, -2.1000000000000014, -1.600000000000001, -1.600000000000001, -1.8000000000000012, -1.600000000000001, -1.700000000000001, -2.0000000000000013, -1.8000000000000012, -1.8000000000000012, -2.1000000000000014, -1.700000000000001, -1.5000000000000009, -1.700000000000001, -2.3000000000000016, -1.700000000000001, -3.5, -1.600000000000001, -2.2000000000000015, -1.600000000000001, -2.0000000000000013, -1.8000000000000012, -1.4000000000000008, -1.9000000000000012, -2.2000000000000015, -2.1000000000000014, -1.5000000000000009, -1.8000000000000012, -2.1000000000000014, -1.5000000000000009, -2.2000000000000015, -1.9000000000000012, -2.0000000000000013, -1.700000000000001, -2.0000000000000013, -1.9000000000000012, -1.8000000000000012, -1.700000000000001, -1.700000000000001, -2.700000000000002, -2.5000000000000018, -2.1000000000000014, -1.8000000000000012, -1.600000000000001, -1.700000000000001, -2.2000000000000015, -1.8000000000000012, -1.5000000000000009, -1.9000000000000012, -1.9000000000000012, -1.8000000000000012, -1.4000000000000008, -1.9000000000000012, -1.600000000000001, -1.5000000000000009, -2.2000000000000015, -1.700000000000001, -1.9000000000000012, -1.600000000000001, -2.0000000000000013, -1.9000000000000012, -2.2000000000000015, -3.5000000000000018, -1.5000000000000009, -1.4000000000000008, -1.600000000000001, -1.700000000000001, -1.4000000000000008, -1.5000000000000009, -1.5000000000000009, -2.0000000000000013, -1.8000000000000012, -2.0000000000000013, -1.5000000000000009, -1.5000000000000009, -1.9000000000000012, -1.5000000000000009, -1.4000000000000008, -1.4000000000000008, -1.9000000000000012, -1.5000000000000009, -1.4000000000000008, -1.4000000000000008, -1.8000000000000012, -1.700000000000001, -1.600000000000001, -1.600000000000001, -1.700000000000001, -1.8000000000000012, -1.4000000000000008, -1.9000000000000012, -1.8000000000000012, -1.700000000000001, -1.600000000000001, -1.8000000000000012, -1.5000000000000009, -1.8000000000000012, -1.700000000000001, -1.700000000000001, -2.4000000000000017, -1.4000000000000008, -2.0000000000000013, -2.1000000000000014, -1.700000000000001, -2.1000000000000014, -1.700000000000001, -2.1000000000000014, -1.5000000000000009, -2.4000000000000017, -1.600000000000001, -1.700000000000001, -1.8000000000000012, -1.8000000000000012, -1.8000000000000012, -2.2000000000000015, -1.4000000000000008, -1.700000000000001, -1.8000000000000012, -1.4000000000000008, -1.5000000000000009, -2.2000000000000015, -1.8000000000000012, -1.5000000000000009, -3.4000000000000004, -1.600000000000001, -4.600000000000003, -2.0000000000000013, -1.600000000000001, -1.5000000000000009, -1.600000000000001, -2.0000000000000013, -1.700000000000001, -1.9000000000000012], "episode_lengths": [30, 26, 28, 32, 27, 27, 29, 27, 28, 31, 29, 29, 32, 28, 26, 28, 31, 28, 46, 27, 32, 27, 31, 29, 25, 30, 33, 32, 26, 29, 32, 26, 33, 30, 31, 28, 31, 30, 29, 28, 28, 38, 36, 32, 29, 27, 28, 33, 29, 26, 30, 30, 29, 25, 30, 27, 26, 33, 28, 30, 27, 31, 30, 33, 37, 26, 25, 27, 28, 25, 26, 26, 31, 29, 31, 26, 26, 30, 26, 25, 25, 30, 26, 25, 25, 29, 28, 27, 27, 28, 29, 25, 30, 29, 28, 27, 29, 26, 29, 28, 28, 35, 25, 31, 32, 28, 32, 28, 32, 26, 35, 27, 28, 29, 29, 29, 33, 25, 28, 29, 25, 26, 33, 29, 26, 45, 27, 44, 31, 27, 26, 27, 31, 28, 30]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.30404787371395026, "mean_inference_ms": 0.6504741325921267, "mean_action_processing_ms": 0.07021684790250646, "mean_env_wait_ms": 6.725097079125702, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006378315113208912, "StateBufferConnector_ms": 0.003943090085630064, "ViewRequirementAgentConnector_ms": 0.08705916228117766}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 192000, "num_agent_steps_trained": 192000, "num_env_steps_sampled": 192000, "num_env_steps_trained": 192000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 316.4597525888883, "num_env_steps_trained_throughput_per_sec": 316.4597525888883, "timesteps_total": 192000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 192000, "timers": {"training_iteration_time_ms": 12574.557, "sample_time_ms": 8849.2, "load_time_ms": 1.093, "load_throughput": 3658993.283, "learn_time_ms": 3721.746, "learn_throughput": 1074.764, "synch_weights_time_ms": 1.825}, "counters": {"num_env_steps_sampled": 192000, "num_env_steps_trained": 192000, "num_agent_steps_sampled": 192000, "num_agent_steps_trained": 192000}, "done": false, "episodes_total": 3507, "training_iteration": 48, "trial_id": "329fa_00000", "date": "2024-03-07_12-31-13", "timestamp": 1709832673, "time_this_iter_s": 12.64254355430603, "time_total_s": 549.863466501236, "pid": 105400, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fcd19c36f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 549.863466501236, "iterations_since_restore": 48, "perf": {"cpu_util_percent": 22.49375, "ram_util_percent": 44.61875, "gpu_util_percent0": 0.08, "vram_util_percent0": 0.1083984375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.15, "cur_lr": 0.0010000000000000005, "total_loss": 0.5437434487265124, "policy_loss": -0.010024724691925991, "vf_loss": 0.5520654840625182, "vf_explained_var": 0.7965826268478107, "kl": 0.011351248296542918, "entropy": 0.2639903094018659, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 45105.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 196000, "num_env_steps_trained": 196000, "num_agent_steps_sampled": 196000, "num_agent_steps_trained": 196000}, "sampler_results": {"episode_reward_max": -1.4000000000000008, "episode_reward_min": -11.99999999999998, "episode_reward_mean": -2.1227272727272735, "episode_len_mean": 30.96212121212121, "episode_media": {}, "episodes_this_iter": 132, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2.2000000000000015, -1.700000000000001, -1.5000000000000009, -1.4000000000000008, -1.9000000000000012, -1.700000000000001, -1.5000000000000009, -1.700000000000001, -1.700000000000001, -2.1000000000000014, -2.0000000000000013, -1.8000000000000012, -1.600000000000001, -1.700000000000001, -11.49999999999999, -1.8000000000000012, -2.0000000000000013, -1.8000000000000012, -1.9000000000000012, -1.4000000000000008, -1.5000000000000009, -7.5000000000000036, -1.600000000000001, -1.700000000000001, -1.4000000000000008, -1.8000000000000012, -1.9000000000000012, -1.8000000000000012, -1.600000000000001, -1.9000000000000012, -1.8000000000000012, -1.9000000000000012, -1.9000000000000012, -1.600000000000001, -2.5000000000000018, -1.5000000000000009, -1.8000000000000012, -2.3000000000000016, -2.0000000000000013, -1.8000000000000012, -1.9000000000000012, -2.0000000000000013, -1.5000000000000009, -1.4000000000000008, -1.600000000000001, -2.0000000000000013, -1.700000000000001, -1.9000000000000012, -2.0000000000000013, -1.700000000000001, -2.2000000000000015, -1.600000000000001, -1.700000000000001, -6.19999999999999, -1.700000000000001, -1.600000000000001, -1.600000000000001, -1.4000000000000008, -1.5000000000000009, -1.700000000000001, -3.3000000000000016, -2.2000000000000015, -1.600000000000001, -1.8000000000000012, -1.700000000000001, -1.9000000000000012, -1.700000000000001, -2.2000000000000015, -1.600000000000001, -2.2000000000000015, -1.8000000000000012, -1.700000000000001, -1.700000000000001, -1.4000000000000008, -1.8000000000000012, -1.700000000000001, -1.5000000000000009, -2.1000000000000014, -1.8000000000000012, -2.800000000000002, -1.600000000000001, -2.2000000000000015, -2.0000000000000013, -1.9000000000000012, -2.0000000000000013, -1.600000000000001, -1.700000000000001, -1.4000000000000008, -1.700000000000001, -1.700000000000001, -2.0000000000000013, -1.8000000000000012, -2.0000000000000013, -1.4000000000000008, -1.9000000000000012, -2.2000000000000015, -3.9000000000000004, -1.5000000000000009, -1.600000000000001, -11.799999999999988, -1.9000000000000012, -1.9000000000000012, -1.700000000000001, -1.700000000000001, -11.99999999999998, -1.600000000000001, -1.600000000000001, -3.8, -1.5000000000000009, -1.9000000000000012, -1.4000000000000008, -1.600000000000001, -1.700000000000001, -1.4000000000000008, -1.600000000000001, -2.2000000000000015, -2.0000000000000013, -1.600000000000001, -1.8000000000000012, -1.4000000000000008, -1.4000000000000008, -1.700000000000001, -1.8000000000000012, -2.5000000000000018, -1.8000000000000012, -1.8000000000000012, -1.5000000000000009, -1.700000000000001, -2.2000000000000015, -1.700000000000001, -1.9000000000000012, -1.9000000000000012], "episode_lengths": [33, 28, 26, 25, 30, 28, 26, 28, 28, 32, 31, 29, 27, 28, 90, 29, 31, 29, 30, 25, 26, 59, 27, 28, 25, 29, 30, 29, 27, 30, 29, 30, 30, 27, 36, 26, 29, 34, 31, 29, 30, 31, 26, 25, 27, 31, 28, 30, 31, 28, 33, 27, 28, 73, 28, 27, 27, 25, 26, 28, 43, 33, 27, 29, 28, 30, 28, 33, 27, 33, 29, 28, 28, 25, 29, 28, 26, 32, 29, 39, 27, 33, 31, 30, 31, 27, 28, 25, 28, 28, 31, 29, 31, 25, 30, 33, 45, 26, 27, 83, 30, 30, 28, 28, 90, 27, 27, 38, 26, 30, 25, 27, 28, 25, 27, 33, 31, 27, 29, 25, 25, 28, 29, 36, 29, 29, 26, 28, 33, 28, 30, 30]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3064687430509949, "mean_inference_ms": 0.6517533044721827, "mean_action_processing_ms": 0.07030547201548785, "mean_env_wait_ms": 6.744497104412248, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006224169875636246, "StateBufferConnector_ms": 0.0038575042377818713, "ViewRequirementAgentConnector_ms": 0.08709864182905717}}, "episode_reward_max": -1.4000000000000008, "episode_reward_min": -11.99999999999998, "episode_reward_mean": -2.1227272727272735, "episode_len_mean": 30.96212121212121, "episodes_this_iter": 132, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-2.2000000000000015, -1.700000000000001, -1.5000000000000009, -1.4000000000000008, -1.9000000000000012, -1.700000000000001, -1.5000000000000009, -1.700000000000001, -1.700000000000001, -2.1000000000000014, -2.0000000000000013, -1.8000000000000012, -1.600000000000001, -1.700000000000001, -11.49999999999999, -1.8000000000000012, -2.0000000000000013, -1.8000000000000012, -1.9000000000000012, -1.4000000000000008, -1.5000000000000009, -7.5000000000000036, -1.600000000000001, -1.700000000000001, -1.4000000000000008, -1.8000000000000012, -1.9000000000000012, -1.8000000000000012, -1.600000000000001, -1.9000000000000012, -1.8000000000000012, -1.9000000000000012, -1.9000000000000012, -1.600000000000001, -2.5000000000000018, -1.5000000000000009, -1.8000000000000012, -2.3000000000000016, -2.0000000000000013, -1.8000000000000012, -1.9000000000000012, -2.0000000000000013, -1.5000000000000009, -1.4000000000000008, -1.600000000000001, -2.0000000000000013, -1.700000000000001, -1.9000000000000012, -2.0000000000000013, -1.700000000000001, -2.2000000000000015, -1.600000000000001, -1.700000000000001, -6.19999999999999, -1.700000000000001, -1.600000000000001, -1.600000000000001, -1.4000000000000008, -1.5000000000000009, -1.700000000000001, -3.3000000000000016, -2.2000000000000015, -1.600000000000001, -1.8000000000000012, -1.700000000000001, -1.9000000000000012, -1.700000000000001, -2.2000000000000015, -1.600000000000001, -2.2000000000000015, -1.8000000000000012, -1.700000000000001, -1.700000000000001, -1.4000000000000008, -1.8000000000000012, -1.700000000000001, -1.5000000000000009, -2.1000000000000014, -1.8000000000000012, -2.800000000000002, -1.600000000000001, -2.2000000000000015, -2.0000000000000013, -1.9000000000000012, -2.0000000000000013, -1.600000000000001, -1.700000000000001, -1.4000000000000008, -1.700000000000001, -1.700000000000001, -2.0000000000000013, -1.8000000000000012, -2.0000000000000013, -1.4000000000000008, -1.9000000000000012, -2.2000000000000015, -3.9000000000000004, -1.5000000000000009, -1.600000000000001, -11.799999999999988, -1.9000000000000012, -1.9000000000000012, -1.700000000000001, -1.700000000000001, -11.99999999999998, -1.600000000000001, -1.600000000000001, -3.8, -1.5000000000000009, -1.9000000000000012, -1.4000000000000008, -1.600000000000001, -1.700000000000001, -1.4000000000000008, -1.600000000000001, -2.2000000000000015, -2.0000000000000013, -1.600000000000001, -1.8000000000000012, -1.4000000000000008, -1.4000000000000008, -1.700000000000001, -1.8000000000000012, -2.5000000000000018, -1.8000000000000012, -1.8000000000000012, -1.5000000000000009, -1.700000000000001, -2.2000000000000015, -1.700000000000001, -1.9000000000000012, -1.9000000000000012], "episode_lengths": [33, 28, 26, 25, 30, 28, 26, 28, 28, 32, 31, 29, 27, 28, 90, 29, 31, 29, 30, 25, 26, 59, 27, 28, 25, 29, 30, 29, 27, 30, 29, 30, 30, 27, 36, 26, 29, 34, 31, 29, 30, 31, 26, 25, 27, 31, 28, 30, 31, 28, 33, 27, 28, 73, 28, 27, 27, 25, 26, 28, 43, 33, 27, 29, 28, 30, 28, 33, 27, 33, 29, 28, 28, 25, 29, 28, 26, 32, 29, 39, 27, 33, 31, 30, 31, 27, 28, 25, 28, 28, 31, 29, 31, 25, 30, 33, 45, 26, 27, 83, 30, 30, 28, 28, 90, 27, 27, 38, 26, 30, 25, 27, 28, 25, 27, 33, 31, 27, 29, 25, 25, 28, 29, 36, 29, 29, 26, 28, 33, 28, 30, 30]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3064687430509949, "mean_inference_ms": 0.6517533044721827, "mean_action_processing_ms": 0.07030547201548785, "mean_env_wait_ms": 6.744497104412248, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006224169875636246, "StateBufferConnector_ms": 0.0038575042377818713, "ViewRequirementAgentConnector_ms": 0.08709864182905717}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 196000, "num_agent_steps_trained": 196000, "num_env_steps_sampled": 196000, "num_env_steps_trained": 196000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 313.0256725697345, "num_env_steps_trained_throughput_per_sec": 313.0256725697345, "timesteps_total": 196000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 196000, "timers": {"training_iteration_time_ms": 12596.847, "sample_time_ms": 8860.155, "load_time_ms": 1.077, "load_throughput": 3714074.205, "learn_time_ms": 3733.101, "learn_throughput": 1071.495, "synch_weights_time_ms": 1.822}, "counters": {"num_env_steps_sampled": 196000, "num_env_steps_trained": 196000, "num_agent_steps_sampled": 196000, "num_agent_steps_trained": 196000}, "done": false, "episodes_total": 3639, "training_iteration": 49, "trial_id": "329fa_00000", "date": "2024-03-07_12-31-26", "timestamp": 1709832686, "time_this_iter_s": 12.781100511550903, "time_total_s": 562.6445670127869, "pid": 105400, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fcd19c36f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 562.6445670127869, "iterations_since_restore": 49, "perf": {"cpu_util_percent": 21.799999999999997, "ram_util_percent": 44.694117647058825, "gpu_util_percent0": 0.0923529411764706, "vram_util_percent0": 0.1083984375}}
{"evaluation": {"sampler_results": {"episode_reward_max": -1.5000000000000009, "episode_reward_min": -2.600000000000002, "episode_reward_mean": -1.9450000000000016, "episode_len_mean": 30.45, "episode_media": {}, "episodes_this_iter": 20, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2.0000000000000013, -1.700000000000001, -2.0000000000000013, -1.9000000000000012, -2.3000000000000016, -1.9000000000000012, -1.5000000000000009, -2.0000000000000013, -2.1000000000000014, -2.600000000000002, -2.4000000000000017, -1.8000000000000012, -1.8000000000000012, -1.8000000000000012, -2.0000000000000013, -1.8000000000000012, -1.8000000000000012, -1.700000000000001, -1.8000000000000012, -2.0000000000000013], "episode_lengths": [31, 28, 31, 30, 34, 30, 26, 31, 32, 37, 35, 29, 29, 29, 31, 29, 29, 28, 29, 31]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3952776799436475, "mean_inference_ms": 1.3462051016385437, "mean_action_processing_ms": 0.0744069208864306, "mean_env_wait_ms": 7.4806514333506104, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005593299865722656, "StateBufferConnector_ms": 0.0032722949981689453, "ViewRequirementAgentConnector_ms": 0.07615208625793457}}, "episode_reward_max": -1.5000000000000009, "episode_reward_min": -2.600000000000002, "episode_reward_mean": -1.9450000000000016, "episode_len_mean": 30.45, "episode_media": {}, "episodes_this_iter": 20, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2.0000000000000013, -1.700000000000001, -2.0000000000000013, -1.9000000000000012, -2.3000000000000016, -1.9000000000000012, -1.5000000000000009, -2.0000000000000013, -2.1000000000000014, -2.600000000000002, -2.4000000000000017, -1.8000000000000012, -1.8000000000000012, -1.8000000000000012, -2.0000000000000013, -1.8000000000000012, -1.8000000000000012, -1.700000000000001, -1.8000000000000012, -2.0000000000000013], "episode_lengths": [31, 28, 31, 30, 34, 30, 26, 31, 32, 37, 35, 29, 29, 29, 31, 29, 29, 28, 29, 31]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3952776799436475, "mean_inference_ms": 1.3462051016385437, "mean_action_processing_ms": 0.0744069208864306, "mean_env_wait_ms": 7.4806514333506104, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005593299865722656, "StateBufferConnector_ms": 0.0032722949981689453, "ViewRequirementAgentConnector_ms": 0.07615208625793457}, "num_agent_steps_sampled_this_iter": 609, "num_env_steps_sampled_this_iter": 609, "timesteps_this_iter": 609, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.15, "cur_lr": 0.0010000000000000005, "total_loss": 0.16446170693379827, "policy_loss": -0.007170450881684339, "vf_loss": 0.1705854036089193, "vf_explained_var": 0.8917147123044536, "kl": 0.006978370053640815, "entropy": 0.2465205656584873, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 46035.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 200000, "num_env_steps_trained": 200000, "num_agent_steps_sampled": 200000, "num_agent_steps_trained": 200000}, "sampler_results": {"episode_reward_max": -1.4000000000000008, "episode_reward_min": -6.099999999999999, "episode_reward_mean": -1.8357664233576654, "episode_len_mean": 29.10948905109489, "episode_media": {}, "episodes_this_iter": 137, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1.8000000000000012, -2.5000000000000018, -1.700000000000001, -1.700000000000001, -1.5000000000000009, -1.8000000000000012, -1.600000000000001, -1.4000000000000008, -2.0000000000000013, -1.8000000000000012, -1.8000000000000012, -1.9000000000000012, -2.3000000000000016, -1.9000000000000012, -1.700000000000001, -1.5000000000000009, -2.2000000000000015, -1.600000000000001, -1.600000000000001, -1.9000000000000012, -1.5000000000000009, -2.0000000000000013, -1.9000000000000012, -1.4000000000000008, -1.600000000000001, -1.8000000000000012, -1.700000000000001, -2.0000000000000013, -1.700000000000001, -1.600000000000001, -2.3000000000000016, -1.8000000000000012, -1.9000000000000012, -1.600000000000001, -1.4000000000000008, -1.9000000000000012, -1.700000000000001, -1.700000000000001, -1.8000000000000012, -1.700000000000001, -1.8000000000000012, -1.600000000000001, -1.8000000000000012, -2.0000000000000013, -1.600000000000001, -1.8000000000000012, -1.4000000000000008, -1.8000000000000012, -1.600000000000001, -1.700000000000001, -1.5000000000000009, -1.5000000000000009, -1.9000000000000012, -1.5000000000000009, -1.9000000000000012, -1.5000000000000009, -2.5000000000000018, -2.0000000000000013, -2.1000000000000014, -1.600000000000001, -1.5000000000000009, -2.5000000000000018, -1.4000000000000008, -1.5000000000000009, -1.5000000000000009, -1.600000000000001, -1.4000000000000008, -1.5000000000000009, -1.5000000000000009, -1.9000000000000012, -2.0000000000000013, -1.8000000000000012, -1.700000000000001, -2.2000000000000015, -1.700000000000001, -1.8000000000000012, -2.0000000000000013, -2.2000000000000015, -2.0000000000000013, -1.700000000000001, -1.700000000000001, -1.600000000000001, -2.2000000000000015, -2.2000000000000015, -1.600000000000001, -1.5000000000000009, -1.8000000000000012, -1.5000000000000009, -1.8000000000000012, -1.600000000000001, -2.0000000000000013, -1.600000000000001, -1.600000000000001, -1.600000000000001, -2.3000000000000016, -1.5000000000000009, -2.1000000000000014, -1.8000000000000012, -2.3000000000000016, -6.099999999999999, -1.9000000000000012, -2.0000000000000013, -2.2000000000000015, -1.4000000000000008, -1.4000000000000008, -3.6999999999999993, -1.600000000000001, -1.700000000000001, -1.8000000000000012, -2.2000000000000015, -1.700000000000001, -1.600000000000001, -1.5000000000000009, -1.4000000000000008, -1.8000000000000012, -1.4000000000000008, -1.9000000000000012, -1.9000000000000012, -1.9000000000000012, -1.5000000000000009, -1.700000000000001, -1.600000000000001, -1.9000000000000012, -1.8000000000000012, -1.8000000000000012, -1.600000000000001, -1.8000000000000012, -1.600000000000001, -2.2000000000000015, -1.600000000000001, -1.5000000000000009, -2.0000000000000013, -4.600000000000002, -1.700000000000001, -2.2000000000000015, -1.700000000000001, -1.600000000000001], "episode_lengths": [29, 36, 28, 28, 26, 29, 27, 25, 31, 29, 29, 30, 34, 30, 28, 26, 33, 27, 27, 30, 26, 31, 30, 25, 27, 29, 28, 31, 28, 27, 34, 29, 30, 27, 25, 30, 28, 28, 29, 28, 29, 27, 29, 31, 27, 29, 25, 29, 27, 28, 26, 26, 30, 26, 30, 26, 36, 31, 32, 27, 26, 36, 25, 26, 26, 27, 25, 26, 26, 30, 31, 29, 28, 33, 28, 29, 31, 33, 31, 28, 28, 27, 33, 33, 27, 26, 29, 26, 29, 27, 31, 27, 27, 27, 34, 26, 32, 29, 34, 56, 30, 31, 33, 25, 25, 43, 27, 28, 29, 33, 28, 27, 26, 25, 29, 25, 30, 30, 30, 26, 28, 27, 30, 29, 29, 27, 29, 27, 33, 27, 26, 31, 46, 28, 31, 28, 27]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.30881904920545467, "mean_inference_ms": 0.6527899842731802, "mean_action_processing_ms": 0.07037099766703736, "mean_env_wait_ms": 6.76046147729378, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006314437754832915, "StateBufferConnector_ms": 0.003907454274866703, "ViewRequirementAgentConnector_ms": 0.08589142430437742}}, "episode_reward_max": -1.4000000000000008, "episode_reward_min": -6.099999999999999, "episode_reward_mean": -1.8357664233576654, "episode_len_mean": 29.10948905109489, "episodes_this_iter": 137, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1.8000000000000012, -2.5000000000000018, -1.700000000000001, -1.700000000000001, -1.5000000000000009, -1.8000000000000012, -1.600000000000001, -1.4000000000000008, -2.0000000000000013, -1.8000000000000012, -1.8000000000000012, -1.9000000000000012, -2.3000000000000016, -1.9000000000000012, -1.700000000000001, -1.5000000000000009, -2.2000000000000015, -1.600000000000001, -1.600000000000001, -1.9000000000000012, -1.5000000000000009, -2.0000000000000013, -1.9000000000000012, -1.4000000000000008, -1.600000000000001, -1.8000000000000012, -1.700000000000001, -2.0000000000000013, -1.700000000000001, -1.600000000000001, -2.3000000000000016, -1.8000000000000012, -1.9000000000000012, -1.600000000000001, -1.4000000000000008, -1.9000000000000012, -1.700000000000001, -1.700000000000001, -1.8000000000000012, -1.700000000000001, -1.8000000000000012, -1.600000000000001, -1.8000000000000012, -2.0000000000000013, -1.600000000000001, -1.8000000000000012, -1.4000000000000008, -1.8000000000000012, -1.600000000000001, -1.700000000000001, -1.5000000000000009, -1.5000000000000009, -1.9000000000000012, -1.5000000000000009, -1.9000000000000012, -1.5000000000000009, -2.5000000000000018, -2.0000000000000013, -2.1000000000000014, -1.600000000000001, -1.5000000000000009, -2.5000000000000018, -1.4000000000000008, -1.5000000000000009, -1.5000000000000009, -1.600000000000001, -1.4000000000000008, -1.5000000000000009, -1.5000000000000009, -1.9000000000000012, -2.0000000000000013, -1.8000000000000012, -1.700000000000001, -2.2000000000000015, -1.700000000000001, -1.8000000000000012, -2.0000000000000013, -2.2000000000000015, -2.0000000000000013, -1.700000000000001, -1.700000000000001, -1.600000000000001, -2.2000000000000015, -2.2000000000000015, -1.600000000000001, -1.5000000000000009, -1.8000000000000012, -1.5000000000000009, -1.8000000000000012, -1.600000000000001, -2.0000000000000013, -1.600000000000001, -1.600000000000001, -1.600000000000001, -2.3000000000000016, -1.5000000000000009, -2.1000000000000014, -1.8000000000000012, -2.3000000000000016, -6.099999999999999, -1.9000000000000012, -2.0000000000000013, -2.2000000000000015, -1.4000000000000008, -1.4000000000000008, -3.6999999999999993, -1.600000000000001, -1.700000000000001, -1.8000000000000012, -2.2000000000000015, -1.700000000000001, -1.600000000000001, -1.5000000000000009, -1.4000000000000008, -1.8000000000000012, -1.4000000000000008, -1.9000000000000012, -1.9000000000000012, -1.9000000000000012, -1.5000000000000009, -1.700000000000001, -1.600000000000001, -1.9000000000000012, -1.8000000000000012, -1.8000000000000012, -1.600000000000001, -1.8000000000000012, -1.600000000000001, -2.2000000000000015, -1.600000000000001, -1.5000000000000009, -2.0000000000000013, -4.600000000000002, -1.700000000000001, -2.2000000000000015, -1.700000000000001, -1.600000000000001], "episode_lengths": [29, 36, 28, 28, 26, 29, 27, 25, 31, 29, 29, 30, 34, 30, 28, 26, 33, 27, 27, 30, 26, 31, 30, 25, 27, 29, 28, 31, 28, 27, 34, 29, 30, 27, 25, 30, 28, 28, 29, 28, 29, 27, 29, 31, 27, 29, 25, 29, 27, 28, 26, 26, 30, 26, 30, 26, 36, 31, 32, 27, 26, 36, 25, 26, 26, 27, 25, 26, 26, 30, 31, 29, 28, 33, 28, 29, 31, 33, 31, 28, 28, 27, 33, 33, 27, 26, 29, 26, 29, 27, 31, 27, 27, 27, 34, 26, 32, 29, 34, 56, 30, 31, 33, 25, 25, 43, 27, 28, 29, 33, 28, 27, 26, 25, 29, 25, 30, 30, 30, 26, 28, 27, 30, 29, 29, 27, 29, 27, 33, 27, 26, 31, 46, 28, 31, 28, 27]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.30881904920545467, "mean_inference_ms": 0.6527899842731802, "mean_action_processing_ms": 0.07037099766703736, "mean_env_wait_ms": 6.76046147729378, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006314437754832915, "StateBufferConnector_ms": 0.003907454274866703, "ViewRequirementAgentConnector_ms": 0.08589142430437742}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 200000, "num_agent_steps_trained": 200000, "num_env_steps_sampled": 200000, "num_env_steps_trained": 200000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 317.8767553668509, "num_env_steps_trained_throughput_per_sec": 317.8767553668509, "timesteps_total": 200000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 200000, "timers": {"training_iteration_time_ms": 12613.045, "sample_time_ms": 8880.249, "load_time_ms": 1.084, "load_throughput": 3690544.655, "learn_time_ms": 3729.243, "learn_throughput": 1072.604, "synch_weights_time_ms": 1.79}, "counters": {"num_env_steps_sampled": 200000, "num_env_steps_trained": 200000, "num_agent_steps_sampled": 200000, "num_agent_steps_trained": 200000}, "done": true, "episodes_total": 3776, "training_iteration": 50, "trial_id": "329fa_00000", "date": "2024-03-07_12-31-44", "timestamp": 1709832704, "time_this_iter_s": 18.271039247512817, "time_total_s": 580.9156062602997, "pid": 105400, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fcd19c36f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 580.9156062602997, "iterations_since_restore": 50, "perf": {"cpu_util_percent": 18.083333333333332, "ram_util_percent": 44.708333333333336, "gpu_util_percent0": 0.07541666666666667, "vram_util_percent0": 0.1083984375}}
