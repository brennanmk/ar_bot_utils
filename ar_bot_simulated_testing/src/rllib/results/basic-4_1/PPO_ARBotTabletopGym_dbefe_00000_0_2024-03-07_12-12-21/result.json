{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 8.107651771332629, "policy_loss": 0.009268379011141357, "vf_loss": 8.097356964054928, "vf_explained_var": 0.005751463995184949, "kl": 0.005132147543843181, "entropy": 1.0934837316954007, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 465.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000}, "sampler_results": {"episode_reward_max": -8.299999999999988, "episode_reward_min": -70.30000000000047, "episode_reward_mean": -47.97000000000023, "episode_len_mean": 310.2, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-58.70000000000034, -38.60000000000012, -64.70000000000037, -49.000000000000185, -8.299999999999988, -69.70000000000044, -18.199999999999964, -37.00000000000002, -70.30000000000047, -65.20000000000047], "episode_lengths": [400, 297, 400, 333, 83, 400, 136, 253, 400, 400]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1944409502850665, "mean_inference_ms": 0.6106818234408415, "mean_action_processing_ms": 0.06849753868567957, "mean_env_wait_ms": 6.235423645415864, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005724430084228516, "StateBufferConnector_ms": 0.0032520294189453125, "ViewRequirementAgentConnector_ms": 0.07155895233154297}}, "episode_reward_max": -8.299999999999988, "episode_reward_min": -70.30000000000047, "episode_reward_mean": -47.97000000000023, "episode_len_mean": 310.2, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-58.70000000000034, -38.60000000000012, -64.70000000000037, -49.000000000000185, -8.299999999999988, -69.70000000000044, -18.199999999999964, -37.00000000000002, -70.30000000000047, -65.20000000000047], "episode_lengths": [400, 297, 400, 333, 83, 400, 136, 253, 400, 400]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1944409502850665, "mean_inference_ms": 0.6106818234408415, "mean_action_processing_ms": 0.06849753868567957, "mean_env_wait_ms": 6.235423645415864, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005724430084228516, "StateBufferConnector_ms": 0.0032520294189453125, "ViewRequirementAgentConnector_ms": 0.07155895233154297}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 371.96168229870733, "num_env_steps_trained_throughput_per_sec": 371.96168229870733, "timesteps_total": 4000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 4000, "timers": {"training_iteration_time_ms": 10753.737, "sample_time_ms": 7211.758, "load_time_ms": 0.911, "load_throughput": 4390791.939, "learn_time_ms": 3538.561, "learn_throughput": 1130.403, "synch_weights_time_ms": 1.705}, "counters": {"num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000}, "done": false, "episodes_total": 10, "training_iteration": 1, "trial_id": "dbefe_00000", "date": "2024-03-07_12-12-38", "timestamp": 1709831558, "time_this_iter_s": 10.755605697631836, "time_total_s": 10.755605697631836, "pid": 103980, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fcd19c36f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 10.755605697631836, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 18.24, "ram_util_percent": 43.800000000000004, "gpu_util_percent0": 0.084, "vram_util_percent0": 0.09825303819444446}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 5.28903959502456, "policy_loss": -0.011858296730825979, "vf_loss": 5.299667235311642, "vf_explained_var": -0.2416685127442883, "kl": 0.006153240258131812, "entropy": 1.0833638023304684, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 1395.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000}, "sampler_results": {"episode_reward_max": -8.299999999999988, "episode_reward_min": -70.30000000000047, "episode_reward_mean": -47.781818181818444, "episode_len_mean": 328.59090909090907, "episode_media": {}, "episodes_this_iter": 12, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-58.70000000000034, -38.60000000000012, -64.70000000000037, -49.000000000000185, -8.299999999999988, -69.70000000000044, -18.199999999999964, -37.00000000000002, -70.30000000000047, -65.20000000000047, -61.90000000000046, -60.40000000000031, -28.700000000000085, -54.00000000000041, -59.900000000000475, -54.5000000000003, -57.000000000000476, -56.500000000000355, -12.899999999999967, -47.500000000000234, -19.4, -58.80000000000042], "episode_lengths": [400, 297, 400, 333, 83, 400, 136, 253, 400, 400, 400, 400, 234, 400, 400, 400, 400, 400, 128, 400, 165, 400]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2081533847440977, "mean_inference_ms": 0.6141478086082879, "mean_action_processing_ms": 0.06849038642079736, "mean_env_wait_ms": 6.2535771754323175, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005822831934148615, "StateBufferConnector_ms": 0.0032565810463645243, "ViewRequirementAgentConnector_ms": 0.07381439208984375}}, "episode_reward_max": -8.299999999999988, "episode_reward_min": -70.30000000000047, "episode_reward_mean": -47.781818181818444, "episode_len_mean": 328.59090909090907, "episodes_this_iter": 12, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-58.70000000000034, -38.60000000000012, -64.70000000000037, -49.000000000000185, -8.299999999999988, -69.70000000000044, -18.199999999999964, -37.00000000000002, -70.30000000000047, -65.20000000000047, -61.90000000000046, -60.40000000000031, -28.700000000000085, -54.00000000000041, -59.900000000000475, -54.5000000000003, -57.000000000000476, -56.500000000000355, -12.899999999999967, -47.500000000000234, -19.4, -58.80000000000042], "episode_lengths": [400, 297, 400, 333, 83, 400, 136, 253, 400, 400, 400, 400, 234, 400, 400, 400, 400, 400, 128, 400, 165, 400]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2081533847440977, "mean_inference_ms": 0.6141478086082879, "mean_action_processing_ms": 0.06849038642079736, "mean_env_wait_ms": 6.2535771754323175, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005822831934148615, "StateBufferConnector_ms": 0.0032565810463645243, "ViewRequirementAgentConnector_ms": 0.07381439208984375}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 368.65554545552027, "num_env_steps_trained_throughput_per_sec": 368.65554545552027, "timesteps_total": 8000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 8000, "timers": {"training_iteration_time_ms": 10801.972, "sample_time_ms": 7297.392, "load_time_ms": 0.916, "load_throughput": 4367360.666, "learn_time_ms": 3501.325, "learn_throughput": 1142.425, "synch_weights_time_ms": 1.65}, "counters": {"num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000}, "done": false, "episodes_total": 22, "training_iteration": 2, "trial_id": "dbefe_00000", "date": "2024-03-07_12-12-49", "timestamp": 1709831569, "time_this_iter_s": 10.852122783660889, "time_total_s": 21.607728481292725, "pid": 103980, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fcd19c36f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 21.607728481292725, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 20.95714285714286, "ram_util_percent": 44.16428571428572, "gpu_util_percent0": 0.08357142857142856, "vram_util_percent0": 0.09879557291666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 4.501584840814273, "policy_loss": -0.009952692078646793, "vf_loss": 4.510672652721405, "vf_explained_var": -0.31001083613723834, "kl": 0.004324413725290463, "entropy": 1.0784098107327698, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 2325.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000}, "sampler_results": {"episode_reward_max": -6.999999999999992, "episode_reward_min": -70.30000000000047, "episode_reward_mean": -49.03030303030332, "episode_len_mean": 342.57575757575756, "episode_media": {}, "episodes_this_iter": 11, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-58.70000000000034, -38.60000000000012, -64.70000000000037, -49.000000000000185, -8.299999999999988, -69.70000000000044, -18.199999999999964, -37.00000000000002, -70.30000000000047, -65.20000000000047, -61.90000000000046, -60.40000000000031, -28.700000000000085, -54.00000000000041, -59.900000000000475, -54.5000000000003, -57.000000000000476, -56.500000000000355, -12.899999999999967, -47.500000000000234, -19.4, -58.80000000000042, -62.00000000000045, -45.40000000000033, -6.999999999999992, -60.70000000000034, -55.600000000000314, -69.50000000000044, -44.30000000000033, -45.00000000000036, -64.0000000000004, -52.20000000000043, -61.100000000000335], "episode_lengths": [400, 297, 400, 333, 83, 400, 136, 253, 400, 400, 400, 400, 234, 400, 400, 400, 400, 400, 128, 400, 165, 400, 400, 400, 76, 400, 400, 400, 400, 400, 400, 400, 400]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20951145654356274, "mean_inference_ms": 0.6145468887402211, "mean_action_processing_ms": 0.06838382590581421, "mean_env_wait_ms": 6.244154376280955, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005917838125517874, "StateBufferConnector_ms": 0.0032403252341530538, "ViewRequirementAgentConnector_ms": 0.07292285110011246}}, "episode_reward_max": -6.999999999999992, "episode_reward_min": -70.30000000000047, "episode_reward_mean": -49.03030303030332, "episode_len_mean": 342.57575757575756, "episodes_this_iter": 11, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-58.70000000000034, -38.60000000000012, -64.70000000000037, -49.000000000000185, -8.299999999999988, -69.70000000000044, -18.199999999999964, -37.00000000000002, -70.30000000000047, -65.20000000000047, -61.90000000000046, -60.40000000000031, -28.700000000000085, -54.00000000000041, -59.900000000000475, -54.5000000000003, -57.000000000000476, -56.500000000000355, -12.899999999999967, -47.500000000000234, -19.4, -58.80000000000042, -62.00000000000045, -45.40000000000033, -6.999999999999992, -60.70000000000034, -55.600000000000314, -69.50000000000044, -44.30000000000033, -45.00000000000036, -64.0000000000004, -52.20000000000043, -61.100000000000335], "episode_lengths": [400, 297, 400, 333, 83, 400, 136, 253, 400, 400, 400, 400, 234, 400, 400, 400, 400, 400, 128, 400, 165, 400, 400, 400, 76, 400, 400, 400, 400, 400, 400, 400, 400]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20951145654356274, "mean_inference_ms": 0.6145468887402211, "mean_action_processing_ms": 0.06838382590581421, "mean_env_wait_ms": 6.244154376280955, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005917838125517874, "StateBufferConnector_ms": 0.0032403252341530538, "ViewRequirementAgentConnector_ms": 0.07292285110011246}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 375.5335173170943, "num_env_steps_trained_throughput_per_sec": 375.5335173170943, "timesteps_total": 12000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 12000, "timers": {"training_iteration_time_ms": 10751.802, "sample_time_ms": 7253.074, "load_time_ms": 0.93, "load_throughput": 4302217.967, "learn_time_ms": 3495.408, "learn_throughput": 1144.359, "synch_weights_time_ms": 1.721}, "counters": {"num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000}, "done": false, "episodes_total": 33, "training_iteration": 3, "trial_id": "dbefe_00000", "date": "2024-03-07_12-13-00", "timestamp": 1709831580, "time_this_iter_s": 10.653561115264893, "time_total_s": 32.26128959655762, "pid": 103980, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fcd19c36f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 32.26128959655762, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 19.414285714285707, "ram_util_percent": 44.2, "gpu_util_percent0": 0.08857142857142856, "vram_util_percent0": 0.09879557291666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.10000000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 5.460339961064759, "policy_loss": -0.012169190608365561, "vf_loss": 5.471812753042867, "vf_explained_var": -0.2420834218942991, "kl": 0.006963931810177186, "entropy": 1.0608298054946366, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 3255.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000}, "sampler_results": {"episode_reward_max": -6.099999999999991, "episode_reward_min": -70.30000000000047, "episode_reward_mean": -45.040425531915155, "episode_len_mean": 324.3829787234043, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-58.70000000000034, -38.60000000000012, -64.70000000000037, -49.000000000000185, -8.299999999999988, -69.70000000000044, -18.199999999999964, -37.00000000000002, -70.30000000000047, -65.20000000000047, -61.90000000000046, -60.40000000000031, -28.700000000000085, -54.00000000000041, -59.900000000000475, -54.5000000000003, -57.000000000000476, -56.500000000000355, -12.899999999999967, -47.500000000000234, -19.4, -58.80000000000042, -62.00000000000045, -45.40000000000033, -6.999999999999992, -60.70000000000034, -55.600000000000314, -69.50000000000044, -44.30000000000033, -45.00000000000036, -64.0000000000004, -52.20000000000043, -61.100000000000335, -50.500000000000334, -58.700000000000344, -7.399999999999986, -22.00000000000003, -57.40000000000028, -11.59999999999998, -42.80000000000032, -6.999999999999988, -6.099999999999991, -48.100000000000264, -43.50000000000032, -53.800000000000416, -25.199999999999946, -64.80000000000041], "episode_lengths": [400, 297, 400, 333, 83, 400, 136, 253, 400, 400, 400, 400, 234, 400, 400, 400, 400, 400, 128, 400, 165, 400, 400, 400, 76, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 85, 223, 400, 101, 400, 81, 72, 400, 400, 400, 179, 400]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20826800233316833, "mean_inference_ms": 0.6142967019797706, "mean_action_processing_ms": 0.06820979396052064, "mean_env_wait_ms": 6.224570507242822, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005624142098934092, "StateBufferConnector_ms": 0.003174518017058677, "ViewRequirementAgentConnector_ms": 0.07250714809336561}}, "episode_reward_max": -6.099999999999991, "episode_reward_min": -70.30000000000047, "episode_reward_mean": -45.040425531915155, "episode_len_mean": 324.3829787234043, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-58.70000000000034, -38.60000000000012, -64.70000000000037, -49.000000000000185, -8.299999999999988, -69.70000000000044, -18.199999999999964, -37.00000000000002, -70.30000000000047, -65.20000000000047, -61.90000000000046, -60.40000000000031, -28.700000000000085, -54.00000000000041, -59.900000000000475, -54.5000000000003, -57.000000000000476, -56.500000000000355, -12.899999999999967, -47.500000000000234, -19.4, -58.80000000000042, -62.00000000000045, -45.40000000000033, -6.999999999999992, -60.70000000000034, -55.600000000000314, -69.50000000000044, -44.30000000000033, -45.00000000000036, -64.0000000000004, -52.20000000000043, -61.100000000000335, -50.500000000000334, -58.700000000000344, -7.399999999999986, -22.00000000000003, -57.40000000000028, -11.59999999999998, -42.80000000000032, -6.999999999999988, -6.099999999999991, -48.100000000000264, -43.50000000000032, -53.800000000000416, -25.199999999999946, -64.80000000000041], "episode_lengths": [400, 297, 400, 333, 83, 400, 136, 253, 400, 400, 400, 400, 234, 400, 400, 400, 400, 400, 128, 400, 165, 400, 400, 400, 76, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 85, 223, 400, 101, 400, 81, 72, 400, 400, 400, 179, 400]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20826800233316833, "mean_inference_ms": 0.6142967019797706, "mean_action_processing_ms": 0.06820979396052064, "mean_env_wait_ms": 6.224570507242822, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005624142098934092, "StateBufferConnector_ms": 0.003174518017058677, "ViewRequirementAgentConnector_ms": 0.07250714809336561}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 382.83200488207774, "num_env_steps_trained_throughput_per_sec": 382.83200488207774, "timesteps_total": 16000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 16000, "timers": {"training_iteration_time_ms": 10675.956, "sample_time_ms": 7188.634, "load_time_ms": 0.936, "load_throughput": 4271729.09, "learn_time_ms": 3484.037, "learn_throughput": 1148.094, "synch_weights_time_ms": 1.703}, "counters": {"num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000}, "done": false, "episodes_total": 47, "training_iteration": 4, "trial_id": "dbefe_00000", "date": "2024-03-07_12-13-10", "timestamp": 1709831590, "time_this_iter_s": 10.45042371749878, "time_total_s": 42.7117133140564, "pid": 103980, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fcd19c36f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 42.7117133140564, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 20.02307692307692, "ram_util_percent": 44.21538461538462, "gpu_util_percent0": 0.07846153846153846, "vram_util_percent0": 0.09879557291666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.10000000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 5.065085146760428, "policy_loss": -0.008974372403275583, "vf_loss": 5.073366732142305, "vf_explained_var": -0.2090355094402067, "kl": 0.006927948217751402, "entropy": 1.0515938152549087, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 4185.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 20000}, "sampler_results": {"episode_reward_max": -4.999999999999995, "episode_reward_min": -70.30000000000047, "episode_reward_mean": -44.131666666666916, "episode_len_mean": 324.6166666666667, "episode_media": {}, "episodes_this_iter": 13, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-58.70000000000034, -38.60000000000012, -64.70000000000037, -49.000000000000185, -8.299999999999988, -69.70000000000044, -18.199999999999964, -37.00000000000002, -70.30000000000047, -65.20000000000047, -61.90000000000046, -60.40000000000031, -28.700000000000085, -54.00000000000041, -59.900000000000475, -54.5000000000003, -57.000000000000476, -56.500000000000355, -12.899999999999967, -47.500000000000234, -19.4, -58.80000000000042, -62.00000000000045, -45.40000000000033, -6.999999999999992, -60.70000000000034, -55.600000000000314, -69.50000000000044, -44.30000000000033, -45.00000000000036, -64.0000000000004, -52.20000000000043, -61.100000000000335, -50.500000000000334, -58.700000000000344, -7.399999999999986, -22.00000000000003, -57.40000000000028, -11.59999999999998, -42.80000000000032, -6.999999999999988, -6.099999999999991, -48.100000000000264, -43.50000000000032, -53.800000000000416, -25.199999999999946, -64.80000000000041, -51.80000000000029, -50.50000000000037, -9.799999999999978, -4.999999999999995, -49.700000000000266, -41.70000000000029, -54.90000000000029, -53.00000000000031, -46.60000000000021, -50.20000000000036, -7.699999999999989, -54.00000000000027, -56.10000000000032], "episode_lengths": [400, 297, 400, 333, 83, 400, 136, 253, 400, 400, 400, 400, 234, 400, 400, 400, 400, 400, 128, 400, 165, 400, 400, 400, 76, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 85, 223, 400, 101, 400, 81, 72, 400, 400, 400, 179, 400, 389, 400, 97, 61, 400, 400, 400, 400, 400, 400, 84, 400, 400]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20743666989500828, "mean_inference_ms": 0.6141663881482246, "mean_action_processing_ms": 0.06811745704859366, "mean_env_wait_ms": 6.212165655852049, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005581776301066081, "StateBufferConnector_ms": 0.0031669934590657554, "ViewRequirementAgentConnector_ms": 0.0726008415222168}}, "episode_reward_max": -4.999999999999995, "episode_reward_min": -70.30000000000047, "episode_reward_mean": -44.131666666666916, "episode_len_mean": 324.6166666666667, "episodes_this_iter": 13, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-58.70000000000034, -38.60000000000012, -64.70000000000037, -49.000000000000185, -8.299999999999988, -69.70000000000044, -18.199999999999964, -37.00000000000002, -70.30000000000047, -65.20000000000047, -61.90000000000046, -60.40000000000031, -28.700000000000085, -54.00000000000041, -59.900000000000475, -54.5000000000003, -57.000000000000476, -56.500000000000355, -12.899999999999967, -47.500000000000234, -19.4, -58.80000000000042, -62.00000000000045, -45.40000000000033, -6.999999999999992, -60.70000000000034, -55.600000000000314, -69.50000000000044, -44.30000000000033, -45.00000000000036, -64.0000000000004, -52.20000000000043, -61.100000000000335, -50.500000000000334, -58.700000000000344, -7.399999999999986, -22.00000000000003, -57.40000000000028, -11.59999999999998, -42.80000000000032, -6.999999999999988, -6.099999999999991, -48.100000000000264, -43.50000000000032, -53.800000000000416, -25.199999999999946, -64.80000000000041, -51.80000000000029, -50.50000000000037, -9.799999999999978, -4.999999999999995, -49.700000000000266, -41.70000000000029, -54.90000000000029, -53.00000000000031, -46.60000000000021, -50.20000000000036, -7.699999999999989, -54.00000000000027, -56.10000000000032], "episode_lengths": [400, 297, 400, 333, 83, 400, 136, 253, 400, 400, 400, 400, 234, 400, 400, 400, 400, 400, 128, 400, 165, 400, 400, 400, 76, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 85, 223, 400, 101, 400, 81, 72, 400, 400, 400, 179, 400, 389, 400, 97, 61, 400, 400, 400, 400, 400, 400, 84, 400, 400]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20743666989500828, "mean_inference_ms": 0.6141663881482246, "mean_action_processing_ms": 0.06811745704859366, "mean_env_wait_ms": 6.212165655852049, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005581776301066081, "StateBufferConnector_ms": 0.0031669934590657554, "ViewRequirementAgentConnector_ms": 0.0726008415222168}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 20000, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 376.96367922958666, "num_env_steps_trained_throughput_per_sec": 376.96367922958666, "timesteps_total": 20000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 20000, "timers": {"training_iteration_time_ms": 10662.979, "sample_time_ms": 7177.055, "load_time_ms": 0.945, "load_throughput": 4231755.032, "learn_time_ms": 3482.611, "learn_throughput": 1148.564, "synch_weights_time_ms": 1.718}, "counters": {"num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 20000}, "done": false, "episodes_total": 60, "training_iteration": 5, "trial_id": "dbefe_00000", "date": "2024-03-07_12-13-21", "timestamp": 1709831601, "time_this_iter_s": 10.613315105438232, "time_total_s": 53.32502841949463, "pid": 103980, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fcd19c36f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 53.32502841949463, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 19.571428571428573, "ram_util_percent": 44.2357142857143, "gpu_util_percent0": 0.07928571428571428, "vram_util_percent0": 0.09879557291666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.10000000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 5.045378277378697, "policy_loss": -0.01298562574691029, "vf_loss": 5.057754836880392, "vf_explained_var": -0.18691892373946406, "kl": 0.00609062557920049, "entropy": 1.0433981479496084, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 5115.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000}, "sampler_results": {"episode_reward_max": -4.999999999999995, "episode_reward_min": -70.30000000000047, "episode_reward_mean": -41.96933333333356, "episode_len_mean": 311.2, "episode_media": {}, "episodes_this_iter": 15, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-58.70000000000034, -38.60000000000012, -64.70000000000037, -49.000000000000185, -8.299999999999988, -69.70000000000044, -18.199999999999964, -37.00000000000002, -70.30000000000047, -65.20000000000047, -61.90000000000046, -60.40000000000031, -28.700000000000085, -54.00000000000041, -59.900000000000475, -54.5000000000003, -57.000000000000476, -56.500000000000355, -12.899999999999967, -47.500000000000234, -19.4, -58.80000000000042, -62.00000000000045, -45.40000000000033, -6.999999999999992, -60.70000000000034, -55.600000000000314, -69.50000000000044, -44.30000000000033, -45.00000000000036, -64.0000000000004, -52.20000000000043, -61.100000000000335, -50.500000000000334, -58.700000000000344, -7.399999999999986, -22.00000000000003, -57.40000000000028, -11.59999999999998, -42.80000000000032, -6.999999999999988, -6.099999999999991, -48.100000000000264, -43.50000000000032, -53.800000000000416, -25.199999999999946, -64.80000000000041, -51.80000000000029, -50.50000000000037, -9.799999999999978, -4.999999999999995, -49.700000000000266, -41.70000000000029, -54.90000000000029, -53.00000000000031, -46.60000000000021, -50.20000000000036, -7.699999999999989, -54.00000000000027, -56.10000000000032, -68.80000000000042, -49.00000000000024, -6.29999999999999, -5.399999999999999, -63.80000000000035, -28.30000000000008, -14.299999999999962, -46.60000000000028, -6.29999999999999, -7.7999999999999865, -16.399999999999974, -56.90000000000038, -23.60000000000008, -54.50000000000044, -51.8000000000004], "episode_lengths": [400, 297, 400, 333, 83, 400, 136, 253, 400, 400, 400, 400, 234, 400, 400, 400, 400, 400, 128, 400, 165, 400, 400, 400, 76, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 85, 223, 400, 101, 400, 81, 72, 400, 400, 400, 179, 400, 389, 400, 97, 61, 400, 400, 400, 400, 400, 400, 84, 400, 400, 400, 400, 74, 53, 400, 231, 138, 400, 74, 88, 160, 400, 245, 400, 400]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20612319201418194, "mean_inference_ms": 0.6139914141152852, "mean_action_processing_ms": 0.06801355533046932, "mean_env_wait_ms": 6.20145915960982, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005541165669759114, "StateBufferConnector_ms": 0.0031868616739908853, "ViewRequirementAgentConnector_ms": 0.07255236307779948}}, "episode_reward_max": -4.999999999999995, "episode_reward_min": -70.30000000000047, "episode_reward_mean": -41.96933333333356, "episode_len_mean": 311.2, "episodes_this_iter": 15, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-58.70000000000034, -38.60000000000012, -64.70000000000037, -49.000000000000185, -8.299999999999988, -69.70000000000044, -18.199999999999964, -37.00000000000002, -70.30000000000047, -65.20000000000047, -61.90000000000046, -60.40000000000031, -28.700000000000085, -54.00000000000041, -59.900000000000475, -54.5000000000003, -57.000000000000476, -56.500000000000355, -12.899999999999967, -47.500000000000234, -19.4, -58.80000000000042, -62.00000000000045, -45.40000000000033, -6.999999999999992, -60.70000000000034, -55.600000000000314, -69.50000000000044, -44.30000000000033, -45.00000000000036, -64.0000000000004, -52.20000000000043, -61.100000000000335, -50.500000000000334, -58.700000000000344, -7.399999999999986, -22.00000000000003, -57.40000000000028, -11.59999999999998, -42.80000000000032, -6.999999999999988, -6.099999999999991, -48.100000000000264, -43.50000000000032, -53.800000000000416, -25.199999999999946, -64.80000000000041, -51.80000000000029, -50.50000000000037, -9.799999999999978, -4.999999999999995, -49.700000000000266, -41.70000000000029, -54.90000000000029, -53.00000000000031, -46.60000000000021, -50.20000000000036, -7.699999999999989, -54.00000000000027, -56.10000000000032, -68.80000000000042, -49.00000000000024, -6.29999999999999, -5.399999999999999, -63.80000000000035, -28.30000000000008, -14.299999999999962, -46.60000000000028, -6.29999999999999, -7.7999999999999865, -16.399999999999974, -56.90000000000038, -23.60000000000008, -54.50000000000044, -51.8000000000004], "episode_lengths": [400, 297, 400, 333, 83, 400, 136, 253, 400, 400, 400, 400, 234, 400, 400, 400, 400, 400, 128, 400, 165, 400, 400, 400, 76, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 85, 223, 400, 101, 400, 81, 72, 400, 400, 400, 179, 400, 389, 400, 97, 61, 400, 400, 400, 400, 400, 400, 84, 400, 400, 400, 400, 74, 53, 400, 231, 138, 400, 74, 88, 160, 400, 245, 400, 400]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20612319201418194, "mean_inference_ms": 0.6139914141152852, "mean_action_processing_ms": 0.06801355533046932, "mean_env_wait_ms": 6.20145915960982, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005541165669759114, "StateBufferConnector_ms": 0.0031868616739908853, "ViewRequirementAgentConnector_ms": 0.07255236307779948}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 377.96595655774655, "num_env_steps_trained_throughput_per_sec": 377.96595655774655, "timesteps_total": 24000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 24000, "timers": {"training_iteration_time_ms": 10649.638, "sample_time_ms": 7163.847, "load_time_ms": 0.949, "load_throughput": 4214498.472, "learn_time_ms": 3482.484, "learn_throughput": 1148.605, "synch_weights_time_ms": 1.719}, "counters": {"num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000}, "done": false, "episodes_total": 75, "training_iteration": 6, "trial_id": "dbefe_00000", "date": "2024-03-07_12-13-32", "timestamp": 1709831612, "time_this_iter_s": 10.585330724716187, "time_total_s": 63.910359144210815, "pid": 103980, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fcd19c36f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 63.910359144210815, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 19.25714285714286, "ram_util_percent": 44.22857142857142, "gpu_util_percent0": 0.075, "vram_util_percent0": 0.09879557291666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.10000000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 4.428316722634018, "policy_loss": -0.013687436753303132, "vf_loss": 4.441375141823164, "vf_explained_var": -0.20135256583972644, "kl": 0.006290316408600468, "entropy": 1.0261326980847185, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 6045.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 28000}, "sampler_results": {"episode_reward_max": -3.8999999999999986, "episode_reward_min": -70.30000000000047, "episode_reward_mean": -41.04942528735655, "episode_len_mean": 312.17241379310343, "episode_media": {}, "episodes_this_iter": 12, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-58.70000000000034, -38.60000000000012, -64.70000000000037, -49.000000000000185, -8.299999999999988, -69.70000000000044, -18.199999999999964, -37.00000000000002, -70.30000000000047, -65.20000000000047, -61.90000000000046, -60.40000000000031, -28.700000000000085, -54.00000000000041, -59.900000000000475, -54.5000000000003, -57.000000000000476, -56.500000000000355, -12.899999999999967, -47.500000000000234, -19.4, -58.80000000000042, -62.00000000000045, -45.40000000000033, -6.999999999999992, -60.70000000000034, -55.600000000000314, -69.50000000000044, -44.30000000000033, -45.00000000000036, -64.0000000000004, -52.20000000000043, -61.100000000000335, -50.500000000000334, -58.700000000000344, -7.399999999999986, -22.00000000000003, -57.40000000000028, -11.59999999999998, -42.80000000000032, -6.999999999999988, -6.099999999999991, -48.100000000000264, -43.50000000000032, -53.800000000000416, -25.199999999999946, -64.80000000000041, -51.80000000000029, -50.50000000000037, -9.799999999999978, -4.999999999999995, -49.700000000000266, -41.70000000000029, -54.90000000000029, -53.00000000000031, -46.60000000000021, -50.20000000000036, -7.699999999999989, -54.00000000000027, -56.10000000000032, -68.80000000000042, -49.00000000000024, -6.29999999999999, -5.399999999999999, -63.80000000000035, -28.30000000000008, -14.299999999999962, -46.60000000000028, -6.29999999999999, -7.7999999999999865, -16.399999999999974, -56.90000000000038, -23.60000000000008, -54.50000000000044, -51.8000000000004, -42.40000000000033, -43.200000000000266, -6.699999999999989, -49.50000000000021, -9.199999999999982, -3.8999999999999986, -46.700000000000315, -44.300000000000274, -42.800000000000225, -46.200000000000344, -46.4000000000003, -42.3000000000003], "episode_lengths": [400, 297, 400, 333, 83, 400, 136, 253, 400, 400, 400, 400, 234, 400, 400, 400, 400, 400, 128, 400, 165, 400, 400, 400, 76, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 85, 223, 400, 101, 400, 81, 72, 400, 400, 400, 179, 400, 389, 400, 97, 61, 400, 400, 400, 400, 400, 400, 84, 400, 400, 400, 400, 74, 53, 400, 231, 138, 400, 74, 88, 160, 400, 245, 400, 400, 400, 400, 78, 400, 95, 50, 400, 400, 396, 400, 400, 400]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20570690642921735, "mean_inference_ms": 0.6138271416128054, "mean_action_processing_ms": 0.06795587585907817, "mean_env_wait_ms": 6.193500574364218, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005457593106675422, "StateBufferConnector_ms": 0.0031838471862091415, "ViewRequirementAgentConnector_ms": 0.07264340060880814}}, "episode_reward_max": -3.8999999999999986, "episode_reward_min": -70.30000000000047, "episode_reward_mean": -41.04942528735655, "episode_len_mean": 312.17241379310343, "episodes_this_iter": 12, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-58.70000000000034, -38.60000000000012, -64.70000000000037, -49.000000000000185, -8.299999999999988, -69.70000000000044, -18.199999999999964, -37.00000000000002, -70.30000000000047, -65.20000000000047, -61.90000000000046, -60.40000000000031, -28.700000000000085, -54.00000000000041, -59.900000000000475, -54.5000000000003, -57.000000000000476, -56.500000000000355, -12.899999999999967, -47.500000000000234, -19.4, -58.80000000000042, -62.00000000000045, -45.40000000000033, -6.999999999999992, -60.70000000000034, -55.600000000000314, -69.50000000000044, -44.30000000000033, -45.00000000000036, -64.0000000000004, -52.20000000000043, -61.100000000000335, -50.500000000000334, -58.700000000000344, -7.399999999999986, -22.00000000000003, -57.40000000000028, -11.59999999999998, -42.80000000000032, -6.999999999999988, -6.099999999999991, -48.100000000000264, -43.50000000000032, -53.800000000000416, -25.199999999999946, -64.80000000000041, -51.80000000000029, -50.50000000000037, -9.799999999999978, -4.999999999999995, -49.700000000000266, -41.70000000000029, -54.90000000000029, -53.00000000000031, -46.60000000000021, -50.20000000000036, -7.699999999999989, -54.00000000000027, -56.10000000000032, -68.80000000000042, -49.00000000000024, -6.29999999999999, -5.399999999999999, -63.80000000000035, -28.30000000000008, -14.299999999999962, -46.60000000000028, -6.29999999999999, -7.7999999999999865, -16.399999999999974, -56.90000000000038, -23.60000000000008, -54.50000000000044, -51.8000000000004, -42.40000000000033, -43.200000000000266, -6.699999999999989, -49.50000000000021, -9.199999999999982, -3.8999999999999986, -46.700000000000315, -44.300000000000274, -42.800000000000225, -46.200000000000344, -46.4000000000003, -42.3000000000003], "episode_lengths": [400, 297, 400, 333, 83, 400, 136, 253, 400, 400, 400, 400, 234, 400, 400, 400, 400, 400, 128, 400, 165, 400, 400, 400, 76, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 85, 223, 400, 101, 400, 81, 72, 400, 400, 400, 179, 400, 389, 400, 97, 61, 400, 400, 400, 400, 400, 400, 84, 400, 400, 400, 400, 74, 53, 400, 231, 138, 400, 74, 88, 160, 400, 245, 400, 400, 400, 400, 78, 400, 95, 50, 400, 400, 396, 400, 400, 400]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20570690642921735, "mean_inference_ms": 0.6138271416128054, "mean_action_processing_ms": 0.06795587585907817, "mean_env_wait_ms": 6.193500574364218, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005457593106675422, "StateBufferConnector_ms": 0.0031838471862091415, "ViewRequirementAgentConnector_ms": 0.07264340060880814}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 28000, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 378.49312315252354, "num_env_steps_trained_throughput_per_sec": 378.49312315252354, "timesteps_total": 28000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 28000, "timers": {"training_iteration_time_ms": 10638.003, "sample_time_ms": 7154.482, "load_time_ms": 0.953, "load_throughput": 4199102.975, "learn_time_ms": 3480.239, "learn_throughput": 1149.346, "synch_weights_time_ms": 1.698}, "counters": {"num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 28000}, "done": false, "episodes_total": 87, "training_iteration": 7, "trial_id": "dbefe_00000", "date": "2024-03-07_12-13-42", "timestamp": 1709831622, "time_this_iter_s": 10.570321798324585, "time_total_s": 74.4806809425354, "pid": 103980, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fcd19c36f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 74.4806809425354, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 19.3, "ram_util_percent": 44.3, "gpu_util_percent0": 0.08714285714285715, "vram_util_percent0": 0.09879557291666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.10000000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 3.7519567867120105, "policy_loss": -0.011854053725318243, "vf_loss": 3.7632401860529376, "vf_explained_var": -0.28908471939384295, "kl": 0.005706464100480853, "entropy": 1.0248673089088933, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 6975.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000}, "sampler_results": {"episode_reward_max": -3.8999999999999986, "episode_reward_min": -70.30000000000047, "episode_reward_mean": -40.00300000000023, "episode_len_mean": 310.23, "episode_media": {}, "episodes_this_iter": 13, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-58.70000000000034, -38.60000000000012, -64.70000000000037, -49.000000000000185, -8.299999999999988, -69.70000000000044, -18.199999999999964, -37.00000000000002, -70.30000000000047, -65.20000000000047, -61.90000000000046, -60.40000000000031, -28.700000000000085, -54.00000000000041, -59.900000000000475, -54.5000000000003, -57.000000000000476, -56.500000000000355, -12.899999999999967, -47.500000000000234, -19.4, -58.80000000000042, -62.00000000000045, -45.40000000000033, -6.999999999999992, -60.70000000000034, -55.600000000000314, -69.50000000000044, -44.30000000000033, -45.00000000000036, -64.0000000000004, -52.20000000000043, -61.100000000000335, -50.500000000000334, -58.700000000000344, -7.399999999999986, -22.00000000000003, -57.40000000000028, -11.59999999999998, -42.80000000000032, -6.999999999999988, -6.099999999999991, -48.100000000000264, -43.50000000000032, -53.800000000000416, -25.199999999999946, -64.80000000000041, -51.80000000000029, -50.50000000000037, -9.799999999999978, -4.999999999999995, -49.700000000000266, -41.70000000000029, -54.90000000000029, -53.00000000000031, -46.60000000000021, -50.20000000000036, -7.699999999999989, -54.00000000000027, -56.10000000000032, -68.80000000000042, -49.00000000000024, -6.29999999999999, -5.399999999999999, -63.80000000000035, -28.30000000000008, -14.299999999999962, -46.60000000000028, -6.29999999999999, -7.7999999999999865, -16.399999999999974, -56.90000000000038, -23.60000000000008, -54.50000000000044, -51.8000000000004, -42.40000000000033, -43.200000000000266, -6.699999999999989, -49.50000000000021, -9.199999999999982, -3.8999999999999986, -46.700000000000315, -44.300000000000274, -42.800000000000225, -46.200000000000344, -46.4000000000003, -42.3000000000003, -52.00000000000033, -41.5000000000003, -8.099999999999985, -43.70000000000031, -42.200000000000344, -50.20000000000027, -9.599999999999984, -40.40000000000029, -6.499999999999989, -38.20000000000025, -4.699999999999996, -48.9000000000002, -43.000000000000334], "episode_lengths": [400, 297, 400, 333, 83, 400, 136, 253, 400, 400, 400, 400, 234, 400, 400, 400, 400, 400, 128, 400, 165, 400, 400, 400, 76, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 85, 223, 400, 101, 400, 81, 72, 400, 400, 400, 179, 400, 389, 400, 97, 61, 400, 400, 400, 400, 400, 400, 84, 400, 400, 400, 400, 74, 53, 400, 231, 138, 400, 74, 88, 160, 400, 245, 400, 400, 400, 400, 78, 400, 95, 50, 400, 400, 396, 400, 400, 400, 400, 400, 89, 400, 400, 400, 87, 400, 76, 354, 58, 400, 400]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20509633417439127, "mean_inference_ms": 0.6139919679101375, "mean_action_processing_ms": 0.06790865045745714, "mean_env_wait_ms": 6.186984721612976, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005492210388183594, "StateBufferConnector_ms": 0.0032243728637695312, "ViewRequirementAgentConnector_ms": 0.07326292991638184}}, "episode_reward_max": -3.8999999999999986, "episode_reward_min": -70.30000000000047, "episode_reward_mean": -40.00300000000023, "episode_len_mean": 310.23, "episodes_this_iter": 13, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-58.70000000000034, -38.60000000000012, -64.70000000000037, -49.000000000000185, -8.299999999999988, -69.70000000000044, -18.199999999999964, -37.00000000000002, -70.30000000000047, -65.20000000000047, -61.90000000000046, -60.40000000000031, -28.700000000000085, -54.00000000000041, -59.900000000000475, -54.5000000000003, -57.000000000000476, -56.500000000000355, -12.899999999999967, -47.500000000000234, -19.4, -58.80000000000042, -62.00000000000045, -45.40000000000033, -6.999999999999992, -60.70000000000034, -55.600000000000314, -69.50000000000044, -44.30000000000033, -45.00000000000036, -64.0000000000004, -52.20000000000043, -61.100000000000335, -50.500000000000334, -58.700000000000344, -7.399999999999986, -22.00000000000003, -57.40000000000028, -11.59999999999998, -42.80000000000032, -6.999999999999988, -6.099999999999991, -48.100000000000264, -43.50000000000032, -53.800000000000416, -25.199999999999946, -64.80000000000041, -51.80000000000029, -50.50000000000037, -9.799999999999978, -4.999999999999995, -49.700000000000266, -41.70000000000029, -54.90000000000029, -53.00000000000031, -46.60000000000021, -50.20000000000036, -7.699999999999989, -54.00000000000027, -56.10000000000032, -68.80000000000042, -49.00000000000024, -6.29999999999999, -5.399999999999999, -63.80000000000035, -28.30000000000008, -14.299999999999962, -46.60000000000028, -6.29999999999999, -7.7999999999999865, -16.399999999999974, -56.90000000000038, -23.60000000000008, -54.50000000000044, -51.8000000000004, -42.40000000000033, -43.200000000000266, -6.699999999999989, -49.50000000000021, -9.199999999999982, -3.8999999999999986, -46.700000000000315, -44.300000000000274, -42.800000000000225, -46.200000000000344, -46.4000000000003, -42.3000000000003, -52.00000000000033, -41.5000000000003, -8.099999999999985, -43.70000000000031, -42.200000000000344, -50.20000000000027, -9.599999999999984, -40.40000000000029, -6.499999999999989, -38.20000000000025, -4.699999999999996, -48.9000000000002, -43.000000000000334], "episode_lengths": [400, 297, 400, 333, 83, 400, 136, 253, 400, 400, 400, 400, 234, 400, 400, 400, 400, 400, 128, 400, 165, 400, 400, 400, 76, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 85, 223, 400, 101, 400, 81, 72, 400, 400, 400, 179, 400, 389, 400, 97, 61, 400, 400, 400, 400, 400, 400, 84, 400, 400, 400, 400, 74, 53, 400, 231, 138, 400, 74, 88, 160, 400, 245, 400, 400, 400, 400, 78, 400, 95, 50, 400, 400, 396, 400, 400, 400, 400, 400, 89, 400, 400, 400, 87, 400, 76, 354, 58, 400, 400]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20509633417439127, "mean_inference_ms": 0.6139919679101375, "mean_action_processing_ms": 0.06790865045745714, "mean_env_wait_ms": 6.186984721612976, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005492210388183594, "StateBufferConnector_ms": 0.0032243728637695312, "ViewRequirementAgentConnector_ms": 0.07326292991638184}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 382.16005003983963, "num_env_steps_trained_throughput_per_sec": 382.16005003983963, "timesteps_total": 32000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 32000, "timers": {"training_iteration_time_ms": 10616.601, "sample_time_ms": 7141.501, "load_time_ms": 0.966, "load_throughput": 4141116.535, "learn_time_ms": 3471.809, "learn_throughput": 1152.137, "synch_weights_time_ms": 1.697}, "counters": {"num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000}, "done": false, "episodes_total": 100, "training_iteration": 8, "trial_id": "dbefe_00000", "date": "2024-03-07_12-13-53", "timestamp": 1709831633, "time_this_iter_s": 10.468894958496094, "time_total_s": 84.9495759010315, "pid": 103980, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fcd19c36f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 84.9495759010315, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 21.084615384615386, "ram_util_percent": 44.3, "gpu_util_percent0": 0.08, "vram_util_percent0": 0.09879557291666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.10000000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 4.357550544892588, "policy_loss": -0.006012365141863464, "vf_loss": 4.362843138996952, "vf_explained_var": -0.08024478721362288, "kl": 0.007197632272425014, "entropy": 1.0137145903161777, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 7905.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000}, "sampler_results": {"episode_reward_max": -3.8999999999999986, "episode_reward_min": -69.50000000000044, "episode_reward_mean": -36.85500000000022, "episode_len_mean": 301.71, "episode_media": {}, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-57.000000000000476, -56.500000000000355, -12.899999999999967, -47.500000000000234, -19.4, -58.80000000000042, -62.00000000000045, -45.40000000000033, -6.999999999999992, -60.70000000000034, -55.600000000000314, -69.50000000000044, -44.30000000000033, -45.00000000000036, -64.0000000000004, -52.20000000000043, -61.100000000000335, -50.500000000000334, -58.700000000000344, -7.399999999999986, -22.00000000000003, -57.40000000000028, -11.59999999999998, -42.80000000000032, -6.999999999999988, -6.099999999999991, -48.100000000000264, -43.50000000000032, -53.800000000000416, -25.199999999999946, -64.80000000000041, -51.80000000000029, -50.50000000000037, -9.799999999999978, -4.999999999999995, -49.700000000000266, -41.70000000000029, -54.90000000000029, -53.00000000000031, -46.60000000000021, -50.20000000000036, -7.699999999999989, -54.00000000000027, -56.10000000000032, -68.80000000000042, -49.00000000000024, -6.29999999999999, -5.399999999999999, -63.80000000000035, -28.30000000000008, -14.299999999999962, -46.60000000000028, -6.29999999999999, -7.7999999999999865, -16.399999999999974, -56.90000000000038, -23.60000000000008, -54.50000000000044, -51.8000000000004, -42.40000000000033, -43.200000000000266, -6.699999999999989, -49.50000000000021, -9.199999999999982, -3.8999999999999986, -46.700000000000315, -44.300000000000274, -42.800000000000225, -46.200000000000344, -46.4000000000003, -42.3000000000003, -52.00000000000033, -41.5000000000003, -8.099999999999985, -43.70000000000031, -42.200000000000344, -50.20000000000027, -9.599999999999984, -40.40000000000029, -6.499999999999989, -38.20000000000025, -4.699999999999996, -48.9000000000002, -43.000000000000334, -35.80000000000018, -9.79999999999998, -43.500000000000234, -9.799999999999978, -41.80000000000028, -41.40000000000028, -42.60000000000029, -5.5999999999999925, -4.099999999999998, -51.60000000000025, -10.099999999999977, -45.10000000000029, -40.70000000000031, -15.199999999999964, -42.20000000000033, -45.00000000000031], "episode_lengths": [400, 400, 128, 400, 165, 400, 400, 400, 76, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 85, 223, 400, 101, 400, 81, 72, 400, 400, 400, 179, 400, 389, 400, 97, 61, 400, 400, 400, 400, 400, 400, 84, 400, 400, 400, 400, 74, 53, 400, 231, 138, 400, 74, 88, 160, 400, 245, 400, 400, 400, 400, 78, 400, 95, 50, 400, 400, 396, 400, 400, 400, 400, 400, 89, 400, 400, 400, 87, 400, 76, 354, 58, 400, 400, 302, 96, 400, 105, 400, 400, 400, 67, 52, 400, 104, 400, 400, 158, 400, 400]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20643196769718103, "mean_inference_ms": 0.6140322868500079, "mean_action_processing_ms": 0.0677644384113379, "mean_env_wait_ms": 6.165922133810727, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00549006462097168, "StateBufferConnector_ms": 0.0032351016998291016, "ViewRequirementAgentConnector_ms": 0.07301807403564453}}, "episode_reward_max": -3.8999999999999986, "episode_reward_min": -69.50000000000044, "episode_reward_mean": -36.85500000000022, "episode_len_mean": 301.71, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-57.000000000000476, -56.500000000000355, -12.899999999999967, -47.500000000000234, -19.4, -58.80000000000042, -62.00000000000045, -45.40000000000033, -6.999999999999992, -60.70000000000034, -55.600000000000314, -69.50000000000044, -44.30000000000033, -45.00000000000036, -64.0000000000004, -52.20000000000043, -61.100000000000335, -50.500000000000334, -58.700000000000344, -7.399999999999986, -22.00000000000003, -57.40000000000028, -11.59999999999998, -42.80000000000032, -6.999999999999988, -6.099999999999991, -48.100000000000264, -43.50000000000032, -53.800000000000416, -25.199999999999946, -64.80000000000041, -51.80000000000029, -50.50000000000037, -9.799999999999978, -4.999999999999995, -49.700000000000266, -41.70000000000029, -54.90000000000029, -53.00000000000031, -46.60000000000021, -50.20000000000036, -7.699999999999989, -54.00000000000027, -56.10000000000032, -68.80000000000042, -49.00000000000024, -6.29999999999999, -5.399999999999999, -63.80000000000035, -28.30000000000008, -14.299999999999962, -46.60000000000028, -6.29999999999999, -7.7999999999999865, -16.399999999999974, -56.90000000000038, -23.60000000000008, -54.50000000000044, -51.8000000000004, -42.40000000000033, -43.200000000000266, -6.699999999999989, -49.50000000000021, -9.199999999999982, -3.8999999999999986, -46.700000000000315, -44.300000000000274, -42.800000000000225, -46.200000000000344, -46.4000000000003, -42.3000000000003, -52.00000000000033, -41.5000000000003, -8.099999999999985, -43.70000000000031, -42.200000000000344, -50.20000000000027, -9.599999999999984, -40.40000000000029, -6.499999999999989, -38.20000000000025, -4.699999999999996, -48.9000000000002, -43.000000000000334, -35.80000000000018, -9.79999999999998, -43.500000000000234, -9.799999999999978, -41.80000000000028, -41.40000000000028, -42.60000000000029, -5.5999999999999925, -4.099999999999998, -51.60000000000025, -10.099999999999977, -45.10000000000029, -40.70000000000031, -15.199999999999964, -42.20000000000033, -45.00000000000031], "episode_lengths": [400, 400, 128, 400, 165, 400, 400, 400, 76, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 85, 223, 400, 101, 400, 81, 72, 400, 400, 400, 179, 400, 389, 400, 97, 61, 400, 400, 400, 400, 400, 400, 84, 400, 400, 400, 400, 74, 53, 400, 231, 138, 400, 74, 88, 160, 400, 245, 400, 400, 400, 400, 78, 400, 95, 50, 400, 400, 396, 400, 400, 400, 400, 400, 89, 400, 400, 400, 87, 400, 76, 354, 58, 400, 400, 302, 96, 400, 105, 400, 400, 400, 67, 52, 400, 104, 400, 400, 158, 400, 400]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20643196769718103, "mean_inference_ms": 0.6140322868500079, "mean_action_processing_ms": 0.0677644384113379, "mean_env_wait_ms": 6.165922133810727, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00549006462097168, "StateBufferConnector_ms": 0.0032351016998291016, "ViewRequirementAgentConnector_ms": 0.07301807403564453}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 375.50448603124283, "num_env_steps_trained_throughput_per_sec": 375.50448603124283, "timesteps_total": 36000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 36000, "timers": {"training_iteration_time_ms": 10620.569, "sample_time_ms": 7136.353, "load_time_ms": 0.965, "load_throughput": 4147187.344, "learn_time_ms": 3480.939, "learn_throughput": 1149.115, "synch_weights_time_ms": 1.693}, "counters": {"num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000}, "done": false, "episodes_total": 116, "training_iteration": 9, "trial_id": "dbefe_00000", "date": "2024-03-07_12-14-03", "timestamp": 1709831643, "time_this_iter_s": 10.654831647872925, "time_total_s": 95.60440754890442, "pid": 103980, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fcd19c36f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 95.60440754890442, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 19.22857142857143, "ram_util_percent": 44.3, "gpu_util_percent0": 0.08499999999999999, "vram_util_percent0": 0.09879557291666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.10000000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 4.589358455904068, "policy_loss": 0.002893105922366983, "vf_loss": 4.585710561708097, "vf_explained_var": -0.09964091790619717, "kl": 0.007548047859694817, "entropy": 1.000708782160154, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 8835.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000}, "sampler_results": {"episode_reward_max": -3.8999999999999986, "episode_reward_min": -68.80000000000042, "episode_reward_mean": -34.612000000000194, "episode_len_mean": 291.93, "episode_media": {}, "episodes_this_iter": 15, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-52.20000000000043, -61.100000000000335, -50.500000000000334, -58.700000000000344, -7.399999999999986, -22.00000000000003, -57.40000000000028, -11.59999999999998, -42.80000000000032, -6.999999999999988, -6.099999999999991, -48.100000000000264, -43.50000000000032, -53.800000000000416, -25.199999999999946, -64.80000000000041, -51.80000000000029, -50.50000000000037, -9.799999999999978, -4.999999999999995, -49.700000000000266, -41.70000000000029, -54.90000000000029, -53.00000000000031, -46.60000000000021, -50.20000000000036, -7.699999999999989, -54.00000000000027, -56.10000000000032, -68.80000000000042, -49.00000000000024, -6.29999999999999, -5.399999999999999, -63.80000000000035, -28.30000000000008, -14.299999999999962, -46.60000000000028, -6.29999999999999, -7.7999999999999865, -16.399999999999974, -56.90000000000038, -23.60000000000008, -54.50000000000044, -51.8000000000004, -42.40000000000033, -43.200000000000266, -6.699999999999989, -49.50000000000021, -9.199999999999982, -3.8999999999999986, -46.700000000000315, -44.300000000000274, -42.800000000000225, -46.200000000000344, -46.4000000000003, -42.3000000000003, -52.00000000000033, -41.5000000000003, -8.099999999999985, -43.70000000000031, -42.200000000000344, -50.20000000000027, -9.599999999999984, -40.40000000000029, -6.499999999999989, -38.20000000000025, -4.699999999999996, -48.9000000000002, -43.000000000000334, -35.80000000000018, -9.79999999999998, -43.500000000000234, -9.799999999999978, -41.80000000000028, -41.40000000000028, -42.60000000000029, -5.5999999999999925, -4.099999999999998, -51.60000000000025, -10.099999999999977, -45.10000000000029, -40.70000000000031, -15.199999999999964, -42.20000000000033, -45.00000000000031, -40.90000000000024, -51.800000000000466, -46.40000000000027, -9.299999999999988, -9.29999999999998, -41.90000000000031, -41.60000000000032, -65.30000000000037, -51.00000000000036, -8.099999999999984, -12.499999999999972, -8.699999999999982, -37.70000000000022, -41.20000000000027, -15.59999999999997], "episode_lengths": [400, 400, 400, 400, 85, 223, 400, 101, 400, 81, 72, 400, 400, 400, 179, 400, 389, 400, 97, 61, 400, 400, 400, 400, 400, 400, 84, 400, 400, 400, 400, 74, 53, 400, 231, 138, 400, 74, 88, 160, 400, 245, 400, 400, 400, 400, 78, 400, 95, 50, 400, 400, 396, 400, 400, 400, 400, 400, 89, 400, 400, 400, 87, 400, 76, 354, 58, 400, 400, 302, 96, 400, 105, 400, 400, 400, 67, 52, 400, 104, 400, 400, 158, 400, 400, 375, 400, 400, 87, 104, 400, 400, 400, 400, 92, 125, 98, 350, 400, 160]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20390713184417883, "mean_inference_ms": 0.6135939745931244, "mean_action_processing_ms": 0.06769067280292214, "mean_env_wait_ms": 6.145490873698313, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00542449951171875, "StateBufferConnector_ms": 0.0032591819763183594, "ViewRequirementAgentConnector_ms": 0.07328915596008301}}, "episode_reward_max": -3.8999999999999986, "episode_reward_min": -68.80000000000042, "episode_reward_mean": -34.612000000000194, "episode_len_mean": 291.93, "episodes_this_iter": 15, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-52.20000000000043, -61.100000000000335, -50.500000000000334, -58.700000000000344, -7.399999999999986, -22.00000000000003, -57.40000000000028, -11.59999999999998, -42.80000000000032, -6.999999999999988, -6.099999999999991, -48.100000000000264, -43.50000000000032, -53.800000000000416, -25.199999999999946, -64.80000000000041, -51.80000000000029, -50.50000000000037, -9.799999999999978, -4.999999999999995, -49.700000000000266, -41.70000000000029, -54.90000000000029, -53.00000000000031, -46.60000000000021, -50.20000000000036, -7.699999999999989, -54.00000000000027, -56.10000000000032, -68.80000000000042, -49.00000000000024, -6.29999999999999, -5.399999999999999, -63.80000000000035, -28.30000000000008, -14.299999999999962, -46.60000000000028, -6.29999999999999, -7.7999999999999865, -16.399999999999974, -56.90000000000038, -23.60000000000008, -54.50000000000044, -51.8000000000004, -42.40000000000033, -43.200000000000266, -6.699999999999989, -49.50000000000021, -9.199999999999982, -3.8999999999999986, -46.700000000000315, -44.300000000000274, -42.800000000000225, -46.200000000000344, -46.4000000000003, -42.3000000000003, -52.00000000000033, -41.5000000000003, -8.099999999999985, -43.70000000000031, -42.200000000000344, -50.20000000000027, -9.599999999999984, -40.40000000000029, -6.499999999999989, -38.20000000000025, -4.699999999999996, -48.9000000000002, -43.000000000000334, -35.80000000000018, -9.79999999999998, -43.500000000000234, -9.799999999999978, -41.80000000000028, -41.40000000000028, -42.60000000000029, -5.5999999999999925, -4.099999999999998, -51.60000000000025, -10.099999999999977, -45.10000000000029, -40.70000000000031, -15.199999999999964, -42.20000000000033, -45.00000000000031, -40.90000000000024, -51.800000000000466, -46.40000000000027, -9.299999999999988, -9.29999999999998, -41.90000000000031, -41.60000000000032, -65.30000000000037, -51.00000000000036, -8.099999999999984, -12.499999999999972, -8.699999999999982, -37.70000000000022, -41.20000000000027, -15.59999999999997], "episode_lengths": [400, 400, 400, 400, 85, 223, 400, 101, 400, 81, 72, 400, 400, 400, 179, 400, 389, 400, 97, 61, 400, 400, 400, 400, 400, 400, 84, 400, 400, 400, 400, 74, 53, 400, 231, 138, 400, 74, 88, 160, 400, 245, 400, 400, 400, 400, 78, 400, 95, 50, 400, 400, 396, 400, 400, 400, 400, 400, 89, 400, 400, 400, 87, 400, 76, 354, 58, 400, 400, 302, 96, 400, 105, 400, 400, 400, 67, 52, 400, 104, 400, 400, 158, 400, 400, 375, 400, 400, 87, 104, 400, 400, 400, 400, 92, 125, 98, 350, 400, 160]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20390713184417883, "mean_inference_ms": 0.6135939745931244, "mean_action_processing_ms": 0.06769067280292214, "mean_env_wait_ms": 6.145490873698313, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00542449951171875, "StateBufferConnector_ms": 0.0032591819763183594, "ViewRequirementAgentConnector_ms": 0.07328915596008301}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 381.5434762022456, "num_env_steps_trained_throughput_per_sec": 381.5434762022456, "timesteps_total": 40000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 40000, "timers": {"training_iteration_time_ms": 10606.881, "sample_time_ms": 7126.152, "load_time_ms": 2.095, "load_throughput": 1909170.318, "learn_time_ms": 3476.327, "learn_throughput": 1150.64, "synch_weights_time_ms": 1.68}, "counters": {"num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000}, "done": false, "episodes_total": 131, "training_iteration": 10, "trial_id": "dbefe_00000", "date": "2024-03-07_12-14-14", "timestamp": 1709831654, "time_this_iter_s": 10.486103296279907, "time_total_s": 106.09051084518433, "pid": 103980, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fcd19c36f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 106.09051084518433, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 19.32857142857143, "ram_util_percent": 44.3, "gpu_util_percent0": 0.07571428571428572, "vram_util_percent0": 0.09879557291666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.10000000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 5.838585279385248, "policy_loss": -0.013588267925285525, "vf_loss": 5.851551730273872, "vf_explained_var": -0.25512109136068695, "kl": 0.006218260451251875, "entropy": 0.9959648406633766, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 9765.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_agent_steps_sampled": 44000, "num_agent_steps_trained": 44000}, "sampler_results": {"episode_reward_max": -3.8999999999999986, "episode_reward_min": -68.80000000000042, "episode_reward_mean": -31.129000000000165, "episode_len_mean": 270.93, "episode_media": {}, "episodes_this_iter": 21, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-41.70000000000029, -54.90000000000029, -53.00000000000031, -46.60000000000021, -50.20000000000036, -7.699999999999989, -54.00000000000027, -56.10000000000032, -68.80000000000042, -49.00000000000024, -6.29999999999999, -5.399999999999999, -63.80000000000035, -28.30000000000008, -14.299999999999962, -46.60000000000028, -6.29999999999999, -7.7999999999999865, -16.399999999999974, -56.90000000000038, -23.60000000000008, -54.50000000000044, -51.8000000000004, -42.40000000000033, -43.200000000000266, -6.699999999999989, -49.50000000000021, -9.199999999999982, -3.8999999999999986, -46.700000000000315, -44.300000000000274, -42.800000000000225, -46.200000000000344, -46.4000000000003, -42.3000000000003, -52.00000000000033, -41.5000000000003, -8.099999999999985, -43.70000000000031, -42.200000000000344, -50.20000000000027, -9.599999999999984, -40.40000000000029, -6.499999999999989, -38.20000000000025, -4.699999999999996, -48.9000000000002, -43.000000000000334, -35.80000000000018, -9.79999999999998, -43.500000000000234, -9.799999999999978, -41.80000000000028, -41.40000000000028, -42.60000000000029, -5.5999999999999925, -4.099999999999998, -51.60000000000025, -10.099999999999977, -45.10000000000029, -40.70000000000031, -15.199999999999964, -42.20000000000033, -45.00000000000031, -40.90000000000024, -51.800000000000466, -46.40000000000027, -9.299999999999988, -9.29999999999998, -41.90000000000031, -41.60000000000032, -65.30000000000037, -51.00000000000036, -8.099999999999984, -12.499999999999972, -8.699999999999982, -37.70000000000022, -41.20000000000027, -15.59999999999997, -11.99999999999997, -46.5000000000003, -58.600000000000385, -9.399999999999988, -27.8000000000001, -26.600000000000087, -13.899999999999963, -6.599999999999991, -17.599999999999994, -5.8999999999999915, -8.399999999999983, -44.90000000000022, -15.099999999999966, -5.8, -14.299999999999967, -9.09999999999998, -8.199999999999985, -10.799999999999976, -21.30000000000004, -25.10000000000004, -42.80000000000035], "episode_lengths": [400, 400, 400, 400, 400, 84, 400, 400, 400, 400, 74, 53, 400, 231, 138, 400, 74, 88, 160, 400, 245, 400, 400, 400, 400, 78, 400, 95, 50, 400, 400, 396, 400, 400, 400, 400, 400, 89, 400, 400, 400, 87, 400, 76, 354, 58, 400, 400, 302, 96, 400, 105, 400, 400, 400, 67, 52, 400, 104, 400, 400, 158, 400, 400, 375, 400, 400, 87, 104, 400, 400, 400, 400, 92, 125, 98, 350, 400, 160, 116, 400, 400, 87, 275, 256, 128, 75, 178, 70, 95, 400, 146, 60, 149, 101, 92, 107, 222, 231, 400]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.202511770165605, "mean_inference_ms": 0.6134552650609632, "mean_action_processing_ms": 0.06755045529770216, "mean_env_wait_ms": 6.135157302823384, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005466938018798828, "StateBufferConnector_ms": 0.0033080577850341797, "ViewRequirementAgentConnector_ms": 0.07355070114135742}}, "episode_reward_max": -3.8999999999999986, "episode_reward_min": -68.80000000000042, "episode_reward_mean": -31.129000000000165, "episode_len_mean": 270.93, "episodes_this_iter": 21, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-41.70000000000029, -54.90000000000029, -53.00000000000031, -46.60000000000021, -50.20000000000036, -7.699999999999989, -54.00000000000027, -56.10000000000032, -68.80000000000042, -49.00000000000024, -6.29999999999999, -5.399999999999999, -63.80000000000035, -28.30000000000008, -14.299999999999962, -46.60000000000028, -6.29999999999999, -7.7999999999999865, -16.399999999999974, -56.90000000000038, -23.60000000000008, -54.50000000000044, -51.8000000000004, -42.40000000000033, -43.200000000000266, -6.699999999999989, -49.50000000000021, -9.199999999999982, -3.8999999999999986, -46.700000000000315, -44.300000000000274, -42.800000000000225, -46.200000000000344, -46.4000000000003, -42.3000000000003, -52.00000000000033, -41.5000000000003, -8.099999999999985, -43.70000000000031, -42.200000000000344, -50.20000000000027, -9.599999999999984, -40.40000000000029, -6.499999999999989, -38.20000000000025, -4.699999999999996, -48.9000000000002, -43.000000000000334, -35.80000000000018, -9.79999999999998, -43.500000000000234, -9.799999999999978, -41.80000000000028, -41.40000000000028, -42.60000000000029, -5.5999999999999925, -4.099999999999998, -51.60000000000025, -10.099999999999977, -45.10000000000029, -40.70000000000031, -15.199999999999964, -42.20000000000033, -45.00000000000031, -40.90000000000024, -51.800000000000466, -46.40000000000027, -9.299999999999988, -9.29999999999998, -41.90000000000031, -41.60000000000032, -65.30000000000037, -51.00000000000036, -8.099999999999984, -12.499999999999972, -8.699999999999982, -37.70000000000022, -41.20000000000027, -15.59999999999997, -11.99999999999997, -46.5000000000003, -58.600000000000385, -9.399999999999988, -27.8000000000001, -26.600000000000087, -13.899999999999963, -6.599999999999991, -17.599999999999994, -5.8999999999999915, -8.399999999999983, -44.90000000000022, -15.099999999999966, -5.8, -14.299999999999967, -9.09999999999998, -8.199999999999985, -10.799999999999976, -21.30000000000004, -25.10000000000004, -42.80000000000035], "episode_lengths": [400, 400, 400, 400, 400, 84, 400, 400, 400, 400, 74, 53, 400, 231, 138, 400, 74, 88, 160, 400, 245, 400, 400, 400, 400, 78, 400, 95, 50, 400, 400, 396, 400, 400, 400, 400, 400, 89, 400, 400, 400, 87, 400, 76, 354, 58, 400, 400, 302, 96, 400, 105, 400, 400, 400, 67, 52, 400, 104, 400, 400, 158, 400, 400, 375, 400, 400, 87, 104, 400, 400, 400, 400, 92, 125, 98, 350, 400, 160, 116, 400, 400, 87, 275, 256, 128, 75, 178, 70, 95, 400, 146, 60, 149, 101, 92, 107, 222, 231, 400]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.202511770165605, "mean_inference_ms": 0.6134552650609632, "mean_action_processing_ms": 0.06755045529770216, "mean_env_wait_ms": 6.135157302823384, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005466938018798828, "StateBufferConnector_ms": 0.0033080577850341797, "ViewRequirementAgentConnector_ms": 0.07355070114135742}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 44000, "num_agent_steps_trained": 44000, "num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 378.07993886618266, "num_env_steps_trained_throughput_per_sec": 378.07993886618266, "timesteps_total": 44000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 44000, "timers": {"training_iteration_time_ms": 10589.482, "sample_time_ms": 7118.335, "load_time_ms": 2.1, "load_throughput": 1904705.335, "learn_time_ms": 3466.762, "learn_throughput": 1153.814, "synch_weights_time_ms": 1.682}, "counters": {"num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_agent_steps_sampled": 44000, "num_agent_steps_trained": 44000}, "done": false, "episodes_total": 152, "training_iteration": 11, "trial_id": "dbefe_00000", "date": "2024-03-07_12-14-24", "timestamp": 1709831664, "time_this_iter_s": 10.58177137374878, "time_total_s": 116.6722822189331, "pid": 103980, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fcd19c36f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 116.6722822189331, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 19.228571428571428, "ram_util_percent": 44.3, "gpu_util_percent0": 0.08214285714285714, "vram_util_percent0": 0.09879557291666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.10000000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 4.579880175026514, "policy_loss": -0.010795459603910805, "vf_loss": 4.589964644707019, "vf_explained_var": -0.3317334227023586, "kl": 0.0071097820665773975, "entropy": 0.9783297595157419, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 10695.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000}, "sampler_results": {"episode_reward_max": -3.8999999999999986, "episode_reward_min": -65.30000000000037, "episode_reward_mean": -28.684000000000143, "episode_len_mean": 259.63, "episode_media": {}, "episodes_this_iter": 18, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-16.399999999999974, -56.90000000000038, -23.60000000000008, -54.50000000000044, -51.8000000000004, -42.40000000000033, -43.200000000000266, -6.699999999999989, -49.50000000000021, -9.199999999999982, -3.8999999999999986, -46.700000000000315, -44.300000000000274, -42.800000000000225, -46.200000000000344, -46.4000000000003, -42.3000000000003, -52.00000000000033, -41.5000000000003, -8.099999999999985, -43.70000000000031, -42.200000000000344, -50.20000000000027, -9.599999999999984, -40.40000000000029, -6.499999999999989, -38.20000000000025, -4.699999999999996, -48.9000000000002, -43.000000000000334, -35.80000000000018, -9.79999999999998, -43.500000000000234, -9.799999999999978, -41.80000000000028, -41.40000000000028, -42.60000000000029, -5.5999999999999925, -4.099999999999998, -51.60000000000025, -10.099999999999977, -45.10000000000029, -40.70000000000031, -15.199999999999964, -42.20000000000033, -45.00000000000031, -40.90000000000024, -51.800000000000466, -46.40000000000027, -9.299999999999988, -9.29999999999998, -41.90000000000031, -41.60000000000032, -65.30000000000037, -51.00000000000036, -8.099999999999984, -12.499999999999972, -8.699999999999982, -37.70000000000022, -41.20000000000027, -15.59999999999997, -11.99999999999997, -46.5000000000003, -58.600000000000385, -9.399999999999988, -27.8000000000001, -26.600000000000087, -13.899999999999963, -6.599999999999991, -17.599999999999994, -5.8999999999999915, -8.399999999999983, -44.90000000000022, -15.099999999999966, -5.8, -14.299999999999967, -9.09999999999998, -8.199999999999985, -10.799999999999976, -21.30000000000004, -25.10000000000004, -42.80000000000035, -15.19999999999996, -24.30000000000007, -10.79999999999998, -21.5, -11.79999999999997, -4.999999999999995, -11.79999999999997, -8.699999999999992, -42.300000000000296, -42.30000000000034, -9.899999999999977, -41.40000000000028, -10.799999999999974, -41.40000000000032, -34.000000000000114, -43.3000000000003, -32.40000000000017, -9.399999999999979], "episode_lengths": [160, 400, 245, 400, 400, 400, 400, 78, 400, 95, 50, 400, 400, 396, 400, 400, 400, 400, 400, 89, 400, 400, 400, 87, 400, 76, 354, 58, 400, 400, 302, 96, 400, 105, 400, 400, 400, 67, 52, 400, 104, 400, 400, 158, 400, 400, 375, 400, 400, 87, 104, 400, 400, 400, 400, 92, 125, 98, 350, 400, 160, 116, 400, 400, 87, 275, 256, 128, 75, 178, 70, 95, 400, 146, 60, 149, 101, 92, 107, 222, 231, 400, 155, 249, 104, 201, 115, 61, 115, 80, 400, 400, 110, 400, 109, 400, 308, 400, 300, 105]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20246289646847637, "mean_inference_ms": 0.6133444257374722, "mean_action_processing_ms": 0.06757845060552531, "mean_env_wait_ms": 6.122894851223021, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005412101745605469, "StateBufferConnector_ms": 0.0033025741577148438, "ViewRequirementAgentConnector_ms": 0.07354927062988281}}, "episode_reward_max": -3.8999999999999986, "episode_reward_min": -65.30000000000037, "episode_reward_mean": -28.684000000000143, "episode_len_mean": 259.63, "episodes_this_iter": 18, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-16.399999999999974, -56.90000000000038, -23.60000000000008, -54.50000000000044, -51.8000000000004, -42.40000000000033, -43.200000000000266, -6.699999999999989, -49.50000000000021, -9.199999999999982, -3.8999999999999986, -46.700000000000315, -44.300000000000274, -42.800000000000225, -46.200000000000344, -46.4000000000003, -42.3000000000003, -52.00000000000033, -41.5000000000003, -8.099999999999985, -43.70000000000031, -42.200000000000344, -50.20000000000027, -9.599999999999984, -40.40000000000029, -6.499999999999989, -38.20000000000025, -4.699999999999996, -48.9000000000002, -43.000000000000334, -35.80000000000018, -9.79999999999998, -43.500000000000234, -9.799999999999978, -41.80000000000028, -41.40000000000028, -42.60000000000029, -5.5999999999999925, -4.099999999999998, -51.60000000000025, -10.099999999999977, -45.10000000000029, -40.70000000000031, -15.199999999999964, -42.20000000000033, -45.00000000000031, -40.90000000000024, -51.800000000000466, -46.40000000000027, -9.299999999999988, -9.29999999999998, -41.90000000000031, -41.60000000000032, -65.30000000000037, -51.00000000000036, -8.099999999999984, -12.499999999999972, -8.699999999999982, -37.70000000000022, -41.20000000000027, -15.59999999999997, -11.99999999999997, -46.5000000000003, -58.600000000000385, -9.399999999999988, -27.8000000000001, -26.600000000000087, -13.899999999999963, -6.599999999999991, -17.599999999999994, -5.8999999999999915, -8.399999999999983, -44.90000000000022, -15.099999999999966, -5.8, -14.299999999999967, -9.09999999999998, -8.199999999999985, -10.799999999999976, -21.30000000000004, -25.10000000000004, -42.80000000000035, -15.19999999999996, -24.30000000000007, -10.79999999999998, -21.5, -11.79999999999997, -4.999999999999995, -11.79999999999997, -8.699999999999992, -42.300000000000296, -42.30000000000034, -9.899999999999977, -41.40000000000028, -10.799999999999974, -41.40000000000032, -34.000000000000114, -43.3000000000003, -32.40000000000017, -9.399999999999979], "episode_lengths": [160, 400, 245, 400, 400, 400, 400, 78, 400, 95, 50, 400, 400, 396, 400, 400, 400, 400, 400, 89, 400, 400, 400, 87, 400, 76, 354, 58, 400, 400, 302, 96, 400, 105, 400, 400, 400, 67, 52, 400, 104, 400, 400, 158, 400, 400, 375, 400, 400, 87, 104, 400, 400, 400, 400, 92, 125, 98, 350, 400, 160, 116, 400, 400, 87, 275, 256, 128, 75, 178, 70, 95, 400, 146, 60, 149, 101, 92, 107, 222, 231, 400, 155, 249, 104, 201, 115, 61, 115, 80, 400, 400, 110, 400, 109, 400, 308, 400, 300, 105]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20246289646847637, "mean_inference_ms": 0.6133444257374722, "mean_action_processing_ms": 0.06757845060552531, "mean_env_wait_ms": 6.122894851223021, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005412101745605469, "StateBufferConnector_ms": 0.0033025741577148438, "ViewRequirementAgentConnector_ms": 0.07354927062988281}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000, "num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 382.8006813066211, "num_env_steps_trained_throughput_per_sec": 382.8006813066211, "timesteps_total": 48000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 48000, "timers": {"training_iteration_time_ms": 10549.388, "sample_time_ms": 7078.604, "load_time_ms": 2.125, "load_throughput": 1882035.359, "learn_time_ms": 3466.372, "learn_throughput": 1153.944, "synch_weights_time_ms": 1.682}, "counters": {"num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000}, "done": false, "episodes_total": 170, "training_iteration": 12, "trial_id": "dbefe_00000", "date": "2024-03-07_12-14-35", "timestamp": 1709831675, "time_this_iter_s": 10.451706647872925, "time_total_s": 127.12398886680603, "pid": 103980, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fcd19c36f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 127.12398886680603, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 20.26153846153846, "ram_util_percent": 44.3, "gpu_util_percent0": 0.0776923076923077, "vram_util_percent0": 0.09879557291666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.10000000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 5.30871774881918, "policy_loss": -0.010895264852711911, "vf_loss": 5.318800258187838, "vf_explained_var": -0.18510826018548782, "kl": 0.008127666538409817, "entropy": 0.9743639695388014, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 11625.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_agent_steps_sampled": 52000, "num_agent_steps_trained": 52000}, "sampler_results": {"episode_reward_max": -4.099999999999998, "episode_reward_min": -65.30000000000037, "episode_reward_mean": -24.207000000000104, "episode_len_mean": 223.49, "episode_media": {}, "episodes_this_iter": 23, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-9.599999999999984, -40.40000000000029, -6.499999999999989, -38.20000000000025, -4.699999999999996, -48.9000000000002, -43.000000000000334, -35.80000000000018, -9.79999999999998, -43.500000000000234, -9.799999999999978, -41.80000000000028, -41.40000000000028, -42.60000000000029, -5.5999999999999925, -4.099999999999998, -51.60000000000025, -10.099999999999977, -45.10000000000029, -40.70000000000031, -15.199999999999964, -42.20000000000033, -45.00000000000031, -40.90000000000024, -51.800000000000466, -46.40000000000027, -9.299999999999988, -9.29999999999998, -41.90000000000031, -41.60000000000032, -65.30000000000037, -51.00000000000036, -8.099999999999984, -12.499999999999972, -8.699999999999982, -37.70000000000022, -41.20000000000027, -15.59999999999997, -11.99999999999997, -46.5000000000003, -58.600000000000385, -9.399999999999988, -27.8000000000001, -26.600000000000087, -13.899999999999963, -6.599999999999991, -17.599999999999994, -5.8999999999999915, -8.399999999999983, -44.90000000000022, -15.099999999999966, -5.8, -14.299999999999967, -9.09999999999998, -8.199999999999985, -10.799999999999976, -21.30000000000004, -25.10000000000004, -42.80000000000035, -15.19999999999996, -24.30000000000007, -10.79999999999998, -21.5, -11.79999999999997, -4.999999999999995, -11.79999999999997, -8.699999999999992, -42.300000000000296, -42.30000000000034, -9.899999999999977, -41.40000000000028, -10.799999999999974, -41.40000000000032, -34.000000000000114, -43.3000000000003, -32.40000000000017, -9.399999999999979, -44.40000000000012, -30.60000000000011, -6.099999999999991, -23.00000000000003, -27.300000000000118, -9.099999999999984, -8.099999999999984, -7.499999999999989, -49.50000000000025, -11.399999999999974, -17.9, -5.999999999999991, -53.200000000000394, -9.99999999999998, -22.500000000000064, -9.59999999999998, -9.399999999999979, -9.19999999999998, -24.30000000000009, -6.499999999999989, -9.09999999999998, -12.199999999999969, -9.899999999999977], "episode_lengths": [87, 400, 76, 354, 58, 400, 400, 302, 96, 400, 105, 400, 400, 400, 67, 52, 400, 104, 400, 400, 158, 400, 400, 375, 400, 400, 87, 104, 400, 400, 400, 400, 92, 125, 98, 350, 400, 160, 116, 400, 400, 87, 275, 256, 128, 75, 178, 70, 95, 400, 146, 60, 149, 101, 92, 107, 222, 231, 400, 155, 249, 104, 201, 115, 61, 115, 80, 400, 400, 110, 400, 109, 400, 308, 400, 300, 105, 335, 282, 72, 229, 267, 93, 92, 83, 400, 106, 190, 71, 400, 107, 225, 96, 104, 103, 238, 76, 102, 118, 110]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20298985179653364, "mean_inference_ms": 0.6131275799197179, "mean_action_processing_ms": 0.06757075149177505, "mean_env_wait_ms": 6.109862540333885, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005510091781616211, "StateBufferConnector_ms": 0.0033087730407714844, "ViewRequirementAgentConnector_ms": 0.07349252700805664}}, "episode_reward_max": -4.099999999999998, "episode_reward_min": -65.30000000000037, "episode_reward_mean": -24.207000000000104, "episode_len_mean": 223.49, "episodes_this_iter": 23, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-9.599999999999984, -40.40000000000029, -6.499999999999989, -38.20000000000025, -4.699999999999996, -48.9000000000002, -43.000000000000334, -35.80000000000018, -9.79999999999998, -43.500000000000234, -9.799999999999978, -41.80000000000028, -41.40000000000028, -42.60000000000029, -5.5999999999999925, -4.099999999999998, -51.60000000000025, -10.099999999999977, -45.10000000000029, -40.70000000000031, -15.199999999999964, -42.20000000000033, -45.00000000000031, -40.90000000000024, -51.800000000000466, -46.40000000000027, -9.299999999999988, -9.29999999999998, -41.90000000000031, -41.60000000000032, -65.30000000000037, -51.00000000000036, -8.099999999999984, -12.499999999999972, -8.699999999999982, -37.70000000000022, -41.20000000000027, -15.59999999999997, -11.99999999999997, -46.5000000000003, -58.600000000000385, -9.399999999999988, -27.8000000000001, -26.600000000000087, -13.899999999999963, -6.599999999999991, -17.599999999999994, -5.8999999999999915, -8.399999999999983, -44.90000000000022, -15.099999999999966, -5.8, -14.299999999999967, -9.09999999999998, -8.199999999999985, -10.799999999999976, -21.30000000000004, -25.10000000000004, -42.80000000000035, -15.19999999999996, -24.30000000000007, -10.79999999999998, -21.5, -11.79999999999997, -4.999999999999995, -11.79999999999997, -8.699999999999992, -42.300000000000296, -42.30000000000034, -9.899999999999977, -41.40000000000028, -10.799999999999974, -41.40000000000032, -34.000000000000114, -43.3000000000003, -32.40000000000017, -9.399999999999979, -44.40000000000012, -30.60000000000011, -6.099999999999991, -23.00000000000003, -27.300000000000118, -9.099999999999984, -8.099999999999984, -7.499999999999989, -49.50000000000025, -11.399999999999974, -17.9, -5.999999999999991, -53.200000000000394, -9.99999999999998, -22.500000000000064, -9.59999999999998, -9.399999999999979, -9.19999999999998, -24.30000000000009, -6.499999999999989, -9.09999999999998, -12.199999999999969, -9.899999999999977], "episode_lengths": [87, 400, 76, 354, 58, 400, 400, 302, 96, 400, 105, 400, 400, 400, 67, 52, 400, 104, 400, 400, 158, 400, 400, 375, 400, 400, 87, 104, 400, 400, 400, 400, 92, 125, 98, 350, 400, 160, 116, 400, 400, 87, 275, 256, 128, 75, 178, 70, 95, 400, 146, 60, 149, 101, 92, 107, 222, 231, 400, 155, 249, 104, 201, 115, 61, 115, 80, 400, 400, 110, 400, 109, 400, 308, 400, 300, 105, 335, 282, 72, 229, 267, 93, 92, 83, 400, 106, 190, 71, 400, 107, 225, 96, 104, 103, 238, 76, 102, 118, 110]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20298985179653364, "mean_inference_ms": 0.6131275799197179, "mean_action_processing_ms": 0.06757075149177505, "mean_env_wait_ms": 6.109862540333885, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005510091781616211, "StateBufferConnector_ms": 0.0033087730407714844, "ViewRequirementAgentConnector_ms": 0.07349252700805664}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 52000, "num_agent_steps_trained": 52000, "num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 382.84163184047634, "num_env_steps_trained_throughput_per_sec": 382.84163184047634, "timesteps_total": 52000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 52000, "timers": {"training_iteration_time_ms": 10529.057, "sample_time_ms": 7056.439, "load_time_ms": 2.158, "load_throughput": 1853795.054, "learn_time_ms": 3468.189, "learn_throughput": 1153.34, "synch_weights_time_ms": 1.658}, "counters": {"num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_agent_steps_sampled": 52000, "num_agent_steps_trained": 52000}, "done": false, "episodes_total": 193, "training_iteration": 13, "trial_id": "dbefe_00000", "date": "2024-03-07_12-14-45", "timestamp": 1709831685, "time_this_iter_s": 10.45059585571289, "time_total_s": 137.57458472251892, "pid": 103980, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fcd19c36f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 137.57458472251892, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 19.550000000000004, "ram_util_percent": 44.30714285714286, "gpu_util_percent0": 0.08642857142857142, "vram_util_percent0": 0.09879557291666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.10000000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 4.88760590979489, "policy_loss": -0.004707048715202398, "vf_loss": 4.891551338472674, "vf_explained_var": -0.12031854609007477, "kl": 0.007616212940841216, "entropy": 0.9754083878250532, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 12555.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 56000}, "sampler_results": {"episode_reward_max": -4.399999999999997, "episode_reward_min": -65.30000000000037, "episode_reward_mean": -20.35700000000007, "episode_len_mean": 189.94, "episode_media": {}, "episodes_this_iter": 26, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-9.299999999999988, -9.29999999999998, -41.90000000000031, -41.60000000000032, -65.30000000000037, -51.00000000000036, -8.099999999999984, -12.499999999999972, -8.699999999999982, -37.70000000000022, -41.20000000000027, -15.59999999999997, -11.99999999999997, -46.5000000000003, -58.600000000000385, -9.399999999999988, -27.8000000000001, -26.600000000000087, -13.899999999999963, -6.599999999999991, -17.599999999999994, -5.8999999999999915, -8.399999999999983, -44.90000000000022, -15.099999999999966, -5.8, -14.299999999999967, -9.09999999999998, -8.199999999999985, -10.799999999999976, -21.30000000000004, -25.10000000000004, -42.80000000000035, -15.19999999999996, -24.30000000000007, -10.79999999999998, -21.5, -11.79999999999997, -4.999999999999995, -11.79999999999997, -8.699999999999992, -42.300000000000296, -42.30000000000034, -9.899999999999977, -41.40000000000028, -10.799999999999974, -41.40000000000032, -34.000000000000114, -43.3000000000003, -32.40000000000017, -9.399999999999979, -44.40000000000012, -30.60000000000011, -6.099999999999991, -23.00000000000003, -27.300000000000118, -9.099999999999984, -8.099999999999984, -7.499999999999989, -49.50000000000025, -11.399999999999974, -17.9, -5.999999999999991, -53.200000000000394, -9.99999999999998, -22.500000000000064, -9.59999999999998, -9.399999999999979, -9.19999999999998, -24.30000000000009, -6.499999999999989, -9.09999999999998, -12.199999999999969, -9.899999999999977, -31.700000000000117, -7.999999999999988, -4.399999999999997, -5.699999999999992, -6.899999999999988, -8.89999999999998, -18.599999999999973, -8.89999999999998, -11.399999999999974, -12.299999999999969, -64.00000000000037, -5.299999999999994, -24.900000000000066, -14.89999999999996, -13.199999999999966, -10.499999999999975, -5.8999999999999915, -5.499999999999993, -7.599999999999985, -5.8999999999999915, -44.500000000000334, -29.400000000000162, -13.699999999999964, -18.199999999999953, -6.8999999999999995, -42.50000000000032], "episode_lengths": [87, 104, 400, 400, 400, 400, 92, 125, 98, 350, 400, 160, 116, 400, 400, 87, 275, 256, 128, 75, 178, 70, 95, 400, 146, 60, 149, 101, 92, 107, 222, 231, 400, 155, 249, 104, 201, 115, 61, 115, 80, 400, 400, 110, 400, 109, 400, 308, 400, 300, 105, 335, 282, 72, 229, 267, 93, 92, 83, 400, 106, 190, 71, 400, 107, 225, 96, 104, 103, 238, 76, 102, 118, 110, 283, 87, 55, 68, 80, 96, 182, 98, 113, 134, 400, 64, 251, 159, 143, 108, 70, 66, 87, 70, 400, 305, 133, 160, 67, 400]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20344780383866662, "mean_inference_ms": 0.6127169703856601, "mean_action_processing_ms": 0.06754425768383875, "mean_env_wait_ms": 6.098313225237195, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0053958892822265625, "StateBufferConnector_ms": 0.0032939910888671875, "ViewRequirementAgentConnector_ms": 0.07300972938537598}}, "episode_reward_max": -4.399999999999997, "episode_reward_min": -65.30000000000037, "episode_reward_mean": -20.35700000000007, "episode_len_mean": 189.94, "episodes_this_iter": 26, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-9.299999999999988, -9.29999999999998, -41.90000000000031, -41.60000000000032, -65.30000000000037, -51.00000000000036, -8.099999999999984, -12.499999999999972, -8.699999999999982, -37.70000000000022, -41.20000000000027, -15.59999999999997, -11.99999999999997, -46.5000000000003, -58.600000000000385, -9.399999999999988, -27.8000000000001, -26.600000000000087, -13.899999999999963, -6.599999999999991, -17.599999999999994, -5.8999999999999915, -8.399999999999983, -44.90000000000022, -15.099999999999966, -5.8, -14.299999999999967, -9.09999999999998, -8.199999999999985, -10.799999999999976, -21.30000000000004, -25.10000000000004, -42.80000000000035, -15.19999999999996, -24.30000000000007, -10.79999999999998, -21.5, -11.79999999999997, -4.999999999999995, -11.79999999999997, -8.699999999999992, -42.300000000000296, -42.30000000000034, -9.899999999999977, -41.40000000000028, -10.799999999999974, -41.40000000000032, -34.000000000000114, -43.3000000000003, -32.40000000000017, -9.399999999999979, -44.40000000000012, -30.60000000000011, -6.099999999999991, -23.00000000000003, -27.300000000000118, -9.099999999999984, -8.099999999999984, -7.499999999999989, -49.50000000000025, -11.399999999999974, -17.9, -5.999999999999991, -53.200000000000394, -9.99999999999998, -22.500000000000064, -9.59999999999998, -9.399999999999979, -9.19999999999998, -24.30000000000009, -6.499999999999989, -9.09999999999998, -12.199999999999969, -9.899999999999977, -31.700000000000117, -7.999999999999988, -4.399999999999997, -5.699999999999992, -6.899999999999988, -8.89999999999998, -18.599999999999973, -8.89999999999998, -11.399999999999974, -12.299999999999969, -64.00000000000037, -5.299999999999994, -24.900000000000066, -14.89999999999996, -13.199999999999966, -10.499999999999975, -5.8999999999999915, -5.499999999999993, -7.599999999999985, -5.8999999999999915, -44.500000000000334, -29.400000000000162, -13.699999999999964, -18.199999999999953, -6.8999999999999995, -42.50000000000032], "episode_lengths": [87, 104, 400, 400, 400, 400, 92, 125, 98, 350, 400, 160, 116, 400, 400, 87, 275, 256, 128, 75, 178, 70, 95, 400, 146, 60, 149, 101, 92, 107, 222, 231, 400, 155, 249, 104, 201, 115, 61, 115, 80, 400, 400, 110, 400, 109, 400, 308, 400, 300, 105, 335, 282, 72, 229, 267, 93, 92, 83, 400, 106, 190, 71, 400, 107, 225, 96, 104, 103, 238, 76, 102, 118, 110, 283, 87, 55, 68, 80, 96, 182, 98, 113, 134, 400, 64, 251, 159, 143, 108, 70, 66, 87, 70, 400, 305, 133, 160, 67, 400]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20344780383866662, "mean_inference_ms": 0.6127169703856601, "mean_action_processing_ms": 0.06754425768383875, "mean_env_wait_ms": 6.098313225237195, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0053958892822265625, "StateBufferConnector_ms": 0.0032939910888671875, "ViewRequirementAgentConnector_ms": 0.07300972938537598}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 56000, "num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 381.14982677977775, "num_env_steps_trained_throughput_per_sec": 381.14982677977775, "timesteps_total": 56000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 56000, "timers": {"training_iteration_time_ms": 10533.669, "sample_time_ms": 7056.097, "load_time_ms": 2.156, "load_throughput": 1855004.367, "learn_time_ms": 3473.138, "learn_throughput": 1151.696, "synch_weights_time_ms": 1.661}, "counters": {"num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 56000}, "done": false, "episodes_total": 219, "training_iteration": 14, "trial_id": "dbefe_00000", "date": "2024-03-07_12-14-56", "timestamp": 1709831696, "time_this_iter_s": 10.496673822402954, "time_total_s": 148.07125854492188, "pid": 103980, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fcd19c36f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 148.07125854492188, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 19.442857142857147, "ram_util_percent": 44.32857142857142, "gpu_util_percent0": 0.08357142857142856, "vram_util_percent0": 0.09981863839285714}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.10000000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 4.986898052177683, "policy_loss": -0.011660833232184892, "vf_loss": 4.9976278507901775, "vf_explained_var": 0.19134334280926693, "kl": 0.009310319230942736, "entropy": 0.9395722512916852, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 13485.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000}, "sampler_results": {"episode_reward_max": -3.5, "episode_reward_min": -64.20000000000037, "episode_reward_mean": -17.786000000000048, "episode_len_mean": 165.95, "episode_media": {}, "episodes_this_iter": 31, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-25.10000000000004, -42.80000000000035, -15.19999999999996, -24.30000000000007, -10.79999999999998, -21.5, -11.79999999999997, -4.999999999999995, -11.79999999999997, -8.699999999999992, -42.300000000000296, -42.30000000000034, -9.899999999999977, -41.40000000000028, -10.799999999999974, -41.40000000000032, -34.000000000000114, -43.3000000000003, -32.40000000000017, -9.399999999999979, -44.40000000000012, -30.60000000000011, -6.099999999999991, -23.00000000000003, -27.300000000000118, -9.099999999999984, -8.099999999999984, -7.499999999999989, -49.50000000000025, -11.399999999999974, -17.9, -5.999999999999991, -53.200000000000394, -9.99999999999998, -22.500000000000064, -9.59999999999998, -9.399999999999979, -9.19999999999998, -24.30000000000009, -6.499999999999989, -9.09999999999998, -12.199999999999969, -9.899999999999977, -31.700000000000117, -7.999999999999988, -4.399999999999997, -5.699999999999992, -6.899999999999988, -8.89999999999998, -18.599999999999973, -8.89999999999998, -11.399999999999974, -12.299999999999969, -64.00000000000037, -5.299999999999994, -24.900000000000066, -14.89999999999996, -13.199999999999966, -10.499999999999975, -5.8999999999999915, -5.499999999999993, -7.599999999999985, -5.8999999999999915, -44.500000000000334, -29.400000000000162, -13.699999999999964, -18.199999999999953, -6.8999999999999995, -42.50000000000032, -23.500000000000085, -17.8, -8.499999999999998, -37.400000000000134, -8.699999999999982, -22.9, -16.69999999999996, -5.499999999999993, -6.799999999999997, -4.699999999999996, -6.099999999999994, -64.20000000000037, -6.699999999999991, -63.60000000000037, -3.6999999999999993, -11.799999999999978, -16.89999999999998, -7.799999999999995, -11.099999999999973, -9.099999999999982, -4.799999999999995, -8.29999999999999, -12.499999999999977, -6.899999999999997, -3.5, -7.9999999999999964, -6.599999999999989, -5.599999999999994, -8.199999999999992, -7.599999999999998, -22.40000000000005], "episode_lengths": [231, 400, 155, 249, 104, 201, 115, 61, 115, 80, 400, 400, 110, 400, 109, 400, 308, 400, 300, 105, 335, 282, 72, 229, 267, 93, 92, 83, 400, 106, 190, 71, 400, 107, 225, 96, 104, 103, 238, 76, 102, 118, 110, 283, 87, 55, 68, 80, 96, 182, 98, 113, 134, 400, 64, 251, 159, 143, 108, 70, 66, 87, 70, 400, 305, 133, 160, 67, 400, 227, 187, 77, 334, 98, 212, 159, 66, 69, 58, 68, 400, 75, 400, 48, 107, 162, 75, 108, 98, 59, 83, 99, 70, 46, 77, 77, 65, 82, 72, 216]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20526504983521918, "mean_inference_ms": 0.6124989201768147, "mean_action_processing_ms": 0.06762082845254454, "mean_env_wait_ms": 6.089243306538875, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005343198776245117, "StateBufferConnector_ms": 0.003282785415649414, "ViewRequirementAgentConnector_ms": 0.07325935363769531}}, "episode_reward_max": -3.5, "episode_reward_min": -64.20000000000037, "episode_reward_mean": -17.786000000000048, "episode_len_mean": 165.95, "episodes_this_iter": 31, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-25.10000000000004, -42.80000000000035, -15.19999999999996, -24.30000000000007, -10.79999999999998, -21.5, -11.79999999999997, -4.999999999999995, -11.79999999999997, -8.699999999999992, -42.300000000000296, -42.30000000000034, -9.899999999999977, -41.40000000000028, -10.799999999999974, -41.40000000000032, -34.000000000000114, -43.3000000000003, -32.40000000000017, -9.399999999999979, -44.40000000000012, -30.60000000000011, -6.099999999999991, -23.00000000000003, -27.300000000000118, -9.099999999999984, -8.099999999999984, -7.499999999999989, -49.50000000000025, -11.399999999999974, -17.9, -5.999999999999991, -53.200000000000394, -9.99999999999998, -22.500000000000064, -9.59999999999998, -9.399999999999979, -9.19999999999998, -24.30000000000009, -6.499999999999989, -9.09999999999998, -12.199999999999969, -9.899999999999977, -31.700000000000117, -7.999999999999988, -4.399999999999997, -5.699999999999992, -6.899999999999988, -8.89999999999998, -18.599999999999973, -8.89999999999998, -11.399999999999974, -12.299999999999969, -64.00000000000037, -5.299999999999994, -24.900000000000066, -14.89999999999996, -13.199999999999966, -10.499999999999975, -5.8999999999999915, -5.499999999999993, -7.599999999999985, -5.8999999999999915, -44.500000000000334, -29.400000000000162, -13.699999999999964, -18.199999999999953, -6.8999999999999995, -42.50000000000032, -23.500000000000085, -17.8, -8.499999999999998, -37.400000000000134, -8.699999999999982, -22.9, -16.69999999999996, -5.499999999999993, -6.799999999999997, -4.699999999999996, -6.099999999999994, -64.20000000000037, -6.699999999999991, -63.60000000000037, -3.6999999999999993, -11.799999999999978, -16.89999999999998, -7.799999999999995, -11.099999999999973, -9.099999999999982, -4.799999999999995, -8.29999999999999, -12.499999999999977, -6.899999999999997, -3.5, -7.9999999999999964, -6.599999999999989, -5.599999999999994, -8.199999999999992, -7.599999999999998, -22.40000000000005], "episode_lengths": [231, 400, 155, 249, 104, 201, 115, 61, 115, 80, 400, 400, 110, 400, 109, 400, 308, 400, 300, 105, 335, 282, 72, 229, 267, 93, 92, 83, 400, 106, 190, 71, 400, 107, 225, 96, 104, 103, 238, 76, 102, 118, 110, 283, 87, 55, 68, 80, 96, 182, 98, 113, 134, 400, 64, 251, 159, 143, 108, 70, 66, 87, 70, 400, 305, 133, 160, 67, 400, 227, 187, 77, 334, 98, 212, 159, 66, 69, 58, 68, 400, 75, 400, 48, 107, 162, 75, 108, 98, 59, 83, 99, 70, 46, 77, 77, 65, 82, 72, 216]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20526504983521918, "mean_inference_ms": 0.6124989201768147, "mean_action_processing_ms": 0.06762082845254454, "mean_env_wait_ms": 6.089243306538875, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005343198776245117, "StateBufferConnector_ms": 0.003282785415649414, "ViewRequirementAgentConnector_ms": 0.07325935363769531}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000, "num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 368.92442487936063, "num_env_steps_trained_throughput_per_sec": 368.92442487936063, "timesteps_total": 60000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 60000, "timers": {"training_iteration_time_ms": 10556.791, "sample_time_ms": 7078.322, "load_time_ms": 2.154, "load_throughput": 1856769.924, "learn_time_ms": 3474.053, "learn_throughput": 1151.393, "synch_weights_time_ms": 1.649}, "counters": {"num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000}, "done": false, "episodes_total": 250, "training_iteration": 15, "trial_id": "dbefe_00000", "date": "2024-03-07_12-15-07", "timestamp": 1709831707, "time_this_iter_s": 10.844516038894653, "time_total_s": 158.91577458381653, "pid": 103980, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fcd19c36f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 158.91577458381653, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 19.735714285714288, "ram_util_percent": 44.25714285714286, "gpu_util_percent0": 0.07785714285714286, "vram_util_percent0": 0.1005859375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.10000000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 3.05262602364334, "policy_loss": -0.0083844680158842, "vf_loss": 3.060251633165985, "vf_explained_var": 0.5673505072952598, "kl": 0.0075886736291269265, "entropy": 0.8696872203580794, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 14415.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000}, "sampler_results": {"episode_reward_max": -3.3000000000000007, "episode_reward_min": -64.20000000000037, "episode_reward_mean": -13.080000000000016, "episode_len_mean": 122.05, "episode_media": {}, "episodes_this_iter": 41, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-12.199999999999969, -9.899999999999977, -31.700000000000117, -7.999999999999988, -4.399999999999997, -5.699999999999992, -6.899999999999988, -8.89999999999998, -18.599999999999973, -8.89999999999998, -11.399999999999974, -12.299999999999969, -64.00000000000037, -5.299999999999994, -24.900000000000066, -14.89999999999996, -13.199999999999966, -10.499999999999975, -5.8999999999999915, -5.499999999999993, -7.599999999999985, -5.8999999999999915, -44.500000000000334, -29.400000000000162, -13.699999999999964, -18.199999999999953, -6.8999999999999995, -42.50000000000032, -23.500000000000085, -17.8, -8.499999999999998, -37.400000000000134, -8.699999999999982, -22.9, -16.69999999999996, -5.499999999999993, -6.799999999999997, -4.699999999999996, -6.099999999999994, -64.20000000000037, -6.699999999999991, -63.60000000000037, -3.6999999999999993, -11.799999999999978, -16.89999999999998, -7.799999999999995, -11.099999999999973, -9.099999999999982, -4.799999999999995, -8.29999999999999, -12.499999999999977, -6.899999999999997, -3.5, -7.9999999999999964, -6.599999999999989, -5.599999999999994, -8.199999999999992, -7.599999999999998, -22.40000000000005, -20.19999999999996, -19.700000000000014, -6.199999999999996, -11.999999999999979, -9.69999999999998, -8.099999999999994, -12.19999999999998, -7.6999999999999975, -6.1000000000000005, -22.600000000000016, -8.099999999999985, -5.999999999999995, -7.899999999999997, -4.899999999999997, -19.3, -10.099999999999978, -14.899999999999961, -5.099999999999994, -11.299999999999972, -9.799999999999981, -8.999999999999984, -6.499999999999989, -13.199999999999966, -8.699999999999987, -9.79999999999998, -9.599999999999985, -11.79999999999997, -10.89999999999999, -21.299999999999972, -6.799999999999993, -3.3000000000000007, -8.299999999999992, -3.4000000000000004, -8.099999999999996, -9.199999999999992, -9.599999999999985, -8.299999999999988, -5.899999999999994, -8.499999999999991, -5.799999999999994, -8.399999999999988], "episode_lengths": [118, 110, 283, 87, 55, 68, 80, 96, 182, 98, 113, 134, 400, 64, 251, 159, 143, 108, 70, 66, 87, 70, 400, 305, 133, 160, 67, 400, 227, 187, 77, 334, 98, 212, 159, 66, 69, 58, 68, 400, 75, 400, 48, 107, 162, 75, 108, 98, 59, 83, 99, 70, 46, 77, 77, 65, 82, 72, 216, 181, 187, 67, 104, 101, 76, 96, 73, 61, 189, 89, 67, 72, 58, 179, 98, 138, 62, 117, 93, 88, 76, 122, 87, 98, 88, 121, 86, 173, 74, 44, 82, 45, 74, 81, 88, 89, 67, 82, 67, 84]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20749558198344914, "mean_inference_ms": 0.6125123934011095, "mean_action_processing_ms": 0.06761119553070426, "mean_env_wait_ms": 6.0947626738655165, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0053102970123291016, "StateBufferConnector_ms": 0.0033364295959472656, "ViewRequirementAgentConnector_ms": 0.07354545593261719}}, "episode_reward_max": -3.3000000000000007, "episode_reward_min": -64.20000000000037, "episode_reward_mean": -13.080000000000016, "episode_len_mean": 122.05, "episodes_this_iter": 41, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-12.199999999999969, -9.899999999999977, -31.700000000000117, -7.999999999999988, -4.399999999999997, -5.699999999999992, -6.899999999999988, -8.89999999999998, -18.599999999999973, -8.89999999999998, -11.399999999999974, -12.299999999999969, -64.00000000000037, -5.299999999999994, -24.900000000000066, -14.89999999999996, -13.199999999999966, -10.499999999999975, -5.8999999999999915, -5.499999999999993, -7.599999999999985, -5.8999999999999915, -44.500000000000334, -29.400000000000162, -13.699999999999964, -18.199999999999953, -6.8999999999999995, -42.50000000000032, -23.500000000000085, -17.8, -8.499999999999998, -37.400000000000134, -8.699999999999982, -22.9, -16.69999999999996, -5.499999999999993, -6.799999999999997, -4.699999999999996, -6.099999999999994, -64.20000000000037, -6.699999999999991, -63.60000000000037, -3.6999999999999993, -11.799999999999978, -16.89999999999998, -7.799999999999995, -11.099999999999973, -9.099999999999982, -4.799999999999995, -8.29999999999999, -12.499999999999977, -6.899999999999997, -3.5, -7.9999999999999964, -6.599999999999989, -5.599999999999994, -8.199999999999992, -7.599999999999998, -22.40000000000005, -20.19999999999996, -19.700000000000014, -6.199999999999996, -11.999999999999979, -9.69999999999998, -8.099999999999994, -12.19999999999998, -7.6999999999999975, -6.1000000000000005, -22.600000000000016, -8.099999999999985, -5.999999999999995, -7.899999999999997, -4.899999999999997, -19.3, -10.099999999999978, -14.899999999999961, -5.099999999999994, -11.299999999999972, -9.799999999999981, -8.999999999999984, -6.499999999999989, -13.199999999999966, -8.699999999999987, -9.79999999999998, -9.599999999999985, -11.79999999999997, -10.89999999999999, -21.299999999999972, -6.799999999999993, -3.3000000000000007, -8.299999999999992, -3.4000000000000004, -8.099999999999996, -9.199999999999992, -9.599999999999985, -8.299999999999988, -5.899999999999994, -8.499999999999991, -5.799999999999994, -8.399999999999988], "episode_lengths": [118, 110, 283, 87, 55, 68, 80, 96, 182, 98, 113, 134, 400, 64, 251, 159, 143, 108, 70, 66, 87, 70, 400, 305, 133, 160, 67, 400, 227, 187, 77, 334, 98, 212, 159, 66, 69, 58, 68, 400, 75, 400, 48, 107, 162, 75, 108, 98, 59, 83, 99, 70, 46, 77, 77, 65, 82, 72, 216, 181, 187, 67, 104, 101, 76, 96, 73, 61, 189, 89, 67, 72, 58, 179, 98, 138, 62, 117, 93, 88, 76, 122, 87, 98, 88, 121, 86, 173, 74, 44, 82, 45, 74, 81, 88, 89, 67, 82, 67, 84]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20749558198344914, "mean_inference_ms": 0.6125123934011095, "mean_action_processing_ms": 0.06761119553070426, "mean_env_wait_ms": 6.0947626738655165, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0053102970123291016, "StateBufferConnector_ms": 0.0033364295959472656, "ViewRequirementAgentConnector_ms": 0.07354545593261719}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000, "num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 369.72127315143894, "num_env_steps_trained_throughput_per_sec": 369.72127315143894, "timesteps_total": 64000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 64000, "timers": {"training_iteration_time_ms": 10580.39, "sample_time_ms": 7107.553, "load_time_ms": 2.173, "load_throughput": 1840474.785, "learn_time_ms": 3468.403, "learn_throughput": 1153.268, "synch_weights_time_ms": 1.644}, "counters": {"num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000}, "done": false, "episodes_total": 291, "training_iteration": 16, "trial_id": "dbefe_00000", "date": "2024-03-07_12-15-18", "timestamp": 1709831718, "time_this_iter_s": 10.821233034133911, "time_total_s": 169.73700761795044, "pid": 103980, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fcd19c36f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 169.73700761795044, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 19.928571428571427, "ram_util_percent": 44.22142857142857, "gpu_util_percent0": 0.07571428571428572, "vram_util_percent0": 0.1005859375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.10000000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 4.721744441583512, "policy_loss": -0.0010422069018566481, "vf_loss": 4.722155959311352, "vf_explained_var": 0.1336530646970195, "kl": 0.006306839663308366, "entropy": 0.8913610777547283, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 15345.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_agent_steps_sampled": 68000, "num_agent_steps_trained": 68000}, "sampler_results": {"episode_reward_max": -3.200000000000001, "episode_reward_min": -72.10000000000048, "episode_reward_mean": -12.064000000000007, "episode_len_mean": 109.67, "episode_media": {}, "episodes_this_iter": 33, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-22.9, -16.69999999999996, -5.499999999999993, -6.799999999999997, -4.699999999999996, -6.099999999999994, -64.20000000000037, -6.699999999999991, -63.60000000000037, -3.6999999999999993, -11.799999999999978, -16.89999999999998, -7.799999999999995, -11.099999999999973, -9.099999999999982, -4.799999999999995, -8.29999999999999, -12.499999999999977, -6.899999999999997, -3.5, -7.9999999999999964, -6.599999999999989, -5.599999999999994, -8.199999999999992, -7.599999999999998, -22.40000000000005, -20.19999999999996, -19.700000000000014, -6.199999999999996, -11.999999999999979, -9.69999999999998, -8.099999999999994, -12.19999999999998, -7.6999999999999975, -6.1000000000000005, -22.600000000000016, -8.099999999999985, -5.999999999999995, -7.899999999999997, -4.899999999999997, -19.3, -10.099999999999978, -14.899999999999961, -5.099999999999994, -11.299999999999972, -9.799999999999981, -8.999999999999984, -6.499999999999989, -13.199999999999966, -8.699999999999987, -9.79999999999998, -9.599999999999985, -11.79999999999997, -10.89999999999999, -21.299999999999972, -6.799999999999993, -3.3000000000000007, -8.299999999999992, -3.4000000000000004, -8.099999999999996, -9.199999999999992, -9.599999999999985, -8.299999999999988, -5.899999999999994, -8.499999999999991, -5.799999999999994, -8.399999999999988, -24.400000000000087, -10.099999999999985, -7.899999999999984, -7.099999999999998, -13.699999999999978, -4.999999999999995, -3.200000000000001, -23.000000000000007, -72.10000000000048, -4.300000000000001, -6.29999999999999, -9.499999999999988, -6.599999999999989, -19.799999999999955, -7.200000000000003, -10.09999999999998, -5.999999999999997, -5.699999999999992, -16.49999999999996, -26.900000000000066, -4.6, -5.399999999999993, -8.599999999999993, -36.50000000000015, -19.69999999999996, -10.999999999999973, -7.499999999999993, -6.800000000000001, -4.599999999999996, -5.999999999999991, -10.699999999999976, -9.399999999999988, -29.899999999999995], "episode_lengths": [212, 159, 66, 69, 58, 68, 400, 75, 400, 48, 107, 162, 75, 108, 98, 59, 83, 99, 70, 46, 77, 77, 65, 82, 72, 216, 181, 187, 67, 104, 101, 76, 96, 73, 61, 189, 89, 67, 72, 58, 179, 98, 138, 62, 117, 93, 88, 76, 122, 87, 98, 88, 121, 86, 173, 74, 44, 82, 45, 74, 81, 88, 89, 67, 82, 67, 84, 254, 88, 90, 70, 101, 61, 43, 197, 400, 50, 74, 84, 77, 157, 66, 98, 64, 68, 158, 250, 53, 65, 78, 331, 184, 121, 79, 65, 57, 71, 102, 86, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20923825291389384, "mean_inference_ms": 0.6125100742170237, "mean_action_processing_ms": 0.06754464292713447, "mean_env_wait_ms": 6.109080670011099, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005333662033081055, "StateBufferConnector_ms": 0.003246307373046875, "ViewRequirementAgentConnector_ms": 0.07387924194335938}}, "episode_reward_max": -3.200000000000001, "episode_reward_min": -72.10000000000048, "episode_reward_mean": -12.064000000000007, "episode_len_mean": 109.67, "episodes_this_iter": 33, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-22.9, -16.69999999999996, -5.499999999999993, -6.799999999999997, -4.699999999999996, -6.099999999999994, -64.20000000000037, -6.699999999999991, -63.60000000000037, -3.6999999999999993, -11.799999999999978, -16.89999999999998, -7.799999999999995, -11.099999999999973, -9.099999999999982, -4.799999999999995, -8.29999999999999, -12.499999999999977, -6.899999999999997, -3.5, -7.9999999999999964, -6.599999999999989, -5.599999999999994, -8.199999999999992, -7.599999999999998, -22.40000000000005, -20.19999999999996, -19.700000000000014, -6.199999999999996, -11.999999999999979, -9.69999999999998, -8.099999999999994, -12.19999999999998, -7.6999999999999975, -6.1000000000000005, -22.600000000000016, -8.099999999999985, -5.999999999999995, -7.899999999999997, -4.899999999999997, -19.3, -10.099999999999978, -14.899999999999961, -5.099999999999994, -11.299999999999972, -9.799999999999981, -8.999999999999984, -6.499999999999989, -13.199999999999966, -8.699999999999987, -9.79999999999998, -9.599999999999985, -11.79999999999997, -10.89999999999999, -21.299999999999972, -6.799999999999993, -3.3000000000000007, -8.299999999999992, -3.4000000000000004, -8.099999999999996, -9.199999999999992, -9.599999999999985, -8.299999999999988, -5.899999999999994, -8.499999999999991, -5.799999999999994, -8.399999999999988, -24.400000000000087, -10.099999999999985, -7.899999999999984, -7.099999999999998, -13.699999999999978, -4.999999999999995, -3.200000000000001, -23.000000000000007, -72.10000000000048, -4.300000000000001, -6.29999999999999, -9.499999999999988, -6.599999999999989, -19.799999999999955, -7.200000000000003, -10.09999999999998, -5.999999999999997, -5.699999999999992, -16.49999999999996, -26.900000000000066, -4.6, -5.399999999999993, -8.599999999999993, -36.50000000000015, -19.69999999999996, -10.999999999999973, -7.499999999999993, -6.800000000000001, -4.599999999999996, -5.999999999999991, -10.699999999999976, -9.399999999999988, -29.899999999999995], "episode_lengths": [212, 159, 66, 69, 58, 68, 400, 75, 400, 48, 107, 162, 75, 108, 98, 59, 83, 99, 70, 46, 77, 77, 65, 82, 72, 216, 181, 187, 67, 104, 101, 76, 96, 73, 61, 189, 89, 67, 72, 58, 179, 98, 138, 62, 117, 93, 88, 76, 122, 87, 98, 88, 121, 86, 173, 74, 44, 82, 45, 74, 81, 88, 89, 67, 82, 67, 84, 254, 88, 90, 70, 101, 61, 43, 197, 400, 50, 74, 84, 77, 157, 66, 98, 64, 68, 158, 250, 53, 65, 78, 331, 184, 121, 79, 65, 57, 71, 102, 86, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20923825291389384, "mean_inference_ms": 0.6125100742170237, "mean_action_processing_ms": 0.06754464292713447, "mean_env_wait_ms": 6.109080670011099, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005333662033081055, "StateBufferConnector_ms": 0.003246307373046875, "ViewRequirementAgentConnector_ms": 0.07387924194335938}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 68000, "num_agent_steps_trained": 68000, "num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 368.37456885558163, "num_env_steps_trained_throughput_per_sec": 368.37456885558163, "timesteps_total": 68000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 68000, "timers": {"training_iteration_time_ms": 10609.42, "sample_time_ms": 7125.652, "load_time_ms": 2.174, "load_throughput": 1840212.351, "learn_time_ms": 3479.335, "learn_throughput": 1149.645, "synch_weights_time_ms": 1.643}, "counters": {"num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_agent_steps_sampled": 68000, "num_agent_steps_trained": 68000}, "done": false, "episodes_total": 324, "training_iteration": 17, "trial_id": "dbefe_00000", "date": "2024-03-07_12-15-28", "timestamp": 1709831728, "time_this_iter_s": 10.860721826553345, "time_total_s": 180.59772944450378, "pid": 103980, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fcd19c36f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 180.59772944450378, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 19.74285714285714, "ram_util_percent": 44.221428571428575, "gpu_util_percent0": 0.0757142857142857, "vram_util_percent0": 0.1005859375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.10000000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 3.6265334160632943, "policy_loss": -0.0018752935993415053, "vf_loss": 3.627623391119383, "vf_explained_var": 0.47616797083167617, "kl": 0.007853090674950212, "entropy": 0.8842812397146738, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 16275.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000}, "sampler_results": {"episode_reward_max": -3.200000000000001, "episode_reward_min": -74.1000000000005, "episode_reward_mean": -12.025000000000004, "episode_len_mean": 107.29, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-19.3, -10.099999999999978, -14.899999999999961, -5.099999999999994, -11.299999999999972, -9.799999999999981, -8.999999999999984, -6.499999999999989, -13.199999999999966, -8.699999999999987, -9.79999999999998, -9.599999999999985, -11.79999999999997, -10.89999999999999, -21.299999999999972, -6.799999999999993, -3.3000000000000007, -8.299999999999992, -3.4000000000000004, -8.099999999999996, -9.199999999999992, -9.599999999999985, -8.299999999999988, -5.899999999999994, -8.499999999999991, -5.799999999999994, -8.399999999999988, -24.400000000000087, -10.099999999999985, -7.899999999999984, -7.099999999999998, -13.699999999999978, -4.999999999999995, -3.200000000000001, -23.000000000000007, -72.10000000000048, -4.300000000000001, -6.29999999999999, -9.499999999999988, -6.599999999999989, -19.799999999999955, -7.200000000000003, -10.09999999999998, -5.999999999999997, -5.699999999999992, -16.49999999999996, -26.900000000000066, -4.6, -5.399999999999993, -8.599999999999993, -36.50000000000015, -19.69999999999996, -10.999999999999973, -7.499999999999993, -6.800000000000001, -4.599999999999996, -5.999999999999991, -10.699999999999976, -9.399999999999988, -29.899999999999995, -74.1000000000005, -3.3000000000000007, -9.699999999999978, -21.1, -3.799999999999999, -5.4, -6.699999999999989, -10.599999999999975, -9.69999999999999, -5.299999999999996, -14.299999999999962, -11.099999999999973, -4.799999999999995, -7.9, -4.599999999999996, -5.399999999999993, -19.299999999999997, -12.899999999999968, -4.799999999999995, -13.799999999999969, -5.099999999999999, -15.099999999999973, -5.299999999999999, -9.899999999999984, -7.799999999999999, -10.999999999999975, -5.299999999999994, -72.20000000000047, -18.499999999999954, -6.4999999999999964, -6.999999999999994, -11.899999999999984, -16.799999999999958, -6.700000000000003, -8.699999999999985, -8.69999999999999, -9.299999999999988, -5.599999999999999, -10.399999999999975, -9.09999999999999], "episode_lengths": [179, 98, 138, 62, 117, 93, 88, 76, 122, 87, 98, 88, 121, 86, 173, 74, 44, 82, 45, 74, 81, 88, 89, 67, 82, 67, 84, 254, 88, 90, 70, 101, 61, 43, 197, 400, 50, 74, 84, 77, 157, 66, 98, 64, 68, 158, 250, 53, 65, 78, 331, 184, 121, 79, 65, 57, 71, 102, 86, 250, 400, 44, 108, 183, 49, 56, 78, 111, 84, 60, 136, 111, 59, 69, 57, 65, 195, 115, 59, 118, 57, 108, 58, 94, 68, 108, 64, 400, 155, 68, 74, 94, 152, 62, 89, 85, 85, 60, 115, 81]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21106930477063493, "mean_inference_ms": 0.6125588408009303, "mean_action_processing_ms": 0.06758077833152652, "mean_env_wait_ms": 6.120900834590052, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005422353744506836, "StateBufferConnector_ms": 0.003228902816772461, "ViewRequirementAgentConnector_ms": 0.0736086368560791}}, "episode_reward_max": -3.200000000000001, "episode_reward_min": -74.1000000000005, "episode_reward_mean": -12.025000000000004, "episode_len_mean": 107.29, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-19.3, -10.099999999999978, -14.899999999999961, -5.099999999999994, -11.299999999999972, -9.799999999999981, -8.999999999999984, -6.499999999999989, -13.199999999999966, -8.699999999999987, -9.79999999999998, -9.599999999999985, -11.79999999999997, -10.89999999999999, -21.299999999999972, -6.799999999999993, -3.3000000000000007, -8.299999999999992, -3.4000000000000004, -8.099999999999996, -9.199999999999992, -9.599999999999985, -8.299999999999988, -5.899999999999994, -8.499999999999991, -5.799999999999994, -8.399999999999988, -24.400000000000087, -10.099999999999985, -7.899999999999984, -7.099999999999998, -13.699999999999978, -4.999999999999995, -3.200000000000001, -23.000000000000007, -72.10000000000048, -4.300000000000001, -6.29999999999999, -9.499999999999988, -6.599999999999989, -19.799999999999955, -7.200000000000003, -10.09999999999998, -5.999999999999997, -5.699999999999992, -16.49999999999996, -26.900000000000066, -4.6, -5.399999999999993, -8.599999999999993, -36.50000000000015, -19.69999999999996, -10.999999999999973, -7.499999999999993, -6.800000000000001, -4.599999999999996, -5.999999999999991, -10.699999999999976, -9.399999999999988, -29.899999999999995, -74.1000000000005, -3.3000000000000007, -9.699999999999978, -21.1, -3.799999999999999, -5.4, -6.699999999999989, -10.599999999999975, -9.69999999999999, -5.299999999999996, -14.299999999999962, -11.099999999999973, -4.799999999999995, -7.9, -4.599999999999996, -5.399999999999993, -19.299999999999997, -12.899999999999968, -4.799999999999995, -13.799999999999969, -5.099999999999999, -15.099999999999973, -5.299999999999999, -9.899999999999984, -7.799999999999999, -10.999999999999975, -5.299999999999994, -72.20000000000047, -18.499999999999954, -6.4999999999999964, -6.999999999999994, -11.899999999999984, -16.799999999999958, -6.700000000000003, -8.699999999999985, -8.69999999999999, -9.299999999999988, -5.599999999999999, -10.399999999999975, -9.09999999999999], "episode_lengths": [179, 98, 138, 62, 117, 93, 88, 76, 122, 87, 98, 88, 121, 86, 173, 74, 44, 82, 45, 74, 81, 88, 89, 67, 82, 67, 84, 254, 88, 90, 70, 101, 61, 43, 197, 400, 50, 74, 84, 77, 157, 66, 98, 64, 68, 158, 250, 53, 65, 78, 331, 184, 121, 79, 65, 57, 71, 102, 86, 250, 400, 44, 108, 183, 49, 56, 78, 111, 84, 60, 136, 111, 59, 69, 57, 65, 195, 115, 59, 118, 57, 108, 58, 94, 68, 108, 64, 400, 155, 68, 74, 94, 152, 62, 89, 85, 85, 60, 115, 81]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21106930477063493, "mean_inference_ms": 0.6125588408009303, "mean_action_processing_ms": 0.06758077833152652, "mean_env_wait_ms": 6.120900834590052, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005422353744506836, "StateBufferConnector_ms": 0.003228902816772461, "ViewRequirementAgentConnector_ms": 0.0736086368560791}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000, "num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 366.2570383558329, "num_env_steps_trained_throughput_per_sec": 366.2570383558329, "timesteps_total": 72000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 72000, "timers": {"training_iteration_time_ms": 10654.866, "sample_time_ms": 7161.884, "load_time_ms": 2.163, "load_throughput": 1849116.179, "learn_time_ms": 3488.556, "learn_throughput": 1146.606, "synch_weights_time_ms": 1.644}, "counters": {"num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000}, "done": false, "episodes_total": 364, "training_iteration": 18, "trial_id": "dbefe_00000", "date": "2024-03-07_12-15-39", "timestamp": 1709831739, "time_this_iter_s": 10.924086332321167, "time_total_s": 191.52181577682495, "pid": 103980, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fcd19c36f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 191.52181577682495, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 19.093333333333327, "ram_util_percent": 44.22000000000001, "gpu_util_percent0": 0.084, "vram_util_percent0": 0.1005859375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.10000000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 3.0585984453518864, "policy_loss": -0.012563114573237716, "vf_loss": 3.070262841736117, "vf_explained_var": 0.29221302533662447, "kl": 0.008987171800351735, "entropy": 0.88474992032974, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 17205.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_agent_steps_sampled": 76000, "num_agent_steps_trained": 76000}, "sampler_results": {"episode_reward_max": -2.600000000000002, "episode_reward_min": -74.1000000000005, "episode_reward_mean": -9.736, "episode_len_mean": 91.07, "episode_media": {}, "episodes_this_iter": 52, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10.999999999999973, -7.499999999999993, -6.800000000000001, -4.599999999999996, -5.999999999999991, -10.699999999999976, -9.399999999999988, -29.899999999999995, -74.1000000000005, -3.3000000000000007, -9.699999999999978, -21.1, -3.799999999999999, -5.4, -6.699999999999989, -10.599999999999975, -9.69999999999999, -5.299999999999996, -14.299999999999962, -11.099999999999973, -4.799999999999995, -7.9, -4.599999999999996, -5.399999999999993, -19.299999999999997, -12.899999999999968, -4.799999999999995, -13.799999999999969, -5.099999999999999, -15.099999999999973, -5.299999999999999, -9.899999999999984, -7.799999999999999, -10.999999999999975, -5.299999999999994, -72.20000000000047, -18.499999999999954, -6.4999999999999964, -6.999999999999994, -11.899999999999984, -16.799999999999958, -6.700000000000003, -8.699999999999985, -8.69999999999999, -9.299999999999988, -5.599999999999999, -10.399999999999975, -9.09999999999999, -3.3000000000000007, -14.999999999999964, -5.999999999999999, -20.999999999999982, -4.099999999999998, -18.60000000000001, -4.199999999999999, -5.1000000000000005, -7.400000000000004, -6.699999999999989, -6.4999999999999964, -10.299999999999986, -3.799999999999999, -2.600000000000002, -3.6999999999999993, -4.699999999999999, -9.499999999999982, -26.100000000000083, -5.499999999999993, -4.999999999999995, -7.399999999999999, -7.799999999999997, -13.29999999999997, -5.899999999999993, -15.599999999999966, -5.499999999999993, -5.200000000000002, -4.699999999999996, -5.599999999999995, -15.099999999999977, -3.8999999999999986, -19.799999999999955, -3.5999999999999996, -5.099999999999994, -3.6999999999999993, -5.3, -7.800000000000001, -10.099999999999987, -2.900000000000002, -8.199999999999983, -3.9999999999999982, -6.5, -6.39999999999999, -4.1999999999999975, -6.999999999999988, -3.9999999999999982, -3.9999999999999982, -3.5, -5.8999999999999915, -5.799999999999992, -5.5999999999999925, -5.699999999999999], "episode_lengths": [121, 79, 65, 57, 71, 102, 86, 250, 400, 44, 108, 183, 49, 56, 78, 111, 84, 60, 136, 111, 59, 69, 57, 65, 195, 115, 59, 118, 57, 108, 58, 94, 68, 108, 64, 400, 155, 68, 74, 94, 152, 62, 89, 85, 85, 60, 115, 81, 44, 142, 62, 190, 52, 185, 51, 55, 65, 78, 68, 101, 49, 37, 48, 54, 92, 257, 66, 61, 72, 74, 128, 68, 132, 66, 54, 58, 64, 111, 50, 171, 47, 62, 48, 53, 69, 87, 40, 93, 51, 64, 75, 53, 81, 51, 51, 46, 70, 69, 67, 60]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21368108224490945, "mean_inference_ms": 0.6129658660935483, "mean_action_processing_ms": 0.06767061001427174, "mean_env_wait_ms": 6.13630058741459, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005525827407836914, "StateBufferConnector_ms": 0.003271818161010742, "ViewRequirementAgentConnector_ms": 0.07468962669372559}}, "episode_reward_max": -2.600000000000002, "episode_reward_min": -74.1000000000005, "episode_reward_mean": -9.736, "episode_len_mean": 91.07, "episodes_this_iter": 52, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10.999999999999973, -7.499999999999993, -6.800000000000001, -4.599999999999996, -5.999999999999991, -10.699999999999976, -9.399999999999988, -29.899999999999995, -74.1000000000005, -3.3000000000000007, -9.699999999999978, -21.1, -3.799999999999999, -5.4, -6.699999999999989, -10.599999999999975, -9.69999999999999, -5.299999999999996, -14.299999999999962, -11.099999999999973, -4.799999999999995, -7.9, -4.599999999999996, -5.399999999999993, -19.299999999999997, -12.899999999999968, -4.799999999999995, -13.799999999999969, -5.099999999999999, -15.099999999999973, -5.299999999999999, -9.899999999999984, -7.799999999999999, -10.999999999999975, -5.299999999999994, -72.20000000000047, -18.499999999999954, -6.4999999999999964, -6.999999999999994, -11.899999999999984, -16.799999999999958, -6.700000000000003, -8.699999999999985, -8.69999999999999, -9.299999999999988, -5.599999999999999, -10.399999999999975, -9.09999999999999, -3.3000000000000007, -14.999999999999964, -5.999999999999999, -20.999999999999982, -4.099999999999998, -18.60000000000001, -4.199999999999999, -5.1000000000000005, -7.400000000000004, -6.699999999999989, -6.4999999999999964, -10.299999999999986, -3.799999999999999, -2.600000000000002, -3.6999999999999993, -4.699999999999999, -9.499999999999982, -26.100000000000083, -5.499999999999993, -4.999999999999995, -7.399999999999999, -7.799999999999997, -13.29999999999997, -5.899999999999993, -15.599999999999966, -5.499999999999993, -5.200000000000002, -4.699999999999996, -5.599999999999995, -15.099999999999977, -3.8999999999999986, -19.799999999999955, -3.5999999999999996, -5.099999999999994, -3.6999999999999993, -5.3, -7.800000000000001, -10.099999999999987, -2.900000000000002, -8.199999999999983, -3.9999999999999982, -6.5, -6.39999999999999, -4.1999999999999975, -6.999999999999988, -3.9999999999999982, -3.9999999999999982, -3.5, -5.8999999999999915, -5.799999999999992, -5.5999999999999925, -5.699999999999999], "episode_lengths": [121, 79, 65, 57, 71, 102, 86, 250, 400, 44, 108, 183, 49, 56, 78, 111, 84, 60, 136, 111, 59, 69, 57, 65, 195, 115, 59, 118, 57, 108, 58, 94, 68, 108, 64, 400, 155, 68, 74, 94, 152, 62, 89, 85, 85, 60, 115, 81, 44, 142, 62, 190, 52, 185, 51, 55, 65, 78, 68, 101, 49, 37, 48, 54, 92, 257, 66, 61, 72, 74, 128, 68, 132, 66, 54, 58, 64, 111, 50, 171, 47, 62, 48, 53, 69, 87, 40, 93, 51, 64, 75, 53, 81, 51, 51, 46, 70, 69, 67, 60]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21368108224490945, "mean_inference_ms": 0.6129658660935483, "mean_action_processing_ms": 0.06767061001427174, "mean_env_wait_ms": 6.13630058741459, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005525827407836914, "StateBufferConnector_ms": 0.003271818161010742, "ViewRequirementAgentConnector_ms": 0.07468962669372559}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 76000, "num_agent_steps_trained": 76000, "num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 356.49442805341505, "num_env_steps_trained_throughput_per_sec": 356.49442805341505, "timesteps_total": 76000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 76000, "timers": {"training_iteration_time_ms": 10711.669, "sample_time_ms": 7227.415, "load_time_ms": 2.166, "load_throughput": 1846755.094, "learn_time_ms": 3479.805, "learn_throughput": 1149.49, "synch_weights_time_ms": 1.655}, "counters": {"num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_agent_steps_sampled": 76000, "num_agent_steps_trained": 76000}, "done": false, "episodes_total": 416, "training_iteration": 19, "trial_id": "dbefe_00000", "date": "2024-03-07_12-15-51", "timestamp": 1709831751, "time_this_iter_s": 11.222464323043823, "time_total_s": 202.74428009986877, "pid": 103980, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fcd19c36f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 202.74428009986877, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 20.678571428571438, "ram_util_percent": 44.278571428571425, "gpu_util_percent0": 0.07428571428571429, "vram_util_percent0": 0.1005859375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.10000000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 2.364716758920125, "policy_loss": -0.01330371200237223, "vf_loss": 2.377279909804303, "vf_explained_var": 0.4975167303956965, "kl": 0.007405685102325184, "entropy": 0.8757034918313386, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 18135.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000}, "sampler_results": {"episode_reward_max": -2.600000000000002, "episode_reward_min": -44.10000000000032, "episode_reward_mean": -7.177999999999998, "episode_len_mean": 76.1, "episode_media": {}, "episodes_this_iter": 52, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4.099999999999998, -18.60000000000001, -4.199999999999999, -5.1000000000000005, -7.400000000000004, -6.699999999999989, -6.4999999999999964, -10.299999999999986, -3.799999999999999, -2.600000000000002, -3.6999999999999993, -4.699999999999999, -9.499999999999982, -26.100000000000083, -5.499999999999993, -4.999999999999995, -7.399999999999999, -7.799999999999997, -13.29999999999997, -5.899999999999993, -15.599999999999966, -5.499999999999993, -5.200000000000002, -4.699999999999996, -5.599999999999995, -15.099999999999977, -3.8999999999999986, -19.799999999999955, -3.5999999999999996, -5.099999999999994, -3.6999999999999993, -5.3, -7.800000000000001, -10.099999999999987, -2.900000000000002, -8.199999999999983, -3.9999999999999982, -6.5, -6.39999999999999, -4.1999999999999975, -6.999999999999988, -3.9999999999999982, -3.9999999999999982, -3.5, -5.8999999999999915, -5.799999999999992, -5.5999999999999925, -5.699999999999999, -4.799999999999995, -4.699999999999996, -14.499999999999961, -4.399999999999997, -4.699999999999999, -9.299999999999992, -3.8999999999999986, -5.699999999999998, -6.5, -5.799999999999992, -7.2999999999999865, -6.39999999999999, -5.199999999999998, -5.399999999999997, -5.399999999999993, -6.799999999999988, -4.1999999999999975, -6.200000000000002, -5.6, -5.600000000000001, -6.299999999999997, -21.700000000000045, -2.900000000000002, -4.500000000000002, -4.8, -5.1999999999999975, -4.099999999999998, -4.299999999999997, -3.1000000000000014, -3.5999999999999996, -5.299999999999999, -12.399999999999968, -3.9999999999999982, -5.099999999999997, -4.4999999999999964, -5.699999999999997, -7.999999999999984, -6.599999999999997, -6.19999999999999, -3.4000000000000004, -4.2, -4.4, -14.89999999999996, -9.29999999999998, -14.499999999999968, -8.199999999999983, -4.799999999999997, -7.499999999999986, -9.399999999999979, -5.999999999999991, -3.5, -44.10000000000032], "episode_lengths": [52, 185, 51, 55, 65, 78, 68, 101, 49, 37, 48, 54, 92, 257, 66, 61, 72, 74, 128, 68, 132, 66, 54, 58, 64, 111, 50, 171, 47, 62, 48, 53, 69, 87, 40, 93, 51, 64, 75, 53, 81, 51, 51, 46, 70, 69, 67, 60, 59, 58, 140, 55, 53, 84, 50, 61, 64, 69, 84, 75, 58, 61, 49, 79, 53, 59, 59, 54, 65, 189, 40, 50, 54, 59, 52, 54, 42, 45, 58, 135, 51, 59, 56, 63, 91, 68, 73, 45, 49, 51, 148, 99, 130, 93, 57, 86, 105, 71, 44, 400]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2151512251297096, "mean_inference_ms": 0.6134597098442535, "mean_action_processing_ms": 0.06754585137188625, "mean_env_wait_ms": 6.152297324383733, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0054187774658203125, "StateBufferConnector_ms": 0.0033173561096191406, "ViewRequirementAgentConnector_ms": 0.07379031181335449}}, "episode_reward_max": -2.600000000000002, "episode_reward_min": -44.10000000000032, "episode_reward_mean": -7.177999999999998, "episode_len_mean": 76.1, "episodes_this_iter": 52, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-4.099999999999998, -18.60000000000001, -4.199999999999999, -5.1000000000000005, -7.400000000000004, -6.699999999999989, -6.4999999999999964, -10.299999999999986, -3.799999999999999, -2.600000000000002, -3.6999999999999993, -4.699999999999999, -9.499999999999982, -26.100000000000083, -5.499999999999993, -4.999999999999995, -7.399999999999999, -7.799999999999997, -13.29999999999997, -5.899999999999993, -15.599999999999966, -5.499999999999993, -5.200000000000002, -4.699999999999996, -5.599999999999995, -15.099999999999977, -3.8999999999999986, -19.799999999999955, -3.5999999999999996, -5.099999999999994, -3.6999999999999993, -5.3, -7.800000000000001, -10.099999999999987, -2.900000000000002, -8.199999999999983, -3.9999999999999982, -6.5, -6.39999999999999, -4.1999999999999975, -6.999999999999988, -3.9999999999999982, -3.9999999999999982, -3.5, -5.8999999999999915, -5.799999999999992, -5.5999999999999925, -5.699999999999999, -4.799999999999995, -4.699999999999996, -14.499999999999961, -4.399999999999997, -4.699999999999999, -9.299999999999992, -3.8999999999999986, -5.699999999999998, -6.5, -5.799999999999992, -7.2999999999999865, -6.39999999999999, -5.199999999999998, -5.399999999999997, -5.399999999999993, -6.799999999999988, -4.1999999999999975, -6.200000000000002, -5.6, -5.600000000000001, -6.299999999999997, -21.700000000000045, -2.900000000000002, -4.500000000000002, -4.8, -5.1999999999999975, -4.099999999999998, -4.299999999999997, -3.1000000000000014, -3.5999999999999996, -5.299999999999999, -12.399999999999968, -3.9999999999999982, -5.099999999999997, -4.4999999999999964, -5.699999999999997, -7.999999999999984, -6.599999999999997, -6.19999999999999, -3.4000000000000004, -4.2, -4.4, -14.89999999999996, -9.29999999999998, -14.499999999999968, -8.199999999999983, -4.799999999999997, -7.499999999999986, -9.399999999999979, -5.999999999999991, -3.5, -44.10000000000032], "episode_lengths": [52, 185, 51, 55, 65, 78, 68, 101, 49, 37, 48, 54, 92, 257, 66, 61, 72, 74, 128, 68, 132, 66, 54, 58, 64, 111, 50, 171, 47, 62, 48, 53, 69, 87, 40, 93, 51, 64, 75, 53, 81, 51, 51, 46, 70, 69, 67, 60, 59, 58, 140, 55, 53, 84, 50, 61, 64, 69, 84, 75, 58, 61, 49, 79, 53, 59, 59, 54, 65, 189, 40, 50, 54, 59, 52, 54, 42, 45, 58, 135, 51, 59, 56, 63, 91, 68, 73, 45, 49, 51, 148, 99, 130, 93, 57, 86, 105, 71, 44, 400]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2151512251297096, "mean_inference_ms": 0.6134597098442535, "mean_action_processing_ms": 0.06754585137188625, "mean_env_wait_ms": 6.152297324383733, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0054187774658203125, "StateBufferConnector_ms": 0.0033173561096191406, "ViewRequirementAgentConnector_ms": 0.07379031181335449}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000, "num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 367.2757070420582, "num_env_steps_trained_throughput_per_sec": 367.2757070420582, "timesteps_total": 80000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 80000, "timers": {"training_iteration_time_ms": 10752.397, "sample_time_ms": 7267.679, "load_time_ms": 1.036, "load_throughput": 3859936.961, "learn_time_ms": 3481.4, "learn_throughput": 1148.963, "synch_weights_time_ms": 1.657}, "counters": {"num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000}, "done": false, "episodes_total": 468, "training_iteration": 20, "trial_id": "dbefe_00000", "date": "2024-03-07_12-16-02", "timestamp": 1709831762, "time_this_iter_s": 10.89315390586853, "time_total_s": 213.6374340057373, "pid": 103980, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fcd19c36f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 213.6374340057373, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 19.800000000000004, "ram_util_percent": 44.25714285714286, "gpu_util_percent0": 0.08, "vram_util_percent0": 0.1005859375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.10000000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 1.8287740130137693, "policy_loss": -0.010699777407271247, "vf_loss": 1.8386912756389187, "vf_explained_var": 0.576963351170222, "kl": 0.007825215184064142, "entropy": 0.8279272074981402, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 19065.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 84000}, "sampler_results": {"episode_reward_max": -2.5000000000000018, "episode_reward_min": -44.10000000000032, "episode_reward_mean": -6.8649999999999975, "episode_len_mean": 73.56, "episode_media": {}, "episodes_this_iter": 58, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-7.2999999999999865, -6.39999999999999, -5.199999999999998, -5.399999999999997, -5.399999999999993, -6.799999999999988, -4.1999999999999975, -6.200000000000002, -5.6, -5.600000000000001, -6.299999999999997, -21.700000000000045, -2.900000000000002, -4.500000000000002, -4.8, -5.1999999999999975, -4.099999999999998, -4.299999999999997, -3.1000000000000014, -3.5999999999999996, -5.299999999999999, -12.399999999999968, -3.9999999999999982, -5.099999999999997, -4.4999999999999964, -5.699999999999997, -7.999999999999984, -6.599999999999997, -6.19999999999999, -3.4000000000000004, -4.2, -4.4, -14.89999999999996, -9.29999999999998, -14.499999999999968, -8.199999999999983, -4.799999999999997, -7.499999999999986, -9.399999999999979, -5.999999999999991, -3.5, -44.10000000000032, -8.499999999999996, -12.49999999999998, -3.5, -6.799999999999994, -5.299999999999994, -8.09999999999999, -5.399999999999997, -5.000000000000002, -2.5000000000000018, -5.799999999999999, -4.599999999999996, -26.000000000000075, -4.1999999999999975, -8.89999999999998, -6.899999999999999, -5.199999999999994, -3.9999999999999982, -17.499999999999993, -5.8999999999999995, -3.4000000000000004, -6.699999999999996, -9.599999999999989, -9.999999999999977, -3.9000000000000004, -7.599999999999985, -5.999999999999991, -4.899999999999995, -6.299999999999995, -12.199999999999969, -3.0000000000000018, -3.9999999999999982, -9.899999999999977, -3.3000000000000007, -8.199999999999989, -5.099999999999998, -3.5999999999999996, -5.6, -6.599999999999992, -6.299999999999992, -4.899999999999999, -4.799999999999995, -5.2, -3.5, -3.5999999999999996, -3.799999999999999, -7.2999999999999865, -6.499999999999993, -4.199999999999999, -4.899999999999999, -8.699999999999982, -5.1999999999999975, -3.3000000000000007, -6.499999999999994, -6.499999999999997, -8.399999999999997, -3.900000000000002, -8.699999999999982, -3.200000000000001], "episode_lengths": [84, 75, 58, 61, 49, 79, 53, 59, 59, 54, 65, 189, 40, 50, 54, 59, 52, 54, 42, 45, 58, 135, 51, 59, 56, 63, 91, 68, 73, 45, 49, 51, 148, 99, 130, 93, 57, 86, 105, 71, 44, 400, 74, 94, 46, 73, 64, 67, 61, 53, 36, 61, 57, 227, 53, 97, 68, 63, 51, 174, 60, 45, 70, 82, 111, 45, 87, 71, 60, 68, 133, 41, 51, 110, 44, 83, 58, 47, 57, 74, 72, 56, 59, 56, 46, 47, 49, 84, 72, 48, 56, 94, 59, 44, 64, 67, 73, 40, 98, 43]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2177899612398508, "mean_inference_ms": 0.6137220656421275, "mean_action_processing_ms": 0.06752297177893919, "mean_env_wait_ms": 6.166083162231632, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0055141448974609375, "StateBufferConnector_ms": 0.0033125877380371094, "ViewRequirementAgentConnector_ms": 0.07294416427612305}}, "episode_reward_max": -2.5000000000000018, "episode_reward_min": -44.10000000000032, "episode_reward_mean": -6.8649999999999975, "episode_len_mean": 73.56, "episodes_this_iter": 58, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-7.2999999999999865, -6.39999999999999, -5.199999999999998, -5.399999999999997, -5.399999999999993, -6.799999999999988, -4.1999999999999975, -6.200000000000002, -5.6, -5.600000000000001, -6.299999999999997, -21.700000000000045, -2.900000000000002, -4.500000000000002, -4.8, -5.1999999999999975, -4.099999999999998, -4.299999999999997, -3.1000000000000014, -3.5999999999999996, -5.299999999999999, -12.399999999999968, -3.9999999999999982, -5.099999999999997, -4.4999999999999964, -5.699999999999997, -7.999999999999984, -6.599999999999997, -6.19999999999999, -3.4000000000000004, -4.2, -4.4, -14.89999999999996, -9.29999999999998, -14.499999999999968, -8.199999999999983, -4.799999999999997, -7.499999999999986, -9.399999999999979, -5.999999999999991, -3.5, -44.10000000000032, -8.499999999999996, -12.49999999999998, -3.5, -6.799999999999994, -5.299999999999994, -8.09999999999999, -5.399999999999997, -5.000000000000002, -2.5000000000000018, -5.799999999999999, -4.599999999999996, -26.000000000000075, -4.1999999999999975, -8.89999999999998, -6.899999999999999, -5.199999999999994, -3.9999999999999982, -17.499999999999993, -5.8999999999999995, -3.4000000000000004, -6.699999999999996, -9.599999999999989, -9.999999999999977, -3.9000000000000004, -7.599999999999985, -5.999999999999991, -4.899999999999995, -6.299999999999995, -12.199999999999969, -3.0000000000000018, -3.9999999999999982, -9.899999999999977, -3.3000000000000007, -8.199999999999989, -5.099999999999998, -3.5999999999999996, -5.6, -6.599999999999992, -6.299999999999992, -4.899999999999999, -4.799999999999995, -5.2, -3.5, -3.5999999999999996, -3.799999999999999, -7.2999999999999865, -6.499999999999993, -4.199999999999999, -4.899999999999999, -8.699999999999982, -5.1999999999999975, -3.3000000000000007, -6.499999999999994, -6.499999999999997, -8.399999999999997, -3.900000000000002, -8.699999999999982, -3.200000000000001], "episode_lengths": [84, 75, 58, 61, 49, 79, 53, 59, 59, 54, 65, 189, 40, 50, 54, 59, 52, 54, 42, 45, 58, 135, 51, 59, 56, 63, 91, 68, 73, 45, 49, 51, 148, 99, 130, 93, 57, 86, 105, 71, 44, 400, 74, 94, 46, 73, 64, 67, 61, 53, 36, 61, 57, 227, 53, 97, 68, 63, 51, 174, 60, 45, 70, 82, 111, 45, 87, 71, 60, 68, 133, 41, 51, 110, 44, 83, 58, 47, 57, 74, 72, 56, 59, 56, 46, 47, 49, 84, 72, 48, 56, 94, 59, 44, 64, 67, 73, 40, 98, 43]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2177899612398508, "mean_inference_ms": 0.6137220656421275, "mean_action_processing_ms": 0.06752297177893919, "mean_env_wait_ms": 6.166083162231632, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0055141448974609375, "StateBufferConnector_ms": 0.0033125877380371094, "ViewRequirementAgentConnector_ms": 0.07294416427612305}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 84000, "num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 366.8039224885973, "num_env_steps_trained_throughput_per_sec": 366.8039224885973, "timesteps_total": 84000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 84000, "timers": {"training_iteration_time_ms": 10784.92, "sample_time_ms": 7299.494, "load_time_ms": 1.037, "load_throughput": 3856388.001, "learn_time_ms": 3482.115, "learn_throughput": 1148.727, "synch_weights_time_ms": 1.647}, "counters": {"num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 84000}, "done": false, "episodes_total": 526, "training_iteration": 21, "trial_id": "dbefe_00000", "date": "2024-03-07_12-16-12", "timestamp": 1709831772, "time_this_iter_s": 10.907835483551025, "time_total_s": 224.54526948928833, "pid": 103980, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fcd19c36f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 224.54526948928833, "iterations_since_restore": 21, "perf": {"cpu_util_percent": 19.12, "ram_util_percent": 44.24, "gpu_util_percent0": 0.09733333333333333, "vram_util_percent0": 0.1005859375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.10000000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 2.728330163233688, "policy_loss": -0.005458787295927283, "vf_loss": 2.733040853822103, "vf_explained_var": 0.4260705823539406, "kl": 0.007480867573807869, "entropy": 0.8134934418303992, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 19995.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_agent_steps_sampled": 88000, "num_agent_steps_trained": 88000}, "sampler_results": {"episode_reward_max": -2.600000000000002, "episode_reward_min": -37.30000000000013, "episode_reward_mean": -6.666999999999996, "episode_len_mean": 72.54, "episode_media": {}, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-26.000000000000075, -4.1999999999999975, -8.89999999999998, -6.899999999999999, -5.199999999999994, -3.9999999999999982, -17.499999999999993, -5.8999999999999995, -3.4000000000000004, -6.699999999999996, -9.599999999999989, -9.999999999999977, -3.9000000000000004, -7.599999999999985, -5.999999999999991, -4.899999999999995, -6.299999999999995, -12.199999999999969, -3.0000000000000018, -3.9999999999999982, -9.899999999999977, -3.3000000000000007, -8.199999999999989, -5.099999999999998, -3.5999999999999996, -5.6, -6.599999999999992, -6.299999999999992, -4.899999999999999, -4.799999999999995, -5.2, -3.5, -3.5999999999999996, -3.799999999999999, -7.2999999999999865, -6.499999999999993, -4.199999999999999, -4.899999999999999, -8.699999999999982, -5.1999999999999975, -3.3000000000000007, -6.499999999999994, -6.499999999999997, -8.399999999999997, -3.900000000000002, -8.699999999999982, -3.200000000000001, -5.599999999999993, -3.799999999999999, -3.200000000000001, -7.899999999999993, -6.099999999999991, -7.999999999999993, -37.30000000000013, -9.199999999999985, -3.0000000000000018, -5.099999999999998, -4.599999999999996, -4.999999999999995, -2.600000000000002, -3.0000000000000018, -4.1000000000000005, -7.599999999999985, -6.39999999999999, -8.99999999999998, -3.9999999999999982, -4.6, -3.200000000000001, -3.8999999999999986, -7.099999999999994, -5.5999999999999925, -3.8999999999999986, -6.099999999999991, -3.1000000000000014, -6.599999999999998, -2.900000000000002, -4.0, -8.099999999999984, -7.200000000000001, -3.3000000000000007, -3.5, -3.5999999999999996, -6.499999999999989, -9.699999999999978, -12.299999999999972, -4.599999999999999, -4.799999999999995, -4.799999999999999, -3.6999999999999993, -4.699999999999996, -5.799999999999992, -7.699999999999985, -8.199999999999983, -23.500000000000032, -9.399999999999979, -5.099999999999994, -3.799999999999999, -12.499999999999968, -13.399999999999965, -6.099999999999997], "episode_lengths": [227, 53, 97, 68, 63, 51, 174, 60, 45, 70, 82, 111, 45, 87, 71, 60, 68, 133, 41, 51, 110, 44, 83, 58, 47, 57, 74, 72, 56, 59, 56, 46, 47, 49, 84, 72, 48, 56, 94, 59, 44, 64, 67, 73, 40, 98, 43, 66, 49, 43, 77, 72, 76, 291, 98, 41, 56, 57, 61, 37, 41, 49, 87, 75, 95, 51, 52, 43, 45, 74, 67, 50, 72, 42, 67, 40, 49, 92, 67, 44, 46, 47, 76, 103, 128, 53, 59, 53, 48, 58, 69, 88, 93, 210, 105, 62, 49, 134, 125, 65]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2201233990002762, "mean_inference_ms": 0.6138249829085377, "mean_action_processing_ms": 0.06749864992898898, "mean_env_wait_ms": 6.176847165749133, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005383968353271484, "StateBufferConnector_ms": 0.003323078155517578, "ViewRequirementAgentConnector_ms": 0.07309293746948242}}, "episode_reward_max": -2.600000000000002, "episode_reward_min": -37.30000000000013, "episode_reward_mean": -6.666999999999996, "episode_len_mean": 72.54, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-26.000000000000075, -4.1999999999999975, -8.89999999999998, -6.899999999999999, -5.199999999999994, -3.9999999999999982, -17.499999999999993, -5.8999999999999995, -3.4000000000000004, -6.699999999999996, -9.599999999999989, -9.999999999999977, -3.9000000000000004, -7.599999999999985, -5.999999999999991, -4.899999999999995, -6.299999999999995, -12.199999999999969, -3.0000000000000018, -3.9999999999999982, -9.899999999999977, -3.3000000000000007, -8.199999999999989, -5.099999999999998, -3.5999999999999996, -5.6, -6.599999999999992, -6.299999999999992, -4.899999999999999, -4.799999999999995, -5.2, -3.5, -3.5999999999999996, -3.799999999999999, -7.2999999999999865, -6.499999999999993, -4.199999999999999, -4.899999999999999, -8.699999999999982, -5.1999999999999975, -3.3000000000000007, -6.499999999999994, -6.499999999999997, -8.399999999999997, -3.900000000000002, -8.699999999999982, -3.200000000000001, -5.599999999999993, -3.799999999999999, -3.200000000000001, -7.899999999999993, -6.099999999999991, -7.999999999999993, -37.30000000000013, -9.199999999999985, -3.0000000000000018, -5.099999999999998, -4.599999999999996, -4.999999999999995, -2.600000000000002, -3.0000000000000018, -4.1000000000000005, -7.599999999999985, -6.39999999999999, -8.99999999999998, -3.9999999999999982, -4.6, -3.200000000000001, -3.8999999999999986, -7.099999999999994, -5.5999999999999925, -3.8999999999999986, -6.099999999999991, -3.1000000000000014, -6.599999999999998, -2.900000000000002, -4.0, -8.099999999999984, -7.200000000000001, -3.3000000000000007, -3.5, -3.5999999999999996, -6.499999999999989, -9.699999999999978, -12.299999999999972, -4.599999999999999, -4.799999999999995, -4.799999999999999, -3.6999999999999993, -4.699999999999996, -5.799999999999992, -7.699999999999985, -8.199999999999983, -23.500000000000032, -9.399999999999979, -5.099999999999994, -3.799999999999999, -12.499999999999968, -13.399999999999965, -6.099999999999997], "episode_lengths": [227, 53, 97, 68, 63, 51, 174, 60, 45, 70, 82, 111, 45, 87, 71, 60, 68, 133, 41, 51, 110, 44, 83, 58, 47, 57, 74, 72, 56, 59, 56, 46, 47, 49, 84, 72, 48, 56, 94, 59, 44, 64, 67, 73, 40, 98, 43, 66, 49, 43, 77, 72, 76, 291, 98, 41, 56, 57, 61, 37, 41, 49, 87, 75, 95, 51, 52, 43, 45, 74, 67, 50, 72, 42, 67, 40, 49, 92, 67, 44, 46, 47, 76, 103, 128, 53, 59, 53, 48, 58, 69, 88, 93, 210, 105, 62, 49, 134, 125, 65]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2201233990002762, "mean_inference_ms": 0.6138249829085377, "mean_action_processing_ms": 0.06749864992898898, "mean_env_wait_ms": 6.176847165749133, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005383968353271484, "StateBufferConnector_ms": 0.003323078155517578, "ViewRequirementAgentConnector_ms": 0.07309293746948242}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 88000, "num_agent_steps_trained": 88000, "num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 370.0887601583943, "num_env_steps_trained_throughput_per_sec": 370.0887601583943, "timesteps_total": 88000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 88000, "timers": {"training_iteration_time_ms": 10820.811, "sample_time_ms": 7337.989, "load_time_ms": 1.018, "load_throughput": 3929090.398, "learn_time_ms": 3479.53, "learn_throughput": 1149.581, "synch_weights_time_ms": 1.647}, "counters": {"num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_agent_steps_sampled": 88000, "num_agent_steps_trained": 88000}, "done": false, "episodes_total": 579, "training_iteration": 22, "trial_id": "dbefe_00000", "date": "2024-03-07_12-16-23", "timestamp": 1709831783, "time_this_iter_s": 10.811028718948364, "time_total_s": 235.3562982082367, "pid": 103980, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fcd19c36f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 235.3562982082367, "iterations_since_restore": 22, "perf": {"cpu_util_percent": 19.878571428571426, "ram_util_percent": 44.25714285714285, "gpu_util_percent0": 0.09, "vram_util_percent0": 0.1005859375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.10000000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 2.2061753206502055, "policy_loss": -0.004207818658762081, "vf_loss": 2.2095906228788436, "vf_explained_var": 0.5121171144388055, "kl": 0.007925079660725304, "entropy": 0.8367176502622584, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 20925.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_agent_steps_sampled": 92000, "num_agent_steps_trained": 92000}, "sampler_results": {"episode_reward_max": -2.2000000000000015, "episode_reward_min": -50.100000000000286, "episode_reward_mean": -6.586, "episode_len_mean": 72.21, "episode_media": {}, "episodes_this_iter": 55, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.0000000000000018, -5.099999999999998, -4.599999999999996, -4.999999999999995, -2.600000000000002, -3.0000000000000018, -4.1000000000000005, -7.599999999999985, -6.39999999999999, -8.99999999999998, -3.9999999999999982, -4.6, -3.200000000000001, -3.8999999999999986, -7.099999999999994, -5.5999999999999925, -3.8999999999999986, -6.099999999999991, -3.1000000000000014, -6.599999999999998, -2.900000000000002, -4.0, -8.099999999999984, -7.200000000000001, -3.3000000000000007, -3.5, -3.5999999999999996, -6.499999999999989, -9.699999999999978, -12.299999999999972, -4.599999999999999, -4.799999999999995, -4.799999999999999, -3.6999999999999993, -4.699999999999996, -5.799999999999992, -7.699999999999985, -8.199999999999983, -23.500000000000032, -9.399999999999979, -5.099999999999994, -3.799999999999999, -12.499999999999968, -13.399999999999965, -6.099999999999997, -5.299999999999997, -3.799999999999999, -3.6999999999999993, -6.4, -14.999999999999961, -4.999999999999995, -3.3000000000000007, -8.199999999999983, -5.799999999999999, -3.0000000000000018, -3.0000000000000018, -6.500000000000001, -8.99999999999998, -3.200000000000001, -3.8999999999999986, -4.999999999999996, -4.699999999999999, -7.0, -5.5999999999999925, -3.8, -3.8999999999999995, -4.799999999999995, -3.9999999999999982, -6.699999999999989, -5.8, -3.5999999999999996, -10.799999999999976, -4.8, -3.0000000000000018, -5.5999999999999925, -4.299999999999997, -50.100000000000286, -8.599999999999982, -3.3000000000000007, -3.3000000000000007, -5.5999999999999925, -3.799999999999999, -13.999999999999968, -5.299999999999997, -4.799999999999995, -12.799999999999967, -5.499999999999994, -4.199999999999999, -2.2000000000000015, -3.1000000000000014, -4.399999999999999, -5.899999999999997, -3.9999999999999982, -43.70000000000028, -3.799999999999999, -5.199999999999994, -2.700000000000002, -7.599999999999985, -3.9999999999999982, -4.500000000000001], "episode_lengths": [41, 56, 57, 61, 37, 41, 49, 87, 75, 95, 51, 52, 43, 45, 74, 67, 50, 72, 42, 67, 40, 49, 92, 67, 44, 46, 47, 76, 103, 128, 53, 59, 53, 48, 58, 69, 88, 93, 210, 105, 62, 49, 134, 125, 65, 60, 49, 48, 63, 157, 61, 44, 93, 61, 41, 41, 59, 101, 43, 50, 60, 54, 66, 67, 48, 46, 59, 51, 78, 60, 47, 117, 54, 41, 67, 54, 400, 97, 44, 44, 67, 49, 138, 60, 59, 139, 65, 49, 33, 41, 53, 64, 51, 364, 49, 63, 38, 87, 51, 51]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.22169377239693466, "mean_inference_ms": 0.613715900055956, "mean_action_processing_ms": 0.06749830158561426, "mean_env_wait_ms": 6.179225511922061, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005236148834228516, "StateBufferConnector_ms": 0.0032634735107421875, "ViewRequirementAgentConnector_ms": 0.07288908958435059}}, "episode_reward_max": -2.2000000000000015, "episode_reward_min": -50.100000000000286, "episode_reward_mean": -6.586, "episode_len_mean": 72.21, "episodes_this_iter": 55, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3.0000000000000018, -5.099999999999998, -4.599999999999996, -4.999999999999995, -2.600000000000002, -3.0000000000000018, -4.1000000000000005, -7.599999999999985, -6.39999999999999, -8.99999999999998, -3.9999999999999982, -4.6, -3.200000000000001, -3.8999999999999986, -7.099999999999994, -5.5999999999999925, -3.8999999999999986, -6.099999999999991, -3.1000000000000014, -6.599999999999998, -2.900000000000002, -4.0, -8.099999999999984, -7.200000000000001, -3.3000000000000007, -3.5, -3.5999999999999996, -6.499999999999989, -9.699999999999978, -12.299999999999972, -4.599999999999999, -4.799999999999995, -4.799999999999999, -3.6999999999999993, -4.699999999999996, -5.799999999999992, -7.699999999999985, -8.199999999999983, -23.500000000000032, -9.399999999999979, -5.099999999999994, -3.799999999999999, -12.499999999999968, -13.399999999999965, -6.099999999999997, -5.299999999999997, -3.799999999999999, -3.6999999999999993, -6.4, -14.999999999999961, -4.999999999999995, -3.3000000000000007, -8.199999999999983, -5.799999999999999, -3.0000000000000018, -3.0000000000000018, -6.500000000000001, -8.99999999999998, -3.200000000000001, -3.8999999999999986, -4.999999999999996, -4.699999999999999, -7.0, -5.5999999999999925, -3.8, -3.8999999999999995, -4.799999999999995, -3.9999999999999982, -6.699999999999989, -5.8, -3.5999999999999996, -10.799999999999976, -4.8, -3.0000000000000018, -5.5999999999999925, -4.299999999999997, -50.100000000000286, -8.599999999999982, -3.3000000000000007, -3.3000000000000007, -5.5999999999999925, -3.799999999999999, -13.999999999999968, -5.299999999999997, -4.799999999999995, -12.799999999999967, -5.499999999999994, -4.199999999999999, -2.2000000000000015, -3.1000000000000014, -4.399999999999999, -5.899999999999997, -3.9999999999999982, -43.70000000000028, -3.799999999999999, -5.199999999999994, -2.700000000000002, -7.599999999999985, -3.9999999999999982, -4.500000000000001], "episode_lengths": [41, 56, 57, 61, 37, 41, 49, 87, 75, 95, 51, 52, 43, 45, 74, 67, 50, 72, 42, 67, 40, 49, 92, 67, 44, 46, 47, 76, 103, 128, 53, 59, 53, 48, 58, 69, 88, 93, 210, 105, 62, 49, 134, 125, 65, 60, 49, 48, 63, 157, 61, 44, 93, 61, 41, 41, 59, 101, 43, 50, 60, 54, 66, 67, 48, 46, 59, 51, 78, 60, 47, 117, 54, 41, 67, 54, 400, 97, 44, 44, 67, 49, 138, 60, 59, 139, 65, 49, 33, 41, 53, 64, 51, 364, 49, 63, 38, 87, 51, 51]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.22169377239693466, "mean_inference_ms": 0.613715900055956, "mean_action_processing_ms": 0.06749830158561426, "mean_env_wait_ms": 6.179225511922061, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005236148834228516, "StateBufferConnector_ms": 0.0032634735107421875, "ViewRequirementAgentConnector_ms": 0.07288908958435059}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 92000, "num_agent_steps_trained": 92000, "num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 366.8339740691929, "num_env_steps_trained_throughput_per_sec": 366.8339740691929, "timesteps_total": 92000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 92000, "timers": {"training_iteration_time_ms": 10866.404, "sample_time_ms": 7389.99, "load_time_ms": 0.985, "load_throughput": 4062476.633, "learn_time_ms": 3473.152, "learn_throughput": 1151.692, "synch_weights_time_ms": 1.663}, "counters": {"num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_agent_steps_sampled": 92000, "num_agent_steps_trained": 92000}, "done": false, "episodes_total": 634, "training_iteration": 23, "trial_id": "dbefe_00000", "date": "2024-03-07_12-16-34", "timestamp": 1709831794, "time_this_iter_s": 10.906371355056763, "time_total_s": 246.26266956329346, "pid": 103980, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fcd19c36f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 246.26266956329346, "iterations_since_restore": 23, "perf": {"cpu_util_percent": 19.642857142857142, "ram_util_percent": 44.3, "gpu_util_percent0": 0.07714285714285715, "vram_util_percent0": 0.1005859375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.10000000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 3.2581285325020755, "policy_loss": -0.008045766462561905, "vf_loss": 3.265400311639232, "vf_explained_var": 0.2998240699691157, "kl": 0.0077399882354575785, "entropy": 0.8128393875655308, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 21855.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000}, "sampler_results": {"episode_reward_max": -1.9000000000000012, "episode_reward_min": -52.100000000000286, "episode_reward_mean": -6.827000000000009, "episode_len_mean": 73.0, "episode_media": {}, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-5.799999999999999, -3.0000000000000018, -3.0000000000000018, -6.500000000000001, -8.99999999999998, -3.200000000000001, -3.8999999999999986, -4.999999999999996, -4.699999999999999, -7.0, -5.5999999999999925, -3.8, -3.8999999999999995, -4.799999999999995, -3.9999999999999982, -6.699999999999989, -5.8, -3.5999999999999996, -10.799999999999976, -4.8, -3.0000000000000018, -5.5999999999999925, -4.299999999999997, -50.100000000000286, -8.599999999999982, -3.3000000000000007, -3.3000000000000007, -5.5999999999999925, -3.799999999999999, -13.999999999999968, -5.299999999999997, -4.799999999999995, -12.799999999999967, -5.499999999999994, -4.199999999999999, -2.2000000000000015, -3.1000000000000014, -4.399999999999999, -5.899999999999997, -3.9999999999999982, -43.70000000000028, -3.799999999999999, -5.199999999999994, -2.700000000000002, -7.599999999999985, -3.9999999999999982, -4.500000000000001, -4.1, -4.3, -6.999999999999996, -4.799999999999995, -5.999999999999991, -4.199999999999999, -47.800000000000395, -2.4000000000000017, -5.099999999999999, -5.7, -3.200000000000001, -3.5, -2.700000000000002, -8.099999999999985, -4.4999999999999964, -4.599999999999996, -7.799999999999999, -3.3000000000000007, -3.0000000000000018, -2.600000000000002, -3.0000000000000018, -4.4999999999999964, -3.1000000000000014, -3.5999999999999996, -4.2, -10.399999999999975, -9.799999999999978, -14.399999999999961, -4.799999999999995, -3.9999999999999982, -3.200000000000001, -2.600000000000002, -3.6999999999999993, -4.299999999999998, -3.6000000000000005, -4.999999999999995, -3.200000000000001, -4.0, -3.200000000000001, -4.599999999999996, -6.099999999999991, -5.199999999999998, -3.5999999999999996, -3.0000000000000018, -4.1999999999999975, -6.200000000000001, -1.9000000000000012, -4.899999999999995, -3.9999999999999982, -20.800000000000043, -52.100000000000286, -3.3000000000000007, -3.3000000000000007], "episode_lengths": [61, 41, 41, 59, 101, 43, 50, 60, 54, 66, 67, 48, 46, 59, 51, 78, 60, 47, 117, 54, 41, 67, 54, 400, 97, 44, 44, 67, 49, 138, 60, 59, 139, 65, 49, 33, 41, 53, 64, 51, 364, 49, 63, 38, 87, 51, 51, 50, 50, 72, 59, 71, 51, 400, 35, 57, 59, 43, 46, 38, 88, 56, 57, 68, 39, 41, 37, 41, 56, 42, 47, 48, 115, 105, 151, 59, 51, 43, 37, 48, 53, 45, 61, 43, 49, 43, 57, 72, 58, 45, 41, 53, 60, 30, 60, 51, 210, 400, 44, 44]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.22349558544351364, "mean_inference_ms": 0.6138724056672848, "mean_action_processing_ms": 0.06750286419815625, "mean_env_wait_ms": 6.186773781064765, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005178928375244141, "StateBufferConnector_ms": 0.0032601356506347656, "ViewRequirementAgentConnector_ms": 0.0730447769165039}}, "episode_reward_max": -1.9000000000000012, "episode_reward_min": -52.100000000000286, "episode_reward_mean": -6.827000000000009, "episode_len_mean": 73.0, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-5.799999999999999, -3.0000000000000018, -3.0000000000000018, -6.500000000000001, -8.99999999999998, -3.200000000000001, -3.8999999999999986, -4.999999999999996, -4.699999999999999, -7.0, -5.5999999999999925, -3.8, -3.8999999999999995, -4.799999999999995, -3.9999999999999982, -6.699999999999989, -5.8, -3.5999999999999996, -10.799999999999976, -4.8, -3.0000000000000018, -5.5999999999999925, -4.299999999999997, -50.100000000000286, -8.599999999999982, -3.3000000000000007, -3.3000000000000007, -5.5999999999999925, -3.799999999999999, -13.999999999999968, -5.299999999999997, -4.799999999999995, -12.799999999999967, -5.499999999999994, -4.199999999999999, -2.2000000000000015, -3.1000000000000014, -4.399999999999999, -5.899999999999997, -3.9999999999999982, -43.70000000000028, -3.799999999999999, -5.199999999999994, -2.700000000000002, -7.599999999999985, -3.9999999999999982, -4.500000000000001, -4.1, -4.3, -6.999999999999996, -4.799999999999995, -5.999999999999991, -4.199999999999999, -47.800000000000395, -2.4000000000000017, -5.099999999999999, -5.7, -3.200000000000001, -3.5, -2.700000000000002, -8.099999999999985, -4.4999999999999964, -4.599999999999996, -7.799999999999999, -3.3000000000000007, -3.0000000000000018, -2.600000000000002, -3.0000000000000018, -4.4999999999999964, -3.1000000000000014, -3.5999999999999996, -4.2, -10.399999999999975, -9.799999999999978, -14.399999999999961, -4.799999999999995, -3.9999999999999982, -3.200000000000001, -2.600000000000002, -3.6999999999999993, -4.299999999999998, -3.6000000000000005, -4.999999999999995, -3.200000000000001, -4.0, -3.200000000000001, -4.599999999999996, -6.099999999999991, -5.199999999999998, -3.5999999999999996, -3.0000000000000018, -4.1999999999999975, -6.200000000000001, -1.9000000000000012, -4.899999999999995, -3.9999999999999982, -20.800000000000043, -52.100000000000286, -3.3000000000000007, -3.3000000000000007], "episode_lengths": [61, 41, 41, 59, 101, 43, 50, 60, 54, 66, 67, 48, 46, 59, 51, 78, 60, 47, 117, 54, 41, 67, 54, 400, 97, 44, 44, 67, 49, 138, 60, 59, 139, 65, 49, 33, 41, 53, 64, 51, 364, 49, 63, 38, 87, 51, 51, 50, 50, 72, 59, 71, 51, 400, 35, 57, 59, 43, 46, 38, 88, 56, 57, 68, 39, 41, 37, 41, 56, 42, 47, 48, 115, 105, 151, 59, 51, 43, 37, 48, 53, 45, 61, 43, 49, 43, 57, 72, 58, 45, 41, 53, 60, 30, 60, 51, 210, 400, 44, 44]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.22349558544351364, "mean_inference_ms": 0.6138724056672848, "mean_action_processing_ms": 0.06750286419815625, "mean_env_wait_ms": 6.186773781064765, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005178928375244141, "StateBufferConnector_ms": 0.0032601356506347656, "ViewRequirementAgentConnector_ms": 0.0730447769165039}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000, "num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 365.4953161344552, "num_env_steps_trained_throughput_per_sec": 365.4953161344552, "timesteps_total": 96000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 96000, "timers": {"training_iteration_time_ms": 10911.353, "sample_time_ms": 7437.106, "load_time_ms": 0.987, "load_throughput": 4054524.276, "learn_time_ms": 3470.981, "learn_throughput": 1152.412, "synch_weights_time_ms": 1.662}, "counters": {"num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000}, "done": false, "episodes_total": 687, "training_iteration": 24, "trial_id": "dbefe_00000", "date": "2024-03-07_12-16-45", "timestamp": 1709831805, "time_this_iter_s": 10.946233987808228, "time_total_s": 257.2089035511017, "pid": 103980, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fcd19c36f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 257.2089035511017, "iterations_since_restore": 24, "perf": {"cpu_util_percent": 20.38571428571429, "ram_util_percent": 44.22857142857142, "gpu_util_percent0": 0.075, "vram_util_percent0": 0.1005859375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.10000000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 3.110499503279871, "policy_loss": -0.005122527227767053, "vf_loss": 3.114733459552129, "vf_explained_var": 0.25610316158622826, "kl": 0.008885737633089056, "entropy": 0.8280631890220027, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 22785.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_agent_steps_sampled": 100000, "num_agent_steps_trained": 100000}, "sampler_results": {"episode_reward_max": -1.9000000000000012, "episode_reward_min": -66.50000000000033, "episode_reward_mean": -7.58800000000001, "episode_len_mean": 76.68, "episode_media": {}, "episodes_this_iter": 52, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4.199999999999999, -47.800000000000395, -2.4000000000000017, -5.099999999999999, -5.7, -3.200000000000001, -3.5, -2.700000000000002, -8.099999999999985, -4.4999999999999964, -4.599999999999996, -7.799999999999999, -3.3000000000000007, -3.0000000000000018, -2.600000000000002, -3.0000000000000018, -4.4999999999999964, -3.1000000000000014, -3.5999999999999996, -4.2, -10.399999999999975, -9.799999999999978, -14.399999999999961, -4.799999999999995, -3.9999999999999982, -3.200000000000001, -2.600000000000002, -3.6999999999999993, -4.299999999999998, -3.6000000000000005, -4.999999999999995, -3.200000000000001, -4.0, -3.200000000000001, -4.599999999999996, -6.099999999999991, -5.199999999999998, -3.5999999999999996, -3.0000000000000018, -4.1999999999999975, -6.200000000000001, -1.9000000000000012, -4.899999999999995, -3.9999999999999982, -20.800000000000043, -52.100000000000286, -3.3000000000000007, -3.3000000000000007, -3.9999999999999982, -4.300000000000001, -5.099999999999997, -4.299999999999997, -4.2, -3.9999999999999982, -3.9999999999999982, -3.799999999999999, -2.4000000000000017, -2.600000000000002, -9.29999999999999, -5.699999999999992, -3.1000000000000014, -3.5999999999999996, -18.899999999999995, -7.099999999999987, -43.20000000000009, -3.3000000000000007, -3.200000000000001, -5.499999999999993, -18.299999999999997, -9.599999999999985, -5.199999999999994, -48.50000000000019, -3.200000000000001, -9.399999999999979, -2.0000000000000013, -10.699999999999983, -2.700000000000002, -3.200000000000001, -4.899999999999995, -4.699999999999996, -4.1999999999999975, -14.499999999999961, -4.799999999999995, -4.299999999999997, -3.200000000000001, -3.6999999999999993, -1.9000000000000012, -4.000000000000001, -4.1999999999999975, -6.599999999999989, -3.8999999999999986, -66.50000000000033, -12.999999999999966, -4.799999999999995, -10.599999999999975, -3.1000000000000014, -3.8999999999999986, -3.3000000000000016, -2.900000000000002, -5.099999999999994], "episode_lengths": [51, 400, 35, 57, 59, 43, 46, 38, 88, 56, 57, 68, 39, 41, 37, 41, 56, 42, 47, 48, 115, 105, 151, 59, 51, 43, 37, 48, 53, 45, 61, 43, 49, 43, 57, 72, 58, 45, 41, 53, 60, 30, 60, 51, 210, 400, 44, 44, 51, 50, 59, 54, 48, 51, 51, 46, 35, 37, 91, 68, 42, 45, 188, 82, 294, 44, 43, 66, 160, 98, 63, 340, 43, 98, 31, 103, 38, 43, 60, 58, 53, 150, 59, 54, 39, 48, 30, 45, 53, 77, 50, 400, 141, 59, 117, 42, 50, 42, 40, 62]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2248160346891239, "mean_inference_ms": 0.6139715969886921, "mean_action_processing_ms": 0.06753481249963932, "mean_env_wait_ms": 6.190605566650832, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005209684371948242, "StateBufferConnector_ms": 0.0032470226287841797, "ViewRequirementAgentConnector_ms": 0.07259678840637207}}, "episode_reward_max": -1.9000000000000012, "episode_reward_min": -66.50000000000033, "episode_reward_mean": -7.58800000000001, "episode_len_mean": 76.68, "episodes_this_iter": 52, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-4.199999999999999, -47.800000000000395, -2.4000000000000017, -5.099999999999999, -5.7, -3.200000000000001, -3.5, -2.700000000000002, -8.099999999999985, -4.4999999999999964, -4.599999999999996, -7.799999999999999, -3.3000000000000007, -3.0000000000000018, -2.600000000000002, -3.0000000000000018, -4.4999999999999964, -3.1000000000000014, -3.5999999999999996, -4.2, -10.399999999999975, -9.799999999999978, -14.399999999999961, -4.799999999999995, -3.9999999999999982, -3.200000000000001, -2.600000000000002, -3.6999999999999993, -4.299999999999998, -3.6000000000000005, -4.999999999999995, -3.200000000000001, -4.0, -3.200000000000001, -4.599999999999996, -6.099999999999991, -5.199999999999998, -3.5999999999999996, -3.0000000000000018, -4.1999999999999975, -6.200000000000001, -1.9000000000000012, -4.899999999999995, -3.9999999999999982, -20.800000000000043, -52.100000000000286, -3.3000000000000007, -3.3000000000000007, -3.9999999999999982, -4.300000000000001, -5.099999999999997, -4.299999999999997, -4.2, -3.9999999999999982, -3.9999999999999982, -3.799999999999999, -2.4000000000000017, -2.600000000000002, -9.29999999999999, -5.699999999999992, -3.1000000000000014, -3.5999999999999996, -18.899999999999995, -7.099999999999987, -43.20000000000009, -3.3000000000000007, -3.200000000000001, -5.499999999999993, -18.299999999999997, -9.599999999999985, -5.199999999999994, -48.50000000000019, -3.200000000000001, -9.399999999999979, -2.0000000000000013, -10.699999999999983, -2.700000000000002, -3.200000000000001, -4.899999999999995, -4.699999999999996, -4.1999999999999975, -14.499999999999961, -4.799999999999995, -4.299999999999997, -3.200000000000001, -3.6999999999999993, -1.9000000000000012, -4.000000000000001, -4.1999999999999975, -6.599999999999989, -3.8999999999999986, -66.50000000000033, -12.999999999999966, -4.799999999999995, -10.599999999999975, -3.1000000000000014, -3.8999999999999986, -3.3000000000000016, -2.900000000000002, -5.099999999999994], "episode_lengths": [51, 400, 35, 57, 59, 43, 46, 38, 88, 56, 57, 68, 39, 41, 37, 41, 56, 42, 47, 48, 115, 105, 151, 59, 51, 43, 37, 48, 53, 45, 61, 43, 49, 43, 57, 72, 58, 45, 41, 53, 60, 30, 60, 51, 210, 400, 44, 44, 51, 50, 59, 54, 48, 51, 51, 46, 35, 37, 91, 68, 42, 45, 188, 82, 294, 44, 43, 66, 160, 98, 63, 340, 43, 98, 31, 103, 38, 43, 60, 58, 53, 150, 59, 54, 39, 48, 30, 45, 53, 77, 50, 400, 141, 59, 117, 42, 50, 42, 40, 62]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2248160346891239, "mean_inference_ms": 0.6139715969886921, "mean_action_processing_ms": 0.06753481249963932, "mean_env_wait_ms": 6.190605566650832, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005209684371948242, "StateBufferConnector_ms": 0.0032470226287841797, "ViewRequirementAgentConnector_ms": 0.07259678840637207}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 100000, "num_agent_steps_trained": 100000, "num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 367.21895230763397, "num_env_steps_trained_throughput_per_sec": 367.21895230763397, "timesteps_total": 100000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 100000, "timers": {"training_iteration_time_ms": 10916.389, "sample_time_ms": 7439.938, "load_time_ms": 0.986, "load_throughput": 4058054.81, "learn_time_ms": 3473.196, "learn_throughput": 1151.677, "synch_weights_time_ms": 1.658}, "counters": {"num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_agent_steps_sampled": 100000, "num_agent_steps_trained": 100000}, "done": false, "episodes_total": 739, "training_iteration": 25, "trial_id": "dbefe_00000", "date": "2024-03-07_12-16-56", "timestamp": 1709831816, "time_this_iter_s": 10.894780158996582, "time_total_s": 268.10368371009827, "pid": 103980, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fcd19c36f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 268.10368371009827, "iterations_since_restore": 25, "perf": {"cpu_util_percent": 20.08571428571429, "ram_util_percent": 44.221428571428575, "gpu_util_percent0": 0.075, "vram_util_percent0": 0.1005859375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.10000000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 1.7028161112845142, "policy_loss": -0.007104882073178086, "vf_loss": 1.709294961529073, "vf_explained_var": 0.5746994646646644, "kl": 0.006260335888501448, "entropy": 0.7970362130672701, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 23715.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 104000, "num_env_steps_trained": 104000, "num_agent_steps_sampled": 104000, "num_agent_steps_trained": 104000}, "sampler_results": {"episode_reward_max": -1.9000000000000012, "episode_reward_min": -66.50000000000033, "episode_reward_mean": -7.332000000000005, "episode_len_mean": 76.3, "episode_media": {}, "episodes_this_iter": 59, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-5.699999999999992, -3.1000000000000014, -3.5999999999999996, -18.899999999999995, -7.099999999999987, -43.20000000000009, -3.3000000000000007, -3.200000000000001, -5.499999999999993, -18.299999999999997, -9.599999999999985, -5.199999999999994, -48.50000000000019, -3.200000000000001, -9.399999999999979, -2.0000000000000013, -10.699999999999983, -2.700000000000002, -3.200000000000001, -4.899999999999995, -4.699999999999996, -4.1999999999999975, -14.499999999999961, -4.799999999999995, -4.299999999999997, -3.200000000000001, -3.6999999999999993, -1.9000000000000012, -4.000000000000001, -4.1999999999999975, -6.599999999999989, -3.8999999999999986, -66.50000000000033, -12.999999999999966, -4.799999999999995, -10.599999999999975, -3.1000000000000014, -3.8999999999999986, -3.3000000000000016, -2.900000000000002, -5.099999999999994, -5.499999999999993, -3.6999999999999993, -5.099999999999994, -3.999999999999999, -4.1999999999999975, -3.799999999999999, -2.700000000000002, -4.199999999999998, -8.999999999999982, -3.8999999999999986, -9.599999999999978, -3.200000000000001, -12.09999999999997, -3.5999999999999996, -11.99999999999998, -5.499999999999993, -43.600000000000286, -3.5999999999999996, -2.2000000000000015, -4.999999999999995, -19.50000000000003, -7.999999999999984, -3.799999999999999, -3.799999999999999, -10.499999999999975, -4.299999999999997, -4.2, -3.5, -2.5000000000000018, -4.099999999999998, -6.599999999999989, -3.200000000000001, -3.5, -3.6999999999999993, -4.099999999999998, -9.09999999999998, -3.3000000000000007, -2.800000000000002, -5.299999999999999, -2.800000000000002, -6.199999999999991, -3.4000000000000004, -3.200000000000001, -3.5, -4.599999999999996, -3.6999999999999993, -8.199999999999983, -6.499999999999989, -3.5, -7.899999999999984, -4.4999999999999964, -5.399999999999993, -2.800000000000002, -9.69999999999998, -5.099999999999994, -4.1999999999999975, -3.5999999999999996, -4.199999999999999, -3.4000000000000004], "episode_lengths": [68, 42, 45, 188, 82, 294, 44, 43, 66, 160, 98, 63, 340, 43, 98, 31, 103, 38, 43, 60, 58, 53, 150, 59, 54, 39, 48, 30, 45, 53, 77, 50, 400, 141, 59, 117, 42, 50, 42, 40, 62, 66, 48, 62, 48, 53, 49, 38, 52, 99, 50, 107, 41, 132, 47, 115, 66, 400, 47, 33, 61, 183, 91, 49, 49, 114, 52, 50, 46, 36, 52, 77, 43, 46, 48, 52, 102, 44, 39, 58, 39, 71, 45, 43, 46, 57, 48, 93, 76, 46, 90, 56, 65, 39, 101, 62, 53, 45, 47, 45]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.22712693822609076, "mean_inference_ms": 0.6141325897456276, "mean_action_processing_ms": 0.06763402978065139, "mean_env_wait_ms": 6.194790166269161, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005414247512817383, "StateBufferConnector_ms": 0.0033218860626220703, "ViewRequirementAgentConnector_ms": 0.07198739051818848}}, "episode_reward_max": -1.9000000000000012, "episode_reward_min": -66.50000000000033, "episode_reward_mean": -7.332000000000005, "episode_len_mean": 76.3, "episodes_this_iter": 59, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-5.699999999999992, -3.1000000000000014, -3.5999999999999996, -18.899999999999995, -7.099999999999987, -43.20000000000009, -3.3000000000000007, -3.200000000000001, -5.499999999999993, -18.299999999999997, -9.599999999999985, -5.199999999999994, -48.50000000000019, -3.200000000000001, -9.399999999999979, -2.0000000000000013, -10.699999999999983, -2.700000000000002, -3.200000000000001, -4.899999999999995, -4.699999999999996, -4.1999999999999975, -14.499999999999961, -4.799999999999995, -4.299999999999997, -3.200000000000001, -3.6999999999999993, -1.9000000000000012, -4.000000000000001, -4.1999999999999975, -6.599999999999989, -3.8999999999999986, -66.50000000000033, -12.999999999999966, -4.799999999999995, -10.599999999999975, -3.1000000000000014, -3.8999999999999986, -3.3000000000000016, -2.900000000000002, -5.099999999999994, -5.499999999999993, -3.6999999999999993, -5.099999999999994, -3.999999999999999, -4.1999999999999975, -3.799999999999999, -2.700000000000002, -4.199999999999998, -8.999999999999982, -3.8999999999999986, -9.599999999999978, -3.200000000000001, -12.09999999999997, -3.5999999999999996, -11.99999999999998, -5.499999999999993, -43.600000000000286, -3.5999999999999996, -2.2000000000000015, -4.999999999999995, -19.50000000000003, -7.999999999999984, -3.799999999999999, -3.799999999999999, -10.499999999999975, -4.299999999999997, -4.2, -3.5, -2.5000000000000018, -4.099999999999998, -6.599999999999989, -3.200000000000001, -3.5, -3.6999999999999993, -4.099999999999998, -9.09999999999998, -3.3000000000000007, -2.800000000000002, -5.299999999999999, -2.800000000000002, -6.199999999999991, -3.4000000000000004, -3.200000000000001, -3.5, -4.599999999999996, -3.6999999999999993, -8.199999999999983, -6.499999999999989, -3.5, -7.899999999999984, -4.4999999999999964, -5.399999999999993, -2.800000000000002, -9.69999999999998, -5.099999999999994, -4.1999999999999975, -3.5999999999999996, -4.199999999999999, -3.4000000000000004], "episode_lengths": [68, 42, 45, 188, 82, 294, 44, 43, 66, 160, 98, 63, 340, 43, 98, 31, 103, 38, 43, 60, 58, 53, 150, 59, 54, 39, 48, 30, 45, 53, 77, 50, 400, 141, 59, 117, 42, 50, 42, 40, 62, 66, 48, 62, 48, 53, 49, 38, 52, 99, 50, 107, 41, 132, 47, 115, 66, 400, 47, 33, 61, 183, 91, 49, 49, 114, 52, 50, 46, 36, 52, 77, 43, 46, 48, 52, 102, 44, 39, 58, 39, 71, 45, 43, 46, 57, 48, 93, 76, 46, 90, 56, 65, 39, 101, 62, 53, 45, 47, 45]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.22712693822609076, "mean_inference_ms": 0.6141325897456276, "mean_action_processing_ms": 0.06763402978065139, "mean_env_wait_ms": 6.194790166269161, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005414247512817383, "StateBufferConnector_ms": 0.0033218860626220703, "ViewRequirementAgentConnector_ms": 0.07198739051818848}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 104000, "num_agent_steps_trained": 104000, "num_env_steps_sampled": 104000, "num_env_steps_trained": 104000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 369.7367216210555, "num_env_steps_trained_throughput_per_sec": 369.7367216210555, "timesteps_total": 104000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 104000, "timers": {"training_iteration_time_ms": 10916.344, "sample_time_ms": 7441.054, "load_time_ms": 0.964, "load_throughput": 4148463.479, "learn_time_ms": 3472.038, "learn_throughput": 1152.061, "synch_weights_time_ms": 1.676}, "counters": {"num_env_steps_sampled": 104000, "num_env_steps_trained": 104000, "num_agent_steps_sampled": 104000, "num_agent_steps_trained": 104000}, "done": false, "episodes_total": 798, "training_iteration": 26, "trial_id": "dbefe_00000", "date": "2024-03-07_12-17-07", "timestamp": 1709831827, "time_this_iter_s": 10.821202993392944, "time_total_s": 278.9248867034912, "pid": 103980, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fcd19c36f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 278.9248867034912, "iterations_since_restore": 26, "perf": {"cpu_util_percent": 19.607142857142858, "ram_util_percent": 44.21428571428571, "gpu_util_percent0": 0.07714285714285714, "vram_util_percent0": 0.1005859375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.10000000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 0.7777396061836982, "policy_loss": -0.01341895568835479, "vf_loss": 0.790236241466576, "vf_explained_var": 0.7822866459046641, "kl": 0.009223155545422832, "entropy": 0.7622583363645821, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 24645.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_agent_steps_sampled": 108000, "num_agent_steps_trained": 108000}, "sampler_results": {"episode_reward_max": -2.0000000000000013, "episode_reward_min": -10.399999999999975, "episode_reward_mean": -4.7129999999999965, "episode_len_mean": 56.68, "episode_media": {}, "episodes_this_iter": 71, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-6.599999999999989, -3.200000000000001, -3.5, -3.6999999999999993, -4.099999999999998, -9.09999999999998, -3.3000000000000007, -2.800000000000002, -5.299999999999999, -2.800000000000002, -6.199999999999991, -3.4000000000000004, -3.200000000000001, -3.5, -4.599999999999996, -3.6999999999999993, -8.199999999999983, -6.499999999999989, -3.5, -7.899999999999984, -4.4999999999999964, -5.399999999999993, -2.800000000000002, -9.69999999999998, -5.099999999999994, -4.1999999999999975, -3.5999999999999996, -4.199999999999999, -3.4000000000000004, -3.3000000000000007, -3.5000000000000018, -4.999999999999995, -3.9000000000000012, -2.5000000000000018, -2.900000000000002, -9.29999999999998, -4.8999999999999995, -6.19999999999999, -3.4000000000000004, -3.6999999999999993, -5.499999999999993, -3.4000000000000004, -3.5999999999999996, -7.099999999999987, -3.3000000000000007, -4.299999999999997, -4.699999999999999, -3.3000000000000007, -5.199999999999999, -3.0000000000000018, -8.89999999999998, -7.499999999999986, -6.999999999999988, -8.999999999999984, -3.200000000000001, -4.0, -3.0000000000000018, -4.299999999999997, -4.000000000000001, -2.900000000000002, -3.4000000000000004, -3.799999999999999, -4.999999999999995, -3.0000000000000018, -3.4000000000000004, -3.200000000000001, -4.6000000000000005, -2.800000000000002, -9.599999999999984, -8.69999999999999, -7.399999999999986, -5.8999999999999915, -7.499999999999986, -4.100000000000001, -4.1000000000000005, -4.1999999999999975, -4.500000000000002, -3.200000000000001, -3.799999999999999, -4.299999999999997, -5.3, -4.0, -4.599999999999996, -4.999999999999995, -3.200000000000002, -2.800000000000002, -2.0000000000000013, -4.200000000000001, -3.9999999999999982, -2.900000000000002, -4.999999999999998, -10.399999999999975, -4.1999999999999975, -6.099999999999991, -3.200000000000001, -3.0000000000000018, -5.899999999999995, -3.7, -4.500000000000001, -6.999999999999992], "episode_lengths": [77, 43, 46, 48, 52, 102, 44, 39, 58, 39, 71, 45, 43, 46, 57, 48, 93, 76, 46, 90, 56, 65, 39, 101, 62, 53, 45, 47, 45, 44, 44, 61, 47, 36, 40, 104, 55, 73, 45, 48, 66, 45, 47, 82, 44, 54, 53, 44, 57, 41, 100, 86, 81, 90, 43, 47, 41, 54, 46, 40, 45, 49, 61, 41, 45, 43, 51, 39, 99, 89, 85, 70, 86, 48, 48, 53, 50, 40, 49, 54, 57, 48, 57, 61, 41, 39, 31, 49, 48, 40, 57, 115, 53, 72, 43, 41, 66, 47, 48, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2300173415907409, "mean_inference_ms": 0.614356021614993, "mean_action_processing_ms": 0.06776095764213774, "mean_env_wait_ms": 6.200756584325688, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005477190017700195, "StateBufferConnector_ms": 0.0031960010528564453, "ViewRequirementAgentConnector_ms": 0.07318282127380371}}, "episode_reward_max": -2.0000000000000013, "episode_reward_min": -10.399999999999975, "episode_reward_mean": -4.7129999999999965, "episode_len_mean": 56.68, "episodes_this_iter": 71, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-6.599999999999989, -3.200000000000001, -3.5, -3.6999999999999993, -4.099999999999998, -9.09999999999998, -3.3000000000000007, -2.800000000000002, -5.299999999999999, -2.800000000000002, -6.199999999999991, -3.4000000000000004, -3.200000000000001, -3.5, -4.599999999999996, -3.6999999999999993, -8.199999999999983, -6.499999999999989, -3.5, -7.899999999999984, -4.4999999999999964, -5.399999999999993, -2.800000000000002, -9.69999999999998, -5.099999999999994, -4.1999999999999975, -3.5999999999999996, -4.199999999999999, -3.4000000000000004, -3.3000000000000007, -3.5000000000000018, -4.999999999999995, -3.9000000000000012, -2.5000000000000018, -2.900000000000002, -9.29999999999998, -4.8999999999999995, -6.19999999999999, -3.4000000000000004, -3.6999999999999993, -5.499999999999993, -3.4000000000000004, -3.5999999999999996, -7.099999999999987, -3.3000000000000007, -4.299999999999997, -4.699999999999999, -3.3000000000000007, -5.199999999999999, -3.0000000000000018, -8.89999999999998, -7.499999999999986, -6.999999999999988, -8.999999999999984, -3.200000000000001, -4.0, -3.0000000000000018, -4.299999999999997, -4.000000000000001, -2.900000000000002, -3.4000000000000004, -3.799999999999999, -4.999999999999995, -3.0000000000000018, -3.4000000000000004, -3.200000000000001, -4.6000000000000005, -2.800000000000002, -9.599999999999984, -8.69999999999999, -7.399999999999986, -5.8999999999999915, -7.499999999999986, -4.100000000000001, -4.1000000000000005, -4.1999999999999975, -4.500000000000002, -3.200000000000001, -3.799999999999999, -4.299999999999997, -5.3, -4.0, -4.599999999999996, -4.999999999999995, -3.200000000000002, -2.800000000000002, -2.0000000000000013, -4.200000000000001, -3.9999999999999982, -2.900000000000002, -4.999999999999998, -10.399999999999975, -4.1999999999999975, -6.099999999999991, -3.200000000000001, -3.0000000000000018, -5.899999999999995, -3.7, -4.500000000000001, -6.999999999999992], "episode_lengths": [77, 43, 46, 48, 52, 102, 44, 39, 58, 39, 71, 45, 43, 46, 57, 48, 93, 76, 46, 90, 56, 65, 39, 101, 62, 53, 45, 47, 45, 44, 44, 61, 47, 36, 40, 104, 55, 73, 45, 48, 66, 45, 47, 82, 44, 54, 53, 44, 57, 41, 100, 86, 81, 90, 43, 47, 41, 54, 46, 40, 45, 49, 61, 41, 45, 43, 51, 39, 99, 89, 85, 70, 86, 48, 48, 53, 50, 40, 49, 54, 57, 48, 57, 61, 41, 39, 31, 49, 48, 40, 57, 115, 53, 72, 43, 41, 66, 47, 48, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2300173415907409, "mean_inference_ms": 0.614356021614993, "mean_action_processing_ms": 0.06776095764213774, "mean_env_wait_ms": 6.200756584325688, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005477190017700195, "StateBufferConnector_ms": 0.0031960010528564453, "ViewRequirementAgentConnector_ms": 0.07318282127380371}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 108000, "num_agent_steps_trained": 108000, "num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 364.15544525086597, "num_env_steps_trained_throughput_per_sec": 364.15544525086597, "timesteps_total": 108000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 108000, "timers": {"training_iteration_time_ms": 10928.924, "sample_time_ms": 7465.371, "load_time_ms": 0.962, "load_throughput": 4156480.032, "learn_time_ms": 3460.281, "learn_throughput": 1155.975, "synch_weights_time_ms": 1.689}, "counters": {"num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_agent_steps_sampled": 108000, "num_agent_steps_trained": 108000}, "done": false, "episodes_total": 869, "training_iteration": 27, "trial_id": "dbefe_00000", "date": "2024-03-07_12-17-18", "timestamp": 1709831838, "time_this_iter_s": 10.986669063568115, "time_total_s": 289.9115557670593, "pid": 103980, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fcd19c36f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 289.9115557670593, "iterations_since_restore": 27, "perf": {"cpu_util_percent": 19.153333333333332, "ram_util_percent": 44.286666666666655, "gpu_util_percent0": 0.09133333333333332, "vram_util_percent0": 0.1005859375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.10000000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 0.9152981634803181, "policy_loss": -0.010974437319823812, "vf_loss": 0.9253154685180034, "vf_explained_var": 0.7099227017612868, "kl": 0.009571398506082933, "entropy": 0.7047231884733323, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 25575.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_agent_steps_sampled": 112000, "num_agent_steps_trained": 112000}, "sampler_results": {"episode_reward_max": -1.9000000000000012, "episode_reward_min": -17.3, "episode_reward_mean": -4.527999999999998, "episode_len_mean": 54.18, "episode_media": {}, "episodes_this_iter": 73, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4.100000000000001, -4.1000000000000005, -4.1999999999999975, -4.500000000000002, -3.200000000000001, -3.799999999999999, -4.299999999999997, -5.3, -4.0, -4.599999999999996, -4.999999999999995, -3.200000000000002, -2.800000000000002, -2.0000000000000013, -4.200000000000001, -3.9999999999999982, -2.900000000000002, -4.999999999999998, -10.399999999999975, -4.1999999999999975, -6.099999999999991, -3.200000000000001, -3.0000000000000018, -5.899999999999995, -3.7, -4.500000000000001, -6.999999999999992, -3.6999999999999993, -3.4000000000000004, -2.600000000000002, -3.200000000000001, -4.4999999999999964, -6.799999999999988, -4.8, -5.299999999999997, -2.600000000000002, -5.5999999999999925, -3.5999999999999996, -5.199999999999997, -6.899999999999988, -3.0000000000000018, -4.100000000000002, -3.5999999999999996, -3.6999999999999993, -6.899999999999991, -3.5999999999999996, -6.899999999999988, -3.500000000000001, -3.3000000000000007, -7.199999999999987, -4.0, -5.099999999999994, -3.1000000000000014, -4.1, -3.3000000000000007, -3.5, -2.2000000000000015, -4.799999999999995, -1.9000000000000012, -3.9999999999999982, -3.7, -7.999999999999984, -2.4000000000000017, -4.4, -6.899999999999988, -14.899999999999977, -3.4000000000000004, -3.9999999999999982, -3.0000000000000018, -2.900000000000002, -3.200000000000001, -3.999999999999999, -2.3000000000000016, -3.5000000000000018, -3.200000000000001, -4.2, -2.700000000000002, -3.200000000000001, -17.3, -5.599999999999997, -4.400000000000001, -2.600000000000002, -4.999999999999995, -4.399999999999997, -3.700000000000002, -6.39999999999999, -7.299999999999995, -8.799999999999981, -3.6999999999999993, -3.8999999999999986, -2.700000000000002, -2.900000000000002, -4.8999999999999995, -3.0000000000000018, -5.0, -2.0000000000000013, -2.900000000000002, -10.599999999999977, -2.800000000000002, -3.799999999999999], "episode_lengths": [48, 48, 53, 50, 40, 49, 54, 57, 48, 57, 61, 41, 39, 31, 49, 48, 40, 57, 115, 53, 72, 43, 41, 66, 47, 48, 76, 48, 45, 37, 40, 56, 79, 54, 60, 37, 67, 47, 60, 80, 41, 47, 47, 48, 77, 47, 80, 41, 44, 83, 47, 62, 42, 46, 44, 46, 33, 59, 30, 51, 43, 91, 35, 48, 80, 134, 45, 51, 37, 40, 43, 50, 34, 43, 43, 48, 38, 43, 165, 62, 50, 37, 61, 55, 44, 75, 75, 99, 48, 50, 38, 40, 55, 41, 52, 31, 40, 110, 39, 49]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23245535131854658, "mean_inference_ms": 0.6147772130144797, "mean_action_processing_ms": 0.06779297741044066, "mean_env_wait_ms": 6.2150493905230455, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005462646484375, "StateBufferConnector_ms": 0.0031890869140625, "ViewRequirementAgentConnector_ms": 0.07355356216430664}}, "episode_reward_max": -1.9000000000000012, "episode_reward_min": -17.3, "episode_reward_mean": -4.527999999999998, "episode_len_mean": 54.18, "episodes_this_iter": 73, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-4.100000000000001, -4.1000000000000005, -4.1999999999999975, -4.500000000000002, -3.200000000000001, -3.799999999999999, -4.299999999999997, -5.3, -4.0, -4.599999999999996, -4.999999999999995, -3.200000000000002, -2.800000000000002, -2.0000000000000013, -4.200000000000001, -3.9999999999999982, -2.900000000000002, -4.999999999999998, -10.399999999999975, -4.1999999999999975, -6.099999999999991, -3.200000000000001, -3.0000000000000018, -5.899999999999995, -3.7, -4.500000000000001, -6.999999999999992, -3.6999999999999993, -3.4000000000000004, -2.600000000000002, -3.200000000000001, -4.4999999999999964, -6.799999999999988, -4.8, -5.299999999999997, -2.600000000000002, -5.5999999999999925, -3.5999999999999996, -5.199999999999997, -6.899999999999988, -3.0000000000000018, -4.100000000000002, -3.5999999999999996, -3.6999999999999993, -6.899999999999991, -3.5999999999999996, -6.899999999999988, -3.500000000000001, -3.3000000000000007, -7.199999999999987, -4.0, -5.099999999999994, -3.1000000000000014, -4.1, -3.3000000000000007, -3.5, -2.2000000000000015, -4.799999999999995, -1.9000000000000012, -3.9999999999999982, -3.7, -7.999999999999984, -2.4000000000000017, -4.4, -6.899999999999988, -14.899999999999977, -3.4000000000000004, -3.9999999999999982, -3.0000000000000018, -2.900000000000002, -3.200000000000001, -3.999999999999999, -2.3000000000000016, -3.5000000000000018, -3.200000000000001, -4.2, -2.700000000000002, -3.200000000000001, -17.3, -5.599999999999997, -4.400000000000001, -2.600000000000002, -4.999999999999995, -4.399999999999997, -3.700000000000002, -6.39999999999999, -7.299999999999995, -8.799999999999981, -3.6999999999999993, -3.8999999999999986, -2.700000000000002, -2.900000000000002, -4.8999999999999995, -3.0000000000000018, -5.0, -2.0000000000000013, -2.900000000000002, -10.599999999999977, -2.800000000000002, -3.799999999999999], "episode_lengths": [48, 48, 53, 50, 40, 49, 54, 57, 48, 57, 61, 41, 39, 31, 49, 48, 40, 57, 115, 53, 72, 43, 41, 66, 47, 48, 76, 48, 45, 37, 40, 56, 79, 54, 60, 37, 67, 47, 60, 80, 41, 47, 47, 48, 77, 47, 80, 41, 44, 83, 47, 62, 42, 46, 44, 46, 33, 59, 30, 51, 43, 91, 35, 48, 80, 134, 45, 51, 37, 40, 43, 50, 34, 43, 43, 48, 38, 43, 165, 62, 50, 37, 61, 55, 44, 75, 75, 99, 48, 50, 38, 40, 55, 41, 52, 31, 40, 110, 39, 49]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23245535131854658, "mean_inference_ms": 0.6147772130144797, "mean_action_processing_ms": 0.06779297741044066, "mean_env_wait_ms": 6.2150493905230455, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005462646484375, "StateBufferConnector_ms": 0.0031890869140625, "ViewRequirementAgentConnector_ms": 0.07355356216430664}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 112000, "num_agent_steps_trained": 112000, "num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 356.5021017458816, "num_env_steps_trained_throughput_per_sec": 356.5021017458816, "timesteps_total": 112000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 112000, "timers": {"training_iteration_time_ms": 10958.808, "sample_time_ms": 7497.609, "load_time_ms": 0.965, "load_throughput": 4144671.558, "learn_time_ms": 3457.918, "learn_throughput": 1156.765, "synch_weights_time_ms": 1.698}, "counters": {"num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_agent_steps_sampled": 112000, "num_agent_steps_trained": 112000}, "done": false, "episodes_total": 942, "training_iteration": 28, "trial_id": "dbefe_00000", "date": "2024-03-07_12-17-29", "timestamp": 1709831849, "time_this_iter_s": 11.222567796707153, "time_total_s": 301.1341235637665, "pid": 103980, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fcd19c36f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 301.1341235637665, "iterations_since_restore": 28, "perf": {"cpu_util_percent": 20.478571428571424, "ram_util_percent": 44.24999999999999, "gpu_util_percent0": 0.07357142857142858, "vram_util_percent0": 0.1005859375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.10000000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 1.3880702897213757, "policy_loss": -0.0031568883567728023, "vf_loss": 1.390487225762298, "vf_explained_var": 0.7310657796680287, "kl": 0.007399501996288182, "entropy": 0.6997180227951337, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 26505.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 116000, "num_env_steps_trained": 116000, "num_agent_steps_sampled": 116000, "num_agent_steps_trained": 116000}, "sampler_results": {"episode_reward_max": -2.0000000000000013, "episode_reward_min": -70.00000000000044, "episode_reward_mean": -4.778000000000003, "episode_len_mean": 54.03, "episode_media": {}, "episodes_this_iter": 77, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.200000000000001, -17.3, -5.599999999999997, -4.400000000000001, -2.600000000000002, -4.999999999999995, -4.399999999999997, -3.700000000000002, -6.39999999999999, -7.299999999999995, -8.799999999999981, -3.6999999999999993, -3.8999999999999986, -2.700000000000002, -2.900000000000002, -4.8999999999999995, -3.0000000000000018, -5.0, -2.0000000000000013, -2.900000000000002, -10.599999999999977, -2.800000000000002, -3.799999999999999, -4.4999999999999964, -5.0, -5.499999999999993, -3.1000000000000014, -2.600000000000002, -2.900000000000002, -5.799999999999992, -2.800000000000002, -2.600000000000002, -2.0000000000000013, -4.3, -2.700000000000002, -6.699999999999989, -6.499999999999991, -4.5, -3.799999999999999, -4.499999999999999, -3.5, -4.399999999999997, -4.1999999999999975, -3.8000000000000016, -3.9999999999999982, -3.1000000000000014, -2.3000000000000016, -9.09999999999998, -3.5999999999999996, -2.700000000000002, -3.9999999999999982, -4.3, -3.200000000000001, -2.900000000000002, -2.3000000000000016, -2.4000000000000017, -5.5999999999999925, -2.800000000000002, -4.6, -4.199999999999998, -3.8000000000000007, -5.099999999999998, -3.799999999999999, -3.1000000000000014, -5.199999999999994, -2.1000000000000014, -70.00000000000044, -3.1000000000000014, -3.9000000000000004, -2.3000000000000016, -4.0, -3.1000000000000014, -8.199999999999992, -3.1000000000000014, -3.0000000000000018, -5.400000000000001, -3.0000000000000018, -3.6999999999999993, -4.099999999999998, -3.3000000000000007, -2.900000000000002, -3.5999999999999996, -2.600000000000002, -4.899999999999995, -3.1000000000000014, -4.099999999999998, -2.800000000000002, -3.3000000000000007, -3.200000000000001, -3.8000000000000016, -3.5, -3.6999999999999993, -3.799999999999999, -3.0000000000000018, -3.1000000000000014, -3.9999999999999982, -6.29999999999999, -2.3000000000000016, -2.900000000000002, -3.9000000000000004], "episode_lengths": [43, 165, 62, 50, 37, 61, 55, 44, 75, 75, 99, 48, 50, 38, 40, 55, 41, 52, 31, 40, 110, 39, 49, 56, 55, 66, 41, 37, 40, 69, 39, 37, 31, 50, 38, 78, 74, 51, 49, 53, 46, 55, 53, 46, 51, 42, 34, 102, 47, 38, 51, 47, 43, 40, 34, 35, 67, 35, 53, 51, 43, 58, 49, 42, 63, 32, 400, 42, 45, 34, 46, 40, 81, 42, 41, 55, 41, 47, 52, 41, 40, 45, 37, 60, 42, 52, 39, 44, 39, 45, 46, 48, 49, 41, 42, 51, 74, 34, 40, 48]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2350696578430233, "mean_inference_ms": 0.6150731213797485, "mean_action_processing_ms": 0.06790252325069962, "mean_env_wait_ms": 6.227534596666319, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005228996276855469, "StateBufferConnector_ms": 0.003157377243041992, "ViewRequirementAgentConnector_ms": 0.07322502136230469}}, "episode_reward_max": -2.0000000000000013, "episode_reward_min": -70.00000000000044, "episode_reward_mean": -4.778000000000003, "episode_len_mean": 54.03, "episodes_this_iter": 77, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3.200000000000001, -17.3, -5.599999999999997, -4.400000000000001, -2.600000000000002, -4.999999999999995, -4.399999999999997, -3.700000000000002, -6.39999999999999, -7.299999999999995, -8.799999999999981, -3.6999999999999993, -3.8999999999999986, -2.700000000000002, -2.900000000000002, -4.8999999999999995, -3.0000000000000018, -5.0, -2.0000000000000013, -2.900000000000002, -10.599999999999977, -2.800000000000002, -3.799999999999999, -4.4999999999999964, -5.0, -5.499999999999993, -3.1000000000000014, -2.600000000000002, -2.900000000000002, -5.799999999999992, -2.800000000000002, -2.600000000000002, -2.0000000000000013, -4.3, -2.700000000000002, -6.699999999999989, -6.499999999999991, -4.5, -3.799999999999999, -4.499999999999999, -3.5, -4.399999999999997, -4.1999999999999975, -3.8000000000000016, -3.9999999999999982, -3.1000000000000014, -2.3000000000000016, -9.09999999999998, -3.5999999999999996, -2.700000000000002, -3.9999999999999982, -4.3, -3.200000000000001, -2.900000000000002, -2.3000000000000016, -2.4000000000000017, -5.5999999999999925, -2.800000000000002, -4.6, -4.199999999999998, -3.8000000000000007, -5.099999999999998, -3.799999999999999, -3.1000000000000014, -5.199999999999994, -2.1000000000000014, -70.00000000000044, -3.1000000000000014, -3.9000000000000004, -2.3000000000000016, -4.0, -3.1000000000000014, -8.199999999999992, -3.1000000000000014, -3.0000000000000018, -5.400000000000001, -3.0000000000000018, -3.6999999999999993, -4.099999999999998, -3.3000000000000007, -2.900000000000002, -3.5999999999999996, -2.600000000000002, -4.899999999999995, -3.1000000000000014, -4.099999999999998, -2.800000000000002, -3.3000000000000007, -3.200000000000001, -3.8000000000000016, -3.5, -3.6999999999999993, -3.799999999999999, -3.0000000000000018, -3.1000000000000014, -3.9999999999999982, -6.29999999999999, -2.3000000000000016, -2.900000000000002, -3.9000000000000004], "episode_lengths": [43, 165, 62, 50, 37, 61, 55, 44, 75, 75, 99, 48, 50, 38, 40, 55, 41, 52, 31, 40, 110, 39, 49, 56, 55, 66, 41, 37, 40, 69, 39, 37, 31, 50, 38, 78, 74, 51, 49, 53, 46, 55, 53, 46, 51, 42, 34, 102, 47, 38, 51, 47, 43, 40, 34, 35, 67, 35, 53, 51, 43, 58, 49, 42, 63, 32, 400, 42, 45, 34, 46, 40, 81, 42, 41, 55, 41, 47, 52, 41, 40, 45, 37, 60, 42, 52, 39, 44, 39, 45, 46, 48, 49, 41, 42, 51, 74, 34, 40, 48]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2350696578430233, "mean_inference_ms": 0.6150731213797485, "mean_action_processing_ms": 0.06790252325069962, "mean_env_wait_ms": 6.227534596666319, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005228996276855469, "StateBufferConnector_ms": 0.003157377243041992, "ViewRequirementAgentConnector_ms": 0.07322502136230469}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 116000, "num_agent_steps_trained": 116000, "num_env_steps_sampled": 116000, "num_env_steps_trained": 116000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 355.10158977085223, "num_env_steps_trained_throughput_per_sec": 355.10158977085223, "timesteps_total": 116000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 116000, "timers": {"training_iteration_time_ms": 10963.21, "sample_time_ms": 7501.532, "load_time_ms": 0.971, "load_throughput": 4119028.75, "learn_time_ms": 3458.399, "learn_throughput": 1156.605, "synch_weights_time_ms": 1.695}, "counters": {"num_env_steps_sampled": 116000, "num_env_steps_trained": 116000, "num_agent_steps_sampled": 116000, "num_agent_steps_trained": 116000}, "done": false, "episodes_total": 1019, "training_iteration": 29, "trial_id": "dbefe_00000", "date": "2024-03-07_12-17-40", "timestamp": 1709831860, "time_this_iter_s": 11.26739501953125, "time_total_s": 312.40151858329773, "pid": 103980, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fcd19c36f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 312.40151858329773, "iterations_since_restore": 29, "perf": {"cpu_util_percent": 19.419999999999998, "ram_util_percent": 44.26000000000001, "gpu_util_percent0": 0.08066666666666666, "vram_util_percent0": 0.1005859375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.10000000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 1.4273018309186207, "policy_loss": -0.01016296249243521, "vf_loss": 1.4358847469972666, "vf_explained_var": 0.6625387885878163, "kl": 0.015800478057101275, "entropy": 0.7026271195821865, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 27435.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 120000, "num_env_steps_trained": 120000, "num_agent_steps_sampled": 120000, "num_agent_steps_trained": 120000}, "sampler_results": {"episode_reward_max": -1.700000000000001, "episode_reward_min": -47.40000000000036, "episode_reward_mean": -3.881000000000003, "episode_len_mean": 47.95, "episode_media": {}, "episodes_this_iter": 79, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.3000000000000007, -2.900000000000002, -3.5999999999999996, -2.600000000000002, -4.899999999999995, -3.1000000000000014, -4.099999999999998, -2.800000000000002, -3.3000000000000007, -3.200000000000001, -3.8000000000000016, -3.5, -3.6999999999999993, -3.799999999999999, -3.0000000000000018, -3.1000000000000014, -3.9999999999999982, -6.29999999999999, -2.3000000000000016, -2.900000000000002, -3.9000000000000004, -3.5, -3.700000000000001, -2.1000000000000014, -3.200000000000001, -2.5000000000000018, -3.0000000000000018, -4.2, -3.5999999999999996, -1.700000000000001, -3.1000000000000014, -3.6999999999999993, -2.1000000000000014, -3.1000000000000014, -2.1000000000000014, -2.1000000000000014, -5.0, -2.800000000000002, -3.200000000000001, -3.8, -3.5, -2.700000000000002, -3.0000000000000018, -3.1000000000000014, -2.5000000000000018, -4.4999999999999964, -3.6999999999999993, -3.4000000000000004, -2.5000000000000018, -3.8999999999999995, -3.9999999999999982, -3.8999999999999986, -2.800000000000002, -2.600000000000002, -2.700000000000002, -3.3000000000000016, -4.399999999999997, -3.200000000000001, -2.3000000000000016, -5.0, -6.699999999999989, -1.8000000000000012, -3.3000000000000016, -2.800000000000002, -3.0000000000000018, -3.1000000000000014, -4.699999999999996, -3.1000000000000014, -2.5000000000000018, -3.1000000000000014, -4.7, -3.200000000000001, -2.1000000000000014, -3.200000000000001, -4.599999999999996, -4.600000000000001, -47.40000000000036, -4.899999999999995, -2.3000000000000016, -6.099999999999991, -6.29999999999999, -4.500000000000001, -2.1000000000000014, -2.2000000000000015, -2.2000000000000015, -2.1000000000000014, -4.099999999999998, -2.600000000000002, -3.9999999999999982, -2.700000000000002, -4.299999999999999, -3.4000000000000004, -4.399999999999997, -4.2, -4.799999999999995, -3.6999999999999993, -3.5, -4.3, -3.4000000000000004, -2.5000000000000018], "episode_lengths": [41, 40, 45, 37, 60, 42, 52, 39, 44, 39, 45, 46, 48, 49, 41, 42, 51, 74, 34, 40, 48, 46, 46, 32, 43, 36, 41, 50, 47, 28, 42, 46, 32, 39, 32, 32, 54, 39, 43, 46, 46, 38, 41, 42, 36, 56, 48, 45, 36, 49, 49, 50, 39, 37, 38, 43, 55, 43, 34, 53, 78, 29, 41, 39, 41, 42, 58, 42, 36, 42, 51, 43, 32, 43, 57, 50, 391, 60, 34, 72, 74, 48, 32, 33, 33, 32, 52, 37, 51, 38, 49, 45, 52, 48, 59, 48, 46, 47, 45, 36]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23784627430283303, "mean_inference_ms": 0.6155636539808899, "mean_action_processing_ms": 0.06804265861057214, "mean_env_wait_ms": 6.2393480783782715, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0055789947509765625, "StateBufferConnector_ms": 0.0032339096069335938, "ViewRequirementAgentConnector_ms": 0.07440972328186035}}, "episode_reward_max": -1.700000000000001, "episode_reward_min": -47.40000000000036, "episode_reward_mean": -3.881000000000003, "episode_len_mean": 47.95, "episodes_this_iter": 79, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3.3000000000000007, -2.900000000000002, -3.5999999999999996, -2.600000000000002, -4.899999999999995, -3.1000000000000014, -4.099999999999998, -2.800000000000002, -3.3000000000000007, -3.200000000000001, -3.8000000000000016, -3.5, -3.6999999999999993, -3.799999999999999, -3.0000000000000018, -3.1000000000000014, -3.9999999999999982, -6.29999999999999, -2.3000000000000016, -2.900000000000002, -3.9000000000000004, -3.5, -3.700000000000001, -2.1000000000000014, -3.200000000000001, -2.5000000000000018, -3.0000000000000018, -4.2, -3.5999999999999996, -1.700000000000001, -3.1000000000000014, -3.6999999999999993, -2.1000000000000014, -3.1000000000000014, -2.1000000000000014, -2.1000000000000014, -5.0, -2.800000000000002, -3.200000000000001, -3.8, -3.5, -2.700000000000002, -3.0000000000000018, -3.1000000000000014, -2.5000000000000018, -4.4999999999999964, -3.6999999999999993, -3.4000000000000004, -2.5000000000000018, -3.8999999999999995, -3.9999999999999982, -3.8999999999999986, -2.800000000000002, -2.600000000000002, -2.700000000000002, -3.3000000000000016, -4.399999999999997, -3.200000000000001, -2.3000000000000016, -5.0, -6.699999999999989, -1.8000000000000012, -3.3000000000000016, -2.800000000000002, -3.0000000000000018, -3.1000000000000014, -4.699999999999996, -3.1000000000000014, -2.5000000000000018, -3.1000000000000014, -4.7, -3.200000000000001, -2.1000000000000014, -3.200000000000001, -4.599999999999996, -4.600000000000001, -47.40000000000036, -4.899999999999995, -2.3000000000000016, -6.099999999999991, -6.29999999999999, -4.500000000000001, -2.1000000000000014, -2.2000000000000015, -2.2000000000000015, -2.1000000000000014, -4.099999999999998, -2.600000000000002, -3.9999999999999982, -2.700000000000002, -4.299999999999999, -3.4000000000000004, -4.399999999999997, -4.2, -4.799999999999995, -3.6999999999999993, -3.5, -4.3, -3.4000000000000004, -2.5000000000000018], "episode_lengths": [41, 40, 45, 37, 60, 42, 52, 39, 44, 39, 45, 46, 48, 49, 41, 42, 51, 74, 34, 40, 48, 46, 46, 32, 43, 36, 41, 50, 47, 28, 42, 46, 32, 39, 32, 32, 54, 39, 43, 46, 46, 38, 41, 42, 36, 56, 48, 45, 36, 49, 49, 50, 39, 37, 38, 43, 55, 43, 34, 53, 78, 29, 41, 39, 41, 42, 58, 42, 36, 42, 51, 43, 32, 43, 57, 50, 391, 60, 34, 72, 74, 48, 32, 33, 33, 32, 52, 37, 51, 38, 49, 45, 52, 48, 59, 48, 46, 47, 45, 36]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23784627430283303, "mean_inference_ms": 0.6155636539808899, "mean_action_processing_ms": 0.06804265861057214, "mean_env_wait_ms": 6.2393480783782715, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0055789947509765625, "StateBufferConnector_ms": 0.0032339096069335938, "ViewRequirementAgentConnector_ms": 0.07440972328186035}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 120000, "num_agent_steps_trained": 120000, "num_env_steps_sampled": 120000, "num_env_steps_trained": 120000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 355.8293846260609, "num_env_steps_trained_throughput_per_sec": 355.8293846260609, "timesteps_total": 120000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 120000, "timers": {"training_iteration_time_ms": 10998.244, "sample_time_ms": 7541.948, "load_time_ms": 0.973, "load_throughput": 4109041.391, "learn_time_ms": 3453.008, "learn_throughput": 1158.41, "synch_weights_time_ms": 1.705}, "counters": {"num_env_steps_sampled": 120000, "num_env_steps_trained": 120000, "num_agent_steps_sampled": 120000, "num_agent_steps_trained": 120000}, "done": false, "episodes_total": 1098, "training_iteration": 30, "trial_id": "dbefe_00000", "date": "2024-03-07_12-17-52", "timestamp": 1709831872, "time_this_iter_s": 11.243800640106201, "time_total_s": 323.64531922340393, "pid": 103980, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fcd19c36f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 323.64531922340393, "iterations_since_restore": 30, "perf": {"cpu_util_percent": 21.257142857142856, "ram_util_percent": 44.26428571428571, "gpu_util_percent0": 0.07714285714285715, "vram_util_percent0": 0.1005859375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.10000000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 2.355044040237353, "policy_loss": -0.007350180466328898, "vf_loss": 2.361489373725909, "vf_explained_var": 0.31589027957249716, "kl": 0.00904845368019393, "entropy": 0.7117607356079163, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 28365.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 124000, "num_env_steps_trained": 124000, "num_agent_steps_sampled": 124000, "num_agent_steps_trained": 124000}, "sampler_results": {"episode_reward_max": -1.8000000000000012, "episode_reward_min": -49.300000000000324, "episode_reward_mean": -5.097000000000008, "episode_len_mean": 57.19, "episode_media": {}, "episodes_this_iter": 72, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2.1000000000000014, -3.200000000000001, -4.599999999999996, -4.600000000000001, -47.40000000000036, -4.899999999999995, -2.3000000000000016, -6.099999999999991, -6.29999999999999, -4.500000000000001, -2.1000000000000014, -2.2000000000000015, -2.2000000000000015, -2.1000000000000014, -4.099999999999998, -2.600000000000002, -3.9999999999999982, -2.700000000000002, -4.299999999999999, -3.4000000000000004, -4.399999999999997, -4.2, -4.799999999999995, -3.6999999999999993, -3.5, -4.3, -3.4000000000000004, -2.5000000000000018, -5.799999999999992, -3.5, -19.500000000000032, -2.700000000000002, -2.0000000000000013, -2.900000000000002, -2.2000000000000015, -1.8000000000000012, -2.700000000000002, -2.1000000000000014, -2.3000000000000016, -3.0000000000000018, -3.8000000000000007, -3.8999999999999995, -2.1000000000000014, -2.600000000000002, -2.900000000000002, -3.3000000000000007, -3.0000000000000018, -3.200000000000001, -2.2000000000000015, -2.4000000000000017, -1.9000000000000012, -49.300000000000324, -2.3000000000000016, -2.800000000000002, -5.799999999999992, -3.0000000000000018, -3.1000000000000014, -16.999999999999996, -2.0000000000000013, -1.9000000000000012, -2.2000000000000015, -2.4000000000000017, -2.2000000000000015, -2.5000000000000018, -8.199999999999983, -3.3000000000000007, -5.1, -2.1000000000000014, -5.000000000000001, -2.3000000000000016, -2.4000000000000017, -2.600000000000002, -1.8000000000000012, -2.4000000000000017, -3.0000000000000018, -3.7, -2.4000000000000017, -3.0000000000000018, -3.8, -2.700000000000002, -2.700000000000002, -24.200000000000077, -2.0000000000000013, -2.2000000000000015, -2.5000000000000018, -3.3000000000000007, -23.500000000000007, -2.2000000000000015, -4.4, -2.800000000000002, -3.4000000000000004, -1.8000000000000012, -4.099999999999998, -3.1000000000000014, -3.4000000000000004, -16.099999999999987, -19.70000000000004, -3.200000000000001, -3.200000000000001, -3.3000000000000007], "episode_lengths": [32, 43, 57, 50, 391, 60, 34, 72, 74, 48, 32, 33, 33, 32, 52, 37, 51, 38, 49, 45, 52, 48, 59, 48, 46, 47, 45, 36, 69, 46, 174, 38, 31, 40, 33, 29, 38, 32, 34, 41, 47, 49, 32, 37, 40, 44, 41, 43, 33, 35, 30, 400, 34, 39, 69, 41, 42, 164, 31, 30, 33, 35, 33, 36, 93, 44, 56, 32, 53, 34, 35, 37, 29, 35, 41, 46, 35, 41, 48, 38, 38, 203, 31, 33, 36, 44, 186, 33, 48, 39, 43, 29, 52, 40, 45, 137, 189, 42, 43, 44]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2393872508963934, "mean_inference_ms": 0.6159269576176597, "mean_action_processing_ms": 0.06797144235639183, "mean_env_wait_ms": 6.255069943852232, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005469560623168945, "StateBufferConnector_ms": 0.0032618045806884766, "ViewRequirementAgentConnector_ms": 0.07334208488464355}}, "episode_reward_max": -1.8000000000000012, "episode_reward_min": -49.300000000000324, "episode_reward_mean": -5.097000000000008, "episode_len_mean": 57.19, "episodes_this_iter": 72, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-2.1000000000000014, -3.200000000000001, -4.599999999999996, -4.600000000000001, -47.40000000000036, -4.899999999999995, -2.3000000000000016, -6.099999999999991, -6.29999999999999, -4.500000000000001, -2.1000000000000014, -2.2000000000000015, -2.2000000000000015, -2.1000000000000014, -4.099999999999998, -2.600000000000002, -3.9999999999999982, -2.700000000000002, -4.299999999999999, -3.4000000000000004, -4.399999999999997, -4.2, -4.799999999999995, -3.6999999999999993, -3.5, -4.3, -3.4000000000000004, -2.5000000000000018, -5.799999999999992, -3.5, -19.500000000000032, -2.700000000000002, -2.0000000000000013, -2.900000000000002, -2.2000000000000015, -1.8000000000000012, -2.700000000000002, -2.1000000000000014, -2.3000000000000016, -3.0000000000000018, -3.8000000000000007, -3.8999999999999995, -2.1000000000000014, -2.600000000000002, -2.900000000000002, -3.3000000000000007, -3.0000000000000018, -3.200000000000001, -2.2000000000000015, -2.4000000000000017, -1.9000000000000012, -49.300000000000324, -2.3000000000000016, -2.800000000000002, -5.799999999999992, -3.0000000000000018, -3.1000000000000014, -16.999999999999996, -2.0000000000000013, -1.9000000000000012, -2.2000000000000015, -2.4000000000000017, -2.2000000000000015, -2.5000000000000018, -8.199999999999983, -3.3000000000000007, -5.1, -2.1000000000000014, -5.000000000000001, -2.3000000000000016, -2.4000000000000017, -2.600000000000002, -1.8000000000000012, -2.4000000000000017, -3.0000000000000018, -3.7, -2.4000000000000017, -3.0000000000000018, -3.8, -2.700000000000002, -2.700000000000002, -24.200000000000077, -2.0000000000000013, -2.2000000000000015, -2.5000000000000018, -3.3000000000000007, -23.500000000000007, -2.2000000000000015, -4.4, -2.800000000000002, -3.4000000000000004, -1.8000000000000012, -4.099999999999998, -3.1000000000000014, -3.4000000000000004, -16.099999999999987, -19.70000000000004, -3.200000000000001, -3.200000000000001, -3.3000000000000007], "episode_lengths": [32, 43, 57, 50, 391, 60, 34, 72, 74, 48, 32, 33, 33, 32, 52, 37, 51, 38, 49, 45, 52, 48, 59, 48, 46, 47, 45, 36, 69, 46, 174, 38, 31, 40, 33, 29, 38, 32, 34, 41, 47, 49, 32, 37, 40, 44, 41, 43, 33, 35, 30, 400, 34, 39, 69, 41, 42, 164, 31, 30, 33, 35, 33, 36, 93, 44, 56, 32, 53, 34, 35, 37, 29, 35, 41, 46, 35, 41, 48, 38, 38, 203, 31, 33, 36, 44, 186, 33, 48, 39, 43, 29, 52, 40, 45, 137, 189, 42, 43, 44]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2393872508963934, "mean_inference_ms": 0.6159269576176597, "mean_action_processing_ms": 0.06797144235639183, "mean_env_wait_ms": 6.255069943852232, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005469560623168945, "StateBufferConnector_ms": 0.0032618045806884766, "ViewRequirementAgentConnector_ms": 0.07334208488464355}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 124000, "num_agent_steps_trained": 124000, "num_env_steps_sampled": 124000, "num_env_steps_trained": 124000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 353.61574664770706, "num_env_steps_trained_throughput_per_sec": 353.61574664770706, "timesteps_total": 124000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 124000, "timers": {"training_iteration_time_ms": 11038.915, "sample_time_ms": 7587.07, "load_time_ms": 0.976, "load_throughput": 4097700.706, "learn_time_ms": 3448.52, "learn_throughput": 1159.918, "synch_weights_time_ms": 1.729}, "counters": {"num_env_steps_sampled": 124000, "num_env_steps_trained": 124000, "num_agent_steps_sampled": 124000, "num_agent_steps_trained": 124000}, "done": false, "episodes_total": 1170, "training_iteration": 31, "trial_id": "dbefe_00000", "date": "2024-03-07_12-18-03", "timestamp": 1709831883, "time_this_iter_s": 11.314146995544434, "time_total_s": 334.95946621894836, "pid": 103980, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fcd19c36f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 334.95946621894836, "iterations_since_restore": 31, "perf": {"cpu_util_percent": 19.69333333333333, "ram_util_percent": 44.28000000000001, "gpu_util_percent0": 0.08133333333333333, "vram_util_percent0": 0.1005859375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.10000000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 3.0512576226370505, "policy_loss": -0.003732569419568585, "vf_loss": 3.054199745033377, "vf_explained_var": 0.23255211089247016, "kl": 0.007904418930416874, "entropy": 0.7188709871743315, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 29295.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 128000, "num_env_steps_trained": 128000, "num_agent_steps_sampled": 128000, "num_agent_steps_trained": 128000}, "sampler_results": {"episode_reward_max": -1.600000000000001, "episode_reward_min": -67.30000000000041, "episode_reward_mean": -5.743000000000013, "episode_len_mean": 59.32, "episode_media": {}, "episodes_this_iter": 66, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-5.1, -2.1000000000000014, -5.000000000000001, -2.3000000000000016, -2.4000000000000017, -2.600000000000002, -1.8000000000000012, -2.4000000000000017, -3.0000000000000018, -3.7, -2.4000000000000017, -3.0000000000000018, -3.8, -2.700000000000002, -2.700000000000002, -24.200000000000077, -2.0000000000000013, -2.2000000000000015, -2.5000000000000018, -3.3000000000000007, -23.500000000000007, -2.2000000000000015, -4.4, -2.800000000000002, -3.4000000000000004, -1.8000000000000012, -4.099999999999998, -3.1000000000000014, -3.4000000000000004, -16.099999999999987, -19.70000000000004, -3.200000000000001, -3.200000000000001, -3.3000000000000007, -3.5, -1.8000000000000012, -4.000000000000002, -2.600000000000002, -1.8000000000000012, -2.800000000000002, -1.8000000000000012, -2.1000000000000014, -2.1000000000000014, -2.4000000000000017, -2.0000000000000013, -3.9999999999999982, -2.700000000000002, -3.799999999999999, -6.200000000000002, -2.700000000000002, -2.0000000000000013, -3.8999999999999995, -2.900000000000002, -3.799999999999999, -2.900000000000002, -3.8000000000000025, -2.2000000000000015, -21.70000000000005, -2.4000000000000017, -2.5000000000000018, -5.199999999999994, -4.200000000000001, -8.399999999999983, -2.5000000000000018, -67.30000000000041, -2.1000000000000014, -1.8000000000000012, -2.5000000000000018, -3.3000000000000007, -2.2000000000000015, -2.2000000000000015, -50.300000000000374, -62.0000000000004, -2.5000000000000018, -3.7, -4.4999999999999964, -2.800000000000002, -3.799999999999999, -2.3000000000000016, -1.700000000000001, -1.9000000000000012, -4.299999999999997, -5.2999999999999945, -4.1999999999999975, -17.199999999999978, -2.0000000000000013, -1.700000000000001, -2.700000000000002, -3.6999999999999993, -2.4000000000000017, -2.2000000000000015, -1.600000000000001, -3.200000000000001, -2.700000000000002, -2.2000000000000015, -3.5, -3.8999999999999986, -2.700000000000002, -2.0000000000000013, -1.8000000000000012], "episode_lengths": [56, 32, 53, 34, 35, 37, 29, 35, 41, 46, 35, 41, 48, 38, 38, 203, 31, 33, 36, 44, 186, 33, 48, 39, 43, 29, 52, 40, 45, 137, 189, 42, 43, 44, 46, 29, 46, 37, 29, 39, 29, 32, 32, 35, 31, 46, 38, 49, 59, 38, 31, 49, 39, 49, 40, 43, 33, 202, 35, 36, 63, 47, 95, 36, 400, 32, 29, 36, 41, 33, 33, 400, 400, 36, 44, 56, 39, 49, 34, 28, 30, 54, 59, 53, 170, 31, 28, 38, 48, 35, 33, 27, 43, 38, 33, 46, 50, 38, 31, 29]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2410042307641648, "mean_inference_ms": 0.6160944344493586, "mean_action_processing_ms": 0.06797909321070512, "mean_env_wait_ms": 6.2683708610727145, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005460500717163086, "StateBufferConnector_ms": 0.003263235092163086, "ViewRequirementAgentConnector_ms": 0.07430481910705566}}, "episode_reward_max": -1.600000000000001, "episode_reward_min": -67.30000000000041, "episode_reward_mean": -5.743000000000013, "episode_len_mean": 59.32, "episodes_this_iter": 66, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-5.1, -2.1000000000000014, -5.000000000000001, -2.3000000000000016, -2.4000000000000017, -2.600000000000002, -1.8000000000000012, -2.4000000000000017, -3.0000000000000018, -3.7, -2.4000000000000017, -3.0000000000000018, -3.8, -2.700000000000002, -2.700000000000002, -24.200000000000077, -2.0000000000000013, -2.2000000000000015, -2.5000000000000018, -3.3000000000000007, -23.500000000000007, -2.2000000000000015, -4.4, -2.800000000000002, -3.4000000000000004, -1.8000000000000012, -4.099999999999998, -3.1000000000000014, -3.4000000000000004, -16.099999999999987, -19.70000000000004, -3.200000000000001, -3.200000000000001, -3.3000000000000007, -3.5, -1.8000000000000012, -4.000000000000002, -2.600000000000002, -1.8000000000000012, -2.800000000000002, -1.8000000000000012, -2.1000000000000014, -2.1000000000000014, -2.4000000000000017, -2.0000000000000013, -3.9999999999999982, -2.700000000000002, -3.799999999999999, -6.200000000000002, -2.700000000000002, -2.0000000000000013, -3.8999999999999995, -2.900000000000002, -3.799999999999999, -2.900000000000002, -3.8000000000000025, -2.2000000000000015, -21.70000000000005, -2.4000000000000017, -2.5000000000000018, -5.199999999999994, -4.200000000000001, -8.399999999999983, -2.5000000000000018, -67.30000000000041, -2.1000000000000014, -1.8000000000000012, -2.5000000000000018, -3.3000000000000007, -2.2000000000000015, -2.2000000000000015, -50.300000000000374, -62.0000000000004, -2.5000000000000018, -3.7, -4.4999999999999964, -2.800000000000002, -3.799999999999999, -2.3000000000000016, -1.700000000000001, -1.9000000000000012, -4.299999999999997, -5.2999999999999945, -4.1999999999999975, -17.199999999999978, -2.0000000000000013, -1.700000000000001, -2.700000000000002, -3.6999999999999993, -2.4000000000000017, -2.2000000000000015, -1.600000000000001, -3.200000000000001, -2.700000000000002, -2.2000000000000015, -3.5, -3.8999999999999986, -2.700000000000002, -2.0000000000000013, -1.8000000000000012], "episode_lengths": [56, 32, 53, 34, 35, 37, 29, 35, 41, 46, 35, 41, 48, 38, 38, 203, 31, 33, 36, 44, 186, 33, 48, 39, 43, 29, 52, 40, 45, 137, 189, 42, 43, 44, 46, 29, 46, 37, 29, 39, 29, 32, 32, 35, 31, 46, 38, 49, 59, 38, 31, 49, 39, 49, 40, 43, 33, 202, 35, 36, 63, 47, 95, 36, 400, 32, 29, 36, 41, 33, 33, 400, 400, 36, 44, 56, 39, 49, 34, 28, 30, 54, 59, 53, 170, 31, 28, 38, 48, 35, 33, 27, 43, 38, 33, 46, 50, 38, 31, 29]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2410042307641648, "mean_inference_ms": 0.6160944344493586, "mean_action_processing_ms": 0.06797909321070512, "mean_env_wait_ms": 6.2683708610727145, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005460500717163086, "StateBufferConnector_ms": 0.003263235092163086, "ViewRequirementAgentConnector_ms": 0.07430481910705566}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 128000, "num_agent_steps_trained": 128000, "num_env_steps_sampled": 128000, "num_env_steps_trained": 128000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 348.83266067943043, "num_env_steps_trained_throughput_per_sec": 348.83266067943043, "timesteps_total": 128000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 128000, "timers": {"training_iteration_time_ms": 11104.774, "sample_time_ms": 7639.56, "load_time_ms": 0.972, "load_throughput": 4117310.297, "learn_time_ms": 3461.866, "learn_throughput": 1155.446, "synch_weights_time_ms": 1.738}, "counters": {"num_env_steps_sampled": 128000, "num_env_steps_trained": 128000, "num_agent_steps_sampled": 128000, "num_agent_steps_trained": 128000}, "done": false, "episodes_total": 1236, "training_iteration": 32, "trial_id": "dbefe_00000", "date": "2024-03-07_12-18-14", "timestamp": 1709831894, "time_this_iter_s": 11.469350576400757, "time_total_s": 346.4288167953491, "pid": 103980, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fcd19c36f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 346.4288167953491, "iterations_since_restore": 32, "perf": {"cpu_util_percent": 19.480000000000004, "ram_util_percent": 44.2, "gpu_util_percent0": 0.07533333333333332, "vram_util_percent0": 0.1005859375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.10000000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 1.7628360620632226, "policy_loss": -0.005784522061065961, "vf_loss": 1.7678017422877332, "vf_explained_var": 0.4334697902202606, "kl": 0.008188427988859524, "entropy": 0.6323423592954553, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 30225.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 132000, "num_env_steps_trained": 132000, "num_agent_steps_sampled": 132000, "num_agent_steps_trained": 132000}, "sampler_results": {"episode_reward_max": -1.5000000000000009, "episode_reward_min": -75.00000000000053, "episode_reward_mean": -3.932000000000008, "episode_len_mean": 44.74, "episode_media": {}, "episodes_this_iter": 85, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2.0000000000000013, -1.700000000000001, -2.700000000000002, -3.6999999999999993, -2.4000000000000017, -2.2000000000000015, -1.600000000000001, -3.200000000000001, -2.700000000000002, -2.2000000000000015, -3.5, -3.8999999999999986, -2.700000000000002, -2.0000000000000013, -1.8000000000000012, -75.00000000000053, -2.600000000000002, -3.9999999999999982, -2.5000000000000018, -2.1000000000000014, -2.3000000000000016, -2.900000000000002, -4.799999999999995, -2.1000000000000014, -3.3000000000000007, -3.3000000000000007, -2.1000000000000014, -2.0000000000000013, -2.800000000000002, -3.1000000000000014, -2.1000000000000014, -3.5999999999999996, -1.8000000000000012, -2.900000000000002, -2.4000000000000017, -2.600000000000002, -2.1000000000000014, -3.700000000000001, -2.4000000000000017, -12.199999999999982, -2.1000000000000014, -2.3000000000000016, -2.5000000000000018, -2.0000000000000013, -4.0, -2.3000000000000016, -3.9000000000000004, -44.00000000000017, -1.600000000000001, -2.5000000000000018, -1.700000000000001, -1.700000000000001, -2.3000000000000016, -2.700000000000002, -3.6999999999999993, -1.5000000000000009, -3.4000000000000004, -2.900000000000002, -2.700000000000002, -2.700000000000002, -2.1000000000000014, -2.1000000000000014, -3.4000000000000004, -3.3000000000000007, -2.2000000000000015, -1.600000000000001, -2.600000000000002, -3.9000000000000004, -2.0000000000000013, -1.8000000000000012, -2.800000000000002, -3.5, -2.4000000000000017, -1.700000000000001, -3.5, -2.900000000000002, -2.4000000000000017, -2.1000000000000014, -2.600000000000002, -3.1000000000000014, -3.5999999999999996, -3.4000000000000004, -3.0000000000000018, -2.700000000000002, -4.299999999999997, -2.900000000000002, -2.5000000000000018, -1.700000000000001, -3.200000000000001, -2.2000000000000015, -2.3000000000000016, -3.5999999999999996, -2.1000000000000014, -4.399999999999997, -2.5000000000000018, -3.999999999999999, -3.9999999999999982, -3.6000000000000005, -1.700000000000001, -2.0000000000000013], "episode_lengths": [31, 28, 38, 48, 35, 33, 27, 43, 38, 33, 46, 50, 38, 31, 29, 400, 37, 51, 36, 32, 34, 38, 59, 32, 41, 44, 32, 31, 39, 38, 32, 47, 29, 40, 35, 37, 32, 44, 35, 114, 32, 34, 36, 31, 45, 34, 44, 343, 27, 36, 28, 28, 34, 38, 44, 26, 45, 40, 38, 38, 32, 32, 41, 40, 33, 27, 37, 46, 31, 29, 39, 42, 35, 28, 42, 40, 35, 32, 37, 38, 43, 45, 41, 38, 54, 40, 36, 28, 41, 33, 34, 47, 32, 55, 34, 47, 51, 42, 28, 31]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24346271892202725, "mean_inference_ms": 0.616504664127816, "mean_action_processing_ms": 0.06800374337925491, "mean_env_wait_ms": 6.288991328070977, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005454301834106445, "StateBufferConnector_ms": 0.003297567367553711, "ViewRequirementAgentConnector_ms": 0.0739142894744873}}, "episode_reward_max": -1.5000000000000009, "episode_reward_min": -75.00000000000053, "episode_reward_mean": -3.932000000000008, "episode_len_mean": 44.74, "episodes_this_iter": 85, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-2.0000000000000013, -1.700000000000001, -2.700000000000002, -3.6999999999999993, -2.4000000000000017, -2.2000000000000015, -1.600000000000001, -3.200000000000001, -2.700000000000002, -2.2000000000000015, -3.5, -3.8999999999999986, -2.700000000000002, -2.0000000000000013, -1.8000000000000012, -75.00000000000053, -2.600000000000002, -3.9999999999999982, -2.5000000000000018, -2.1000000000000014, -2.3000000000000016, -2.900000000000002, -4.799999999999995, -2.1000000000000014, -3.3000000000000007, -3.3000000000000007, -2.1000000000000014, -2.0000000000000013, -2.800000000000002, -3.1000000000000014, -2.1000000000000014, -3.5999999999999996, -1.8000000000000012, -2.900000000000002, -2.4000000000000017, -2.600000000000002, -2.1000000000000014, -3.700000000000001, -2.4000000000000017, -12.199999999999982, -2.1000000000000014, -2.3000000000000016, -2.5000000000000018, -2.0000000000000013, -4.0, -2.3000000000000016, -3.9000000000000004, -44.00000000000017, -1.600000000000001, -2.5000000000000018, -1.700000000000001, -1.700000000000001, -2.3000000000000016, -2.700000000000002, -3.6999999999999993, -1.5000000000000009, -3.4000000000000004, -2.900000000000002, -2.700000000000002, -2.700000000000002, -2.1000000000000014, -2.1000000000000014, -3.4000000000000004, -3.3000000000000007, -2.2000000000000015, -1.600000000000001, -2.600000000000002, -3.9000000000000004, -2.0000000000000013, -1.8000000000000012, -2.800000000000002, -3.5, -2.4000000000000017, -1.700000000000001, -3.5, -2.900000000000002, -2.4000000000000017, -2.1000000000000014, -2.600000000000002, -3.1000000000000014, -3.5999999999999996, -3.4000000000000004, -3.0000000000000018, -2.700000000000002, -4.299999999999997, -2.900000000000002, -2.5000000000000018, -1.700000000000001, -3.200000000000001, -2.2000000000000015, -2.3000000000000016, -3.5999999999999996, -2.1000000000000014, -4.399999999999997, -2.5000000000000018, -3.999999999999999, -3.9999999999999982, -3.6000000000000005, -1.700000000000001, -2.0000000000000013], "episode_lengths": [31, 28, 38, 48, 35, 33, 27, 43, 38, 33, 46, 50, 38, 31, 29, 400, 37, 51, 36, 32, 34, 38, 59, 32, 41, 44, 32, 31, 39, 38, 32, 47, 29, 40, 35, 37, 32, 44, 35, 114, 32, 34, 36, 31, 45, 34, 44, 343, 27, 36, 28, 28, 34, 38, 44, 26, 45, 40, 38, 38, 32, 32, 41, 40, 33, 27, 37, 46, 31, 29, 39, 42, 35, 28, 42, 40, 35, 32, 37, 38, 43, 45, 41, 38, 54, 40, 36, 28, 41, 33, 34, 47, 32, 55, 34, 47, 51, 42, 28, 31]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24346271892202725, "mean_inference_ms": 0.616504664127816, "mean_action_processing_ms": 0.06800374337925491, "mean_env_wait_ms": 6.288991328070977, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005454301834106445, "StateBufferConnector_ms": 0.003297567367553711, "ViewRequirementAgentConnector_ms": 0.0739142894744873}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 132000, "num_agent_steps_trained": 132000, "num_env_steps_sampled": 132000, "num_env_steps_trained": 132000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 347.7891697977032, "num_env_steps_trained_throughput_per_sec": 347.7891697977032, "timesteps_total": 132000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 132000, "timers": {"training_iteration_time_ms": 11164.485, "sample_time_ms": 7695.858, "load_time_ms": 0.972, "load_throughput": 4114987.614, "learn_time_ms": 3465.278, "learn_throughput": 1154.308, "synch_weights_time_ms": 1.738}, "counters": {"num_env_steps_sampled": 132000, "num_env_steps_trained": 132000, "num_agent_steps_sampled": 132000, "num_agent_steps_trained": 132000}, "done": false, "episodes_total": 1321, "training_iteration": 33, "trial_id": "dbefe_00000", "date": "2024-03-07_12-18-26", "timestamp": 1709831906, "time_this_iter_s": 11.503877401351929, "time_total_s": 357.93269419670105, "pid": 103980, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fcd19c36f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 357.93269419670105, "iterations_since_restore": 33, "perf": {"cpu_util_percent": 20.033333333333335, "ram_util_percent": 44.10000000000001, "gpu_util_percent0": 0.06999999999999999, "vram_util_percent0": 0.1005859375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.10000000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 1.3218635165835455, "policy_loss": -0.007816179745620298, "vf_loss": 1.3286628828774536, "vf_explained_var": 0.6887424051120717, "kl": 0.010168076410869947, "entropy": 0.5552639655208075, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 31155.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 136000, "num_env_steps_trained": 136000, "num_agent_steps_sampled": 136000, "num_agent_steps_trained": 136000}, "sampler_results": {"episode_reward_max": -1.600000000000001, "episode_reward_min": -74.30000000000034, "episode_reward_mean": -3.8740000000000068, "episode_len_mean": 43.45, "episode_media": {}, "episodes_this_iter": 96, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.9999999999999982, -3.6000000000000005, -1.700000000000001, -2.0000000000000013, -2.0000000000000013, -2.1000000000000014, -2.3000000000000016, -6.39999999999999, -1.600000000000001, -2.5000000000000018, -2.4000000000000017, -2.2000000000000015, -2.900000000000002, -1.9000000000000012, -3.3000000000000007, -1.8000000000000012, -1.9000000000000012, -2.0000000000000013, -1.8000000000000012, -1.9000000000000012, -3.5999999999999996, -2.4000000000000017, -2.700000000000002, -1.9000000000000012, -2.3000000000000016, -2.800000000000002, -2.0000000000000013, -4.1000000000000005, -2.1000000000000014, -1.700000000000001, -2.1000000000000014, -4.899999999999995, -1.700000000000001, -3.1000000000000014, -2.1000000000000014, -74.30000000000034, -2.900000000000002, -2.600000000000002, -3.5, -3.200000000000001, -3.400000000000002, -2.1000000000000014, -2.1000000000000014, -1.700000000000001, -2.4000000000000017, -1.8000000000000012, -1.700000000000001, -2.900000000000002, -2.700000000000002, -1.9000000000000012, -51.90000000000023, -2.700000000000002, -2.900000000000002, -3.9000000000000004, -1.8000000000000012, -6.799999999999995, -2.3000000000000016, -2.2000000000000015, -1.9000000000000012, -2.3000000000000016, -2.1000000000000014, -1.700000000000001, -1.700000000000001, -1.700000000000001, -4.1999999999999975, -1.700000000000001, -3.7, -5.299999999999994, -2.1000000000000014, -2.0000000000000013, -1.9000000000000012, -1.8000000000000012, -2.4000000000000017, -2.4000000000000017, -1.8000000000000012, -2.600000000000002, -2.1000000000000014, -2.700000000000002, -3.1000000000000014, -2.1000000000000014, -3.6000000000000005, -2.0000000000000013, -2.800000000000002, -2.900000000000002, -4.6999999999999975, -3.4000000000000004, -2.5000000000000018, -2.4000000000000017, -3.5999999999999996, -1.700000000000001, -2.3000000000000016, -3.700000000000001, -3.5, -3.0000000000000018, -2.900000000000002, -2.1000000000000014, -2.2000000000000015, -3.5999999999999996, -2.4000000000000017, -5.3], "episode_lengths": [51, 42, 28, 31, 31, 32, 34, 75, 27, 36, 35, 33, 40, 30, 40, 29, 30, 31, 29, 30, 47, 35, 38, 30, 34, 39, 31, 45, 32, 28, 32, 60, 28, 40, 32, 400, 40, 37, 46, 42, 40, 32, 32, 28, 35, 29, 28, 39, 38, 30, 341, 38, 40, 40, 29, 71, 34, 33, 30, 34, 32, 28, 28, 28, 53, 28, 44, 64, 32, 31, 30, 29, 34, 35, 29, 37, 32, 38, 42, 32, 42, 31, 39, 38, 56, 41, 36, 35, 47, 28, 34, 41, 42, 41, 38, 32, 33, 42, 35, 57]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24568070628086566, "mean_inference_ms": 0.6165579036842052, "mean_action_processing_ms": 0.06792346504835979, "mean_env_wait_ms": 6.303457496345466, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005498170852661133, "StateBufferConnector_ms": 0.0033254623413085938, "ViewRequirementAgentConnector_ms": 0.07407975196838379}}, "episode_reward_max": -1.600000000000001, "episode_reward_min": -74.30000000000034, "episode_reward_mean": -3.8740000000000068, "episode_len_mean": 43.45, "episodes_this_iter": 96, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3.9999999999999982, -3.6000000000000005, -1.700000000000001, -2.0000000000000013, -2.0000000000000013, -2.1000000000000014, -2.3000000000000016, -6.39999999999999, -1.600000000000001, -2.5000000000000018, -2.4000000000000017, -2.2000000000000015, -2.900000000000002, -1.9000000000000012, -3.3000000000000007, -1.8000000000000012, -1.9000000000000012, -2.0000000000000013, -1.8000000000000012, -1.9000000000000012, -3.5999999999999996, -2.4000000000000017, -2.700000000000002, -1.9000000000000012, -2.3000000000000016, -2.800000000000002, -2.0000000000000013, -4.1000000000000005, -2.1000000000000014, -1.700000000000001, -2.1000000000000014, -4.899999999999995, -1.700000000000001, -3.1000000000000014, -2.1000000000000014, -74.30000000000034, -2.900000000000002, -2.600000000000002, -3.5, -3.200000000000001, -3.400000000000002, -2.1000000000000014, -2.1000000000000014, -1.700000000000001, -2.4000000000000017, -1.8000000000000012, -1.700000000000001, -2.900000000000002, -2.700000000000002, -1.9000000000000012, -51.90000000000023, -2.700000000000002, -2.900000000000002, -3.9000000000000004, -1.8000000000000012, -6.799999999999995, -2.3000000000000016, -2.2000000000000015, -1.9000000000000012, -2.3000000000000016, -2.1000000000000014, -1.700000000000001, -1.700000000000001, -1.700000000000001, -4.1999999999999975, -1.700000000000001, -3.7, -5.299999999999994, -2.1000000000000014, -2.0000000000000013, -1.9000000000000012, -1.8000000000000012, -2.4000000000000017, -2.4000000000000017, -1.8000000000000012, -2.600000000000002, -2.1000000000000014, -2.700000000000002, -3.1000000000000014, -2.1000000000000014, -3.6000000000000005, -2.0000000000000013, -2.800000000000002, -2.900000000000002, -4.6999999999999975, -3.4000000000000004, -2.5000000000000018, -2.4000000000000017, -3.5999999999999996, -1.700000000000001, -2.3000000000000016, -3.700000000000001, -3.5, -3.0000000000000018, -2.900000000000002, -2.1000000000000014, -2.2000000000000015, -3.5999999999999996, -2.4000000000000017, -5.3], "episode_lengths": [51, 42, 28, 31, 31, 32, 34, 75, 27, 36, 35, 33, 40, 30, 40, 29, 30, 31, 29, 30, 47, 35, 38, 30, 34, 39, 31, 45, 32, 28, 32, 60, 28, 40, 32, 400, 40, 37, 46, 42, 40, 32, 32, 28, 35, 29, 28, 39, 38, 30, 341, 38, 40, 40, 29, 71, 34, 33, 30, 34, 32, 28, 28, 28, 53, 28, 44, 64, 32, 31, 30, 29, 34, 35, 29, 37, 32, 38, 42, 32, 42, 31, 39, 38, 56, 41, 36, 35, 47, 28, 34, 41, 42, 41, 38, 32, 33, 42, 35, 57]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24568070628086566, "mean_inference_ms": 0.6165579036842052, "mean_action_processing_ms": 0.06792346504835979, "mean_env_wait_ms": 6.303457496345466, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005498170852661133, "StateBufferConnector_ms": 0.0033254623413085938, "ViewRequirementAgentConnector_ms": 0.07407975196838379}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 136000, "num_agent_steps_trained": 136000, "num_env_steps_sampled": 136000, "num_env_steps_trained": 136000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 346.9645542125395, "num_env_steps_trained_throughput_per_sec": 346.9645542125395, "timesteps_total": 136000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 136000, "timers": {"training_iteration_time_ms": 11222.936, "sample_time_ms": 7754.004, "load_time_ms": 0.971, "load_throughput": 4120445.023, "learn_time_ms": 3465.582, "learn_throughput": 1154.207, "synch_weights_time_ms": 1.743}, "counters": {"num_env_steps_sampled": 136000, "num_env_steps_trained": 136000, "num_agent_steps_sampled": 136000, "num_agent_steps_trained": 136000}, "done": false, "episodes_total": 1417, "training_iteration": 34, "trial_id": "dbefe_00000", "date": "2024-03-07_12-18-38", "timestamp": 1709831918, "time_this_iter_s": 11.530832052230835, "time_total_s": 369.4635262489319, "pid": 103980, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fcd19c36f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 369.4635262489319, "iterations_since_restore": 34, "perf": {"cpu_util_percent": 20.066666666666666, "ram_util_percent": 44.106666666666676, "gpu_util_percent0": 0.07333333333333332, "vram_util_percent0": 0.1005859375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.10000000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 1.0867976506193098, "policy_loss": -0.008050474736799476, "vf_loss": 1.093709182567013, "vf_explained_var": 0.5933078039717931, "kl": 0.011389476567559105, "entropy": 0.5468516502649553, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 32085.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 140000, "num_env_steps_trained": 140000, "num_agent_steps_sampled": 140000, "num_agent_steps_trained": 140000}, "sampler_results": {"episode_reward_max": -1.5000000000000009, "episode_reward_min": -26.300000000000068, "episode_reward_mean": -3.186000000000001, "episode_len_mean": 41.25, "episode_media": {}, "episodes_this_iter": 97, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.5999999999999996, -2.4000000000000017, -5.3, -2.5000000000000018, -2.3000000000000016, -2.0000000000000013, -2.1000000000000014, -1.9000000000000012, -4.200000000000001, -2.600000000000002, -2.4000000000000017, -2.600000000000002, -3.1000000000000014, -1.8000000000000012, -26.300000000000068, -2.0000000000000013, -2.5000000000000018, -2.1000000000000014, -2.3000000000000016, -2.1000000000000014, -2.900000000000002, -17.799999999999986, -1.8000000000000012, -1.9000000000000012, -1.8000000000000012, -4.099999999999998, -1.9000000000000012, -2.1000000000000014, -5.399999999999993, -3.6000000000000014, -2.5000000000000018, -2.3000000000000016, -1.8000000000000012, -1.9000000000000012, -17.90000000000001, -2.600000000000002, -4.500000000000003, -2.4000000000000017, -2.4000000000000017, -1.9000000000000012, -2.0000000000000013, -2.900000000000002, -1.700000000000001, -2.3000000000000016, -3.4000000000000004, -3.4000000000000004, -3.200000000000001, -2.2000000000000015, -3.5, -2.2000000000000015, -2.700000000000002, -2.3000000000000016, -2.4000000000000017, -3.3000000000000007, -2.0000000000000013, -2.5000000000000018, -2.2000000000000015, -2.2000000000000015, -2.5000000000000018, -2.800000000000002, -4.399999999999998, -2.2000000000000015, -1.9000000000000012, -2.3000000000000016, -13.999999999999964, -1.700000000000001, -1.600000000000001, -1.5000000000000009, -1.9000000000000012, -2.2000000000000015, -2.2000000000000015, -6.499999999999989, -2.800000000000002, -3.3000000000000016, -1.8000000000000012, -2.0000000000000013, -2.1000000000000014, -1.8000000000000012, -2.4000000000000017, -2.0000000000000013, -1.8000000000000012, -2.800000000000002, -2.3000000000000016, -5.000000000000002, -1.8000000000000012, -2.0000000000000013, -1.600000000000001, -3.200000000000001, -1.700000000000001, -1.9000000000000012, -1.600000000000001, -2.800000000000002, -2.2000000000000015, -2.1000000000000014, -1.9000000000000012, -1.9000000000000012, -1.9000000000000012, -2.3000000000000016, -2.2000000000000015, -3.6999999999999993], "episode_lengths": [42, 35, 57, 36, 34, 31, 32, 30, 46, 37, 35, 37, 42, 29, 225, 31, 36, 32, 34, 32, 40, 165, 29, 30, 29, 52, 30, 32, 65, 41, 36, 34, 29, 30, 169, 37, 49, 35, 35, 30, 31, 40, 28, 34, 44, 45, 43, 33, 43, 33, 38, 34, 35, 44, 31, 36, 33, 33, 36, 39, 54, 33, 29, 34, 144, 28, 27, 26, 30, 33, 33, 76, 39, 40, 29, 31, 32, 29, 35, 31, 29, 39, 34, 51, 29, 31, 27, 39, 28, 30, 27, 39, 33, 32, 30, 30, 30, 34, 33, 44]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24823751162530938, "mean_inference_ms": 0.6173143467998, "mean_action_processing_ms": 0.06787904923349314, "mean_env_wait_ms": 6.330434824568881, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005690336227416992, "StateBufferConnector_ms": 0.0034236907958984375, "ViewRequirementAgentConnector_ms": 0.07601809501647949}}, "episode_reward_max": -1.5000000000000009, "episode_reward_min": -26.300000000000068, "episode_reward_mean": -3.186000000000001, "episode_len_mean": 41.25, "episodes_this_iter": 97, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3.5999999999999996, -2.4000000000000017, -5.3, -2.5000000000000018, -2.3000000000000016, -2.0000000000000013, -2.1000000000000014, -1.9000000000000012, -4.200000000000001, -2.600000000000002, -2.4000000000000017, -2.600000000000002, -3.1000000000000014, -1.8000000000000012, -26.300000000000068, -2.0000000000000013, -2.5000000000000018, -2.1000000000000014, -2.3000000000000016, -2.1000000000000014, -2.900000000000002, -17.799999999999986, -1.8000000000000012, -1.9000000000000012, -1.8000000000000012, -4.099999999999998, -1.9000000000000012, -2.1000000000000014, -5.399999999999993, -3.6000000000000014, -2.5000000000000018, -2.3000000000000016, -1.8000000000000012, -1.9000000000000012, -17.90000000000001, -2.600000000000002, -4.500000000000003, -2.4000000000000017, -2.4000000000000017, -1.9000000000000012, -2.0000000000000013, -2.900000000000002, -1.700000000000001, -2.3000000000000016, -3.4000000000000004, -3.4000000000000004, -3.200000000000001, -2.2000000000000015, -3.5, -2.2000000000000015, -2.700000000000002, -2.3000000000000016, -2.4000000000000017, -3.3000000000000007, -2.0000000000000013, -2.5000000000000018, -2.2000000000000015, -2.2000000000000015, -2.5000000000000018, -2.800000000000002, -4.399999999999998, -2.2000000000000015, -1.9000000000000012, -2.3000000000000016, -13.999999999999964, -1.700000000000001, -1.600000000000001, -1.5000000000000009, -1.9000000000000012, -2.2000000000000015, -2.2000000000000015, -6.499999999999989, -2.800000000000002, -3.3000000000000016, -1.8000000000000012, -2.0000000000000013, -2.1000000000000014, -1.8000000000000012, -2.4000000000000017, -2.0000000000000013, -1.8000000000000012, -2.800000000000002, -2.3000000000000016, -5.000000000000002, -1.8000000000000012, -2.0000000000000013, -1.600000000000001, -3.200000000000001, -1.700000000000001, -1.9000000000000012, -1.600000000000001, -2.800000000000002, -2.2000000000000015, -2.1000000000000014, -1.9000000000000012, -1.9000000000000012, -1.9000000000000012, -2.3000000000000016, -2.2000000000000015, -3.6999999999999993], "episode_lengths": [42, 35, 57, 36, 34, 31, 32, 30, 46, 37, 35, 37, 42, 29, 225, 31, 36, 32, 34, 32, 40, 165, 29, 30, 29, 52, 30, 32, 65, 41, 36, 34, 29, 30, 169, 37, 49, 35, 35, 30, 31, 40, 28, 34, 44, 45, 43, 33, 43, 33, 38, 34, 35, 44, 31, 36, 33, 33, 36, 39, 54, 33, 29, 34, 144, 28, 27, 26, 30, 33, 33, 76, 39, 40, 29, 31, 32, 29, 35, 31, 29, 39, 34, 51, 29, 31, 27, 39, 28, 30, 27, 39, 33, 32, 30, 30, 30, 34, 33, 44]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24823751162530938, "mean_inference_ms": 0.6173143467998, "mean_action_processing_ms": 0.06787904923349314, "mean_env_wait_ms": 6.330434824568881, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005690336227416992, "StateBufferConnector_ms": 0.0034236907958984375, "ViewRequirementAgentConnector_ms": 0.07601809501647949}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 140000, "num_agent_steps_trained": 140000, "num_env_steps_sampled": 140000, "num_env_steps_trained": 140000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 340.8674492518455, "num_env_steps_trained_throughput_per_sec": 340.8674492518455, "timesteps_total": 140000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 140000, "timers": {"training_iteration_time_ms": 11307.143, "sample_time_ms": 7842.062, "load_time_ms": 0.973, "load_throughput": 4110048.016, "learn_time_ms": 3461.727, "learn_throughput": 1155.493, "synch_weights_time_ms": 1.741}, "counters": {"num_env_steps_sampled": 140000, "num_env_steps_trained": 140000, "num_agent_steps_sampled": 140000, "num_agent_steps_trained": 140000}, "done": false, "episodes_total": 1514, "training_iteration": 35, "trial_id": "dbefe_00000", "date": "2024-03-07_12-18-49", "timestamp": 1709831929, "time_this_iter_s": 11.737215518951416, "time_total_s": 381.2007417678833, "pid": 103980, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fcd19c36f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 381.2007417678833, "iterations_since_restore": 35, "perf": {"cpu_util_percent": 20.225, "ram_util_percent": 44.16875, "gpu_util_percent0": 0.079375, "vram_util_percent0": 0.1005859375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.10000000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 0.29865269942624717, "policy_loss": -0.009179215245349433, "vf_loss": 0.3070878635651322, "vf_explained_var": 0.8108664351765827, "kl": 0.007440513186841084, "entropy": 0.48615789000065096, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 33015.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_agent_steps_sampled": 144000, "num_agent_steps_trained": 144000}, "sampler_results": {"episode_reward_max": -1.4000000000000008, "episode_reward_min": -6.599999999999989, "episode_reward_mean": -2.4903508771929843, "episode_len_mean": 35.30701754385965, "episode_media": {}, "episodes_this_iter": 114, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2.1000000000000014, -1.5000000000000009, -2.2000000000000015, -1.9000000000000012, -1.9000000000000012, -1.4000000000000008, -2.900000000000002, -1.8000000000000012, -3.0000000000000018, -2.5000000000000018, -2.0000000000000013, -2.2000000000000015, -2.5000000000000018, -2.0000000000000013, -1.700000000000001, -2.2000000000000015, -3.9999999999999982, -1.9000000000000012, -2.4000000000000017, -2.800000000000002, -1.9000000000000012, -1.600000000000001, -1.8000000000000012, -1.9000000000000012, -1.8000000000000012, -2.900000000000002, -1.9000000000000012, -1.9000000000000012, -3.8000000000000016, -1.8000000000000012, -1.9000000000000012, -2.4000000000000017, -1.8000000000000012, -2.4000000000000017, -3.3000000000000007, -1.9000000000000012, -2.1000000000000014, -1.9000000000000012, -2.3000000000000016, -5.200000000000004, -2.4000000000000017, -2.1000000000000014, -2.2000000000000015, -2.5000000000000018, -4.1999999999999975, -2.1000000000000014, -1.8000000000000012, -2.1000000000000014, -2.0000000000000013, -4.599999999999996, -2.2000000000000015, -2.0000000000000013, -2.800000000000002, -3.1000000000000014, -1.8000000000000012, -2.5000000000000018, -2.800000000000002, -3.1000000000000014, -1.9000000000000012, -4.100000000000002, -1.8000000000000012, -1.8000000000000012, -1.700000000000001, -1.9000000000000012, -5.199999999999994, -3.200000000000001, -5.099999999999999, -2.700000000000002, -3.200000000000001, -1.600000000000001, -1.700000000000001, -2.700000000000002, -2.5000000000000018, -1.5000000000000009, -4.099999999999998, -2.1000000000000014, -2.1000000000000014, -1.600000000000001, -2.0000000000000013, -6.599999999999989, -4.799999999999995, -1.9000000000000012, -2.5000000000000018, -2.3000000000000016, -2.2000000000000015, -1.700000000000001, -3.5, -1.8000000000000012, -1.8000000000000012, -1.8000000000000012, -4.300000000000001, -2.800000000000002, -1.8000000000000012, -2.1000000000000014, -3.1000000000000014, -2.5000000000000018, -2.3000000000000016, -2.1000000000000014, -2.3000000000000016, -1.700000000000001, -3.200000000000001, -4.700000000000001, -1.8000000000000012, -1.700000000000001, -2.1000000000000014, -2.2000000000000015, -3.3000000000000007, -2.5000000000000018, -1.9000000000000012, -2.3000000000000016, -2.4000000000000017, -3.5999999999999996, -2.600000000000002, -1.5000000000000009], "episode_lengths": [32, 26, 33, 30, 30, 25, 40, 29, 41, 36, 31, 33, 36, 31, 28, 33, 51, 30, 35, 39, 30, 27, 29, 30, 29, 40, 30, 30, 46, 29, 30, 35, 29, 35, 44, 30, 32, 30, 34, 50, 35, 32, 33, 36, 49, 32, 29, 32, 31, 57, 33, 31, 39, 38, 29, 36, 39, 41, 30, 46, 29, 29, 28, 30, 63, 43, 55, 38, 40, 27, 28, 38, 36, 26, 52, 32, 32, 27, 31, 77, 59, 30, 36, 34, 33, 28, 42, 29, 29, 29, 50, 39, 29, 32, 42, 36, 34, 32, 34, 28, 39, 49, 29, 28, 32, 33, 44, 36, 30, 34, 35, 41, 37, 26]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2510844202313364, "mean_inference_ms": 0.6175452610977152, "mean_action_processing_ms": 0.06788650515385233, "mean_env_wait_ms": 6.347743729992649, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005470242416649534, "StateBufferConnector_ms": 0.003344761697869552, "ViewRequirementAgentConnector_ms": 0.07463400824028149}}, "episode_reward_max": -1.4000000000000008, "episode_reward_min": -6.599999999999989, "episode_reward_mean": -2.4903508771929843, "episode_len_mean": 35.30701754385965, "episodes_this_iter": 114, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-2.1000000000000014, -1.5000000000000009, -2.2000000000000015, -1.9000000000000012, -1.9000000000000012, -1.4000000000000008, -2.900000000000002, -1.8000000000000012, -3.0000000000000018, -2.5000000000000018, -2.0000000000000013, -2.2000000000000015, -2.5000000000000018, -2.0000000000000013, -1.700000000000001, -2.2000000000000015, -3.9999999999999982, -1.9000000000000012, -2.4000000000000017, -2.800000000000002, -1.9000000000000012, -1.600000000000001, -1.8000000000000012, -1.9000000000000012, -1.8000000000000012, -2.900000000000002, -1.9000000000000012, -1.9000000000000012, -3.8000000000000016, -1.8000000000000012, -1.9000000000000012, -2.4000000000000017, -1.8000000000000012, -2.4000000000000017, -3.3000000000000007, -1.9000000000000012, -2.1000000000000014, -1.9000000000000012, -2.3000000000000016, -5.200000000000004, -2.4000000000000017, -2.1000000000000014, -2.2000000000000015, -2.5000000000000018, -4.1999999999999975, -2.1000000000000014, -1.8000000000000012, -2.1000000000000014, -2.0000000000000013, -4.599999999999996, -2.2000000000000015, -2.0000000000000013, -2.800000000000002, -3.1000000000000014, -1.8000000000000012, -2.5000000000000018, -2.800000000000002, -3.1000000000000014, -1.9000000000000012, -4.100000000000002, -1.8000000000000012, -1.8000000000000012, -1.700000000000001, -1.9000000000000012, -5.199999999999994, -3.200000000000001, -5.099999999999999, -2.700000000000002, -3.200000000000001, -1.600000000000001, -1.700000000000001, -2.700000000000002, -2.5000000000000018, -1.5000000000000009, -4.099999999999998, -2.1000000000000014, -2.1000000000000014, -1.600000000000001, -2.0000000000000013, -6.599999999999989, -4.799999999999995, -1.9000000000000012, -2.5000000000000018, -2.3000000000000016, -2.2000000000000015, -1.700000000000001, -3.5, -1.8000000000000012, -1.8000000000000012, -1.8000000000000012, -4.300000000000001, -2.800000000000002, -1.8000000000000012, -2.1000000000000014, -3.1000000000000014, -2.5000000000000018, -2.3000000000000016, -2.1000000000000014, -2.3000000000000016, -1.700000000000001, -3.200000000000001, -4.700000000000001, -1.8000000000000012, -1.700000000000001, -2.1000000000000014, -2.2000000000000015, -3.3000000000000007, -2.5000000000000018, -1.9000000000000012, -2.3000000000000016, -2.4000000000000017, -3.5999999999999996, -2.600000000000002, -1.5000000000000009], "episode_lengths": [32, 26, 33, 30, 30, 25, 40, 29, 41, 36, 31, 33, 36, 31, 28, 33, 51, 30, 35, 39, 30, 27, 29, 30, 29, 40, 30, 30, 46, 29, 30, 35, 29, 35, 44, 30, 32, 30, 34, 50, 35, 32, 33, 36, 49, 32, 29, 32, 31, 57, 33, 31, 39, 38, 29, 36, 39, 41, 30, 46, 29, 29, 28, 30, 63, 43, 55, 38, 40, 27, 28, 38, 36, 26, 52, 32, 32, 27, 31, 77, 59, 30, 36, 34, 33, 28, 42, 29, 29, 29, 50, 39, 29, 32, 42, 36, 34, 32, 34, 28, 39, 49, 29, 28, 32, 33, 44, 36, 30, 34, 35, 41, 37, 26]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2510844202313364, "mean_inference_ms": 0.6175452610977152, "mean_action_processing_ms": 0.06788650515385233, "mean_env_wait_ms": 6.347743729992649, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005470242416649534, "StateBufferConnector_ms": 0.003344761697869552, "ViewRequirementAgentConnector_ms": 0.07463400824028149}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 144000, "num_agent_steps_trained": 144000, "num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 338.1190492231675, "num_env_steps_trained_throughput_per_sec": 338.1190492231675, "timesteps_total": 144000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 144000, "timers": {"training_iteration_time_ms": 11408.307, "sample_time_ms": 7935.946, "load_time_ms": 0.979, "load_throughput": 4083836.23, "learn_time_ms": 3469.001, "learn_throughput": 1153.07, "synch_weights_time_ms": 1.745}, "counters": {"num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_agent_steps_sampled": 144000, "num_agent_steps_trained": 144000}, "done": false, "episodes_total": 1628, "training_iteration": 36, "trial_id": "dbefe_00000", "date": "2024-03-07_12-19-01", "timestamp": 1709831941, "time_this_iter_s": 11.832572937011719, "time_total_s": 393.033314704895, "pid": 103980, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fcd19c36f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 393.033314704895, "iterations_since_restore": 36, "perf": {"cpu_util_percent": 20.54, "ram_util_percent": 44.28666666666666, "gpu_util_percent0": 0.07333333333333333, "vram_util_percent0": 0.1005859375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.10000000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 0.9365242974918401, "policy_loss": -0.007078466746675712, "vf_loss": 0.9426733926839886, "vf_explained_var": 0.6345687220814408, "kl": 0.009293597144812756, "entropy": 0.4924497276865026, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 33945.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 148000, "num_env_steps_trained": 148000, "num_agent_steps_sampled": 148000, "num_agent_steps_trained": 148000}, "sampler_results": {"episode_reward_max": -1.4000000000000008, "episode_reward_min": -28.50000000000009, "episode_reward_mean": -2.822115384615387, "episode_len_mean": 37.39423076923077, "episode_media": {}, "episodes_this_iter": 104, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1.8000000000000012, -1.700000000000001, -1.700000000000001, -2.600000000000002, -2.0000000000000013, -2.0000000000000013, -1.700000000000001, -2.2000000000000015, -2.0000000000000013, -1.9000000000000012, -2.1000000000000014, -2.600000000000002, -2.1000000000000014, -3.4000000000000004, -1.600000000000001, -2.3000000000000016, -2.5000000000000018, -2.4000000000000017, -2.800000000000002, -1.9000000000000012, -1.5000000000000009, -2.700000000000002, -2.0000000000000013, -3.5, -2.0000000000000013, -2.0000000000000013, -2.2000000000000015, -1.700000000000001, -2.2000000000000015, -1.5000000000000009, -2.1000000000000014, -1.9000000000000012, -2.1000000000000014, -2.1000000000000014, -19.70000000000003, -1.8000000000000012, -3.6999999999999993, -2.0000000000000013, -4.300000000000002, -1.700000000000001, -4.499999999999998, -2.900000000000002, -1.8000000000000012, -2.2000000000000015, -1.9000000000000012, -1.8000000000000012, -1.700000000000001, -3.5, -1.700000000000001, -2.1000000000000014, -2.1000000000000014, -2.1000000000000014, -2.2000000000000015, -2.900000000000002, -3.1000000000000014, -1.8000000000000012, -1.9000000000000012, -1.600000000000001, -4.300000000000001, -1.8000000000000012, -1.600000000000001, -2.2000000000000015, -3.0000000000000018, -1.4000000000000008, -2.4000000000000017, -1.700000000000001, -2.0000000000000013, -1.700000000000001, -1.8000000000000012, -2.700000000000002, -2.1000000000000014, -2.2000000000000015, -1.9000000000000012, -2.3000000000000016, -1.600000000000001, -2.2000000000000015, -2.600000000000002, -2.3000000000000016, -1.8000000000000012, -2.5000000000000018, -3.3000000000000007, -2.700000000000002, -1.700000000000001, -3.4000000000000004, -2.4000000000000017, -1.700000000000001, -3.1000000000000014, -2.3000000000000016, -1.9000000000000012, -2.0000000000000013, -2.2000000000000015, -28.50000000000009, -1.9000000000000012, -1.9000000000000012, -2.4000000000000017, -1.8000000000000012, -1.9000000000000012, -2.2000000000000015, -2.0000000000000013, -1.8000000000000012, -2.0000000000000013, -15.699999999999982, -3.200000000000001, -5.5999999999999925], "episode_lengths": [29, 28, 28, 37, 31, 31, 28, 33, 31, 30, 32, 37, 32, 45, 27, 34, 36, 35, 39, 30, 26, 38, 31, 36, 31, 31, 33, 28, 33, 26, 32, 30, 32, 32, 168, 29, 48, 31, 45, 28, 40, 40, 29, 33, 30, 29, 28, 42, 28, 32, 32, 32, 33, 40, 42, 29, 30, 27, 46, 29, 27, 33, 36, 25, 35, 28, 31, 28, 29, 38, 32, 33, 30, 34, 27, 33, 37, 34, 29, 33, 40, 38, 28, 45, 35, 28, 42, 34, 30, 31, 33, 233, 30, 30, 35, 29, 30, 33, 31, 29, 31, 146, 41, 63]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2532543068828399, "mean_inference_ms": 0.6179653534278557, "mean_action_processing_ms": 0.06782547221935088, "mean_env_wait_ms": 6.369491017751288, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005677342414855957, "StateBufferConnector_ms": 0.0034421682357788086, "ViewRequirementAgentConnector_ms": 0.07554544852330135}}, "episode_reward_max": -1.4000000000000008, "episode_reward_min": -28.50000000000009, "episode_reward_mean": -2.822115384615387, "episode_len_mean": 37.39423076923077, "episodes_this_iter": 104, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1.8000000000000012, -1.700000000000001, -1.700000000000001, -2.600000000000002, -2.0000000000000013, -2.0000000000000013, -1.700000000000001, -2.2000000000000015, -2.0000000000000013, -1.9000000000000012, -2.1000000000000014, -2.600000000000002, -2.1000000000000014, -3.4000000000000004, -1.600000000000001, -2.3000000000000016, -2.5000000000000018, -2.4000000000000017, -2.800000000000002, -1.9000000000000012, -1.5000000000000009, -2.700000000000002, -2.0000000000000013, -3.5, -2.0000000000000013, -2.0000000000000013, -2.2000000000000015, -1.700000000000001, -2.2000000000000015, -1.5000000000000009, -2.1000000000000014, -1.9000000000000012, -2.1000000000000014, -2.1000000000000014, -19.70000000000003, -1.8000000000000012, -3.6999999999999993, -2.0000000000000013, -4.300000000000002, -1.700000000000001, -4.499999999999998, -2.900000000000002, -1.8000000000000012, -2.2000000000000015, -1.9000000000000012, -1.8000000000000012, -1.700000000000001, -3.5, -1.700000000000001, -2.1000000000000014, -2.1000000000000014, -2.1000000000000014, -2.2000000000000015, -2.900000000000002, -3.1000000000000014, -1.8000000000000012, -1.9000000000000012, -1.600000000000001, -4.300000000000001, -1.8000000000000012, -1.600000000000001, -2.2000000000000015, -3.0000000000000018, -1.4000000000000008, -2.4000000000000017, -1.700000000000001, -2.0000000000000013, -1.700000000000001, -1.8000000000000012, -2.700000000000002, -2.1000000000000014, -2.2000000000000015, -1.9000000000000012, -2.3000000000000016, -1.600000000000001, -2.2000000000000015, -2.600000000000002, -2.3000000000000016, -1.8000000000000012, -2.5000000000000018, -3.3000000000000007, -2.700000000000002, -1.700000000000001, -3.4000000000000004, -2.4000000000000017, -1.700000000000001, -3.1000000000000014, -2.3000000000000016, -1.9000000000000012, -2.0000000000000013, -2.2000000000000015, -28.50000000000009, -1.9000000000000012, -1.9000000000000012, -2.4000000000000017, -1.8000000000000012, -1.9000000000000012, -2.2000000000000015, -2.0000000000000013, -1.8000000000000012, -2.0000000000000013, -15.699999999999982, -3.200000000000001, -5.5999999999999925], "episode_lengths": [29, 28, 28, 37, 31, 31, 28, 33, 31, 30, 32, 37, 32, 45, 27, 34, 36, 35, 39, 30, 26, 38, 31, 36, 31, 31, 33, 28, 33, 26, 32, 30, 32, 32, 168, 29, 48, 31, 45, 28, 40, 40, 29, 33, 30, 29, 28, 42, 28, 32, 32, 32, 33, 40, 42, 29, 30, 27, 46, 29, 27, 33, 36, 25, 35, 28, 31, 28, 29, 38, 32, 33, 30, 34, 27, 33, 37, 34, 29, 33, 40, 38, 28, 45, 35, 28, 42, 34, 30, 31, 33, 233, 30, 30, 35, 29, 30, 33, 31, 29, 31, 146, 41, 63]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2532543068828399, "mean_inference_ms": 0.6179653534278557, "mean_action_processing_ms": 0.06782547221935088, "mean_env_wait_ms": 6.369491017751288, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005677342414855957, "StateBufferConnector_ms": 0.0034421682357788086, "ViewRequirementAgentConnector_ms": 0.07554544852330135}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 148000, "num_agent_steps_trained": 148000, "num_env_steps_sampled": 148000, "num_env_steps_trained": 148000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 337.86289737598474, "num_env_steps_trained_throughput_per_sec": 337.86289737598474, "timesteps_total": 148000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 148000, "timers": {"training_iteration_time_ms": 11493.787, "sample_time_ms": 8021.62, "load_time_ms": 1.005, "load_throughput": 3978471.899, "learn_time_ms": 3468.776, "learn_throughput": 1153.144, "synch_weights_time_ms": 1.758}, "counters": {"num_env_steps_sampled": 148000, "num_env_steps_trained": 148000, "num_agent_steps_sampled": 148000, "num_agent_steps_trained": 148000}, "done": false, "episodes_total": 1732, "training_iteration": 37, "trial_id": "dbefe_00000", "date": "2024-03-07_12-19-13", "timestamp": 1709831953, "time_this_iter_s": 11.841672420501709, "time_total_s": 404.87498712539673, "pid": 103980, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fcd19c36f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 404.87498712539673, "iterations_since_restore": 37, "perf": {"cpu_util_percent": 21.04666666666667, "ram_util_percent": 43.826666666666675, "gpu_util_percent0": 0.072, "vram_util_percent0": 0.1005859375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.10000000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 1.5595849257296763, "policy_loss": -0.0021639102489076634, "vf_loss": 1.560901776673172, "vf_explained_var": 0.4718745089346363, "kl": 0.008470667807179703, "entropy": 0.4867083745938475, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 34875.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 152000, "num_env_steps_trained": 152000, "num_agent_steps_sampled": 152000, "num_agent_steps_trained": 152000}, "sampler_results": {"episode_reward_max": -1.4000000000000008, "episode_reward_min": -50.10000000000019, "episode_reward_mean": -3.553000000000005, "episode_len_mean": 42.11, "episode_media": {}, "episodes_this_iter": 98, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.200000000000001, -5.5999999999999925, -24.600000000000108, -1.600000000000001, -3.0000000000000018, -2.0000000000000013, -1.9000000000000012, -2.600000000000002, -2.0000000000000013, -2.0000000000000013, -1.9000000000000012, -1.9000000000000012, -1.700000000000001, -1.600000000000001, -1.9000000000000012, -1.9000000000000012, -3.8999999999999986, -1.600000000000001, -1.8000000000000012, -1.700000000000001, -2.0000000000000013, -2.2000000000000015, -1.9000000000000012, -9.199999999999982, -2.1000000000000014, -2.600000000000002, -1.8000000000000012, -23.700000000000067, -4.6999999999999975, -2.0000000000000013, -1.4000000000000008, -2.0000000000000013, -2.1000000000000014, -1.8000000000000012, -2.2000000000000015, -2.1000000000000014, -2.600000000000002, -1.5000000000000009, -1.600000000000001, -28.100000000000072, -1.5000000000000009, -2.2000000000000015, -1.5000000000000009, -2.3000000000000016, -1.700000000000001, -4.599999999999998, -1.600000000000001, -6.899999999999994, -1.5000000000000009, -50.10000000000019, -2.0000000000000013, -1.9000000000000012, -2.2000000000000015, -1.700000000000001, -2.1000000000000014, -2.2000000000000015, -4.399999999999998, -1.5000000000000009, -2.800000000000002, -2.1000000000000014, -2.800000000000002, -2.3000000000000016, -4.399999999999997, -3.9999999999999982, -2.600000000000002, -1.700000000000001, -2.1000000000000014, -1.600000000000001, -1.5000000000000009, -2.3000000000000016, -1.600000000000001, -2.5000000000000018, -1.9000000000000012, -4.199999999999999, -2.0000000000000013, -2.700000000000002, -1.9000000000000012, -2.0000000000000013, -2.1000000000000014, -2.3000000000000016, -1.9000000000000012, -2.0000000000000013, -2.0000000000000013, -2.0000000000000013, -1.5000000000000009, -1.9000000000000012, -1.8000000000000012, -3.6000000000000023, -3.4000000000000004, -2.1000000000000014, -2.1000000000000014, -1.8000000000000012, -1.4000000000000008, -1.8000000000000012, -2.800000000000002, -1.600000000000001, -1.5000000000000009, -4.399999999999997, -2.5000000000000018, -1.9000000000000012], "episode_lengths": [41, 63, 213, 27, 41, 31, 30, 37, 31, 31, 30, 30, 28, 27, 30, 30, 50, 27, 29, 28, 31, 33, 30, 101, 32, 37, 29, 196, 51, 31, 25, 31, 32, 29, 33, 32, 37, 26, 27, 237, 26, 33, 26, 34, 28, 52, 27, 72, 26, 273, 31, 30, 33, 28, 32, 33, 52, 26, 39, 32, 39, 34, 51, 51, 37, 28, 32, 27, 26, 34, 27, 36, 30, 48, 31, 38, 30, 31, 32, 34, 30, 31, 31, 31, 26, 30, 29, 39, 45, 32, 32, 29, 25, 29, 35, 27, 26, 55, 36, 30]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.25669411380512175, "mean_inference_ms": 0.6183818030450109, "mean_action_processing_ms": 0.06804314867397751, "mean_env_wait_ms": 6.38808417285655, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0055201053619384766, "StateBufferConnector_ms": 0.0033941268920898438, "ViewRequirementAgentConnector_ms": 0.0741872787475586}}, "episode_reward_max": -1.4000000000000008, "episode_reward_min": -50.10000000000019, "episode_reward_mean": -3.553000000000005, "episode_len_mean": 42.11, "episodes_this_iter": 98, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3.200000000000001, -5.5999999999999925, -24.600000000000108, -1.600000000000001, -3.0000000000000018, -2.0000000000000013, -1.9000000000000012, -2.600000000000002, -2.0000000000000013, -2.0000000000000013, -1.9000000000000012, -1.9000000000000012, -1.700000000000001, -1.600000000000001, -1.9000000000000012, -1.9000000000000012, -3.8999999999999986, -1.600000000000001, -1.8000000000000012, -1.700000000000001, -2.0000000000000013, -2.2000000000000015, -1.9000000000000012, -9.199999999999982, -2.1000000000000014, -2.600000000000002, -1.8000000000000012, -23.700000000000067, -4.6999999999999975, -2.0000000000000013, -1.4000000000000008, -2.0000000000000013, -2.1000000000000014, -1.8000000000000012, -2.2000000000000015, -2.1000000000000014, -2.600000000000002, -1.5000000000000009, -1.600000000000001, -28.100000000000072, -1.5000000000000009, -2.2000000000000015, -1.5000000000000009, -2.3000000000000016, -1.700000000000001, -4.599999999999998, -1.600000000000001, -6.899999999999994, -1.5000000000000009, -50.10000000000019, -2.0000000000000013, -1.9000000000000012, -2.2000000000000015, -1.700000000000001, -2.1000000000000014, -2.2000000000000015, -4.399999999999998, -1.5000000000000009, -2.800000000000002, -2.1000000000000014, -2.800000000000002, -2.3000000000000016, -4.399999999999997, -3.9999999999999982, -2.600000000000002, -1.700000000000001, -2.1000000000000014, -1.600000000000001, -1.5000000000000009, -2.3000000000000016, -1.600000000000001, -2.5000000000000018, -1.9000000000000012, -4.199999999999999, -2.0000000000000013, -2.700000000000002, -1.9000000000000012, -2.0000000000000013, -2.1000000000000014, -2.3000000000000016, -1.9000000000000012, -2.0000000000000013, -2.0000000000000013, -2.0000000000000013, -1.5000000000000009, -1.9000000000000012, -1.8000000000000012, -3.6000000000000023, -3.4000000000000004, -2.1000000000000014, -2.1000000000000014, -1.8000000000000012, -1.4000000000000008, -1.8000000000000012, -2.800000000000002, -1.600000000000001, -1.5000000000000009, -4.399999999999997, -2.5000000000000018, -1.9000000000000012], "episode_lengths": [41, 63, 213, 27, 41, 31, 30, 37, 31, 31, 30, 30, 28, 27, 30, 30, 50, 27, 29, 28, 31, 33, 30, 101, 32, 37, 29, 196, 51, 31, 25, 31, 32, 29, 33, 32, 37, 26, 27, 237, 26, 33, 26, 34, 28, 52, 27, 72, 26, 273, 31, 30, 33, 28, 32, 33, 52, 26, 39, 32, 39, 34, 51, 51, 37, 28, 32, 27, 26, 34, 27, 36, 30, 48, 31, 38, 30, 31, 32, 34, 30, 31, 31, 31, 26, 30, 29, 39, 45, 32, 32, 29, 25, 29, 35, 27, 26, 55, 36, 30]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.25669411380512175, "mean_inference_ms": 0.6183818030450109, "mean_action_processing_ms": 0.06804314867397751, "mean_env_wait_ms": 6.38808417285655, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0055201053619384766, "StateBufferConnector_ms": 0.0033941268920898438, "ViewRequirementAgentConnector_ms": 0.0741872787475586}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 152000, "num_agent_steps_trained": 152000, "num_env_steps_sampled": 152000, "num_env_steps_trained": 152000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 341.240039395154, "num_env_steps_trained_throughput_per_sec": 341.240039395154, "timesteps_total": 152000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 152000, "timers": {"training_iteration_time_ms": 11543.969, "sample_time_ms": 8077.185, "load_time_ms": 1.007, "load_throughput": 3970656.758, "learn_time_ms": 3463.39, "learn_throughput": 1154.938, "synch_weights_time_ms": 1.758}, "counters": {"num_env_steps_sampled": 152000, "num_env_steps_trained": 152000, "num_agent_steps_sampled": 152000, "num_agent_steps_trained": 152000}, "done": false, "episodes_total": 1830, "training_iteration": 38, "trial_id": "dbefe_00000", "date": "2024-03-07_12-19-25", "timestamp": 1709831965, "time_this_iter_s": 11.724302530288696, "time_total_s": 416.5992896556854, "pid": 103980, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fcd19c36f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 416.5992896556854, "iterations_since_restore": 38, "perf": {"cpu_util_percent": 19.4625, "ram_util_percent": 43.54375, "gpu_util_percent0": 0.08374999999999999, "vram_util_percent0": 0.1005859375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.10000000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 1.1726526173361156, "policy_loss": -0.0034577617361660927, "vf_loss": 1.1751130888418806, "vf_explained_var": 0.5515452914340522, "kl": 0.009972906248396602, "entropy": 0.4484114246983682, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 35805.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 156000, "num_env_steps_trained": 156000, "num_agent_steps_sampled": 156000, "num_agent_steps_trained": 156000}, "sampler_results": {"episode_reward_max": -1.4000000000000008, "episode_reward_min": -44.10000000000017, "episode_reward_mean": -2.8146788990825726, "episode_len_mean": 36.45871559633027, "episode_media": {}, "episodes_this_iter": 109, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2.2000000000000015, -1.700000000000001, -2.700000000000002, -3.4000000000000004, -2.800000000000002, -1.600000000000001, -1.8000000000000012, -3.200000000000001, -2.1000000000000014, -1.600000000000001, -1.5000000000000009, -44.10000000000017, -3.1000000000000014, -2.4000000000000017, -22.500000000000043, -1.8000000000000012, -2.0000000000000013, -1.5000000000000009, -2.700000000000002, -2.700000000000002, -2.1000000000000014, -1.8000000000000012, -1.600000000000001, -1.600000000000001, -1.9000000000000012, -2.1000000000000014, -1.9000000000000012, -1.700000000000001, -2.1000000000000014, -1.5000000000000009, -3.700000000000001, -1.8000000000000012, -1.8000000000000012, -2.0000000000000013, -1.700000000000001, -2.4000000000000017, -2.0000000000000013, -2.2000000000000015, -1.600000000000001, -2.2000000000000015, -1.5000000000000009, -3.6999999999999993, -2.2000000000000015, -1.9000000000000012, -5.700000000000002, -2.2000000000000015, -2.0000000000000013, -2.2000000000000015, -3.1000000000000014, -1.8000000000000012, -1.700000000000001, -2.4000000000000017, -1.8000000000000012, -5.100000000000004, -1.700000000000001, -1.9000000000000012, -1.600000000000001, -2.4000000000000017, -1.9000000000000012, -2.0000000000000013, -1.700000000000001, -4.699999999999996, -1.5000000000000009, -1.8000000000000012, -2.5000000000000018, -1.9000000000000012, -2.600000000000002, -1.5000000000000009, -1.700000000000001, -4.199999999999998, -1.700000000000001, -2.3000000000000016, -1.700000000000001, -1.5000000000000009, -2.2000000000000015, -2.4000000000000017, -1.700000000000001, -1.700000000000001, -2.2000000000000015, -1.700000000000001, -1.5000000000000009, -2.3000000000000016, -1.700000000000001, -2.600000000000002, -2.0000000000000013, -2.1000000000000014, -2.1000000000000014, -2.700000000000002, -2.3000000000000016, -2.700000000000002, -1.9000000000000012, -1.8000000000000012, -1.9000000000000012, -4.299999999999998, -1.4000000000000008, -2.0000000000000013, -1.700000000000001, -1.600000000000001, -2.1000000000000014, -8.799999999999995, -1.9000000000000012, -1.700000000000001, -2.1000000000000014, -2.900000000000002, -1.5000000000000009, -2.1000000000000014, -2.1000000000000014, -2.1000000000000014, -1.8000000000000012], "episode_lengths": [33, 28, 38, 45, 39, 27, 29, 43, 32, 27, 26, 317, 42, 35, 167, 29, 31, 26, 38, 38, 32, 29, 27, 27, 30, 32, 30, 28, 32, 26, 43, 29, 29, 31, 28, 35, 31, 33, 27, 33, 26, 48, 33, 30, 56, 33, 31, 33, 42, 29, 28, 35, 29, 47, 28, 30, 27, 35, 30, 31, 28, 52, 26, 29, 36, 30, 37, 26, 28, 45, 28, 34, 28, 26, 33, 35, 28, 28, 33, 28, 26, 34, 28, 36, 31, 32, 32, 38, 34, 35, 30, 29, 30, 48, 25, 31, 28, 27, 32, 73, 30, 28, 32, 33, 26, 32, 32, 32, 29]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.25835051743703524, "mean_inference_ms": 0.6186653374288288, "mean_action_processing_ms": 0.06782160696921216, "mean_env_wait_ms": 6.415316458179398, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00541560146786751, "StateBufferConnector_ms": 0.00329039512424294, "ViewRequirementAgentConnector_ms": 0.07391610276808433}}, "episode_reward_max": -1.4000000000000008, "episode_reward_min": -44.10000000000017, "episode_reward_mean": -2.8146788990825726, "episode_len_mean": 36.45871559633027, "episodes_this_iter": 109, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-2.2000000000000015, -1.700000000000001, -2.700000000000002, -3.4000000000000004, -2.800000000000002, -1.600000000000001, -1.8000000000000012, -3.200000000000001, -2.1000000000000014, -1.600000000000001, -1.5000000000000009, -44.10000000000017, -3.1000000000000014, -2.4000000000000017, -22.500000000000043, -1.8000000000000012, -2.0000000000000013, -1.5000000000000009, -2.700000000000002, -2.700000000000002, -2.1000000000000014, -1.8000000000000012, -1.600000000000001, -1.600000000000001, -1.9000000000000012, -2.1000000000000014, -1.9000000000000012, -1.700000000000001, -2.1000000000000014, -1.5000000000000009, -3.700000000000001, -1.8000000000000012, -1.8000000000000012, -2.0000000000000013, -1.700000000000001, -2.4000000000000017, -2.0000000000000013, -2.2000000000000015, -1.600000000000001, -2.2000000000000015, -1.5000000000000009, -3.6999999999999993, -2.2000000000000015, -1.9000000000000012, -5.700000000000002, -2.2000000000000015, -2.0000000000000013, -2.2000000000000015, -3.1000000000000014, -1.8000000000000012, -1.700000000000001, -2.4000000000000017, -1.8000000000000012, -5.100000000000004, -1.700000000000001, -1.9000000000000012, -1.600000000000001, -2.4000000000000017, -1.9000000000000012, -2.0000000000000013, -1.700000000000001, -4.699999999999996, -1.5000000000000009, -1.8000000000000012, -2.5000000000000018, -1.9000000000000012, -2.600000000000002, -1.5000000000000009, -1.700000000000001, -4.199999999999998, -1.700000000000001, -2.3000000000000016, -1.700000000000001, -1.5000000000000009, -2.2000000000000015, -2.4000000000000017, -1.700000000000001, -1.700000000000001, -2.2000000000000015, -1.700000000000001, -1.5000000000000009, -2.3000000000000016, -1.700000000000001, -2.600000000000002, -2.0000000000000013, -2.1000000000000014, -2.1000000000000014, -2.700000000000002, -2.3000000000000016, -2.700000000000002, -1.9000000000000012, -1.8000000000000012, -1.9000000000000012, -4.299999999999998, -1.4000000000000008, -2.0000000000000013, -1.700000000000001, -1.600000000000001, -2.1000000000000014, -8.799999999999995, -1.9000000000000012, -1.700000000000001, -2.1000000000000014, -2.900000000000002, -1.5000000000000009, -2.1000000000000014, -2.1000000000000014, -2.1000000000000014, -1.8000000000000012], "episode_lengths": [33, 28, 38, 45, 39, 27, 29, 43, 32, 27, 26, 317, 42, 35, 167, 29, 31, 26, 38, 38, 32, 29, 27, 27, 30, 32, 30, 28, 32, 26, 43, 29, 29, 31, 28, 35, 31, 33, 27, 33, 26, 48, 33, 30, 56, 33, 31, 33, 42, 29, 28, 35, 29, 47, 28, 30, 27, 35, 30, 31, 28, 52, 26, 29, 36, 30, 37, 26, 28, 45, 28, 34, 28, 26, 33, 35, 28, 28, 33, 28, 26, 34, 28, 36, 31, 32, 32, 38, 34, 35, 30, 29, 30, 48, 25, 31, 28, 27, 32, 73, 30, 28, 32, 33, 26, 32, 32, 32, 29]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.25835051743703524, "mean_inference_ms": 0.6186653374288288, "mean_action_processing_ms": 0.06782160696921216, "mean_env_wait_ms": 6.415316458179398, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00541560146786751, "StateBufferConnector_ms": 0.00329039512424294, "ViewRequirementAgentConnector_ms": 0.07391610276808433}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 156000, "num_agent_steps_trained": 156000, "num_env_steps_sampled": 156000, "num_env_steps_trained": 156000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 334.5045927545248, "num_env_steps_trained_throughput_per_sec": 334.5045927545248, "timesteps_total": 156000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 156000, "timers": {"training_iteration_time_ms": 11613.329, "sample_time_ms": 8146.519, "load_time_ms": 1.005, "load_throughput": 3978660.596, "learn_time_ms": 3463.428, "learn_throughput": 1154.925, "synch_weights_time_ms": 1.747}, "counters": {"num_env_steps_sampled": 156000, "num_env_steps_trained": 156000, "num_agent_steps_sampled": 156000, "num_agent_steps_trained": 156000}, "done": false, "episodes_total": 1939, "training_iteration": 39, "trial_id": "dbefe_00000", "date": "2024-03-07_12-19-37", "timestamp": 1709831977, "time_this_iter_s": 11.960603713989258, "time_total_s": 428.5598933696747, "pid": 103980, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fcd19c36f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 428.5598933696747, "iterations_since_restore": 39, "perf": {"cpu_util_percent": 20.58, "ram_util_percent": 43.5, "gpu_util_percent0": 0.06866666666666667, "vram_util_percent0": 0.1005859375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.10000000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 0.42796116513807214, "policy_loss": -0.00457044134857834, "vf_loss": 0.43148996266586487, "vf_explained_var": 0.7678065208978551, "kl": 0.010416446485338873, "entropy": 0.4103938730333441, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 36735.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 160000, "num_env_steps_trained": 160000, "num_agent_steps_sampled": 160000, "num_agent_steps_trained": 160000}, "sampler_results": {"episode_reward_max": -1.4000000000000008, "episode_reward_min": -9.999999999999993, "episode_reward_mean": -2.440517241379311, "episode_len_mean": 34.39655172413793, "episode_media": {}, "episodes_this_iter": 116, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4.599999999999999, -2.4000000000000017, -2.2000000000000015, -2.4000000000000017, -3.500000000000001, -2.0000000000000013, -3.1000000000000014, -2.800000000000002, -2.0000000000000013, -1.600000000000001, -1.700000000000001, -1.700000000000001, -1.700000000000001, -1.600000000000001, -1.9000000000000012, -1.700000000000001, -1.700000000000001, -1.700000000000001, -2.0000000000000013, -3.799999999999999, -1.600000000000001, -2.0000000000000013, -4.499999999999998, -2.900000000000002, -2.2000000000000015, -1.9000000000000012, -1.9000000000000012, -2.2000000000000015, -1.8000000000000012, -2.0000000000000013, -1.4000000000000008, -6.099999999999991, -1.600000000000001, -1.4000000000000008, -3.6999999999999993, -1.700000000000001, -2.0000000000000013, -2.4000000000000017, -1.700000000000001, -2.2000000000000015, -1.700000000000001, -1.9000000000000012, -3.0000000000000018, -1.8000000000000012, -2.5000000000000018, -1.9000000000000012, -2.700000000000002, -3.5, -2.1000000000000014, -3.200000000000001, -2.0000000000000013, -2.3000000000000016, -4.0, -2.900000000000002, -1.700000000000001, -1.600000000000001, -2.700000000000002, -1.5000000000000009, -2.0000000000000013, -2.4000000000000017, -1.700000000000001, -4.099999999999999, -1.5000000000000009, -1.8000000000000012, -2.700000000000002, -8.199999999999983, -4.799999999999995, -1.700000000000001, -1.700000000000001, -1.600000000000001, -3.9000000000000004, -3.5, -1.4000000000000008, -2.3000000000000016, -1.9000000000000012, -2.700000000000002, -2.3000000000000016, -2.1000000000000014, -2.600000000000002, -2.900000000000002, -1.9000000000000012, -2.5000000000000018, -2.0000000000000013, -2.4000000000000017, -2.2000000000000015, -1.9000000000000012, -1.8000000000000012, -2.900000000000002, -1.9000000000000012, -2.2000000000000015, -1.9000000000000012, -9.999999999999993, -2.0000000000000013, -3.5999999999999996, -2.1000000000000014, -1.8000000000000012, -1.9000000000000012, -1.9000000000000012, -1.8000000000000012, -3.6000000000000005, -1.9000000000000012, -1.4000000000000008, -1.9000000000000012, -1.8000000000000012, -2.3000000000000016, -2.4000000000000017, -1.700000000000001, -1.9000000000000012, -2.0000000000000013, -1.8000000000000012, -3.5, -3.8999999999999986, -2.5000000000000018, -1.700000000000001, -2.1000000000000014, -1.9000000000000012], "episode_lengths": [48, 35, 33, 35, 41, 31, 40, 38, 31, 27, 28, 28, 28, 27, 30, 28, 28, 28, 31, 46, 27, 31, 48, 39, 33, 30, 30, 33, 29, 31, 25, 72, 27, 25, 42, 28, 31, 35, 28, 33, 28, 30, 41, 29, 36, 30, 38, 42, 32, 39, 31, 34, 48, 38, 28, 27, 38, 26, 31, 35, 28, 48, 26, 29, 38, 88, 59, 28, 28, 27, 42, 46, 25, 34, 30, 38, 34, 32, 37, 40, 30, 36, 31, 35, 33, 30, 29, 40, 30, 33, 30, 73, 31, 47, 32, 29, 30, 30, 29, 41, 30, 25, 30, 29, 34, 35, 28, 30, 31, 29, 44, 44, 36, 28, 32, 30]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.26120898731677494, "mean_inference_ms": 0.6190375000726731, "mean_action_processing_ms": 0.06795775463273188, "mean_env_wait_ms": 6.427225131084955, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005779389677376583, "StateBufferConnector_ms": 0.003386982556047111, "ViewRequirementAgentConnector_ms": 0.07583026228279903}}, "episode_reward_max": -1.4000000000000008, "episode_reward_min": -9.999999999999993, "episode_reward_mean": -2.440517241379311, "episode_len_mean": 34.39655172413793, "episodes_this_iter": 116, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-4.599999999999999, -2.4000000000000017, -2.2000000000000015, -2.4000000000000017, -3.500000000000001, -2.0000000000000013, -3.1000000000000014, -2.800000000000002, -2.0000000000000013, -1.600000000000001, -1.700000000000001, -1.700000000000001, -1.700000000000001, -1.600000000000001, -1.9000000000000012, -1.700000000000001, -1.700000000000001, -1.700000000000001, -2.0000000000000013, -3.799999999999999, -1.600000000000001, -2.0000000000000013, -4.499999999999998, -2.900000000000002, -2.2000000000000015, -1.9000000000000012, -1.9000000000000012, -2.2000000000000015, -1.8000000000000012, -2.0000000000000013, -1.4000000000000008, -6.099999999999991, -1.600000000000001, -1.4000000000000008, -3.6999999999999993, -1.700000000000001, -2.0000000000000013, -2.4000000000000017, -1.700000000000001, -2.2000000000000015, -1.700000000000001, -1.9000000000000012, -3.0000000000000018, -1.8000000000000012, -2.5000000000000018, -1.9000000000000012, -2.700000000000002, -3.5, -2.1000000000000014, -3.200000000000001, -2.0000000000000013, -2.3000000000000016, -4.0, -2.900000000000002, -1.700000000000001, -1.600000000000001, -2.700000000000002, -1.5000000000000009, -2.0000000000000013, -2.4000000000000017, -1.700000000000001, -4.099999999999999, -1.5000000000000009, -1.8000000000000012, -2.700000000000002, -8.199999999999983, -4.799999999999995, -1.700000000000001, -1.700000000000001, -1.600000000000001, -3.9000000000000004, -3.5, -1.4000000000000008, -2.3000000000000016, -1.9000000000000012, -2.700000000000002, -2.3000000000000016, -2.1000000000000014, -2.600000000000002, -2.900000000000002, -1.9000000000000012, -2.5000000000000018, -2.0000000000000013, -2.4000000000000017, -2.2000000000000015, -1.9000000000000012, -1.8000000000000012, -2.900000000000002, -1.9000000000000012, -2.2000000000000015, -1.9000000000000012, -9.999999999999993, -2.0000000000000013, -3.5999999999999996, -2.1000000000000014, -1.8000000000000012, -1.9000000000000012, -1.9000000000000012, -1.8000000000000012, -3.6000000000000005, -1.9000000000000012, -1.4000000000000008, -1.9000000000000012, -1.8000000000000012, -2.3000000000000016, -2.4000000000000017, -1.700000000000001, -1.9000000000000012, -2.0000000000000013, -1.8000000000000012, -3.5, -3.8999999999999986, -2.5000000000000018, -1.700000000000001, -2.1000000000000014, -1.9000000000000012], "episode_lengths": [48, 35, 33, 35, 41, 31, 40, 38, 31, 27, 28, 28, 28, 27, 30, 28, 28, 28, 31, 46, 27, 31, 48, 39, 33, 30, 30, 33, 29, 31, 25, 72, 27, 25, 42, 28, 31, 35, 28, 33, 28, 30, 41, 29, 36, 30, 38, 42, 32, 39, 31, 34, 48, 38, 28, 27, 38, 26, 31, 35, 28, 48, 26, 29, 38, 88, 59, 28, 28, 27, 42, 46, 25, 34, 30, 38, 34, 32, 37, 40, 30, 36, 31, 35, 33, 30, 29, 40, 30, 33, 30, 73, 31, 47, 32, 29, 30, 30, 29, 41, 30, 25, 30, 29, 34, 35, 28, 30, 31, 29, 44, 44, 36, 28, 32, 30]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.26120898731677494, "mean_inference_ms": 0.6190375000726731, "mean_action_processing_ms": 0.06795775463273188, "mean_env_wait_ms": 6.427225131084955, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005779389677376583, "StateBufferConnector_ms": 0.003386982556047111, "ViewRequirementAgentConnector_ms": 0.07583026228279903}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 160000, "num_agent_steps_trained": 160000, "num_env_steps_sampled": 160000, "num_env_steps_trained": 160000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 332.9587025585851, "num_env_steps_trained_throughput_per_sec": 332.9587025585851, "timesteps_total": 160000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 160000, "timers": {"training_iteration_time_ms": 11690.545, "sample_time_ms": 8203.669, "load_time_ms": 1.003, "load_throughput": 3987644.332, "learn_time_ms": 3483.492, "learn_throughput": 1148.273, "synch_weights_time_ms": 1.751}, "counters": {"num_env_steps_sampled": 160000, "num_env_steps_trained": 160000, "num_agent_steps_sampled": 160000, "num_agent_steps_trained": 160000}, "done": false, "episodes_total": 2055, "training_iteration": 40, "trial_id": "dbefe_00000", "date": "2024-03-07_12-19-49", "timestamp": 1709831989, "time_this_iter_s": 12.016058206558228, "time_total_s": 440.5759515762329, "pid": 103980, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fcd19c36f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 440.5759515762329, "iterations_since_restore": 40, "perf": {"cpu_util_percent": 20.668750000000003, "ram_util_percent": 43.543749999999996, "gpu_util_percent0": 0.086875, "vram_util_percent0": 0.1005859375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.10000000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 0.35224944825017557, "policy_loss": -0.011262247715425748, "vf_loss": 0.3626863370939929, "vf_explained_var": 0.7920614308567457, "kl": 0.008253585393831062, "entropy": 0.39805404274694384, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 37665.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 164000, "num_env_steps_trained": 164000, "num_agent_steps_sampled": 164000, "num_agent_steps_trained": 164000}, "sampler_results": {"episode_reward_max": -1.4000000000000008, "episode_reward_min": -10.099999999999984, "episode_reward_mean": -2.3550000000000013, "episode_len_mean": 33.55, "episode_media": {}, "episodes_this_iter": 120, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4.600000000000002, -3.0000000000000018, -1.600000000000001, -1.600000000000001, -2.2000000000000015, -2.0000000000000013, -10.099999999999984, -2.2000000000000015, -4.1999999999999975, -2.1000000000000014, -2.4000000000000017, -4.800000000000001, -1.9000000000000012, -4.399999999999999, -3.4000000000000012, -2.5000000000000018, -4.900000000000003, -3.6999999999999993, -1.9000000000000012, -3.3000000000000007, -1.5000000000000009, -3.200000000000002, -2.3000000000000016, -2.1000000000000014, -2.1000000000000014, -2.600000000000002, -2.2000000000000015, -2.3000000000000016, -2.0000000000000013, -2.3000000000000016, -3.0000000000000018, -1.9000000000000012, -2.700000000000002, -3.5, -2.2000000000000015, -1.700000000000001, -2.600000000000002, -2.2000000000000015, -1.9000000000000012, -2.1000000000000014, -1.5000000000000009, -2.1000000000000014, -3.0000000000000018, -1.5000000000000009, -1.8000000000000012, -1.8000000000000012, -2.4000000000000017, -1.700000000000001, -1.700000000000001, -1.9000000000000012, -1.8000000000000012, -6.000000000000004, -1.5000000000000009, -1.9000000000000012, -1.700000000000001, -2.1000000000000014, -1.600000000000001, -1.8000000000000012, -3.3000000000000007, -1.9000000000000012, -2.0000000000000013, -2.2000000000000015, -2.2000000000000015, -1.600000000000001, -1.4000000000000008, -1.600000000000001, -2.4000000000000017, -2.1000000000000014, -2.1000000000000014, -1.9000000000000012, -2.2000000000000015, -2.4000000000000017, -1.600000000000001, -2.0000000000000013, -1.5000000000000009, -1.9000000000000012, -2.0000000000000013, -3.0000000000000018, -2.900000000000002, -2.3000000000000016, -2.600000000000002, -1.600000000000001, -1.9000000000000012, -2.2000000000000015, -2.4000000000000017, -1.8000000000000012, -1.8000000000000012, -1.8000000000000012, -2.5000000000000018, -1.9000000000000012, -1.600000000000001, -1.700000000000001, -1.9000000000000012, -2.1000000000000014, -2.5000000000000018, -4.300000000000002, -1.8000000000000012, -1.9000000000000012, -1.9000000000000012, -2.3000000000000016, -1.700000000000001, -1.8000000000000012, -2.2000000000000015, -1.700000000000001, -1.9000000000000012, -5.199999999999994, -2.0000000000000013, -1.700000000000001, -1.9000000000000012, -2.3000000000000016, -1.8000000000000012, -1.700000000000001, -2.800000000000002, -2.0000000000000013, -1.9000000000000012, -1.600000000000001, -2.0000000000000013, -2.1000000000000014, -2.600000000000002, -1.700000000000001], "episode_lengths": [46, 41, 27, 27, 33, 31, 95, 33, 53, 32, 35, 53, 30, 43, 37, 36, 51, 48, 30, 44, 26, 37, 34, 32, 32, 37, 33, 34, 31, 34, 36, 30, 38, 43, 33, 28, 37, 33, 30, 32, 26, 32, 41, 26, 29, 29, 35, 28, 28, 30, 29, 52, 26, 30, 28, 32, 27, 29, 40, 30, 31, 33, 33, 27, 25, 27, 35, 32, 32, 30, 33, 35, 27, 31, 26, 30, 31, 39, 40, 34, 37, 27, 30, 33, 35, 29, 29, 29, 36, 30, 27, 28, 30, 32, 32, 45, 29, 30, 30, 34, 28, 29, 33, 28, 30, 63, 31, 28, 30, 34, 29, 28, 34, 31, 30, 27, 31, 32, 37, 28]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2639020432181738, "mean_inference_ms": 0.6194973440081825, "mean_action_processing_ms": 0.06793035765641585, "mean_env_wait_ms": 6.44905808062997, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0055664777755737305, "StateBufferConnector_ms": 0.0033402442932128906, "ViewRequirementAgentConnector_ms": 0.07468163967132568}}, "episode_reward_max": -1.4000000000000008, "episode_reward_min": -10.099999999999984, "episode_reward_mean": -2.3550000000000013, "episode_len_mean": 33.55, "episodes_this_iter": 120, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-4.600000000000002, -3.0000000000000018, -1.600000000000001, -1.600000000000001, -2.2000000000000015, -2.0000000000000013, -10.099999999999984, -2.2000000000000015, -4.1999999999999975, -2.1000000000000014, -2.4000000000000017, -4.800000000000001, -1.9000000000000012, -4.399999999999999, -3.4000000000000012, -2.5000000000000018, -4.900000000000003, -3.6999999999999993, -1.9000000000000012, -3.3000000000000007, -1.5000000000000009, -3.200000000000002, -2.3000000000000016, -2.1000000000000014, -2.1000000000000014, -2.600000000000002, -2.2000000000000015, -2.3000000000000016, -2.0000000000000013, -2.3000000000000016, -3.0000000000000018, -1.9000000000000012, -2.700000000000002, -3.5, -2.2000000000000015, -1.700000000000001, -2.600000000000002, -2.2000000000000015, -1.9000000000000012, -2.1000000000000014, -1.5000000000000009, -2.1000000000000014, -3.0000000000000018, -1.5000000000000009, -1.8000000000000012, -1.8000000000000012, -2.4000000000000017, -1.700000000000001, -1.700000000000001, -1.9000000000000012, -1.8000000000000012, -6.000000000000004, -1.5000000000000009, -1.9000000000000012, -1.700000000000001, -2.1000000000000014, -1.600000000000001, -1.8000000000000012, -3.3000000000000007, -1.9000000000000012, -2.0000000000000013, -2.2000000000000015, -2.2000000000000015, -1.600000000000001, -1.4000000000000008, -1.600000000000001, -2.4000000000000017, -2.1000000000000014, -2.1000000000000014, -1.9000000000000012, -2.2000000000000015, -2.4000000000000017, -1.600000000000001, -2.0000000000000013, -1.5000000000000009, -1.9000000000000012, -2.0000000000000013, -3.0000000000000018, -2.900000000000002, -2.3000000000000016, -2.600000000000002, -1.600000000000001, -1.9000000000000012, -2.2000000000000015, -2.4000000000000017, -1.8000000000000012, -1.8000000000000012, -1.8000000000000012, -2.5000000000000018, -1.9000000000000012, -1.600000000000001, -1.700000000000001, -1.9000000000000012, -2.1000000000000014, -2.5000000000000018, -4.300000000000002, -1.8000000000000012, -1.9000000000000012, -1.9000000000000012, -2.3000000000000016, -1.700000000000001, -1.8000000000000012, -2.2000000000000015, -1.700000000000001, -1.9000000000000012, -5.199999999999994, -2.0000000000000013, -1.700000000000001, -1.9000000000000012, -2.3000000000000016, -1.8000000000000012, -1.700000000000001, -2.800000000000002, -2.0000000000000013, -1.9000000000000012, -1.600000000000001, -2.0000000000000013, -2.1000000000000014, -2.600000000000002, -1.700000000000001], "episode_lengths": [46, 41, 27, 27, 33, 31, 95, 33, 53, 32, 35, 53, 30, 43, 37, 36, 51, 48, 30, 44, 26, 37, 34, 32, 32, 37, 33, 34, 31, 34, 36, 30, 38, 43, 33, 28, 37, 33, 30, 32, 26, 32, 41, 26, 29, 29, 35, 28, 28, 30, 29, 52, 26, 30, 28, 32, 27, 29, 40, 30, 31, 33, 33, 27, 25, 27, 35, 32, 32, 30, 33, 35, 27, 31, 26, 30, 31, 39, 40, 34, 37, 27, 30, 33, 35, 29, 29, 29, 36, 30, 27, 28, 30, 32, 32, 45, 29, 30, 30, 34, 28, 29, 33, 28, 30, 63, 31, 28, 30, 34, 29, 28, 34, 31, 30, 27, 31, 32, 37, 28]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2639020432181738, "mean_inference_ms": 0.6194973440081825, "mean_action_processing_ms": 0.06793035765641585, "mean_env_wait_ms": 6.44905808062997, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0055664777755737305, "StateBufferConnector_ms": 0.0033402442932128906, "ViewRequirementAgentConnector_ms": 0.07468163967132568}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 164000, "num_agent_steps_trained": 164000, "num_env_steps_sampled": 164000, "num_env_steps_trained": 164000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 337.3865992821844, "num_env_steps_trained_throughput_per_sec": 337.3865992821844, "timesteps_total": 164000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 164000, "timers": {"training_iteration_time_ms": 11744.957, "sample_time_ms": 8255.924, "load_time_ms": 1.0, "load_throughput": 3998573.812, "learn_time_ms": 3485.676, "learn_throughput": 1147.554, "synch_weights_time_ms": 1.726}, "counters": {"num_env_steps_sampled": 164000, "num_env_steps_trained": 164000, "num_agent_steps_sampled": 164000, "num_agent_steps_trained": 164000}, "done": false, "episodes_total": 2175, "training_iteration": 41, "trial_id": "dbefe_00000", "date": "2024-03-07_12-20-01", "timestamp": 1709832001, "time_this_iter_s": 11.858439922332764, "time_total_s": 452.4343914985657, "pid": 103980, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fcd19c36f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 452.4343914985657, "iterations_since_restore": 41, "perf": {"cpu_util_percent": 20.68, "ram_util_percent": 43.5, "gpu_util_percent0": 0.07266666666666666, "vram_util_percent0": 0.1005859375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.10000000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 0.18296137920046296, "policy_loss": -0.009503899993354915, "vf_loss": 0.19163984022233435, "vf_explained_var": 0.864871153523845, "kl": 0.008254385073505384, "entropy": 0.32899153258210867, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 38595.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 168000, "num_env_steps_trained": 168000, "num_agent_steps_sampled": 168000, "num_agent_steps_trained": 168000}, "sampler_results": {"episode_reward_max": -1.4000000000000008, "episode_reward_min": -4.6, "episode_reward_mean": -2.0779527559055135, "episode_len_mean": 31.37795275590551, "episode_media": {}, "episodes_this_iter": 127, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2.1000000000000014, -2.4000000000000017, -1.9000000000000012, -2.2000000000000015, -1.8000000000000012, -1.700000000000001, -2.1000000000000014, -1.5000000000000009, -1.5000000000000009, -1.600000000000001, -2.0000000000000013, -1.8000000000000012, -2.0000000000000013, -1.9000000000000012, -1.600000000000001, -2.700000000000002, -2.4000000000000017, -1.4000000000000008, -2.900000000000002, -2.2000000000000015, -1.600000000000001, -2.5000000000000018, -2.3000000000000016, -1.600000000000001, -2.1000000000000014, -1.4000000000000008, -3.4000000000000012, -1.8000000000000012, -2.5000000000000018, -2.0000000000000013, -2.5000000000000018, -1.600000000000001, -2.0000000000000013, -2.3000000000000016, -2.1000000000000014, -4.400000000000001, -1.8000000000000012, -1.4000000000000008, -1.700000000000001, -4.6, -1.600000000000001, -1.600000000000001, -1.8000000000000012, -1.8000000000000012, -1.600000000000001, -2.0000000000000013, -2.1000000000000014, -2.5000000000000018, -2.3000000000000016, -2.4000000000000017, -1.700000000000001, -3.5, -3.6999999999999993, -1.700000000000001, -2.0000000000000013, -2.2000000000000015, -1.9000000000000012, -2.3000000000000016, -2.0000000000000013, -1.9000000000000012, -1.700000000000001, -2.3000000000000016, -1.700000000000001, -1.9000000000000012, -2.1000000000000014, -2.0000000000000013, -1.700000000000001, -2.600000000000002, -1.9000000000000012, -1.5000000000000009, -1.5000000000000009, -4.099999999999998, -2.5000000000000018, -1.4000000000000008, -1.5000000000000009, -1.600000000000001, -3.3000000000000007, -2.0000000000000013, -1.600000000000001, -1.8000000000000012, -1.600000000000001, -3.500000000000001, -1.8000000000000012, -2.3000000000000016, -1.600000000000001, -1.9000000000000012, -1.600000000000001, -2.1000000000000014, -1.5000000000000009, -2.0000000000000013, -1.600000000000001, -2.600000000000002, -1.8000000000000012, -2.4000000000000017, -1.9000000000000012, -2.1000000000000014, -1.5000000000000009, -1.700000000000001, -1.600000000000001, -1.9000000000000012, -1.9000000000000012, -2.0000000000000013, -2.2000000000000015, -2.600000000000002, -2.2000000000000015, -3.6999999999999993, -2.0000000000000013, -1.600000000000001, -1.9000000000000012, -2.3000000000000016, -1.700000000000001, -3.6000000000000023, -2.5000000000000018, -1.8000000000000012, -1.600000000000001, -1.600000000000001, -1.600000000000001, -2.3000000000000016, -1.8000000000000012, -2.1000000000000014, -1.5000000000000009, -2.0000000000000013, -2.0000000000000013, -2.1000000000000014, -2.1000000000000014, -1.8000000000000012, -1.8000000000000012], "episode_lengths": [32, 35, 30, 33, 29, 28, 32, 26, 26, 27, 31, 29, 31, 30, 27, 34, 35, 25, 35, 33, 27, 36, 34, 27, 32, 25, 42, 29, 36, 31, 36, 27, 31, 34, 32, 48, 29, 25, 28, 49, 27, 27, 29, 29, 27, 31, 32, 36, 34, 35, 28, 43, 43, 28, 31, 33, 30, 34, 31, 30, 28, 34, 28, 30, 32, 31, 28, 37, 30, 26, 26, 52, 36, 25, 26, 27, 40, 31, 27, 29, 27, 40, 29, 34, 27, 30, 27, 32, 26, 31, 27, 37, 29, 34, 30, 32, 26, 28, 27, 30, 30, 31, 33, 37, 33, 48, 31, 27, 30, 34, 28, 42, 36, 29, 27, 27, 27, 34, 29, 32, 26, 31, 31, 32, 32, 29, 29]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.26678045895960717, "mean_inference_ms": 0.6198744556801737, "mean_action_processing_ms": 0.06799490248464056, "mean_env_wait_ms": 6.467065836157059, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005718854468638503, "StateBufferConnector_ms": 0.0033598246536855622, "ViewRequirementAgentConnector_ms": 0.07577374225526344}}, "episode_reward_max": -1.4000000000000008, "episode_reward_min": -4.6, "episode_reward_mean": -2.0779527559055135, "episode_len_mean": 31.37795275590551, "episodes_this_iter": 127, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-2.1000000000000014, -2.4000000000000017, -1.9000000000000012, -2.2000000000000015, -1.8000000000000012, -1.700000000000001, -2.1000000000000014, -1.5000000000000009, -1.5000000000000009, -1.600000000000001, -2.0000000000000013, -1.8000000000000012, -2.0000000000000013, -1.9000000000000012, -1.600000000000001, -2.700000000000002, -2.4000000000000017, -1.4000000000000008, -2.900000000000002, -2.2000000000000015, -1.600000000000001, -2.5000000000000018, -2.3000000000000016, -1.600000000000001, -2.1000000000000014, -1.4000000000000008, -3.4000000000000012, -1.8000000000000012, -2.5000000000000018, -2.0000000000000013, -2.5000000000000018, -1.600000000000001, -2.0000000000000013, -2.3000000000000016, -2.1000000000000014, -4.400000000000001, -1.8000000000000012, -1.4000000000000008, -1.700000000000001, -4.6, -1.600000000000001, -1.600000000000001, -1.8000000000000012, -1.8000000000000012, -1.600000000000001, -2.0000000000000013, -2.1000000000000014, -2.5000000000000018, -2.3000000000000016, -2.4000000000000017, -1.700000000000001, -3.5, -3.6999999999999993, -1.700000000000001, -2.0000000000000013, -2.2000000000000015, -1.9000000000000012, -2.3000000000000016, -2.0000000000000013, -1.9000000000000012, -1.700000000000001, -2.3000000000000016, -1.700000000000001, -1.9000000000000012, -2.1000000000000014, -2.0000000000000013, -1.700000000000001, -2.600000000000002, -1.9000000000000012, -1.5000000000000009, -1.5000000000000009, -4.099999999999998, -2.5000000000000018, -1.4000000000000008, -1.5000000000000009, -1.600000000000001, -3.3000000000000007, -2.0000000000000013, -1.600000000000001, -1.8000000000000012, -1.600000000000001, -3.500000000000001, -1.8000000000000012, -2.3000000000000016, -1.600000000000001, -1.9000000000000012, -1.600000000000001, -2.1000000000000014, -1.5000000000000009, -2.0000000000000013, -1.600000000000001, -2.600000000000002, -1.8000000000000012, -2.4000000000000017, -1.9000000000000012, -2.1000000000000014, -1.5000000000000009, -1.700000000000001, -1.600000000000001, -1.9000000000000012, -1.9000000000000012, -2.0000000000000013, -2.2000000000000015, -2.600000000000002, -2.2000000000000015, -3.6999999999999993, -2.0000000000000013, -1.600000000000001, -1.9000000000000012, -2.3000000000000016, -1.700000000000001, -3.6000000000000023, -2.5000000000000018, -1.8000000000000012, -1.600000000000001, -1.600000000000001, -1.600000000000001, -2.3000000000000016, -1.8000000000000012, -2.1000000000000014, -1.5000000000000009, -2.0000000000000013, -2.0000000000000013, -2.1000000000000014, -2.1000000000000014, -1.8000000000000012, -1.8000000000000012], "episode_lengths": [32, 35, 30, 33, 29, 28, 32, 26, 26, 27, 31, 29, 31, 30, 27, 34, 35, 25, 35, 33, 27, 36, 34, 27, 32, 25, 42, 29, 36, 31, 36, 27, 31, 34, 32, 48, 29, 25, 28, 49, 27, 27, 29, 29, 27, 31, 32, 36, 34, 35, 28, 43, 43, 28, 31, 33, 30, 34, 31, 30, 28, 34, 28, 30, 32, 31, 28, 37, 30, 26, 26, 52, 36, 25, 26, 27, 40, 31, 27, 29, 27, 40, 29, 34, 27, 30, 27, 32, 26, 31, 27, 37, 29, 34, 30, 32, 26, 28, 27, 30, 30, 31, 33, 37, 33, 48, 31, 27, 30, 34, 28, 42, 36, 29, 27, 27, 27, 34, 29, 32, 26, 31, 31, 32, 32, 29, 29]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.26678045895960717, "mean_inference_ms": 0.6198744556801737, "mean_action_processing_ms": 0.06799490248464056, "mean_env_wait_ms": 6.467065836157059, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005718854468638503, "StateBufferConnector_ms": 0.0033598246536855622, "ViewRequirementAgentConnector_ms": 0.07577374225526344}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 168000, "num_agent_steps_trained": 168000, "num_env_steps_sampled": 168000, "num_env_steps_trained": 168000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 334.71334725556943, "num_env_steps_trained_throughput_per_sec": 334.71334725556943, "timesteps_total": 168000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 168000, "timers": {"training_iteration_time_ms": 11793.328, "sample_time_ms": 8318.864, "load_time_ms": 1.003, "load_throughput": 3987265.252, "learn_time_ms": 3471.116, "learn_throughput": 1152.367, "synch_weights_time_ms": 1.731}, "counters": {"num_env_steps_sampled": 168000, "num_env_steps_trained": 168000, "num_agent_steps_sampled": 168000, "num_agent_steps_trained": 168000}, "done": false, "episodes_total": 2302, "training_iteration": 42, "trial_id": "dbefe_00000", "date": "2024-03-07_12-20-13", "timestamp": 1709832013, "time_this_iter_s": 11.953572273254395, "time_total_s": 464.38796377182007, "pid": 103980, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fcd19c36f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 464.38796377182007, "iterations_since_restore": 42, "perf": {"cpu_util_percent": 20.150000000000002, "ram_util_percent": 43.525, "gpu_util_percent0": 0.07375, "vram_util_percent0": 0.1005859375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.10000000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 0.12548519093261642, "policy_loss": -0.008115739563620218, "vf_loss": 0.1327260967814714, "vf_explained_var": 0.9083039993239987, "kl": 0.008748356744006246, "entropy": 0.2981804420871119, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 39525.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 172000, "num_env_steps_trained": 172000, "num_agent_steps_sampled": 172000, "num_agent_steps_trained": 172000}, "sampler_results": {"episode_reward_max": -1.4000000000000008, "episode_reward_min": -5.599999999999997, "episode_reward_mean": -2.026356589147288, "episode_len_mean": 31.085271317829456, "episode_media": {}, "episodes_this_iter": 129, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2.3000000000000016, -2.1000000000000014, -1.700000000000001, -3.1000000000000014, -1.8000000000000012, -1.9000000000000012, -2.1000000000000014, -1.600000000000001, -1.4000000000000008, -2.0000000000000013, -1.9000000000000012, -1.600000000000001, -1.9000000000000012, -1.700000000000001, -1.600000000000001, -1.5000000000000009, -1.8000000000000012, -1.8000000000000012, -1.8000000000000012, -3.5, -1.8000000000000012, -1.700000000000001, -1.9000000000000012, -3.4000000000000004, -1.700000000000001, -1.700000000000001, -1.600000000000001, -1.700000000000001, -1.600000000000001, -1.5000000000000009, -1.4000000000000008, -1.8000000000000012, -2.2000000000000015, -2.2000000000000015, -2.800000000000002, -1.600000000000001, -1.9000000000000012, -1.8000000000000012, -2.1000000000000014, -1.9000000000000012, -2.900000000000002, -2.0000000000000013, -2.0000000000000013, -1.9000000000000012, -1.5000000000000009, -5.599999999999997, -1.700000000000001, -2.2000000000000015, -1.9000000000000012, -2.4000000000000017, -2.600000000000002, -1.9000000000000012, -1.600000000000001, -1.600000000000001, -3.3000000000000007, -2.3000000000000016, -2.2000000000000015, -1.8000000000000012, -1.9000000000000012, -4.1999999999999975, -1.700000000000001, -1.8000000000000012, -1.600000000000001, -1.8000000000000012, -1.700000000000001, -1.5000000000000009, -1.5000000000000009, -1.600000000000001, -2.900000000000002, -1.8000000000000012, -1.9000000000000012, -1.5000000000000009, -1.8000000000000012, -2.4000000000000017, -2.0000000000000013, -2.800000000000002, -1.9000000000000012, -2.2000000000000015, -1.600000000000001, -1.600000000000001, -2.3000000000000016, -1.600000000000001, -2.0000000000000013, -1.9000000000000012, -2.2000000000000015, -2.0000000000000013, -1.600000000000001, -1.9000000000000012, -1.700000000000001, -1.5000000000000009, -2.2000000000000015, -2.1000000000000014, -2.4000000000000017, -1.9000000000000012, -3.0000000000000018, -1.600000000000001, -1.4000000000000008, -3.1000000000000014, -1.700000000000001, -1.8000000000000012, -1.600000000000001, -1.8000000000000012, -1.8000000000000012, -2.4000000000000017, -2.4000000000000017, -2.700000000000002, -1.8000000000000012, -1.700000000000001, -2.0000000000000013, -1.600000000000001, -2.1000000000000014, -2.4000000000000017, -1.600000000000001, -1.9000000000000012, -1.4000000000000008, -1.8000000000000012, -2.2000000000000015, -1.600000000000001, -1.8000000000000012, -1.8000000000000012, -1.5000000000000009, -4.2, -2.3000000000000016, -2.600000000000002, -2.4000000000000017, -1.8000000000000012, -1.8000000000000012, -2.5000000000000018, -1.5000000000000009], "episode_lengths": [34, 32, 28, 42, 29, 30, 32, 27, 25, 31, 30, 27, 30, 28, 27, 26, 29, 29, 29, 41, 29, 28, 30, 42, 28, 28, 27, 28, 27, 26, 25, 29, 33, 33, 38, 27, 30, 29, 32, 30, 40, 31, 31, 30, 26, 62, 28, 33, 30, 35, 35, 30, 27, 27, 44, 34, 33, 29, 30, 53, 28, 29, 27, 29, 28, 26, 26, 27, 40, 29, 30, 26, 29, 35, 31, 39, 30, 33, 27, 27, 34, 27, 31, 30, 33, 31, 27, 30, 28, 26, 33, 32, 35, 30, 41, 27, 25, 42, 28, 29, 27, 29, 29, 35, 35, 38, 29, 28, 31, 27, 32, 35, 27, 30, 25, 29, 33, 27, 29, 29, 26, 48, 34, 35, 35, 29, 29, 36, 26]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.26963471261862165, "mean_inference_ms": 0.6203417605939122, "mean_action_processing_ms": 0.0680400352942059, "mean_env_wait_ms": 6.486787589359774, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005713174509447675, "StateBufferConnector_ms": 0.003286849620730378, "ViewRequirementAgentConnector_ms": 0.07531809252361919}}, "episode_reward_max": -1.4000000000000008, "episode_reward_min": -5.599999999999997, "episode_reward_mean": -2.026356589147288, "episode_len_mean": 31.085271317829456, "episodes_this_iter": 129, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-2.3000000000000016, -2.1000000000000014, -1.700000000000001, -3.1000000000000014, -1.8000000000000012, -1.9000000000000012, -2.1000000000000014, -1.600000000000001, -1.4000000000000008, -2.0000000000000013, -1.9000000000000012, -1.600000000000001, -1.9000000000000012, -1.700000000000001, -1.600000000000001, -1.5000000000000009, -1.8000000000000012, -1.8000000000000012, -1.8000000000000012, -3.5, -1.8000000000000012, -1.700000000000001, -1.9000000000000012, -3.4000000000000004, -1.700000000000001, -1.700000000000001, -1.600000000000001, -1.700000000000001, -1.600000000000001, -1.5000000000000009, -1.4000000000000008, -1.8000000000000012, -2.2000000000000015, -2.2000000000000015, -2.800000000000002, -1.600000000000001, -1.9000000000000012, -1.8000000000000012, -2.1000000000000014, -1.9000000000000012, -2.900000000000002, -2.0000000000000013, -2.0000000000000013, -1.9000000000000012, -1.5000000000000009, -5.599999999999997, -1.700000000000001, -2.2000000000000015, -1.9000000000000012, -2.4000000000000017, -2.600000000000002, -1.9000000000000012, -1.600000000000001, -1.600000000000001, -3.3000000000000007, -2.3000000000000016, -2.2000000000000015, -1.8000000000000012, -1.9000000000000012, -4.1999999999999975, -1.700000000000001, -1.8000000000000012, -1.600000000000001, -1.8000000000000012, -1.700000000000001, -1.5000000000000009, -1.5000000000000009, -1.600000000000001, -2.900000000000002, -1.8000000000000012, -1.9000000000000012, -1.5000000000000009, -1.8000000000000012, -2.4000000000000017, -2.0000000000000013, -2.800000000000002, -1.9000000000000012, -2.2000000000000015, -1.600000000000001, -1.600000000000001, -2.3000000000000016, -1.600000000000001, -2.0000000000000013, -1.9000000000000012, -2.2000000000000015, -2.0000000000000013, -1.600000000000001, -1.9000000000000012, -1.700000000000001, -1.5000000000000009, -2.2000000000000015, -2.1000000000000014, -2.4000000000000017, -1.9000000000000012, -3.0000000000000018, -1.600000000000001, -1.4000000000000008, -3.1000000000000014, -1.700000000000001, -1.8000000000000012, -1.600000000000001, -1.8000000000000012, -1.8000000000000012, -2.4000000000000017, -2.4000000000000017, -2.700000000000002, -1.8000000000000012, -1.700000000000001, -2.0000000000000013, -1.600000000000001, -2.1000000000000014, -2.4000000000000017, -1.600000000000001, -1.9000000000000012, -1.4000000000000008, -1.8000000000000012, -2.2000000000000015, -1.600000000000001, -1.8000000000000012, -1.8000000000000012, -1.5000000000000009, -4.2, -2.3000000000000016, -2.600000000000002, -2.4000000000000017, -1.8000000000000012, -1.8000000000000012, -2.5000000000000018, -1.5000000000000009], "episode_lengths": [34, 32, 28, 42, 29, 30, 32, 27, 25, 31, 30, 27, 30, 28, 27, 26, 29, 29, 29, 41, 29, 28, 30, 42, 28, 28, 27, 28, 27, 26, 25, 29, 33, 33, 38, 27, 30, 29, 32, 30, 40, 31, 31, 30, 26, 62, 28, 33, 30, 35, 35, 30, 27, 27, 44, 34, 33, 29, 30, 53, 28, 29, 27, 29, 28, 26, 26, 27, 40, 29, 30, 26, 29, 35, 31, 39, 30, 33, 27, 27, 34, 27, 31, 30, 33, 31, 27, 30, 28, 26, 33, 32, 35, 30, 41, 27, 25, 42, 28, 29, 27, 29, 29, 35, 35, 38, 29, 28, 31, 27, 32, 35, 27, 30, 25, 29, 33, 27, 29, 29, 26, 48, 34, 35, 35, 29, 29, 36, 26]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.26963471261862165, "mean_inference_ms": 0.6203417605939122, "mean_action_processing_ms": 0.0680400352942059, "mean_env_wait_ms": 6.486787589359774, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005713174509447675, "StateBufferConnector_ms": 0.003286849620730378, "ViewRequirementAgentConnector_ms": 0.07531809252361919}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 172000, "num_agent_steps_trained": 172000, "num_env_steps_sampled": 172000, "num_env_steps_trained": 172000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 334.364927964189, "num_env_steps_trained_throughput_per_sec": 334.364927964189, "timesteps_total": 172000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 172000, "timers": {"training_iteration_time_ms": 11839.504, "sample_time_ms": 8369.816, "load_time_ms": 1.008, "load_throughput": 3968684.298, "learn_time_ms": 3466.333, "learn_throughput": 1153.957, "synch_weights_time_ms": 1.731}, "counters": {"num_env_steps_sampled": 172000, "num_env_steps_trained": 172000, "num_agent_steps_sampled": 172000, "num_agent_steps_trained": 172000}, "done": false, "episodes_total": 2431, "training_iteration": 43, "trial_id": "dbefe_00000", "date": "2024-03-07_12-20-24", "timestamp": 1709832024, "time_this_iter_s": 11.965545415878296, "time_total_s": 476.35350918769836, "pid": 103980, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fcd19c36f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 476.35350918769836, "iterations_since_restore": 43, "perf": {"cpu_util_percent": 20.206249999999997, "ram_util_percent": 43.56875, "gpu_util_percent0": 0.079375, "vram_util_percent0": 0.1005859375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.10000000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 0.08116974237500765, "policy_loss": -0.01225961247278798, "vf_loss": 0.09251777355869611, "vf_explained_var": 0.9164802135959749, "kl": 0.00911582602260904, "entropy": 0.2693885920509215, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 40455.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 176000, "num_env_steps_trained": 176000, "num_agent_steps_sampled": 176000, "num_agent_steps_trained": 176000}, "sampler_results": {"episode_reward_max": -1.4000000000000008, "episode_reward_min": -3.6999999999999993, "episode_reward_mean": -1.9135338345864674, "episode_len_mean": 29.93984962406015, "episode_media": {}, "episodes_this_iter": 133, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1.8000000000000012, -1.8000000000000012, -3.200000000000002, -1.600000000000001, -1.8000000000000012, -1.8000000000000012, -1.600000000000001, -2.2000000000000015, -2.3000000000000016, -3.200000000000001, -1.700000000000001, -1.8000000000000012, -1.9000000000000012, -2.1000000000000014, -1.5000000000000009, -2.2000000000000015, -2.800000000000002, -1.4000000000000008, -1.700000000000001, -1.600000000000001, -2.0000000000000013, -1.9000000000000012, -2.2000000000000015, -1.5000000000000009, -2.900000000000002, -1.8000000000000012, -1.8000000000000012, -1.700000000000001, -1.8000000000000012, -1.8000000000000012, -3.1000000000000014, -1.600000000000001, -2.2000000000000015, -2.1000000000000014, -2.0000000000000013, -1.700000000000001, -1.700000000000001, -1.700000000000001, -1.700000000000001, -1.700000000000001, -1.8000000000000012, -1.600000000000001, -1.9000000000000012, -2.5000000000000018, -1.5000000000000009, -1.700000000000001, -2.0000000000000013, -2.1000000000000014, -2.1000000000000014, -1.700000000000001, -1.700000000000001, -3.3000000000000007, -1.5000000000000009, -1.700000000000001, -1.600000000000001, -1.600000000000001, -3.0000000000000018, -3.4000000000000004, -1.9000000000000012, -1.700000000000001, -1.9000000000000012, -1.8000000000000012, -1.700000000000001, -1.8000000000000012, -1.4000000000000008, -1.8000000000000012, -2.700000000000002, -2.700000000000002, -2.5000000000000018, -1.4000000000000008, -1.9000000000000012, -1.700000000000001, -1.700000000000001, -1.8000000000000012, -1.700000000000001, -1.700000000000001, -2.0000000000000013, -1.9000000000000012, -3.200000000000001, -1.700000000000001, -1.9000000000000012, -1.9000000000000012, -1.5000000000000009, -1.8000000000000012, -1.8000000000000012, -2.0000000000000013, -1.600000000000001, -1.700000000000001, -1.9000000000000012, -1.600000000000001, -2.3000000000000016, -1.600000000000001, -1.700000000000001, -1.700000000000001, -2.0000000000000013, -1.9000000000000012, -1.600000000000001, -1.8000000000000012, -1.600000000000001, -1.4000000000000008, -1.600000000000001, -1.700000000000001, -1.700000000000001, -2.1000000000000014, -2.5000000000000018, -1.8000000000000012, -1.700000000000001, -3.6999999999999993, -1.5000000000000009, -1.8000000000000012, -1.600000000000001, -2.5000000000000018, -1.8000000000000012, -1.700000000000001, -1.600000000000001, -1.4000000000000008, -1.5000000000000009, -1.8000000000000012, -1.700000000000001, -1.600000000000001, -1.600000000000001, -1.8000000000000012, -1.5000000000000009, -2.2000000000000015, -1.600000000000001, -1.600000000000001, -2.0000000000000013, -1.8000000000000012, -1.5000000000000009, -2.3000000000000016, -1.8000000000000012, -2.2000000000000015, -1.8000000000000012], "episode_lengths": [29, 29, 40, 27, 29, 29, 27, 33, 34, 39, 28, 29, 30, 32, 26, 33, 39, 25, 28, 27, 31, 30, 33, 26, 40, 29, 29, 28, 29, 29, 42, 27, 33, 32, 31, 28, 28, 28, 28, 28, 29, 27, 30, 36, 26, 28, 31, 32, 32, 28, 28, 40, 26, 28, 27, 27, 37, 41, 30, 28, 30, 29, 28, 29, 25, 29, 38, 38, 34, 25, 30, 28, 28, 29, 28, 28, 31, 30, 38, 28, 30, 30, 26, 29, 29, 31, 27, 28, 30, 27, 34, 27, 28, 28, 31, 30, 27, 29, 27, 25, 27, 28, 28, 32, 36, 29, 28, 48, 26, 29, 27, 36, 29, 28, 27, 25, 26, 29, 28, 27, 27, 29, 26, 33, 27, 27, 31, 29, 26, 34, 29, 33, 29]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2726715619090139, "mean_inference_ms": 0.6212973320470021, "mean_action_processing_ms": 0.06808310239332074, "mean_env_wait_ms": 6.512669391554988, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005964228981419613, "StateBufferConnector_ms": 0.0034466721957787535, "ViewRequirementAgentConnector_ms": 0.07793042892800238}}, "episode_reward_max": -1.4000000000000008, "episode_reward_min": -3.6999999999999993, "episode_reward_mean": -1.9135338345864674, "episode_len_mean": 29.93984962406015, "episodes_this_iter": 133, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1.8000000000000012, -1.8000000000000012, -3.200000000000002, -1.600000000000001, -1.8000000000000012, -1.8000000000000012, -1.600000000000001, -2.2000000000000015, -2.3000000000000016, -3.200000000000001, -1.700000000000001, -1.8000000000000012, -1.9000000000000012, -2.1000000000000014, -1.5000000000000009, -2.2000000000000015, -2.800000000000002, -1.4000000000000008, -1.700000000000001, -1.600000000000001, -2.0000000000000013, -1.9000000000000012, -2.2000000000000015, -1.5000000000000009, -2.900000000000002, -1.8000000000000012, -1.8000000000000012, -1.700000000000001, -1.8000000000000012, -1.8000000000000012, -3.1000000000000014, -1.600000000000001, -2.2000000000000015, -2.1000000000000014, -2.0000000000000013, -1.700000000000001, -1.700000000000001, -1.700000000000001, -1.700000000000001, -1.700000000000001, -1.8000000000000012, -1.600000000000001, -1.9000000000000012, -2.5000000000000018, -1.5000000000000009, -1.700000000000001, -2.0000000000000013, -2.1000000000000014, -2.1000000000000014, -1.700000000000001, -1.700000000000001, -3.3000000000000007, -1.5000000000000009, -1.700000000000001, -1.600000000000001, -1.600000000000001, -3.0000000000000018, -3.4000000000000004, -1.9000000000000012, -1.700000000000001, -1.9000000000000012, -1.8000000000000012, -1.700000000000001, -1.8000000000000012, -1.4000000000000008, -1.8000000000000012, -2.700000000000002, -2.700000000000002, -2.5000000000000018, -1.4000000000000008, -1.9000000000000012, -1.700000000000001, -1.700000000000001, -1.8000000000000012, -1.700000000000001, -1.700000000000001, -2.0000000000000013, -1.9000000000000012, -3.200000000000001, -1.700000000000001, -1.9000000000000012, -1.9000000000000012, -1.5000000000000009, -1.8000000000000012, -1.8000000000000012, -2.0000000000000013, -1.600000000000001, -1.700000000000001, -1.9000000000000012, -1.600000000000001, -2.3000000000000016, -1.600000000000001, -1.700000000000001, -1.700000000000001, -2.0000000000000013, -1.9000000000000012, -1.600000000000001, -1.8000000000000012, -1.600000000000001, -1.4000000000000008, -1.600000000000001, -1.700000000000001, -1.700000000000001, -2.1000000000000014, -2.5000000000000018, -1.8000000000000012, -1.700000000000001, -3.6999999999999993, -1.5000000000000009, -1.8000000000000012, -1.600000000000001, -2.5000000000000018, -1.8000000000000012, -1.700000000000001, -1.600000000000001, -1.4000000000000008, -1.5000000000000009, -1.8000000000000012, -1.700000000000001, -1.600000000000001, -1.600000000000001, -1.8000000000000012, -1.5000000000000009, -2.2000000000000015, -1.600000000000001, -1.600000000000001, -2.0000000000000013, -1.8000000000000012, -1.5000000000000009, -2.3000000000000016, -1.8000000000000012, -2.2000000000000015, -1.8000000000000012], "episode_lengths": [29, 29, 40, 27, 29, 29, 27, 33, 34, 39, 28, 29, 30, 32, 26, 33, 39, 25, 28, 27, 31, 30, 33, 26, 40, 29, 29, 28, 29, 29, 42, 27, 33, 32, 31, 28, 28, 28, 28, 28, 29, 27, 30, 36, 26, 28, 31, 32, 32, 28, 28, 40, 26, 28, 27, 27, 37, 41, 30, 28, 30, 29, 28, 29, 25, 29, 38, 38, 34, 25, 30, 28, 28, 29, 28, 28, 31, 30, 38, 28, 30, 30, 26, 29, 29, 31, 27, 28, 30, 27, 34, 27, 28, 28, 31, 30, 27, 29, 27, 25, 27, 28, 28, 32, 36, 29, 28, 48, 26, 29, 27, 36, 29, 28, 27, 25, 26, 29, 28, 27, 27, 29, 26, 33, 27, 27, 31, 29, 26, 34, 29, 33, 29]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2726715619090139, "mean_inference_ms": 0.6212973320470021, "mean_action_processing_ms": 0.06808310239332074, "mean_env_wait_ms": 6.512669391554988, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005964228981419613, "StateBufferConnector_ms": 0.0034466721957787535, "ViewRequirementAgentConnector_ms": 0.07793042892800238}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 176000, "num_agent_steps_trained": 176000, "num_env_steps_sampled": 176000, "num_env_steps_trained": 176000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 326.3920899622058, "num_env_steps_trained_throughput_per_sec": 326.3920899622058, "timesteps_total": 176000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 176000, "timers": {"training_iteration_time_ms": 11912.163, "sample_time_ms": 8447.47, "load_time_ms": 1.008, "load_throughput": 3967745.719, "learn_time_ms": 3460.138, "learn_throughput": 1156.023, "synch_weights_time_ms": 2.918}, "counters": {"num_env_steps_sampled": 176000, "num_env_steps_trained": 176000, "num_agent_steps_sampled": 176000, "num_agent_steps_trained": 176000}, "done": false, "episodes_total": 2564, "training_iteration": 44, "trial_id": "dbefe_00000", "date": "2024-03-07_12-20-37", "timestamp": 1709832037, "time_this_iter_s": 12.25837516784668, "time_total_s": 488.61188435554504, "pid": 103980, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fcd19c36f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 488.61188435554504, "iterations_since_restore": 44, "perf": {"cpu_util_percent": 21.53125, "ram_util_percent": 43.6375, "gpu_util_percent0": 0.080625, "vram_util_percent0": 0.1005859375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.10000000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 0.019667535184341813, "policy_loss": -0.009269426838164369, "vf_loss": 0.02825809642772681, "vf_explained_var": 0.9739985254503065, "kl": 0.006788657871261451, "entropy": 0.25219726376636054, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 41385.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 180000, "num_env_steps_trained": 180000, "num_agent_steps_sampled": 180000, "num_agent_steps_trained": 180000}, "sampler_results": {"episode_reward_max": -1.4000000000000008, "episode_reward_min": -6.39999999999999, "episode_reward_mean": -1.8398550724637694, "episode_len_mean": 29.32608695652174, "episode_media": {}, "episodes_this_iter": 138, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1.5000000000000009, -1.700000000000001, -1.600000000000001, -2.0000000000000013, -1.700000000000001, -1.700000000000001, -1.700000000000001, -1.5000000000000009, -1.600000000000001, -2.1000000000000014, -1.4000000000000008, -2.2000000000000015, -1.5000000000000009, -1.700000000000001, -2.0000000000000013, -1.600000000000001, -1.700000000000001, -1.8000000000000012, -1.8000000000000012, -1.9000000000000012, -1.8000000000000012, -1.600000000000001, -1.8000000000000012, -2.1000000000000014, -1.9000000000000012, -6.39999999999999, -2.0000000000000013, -1.8000000000000012, -1.700000000000001, -1.600000000000001, -1.600000000000001, -1.9000000000000012, -1.600000000000001, -1.700000000000001, -1.8000000000000012, -1.700000000000001, -1.600000000000001, -1.5000000000000009, -1.5000000000000009, -1.9000000000000012, -2.1000000000000014, -1.600000000000001, -1.5000000000000009, -1.700000000000001, -1.9000000000000012, -1.9000000000000012, -1.8000000000000012, -1.600000000000001, -1.600000000000001, -1.4000000000000008, -1.9000000000000012, -1.9000000000000012, -2.0000000000000013, -1.9000000000000012, -1.700000000000001, -2.0000000000000013, -1.700000000000001, -2.3000000000000016, -1.700000000000001, -1.600000000000001, -1.700000000000001, -1.4000000000000008, -1.600000000000001, -1.600000000000001, -2.5000000000000018, -2.0000000000000013, -1.8000000000000012, -2.1000000000000014, -1.600000000000001, -2.1000000000000014, -1.600000000000001, -1.9000000000000012, -1.700000000000001, -1.8000000000000012, -1.9000000000000012, -2.2000000000000015, -1.4000000000000008, -1.600000000000001, -1.700000000000001, -1.9000000000000012, -1.600000000000001, -3.1000000000000014, -1.700000000000001, -1.9000000000000012, -1.600000000000001, -1.600000000000001, -2.1000000000000014, -1.600000000000001, -1.600000000000001, -1.600000000000001, -1.700000000000001, -1.5000000000000009, -1.9000000000000012, -1.600000000000001, -1.600000000000001, -1.9000000000000012, -1.9000000000000012, -2.0000000000000013, -1.9000000000000012, -2.800000000000002, -1.700000000000001, -1.700000000000001, -1.9000000000000012, -1.700000000000001, -1.700000000000001, -2.3000000000000016, -2.0000000000000013, -1.8000000000000012, -1.700000000000001, -1.9000000000000012, -1.700000000000001, -2.1000000000000014, -2.0000000000000013, -1.700000000000001, -1.8000000000000012, -1.8000000000000012, -2.3000000000000016, -1.600000000000001, -1.8000000000000012, -1.5000000000000009, -1.8000000000000012, -1.700000000000001, -3.200000000000001, -1.9000000000000012, -1.8000000000000012, -1.4000000000000008, -1.4000000000000008, -1.5000000000000009, -2.2000000000000015, -1.600000000000001, -2.3000000000000016, -1.9000000000000012, -1.700000000000001, -2.0000000000000013, -2.0000000000000013, -1.600000000000001, -1.9000000000000012, -2.0000000000000013], "episode_lengths": [26, 28, 27, 31, 28, 28, 28, 26, 27, 32, 25, 33, 26, 28, 31, 27, 28, 29, 29, 30, 29, 27, 29, 32, 30, 66, 31, 29, 28, 27, 27, 30, 27, 28, 29, 28, 27, 26, 26, 30, 32, 27, 26, 28, 30, 30, 29, 27, 27, 25, 30, 30, 31, 30, 28, 31, 28, 34, 28, 27, 28, 25, 27, 27, 36, 31, 29, 31, 27, 32, 27, 30, 28, 29, 30, 33, 25, 27, 28, 30, 27, 42, 28, 30, 27, 27, 32, 27, 27, 27, 28, 26, 30, 27, 27, 30, 30, 31, 30, 39, 28, 28, 30, 28, 28, 34, 31, 29, 28, 30, 28, 32, 31, 28, 29, 29, 34, 27, 29, 26, 29, 28, 43, 30, 29, 25, 25, 26, 33, 27, 34, 30, 28, 31, 31, 27, 30, 31]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2755302864275123, "mean_inference_ms": 0.6218217961019846, "mean_action_processing_ms": 0.06810523295521397, "mean_env_wait_ms": 6.532700737995748, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0058996504631595335, "StateBufferConnector_ms": 0.0034394471541694975, "ViewRequirementAgentConnector_ms": 0.0773849694625191}}, "episode_reward_max": -1.4000000000000008, "episode_reward_min": -6.39999999999999, "episode_reward_mean": -1.8398550724637694, "episode_len_mean": 29.32608695652174, "episodes_this_iter": 138, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1.5000000000000009, -1.700000000000001, -1.600000000000001, -2.0000000000000013, -1.700000000000001, -1.700000000000001, -1.700000000000001, -1.5000000000000009, -1.600000000000001, -2.1000000000000014, -1.4000000000000008, -2.2000000000000015, -1.5000000000000009, -1.700000000000001, -2.0000000000000013, -1.600000000000001, -1.700000000000001, -1.8000000000000012, -1.8000000000000012, -1.9000000000000012, -1.8000000000000012, -1.600000000000001, -1.8000000000000012, -2.1000000000000014, -1.9000000000000012, -6.39999999999999, -2.0000000000000013, -1.8000000000000012, -1.700000000000001, -1.600000000000001, -1.600000000000001, -1.9000000000000012, -1.600000000000001, -1.700000000000001, -1.8000000000000012, -1.700000000000001, -1.600000000000001, -1.5000000000000009, -1.5000000000000009, -1.9000000000000012, -2.1000000000000014, -1.600000000000001, -1.5000000000000009, -1.700000000000001, -1.9000000000000012, -1.9000000000000012, -1.8000000000000012, -1.600000000000001, -1.600000000000001, -1.4000000000000008, -1.9000000000000012, -1.9000000000000012, -2.0000000000000013, -1.9000000000000012, -1.700000000000001, -2.0000000000000013, -1.700000000000001, -2.3000000000000016, -1.700000000000001, -1.600000000000001, -1.700000000000001, -1.4000000000000008, -1.600000000000001, -1.600000000000001, -2.5000000000000018, -2.0000000000000013, -1.8000000000000012, -2.1000000000000014, -1.600000000000001, -2.1000000000000014, -1.600000000000001, -1.9000000000000012, -1.700000000000001, -1.8000000000000012, -1.9000000000000012, -2.2000000000000015, -1.4000000000000008, -1.600000000000001, -1.700000000000001, -1.9000000000000012, -1.600000000000001, -3.1000000000000014, -1.700000000000001, -1.9000000000000012, -1.600000000000001, -1.600000000000001, -2.1000000000000014, -1.600000000000001, -1.600000000000001, -1.600000000000001, -1.700000000000001, -1.5000000000000009, -1.9000000000000012, -1.600000000000001, -1.600000000000001, -1.9000000000000012, -1.9000000000000012, -2.0000000000000013, -1.9000000000000012, -2.800000000000002, -1.700000000000001, -1.700000000000001, -1.9000000000000012, -1.700000000000001, -1.700000000000001, -2.3000000000000016, -2.0000000000000013, -1.8000000000000012, -1.700000000000001, -1.9000000000000012, -1.700000000000001, -2.1000000000000014, -2.0000000000000013, -1.700000000000001, -1.8000000000000012, -1.8000000000000012, -2.3000000000000016, -1.600000000000001, -1.8000000000000012, -1.5000000000000009, -1.8000000000000012, -1.700000000000001, -3.200000000000001, -1.9000000000000012, -1.8000000000000012, -1.4000000000000008, -1.4000000000000008, -1.5000000000000009, -2.2000000000000015, -1.600000000000001, -2.3000000000000016, -1.9000000000000012, -1.700000000000001, -2.0000000000000013, -2.0000000000000013, -1.600000000000001, -1.9000000000000012, -2.0000000000000013], "episode_lengths": [26, 28, 27, 31, 28, 28, 28, 26, 27, 32, 25, 33, 26, 28, 31, 27, 28, 29, 29, 30, 29, 27, 29, 32, 30, 66, 31, 29, 28, 27, 27, 30, 27, 28, 29, 28, 27, 26, 26, 30, 32, 27, 26, 28, 30, 30, 29, 27, 27, 25, 30, 30, 31, 30, 28, 31, 28, 34, 28, 27, 28, 25, 27, 27, 36, 31, 29, 31, 27, 32, 27, 30, 28, 29, 30, 33, 25, 27, 28, 30, 27, 42, 28, 30, 27, 27, 32, 27, 27, 27, 28, 26, 30, 27, 27, 30, 30, 31, 30, 39, 28, 28, 30, 28, 28, 34, 31, 29, 28, 30, 28, 32, 31, 28, 29, 29, 34, 27, 29, 26, 29, 28, 43, 30, 29, 25, 25, 26, 33, 27, 34, 30, 28, 31, 31, 27, 30, 31]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2755302864275123, "mean_inference_ms": 0.6218217961019846, "mean_action_processing_ms": 0.06810523295521397, "mean_env_wait_ms": 6.532700737995748, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0058996504631595335, "StateBufferConnector_ms": 0.0034394471541694975, "ViewRequirementAgentConnector_ms": 0.0773849694625191}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 180000, "num_agent_steps_trained": 180000, "num_env_steps_sampled": 180000, "num_env_steps_trained": 180000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 329.27438903724504, "num_env_steps_trained_throughput_per_sec": 329.27438903724504, "timesteps_total": 180000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 180000, "timers": {"training_iteration_time_ms": 11953.479, "sample_time_ms": 8494.847, "load_time_ms": 1.01, "load_throughput": 3960346.529, "learn_time_ms": 3454.071, "learn_throughput": 1158.054, "synch_weights_time_ms": 2.924}, "counters": {"num_env_steps_sampled": 180000, "num_env_steps_trained": 180000, "num_agent_steps_sampled": 180000, "num_agent_steps_trained": 180000}, "done": false, "episodes_total": 2702, "training_iteration": 45, "trial_id": "dbefe_00000", "date": "2024-03-07_12-20-49", "timestamp": 1709832049, "time_this_iter_s": 12.150567054748535, "time_total_s": 500.7624514102936, "pid": 103980, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fcd19c36f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 500.7624514102936, "iterations_since_restore": 45, "perf": {"cpu_util_percent": 21.660000000000004, "ram_util_percent": 43.62666666666667, "gpu_util_percent0": 0.06933333333333333, "vram_util_percent0": 0.1005859375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.10000000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 1.2557679632458316, "policy_loss": 0.0017441894258222272, "vf_loss": 1.2531501263289924, "vf_explained_var": 0.625659889495501, "kl": 0.008736514127377441, "entropy": 0.35173945146542723, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 42315.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 184000, "num_env_steps_trained": 184000, "num_agent_steps_sampled": 184000, "num_agent_steps_trained": 184000}, "sampler_results": {"episode_reward_max": -1.4000000000000008, "episode_reward_min": -59.50000000000037, "episode_reward_mean": -2.3663716814159335, "episode_len_mean": 32.78761061946903, "episode_media": {}, "episodes_this_iter": 113, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2.0000000000000013, -2.0000000000000013, -1.700000000000001, -1.700000000000001, -2.2000000000000015, -1.9000000000000012, -2.2000000000000015, -2.1000000000000014, -1.4000000000000008, -1.9000000000000012, -1.8000000000000012, -3.0000000000000018, -1.700000000000001, -1.700000000000001, -2.2000000000000015, -2.1000000000000014, -1.600000000000001, -2.5000000000000018, -2.3000000000000016, -2.5000000000000018, -1.600000000000001, -1.700000000000001, -2.4000000000000017, -2.3000000000000016, -1.5000000000000009, -2.3000000000000016, -1.9000000000000012, -2.0000000000000013, -1.9000000000000012, -1.700000000000001, -1.8000000000000012, -1.9000000000000012, -2.1000000000000014, -1.4000000000000008, -1.5000000000000009, -1.5000000000000009, -1.4000000000000008, -1.5000000000000009, -1.9000000000000012, -1.600000000000001, -1.600000000000001, -1.9000000000000012, -2.1000000000000014, -1.8000000000000012, -2.0000000000000013, -2.3000000000000016, -2.2000000000000015, -1.8000000000000012, -1.5000000000000009, -1.8000000000000012, -1.600000000000001, -2.0000000000000013, -1.5000000000000009, -1.4000000000000008, -1.8000000000000012, -1.5000000000000009, -1.8000000000000012, -2.1000000000000014, -1.4000000000000008, -1.5000000000000009, -1.8000000000000012, -1.8000000000000012, -1.600000000000001, -1.700000000000001, -2.0000000000000013, -1.8000000000000012, -2.2000000000000015, -2.0000000000000013, -2.3000000000000016, -1.5000000000000009, -1.4000000000000008, -2.0000000000000013, -2.3000000000000016, -1.5000000000000009, -1.8000000000000012, -1.700000000000001, -1.8000000000000012, -1.5000000000000009, -1.700000000000001, -1.600000000000001, -1.600000000000001, -1.600000000000001, -1.4000000000000008, -1.700000000000001, -59.50000000000037, -1.600000000000001, -2.700000000000002, -2.0000000000000013, -1.9000000000000012, -1.700000000000001, -1.8000000000000012, -1.5000000000000009, -1.700000000000001, -1.5000000000000009, -1.5000000000000009, -2.2000000000000015, -2.2000000000000015, -1.8000000000000012, -1.600000000000001, -2.3000000000000016, -1.700000000000001, -1.9000000000000012, -1.700000000000001, -1.9000000000000012, -1.4000000000000008, -1.8000000000000012, -2.0000000000000013, -3.200000000000001, -2.3000000000000016, -1.600000000000001, -1.9000000000000012, -2.4000000000000017, -1.8000000000000012], "episode_lengths": [31, 31, 28, 28, 33, 30, 33, 32, 25, 30, 29, 35, 28, 28, 33, 32, 27, 36, 34, 36, 27, 28, 35, 34, 26, 34, 30, 31, 30, 28, 29, 30, 32, 25, 26, 26, 25, 26, 30, 27, 27, 30, 32, 29, 31, 34, 33, 29, 26, 29, 27, 31, 26, 25, 29, 26, 29, 32, 25, 26, 29, 29, 27, 28, 31, 29, 33, 31, 34, 26, 25, 31, 34, 26, 29, 28, 29, 26, 28, 27, 27, 27, 25, 28, 400, 27, 38, 31, 30, 28, 29, 26, 28, 26, 26, 33, 33, 29, 27, 34, 28, 30, 28, 30, 25, 29, 31, 43, 34, 27, 30, 35, 29]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.27708591935856014, "mean_inference_ms": 0.6218675449256387, "mean_action_processing_ms": 0.06809385249806794, "mean_env_wait_ms": 6.543841691678732, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005756226261105158, "StateBufferConnector_ms": 0.0033034687548612073, "ViewRequirementAgentConnector_ms": 0.07471299804417433}}, "episode_reward_max": -1.4000000000000008, "episode_reward_min": -59.50000000000037, "episode_reward_mean": -2.3663716814159335, "episode_len_mean": 32.78761061946903, "episodes_this_iter": 113, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-2.0000000000000013, -2.0000000000000013, -1.700000000000001, -1.700000000000001, -2.2000000000000015, -1.9000000000000012, -2.2000000000000015, -2.1000000000000014, -1.4000000000000008, -1.9000000000000012, -1.8000000000000012, -3.0000000000000018, -1.700000000000001, -1.700000000000001, -2.2000000000000015, -2.1000000000000014, -1.600000000000001, -2.5000000000000018, -2.3000000000000016, -2.5000000000000018, -1.600000000000001, -1.700000000000001, -2.4000000000000017, -2.3000000000000016, -1.5000000000000009, -2.3000000000000016, -1.9000000000000012, -2.0000000000000013, -1.9000000000000012, -1.700000000000001, -1.8000000000000012, -1.9000000000000012, -2.1000000000000014, -1.4000000000000008, -1.5000000000000009, -1.5000000000000009, -1.4000000000000008, -1.5000000000000009, -1.9000000000000012, -1.600000000000001, -1.600000000000001, -1.9000000000000012, -2.1000000000000014, -1.8000000000000012, -2.0000000000000013, -2.3000000000000016, -2.2000000000000015, -1.8000000000000012, -1.5000000000000009, -1.8000000000000012, -1.600000000000001, -2.0000000000000013, -1.5000000000000009, -1.4000000000000008, -1.8000000000000012, -1.5000000000000009, -1.8000000000000012, -2.1000000000000014, -1.4000000000000008, -1.5000000000000009, -1.8000000000000012, -1.8000000000000012, -1.600000000000001, -1.700000000000001, -2.0000000000000013, -1.8000000000000012, -2.2000000000000015, -2.0000000000000013, -2.3000000000000016, -1.5000000000000009, -1.4000000000000008, -2.0000000000000013, -2.3000000000000016, -1.5000000000000009, -1.8000000000000012, -1.700000000000001, -1.8000000000000012, -1.5000000000000009, -1.700000000000001, -1.600000000000001, -1.600000000000001, -1.600000000000001, -1.4000000000000008, -1.700000000000001, -59.50000000000037, -1.600000000000001, -2.700000000000002, -2.0000000000000013, -1.9000000000000012, -1.700000000000001, -1.8000000000000012, -1.5000000000000009, -1.700000000000001, -1.5000000000000009, -1.5000000000000009, -2.2000000000000015, -2.2000000000000015, -1.8000000000000012, -1.600000000000001, -2.3000000000000016, -1.700000000000001, -1.9000000000000012, -1.700000000000001, -1.9000000000000012, -1.4000000000000008, -1.8000000000000012, -2.0000000000000013, -3.200000000000001, -2.3000000000000016, -1.600000000000001, -1.9000000000000012, -2.4000000000000017, -1.8000000000000012], "episode_lengths": [31, 31, 28, 28, 33, 30, 33, 32, 25, 30, 29, 35, 28, 28, 33, 32, 27, 36, 34, 36, 27, 28, 35, 34, 26, 34, 30, 31, 30, 28, 29, 30, 32, 25, 26, 26, 25, 26, 30, 27, 27, 30, 32, 29, 31, 34, 33, 29, 26, 29, 27, 31, 26, 25, 29, 26, 29, 32, 25, 26, 29, 29, 27, 28, 31, 29, 33, 31, 34, 26, 25, 31, 34, 26, 29, 28, 29, 26, 28, 27, 27, 27, 25, 28, 400, 27, 38, 31, 30, 28, 29, 26, 28, 26, 26, 33, 33, 29, 27, 34, 28, 30, 28, 30, 25, 29, 31, 43, 34, 27, 30, 35, 29]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.27708591935856014, "mean_inference_ms": 0.6218675449256387, "mean_action_processing_ms": 0.06809385249806794, "mean_env_wait_ms": 6.543841691678732, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005756226261105158, "StateBufferConnector_ms": 0.0033034687548612073, "ViewRequirementAgentConnector_ms": 0.07471299804417433}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 184000, "num_agent_steps_trained": 184000, "num_env_steps_sampled": 184000, "num_env_steps_trained": 184000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 330.85683302955056, "num_env_steps_trained_throughput_per_sec": 330.85683302955056, "timesteps_total": 184000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 184000, "timers": {"training_iteration_time_ms": 11979.446, "sample_time_ms": 8524.031, "load_time_ms": 1.009, "load_throughput": 3965120.061, "learn_time_ms": 3450.881, "learn_throughput": 1159.124, "synch_weights_time_ms": 2.898}, "counters": {"num_env_steps_sampled": 184000, "num_env_steps_trained": 184000, "num_agent_steps_sampled": 184000, "num_agent_steps_trained": 184000}, "done": false, "episodes_total": 2815, "training_iteration": 46, "trial_id": "dbefe_00000", "date": "2024-03-07_12-21-01", "timestamp": 1709832061, "time_this_iter_s": 12.09231424331665, "time_total_s": 512.8547656536102, "pid": 103980, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fcd19c36f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 512.8547656536102, "iterations_since_restore": 46, "perf": {"cpu_util_percent": 19.60625, "ram_util_percent": 43.58125, "gpu_util_percent0": 0.07625, "vram_util_percent0": 0.10046895345052083}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.10000000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 3.7979542746699306, "policy_loss": -0.004245573114002904, "vf_loss": 3.800838389259673, "vf_explained_var": 0.16776421371326652, "kl": 0.013614490399112417, "entropy": 0.49632147959163114, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 43245.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 188000, "num_env_steps_trained": 188000, "num_agent_steps_sampled": 188000, "num_agent_steps_trained": 188000}, "sampler_results": {"episode_reward_max": -1.4000000000000008, "episode_reward_min": -64.50000000000047, "episode_reward_mean": -3.6930000000000125, "episode_len_mean": 42.41, "episode_media": {}, "episodes_this_iter": 82, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2.2000000000000015, -2.2000000000000015, -1.8000000000000012, -1.600000000000001, -2.3000000000000016, -1.700000000000001, -1.9000000000000012, -1.700000000000001, -1.9000000000000012, -1.4000000000000008, -1.8000000000000012, -2.0000000000000013, -3.200000000000001, -2.3000000000000016, -1.600000000000001, -1.9000000000000012, -2.4000000000000017, -1.8000000000000012, -1.8000000000000012, -1.5000000000000009, -2.1000000000000014, -1.700000000000001, -2.1000000000000014, -1.5000000000000009, -2.1000000000000014, -1.700000000000001, -1.8000000000000012, -1.600000000000001, -1.700000000000001, -1.600000000000001, -1.600000000000001, -22.699999999999985, -1.4000000000000008, -2.0000000000000013, -1.600000000000001, -1.9000000000000012, -1.8000000000000012, -1.8000000000000012, -1.600000000000001, -2.0000000000000013, -1.700000000000001, -1.700000000000001, -2.0000000000000013, -4.400000000000002, -1.5000000000000009, -7.799999999999997, -2.2000000000000015, -4.900000000000004, -1.8000000000000012, -1.700000000000001, -1.700000000000001, -2.1000000000000014, -1.8000000000000012, -2.5000000000000018, -1.8000000000000012, -1.9000000000000012, -1.8000000000000012, -1.8000000000000012, -1.9000000000000012, -64.50000000000047, -2.0000000000000013, -1.4000000000000008, -1.600000000000001, -1.4000000000000008, -1.700000000000001, -1.5000000000000009, -2.0000000000000013, -1.8000000000000012, -43.20000000000032, -49.10000000000044, -2.0000000000000013, -1.8000000000000012, -1.600000000000001, -1.8000000000000012, -1.5000000000000009, -1.4000000000000008, -2.0000000000000013, -1.8000000000000012, -6.100000000000004, -1.4000000000000008, -1.8000000000000012, -1.4000000000000008, -1.9000000000000012, -1.700000000000001, -1.700000000000001, -1.5000000000000009, -2.4000000000000017, -1.700000000000001, -1.5000000000000009, -1.600000000000001, -1.8000000000000012, -1.8000000000000012, -1.9000000000000012, -1.600000000000001, -2.1000000000000014, -1.700000000000001, -1.4000000000000008, -2.0000000000000013, -2.2000000000000015, -1.700000000000001], "episode_lengths": [33, 33, 29, 27, 34, 28, 30, 28, 30, 25, 29, 31, 43, 34, 27, 30, 35, 29, 29, 26, 32, 28, 32, 26, 32, 28, 29, 27, 28, 27, 27, 171, 25, 31, 27, 30, 29, 29, 27, 31, 28, 28, 31, 43, 26, 65, 33, 49, 29, 28, 28, 32, 29, 36, 29, 30, 29, 29, 30, 400, 31, 25, 27, 25, 28, 26, 31, 29, 383, 400, 31, 29, 27, 29, 26, 25, 31, 29, 52, 25, 29, 25, 30, 28, 28, 26, 35, 28, 26, 27, 29, 29, 30, 27, 32, 28, 25, 31, 33, 28]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.28025472611239527, "mean_inference_ms": 0.6224979857608909, "mean_action_processing_ms": 0.0684961007104012, "mean_env_wait_ms": 6.561040350740089, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005701303482055664, "StateBufferConnector_ms": 0.0032987594604492188, "ViewRequirementAgentConnector_ms": 0.07493805885314941}}, "episode_reward_max": -1.4000000000000008, "episode_reward_min": -64.50000000000047, "episode_reward_mean": -3.6930000000000125, "episode_len_mean": 42.41, "episodes_this_iter": 82, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-2.2000000000000015, -2.2000000000000015, -1.8000000000000012, -1.600000000000001, -2.3000000000000016, -1.700000000000001, -1.9000000000000012, -1.700000000000001, -1.9000000000000012, -1.4000000000000008, -1.8000000000000012, -2.0000000000000013, -3.200000000000001, -2.3000000000000016, -1.600000000000001, -1.9000000000000012, -2.4000000000000017, -1.8000000000000012, -1.8000000000000012, -1.5000000000000009, -2.1000000000000014, -1.700000000000001, -2.1000000000000014, -1.5000000000000009, -2.1000000000000014, -1.700000000000001, -1.8000000000000012, -1.600000000000001, -1.700000000000001, -1.600000000000001, -1.600000000000001, -22.699999999999985, -1.4000000000000008, -2.0000000000000013, -1.600000000000001, -1.9000000000000012, -1.8000000000000012, -1.8000000000000012, -1.600000000000001, -2.0000000000000013, -1.700000000000001, -1.700000000000001, -2.0000000000000013, -4.400000000000002, -1.5000000000000009, -7.799999999999997, -2.2000000000000015, -4.900000000000004, -1.8000000000000012, -1.700000000000001, -1.700000000000001, -2.1000000000000014, -1.8000000000000012, -2.5000000000000018, -1.8000000000000012, -1.9000000000000012, -1.8000000000000012, -1.8000000000000012, -1.9000000000000012, -64.50000000000047, -2.0000000000000013, -1.4000000000000008, -1.600000000000001, -1.4000000000000008, -1.700000000000001, -1.5000000000000009, -2.0000000000000013, -1.8000000000000012, -43.20000000000032, -49.10000000000044, -2.0000000000000013, -1.8000000000000012, -1.600000000000001, -1.8000000000000012, -1.5000000000000009, -1.4000000000000008, -2.0000000000000013, -1.8000000000000012, -6.100000000000004, -1.4000000000000008, -1.8000000000000012, -1.4000000000000008, -1.9000000000000012, -1.700000000000001, -1.700000000000001, -1.5000000000000009, -2.4000000000000017, -1.700000000000001, -1.5000000000000009, -1.600000000000001, -1.8000000000000012, -1.8000000000000012, -1.9000000000000012, -1.600000000000001, -2.1000000000000014, -1.700000000000001, -1.4000000000000008, -2.0000000000000013, -2.2000000000000015, -1.700000000000001], "episode_lengths": [33, 33, 29, 27, 34, 28, 30, 28, 30, 25, 29, 31, 43, 34, 27, 30, 35, 29, 29, 26, 32, 28, 32, 26, 32, 28, 29, 27, 28, 27, 27, 171, 25, 31, 27, 30, 29, 29, 27, 31, 28, 28, 31, 43, 26, 65, 33, 49, 29, 28, 28, 32, 29, 36, 29, 30, 29, 29, 30, 400, 31, 25, 27, 25, 28, 26, 31, 29, 383, 400, 31, 29, 27, 29, 26, 25, 31, 29, 52, 25, 29, 25, 30, 28, 28, 26, 35, 28, 26, 27, 29, 29, 30, 27, 32, 28, 25, 31, 33, 28]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.28025472611239527, "mean_inference_ms": 0.6224979857608909, "mean_action_processing_ms": 0.0684961007104012, "mean_env_wait_ms": 6.561040350740089, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005701303482055664, "StateBufferConnector_ms": 0.0032987594604492188, "ViewRequirementAgentConnector_ms": 0.07493805885314941}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 188000, "num_agent_steps_trained": 188000, "num_env_steps_sampled": 188000, "num_env_steps_trained": 188000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 340.4165177942698, "num_env_steps_trained_throughput_per_sec": 340.4165177942698, "timesteps_total": 188000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 188000, "timers": {"training_iteration_time_ms": 11970.565, "sample_time_ms": 8518.667, "load_time_ms": 0.98, "load_throughput": 4082445.007, "learn_time_ms": 3447.393, "learn_throughput": 1160.297, "synch_weights_time_ms": 2.898}, "counters": {"num_env_steps_sampled": 188000, "num_env_steps_trained": 188000, "num_agent_steps_sampled": 188000, "num_agent_steps_trained": 188000}, "done": false, "episodes_total": 2897, "training_iteration": 47, "trial_id": "dbefe_00000", "date": "2024-03-07_12-21-13", "timestamp": 1709832073, "time_this_iter_s": 11.752880334854126, "time_total_s": 524.6076459884644, "pid": 103980, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fcd19c36f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 524.6076459884644, "iterations_since_restore": 47, "perf": {"cpu_util_percent": 20.186666666666667, "ram_util_percent": 43.53333333333333, "gpu_util_percent0": 0.07200000000000001, "vram_util_percent0": 0.09871419270833331}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.10000000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 2.3271974887098037, "policy_loss": -0.006652457887927691, "vf_loss": 2.332780899892571, "vf_explained_var": 0.3578234238009299, "kl": 0.010690461341473749, "entropy": 0.4046384010744351, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 44175.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 192000, "num_env_steps_trained": 192000, "num_agent_steps_sampled": 192000, "num_agent_steps_trained": 192000}, "sampler_results": {"episode_reward_max": -1.4000000000000008, "episode_reward_min": -72.80000000000052, "episode_reward_mean": -3.9209523809523894, "episode_len_mean": 40.838095238095235, "episode_media": {}, "episodes_this_iter": 105, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-64.60000000000039, -12.499999999999984, -3.3000000000000007, -1.5000000000000009, -1.8000000000000012, -1.9000000000000012, -1.9000000000000012, -1.700000000000001, -1.5000000000000009, -1.5000000000000009, -1.8000000000000012, -1.600000000000001, -2.1000000000000014, -4.699999999999997, -1.8000000000000012, -1.4000000000000008, -2.600000000000002, -1.4000000000000008, -1.4000000000000008, -1.700000000000001, -72.80000000000052, -1.600000000000001, -1.8000000000000012, -1.8000000000000012, -2.2000000000000015, -1.8000000000000012, -1.4000000000000008, -2.0000000000000013, -1.700000000000001, -1.4000000000000008, -1.700000000000001, -2.0000000000000013, -1.600000000000001, -1.700000000000001, -1.5000000000000009, -1.700000000000001, -1.9000000000000012, -1.600000000000001, -1.600000000000001, -18.29999999999999, -2.4000000000000017, -1.9000000000000012, -1.9000000000000012, -1.600000000000001, -1.8000000000000012, -1.4000000000000008, -2.1000000000000014, -1.600000000000001, -1.8000000000000012, -1.600000000000001, -1.8000000000000012, -2.1000000000000014, -2.1000000000000014, -1.600000000000001, -1.600000000000001, -3.8999999999999986, -2.5000000000000018, -1.9000000000000012, -1.9000000000000012, -1.9000000000000012, -1.4000000000000008, -8.299999999999983, -2.3000000000000016, -1.700000000000001, -1.9000000000000012, -1.5000000000000009, -1.5000000000000009, -2.0000000000000013, -1.700000000000001, -2.1000000000000014, -1.700000000000001, -1.8000000000000012, -1.5000000000000009, -21.199999999999957, -1.4000000000000008, -1.5000000000000009, -1.9000000000000012, -1.600000000000001, -1.600000000000001, -1.5000000000000009, -1.9000000000000012, -1.8000000000000012, -1.600000000000001, -2.4000000000000017, -1.4000000000000008, -35.49999999999999, -1.8000000000000012, -1.600000000000001, -1.4000000000000008, -1.9000000000000012, -1.600000000000001, -1.700000000000001, -1.4000000000000008, -1.9000000000000012, -1.8000000000000012, -1.9000000000000012, -1.600000000000001, -2.3000000000000016, -1.700000000000001, -1.4000000000000008, -1.4000000000000008, -1.5000000000000009, -1.4000000000000008, -2.600000000000002, -1.9000000000000012], "episode_lengths": [400, 94, 43, 26, 29, 30, 30, 28, 26, 26, 29, 27, 32, 56, 29, 25, 37, 25, 25, 28, 400, 27, 29, 29, 33, 29, 25, 31, 28, 25, 28, 31, 27, 28, 26, 28, 30, 27, 27, 120, 32, 30, 30, 27, 29, 25, 32, 27, 29, 27, 29, 32, 32, 27, 27, 50, 36, 30, 30, 30, 25, 92, 34, 28, 30, 26, 26, 31, 28, 32, 28, 29, 26, 125, 25, 26, 30, 27, 27, 26, 30, 29, 27, 35, 25, 200, 29, 27, 25, 30, 27, 28, 25, 30, 29, 30, 27, 34, 28, 25, 25, 26, 25, 37, 30]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2794196074476504, "mean_inference_ms": 0.6223755087942816, "mean_action_processing_ms": 0.06805432347765406, "mean_env_wait_ms": 6.574820845953804, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005658467610677083, "StateBufferConnector_ms": 0.0033085686819893973, "ViewRequirementAgentConnector_ms": 0.07445925757998512}}, "episode_reward_max": -1.4000000000000008, "episode_reward_min": -72.80000000000052, "episode_reward_mean": -3.9209523809523894, "episode_len_mean": 40.838095238095235, "episodes_this_iter": 105, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-64.60000000000039, -12.499999999999984, -3.3000000000000007, -1.5000000000000009, -1.8000000000000012, -1.9000000000000012, -1.9000000000000012, -1.700000000000001, -1.5000000000000009, -1.5000000000000009, -1.8000000000000012, -1.600000000000001, -2.1000000000000014, -4.699999999999997, -1.8000000000000012, -1.4000000000000008, -2.600000000000002, -1.4000000000000008, -1.4000000000000008, -1.700000000000001, -72.80000000000052, -1.600000000000001, -1.8000000000000012, -1.8000000000000012, -2.2000000000000015, -1.8000000000000012, -1.4000000000000008, -2.0000000000000013, -1.700000000000001, -1.4000000000000008, -1.700000000000001, -2.0000000000000013, -1.600000000000001, -1.700000000000001, -1.5000000000000009, -1.700000000000001, -1.9000000000000012, -1.600000000000001, -1.600000000000001, -18.29999999999999, -2.4000000000000017, -1.9000000000000012, -1.9000000000000012, -1.600000000000001, -1.8000000000000012, -1.4000000000000008, -2.1000000000000014, -1.600000000000001, -1.8000000000000012, -1.600000000000001, -1.8000000000000012, -2.1000000000000014, -2.1000000000000014, -1.600000000000001, -1.600000000000001, -3.8999999999999986, -2.5000000000000018, -1.9000000000000012, -1.9000000000000012, -1.9000000000000012, -1.4000000000000008, -8.299999999999983, -2.3000000000000016, -1.700000000000001, -1.9000000000000012, -1.5000000000000009, -1.5000000000000009, -2.0000000000000013, -1.700000000000001, -2.1000000000000014, -1.700000000000001, -1.8000000000000012, -1.5000000000000009, -21.199999999999957, -1.4000000000000008, -1.5000000000000009, -1.9000000000000012, -1.600000000000001, -1.600000000000001, -1.5000000000000009, -1.9000000000000012, -1.8000000000000012, -1.600000000000001, -2.4000000000000017, -1.4000000000000008, -35.49999999999999, -1.8000000000000012, -1.600000000000001, -1.4000000000000008, -1.9000000000000012, -1.600000000000001, -1.700000000000001, -1.4000000000000008, -1.9000000000000012, -1.8000000000000012, -1.9000000000000012, -1.600000000000001, -2.3000000000000016, -1.700000000000001, -1.4000000000000008, -1.4000000000000008, -1.5000000000000009, -1.4000000000000008, -2.600000000000002, -1.9000000000000012], "episode_lengths": [400, 94, 43, 26, 29, 30, 30, 28, 26, 26, 29, 27, 32, 56, 29, 25, 37, 25, 25, 28, 400, 27, 29, 29, 33, 29, 25, 31, 28, 25, 28, 31, 27, 28, 26, 28, 30, 27, 27, 120, 32, 30, 30, 27, 29, 25, 32, 27, 29, 27, 29, 32, 32, 27, 27, 50, 36, 30, 30, 30, 25, 92, 34, 28, 30, 26, 26, 31, 28, 32, 28, 29, 26, 125, 25, 26, 30, 27, 27, 26, 30, 29, 27, 35, 25, 200, 29, 27, 25, 30, 27, 28, 25, 30, 29, 30, 27, 34, 28, 25, 25, 26, 25, 37, 30]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2794196074476504, "mean_inference_ms": 0.6223755087942816, "mean_action_processing_ms": 0.06805432347765406, "mean_env_wait_ms": 6.574820845953804, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005658467610677083, "StateBufferConnector_ms": 0.0033085686819893973, "ViewRequirementAgentConnector_ms": 0.07445925757998512}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 192000, "num_agent_steps_trained": 192000, "num_env_steps_sampled": 192000, "num_env_steps_trained": 192000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 337.80691694903294, "num_env_steps_trained_throughput_per_sec": 337.80691694903294, "timesteps_total": 192000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 192000, "timers": {"training_iteration_time_ms": 11982.475, "sample_time_ms": 8518.193, "load_time_ms": 0.978, "load_throughput": 4091804.302, "learn_time_ms": 3458.584, "learn_throughput": 1156.543, "synch_weights_time_ms": 4.078}, "counters": {"num_env_steps_sampled": 192000, "num_env_steps_trained": 192000, "num_agent_steps_sampled": 192000, "num_agent_steps_trained": 192000}, "done": false, "episodes_total": 3002, "training_iteration": 48, "trial_id": "dbefe_00000", "date": "2024-03-07_12-21-25", "timestamp": 1709832085, "time_this_iter_s": 11.844453573226929, "time_total_s": 536.4520995616913, "pid": 103980, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fcd19c36f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 536.4520995616913, "iterations_since_restore": 48, "perf": {"cpu_util_percent": 19.606250000000003, "ram_util_percent": 43.53125, "gpu_util_percent0": 0.07749999999999999, "vram_util_percent0": 0.09871419270833333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.10000000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 1.8037038037618522, "policy_loss": -0.002404090902337464, "vf_loss": 1.805399558728721, "vf_explained_var": 0.3751666835559312, "kl": 0.007083324900670659, "entropy": 0.38162689829064955, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 45105.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 196000, "num_env_steps_trained": 196000, "num_agent_steps_sampled": 196000, "num_agent_steps_trained": 196000}, "sampler_results": {"episode_reward_max": -1.4000000000000008, "episode_reward_min": -75.90000000000055, "episode_reward_mean": -3.7754716981132197, "episode_len_mean": 40.094339622641506, "episode_media": {}, "episodes_this_iter": 106, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-75.90000000000055, -2.0000000000000013, -1.9000000000000012, -1.9000000000000012, -1.5000000000000009, -1.8000000000000012, -2.2000000000000015, -1.5000000000000009, -1.5000000000000009, -1.600000000000001, -1.4000000000000008, -1.4000000000000008, -1.5000000000000009, -1.4000000000000008, -1.8000000000000012, -1.5000000000000009, -1.5000000000000009, -1.600000000000001, -2.5000000000000018, -1.8000000000000012, -2.0000000000000013, -1.4000000000000008, -1.5000000000000009, -1.5000000000000009, -1.600000000000001, -1.700000000000001, -1.700000000000001, -3.8999999999999995, -1.700000000000001, -1.5000000000000009, -2.2000000000000015, -1.600000000000001, -1.8000000000000012, -2.0000000000000013, -1.4000000000000008, -1.8000000000000012, -1.600000000000001, -1.5000000000000009, -1.5000000000000009, -1.4000000000000008, -1.8000000000000012, -1.700000000000001, -1.4000000000000008, -1.600000000000001, -1.9000000000000012, -2.3000000000000016, -1.600000000000001, -1.4000000000000008, -2.3000000000000016, -1.9000000000000012, -1.4000000000000008, -2.0000000000000013, -1.8000000000000012, -1.4000000000000008, -1.600000000000001, -2.1000000000000014, -2.700000000000002, -2.0000000000000013, -1.700000000000001, -1.5000000000000009, -1.9000000000000012, -1.4000000000000008, -2.1000000000000014, -1.8000000000000012, -1.4000000000000008, -1.8000000000000012, -1.700000000000001, -1.8000000000000012, -1.4000000000000008, -1.5000000000000009, -1.700000000000001, -1.8000000000000012, -2.2000000000000015, -1.700000000000001, -1.600000000000001, -2.900000000000002, -1.8000000000000012, -1.5000000000000009, -2.1000000000000014, -1.8000000000000012, -1.5000000000000009, -63.100000000000406, -1.600000000000001, -2.1000000000000014, -1.9000000000000012, -50.5000000000002, -1.600000000000001, -2.2000000000000015, -1.700000000000001, -2.1000000000000014, -3.0000000000000018, -1.700000000000001, -1.700000000000001, -1.700000000000001, -1.600000000000001, -2.1000000000000014, -1.9000000000000012, -1.4000000000000008, -2.0000000000000013, -1.8000000000000012, -1.700000000000001, -1.5000000000000009, -29.100000000000023, -1.700000000000001, -1.600000000000001, -1.9000000000000012], "episode_lengths": [400, 31, 30, 30, 26, 29, 33, 26, 26, 27, 25, 25, 26, 25, 29, 26, 26, 27, 36, 29, 31, 25, 26, 26, 27, 28, 28, 44, 28, 26, 33, 27, 29, 31, 25, 29, 27, 26, 26, 25, 29, 28, 25, 27, 30, 34, 27, 25, 34, 30, 25, 31, 29, 25, 27, 32, 38, 31, 28, 26, 30, 25, 32, 29, 25, 29, 28, 29, 25, 26, 28, 29, 33, 28, 27, 40, 29, 26, 32, 29, 26, 400, 27, 32, 30, 314, 27, 33, 28, 32, 41, 28, 28, 28, 27, 32, 30, 25, 31, 29, 28, 26, 204, 28, 27, 30]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.28060887198449536, "mean_inference_ms": 0.6222151614947039, "mean_action_processing_ms": 0.06807175601379366, "mean_env_wait_ms": 6.579728532009128, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005533785190222398, "StateBufferConnector_ms": 0.0032748816148290096, "ViewRequirementAgentConnector_ms": 0.07410926638909106}}, "episode_reward_max": -1.4000000000000008, "episode_reward_min": -75.90000000000055, "episode_reward_mean": -3.7754716981132197, "episode_len_mean": 40.094339622641506, "episodes_this_iter": 106, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-75.90000000000055, -2.0000000000000013, -1.9000000000000012, -1.9000000000000012, -1.5000000000000009, -1.8000000000000012, -2.2000000000000015, -1.5000000000000009, -1.5000000000000009, -1.600000000000001, -1.4000000000000008, -1.4000000000000008, -1.5000000000000009, -1.4000000000000008, -1.8000000000000012, -1.5000000000000009, -1.5000000000000009, -1.600000000000001, -2.5000000000000018, -1.8000000000000012, -2.0000000000000013, -1.4000000000000008, -1.5000000000000009, -1.5000000000000009, -1.600000000000001, -1.700000000000001, -1.700000000000001, -3.8999999999999995, -1.700000000000001, -1.5000000000000009, -2.2000000000000015, -1.600000000000001, -1.8000000000000012, -2.0000000000000013, -1.4000000000000008, -1.8000000000000012, -1.600000000000001, -1.5000000000000009, -1.5000000000000009, -1.4000000000000008, -1.8000000000000012, -1.700000000000001, -1.4000000000000008, -1.600000000000001, -1.9000000000000012, -2.3000000000000016, -1.600000000000001, -1.4000000000000008, -2.3000000000000016, -1.9000000000000012, -1.4000000000000008, -2.0000000000000013, -1.8000000000000012, -1.4000000000000008, -1.600000000000001, -2.1000000000000014, -2.700000000000002, -2.0000000000000013, -1.700000000000001, -1.5000000000000009, -1.9000000000000012, -1.4000000000000008, -2.1000000000000014, -1.8000000000000012, -1.4000000000000008, -1.8000000000000012, -1.700000000000001, -1.8000000000000012, -1.4000000000000008, -1.5000000000000009, -1.700000000000001, -1.8000000000000012, -2.2000000000000015, -1.700000000000001, -1.600000000000001, -2.900000000000002, -1.8000000000000012, -1.5000000000000009, -2.1000000000000014, -1.8000000000000012, -1.5000000000000009, -63.100000000000406, -1.600000000000001, -2.1000000000000014, -1.9000000000000012, -50.5000000000002, -1.600000000000001, -2.2000000000000015, -1.700000000000001, -2.1000000000000014, -3.0000000000000018, -1.700000000000001, -1.700000000000001, -1.700000000000001, -1.600000000000001, -2.1000000000000014, -1.9000000000000012, -1.4000000000000008, -2.0000000000000013, -1.8000000000000012, -1.700000000000001, -1.5000000000000009, -29.100000000000023, -1.700000000000001, -1.600000000000001, -1.9000000000000012], "episode_lengths": [400, 31, 30, 30, 26, 29, 33, 26, 26, 27, 25, 25, 26, 25, 29, 26, 26, 27, 36, 29, 31, 25, 26, 26, 27, 28, 28, 44, 28, 26, 33, 27, 29, 31, 25, 29, 27, 26, 26, 25, 29, 28, 25, 27, 30, 34, 27, 25, 34, 30, 25, 31, 29, 25, 27, 32, 38, 31, 28, 26, 30, 25, 32, 29, 25, 29, 28, 29, 25, 26, 28, 29, 33, 28, 27, 40, 29, 26, 32, 29, 26, 400, 27, 32, 30, 314, 27, 33, 28, 32, 41, 28, 28, 28, 27, 32, 30, 25, 31, 29, 28, 26, 204, 28, 27, 30]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.28060887198449536, "mean_inference_ms": 0.6222151614947039, "mean_action_processing_ms": 0.06807175601379366, "mean_env_wait_ms": 6.579728532009128, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005533785190222398, "StateBufferConnector_ms": 0.0032748816148290096, "ViewRequirementAgentConnector_ms": 0.07410926638909106}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 196000, "num_agent_steps_trained": 196000, "num_env_steps_sampled": 196000, "num_env_steps_trained": 196000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 332.5354593552435, "num_env_steps_trained_throughput_per_sec": 332.5354593552435, "timesteps_total": 196000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 196000, "timers": {"training_iteration_time_ms": 11989.555, "sample_time_ms": 8524.335, "load_time_ms": 0.973, "load_throughput": 4110551.513, "learn_time_ms": 3459.517, "learn_throughput": 1156.231, "synch_weights_time_ms": 4.083}, "counters": {"num_env_steps_sampled": 196000, "num_env_steps_trained": 196000, "num_agent_steps_sampled": 196000, "num_agent_steps_trained": 196000}, "done": false, "episodes_total": 3108, "training_iteration": 49, "trial_id": "dbefe_00000", "date": "2024-03-07_12-21-37", "timestamp": 1709832097, "time_this_iter_s": 12.03140664100647, "time_total_s": 548.4835062026978, "pid": 103980, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fcd19c36f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 548.4835062026978, "iterations_since_restore": 49, "perf": {"cpu_util_percent": 20.660000000000004, "ram_util_percent": 43.50666666666667, "gpu_util_percent0": 0.06866666666666667, "vram_util_percent0": 0.09871419270833331}}
{"evaluation": {"sampler_results": {"episode_reward_max": -1.4000000000000008, "episode_reward_min": -20.899999999999956, "episode_reward_mean": -2.7899999999999987, "episode_len_mean": 34.1, "episode_media": {}, "episodes_this_iter": 20, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1.8000000000000012, -1.8000000000000012, -1.600000000000001, -2.3000000000000016, -2.1000000000000014, -20.899999999999956, -1.5000000000000009, -1.9000000000000012, -2.1000000000000014, -2.600000000000002, -1.9000000000000012, -2.1000000000000014, -1.9000000000000012, -1.600000000000001, -1.8000000000000012, -1.5000000000000009, -1.9000000000000012, -1.4000000000000008, -1.5000000000000009, -1.600000000000001], "episode_lengths": [29, 29, 27, 34, 32, 124, 26, 30, 32, 37, 30, 32, 30, 27, 29, 26, 30, 25, 26, 27]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3404187946682618, "mean_inference_ms": 1.1153078009408532, "mean_action_processing_ms": 0.06546213197498685, "mean_env_wait_ms": 7.127012375682201, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004614591598510742, "StateBufferConnector_ms": 0.002677440643310547, "ViewRequirementAgentConnector_ms": 0.06442666053771973}}, "episode_reward_max": -1.4000000000000008, "episode_reward_min": -20.899999999999956, "episode_reward_mean": -2.7899999999999987, "episode_len_mean": 34.1, "episode_media": {}, "episodes_this_iter": 20, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1.8000000000000012, -1.8000000000000012, -1.600000000000001, -2.3000000000000016, -2.1000000000000014, -20.899999999999956, -1.5000000000000009, -1.9000000000000012, -2.1000000000000014, -2.600000000000002, -1.9000000000000012, -2.1000000000000014, -1.9000000000000012, -1.600000000000001, -1.8000000000000012, -1.5000000000000009, -1.9000000000000012, -1.4000000000000008, -1.5000000000000009, -1.600000000000001], "episode_lengths": [29, 29, 27, 34, 32, 124, 26, 30, 32, 37, 30, 32, 30, 27, 29, 26, 30, 25, 26, 27]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3404187946682618, "mean_inference_ms": 1.1153078009408532, "mean_action_processing_ms": 0.06546213197498685, "mean_env_wait_ms": 7.127012375682201, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004614591598510742, "StateBufferConnector_ms": 0.002677440643310547, "ViewRequirementAgentConnector_ms": 0.06442666053771973}, "num_agent_steps_sampled_this_iter": 682, "num_env_steps_sampled_this_iter": 682, "timesteps_this_iter": 682, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.10000000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 0.7909931243252715, "policy_loss": -0.002674522584364299, "vf_loss": 0.7928184319913427, "vf_explained_var": 0.5636351133546521, "kl": 0.008492165999938966, "entropy": 0.2922114659701624, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 46035.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 200000, "num_env_steps_trained": 200000, "num_agent_steps_sampled": 200000, "num_agent_steps_trained": 200000}, "sampler_results": {"episode_reward_max": -1.4000000000000008, "episode_reward_min": -71.40000000000047, "episode_reward_mean": -2.3790322580645213, "episode_len_mean": 31.862903225806452, "episode_media": {}, "episodes_this_iter": 124, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1.600000000000001, -1.700000000000001, -1.8000000000000012, -1.5000000000000009, -1.5000000000000009, -2.1000000000000014, -2.3000000000000016, -1.5000000000000009, -1.8000000000000012, -1.600000000000001, -1.8000000000000012, -1.9000000000000012, -1.5000000000000009, -2.2000000000000015, -1.5000000000000009, -1.600000000000001, -71.40000000000047, -1.5000000000000009, -1.700000000000001, -2.0000000000000013, -1.600000000000001, -1.8000000000000012, -1.4000000000000008, -8.000000000000002, -1.700000000000001, -1.8000000000000012, -1.8000000000000012, -1.4000000000000008, -1.4000000000000008, -2.1000000000000014, -2.800000000000002, -1.4000000000000008, -1.700000000000001, -1.4000000000000008, -2.1000000000000014, -2.1000000000000014, -1.9000000000000012, -1.700000000000001, -1.8000000000000012, -1.8000000000000012, -1.8000000000000012, -2.4000000000000017, -1.8000000000000012, -1.4000000000000008, -1.8000000000000012, -1.4000000000000008, -1.8000000000000012, -1.8000000000000012, -1.600000000000001, -1.700000000000001, -1.700000000000001, -2.1000000000000014, -1.700000000000001, -1.8000000000000012, -2.0000000000000013, -1.9000000000000012, -2.0000000000000013, -1.600000000000001, -1.8000000000000012, -1.600000000000001, -1.600000000000001, -2.0000000000000013, -1.4000000000000008, -2.4000000000000017, -1.5000000000000009, -1.700000000000001, -1.600000000000001, -2.5000000000000018, -1.5000000000000009, -2.1000000000000014, -1.600000000000001, -1.5000000000000009, -1.4000000000000008, -1.700000000000001, -1.600000000000001, -2.0000000000000013, -1.4000000000000008, -1.600000000000001, -1.600000000000001, -2.800000000000002, -1.8000000000000012, -1.4000000000000008, -1.9000000000000012, -1.600000000000001, -1.9000000000000012, -1.8000000000000012, -1.600000000000001, -1.8000000000000012, -2.0000000000000013, -1.8000000000000012, -2.0000000000000013, -1.600000000000001, -1.700000000000001, -3.0000000000000018, -1.4000000000000008, -2.0000000000000013, -1.600000000000001, -1.5000000000000009, -2.0000000000000013, -1.700000000000001, -1.9000000000000012, -1.9000000000000012, -1.8000000000000012, -1.8000000000000012, -1.5000000000000009, -1.5000000000000009, -1.4000000000000008, -1.4000000000000008, -1.600000000000001, -1.8000000000000012, -1.5000000000000009, -1.4000000000000008, -1.5000000000000009, -1.5000000000000009, -1.9000000000000012, -2.0000000000000013, -1.5000000000000009, -1.700000000000001, -3.5, -1.8000000000000012, -1.600000000000001, -1.700000000000001, -1.8000000000000012, -1.5000000000000009], "episode_lengths": [27, 28, 29, 26, 26, 32, 34, 26, 29, 27, 29, 30, 26, 33, 26, 27, 400, 26, 28, 31, 27, 29, 25, 62, 28, 29, 29, 25, 25, 32, 39, 25, 28, 25, 32, 32, 30, 28, 29, 29, 29, 32, 29, 25, 29, 25, 29, 29, 27, 28, 28, 32, 28, 29, 31, 30, 31, 27, 29, 27, 27, 31, 25, 35, 26, 28, 27, 36, 26, 32, 27, 26, 25, 28, 27, 31, 25, 27, 27, 39, 29, 25, 30, 27, 30, 29, 27, 29, 31, 29, 31, 27, 28, 37, 25, 31, 27, 26, 31, 28, 30, 30, 29, 29, 26, 26, 25, 25, 27, 29, 26, 25, 26, 26, 30, 31, 26, 28, 44, 29, 27, 28, 29, 26]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.28326453250847883, "mean_inference_ms": 0.6229789145374994, "mean_action_processing_ms": 0.06816468411789786, "mean_env_wait_ms": 6.6032948458955305, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005784150092832504, "StateBufferConnector_ms": 0.0033632401497133316, "ViewRequirementAgentConnector_ms": 0.07549178215765184}}, "episode_reward_max": -1.4000000000000008, "episode_reward_min": -71.40000000000047, "episode_reward_mean": -2.3790322580645213, "episode_len_mean": 31.862903225806452, "episodes_this_iter": 124, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1.600000000000001, -1.700000000000001, -1.8000000000000012, -1.5000000000000009, -1.5000000000000009, -2.1000000000000014, -2.3000000000000016, -1.5000000000000009, -1.8000000000000012, -1.600000000000001, -1.8000000000000012, -1.9000000000000012, -1.5000000000000009, -2.2000000000000015, -1.5000000000000009, -1.600000000000001, -71.40000000000047, -1.5000000000000009, -1.700000000000001, -2.0000000000000013, -1.600000000000001, -1.8000000000000012, -1.4000000000000008, -8.000000000000002, -1.700000000000001, -1.8000000000000012, -1.8000000000000012, -1.4000000000000008, -1.4000000000000008, -2.1000000000000014, -2.800000000000002, -1.4000000000000008, -1.700000000000001, -1.4000000000000008, -2.1000000000000014, -2.1000000000000014, -1.9000000000000012, -1.700000000000001, -1.8000000000000012, -1.8000000000000012, -1.8000000000000012, -2.4000000000000017, -1.8000000000000012, -1.4000000000000008, -1.8000000000000012, -1.4000000000000008, -1.8000000000000012, -1.8000000000000012, -1.600000000000001, -1.700000000000001, -1.700000000000001, -2.1000000000000014, -1.700000000000001, -1.8000000000000012, -2.0000000000000013, -1.9000000000000012, -2.0000000000000013, -1.600000000000001, -1.8000000000000012, -1.600000000000001, -1.600000000000001, -2.0000000000000013, -1.4000000000000008, -2.4000000000000017, -1.5000000000000009, -1.700000000000001, -1.600000000000001, -2.5000000000000018, -1.5000000000000009, -2.1000000000000014, -1.600000000000001, -1.5000000000000009, -1.4000000000000008, -1.700000000000001, -1.600000000000001, -2.0000000000000013, -1.4000000000000008, -1.600000000000001, -1.600000000000001, -2.800000000000002, -1.8000000000000012, -1.4000000000000008, -1.9000000000000012, -1.600000000000001, -1.9000000000000012, -1.8000000000000012, -1.600000000000001, -1.8000000000000012, -2.0000000000000013, -1.8000000000000012, -2.0000000000000013, -1.600000000000001, -1.700000000000001, -3.0000000000000018, -1.4000000000000008, -2.0000000000000013, -1.600000000000001, -1.5000000000000009, -2.0000000000000013, -1.700000000000001, -1.9000000000000012, -1.9000000000000012, -1.8000000000000012, -1.8000000000000012, -1.5000000000000009, -1.5000000000000009, -1.4000000000000008, -1.4000000000000008, -1.600000000000001, -1.8000000000000012, -1.5000000000000009, -1.4000000000000008, -1.5000000000000009, -1.5000000000000009, -1.9000000000000012, -2.0000000000000013, -1.5000000000000009, -1.700000000000001, -3.5, -1.8000000000000012, -1.600000000000001, -1.700000000000001, -1.8000000000000012, -1.5000000000000009], "episode_lengths": [27, 28, 29, 26, 26, 32, 34, 26, 29, 27, 29, 30, 26, 33, 26, 27, 400, 26, 28, 31, 27, 29, 25, 62, 28, 29, 29, 25, 25, 32, 39, 25, 28, 25, 32, 32, 30, 28, 29, 29, 29, 32, 29, 25, 29, 25, 29, 29, 27, 28, 28, 32, 28, 29, 31, 30, 31, 27, 29, 27, 27, 31, 25, 35, 26, 28, 27, 36, 26, 32, 27, 26, 25, 28, 27, 31, 25, 27, 27, 39, 29, 25, 30, 27, 30, 29, 27, 29, 31, 29, 31, 27, 28, 37, 25, 31, 27, 26, 31, 28, 30, 30, 29, 29, 26, 26, 25, 25, 27, 29, 26, 25, 26, 26, 30, 31, 26, 28, 44, 29, 27, 28, 29, 26]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.28326453250847883, "mean_inference_ms": 0.6229789145374994, "mean_action_processing_ms": 0.06816468411789786, "mean_env_wait_ms": 6.6032948458955305, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005784150092832504, "StateBufferConnector_ms": 0.0033632401497133316, "ViewRequirementAgentConnector_ms": 0.07549178215765184}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 200000, "num_agent_steps_trained": 200000, "num_env_steps_sampled": 200000, "num_env_steps_trained": 200000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 328.49648056883257, "num_env_steps_trained_throughput_per_sec": 328.49648056883257, "timesteps_total": 200000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 200000, "timers": {"training_iteration_time_ms": 12005.874, "sample_time_ms": 8551.034, "load_time_ms": 0.976, "load_throughput": 4097400.479, "learn_time_ms": 3449.131, "learn_throughput": 1159.712, "synch_weights_time_ms": 4.084}, "counters": {"num_env_steps_sampled": 200000, "num_env_steps_trained": 200000, "num_agent_steps_sampled": 200000, "num_agent_steps_trained": 200000}, "done": true, "episodes_total": 3232, "training_iteration": 50, "trial_id": "dbefe_00000", "date": "2024-03-07_12-21-55", "timestamp": 1709832115, "time_this_iter_s": 18.09886074066162, "time_total_s": 566.5823669433594, "pid": 103980, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fcd19c36f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 566.5823669433594, "iterations_since_restore": 50, "perf": {"cpu_util_percent": 16.120833333333334, "ram_util_percent": 43.54583333333333, "gpu_util_percent0": 0.05875, "vram_util_percent0": 0.09871419270833333}}
