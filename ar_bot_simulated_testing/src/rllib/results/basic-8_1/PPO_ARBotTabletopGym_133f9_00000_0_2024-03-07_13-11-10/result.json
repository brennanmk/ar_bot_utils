{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 8.200939992358608, "policy_loss": 0.008027300583098524, "vf_loss": 8.19172301779511, "vf_explained_var": -0.007327945129845732, "kl": 0.0059483239457016855, "entropy": 1.0926854932180015, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 465.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000}, "sampler_results": {"episode_reward_max": -6.099999999999991, "episode_reward_min": -69.50000000000051, "episode_reward_mean": -51.160000000000316, "episode_len_mean": 332.9, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-63.800000000000445, -66.90000000000043, -69.50000000000051, -58.10000000000033, -55.20000000000032, -58.300000000000395, -7.599999999999991, -57.800000000000296, -68.30000000000045, -6.099999999999991], "episode_lengths": [400, 400, 400, 400, 376, 400, 81, 400, 400, 72]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23322252932184942, "mean_inference_ms": 0.7262469289783471, "mean_action_processing_ms": 0.07754195474103062, "mean_env_wait_ms": 6.381138356145985, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007925033569335938, "StateBufferConnector_ms": 0.004067420959472656, "ViewRequirementAgentConnector_ms": 0.0914454460144043}}, "episode_reward_max": -6.099999999999991, "episode_reward_min": -69.50000000000051, "episode_reward_mean": -51.160000000000316, "episode_len_mean": 332.9, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-63.800000000000445, -66.90000000000043, -69.50000000000051, -58.10000000000033, -55.20000000000032, -58.300000000000395, -7.599999999999991, -57.800000000000296, -68.30000000000045, -6.099999999999991], "episode_lengths": [400, 400, 400, 400, 376, 400, 81, 400, 400, 72]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23322252932184942, "mean_inference_ms": 0.7262469289783471, "mean_action_processing_ms": 0.07754195474103062, "mean_env_wait_ms": 6.381138356145985, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007925033569335938, "StateBufferConnector_ms": 0.004067420959472656, "ViewRequirementAgentConnector_ms": 0.0914454460144043}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 541.3016347666753, "num_env_steps_trained_throughput_per_sec": 541.3016347666753, "timesteps_total": 4000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 4000, "timers": {"training_iteration_time_ms": 7389.531, "sample_time_ms": 3827.115, "load_time_ms": 0.938, "load_throughput": 4264671.073, "learn_time_ms": 3558.27, "learn_throughput": 1124.142, "synch_weights_time_ms": 2.421}, "counters": {"num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000}, "done": false, "episodes_total": 10, "training_iteration": 1, "trial_id": "133f9_00000", "date": "2024-03-07_13-11-24", "timestamp": 1709835084, "time_this_iter_s": 7.391911745071411, "time_total_s": 7.391911745071411, "pid": 117779, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7efea6399f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 7.391911745071411, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 28.07, "ram_util_percent": 50.4, "gpu_util_percent0": 0.073, "vram_util_percent0": 0.09354654947916666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 6.813352344834035, "policy_loss": 0.0025048428245129126, "vf_loss": 6.8097709591670705, "vf_explained_var": -0.21299331598384405, "kl": 0.005382754345826996, "entropy": 1.081392764788802, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 1395.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000}, "sampler_results": {"episode_reward_max": -6.099999999999991, "episode_reward_min": -69.50000000000051, "episode_reward_mean": -45.53636363636388, "episode_len_mean": 310.3181818181818, "episode_media": {}, "episodes_this_iter": 12, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-63.800000000000445, -66.90000000000043, -69.50000000000051, -58.10000000000033, -55.20000000000032, -58.300000000000395, -7.599999999999991, -57.800000000000296, -68.30000000000045, -6.099999999999991, -21.800000000000004, -61.80000000000041, -48.500000000000185, -60.60000000000036, -38.60000000000014, -11.69999999999997, -56.600000000000286, -53.200000000000294, -10.799999999999978, -60.40000000000037, -57.00000000000034, -9.19999999999998], "episode_lengths": [400, 400, 400, 400, 376, 400, 81, 400, 400, 72, 179, 400, 309, 400, 298, 115, 400, 400, 114, 400, 380, 103]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2338178317184134, "mean_inference_ms": 0.7266626404370005, "mean_action_processing_ms": 0.07762273919203032, "mean_env_wait_ms": 6.365132635622154, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007320534099232067, "StateBufferConnector_ms": 0.0040877949107776985, "ViewRequirementAgentConnector_ms": 0.0915007157759233}}, "episode_reward_max": -6.099999999999991, "episode_reward_min": -69.50000000000051, "episode_reward_mean": -45.53636363636388, "episode_len_mean": 310.3181818181818, "episodes_this_iter": 12, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-63.800000000000445, -66.90000000000043, -69.50000000000051, -58.10000000000033, -55.20000000000032, -58.300000000000395, -7.599999999999991, -57.800000000000296, -68.30000000000045, -6.099999999999991, -21.800000000000004, -61.80000000000041, -48.500000000000185, -60.60000000000036, -38.60000000000014, -11.69999999999997, -56.600000000000286, -53.200000000000294, -10.799999999999978, -60.40000000000037, -57.00000000000034, -9.19999999999998], "episode_lengths": [400, 400, 400, 400, 376, 400, 81, 400, 400, 72, 179, 400, 309, 400, 298, 115, 400, 400, 114, 400, 380, 103]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2338178317184134, "mean_inference_ms": 0.7266626404370005, "mean_action_processing_ms": 0.07762273919203032, "mean_env_wait_ms": 6.365132635622154, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007320534099232067, "StateBufferConnector_ms": 0.0040877949107776985, "ViewRequirementAgentConnector_ms": 0.0915007157759233}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 552.9685793831103, "num_env_steps_trained_throughput_per_sec": 552.9685793831103, "timesteps_total": 8000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 8000, "timers": {"training_iteration_time_ms": 7311.587, "sample_time_ms": 3804.314, "load_time_ms": 0.924, "load_throughput": 4328487.1, "learn_time_ms": 3503.151, "learn_throughput": 1141.829, "synch_weights_time_ms": 2.471}, "counters": {"num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000}, "done": false, "episodes_total": 22, "training_iteration": 2, "trial_id": "133f9_00000", "date": "2024-03-07_13-11-32", "timestamp": 1709835092, "time_this_iter_s": 7.236050844192505, "time_total_s": 14.627962589263916, "pid": 117779, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7efea6399f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 14.627962589263916, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 30.533333333333328, "ram_util_percent": 50.7, "gpu_util_percent0": 0.08222222222222222, "vram_util_percent0": 0.09393084490740741}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 6.18502395539144, "policy_loss": -0.0005367018682982332, "vf_loss": 6.184271217994793, "vf_explained_var": -0.1917881913082574, "kl": 0.006447272123165363, "entropy": 1.0705148149562138, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 2325.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000}, "sampler_results": {"episode_reward_max": -6.099999999999991, "episode_reward_min": -69.50000000000051, "episode_reward_mean": -42.3114285714288, "episode_len_mean": 300.9428571428571, "episode_media": {}, "episodes_this_iter": 13, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-63.800000000000445, -66.90000000000043, -69.50000000000051, -58.10000000000033, -55.20000000000032, -58.300000000000395, -7.599999999999991, -57.800000000000296, -68.30000000000045, -6.099999999999991, -21.800000000000004, -61.80000000000041, -48.500000000000185, -60.60000000000036, -38.60000000000014, -11.69999999999997, -56.600000000000286, -53.200000000000294, -10.799999999999978, -60.40000000000037, -57.00000000000034, -9.19999999999998, -52.90000000000035, -63.10000000000048, -49.60000000000019, -60.300000000000395, -15.099999999999966, -46.400000000000304, -36.00000000000022, -18.900000000000002, -50.90000000000043, -51.2000000000003, -10.799999999999974, -7.499999999999988, -16.399999999999974], "episode_lengths": [400, 400, 400, 400, 376, 400, 81, 400, 400, 72, 179, 400, 309, 400, 298, 115, 400, 400, 114, 400, 380, 103, 400, 400, 331, 400, 146, 400, 307, 164, 400, 400, 114, 85, 159]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23385571300467337, "mean_inference_ms": 0.7254614103883013, "mean_action_processing_ms": 0.07727133067094465, "mean_env_wait_ms": 6.356145733480908, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007098061697823661, "StateBufferConnector_ms": 0.0040830884660993305, "ViewRequirementAgentConnector_ms": 0.09091922215053014}}, "episode_reward_max": -6.099999999999991, "episode_reward_min": -69.50000000000051, "episode_reward_mean": -42.3114285714288, "episode_len_mean": 300.9428571428571, "episodes_this_iter": 13, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-63.800000000000445, -66.90000000000043, -69.50000000000051, -58.10000000000033, -55.20000000000032, -58.300000000000395, -7.599999999999991, -57.800000000000296, -68.30000000000045, -6.099999999999991, -21.800000000000004, -61.80000000000041, -48.500000000000185, -60.60000000000036, -38.60000000000014, -11.69999999999997, -56.600000000000286, -53.200000000000294, -10.799999999999978, -60.40000000000037, -57.00000000000034, -9.19999999999998, -52.90000000000035, -63.10000000000048, -49.60000000000019, -60.300000000000395, -15.099999999999966, -46.400000000000304, -36.00000000000022, -18.900000000000002, -50.90000000000043, -51.2000000000003, -10.799999999999974, -7.499999999999988, -16.399999999999974], "episode_lengths": [400, 400, 400, 400, 376, 400, 81, 400, 400, 72, 179, 400, 309, 400, 298, 115, 400, 400, 114, 400, 380, 103, 400, 400, 331, 400, 146, 400, 307, 164, 400, 400, 114, 85, 159]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23385571300467337, "mean_inference_ms": 0.7254614103883013, "mean_action_processing_ms": 0.07727133067094465, "mean_env_wait_ms": 6.356145733480908, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007098061697823661, "StateBufferConnector_ms": 0.0040830884660993305, "ViewRequirementAgentConnector_ms": 0.09091922215053014}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 555.2587726744846, "num_env_steps_trained_throughput_per_sec": 555.2587726744846, "timesteps_total": 12000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 12000, "timers": {"training_iteration_time_ms": 7275.659, "sample_time_ms": 3788.61, "load_time_ms": 0.927, "load_throughput": 4314387.794, "learn_time_ms": 3483.006, "learn_throughput": 1148.433, "synch_weights_time_ms": 2.428}, "counters": {"num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000}, "done": false, "episodes_total": 35, "training_iteration": 3, "trial_id": "133f9_00000", "date": "2024-03-07_13-11-39", "timestamp": 1709835099, "time_this_iter_s": 7.206111669540405, "time_total_s": 21.83407425880432, "pid": 117779, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7efea6399f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 21.83407425880432, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 28.29, "ram_util_percent": 50.7, "gpu_util_percent0": 0.091, "vram_util_percent0": 0.09395345052083333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 5.360784872453059, "policy_loss": -0.004685158254478568, "vf_loss": 5.36413310823902, "vf_explained_var": -0.16493333430700405, "kl": 0.0066846229225137645, "entropy": 1.0581204102244428, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 3255.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000}, "sampler_results": {"episode_reward_max": -6.099999999999991, "episode_reward_min": -71.10000000000045, "episode_reward_mean": -41.33600000000022, "episode_len_mean": 301.02, "episode_media": {}, "episodes_this_iter": 15, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-63.800000000000445, -66.90000000000043, -69.50000000000051, -58.10000000000033, -55.20000000000032, -58.300000000000395, -7.599999999999991, -57.800000000000296, -68.30000000000045, -6.099999999999991, -21.800000000000004, -61.80000000000041, -48.500000000000185, -60.60000000000036, -38.60000000000014, -11.69999999999997, -56.600000000000286, -53.200000000000294, -10.799999999999978, -60.40000000000037, -57.00000000000034, -9.19999999999998, -52.90000000000035, -63.10000000000048, -49.60000000000019, -60.300000000000395, -15.099999999999966, -46.400000000000304, -36.00000000000022, -18.900000000000002, -50.90000000000043, -51.2000000000003, -10.799999999999974, -7.499999999999988, -16.399999999999974, -52.00000000000028, -25.299999999999994, -49.90000000000033, -20.59999999999997, -7.099999999999987, -53.80000000000025, -57.700000000000415, -26.600000000000083, -53.10000000000044, -11.699999999999978, -71.10000000000045, -46.200000000000315, -33.10000000000001, -49.20000000000028, -28.5000000000001], "episode_lengths": [400, 400, 400, 400, 376, 400, 81, 400, 400, 72, 179, 400, 309, 400, 298, 115, 400, 400, 114, 400, 380, 103, 400, 400, 331, 400, 146, 400, 307, 164, 400, 400, 114, 85, 159, 400, 189, 400, 180, 82, 371, 400, 263, 400, 119, 400, 400, 265, 400, 249]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23402467324892556, "mean_inference_ms": 0.724721116652555, "mean_action_processing_ms": 0.07711618575279801, "mean_env_wait_ms": 6.351303695567526, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0069446563720703125, "StateBufferConnector_ms": 0.0040340423583984375, "ViewRequirementAgentConnector_ms": 0.09010505676269531}}, "episode_reward_max": -6.099999999999991, "episode_reward_min": -71.10000000000045, "episode_reward_mean": -41.33600000000022, "episode_len_mean": 301.02, "episodes_this_iter": 15, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-63.800000000000445, -66.90000000000043, -69.50000000000051, -58.10000000000033, -55.20000000000032, -58.300000000000395, -7.599999999999991, -57.800000000000296, -68.30000000000045, -6.099999999999991, -21.800000000000004, -61.80000000000041, -48.500000000000185, -60.60000000000036, -38.60000000000014, -11.69999999999997, -56.600000000000286, -53.200000000000294, -10.799999999999978, -60.40000000000037, -57.00000000000034, -9.19999999999998, -52.90000000000035, -63.10000000000048, -49.60000000000019, -60.300000000000395, -15.099999999999966, -46.400000000000304, -36.00000000000022, -18.900000000000002, -50.90000000000043, -51.2000000000003, -10.799999999999974, -7.499999999999988, -16.399999999999974, -52.00000000000028, -25.299999999999994, -49.90000000000033, -20.59999999999997, -7.099999999999987, -53.80000000000025, -57.700000000000415, -26.600000000000083, -53.10000000000044, -11.699999999999978, -71.10000000000045, -46.200000000000315, -33.10000000000001, -49.20000000000028, -28.5000000000001], "episode_lengths": [400, 400, 400, 400, 376, 400, 81, 400, 400, 72, 179, 400, 309, 400, 298, 115, 400, 400, 114, 400, 380, 103, 400, 400, 331, 400, 146, 400, 307, 164, 400, 400, 114, 85, 159, 400, 189, 400, 180, 82, 371, 400, 263, 400, 119, 400, 400, 265, 400, 249]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23402467324892556, "mean_inference_ms": 0.724721116652555, "mean_action_processing_ms": 0.07711618575279801, "mean_env_wait_ms": 6.351303695567526, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0069446563720703125, "StateBufferConnector_ms": 0.0040340423583984375, "ViewRequirementAgentConnector_ms": 0.09010505676269531}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 549.3118498205911, "num_env_steps_trained_throughput_per_sec": 549.3118498205911, "timesteps_total": 16000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 16000, "timers": {"training_iteration_time_ms": 7277.196, "sample_time_ms": 3794.243, "load_time_ms": 0.927, "load_throughput": 4313463.427, "learn_time_ms": 3478.913, "learn_throughput": 1149.784, "synch_weights_time_ms": 2.438}, "counters": {"num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000}, "done": false, "episodes_total": 50, "training_iteration": 4, "trial_id": "133f9_00000", "date": "2024-03-07_13-11-46", "timestamp": 1709835106, "time_this_iter_s": 7.284175395965576, "time_total_s": 29.118249654769897, "pid": 117779, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7efea6399f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 29.118249654769897, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 31.95555555555556, "ram_util_percent": 50.7, "gpu_util_percent0": 0.0811111111111111, "vram_util_percent0": 0.0939670138888889}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 5.10551587000329, "policy_loss": -0.00845901101266825, "vf_loss": 5.112673875280926, "vf_explained_var": -0.04553903008020052, "kl": 0.00650491264980662, "entropy": 1.0530060223353805, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 4185.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 20000}, "sampler_results": {"episode_reward_max": -5.099999999999994, "episode_reward_min": -71.10000000000045, "episode_reward_mean": -38.16562500000019, "episode_len_mean": 282.03125, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-63.800000000000445, -66.90000000000043, -69.50000000000051, -58.10000000000033, -55.20000000000032, -58.300000000000395, -7.599999999999991, -57.800000000000296, -68.30000000000045, -6.099999999999991, -21.800000000000004, -61.80000000000041, -48.500000000000185, -60.60000000000036, -38.60000000000014, -11.69999999999997, -56.600000000000286, -53.200000000000294, -10.799999999999978, -60.40000000000037, -57.00000000000034, -9.19999999999998, -52.90000000000035, -63.10000000000048, -49.60000000000019, -60.300000000000395, -15.099999999999966, -46.400000000000304, -36.00000000000022, -18.900000000000002, -50.90000000000043, -51.2000000000003, -10.799999999999974, -7.499999999999988, -16.399999999999974, -52.00000000000028, -25.299999999999994, -49.90000000000033, -20.59999999999997, -7.099999999999987, -53.80000000000025, -57.700000000000415, -26.600000000000083, -53.10000000000044, -11.699999999999978, -71.10000000000045, -46.200000000000315, -33.10000000000001, -49.20000000000028, -28.5000000000001, -8.399999999999983, -5.099999999999994, -13.399999999999968, -8.799999999999981, -24.899999999999984, -27.09999999999997, -7.999999999999984, -9.899999999999977, -63.40000000000041, -45.90000000000026, -43.400000000000325, -67.40000000000016, -32.600000000000065, -17.49999999999997], "episode_lengths": [400, 400, 400, 400, 376, 400, 81, 400, 400, 72, 179, 400, 309, 400, 298, 115, 400, 400, 114, 400, 380, 103, 400, 400, 331, 400, 146, 400, 307, 164, 400, 400, 114, 85, 159, 400, 189, 400, 180, 82, 371, 400, 263, 400, 119, 400, 400, 265, 400, 249, 95, 61, 122, 99, 194, 197, 91, 107, 400, 400, 400, 400, 277, 156]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23454323366225982, "mean_inference_ms": 0.7249566402661021, "mean_action_processing_ms": 0.07718713055505375, "mean_env_wait_ms": 6.351336121646256, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006851553916931152, "StateBufferConnector_ms": 0.0040005892515182495, "ViewRequirementAgentConnector_ms": 0.09017400443553925}}, "episode_reward_max": -5.099999999999994, "episode_reward_min": -71.10000000000045, "episode_reward_mean": -38.16562500000019, "episode_len_mean": 282.03125, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-63.800000000000445, -66.90000000000043, -69.50000000000051, -58.10000000000033, -55.20000000000032, -58.300000000000395, -7.599999999999991, -57.800000000000296, -68.30000000000045, -6.099999999999991, -21.800000000000004, -61.80000000000041, -48.500000000000185, -60.60000000000036, -38.60000000000014, -11.69999999999997, -56.600000000000286, -53.200000000000294, -10.799999999999978, -60.40000000000037, -57.00000000000034, -9.19999999999998, -52.90000000000035, -63.10000000000048, -49.60000000000019, -60.300000000000395, -15.099999999999966, -46.400000000000304, -36.00000000000022, -18.900000000000002, -50.90000000000043, -51.2000000000003, -10.799999999999974, -7.499999999999988, -16.399999999999974, -52.00000000000028, -25.299999999999994, -49.90000000000033, -20.59999999999997, -7.099999999999987, -53.80000000000025, -57.700000000000415, -26.600000000000083, -53.10000000000044, -11.699999999999978, -71.10000000000045, -46.200000000000315, -33.10000000000001, -49.20000000000028, -28.5000000000001, -8.399999999999983, -5.099999999999994, -13.399999999999968, -8.799999999999981, -24.899999999999984, -27.09999999999997, -7.999999999999984, -9.899999999999977, -63.40000000000041, -45.90000000000026, -43.400000000000325, -67.40000000000016, -32.600000000000065, -17.49999999999997], "episode_lengths": [400, 400, 400, 400, 376, 400, 81, 400, 400, 72, 179, 400, 309, 400, 298, 115, 400, 400, 114, 400, 380, 103, 400, 400, 331, 400, 146, 400, 307, 164, 400, 400, 114, 85, 159, 400, 189, 400, 180, 82, 371, 400, 263, 400, 119, 400, 400, 265, 400, 249, 95, 61, 122, 99, 194, 197, 91, 107, 400, 400, 400, 400, 277, 156]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23454323366225982, "mean_inference_ms": 0.7249566402661021, "mean_action_processing_ms": 0.07718713055505375, "mean_env_wait_ms": 6.351336121646256, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006851553916931152, "StateBufferConnector_ms": 0.0040005892515182495, "ViewRequirementAgentConnector_ms": 0.09017400443553925}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 20000, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 547.2196141441973, "num_env_steps_trained_throughput_per_sec": 547.2196141441973, "timesteps_total": 20000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 20000, "timers": {"training_iteration_time_ms": 7283.686, "sample_time_ms": 3796.031, "load_time_ms": 0.937, "load_throughput": 4269880.892, "learn_time_ms": 3483.606, "learn_throughput": 1148.236, "synch_weights_time_ms": 2.445}, "counters": {"num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 20000}, "done": false, "episodes_total": 64, "training_iteration": 5, "trial_id": "133f9_00000", "date": "2024-03-07_13-11-53", "timestamp": 1709835113, "time_this_iter_s": 7.31196403503418, "time_total_s": 36.43021368980408, "pid": 117779, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7efea6399f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 36.43021368980408, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 29.1, "ram_util_percent": 50.730000000000004, "gpu_util_percent0": 0.099, "vram_util_percent0": 0.0939453125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 5.375560486444863, "policy_loss": -0.014851026325136102, "vf_loss": 5.389126496593798, "vf_explained_var": -0.14493791371263484, "kl": 0.00642512791444452, "entropy": 1.0494061585395567, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 5115.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000}, "sampler_results": {"episode_reward_max": -5.099999999999994, "episode_reward_min": -72.10000000000048, "episode_reward_mean": -36.80487804878067, "episode_len_mean": 277.0121951219512, "episode_media": {}, "episodes_this_iter": 18, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-63.800000000000445, -66.90000000000043, -69.50000000000051, -58.10000000000033, -55.20000000000032, -58.300000000000395, -7.599999999999991, -57.800000000000296, -68.30000000000045, -6.099999999999991, -21.800000000000004, -61.80000000000041, -48.500000000000185, -60.60000000000036, -38.60000000000014, -11.69999999999997, -56.600000000000286, -53.200000000000294, -10.799999999999978, -60.40000000000037, -57.00000000000034, -9.19999999999998, -52.90000000000035, -63.10000000000048, -49.60000000000019, -60.300000000000395, -15.099999999999966, -46.400000000000304, -36.00000000000022, -18.900000000000002, -50.90000000000043, -51.2000000000003, -10.799999999999974, -7.499999999999988, -16.399999999999974, -52.00000000000028, -25.299999999999994, -49.90000000000033, -20.59999999999997, -7.099999999999987, -53.80000000000025, -57.700000000000415, -26.600000000000083, -53.10000000000044, -11.699999999999978, -71.10000000000045, -46.200000000000315, -33.10000000000001, -49.20000000000028, -28.5000000000001, -8.399999999999983, -5.099999999999994, -13.399999999999968, -8.799999999999981, -24.899999999999984, -27.09999999999997, -7.999999999999984, -9.899999999999977, -63.40000000000041, -45.90000000000026, -43.400000000000325, -67.40000000000016, -32.600000000000065, -17.49999999999997, -20.80000000000004, -63.20000000000038, -42.20000000000022, -9.399999999999979, -72.10000000000048, -42.90000000000029, -27.000000000000128, -47.40000000000024, -55.10000000000025, -11.299999999999976, -5.499999999999993, -6.999999999999988, -27.200000000000117, -12.599999999999971, -19.79999999999996, -50.40000000000031, -47.90000000000034, -13.599999999999968], "episode_lengths": [400, 400, 400, 400, 376, 400, 81, 400, 400, 72, 179, 400, 309, 400, 298, 115, 400, 400, 114, 400, 380, 103, 400, 400, 331, 400, 146, 400, 307, 164, 400, 400, 114, 85, 159, 400, 189, 400, 180, 82, 371, 400, 263, 400, 119, 400, 400, 265, 400, 249, 95, 61, 122, 99, 194, 197, 91, 107, 400, 400, 400, 400, 277, 156, 219, 400, 380, 97, 400, 388, 257, 400, 400, 105, 65, 81, 266, 123, 166, 400, 400, 118]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23491307489051766, "mean_inference_ms": 0.7248182976314836, "mean_action_processing_ms": 0.07709565762674556, "mean_env_wait_ms": 6.356119558159722, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006748990314762767, "StateBufferConnector_ms": 0.003992057428127382, "ViewRequirementAgentConnector_ms": 0.0901431572146532}}, "episode_reward_max": -5.099999999999994, "episode_reward_min": -72.10000000000048, "episode_reward_mean": -36.80487804878067, "episode_len_mean": 277.0121951219512, "episodes_this_iter": 18, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-63.800000000000445, -66.90000000000043, -69.50000000000051, -58.10000000000033, -55.20000000000032, -58.300000000000395, -7.599999999999991, -57.800000000000296, -68.30000000000045, -6.099999999999991, -21.800000000000004, -61.80000000000041, -48.500000000000185, -60.60000000000036, -38.60000000000014, -11.69999999999997, -56.600000000000286, -53.200000000000294, -10.799999999999978, -60.40000000000037, -57.00000000000034, -9.19999999999998, -52.90000000000035, -63.10000000000048, -49.60000000000019, -60.300000000000395, -15.099999999999966, -46.400000000000304, -36.00000000000022, -18.900000000000002, -50.90000000000043, -51.2000000000003, -10.799999999999974, -7.499999999999988, -16.399999999999974, -52.00000000000028, -25.299999999999994, -49.90000000000033, -20.59999999999997, -7.099999999999987, -53.80000000000025, -57.700000000000415, -26.600000000000083, -53.10000000000044, -11.699999999999978, -71.10000000000045, -46.200000000000315, -33.10000000000001, -49.20000000000028, -28.5000000000001, -8.399999999999983, -5.099999999999994, -13.399999999999968, -8.799999999999981, -24.899999999999984, -27.09999999999997, -7.999999999999984, -9.899999999999977, -63.40000000000041, -45.90000000000026, -43.400000000000325, -67.40000000000016, -32.600000000000065, -17.49999999999997, -20.80000000000004, -63.20000000000038, -42.20000000000022, -9.399999999999979, -72.10000000000048, -42.90000000000029, -27.000000000000128, -47.40000000000024, -55.10000000000025, -11.299999999999976, -5.499999999999993, -6.999999999999988, -27.200000000000117, -12.599999999999971, -19.79999999999996, -50.40000000000031, -47.90000000000034, -13.599999999999968], "episode_lengths": [400, 400, 400, 400, 376, 400, 81, 400, 400, 72, 179, 400, 309, 400, 298, 115, 400, 400, 114, 400, 380, 103, 400, 400, 331, 400, 146, 400, 307, 164, 400, 400, 114, 85, 159, 400, 189, 400, 180, 82, 371, 400, 263, 400, 119, 400, 400, 265, 400, 249, 95, 61, 122, 99, 194, 197, 91, 107, 400, 400, 400, 400, 277, 156, 219, 400, 380, 97, 400, 388, 257, 400, 400, 105, 65, 81, 266, 123, 166, 400, 400, 118]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23491307489051766, "mean_inference_ms": 0.7248182976314836, "mean_action_processing_ms": 0.07709565762674556, "mean_env_wait_ms": 6.356119558159722, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006748990314762767, "StateBufferConnector_ms": 0.003992057428127382, "ViewRequirementAgentConnector_ms": 0.0901431572146532}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 537.0157945652473, "num_env_steps_trained_throughput_per_sec": 537.0157945652473, "timesteps_total": 24000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 24000, "timers": {"training_iteration_time_ms": 7311.162, "sample_time_ms": 3807.844, "load_time_ms": 0.936, "load_throughput": 4272091.669, "learn_time_ms": 3499.193, "learn_throughput": 1143.121, "synch_weights_time_ms": 2.53}, "counters": {"num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000}, "done": false, "episodes_total": 82, "training_iteration": 6, "trial_id": "133f9_00000", "date": "2024-03-07_13-12-01", "timestamp": 1709835121, "time_this_iter_s": 7.450937032699585, "time_total_s": 43.88115072250366, "pid": 117779, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7efea6399f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 43.88115072250366, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 31.077777777777776, "ram_util_percent": 50.74444444444444, "gpu_util_percent0": 0.08222222222222222, "vram_util_percent0": 0.0939308449074074}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 5.0926898698012035, "policy_loss": -0.012413220411987716, "vf_loss": 5.104001734205472, "vf_explained_var": -0.21823561588923138, "kl": 0.0055068547918019385, "entropy": 1.0417860020232457, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 6045.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 28000}, "sampler_results": {"episode_reward_max": -5.099999999999994, "episode_reward_min": -72.10000000000048, "episode_reward_mean": -34.50000000000016, "episode_len_mean": 264.35, "episode_media": {}, "episodes_this_iter": 19, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-66.90000000000043, -69.50000000000051, -58.10000000000033, -55.20000000000032, -58.300000000000395, -7.599999999999991, -57.800000000000296, -68.30000000000045, -6.099999999999991, -21.800000000000004, -61.80000000000041, -48.500000000000185, -60.60000000000036, -38.60000000000014, -11.69999999999997, -56.600000000000286, -53.200000000000294, -10.799999999999978, -60.40000000000037, -57.00000000000034, -9.19999999999998, -52.90000000000035, -63.10000000000048, -49.60000000000019, -60.300000000000395, -15.099999999999966, -46.400000000000304, -36.00000000000022, -18.900000000000002, -50.90000000000043, -51.2000000000003, -10.799999999999974, -7.499999999999988, -16.399999999999974, -52.00000000000028, -25.299999999999994, -49.90000000000033, -20.59999999999997, -7.099999999999987, -53.80000000000025, -57.700000000000415, -26.600000000000083, -53.10000000000044, -11.699999999999978, -71.10000000000045, -46.200000000000315, -33.10000000000001, -49.20000000000028, -28.5000000000001, -8.399999999999983, -5.099999999999994, -13.399999999999968, -8.799999999999981, -24.899999999999984, -27.09999999999997, -7.999999999999984, -9.899999999999977, -63.40000000000041, -45.90000000000026, -43.400000000000325, -67.40000000000016, -32.600000000000065, -17.49999999999997, -20.80000000000004, -63.20000000000038, -42.20000000000022, -9.399999999999979, -72.10000000000048, -42.90000000000029, -27.000000000000128, -47.40000000000024, -55.10000000000025, -11.299999999999976, -5.499999999999993, -6.999999999999988, -27.200000000000117, -12.599999999999971, -19.79999999999996, -50.40000000000031, -47.90000000000034, -13.599999999999968, -43.70000000000033, -44.50000000000028, -37.40000000000023, -8.99999999999998, -6.899999999999988, -13.599999999999971, -12.899999999999967, -13.899999999999972, -17.399999999999967, -65.9000000000004, -7.79999999999999, -9.899999999999977, -7.899999999999984, -26.10000000000005, -49.50000000000025, -50.000000000000384, -60.6000000000004, -11.69999999999997, -7.099999999999989], "episode_lengths": [400, 400, 400, 376, 400, 81, 400, 400, 72, 179, 400, 309, 400, 298, 115, 400, 400, 114, 400, 380, 103, 400, 400, 331, 400, 146, 400, 307, 164, 400, 400, 114, 85, 159, 400, 189, 400, 180, 82, 371, 400, 263, 400, 119, 400, 400, 265, 400, 249, 95, 61, 122, 99, 194, 197, 91, 107, 400, 400, 400, 400, 277, 156, 219, 400, 380, 97, 400, 388, 257, 400, 400, 105, 65, 81, 266, 123, 166, 400, 400, 118, 400, 400, 330, 98, 80, 123, 119, 122, 150, 400, 83, 110, 78, 229, 400, 400, 400, 119, 79]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23556890096099908, "mean_inference_ms": 0.7244255239823957, "mean_action_processing_ms": 0.07690115584954507, "mean_env_wait_ms": 6.360344026599111, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0066487789154052734, "StateBufferConnector_ms": 0.003987789154052734, "ViewRequirementAgentConnector_ms": 0.08984017372131348}}, "episode_reward_max": -5.099999999999994, "episode_reward_min": -72.10000000000048, "episode_reward_mean": -34.50000000000016, "episode_len_mean": 264.35, "episodes_this_iter": 19, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-66.90000000000043, -69.50000000000051, -58.10000000000033, -55.20000000000032, -58.300000000000395, -7.599999999999991, -57.800000000000296, -68.30000000000045, -6.099999999999991, -21.800000000000004, -61.80000000000041, -48.500000000000185, -60.60000000000036, -38.60000000000014, -11.69999999999997, -56.600000000000286, -53.200000000000294, -10.799999999999978, -60.40000000000037, -57.00000000000034, -9.19999999999998, -52.90000000000035, -63.10000000000048, -49.60000000000019, -60.300000000000395, -15.099999999999966, -46.400000000000304, -36.00000000000022, -18.900000000000002, -50.90000000000043, -51.2000000000003, -10.799999999999974, -7.499999999999988, -16.399999999999974, -52.00000000000028, -25.299999999999994, -49.90000000000033, -20.59999999999997, -7.099999999999987, -53.80000000000025, -57.700000000000415, -26.600000000000083, -53.10000000000044, -11.699999999999978, -71.10000000000045, -46.200000000000315, -33.10000000000001, -49.20000000000028, -28.5000000000001, -8.399999999999983, -5.099999999999994, -13.399999999999968, -8.799999999999981, -24.899999999999984, -27.09999999999997, -7.999999999999984, -9.899999999999977, -63.40000000000041, -45.90000000000026, -43.400000000000325, -67.40000000000016, -32.600000000000065, -17.49999999999997, -20.80000000000004, -63.20000000000038, -42.20000000000022, -9.399999999999979, -72.10000000000048, -42.90000000000029, -27.000000000000128, -47.40000000000024, -55.10000000000025, -11.299999999999976, -5.499999999999993, -6.999999999999988, -27.200000000000117, -12.599999999999971, -19.79999999999996, -50.40000000000031, -47.90000000000034, -13.599999999999968, -43.70000000000033, -44.50000000000028, -37.40000000000023, -8.99999999999998, -6.899999999999988, -13.599999999999971, -12.899999999999967, -13.899999999999972, -17.399999999999967, -65.9000000000004, -7.79999999999999, -9.899999999999977, -7.899999999999984, -26.10000000000005, -49.50000000000025, -50.000000000000384, -60.6000000000004, -11.69999999999997, -7.099999999999989], "episode_lengths": [400, 400, 400, 376, 400, 81, 400, 400, 72, 179, 400, 309, 400, 298, 115, 400, 400, 114, 400, 380, 103, 400, 400, 331, 400, 146, 400, 307, 164, 400, 400, 114, 85, 159, 400, 189, 400, 180, 82, 371, 400, 263, 400, 119, 400, 400, 265, 400, 249, 95, 61, 122, 99, 194, 197, 91, 107, 400, 400, 400, 400, 277, 156, 219, 400, 380, 97, 400, 388, 257, 400, 400, 105, 65, 81, 266, 123, 166, 400, 400, 118, 400, 400, 330, 98, 80, 123, 119, 122, 150, 400, 83, 110, 78, 229, 400, 400, 400, 119, 79]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23556890096099908, "mean_inference_ms": 0.7244255239823957, "mean_action_processing_ms": 0.07690115584954507, "mean_env_wait_ms": 6.360344026599111, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0066487789154052734, "StateBufferConnector_ms": 0.003987789154052734, "ViewRequirementAgentConnector_ms": 0.08984017372131348}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 28000, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 534.5487807796104, "num_env_steps_trained_throughput_per_sec": 534.5487807796104, "timesteps_total": 28000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 28000, "timers": {"training_iteration_time_ms": 7335.699, "sample_time_ms": 3836.521, "load_time_ms": 0.941, "load_throughput": 4249548.126, "learn_time_ms": 3494.967, "learn_throughput": 1144.503, "synch_weights_time_ms": 2.612}, "counters": {"num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 28000}, "done": false, "episodes_total": 101, "training_iteration": 7, "trial_id": "133f9_00000", "date": "2024-03-07_13-12-08", "timestamp": 1709835128, "time_this_iter_s": 7.485340356826782, "time_total_s": 51.366491079330444, "pid": 117779, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7efea6399f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 51.366491079330444, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 28.82, "ram_util_percent": 50.71, "gpu_util_percent0": 0.08499999999999999, "vram_util_percent0": 0.09396158854166667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 4.871283811971705, "policy_loss": -0.01877543059408024, "vf_loss": 4.888803690287375, "vf_explained_var": -0.16078209736013926, "kl": 0.006277761978425916, "entropy": 1.03560738146946, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 6975.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000}, "sampler_results": {"episode_reward_max": -5.099999999999994, "episode_reward_min": -72.10000000000048, "episode_reward_mean": -30.521000000000136, "episode_len_mean": 245.67, "episode_media": {}, "episodes_this_iter": 18, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-60.40000000000037, -57.00000000000034, -9.19999999999998, -52.90000000000035, -63.10000000000048, -49.60000000000019, -60.300000000000395, -15.099999999999966, -46.400000000000304, -36.00000000000022, -18.900000000000002, -50.90000000000043, -51.2000000000003, -10.799999999999974, -7.499999999999988, -16.399999999999974, -52.00000000000028, -25.299999999999994, -49.90000000000033, -20.59999999999997, -7.099999999999987, -53.80000000000025, -57.700000000000415, -26.600000000000083, -53.10000000000044, -11.699999999999978, -71.10000000000045, -46.200000000000315, -33.10000000000001, -49.20000000000028, -28.5000000000001, -8.399999999999983, -5.099999999999994, -13.399999999999968, -8.799999999999981, -24.899999999999984, -27.09999999999997, -7.999999999999984, -9.899999999999977, -63.40000000000041, -45.90000000000026, -43.400000000000325, -67.40000000000016, -32.600000000000065, -17.49999999999997, -20.80000000000004, -63.20000000000038, -42.20000000000022, -9.399999999999979, -72.10000000000048, -42.90000000000029, -27.000000000000128, -47.40000000000024, -55.10000000000025, -11.299999999999976, -5.499999999999993, -6.999999999999988, -27.200000000000117, -12.599999999999971, -19.79999999999996, -50.40000000000031, -47.90000000000034, -13.599999999999968, -43.70000000000033, -44.50000000000028, -37.40000000000023, -8.99999999999998, -6.899999999999988, -13.599999999999971, -12.899999999999967, -13.899999999999972, -17.399999999999967, -65.9000000000004, -7.79999999999999, -9.899999999999977, -7.899999999999984, -26.10000000000005, -49.50000000000025, -50.000000000000384, -60.6000000000004, -11.69999999999997, -7.099999999999989, -14.099999999999962, -44.00000000000032, -34.80000000000015, -7.499999999999986, -41.10000000000028, -27.000000000000004, -8.699999999999983, -32.00000000000003, -17.200000000000003, -9.199999999999983, -5.999999999999991, -8.499999999999988, -52.10000000000023, -6.099999999999991, -5.799999999999992, -46.300000000000296, -5.8999999999999915, -47.20000000000034], "episode_lengths": [400, 380, 103, 400, 400, 331, 400, 146, 400, 307, 164, 400, 400, 114, 85, 159, 400, 189, 400, 180, 82, 371, 400, 263, 400, 119, 400, 400, 265, 400, 249, 95, 61, 122, 99, 194, 197, 91, 107, 400, 400, 400, 400, 277, 156, 219, 400, 380, 97, 400, 388, 257, 400, 400, 105, 65, 81, 266, 123, 166, 400, 400, 118, 400, 400, 330, 98, 80, 123, 119, 122, 150, 400, 83, 110, 78, 229, 400, 400, 400, 119, 79, 144, 400, 319, 86, 356, 241, 97, 251, 169, 100, 71, 87, 344, 72, 69, 400, 70, 400]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23656246832541306, "mean_inference_ms": 0.7241192843864794, "mean_action_processing_ms": 0.07677009623376263, "mean_env_wait_ms": 6.363474959241266, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0065076351165771484, "StateBufferConnector_ms": 0.0039670467376708984, "ViewRequirementAgentConnector_ms": 0.08971142768859863}}, "episode_reward_max": -5.099999999999994, "episode_reward_min": -72.10000000000048, "episode_reward_mean": -30.521000000000136, "episode_len_mean": 245.67, "episodes_this_iter": 18, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-60.40000000000037, -57.00000000000034, -9.19999999999998, -52.90000000000035, -63.10000000000048, -49.60000000000019, -60.300000000000395, -15.099999999999966, -46.400000000000304, -36.00000000000022, -18.900000000000002, -50.90000000000043, -51.2000000000003, -10.799999999999974, -7.499999999999988, -16.399999999999974, -52.00000000000028, -25.299999999999994, -49.90000000000033, -20.59999999999997, -7.099999999999987, -53.80000000000025, -57.700000000000415, -26.600000000000083, -53.10000000000044, -11.699999999999978, -71.10000000000045, -46.200000000000315, -33.10000000000001, -49.20000000000028, -28.5000000000001, -8.399999999999983, -5.099999999999994, -13.399999999999968, -8.799999999999981, -24.899999999999984, -27.09999999999997, -7.999999999999984, -9.899999999999977, -63.40000000000041, -45.90000000000026, -43.400000000000325, -67.40000000000016, -32.600000000000065, -17.49999999999997, -20.80000000000004, -63.20000000000038, -42.20000000000022, -9.399999999999979, -72.10000000000048, -42.90000000000029, -27.000000000000128, -47.40000000000024, -55.10000000000025, -11.299999999999976, -5.499999999999993, -6.999999999999988, -27.200000000000117, -12.599999999999971, -19.79999999999996, -50.40000000000031, -47.90000000000034, -13.599999999999968, -43.70000000000033, -44.50000000000028, -37.40000000000023, -8.99999999999998, -6.899999999999988, -13.599999999999971, -12.899999999999967, -13.899999999999972, -17.399999999999967, -65.9000000000004, -7.79999999999999, -9.899999999999977, -7.899999999999984, -26.10000000000005, -49.50000000000025, -50.000000000000384, -60.6000000000004, -11.69999999999997, -7.099999999999989, -14.099999999999962, -44.00000000000032, -34.80000000000015, -7.499999999999986, -41.10000000000028, -27.000000000000004, -8.699999999999983, -32.00000000000003, -17.200000000000003, -9.199999999999983, -5.999999999999991, -8.499999999999988, -52.10000000000023, -6.099999999999991, -5.799999999999992, -46.300000000000296, -5.8999999999999915, -47.20000000000034], "episode_lengths": [400, 380, 103, 400, 400, 331, 400, 146, 400, 307, 164, 400, 400, 114, 85, 159, 400, 189, 400, 180, 82, 371, 400, 263, 400, 119, 400, 400, 265, 400, 249, 95, 61, 122, 99, 194, 197, 91, 107, 400, 400, 400, 400, 277, 156, 219, 400, 380, 97, 400, 388, 257, 400, 400, 105, 65, 81, 266, 123, 166, 400, 400, 118, 400, 400, 330, 98, 80, 123, 119, 122, 150, 400, 83, 110, 78, 229, 400, 400, 400, 119, 79, 144, 400, 319, 86, 356, 241, 97, 251, 169, 100, 71, 87, 344, 72, 69, 400, 70, 400]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23656246832541306, "mean_inference_ms": 0.7241192843864794, "mean_action_processing_ms": 0.07677009623376263, "mean_env_wait_ms": 6.363474959241266, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0065076351165771484, "StateBufferConnector_ms": 0.0039670467376708984, "ViewRequirementAgentConnector_ms": 0.08971142768859863}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 548.0177687827266, "num_env_steps_trained_throughput_per_sec": 548.0177687827266, "timesteps_total": 32000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 32000, "timers": {"training_iteration_time_ms": 7331.11, "sample_time_ms": 3833.455, "load_time_ms": 0.941, "load_throughput": 4252510.234, "learn_time_ms": 3493.261, "learn_throughput": 1145.062, "synch_weights_time_ms": 2.767}, "counters": {"num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000}, "done": false, "episodes_total": 119, "training_iteration": 8, "trial_id": "133f9_00000", "date": "2024-03-07_13-12-16", "timestamp": 1709835136, "time_this_iter_s": 7.301610946655273, "time_total_s": 58.66810202598572, "pid": 117779, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7efea6399f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 58.66810202598572, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 28.75, "ram_util_percent": 50.7, "gpu_util_percent0": 0.092, "vram_util_percent0": 0.09396158854166667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 5.103340961663954, "policy_loss": -0.006804744747056756, "vf_loss": 5.10908656851739, "vf_explained_var": -0.13885651352585002, "kl": 0.005295685214827816, "entropy": 1.0249280500155624, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 7905.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000}, "sampler_results": {"episode_reward_max": -5.099999999999994, "episode_reward_min": -72.10000000000048, "episode_reward_mean": -28.28300000000012, "episode_len_mean": 236.52, "episode_media": {}, "episodes_this_iter": 19, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-20.59999999999997, -7.099999999999987, -53.80000000000025, -57.700000000000415, -26.600000000000083, -53.10000000000044, -11.699999999999978, -71.10000000000045, -46.200000000000315, -33.10000000000001, -49.20000000000028, -28.5000000000001, -8.399999999999983, -5.099999999999994, -13.399999999999968, -8.799999999999981, -24.899999999999984, -27.09999999999997, -7.999999999999984, -9.899999999999977, -63.40000000000041, -45.90000000000026, -43.400000000000325, -67.40000000000016, -32.600000000000065, -17.49999999999997, -20.80000000000004, -63.20000000000038, -42.20000000000022, -9.399999999999979, -72.10000000000048, -42.90000000000029, -27.000000000000128, -47.40000000000024, -55.10000000000025, -11.299999999999976, -5.499999999999993, -6.999999999999988, -27.200000000000117, -12.599999999999971, -19.79999999999996, -50.40000000000031, -47.90000000000034, -13.599999999999968, -43.70000000000033, -44.50000000000028, -37.40000000000023, -8.99999999999998, -6.899999999999988, -13.599999999999971, -12.899999999999967, -13.899999999999972, -17.399999999999967, -65.9000000000004, -7.79999999999999, -9.899999999999977, -7.899999999999984, -26.10000000000005, -49.50000000000025, -50.000000000000384, -60.6000000000004, -11.69999999999997, -7.099999999999989, -14.099999999999962, -44.00000000000032, -34.80000000000015, -7.499999999999986, -41.10000000000028, -27.000000000000004, -8.699999999999983, -32.00000000000003, -17.200000000000003, -9.199999999999983, -5.999999999999991, -8.499999999999988, -52.10000000000023, -6.099999999999991, -5.799999999999992, -46.300000000000296, -5.8999999999999915, -47.20000000000034, -19.1, -44.400000000000304, -29.90000000000002, -28.30000000000013, -7.099999999999987, -42.800000000000296, -10.899999999999974, -43.80000000000036, -37.20000000000024, -28.00000000000011, -6.899999999999988, -53.20000000000038, -10.099999999999977, -24.8000000000001, -20.399999999999967, -8.29999999999999, -46.10000000000034, -35.50000000000021, -12.29999999999997], "episode_lengths": [180, 82, 371, 400, 263, 400, 119, 400, 400, 265, 400, 249, 95, 61, 122, 99, 194, 197, 91, 107, 400, 400, 400, 400, 277, 156, 219, 400, 380, 97, 400, 388, 257, 400, 400, 105, 65, 81, 266, 123, 166, 400, 400, 118, 400, 400, 330, 98, 80, 123, 119, 122, 150, 400, 83, 110, 78, 229, 400, 400, 400, 119, 79, 144, 400, 319, 86, 356, 241, 97, 251, 169, 100, 71, 87, 344, 72, 69, 400, 70, 400, 171, 400, 259, 288, 82, 400, 114, 400, 349, 278, 80, 400, 106, 252, 154, 81, 400, 329, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2374053836364739, "mean_inference_ms": 0.7241203109360589, "mean_action_processing_ms": 0.07668207938494069, "mean_env_wait_ms": 6.369079215871714, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006520986557006836, "StateBufferConnector_ms": 0.003947019577026367, "ViewRequirementAgentConnector_ms": 0.08970451354980469}}, "episode_reward_max": -5.099999999999994, "episode_reward_min": -72.10000000000048, "episode_reward_mean": -28.28300000000012, "episode_len_mean": 236.52, "episodes_this_iter": 19, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-20.59999999999997, -7.099999999999987, -53.80000000000025, -57.700000000000415, -26.600000000000083, -53.10000000000044, -11.699999999999978, -71.10000000000045, -46.200000000000315, -33.10000000000001, -49.20000000000028, -28.5000000000001, -8.399999999999983, -5.099999999999994, -13.399999999999968, -8.799999999999981, -24.899999999999984, -27.09999999999997, -7.999999999999984, -9.899999999999977, -63.40000000000041, -45.90000000000026, -43.400000000000325, -67.40000000000016, -32.600000000000065, -17.49999999999997, -20.80000000000004, -63.20000000000038, -42.20000000000022, -9.399999999999979, -72.10000000000048, -42.90000000000029, -27.000000000000128, -47.40000000000024, -55.10000000000025, -11.299999999999976, -5.499999999999993, -6.999999999999988, -27.200000000000117, -12.599999999999971, -19.79999999999996, -50.40000000000031, -47.90000000000034, -13.599999999999968, -43.70000000000033, -44.50000000000028, -37.40000000000023, -8.99999999999998, -6.899999999999988, -13.599999999999971, -12.899999999999967, -13.899999999999972, -17.399999999999967, -65.9000000000004, -7.79999999999999, -9.899999999999977, -7.899999999999984, -26.10000000000005, -49.50000000000025, -50.000000000000384, -60.6000000000004, -11.69999999999997, -7.099999999999989, -14.099999999999962, -44.00000000000032, -34.80000000000015, -7.499999999999986, -41.10000000000028, -27.000000000000004, -8.699999999999983, -32.00000000000003, -17.200000000000003, -9.199999999999983, -5.999999999999991, -8.499999999999988, -52.10000000000023, -6.099999999999991, -5.799999999999992, -46.300000000000296, -5.8999999999999915, -47.20000000000034, -19.1, -44.400000000000304, -29.90000000000002, -28.30000000000013, -7.099999999999987, -42.800000000000296, -10.899999999999974, -43.80000000000036, -37.20000000000024, -28.00000000000011, -6.899999999999988, -53.20000000000038, -10.099999999999977, -24.8000000000001, -20.399999999999967, -8.29999999999999, -46.10000000000034, -35.50000000000021, -12.29999999999997], "episode_lengths": [180, 82, 371, 400, 263, 400, 119, 400, 400, 265, 400, 249, 95, 61, 122, 99, 194, 197, 91, 107, 400, 400, 400, 400, 277, 156, 219, 400, 380, 97, 400, 388, 257, 400, 400, 105, 65, 81, 266, 123, 166, 400, 400, 118, 400, 400, 330, 98, 80, 123, 119, 122, 150, 400, 83, 110, 78, 229, 400, 400, 400, 119, 79, 144, 400, 319, 86, 356, 241, 97, 251, 169, 100, 71, 87, 344, 72, 69, 400, 70, 400, 171, 400, 259, 288, 82, 400, 114, 400, 349, 278, 80, 400, 106, 252, 154, 81, 400, 329, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2374053836364739, "mean_inference_ms": 0.7241203109360589, "mean_action_processing_ms": 0.07668207938494069, "mean_env_wait_ms": 6.369079215871714, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006520986557006836, "StateBufferConnector_ms": 0.003947019577026367, "ViewRequirementAgentConnector_ms": 0.08970451354980469}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 551.9033644355183, "num_env_steps_trained_throughput_per_sec": 551.9033644355183, "timesteps_total": 36000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 36000, "timers": {"training_iteration_time_ms": 7321.833, "sample_time_ms": 3825.463, "load_time_ms": 0.94, "load_throughput": 4254936.85, "learn_time_ms": 3491.962, "learn_throughput": 1145.488, "synch_weights_time_ms": 2.786}, "counters": {"num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000}, "done": false, "episodes_total": 138, "training_iteration": 9, "trial_id": "133f9_00000", "date": "2024-03-07_13-12-23", "timestamp": 1709835143, "time_this_iter_s": 7.250144004821777, "time_total_s": 65.9182460308075, "pid": 117779, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7efea6399f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 65.9182460308075, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 30.966666666666672, "ram_util_percent": 50.73333333333333, "gpu_util_percent0": 0.09111111111111111, "vram_util_percent0": 0.09393988715277778}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 6.256063899429895, "policy_loss": -0.018305212179178833, "vf_loss": 6.273113270728818, "vf_explained_var": -0.2289017051778814, "kl": 0.0062792208849166715, "entropy": 1.0268379147334765, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 8835.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000}, "sampler_results": {"episode_reward_max": -4.999999999999995, "episode_reward_min": -72.10000000000048, "episode_reward_mean": -23.648000000000096, "episode_len_mean": 209.03, "episode_media": {}, "episodes_this_iter": 27, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-63.20000000000038, -42.20000000000022, -9.399999999999979, -72.10000000000048, -42.90000000000029, -27.000000000000128, -47.40000000000024, -55.10000000000025, -11.299999999999976, -5.499999999999993, -6.999999999999988, -27.200000000000117, -12.599999999999971, -19.79999999999996, -50.40000000000031, -47.90000000000034, -13.599999999999968, -43.70000000000033, -44.50000000000028, -37.40000000000023, -8.99999999999998, -6.899999999999988, -13.599999999999971, -12.899999999999967, -13.899999999999972, -17.399999999999967, -65.9000000000004, -7.79999999999999, -9.899999999999977, -7.899999999999984, -26.10000000000005, -49.50000000000025, -50.000000000000384, -60.6000000000004, -11.69999999999997, -7.099999999999989, -14.099999999999962, -44.00000000000032, -34.80000000000015, -7.499999999999986, -41.10000000000028, -27.000000000000004, -8.699999999999983, -32.00000000000003, -17.200000000000003, -9.199999999999983, -5.999999999999991, -8.499999999999988, -52.10000000000023, -6.099999999999991, -5.799999999999992, -46.300000000000296, -5.8999999999999915, -47.20000000000034, -19.1, -44.400000000000304, -29.90000000000002, -28.30000000000013, -7.099999999999987, -42.800000000000296, -10.899999999999974, -43.80000000000036, -37.20000000000024, -28.00000000000011, -6.899999999999988, -53.20000000000038, -10.099999999999977, -24.8000000000001, -20.399999999999967, -8.29999999999999, -46.10000000000034, -35.50000000000021, -12.29999999999997, -6.699999999999989, -6.29999999999999, -11.89999999999997, -14.299999999999969, -7.199999999999987, -6.29999999999999, -5.699999999999992, -9.699999999999978, -11.599999999999971, -7.999999999999984, -44.500000000000284, -41.30000000000031, -8.899999999999988, -6.19999999999999, -12.899999999999972, -6.799999999999988, -8.99999999999998, -31.800000000000182, -4.999999999999995, -8.199999999999983, -8.799999999999988, -28.700000000000113, -20.300000000000036, -6.699999999999989, -17.299999999999986, -40.60000000000031, -7.099999999999987], "episode_lengths": [400, 380, 97, 400, 388, 257, 400, 400, 105, 65, 81, 266, 123, 166, 400, 400, 118, 400, 400, 330, 98, 80, 123, 119, 122, 150, 400, 83, 110, 78, 229, 400, 400, 400, 119, 79, 144, 400, 319, 86, 356, 241, 97, 251, 169, 100, 71, 87, 344, 72, 69, 400, 70, 400, 171, 400, 259, 288, 82, 400, 114, 400, 349, 278, 80, 400, 106, 252, 154, 81, 400, 329, 120, 78, 74, 120, 140, 83, 74, 68, 108, 120, 91, 400, 400, 91, 73, 126, 79, 99, 325, 61, 93, 88, 275, 206, 78, 166, 400, 82]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23889791212402606, "mean_inference_ms": 0.7240664124343019, "mean_action_processing_ms": 0.07658120943990758, "mean_env_wait_ms": 6.376237597521626, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00653386116027832, "StateBufferConnector_ms": 0.003952503204345703, "ViewRequirementAgentConnector_ms": 0.08996129035949707}}, "episode_reward_max": -4.999999999999995, "episode_reward_min": -72.10000000000048, "episode_reward_mean": -23.648000000000096, "episode_len_mean": 209.03, "episodes_this_iter": 27, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-63.20000000000038, -42.20000000000022, -9.399999999999979, -72.10000000000048, -42.90000000000029, -27.000000000000128, -47.40000000000024, -55.10000000000025, -11.299999999999976, -5.499999999999993, -6.999999999999988, -27.200000000000117, -12.599999999999971, -19.79999999999996, -50.40000000000031, -47.90000000000034, -13.599999999999968, -43.70000000000033, -44.50000000000028, -37.40000000000023, -8.99999999999998, -6.899999999999988, -13.599999999999971, -12.899999999999967, -13.899999999999972, -17.399999999999967, -65.9000000000004, -7.79999999999999, -9.899999999999977, -7.899999999999984, -26.10000000000005, -49.50000000000025, -50.000000000000384, -60.6000000000004, -11.69999999999997, -7.099999999999989, -14.099999999999962, -44.00000000000032, -34.80000000000015, -7.499999999999986, -41.10000000000028, -27.000000000000004, -8.699999999999983, -32.00000000000003, -17.200000000000003, -9.199999999999983, -5.999999999999991, -8.499999999999988, -52.10000000000023, -6.099999999999991, -5.799999999999992, -46.300000000000296, -5.8999999999999915, -47.20000000000034, -19.1, -44.400000000000304, -29.90000000000002, -28.30000000000013, -7.099999999999987, -42.800000000000296, -10.899999999999974, -43.80000000000036, -37.20000000000024, -28.00000000000011, -6.899999999999988, -53.20000000000038, -10.099999999999977, -24.8000000000001, -20.399999999999967, -8.29999999999999, -46.10000000000034, -35.50000000000021, -12.29999999999997, -6.699999999999989, -6.29999999999999, -11.89999999999997, -14.299999999999969, -7.199999999999987, -6.29999999999999, -5.699999999999992, -9.699999999999978, -11.599999999999971, -7.999999999999984, -44.500000000000284, -41.30000000000031, -8.899999999999988, -6.19999999999999, -12.899999999999972, -6.799999999999988, -8.99999999999998, -31.800000000000182, -4.999999999999995, -8.199999999999983, -8.799999999999988, -28.700000000000113, -20.300000000000036, -6.699999999999989, -17.299999999999986, -40.60000000000031, -7.099999999999987], "episode_lengths": [400, 380, 97, 400, 388, 257, 400, 400, 105, 65, 81, 266, 123, 166, 400, 400, 118, 400, 400, 330, 98, 80, 123, 119, 122, 150, 400, 83, 110, 78, 229, 400, 400, 400, 119, 79, 144, 400, 319, 86, 356, 241, 97, 251, 169, 100, 71, 87, 344, 72, 69, 400, 70, 400, 171, 400, 259, 288, 82, 400, 114, 400, 349, 278, 80, 400, 106, 252, 154, 81, 400, 329, 120, 78, 74, 120, 140, 83, 74, 68, 108, 120, 91, 400, 400, 91, 73, 126, 79, 99, 325, 61, 93, 88, 275, 206, 78, 166, 400, 82]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23889791212402606, "mean_inference_ms": 0.7240664124343019, "mean_action_processing_ms": 0.07658120943990758, "mean_env_wait_ms": 6.376237597521626, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00653386116027832, "StateBufferConnector_ms": 0.003952503204345703, "ViewRequirementAgentConnector_ms": 0.08996129035949707}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 550.918197762474, "num_env_steps_trained_throughput_per_sec": 550.918197762474, "timesteps_total": 40000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 40000, "timers": {"training_iteration_time_ms": 7315.707, "sample_time_ms": 3826.168, "load_time_ms": 0.94, "load_throughput": 4254613.141, "learn_time_ms": 3485.132, "learn_throughput": 1147.733, "synch_weights_time_ms": 2.792}, "counters": {"num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000}, "done": false, "episodes_total": 165, "training_iteration": 10, "trial_id": "133f9_00000", "date": "2024-03-07_13-12-30", "timestamp": 1709835150, "time_this_iter_s": 7.263150930404663, "time_total_s": 73.18139696121216, "pid": 117779, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7efea6399f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 73.18139696121216, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 31.011111111111113, "ram_util_percent": 50.7, "gpu_util_percent0": 0.08444444444444445, "vram_util_percent0": 0.09393988715277778}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 6.531403529003103, "policy_loss": -0.020638331234134652, "vf_loss": 6.550602700184751, "vf_explained_var": -0.1959957497094267, "kl": 0.007195806412710226, "entropy": 1.013850390270192, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 9765.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_agent_steps_sampled": 44000, "num_agent_steps_trained": 44000}, "sampler_results": {"episode_reward_max": -3.9999999999999982, "episode_reward_min": -60.6000000000004, "episode_reward_mean": -18.388000000000062, "episode_len_mean": 172.21, "episode_media": {}, "episodes_this_iter": 33, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-60.6000000000004, -11.69999999999997, -7.099999999999989, -14.099999999999962, -44.00000000000032, -34.80000000000015, -7.499999999999986, -41.10000000000028, -27.000000000000004, -8.699999999999983, -32.00000000000003, -17.200000000000003, -9.199999999999983, -5.999999999999991, -8.499999999999988, -52.10000000000023, -6.099999999999991, -5.799999999999992, -46.300000000000296, -5.8999999999999915, -47.20000000000034, -19.1, -44.400000000000304, -29.90000000000002, -28.30000000000013, -7.099999999999987, -42.800000000000296, -10.899999999999974, -43.80000000000036, -37.20000000000024, -28.00000000000011, -6.899999999999988, -53.20000000000038, -10.099999999999977, -24.8000000000001, -20.399999999999967, -8.29999999999999, -46.10000000000034, -35.50000000000021, -12.29999999999997, -6.699999999999989, -6.29999999999999, -11.89999999999997, -14.299999999999969, -7.199999999999987, -6.29999999999999, -5.699999999999992, -9.699999999999978, -11.599999999999971, -7.999999999999984, -44.500000000000284, -41.30000000000031, -8.899999999999988, -6.19999999999999, -12.899999999999972, -6.799999999999988, -8.99999999999998, -31.800000000000182, -4.999999999999995, -8.199999999999983, -8.799999999999988, -28.700000000000113, -20.300000000000036, -6.699999999999989, -17.299999999999986, -40.60000000000031, -7.099999999999987, -38.40000000000029, -7.799999999999988, -3.9999999999999982, -7.699999999999987, -19.299999999999997, -31.300000000000146, -4.4999999999999964, -8.999999999999988, -25.89999999999995, -47.10000000000038, -4.599999999999998, -7.799999999999985, -5.199999999999994, -8.199999999999983, -5.6, -13.599999999999964, -5.5999999999999925, -4.799999999999995, -11.399999999999984, -35.90000000000019, -10.399999999999975, -5.199999999999995, -10.899999999999974, -4.699999999999996, -11.799999999999983, -4.699999999999996, -4.399999999999997, -26.000000000000117, -12.699999999999969, -5.199999999999994, -36.70000000000017, -8.599999999999989, -5.999999999999996], "episode_lengths": [400, 119, 79, 144, 400, 319, 86, 356, 241, 97, 251, 169, 100, 71, 87, 344, 72, 69, 400, 70, 400, 171, 400, 259, 288, 82, 400, 114, 400, 349, 278, 80, 400, 106, 252, 154, 81, 400, 329, 120, 78, 74, 120, 140, 83, 74, 68, 108, 120, 91, 400, 400, 91, 73, 126, 79, 99, 325, 61, 93, 88, 275, 206, 78, 166, 400, 82, 365, 84, 51, 86, 162, 313, 56, 93, 176, 400, 55, 89, 63, 86, 59, 147, 67, 59, 102, 313, 109, 62, 103, 58, 107, 58, 55, 254, 115, 63, 322, 88, 66]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24094425138018352, "mean_inference_ms": 0.7238660824560178, "mean_action_processing_ms": 0.0765329639570318, "mean_env_wait_ms": 6.366331511545882, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0065765380859375, "StateBufferConnector_ms": 0.0039539337158203125, "ViewRequirementAgentConnector_ms": 0.09004640579223633}}, "episode_reward_max": -3.9999999999999982, "episode_reward_min": -60.6000000000004, "episode_reward_mean": -18.388000000000062, "episode_len_mean": 172.21, "episodes_this_iter": 33, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-60.6000000000004, -11.69999999999997, -7.099999999999989, -14.099999999999962, -44.00000000000032, -34.80000000000015, -7.499999999999986, -41.10000000000028, -27.000000000000004, -8.699999999999983, -32.00000000000003, -17.200000000000003, -9.199999999999983, -5.999999999999991, -8.499999999999988, -52.10000000000023, -6.099999999999991, -5.799999999999992, -46.300000000000296, -5.8999999999999915, -47.20000000000034, -19.1, -44.400000000000304, -29.90000000000002, -28.30000000000013, -7.099999999999987, -42.800000000000296, -10.899999999999974, -43.80000000000036, -37.20000000000024, -28.00000000000011, -6.899999999999988, -53.20000000000038, -10.099999999999977, -24.8000000000001, -20.399999999999967, -8.29999999999999, -46.10000000000034, -35.50000000000021, -12.29999999999997, -6.699999999999989, -6.29999999999999, -11.89999999999997, -14.299999999999969, -7.199999999999987, -6.29999999999999, -5.699999999999992, -9.699999999999978, -11.599999999999971, -7.999999999999984, -44.500000000000284, -41.30000000000031, -8.899999999999988, -6.19999999999999, -12.899999999999972, -6.799999999999988, -8.99999999999998, -31.800000000000182, -4.999999999999995, -8.199999999999983, -8.799999999999988, -28.700000000000113, -20.300000000000036, -6.699999999999989, -17.299999999999986, -40.60000000000031, -7.099999999999987, -38.40000000000029, -7.799999999999988, -3.9999999999999982, -7.699999999999987, -19.299999999999997, -31.300000000000146, -4.4999999999999964, -8.999999999999988, -25.89999999999995, -47.10000000000038, -4.599999999999998, -7.799999999999985, -5.199999999999994, -8.199999999999983, -5.6, -13.599999999999964, -5.5999999999999925, -4.799999999999995, -11.399999999999984, -35.90000000000019, -10.399999999999975, -5.199999999999995, -10.899999999999974, -4.699999999999996, -11.799999999999983, -4.699999999999996, -4.399999999999997, -26.000000000000117, -12.699999999999969, -5.199999999999994, -36.70000000000017, -8.599999999999989, -5.999999999999996], "episode_lengths": [400, 119, 79, 144, 400, 319, 86, 356, 241, 97, 251, 169, 100, 71, 87, 344, 72, 69, 400, 70, 400, 171, 400, 259, 288, 82, 400, 114, 400, 349, 278, 80, 400, 106, 252, 154, 81, 400, 329, 120, 78, 74, 120, 140, 83, 74, 68, 108, 120, 91, 400, 400, 91, 73, 126, 79, 99, 325, 61, 93, 88, 275, 206, 78, 166, 400, 82, 365, 84, 51, 86, 162, 313, 56, 93, 176, 400, 55, 89, 63, 86, 59, 147, 67, 59, 102, 313, 109, 62, 103, 58, 107, 58, 55, 254, 115, 63, 322, 88, 66]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24094425138018352, "mean_inference_ms": 0.7238660824560178, "mean_action_processing_ms": 0.0765329639570318, "mean_env_wait_ms": 6.366331511545882, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0065765380859375, "StateBufferConnector_ms": 0.0039539337158203125, "ViewRequirementAgentConnector_ms": 0.09004640579223633}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 44000, "num_agent_steps_trained": 44000, "num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 540.6843892758886, "num_env_steps_trained_throughput_per_sec": 540.6843892758886, "timesteps_total": 44000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 44000, "timers": {"training_iteration_time_ms": 7316.554, "sample_time_ms": 3839.305, "load_time_ms": 0.942, "load_throughput": 4247719.067, "learn_time_ms": 3472.797, "learn_throughput": 1151.809, "synch_weights_time_ms": 2.848}, "counters": {"num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_agent_steps_sampled": 44000, "num_agent_steps_trained": 44000}, "done": false, "episodes_total": 198, "training_iteration": 11, "trial_id": "133f9_00000", "date": "2024-03-07_13-12-38", "timestamp": 1709835158, "time_this_iter_s": 7.400536775588989, "time_total_s": 80.58193373680115, "pid": 117779, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7efea6399f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 80.58193373680115, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 29.05, "ram_util_percent": 50.7, "gpu_util_percent0": 0.078, "vram_util_percent0": 0.09396158854166667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 6.707618911246899, "policy_loss": -0.020762053562668702, "vf_loss": 6.727078972548567, "vf_explained_var": -0.050533618209182576, "kl": 0.0065098899939555616, "entropy": 0.9907634309543076, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 10695.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000}, "sampler_results": {"episode_reward_max": -3.200000000000001, "episode_reward_min": -47.10000000000038, "episode_reward_mean": -11.912000000000019, "episode_len_mean": 119.93, "episode_media": {}, "episodes_this_iter": 44, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-7.199999999999987, -6.29999999999999, -5.699999999999992, -9.699999999999978, -11.599999999999971, -7.999999999999984, -44.500000000000284, -41.30000000000031, -8.899999999999988, -6.19999999999999, -12.899999999999972, -6.799999999999988, -8.99999999999998, -31.800000000000182, -4.999999999999995, -8.199999999999983, -8.799999999999988, -28.700000000000113, -20.300000000000036, -6.699999999999989, -17.299999999999986, -40.60000000000031, -7.099999999999987, -38.40000000000029, -7.799999999999988, -3.9999999999999982, -7.699999999999987, -19.299999999999997, -31.300000000000146, -4.4999999999999964, -8.999999999999988, -25.89999999999995, -47.10000000000038, -4.599999999999998, -7.799999999999985, -5.199999999999994, -8.199999999999983, -5.6, -13.599999999999964, -5.5999999999999925, -4.799999999999995, -11.399999999999984, -35.90000000000019, -10.399999999999975, -5.199999999999995, -10.899999999999974, -4.699999999999996, -11.799999999999983, -4.699999999999996, -4.399999999999997, -26.000000000000117, -12.699999999999969, -5.199999999999994, -36.70000000000017, -8.599999999999989, -5.999999999999996, -8.499999999999982, -18.999999999999996, -5.999999999999991, -4.999999999999995, -8.799999999999988, -9.399999999999983, -5.299999999999994, -5.5999999999999925, -5.699999999999992, -6.999999999999993, -3.9999999999999982, -4.899999999999995, -11.599999999999982, -17.099999999999987, -5.199999999999994, -12.899999999999967, -5.399999999999993, -5.6999999999999975, -8.799999999999992, -5.399999999999999, -5.299999999999994, -8.599999999999989, -15.899999999999963, -6.19999999999999, -10.899999999999974, -12.999999999999975, -4.1999999999999975, -5.699999999999996, -8.499999999999982, -31.600000000000193, -5.399999999999993, -5.999999999999991, -6.899999999999988, -5.399999999999993, -5.999999999999991, -7.5999999999999925, -7.899999999999993, -6.39999999999999, -5.499999999999993, -3.200000000000001, -4.1999999999999975, -4.599999999999996, -39.60000000000025, -13.69999999999997], "episode_lengths": [83, 74, 68, 108, 120, 91, 400, 400, 91, 73, 126, 79, 99, 325, 61, 93, 88, 275, 206, 78, 166, 400, 82, 365, 84, 51, 86, 162, 313, 56, 93, 176, 400, 55, 89, 63, 86, 59, 147, 67, 59, 102, 313, 109, 62, 103, 58, 107, 58, 55, 254, 115, 63, 322, 88, 66, 95, 166, 71, 61, 88, 96, 64, 67, 68, 75, 51, 60, 94, 181, 63, 117, 65, 62, 81, 59, 64, 90, 157, 73, 115, 113, 53, 64, 96, 323, 65, 71, 80, 65, 71, 76, 79, 75, 66, 43, 53, 57, 372, 116]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24459716405959547, "mean_inference_ms": 0.7235023407086615, "mean_action_processing_ms": 0.07644722655227297, "mean_env_wait_ms": 6.373221558974749, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006623744964599609, "StateBufferConnector_ms": 0.0039196014404296875, "ViewRequirementAgentConnector_ms": 0.0903480052947998}}, "episode_reward_max": -3.200000000000001, "episode_reward_min": -47.10000000000038, "episode_reward_mean": -11.912000000000019, "episode_len_mean": 119.93, "episodes_this_iter": 44, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-7.199999999999987, -6.29999999999999, -5.699999999999992, -9.699999999999978, -11.599999999999971, -7.999999999999984, -44.500000000000284, -41.30000000000031, -8.899999999999988, -6.19999999999999, -12.899999999999972, -6.799999999999988, -8.99999999999998, -31.800000000000182, -4.999999999999995, -8.199999999999983, -8.799999999999988, -28.700000000000113, -20.300000000000036, -6.699999999999989, -17.299999999999986, -40.60000000000031, -7.099999999999987, -38.40000000000029, -7.799999999999988, -3.9999999999999982, -7.699999999999987, -19.299999999999997, -31.300000000000146, -4.4999999999999964, -8.999999999999988, -25.89999999999995, -47.10000000000038, -4.599999999999998, -7.799999999999985, -5.199999999999994, -8.199999999999983, -5.6, -13.599999999999964, -5.5999999999999925, -4.799999999999995, -11.399999999999984, -35.90000000000019, -10.399999999999975, -5.199999999999995, -10.899999999999974, -4.699999999999996, -11.799999999999983, -4.699999999999996, -4.399999999999997, -26.000000000000117, -12.699999999999969, -5.199999999999994, -36.70000000000017, -8.599999999999989, -5.999999999999996, -8.499999999999982, -18.999999999999996, -5.999999999999991, -4.999999999999995, -8.799999999999988, -9.399999999999983, -5.299999999999994, -5.5999999999999925, -5.699999999999992, -6.999999999999993, -3.9999999999999982, -4.899999999999995, -11.599999999999982, -17.099999999999987, -5.199999999999994, -12.899999999999967, -5.399999999999993, -5.6999999999999975, -8.799999999999992, -5.399999999999999, -5.299999999999994, -8.599999999999989, -15.899999999999963, -6.19999999999999, -10.899999999999974, -12.999999999999975, -4.1999999999999975, -5.699999999999996, -8.499999999999982, -31.600000000000193, -5.399999999999993, -5.999999999999991, -6.899999999999988, -5.399999999999993, -5.999999999999991, -7.5999999999999925, -7.899999999999993, -6.39999999999999, -5.499999999999993, -3.200000000000001, -4.1999999999999975, -4.599999999999996, -39.60000000000025, -13.69999999999997], "episode_lengths": [83, 74, 68, 108, 120, 91, 400, 400, 91, 73, 126, 79, 99, 325, 61, 93, 88, 275, 206, 78, 166, 400, 82, 365, 84, 51, 86, 162, 313, 56, 93, 176, 400, 55, 89, 63, 86, 59, 147, 67, 59, 102, 313, 109, 62, 103, 58, 107, 58, 55, 254, 115, 63, 322, 88, 66, 95, 166, 71, 61, 88, 96, 64, 67, 68, 75, 51, 60, 94, 181, 63, 117, 65, 62, 81, 59, 64, 90, 157, 73, 115, 113, 53, 64, 96, 323, 65, 71, 80, 65, 71, 76, 79, 75, 66, 43, 53, 57, 372, 116]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24459716405959547, "mean_inference_ms": 0.7235023407086615, "mean_action_processing_ms": 0.07644722655227297, "mean_env_wait_ms": 6.373221558974749, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006623744964599609, "StateBufferConnector_ms": 0.0039196014404296875, "ViewRequirementAgentConnector_ms": 0.0903480052947998}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000, "num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 524.1216241419364, "num_env_steps_trained_throughput_per_sec": 524.1216241419364, "timesteps_total": 48000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 48000, "timers": {"training_iteration_time_ms": 7356.368, "sample_time_ms": 3869.398, "load_time_ms": 0.942, "load_throughput": 4247073.893, "learn_time_ms": 3482.462, "learn_throughput": 1148.613, "synch_weights_time_ms": 2.911}, "counters": {"num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000}, "done": false, "episodes_total": 242, "training_iteration": 12, "trial_id": "133f9_00000", "date": "2024-03-07_13-12-45", "timestamp": 1709835165, "time_this_iter_s": 7.634690999984741, "time_total_s": 88.21662473678589, "pid": 117779, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7efea6399f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 88.21662473678589, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 29.9, "ram_util_percent": 50.77, "gpu_util_percent0": 0.091, "vram_util_percent0": 0.09396158854166667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 3.2538327476950437, "policy_loss": -0.007644106627952668, "vf_loss": 3.2599205812779806, "vf_explained_var": 0.37731803117259854, "kl": 0.007781406108305448, "entropy": 0.9985364953035949, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 11625.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_agent_steps_sampled": 52000, "num_agent_steps_trained": 52000}, "sampler_results": {"episode_reward_max": -3.200000000000001, "episode_reward_min": -42.50000000000032, "episode_reward_mean": -9.531, "episode_len_mean": 99.02, "episode_media": {}, "episodes_this_iter": 42, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-35.90000000000019, -10.399999999999975, -5.199999999999995, -10.899999999999974, -4.699999999999996, -11.799999999999983, -4.699999999999996, -4.399999999999997, -26.000000000000117, -12.699999999999969, -5.199999999999994, -36.70000000000017, -8.599999999999989, -5.999999999999996, -8.499999999999982, -18.999999999999996, -5.999999999999991, -4.999999999999995, -8.799999999999988, -9.399999999999983, -5.299999999999994, -5.5999999999999925, -5.699999999999992, -6.999999999999993, -3.9999999999999982, -4.899999999999995, -11.599999999999982, -17.099999999999987, -5.199999999999994, -12.899999999999967, -5.399999999999993, -5.6999999999999975, -8.799999999999992, -5.399999999999999, -5.299999999999994, -8.599999999999989, -15.899999999999963, -6.19999999999999, -10.899999999999974, -12.999999999999975, -4.1999999999999975, -5.699999999999996, -8.499999999999982, -31.600000000000193, -5.399999999999993, -5.999999999999991, -6.899999999999988, -5.399999999999993, -5.999999999999991, -7.5999999999999925, -7.899999999999993, -6.39999999999999, -5.499999999999993, -3.200000000000001, -4.1999999999999975, -4.599999999999996, -39.60000000000025, -13.69999999999997, -42.50000000000032, -9.099999999999982, -5.999999999999991, -4.699999999999996, -5.299999999999994, -15.499999999999972, -8.29999999999999, -10.499999999999984, -6.999999999999988, -6.19999999999999, -5.399999999999993, -6.599999999999989, -5.5999999999999925, -6.29999999999999, -5.799999999999992, -5.599999999999994, -5.5999999999999925, -7.999999999999984, -3.9999999999999982, -22.800000000000043, -13.799999999999965, -6.39999999999999, -9.499999999999982, -9.39999999999998, -5.299999999999994, -18.2, -7.6999999999999975, -5.399999999999993, -6.29999999999999, -8.399999999999991, -11.499999999999972, -6.599999999999989, -3.5999999999999996, -9.499999999999986, -5.699999999999992, -8.19999999999999, -6.39999999999999, -8.799999999999986, -8.399999999999983, -13.399999999999965, -6.39999999999999, -6.599999999999989], "episode_lengths": [313, 109, 62, 103, 58, 107, 58, 55, 254, 115, 63, 322, 88, 66, 95, 166, 71, 61, 88, 96, 64, 67, 68, 75, 51, 60, 94, 181, 63, 117, 65, 62, 81, 59, 64, 90, 157, 73, 115, 113, 53, 64, 96, 323, 65, 71, 80, 65, 71, 76, 79, 75, 66, 43, 53, 57, 372, 116, 400, 99, 71, 58, 64, 132, 82, 101, 81, 73, 65, 77, 67, 74, 69, 64, 67, 87, 51, 232, 130, 75, 102, 99, 64, 180, 75, 65, 74, 85, 118, 77, 47, 99, 68, 84, 75, 91, 95, 139, 75, 77]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24778673901708623, "mean_inference_ms": 0.7228972497048608, "mean_action_processing_ms": 0.07623656808990913, "mean_env_wait_ms": 6.375911906116053, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006523609161376953, "StateBufferConnector_ms": 0.0039370059967041016, "ViewRequirementAgentConnector_ms": 0.0903928279876709}}, "episode_reward_max": -3.200000000000001, "episode_reward_min": -42.50000000000032, "episode_reward_mean": -9.531, "episode_len_mean": 99.02, "episodes_this_iter": 42, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-35.90000000000019, -10.399999999999975, -5.199999999999995, -10.899999999999974, -4.699999999999996, -11.799999999999983, -4.699999999999996, -4.399999999999997, -26.000000000000117, -12.699999999999969, -5.199999999999994, -36.70000000000017, -8.599999999999989, -5.999999999999996, -8.499999999999982, -18.999999999999996, -5.999999999999991, -4.999999999999995, -8.799999999999988, -9.399999999999983, -5.299999999999994, -5.5999999999999925, -5.699999999999992, -6.999999999999993, -3.9999999999999982, -4.899999999999995, -11.599999999999982, -17.099999999999987, -5.199999999999994, -12.899999999999967, -5.399999999999993, -5.6999999999999975, -8.799999999999992, -5.399999999999999, -5.299999999999994, -8.599999999999989, -15.899999999999963, -6.19999999999999, -10.899999999999974, -12.999999999999975, -4.1999999999999975, -5.699999999999996, -8.499999999999982, -31.600000000000193, -5.399999999999993, -5.999999999999991, -6.899999999999988, -5.399999999999993, -5.999999999999991, -7.5999999999999925, -7.899999999999993, -6.39999999999999, -5.499999999999993, -3.200000000000001, -4.1999999999999975, -4.599999999999996, -39.60000000000025, -13.69999999999997, -42.50000000000032, -9.099999999999982, -5.999999999999991, -4.699999999999996, -5.299999999999994, -15.499999999999972, -8.29999999999999, -10.499999999999984, -6.999999999999988, -6.19999999999999, -5.399999999999993, -6.599999999999989, -5.5999999999999925, -6.29999999999999, -5.799999999999992, -5.599999999999994, -5.5999999999999925, -7.999999999999984, -3.9999999999999982, -22.800000000000043, -13.799999999999965, -6.39999999999999, -9.499999999999982, -9.39999999999998, -5.299999999999994, -18.2, -7.6999999999999975, -5.399999999999993, -6.29999999999999, -8.399999999999991, -11.499999999999972, -6.599999999999989, -3.5999999999999996, -9.499999999999986, -5.699999999999992, -8.19999999999999, -6.39999999999999, -8.799999999999986, -8.399999999999983, -13.399999999999965, -6.39999999999999, -6.599999999999989], "episode_lengths": [313, 109, 62, 103, 58, 107, 58, 55, 254, 115, 63, 322, 88, 66, 95, 166, 71, 61, 88, 96, 64, 67, 68, 75, 51, 60, 94, 181, 63, 117, 65, 62, 81, 59, 64, 90, 157, 73, 115, 113, 53, 64, 96, 323, 65, 71, 80, 65, 71, 76, 79, 75, 66, 43, 53, 57, 372, 116, 400, 99, 71, 58, 64, 132, 82, 101, 81, 73, 65, 77, 67, 74, 69, 64, 67, 87, 51, 232, 130, 75, 102, 99, 64, 180, 75, 65, 74, 85, 118, 77, 47, 99, 68, 84, 75, 91, 95, 139, 75, 77]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24778673901708623, "mean_inference_ms": 0.7228972497048608, "mean_action_processing_ms": 0.07623656808990913, "mean_env_wait_ms": 6.375911906116053, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006523609161376953, "StateBufferConnector_ms": 0.0039370059967041016, "ViewRequirementAgentConnector_ms": 0.0903928279876709}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 52000, "num_agent_steps_trained": 52000, "num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 549.2736696515489, "num_env_steps_trained_throughput_per_sec": 549.2736696515489, "timesteps_total": 52000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 52000, "timers": {"training_iteration_time_ms": 7364.218, "sample_time_ms": 3877.163, "load_time_ms": 0.946, "load_throughput": 4228555.298, "learn_time_ms": 3482.517, "learn_throughput": 1148.595, "synch_weights_time_ms": 2.931}, "counters": {"num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_agent_steps_sampled": 52000, "num_agent_steps_trained": 52000}, "done": false, "episodes_total": 284, "training_iteration": 13, "trial_id": "133f9_00000", "date": "2024-03-07_13-12-53", "timestamp": 1709835173, "time_this_iter_s": 7.285226821899414, "time_total_s": 95.5018515586853, "pid": 117779, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7efea6399f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 95.5018515586853, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 31.199999999999996, "ram_util_percent": 50.74444444444444, "gpu_util_percent0": 0.08333333333333333, "vram_util_percent0": 0.09393084490740741}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 2.0228023070058416, "policy_loss": -0.014809291437268257, "vf_loss": 2.035865761179437, "vf_explained_var": 0.6453006566852652, "kl": 0.008729181312931093, "entropy": 0.9873400704835051, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 12555.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 56000}, "sampler_results": {"episode_reward_max": -2.700000000000002, "episode_reward_min": -42.50000000000032, "episode_reward_mean": -8.454999999999997, "episode_len_mean": 89.8, "episode_media": {}, "episodes_this_iter": 50, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-7.899999999999993, -6.39999999999999, -5.499999999999993, -3.200000000000001, -4.1999999999999975, -4.599999999999996, -39.60000000000025, -13.69999999999997, -42.50000000000032, -9.099999999999982, -5.999999999999991, -4.699999999999996, -5.299999999999994, -15.499999999999972, -8.29999999999999, -10.499999999999984, -6.999999999999988, -6.19999999999999, -5.399999999999993, -6.599999999999989, -5.5999999999999925, -6.29999999999999, -5.799999999999992, -5.599999999999994, -5.5999999999999925, -7.999999999999984, -3.9999999999999982, -22.800000000000043, -13.799999999999965, -6.39999999999999, -9.499999999999982, -9.39999999999998, -5.299999999999994, -18.2, -7.6999999999999975, -5.399999999999993, -6.29999999999999, -8.399999999999991, -11.499999999999972, -6.599999999999989, -3.5999999999999996, -9.499999999999986, -5.699999999999992, -8.19999999999999, -6.39999999999999, -8.799999999999986, -8.399999999999983, -13.399999999999965, -6.39999999999999, -6.599999999999989, -6.29999999999999, -3.9999999999999982, -6.199999999999992, -4.599999999999998, -7.2999999999999865, -4.699999999999996, -4.599999999999996, -3.8999999999999986, -28.000000000000146, -19.699999999999967, -22.99999999999997, -4.299999999999997, -13.399999999999967, -10.099999999999977, -7.599999999999985, -6.39999999999999, -3.799999999999999, -4.1999999999999975, -4.4999999999999964, -9.599999999999978, -3.5, -5.399999999999993, -6.19999999999999, -5.199999999999994, -7.999999999999984, -9.599999999999978, -7.399999999999986, -4.999999999999995, -5.199999999999994, -5.5999999999999925, -11.499999999999973, -15.999999999999982, -8.89999999999998, -6.19999999999999, -6.099999999999991, -2.700000000000002, -6.699999999999989, -5.499999999999993, -10.899999999999974, -6.099999999999991, -12.69999999999997, -5.199999999999994, -3.8999999999999986, -6.699999999999989, -6.599999999999989, -5.699999999999992, -6.6999999999999895, -9.29999999999998, -5.499999999999993, -3.8999999999999986], "episode_lengths": [79, 75, 66, 43, 53, 57, 372, 116, 400, 99, 71, 58, 64, 132, 82, 101, 81, 73, 65, 77, 67, 74, 69, 64, 67, 87, 51, 232, 130, 75, 102, 99, 64, 180, 75, 65, 74, 85, 118, 77, 47, 99, 68, 84, 75, 91, 95, 139, 75, 77, 74, 51, 71, 55, 84, 58, 57, 50, 252, 156, 170, 54, 132, 108, 85, 75, 49, 53, 56, 97, 46, 65, 73, 63, 91, 104, 85, 61, 63, 67, 119, 127, 100, 73, 72, 38, 78, 66, 115, 72, 113, 63, 50, 78, 77, 68, 77, 104, 66, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.25128324878124103, "mean_inference_ms": 0.7229257961920388, "mean_action_processing_ms": 0.07626718755120514, "mean_env_wait_ms": 6.374658351845232, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006689310073852539, "StateBufferConnector_ms": 0.003998994827270508, "ViewRequirementAgentConnector_ms": 0.09104323387145996}}, "episode_reward_max": -2.700000000000002, "episode_reward_min": -42.50000000000032, "episode_reward_mean": -8.454999999999997, "episode_len_mean": 89.8, "episodes_this_iter": 50, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-7.899999999999993, -6.39999999999999, -5.499999999999993, -3.200000000000001, -4.1999999999999975, -4.599999999999996, -39.60000000000025, -13.69999999999997, -42.50000000000032, -9.099999999999982, -5.999999999999991, -4.699999999999996, -5.299999999999994, -15.499999999999972, -8.29999999999999, -10.499999999999984, -6.999999999999988, -6.19999999999999, -5.399999999999993, -6.599999999999989, -5.5999999999999925, -6.29999999999999, -5.799999999999992, -5.599999999999994, -5.5999999999999925, -7.999999999999984, -3.9999999999999982, -22.800000000000043, -13.799999999999965, -6.39999999999999, -9.499999999999982, -9.39999999999998, -5.299999999999994, -18.2, -7.6999999999999975, -5.399999999999993, -6.29999999999999, -8.399999999999991, -11.499999999999972, -6.599999999999989, -3.5999999999999996, -9.499999999999986, -5.699999999999992, -8.19999999999999, -6.39999999999999, -8.799999999999986, -8.399999999999983, -13.399999999999965, -6.39999999999999, -6.599999999999989, -6.29999999999999, -3.9999999999999982, -6.199999999999992, -4.599999999999998, -7.2999999999999865, -4.699999999999996, -4.599999999999996, -3.8999999999999986, -28.000000000000146, -19.699999999999967, -22.99999999999997, -4.299999999999997, -13.399999999999967, -10.099999999999977, -7.599999999999985, -6.39999999999999, -3.799999999999999, -4.1999999999999975, -4.4999999999999964, -9.599999999999978, -3.5, -5.399999999999993, -6.19999999999999, -5.199999999999994, -7.999999999999984, -9.599999999999978, -7.399999999999986, -4.999999999999995, -5.199999999999994, -5.5999999999999925, -11.499999999999973, -15.999999999999982, -8.89999999999998, -6.19999999999999, -6.099999999999991, -2.700000000000002, -6.699999999999989, -5.499999999999993, -10.899999999999974, -6.099999999999991, -12.69999999999997, -5.199999999999994, -3.8999999999999986, -6.699999999999989, -6.599999999999989, -5.699999999999992, -6.6999999999999895, -9.29999999999998, -5.499999999999993, -3.8999999999999986], "episode_lengths": [79, 75, 66, 43, 53, 57, 372, 116, 400, 99, 71, 58, 64, 132, 82, 101, 81, 73, 65, 77, 67, 74, 69, 64, 67, 87, 51, 232, 130, 75, 102, 99, 64, 180, 75, 65, 74, 85, 118, 77, 47, 99, 68, 84, 75, 91, 95, 139, 75, 77, 74, 51, 71, 55, 84, 58, 57, 50, 252, 156, 170, 54, 132, 108, 85, 75, 49, 53, 56, 97, 46, 65, 73, 63, 91, 104, 85, 61, 63, 67, 119, 127, 100, 73, 72, 38, 78, 66, 115, 72, 113, 63, 50, 78, 77, 68, 77, 104, 66, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.25128324878124103, "mean_inference_ms": 0.7229257961920388, "mean_action_processing_ms": 0.07626718755120514, "mean_env_wait_ms": 6.374658351845232, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006689310073852539, "StateBufferConnector_ms": 0.003998994827270508, "ViewRequirementAgentConnector_ms": 0.09104323387145996}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 56000, "num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 532.8521496132513, "num_env_steps_trained_throughput_per_sec": 532.8521496132513, "timesteps_total": 56000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 56000, "timers": {"training_iteration_time_ms": 7386.712, "sample_time_ms": 3886.621, "load_time_ms": 0.948, "load_throughput": 4218560.724, "learn_time_ms": 3495.483, "learn_throughput": 1144.334, "synch_weights_time_ms": 2.994}, "counters": {"num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 56000}, "done": false, "episodes_total": 334, "training_iteration": 14, "trial_id": "133f9_00000", "date": "2024-03-07_13-13-00", "timestamp": 1709835180, "time_this_iter_s": 7.509475469589233, "time_total_s": 103.01132702827454, "pid": 117779, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7efea6399f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 103.01132702827454, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 29.209999999999997, "ram_util_percent": 50.739999999999995, "gpu_util_percent0": 0.096, "vram_util_percent0": 0.0939453125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 1.816890178129868, "policy_loss": -0.00835603482380349, "vf_loss": 1.8236515933147042, "vf_explained_var": 0.6347727558946097, "kl": 0.007973148825758178, "entropy": 0.9575671693971081, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 13485.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000}, "sampler_results": {"episode_reward_max": -2.700000000000002, "episode_reward_min": -28.000000000000146, "episode_reward_mean": -6.983999999999992, "episode_len_mean": 77.28, "episode_media": {}, "episodes_this_iter": 54, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-7.2999999999999865, -4.699999999999996, -4.599999999999996, -3.8999999999999986, -28.000000000000146, -19.699999999999967, -22.99999999999997, -4.299999999999997, -13.399999999999967, -10.099999999999977, -7.599999999999985, -6.39999999999999, -3.799999999999999, -4.1999999999999975, -4.4999999999999964, -9.599999999999978, -3.5, -5.399999999999993, -6.19999999999999, -5.199999999999994, -7.999999999999984, -9.599999999999978, -7.399999999999986, -4.999999999999995, -5.199999999999994, -5.5999999999999925, -11.499999999999973, -15.999999999999982, -8.89999999999998, -6.19999999999999, -6.099999999999991, -2.700000000000002, -6.699999999999989, -5.499999999999993, -10.899999999999974, -6.099999999999991, -12.69999999999997, -5.199999999999994, -3.8999999999999986, -6.699999999999989, -6.599999999999989, -5.699999999999992, -6.6999999999999895, -9.29999999999998, -5.499999999999993, -3.8999999999999986, -7.499999999999986, -5.299999999999994, -7.200000000000001, -4.099999999999998, -3.5, -8.79999999999999, -6.599999999999989, -5.8999999999999915, -3.6999999999999993, -17.6, -5.499999999999993, -5.999999999999991, -8.499999999999988, -4.899999999999995, -4.999999999999995, -15.099999999999966, -5.099999999999994, -4.799999999999995, -4.599999999999996, -5.099999999999994, -5.199999999999994, -8.699999999999982, -3.8999999999999986, -4.799999999999995, -9.899999999999983, -5.5999999999999925, -7.199999999999987, -6.19999999999999, -2.700000000000002, -4.699999999999996, -16.299999999999976, -3.8999999999999986, -3.9999999999999982, -4.099999999999998, -4.399999999999997, -4.1999999999999975, -7.999999999999984, -6.599999999999989, -4.299999999999997, -5.699999999999993, -3.1000000000000014, -8.099999999999984, -3.8999999999999986, -7.0999999999999925, -3.799999999999999, -5.699999999999992, -6.999999999999988, -6.099999999999991, -5.5999999999999925, -4.099999999999998, -6.999999999999992, -7.2999999999999865, -3.9999999999999982, -7.399999999999986], "episode_lengths": [84, 58, 57, 50, 252, 156, 170, 54, 132, 108, 85, 75, 49, 53, 56, 97, 46, 65, 73, 63, 91, 104, 85, 61, 63, 67, 119, 127, 100, 73, 72, 38, 78, 66, 115, 72, 113, 63, 50, 78, 77, 68, 77, 104, 66, 50, 86, 64, 68, 52, 46, 88, 77, 70, 48, 176, 66, 71, 83, 60, 61, 156, 62, 59, 57, 62, 63, 98, 50, 59, 105, 67, 83, 73, 38, 58, 170, 50, 51, 52, 55, 53, 88, 77, 54, 67, 42, 92, 50, 76, 49, 68, 81, 72, 67, 52, 76, 84, 51, 85]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2549788798748304, "mean_inference_ms": 0.7227613490413393, "mean_action_processing_ms": 0.07624801934378944, "mean_env_wait_ms": 6.384808685148442, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006852388381958008, "StateBufferConnector_ms": 0.004058361053466797, "ViewRequirementAgentConnector_ms": 0.09127521514892578}}, "episode_reward_max": -2.700000000000002, "episode_reward_min": -28.000000000000146, "episode_reward_mean": -6.983999999999992, "episode_len_mean": 77.28, "episodes_this_iter": 54, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-7.2999999999999865, -4.699999999999996, -4.599999999999996, -3.8999999999999986, -28.000000000000146, -19.699999999999967, -22.99999999999997, -4.299999999999997, -13.399999999999967, -10.099999999999977, -7.599999999999985, -6.39999999999999, -3.799999999999999, -4.1999999999999975, -4.4999999999999964, -9.599999999999978, -3.5, -5.399999999999993, -6.19999999999999, -5.199999999999994, -7.999999999999984, -9.599999999999978, -7.399999999999986, -4.999999999999995, -5.199999999999994, -5.5999999999999925, -11.499999999999973, -15.999999999999982, -8.89999999999998, -6.19999999999999, -6.099999999999991, -2.700000000000002, -6.699999999999989, -5.499999999999993, -10.899999999999974, -6.099999999999991, -12.69999999999997, -5.199999999999994, -3.8999999999999986, -6.699999999999989, -6.599999999999989, -5.699999999999992, -6.6999999999999895, -9.29999999999998, -5.499999999999993, -3.8999999999999986, -7.499999999999986, -5.299999999999994, -7.200000000000001, -4.099999999999998, -3.5, -8.79999999999999, -6.599999999999989, -5.8999999999999915, -3.6999999999999993, -17.6, -5.499999999999993, -5.999999999999991, -8.499999999999988, -4.899999999999995, -4.999999999999995, -15.099999999999966, -5.099999999999994, -4.799999999999995, -4.599999999999996, -5.099999999999994, -5.199999999999994, -8.699999999999982, -3.8999999999999986, -4.799999999999995, -9.899999999999983, -5.5999999999999925, -7.199999999999987, -6.19999999999999, -2.700000000000002, -4.699999999999996, -16.299999999999976, -3.8999999999999986, -3.9999999999999982, -4.099999999999998, -4.399999999999997, -4.1999999999999975, -7.999999999999984, -6.599999999999989, -4.299999999999997, -5.699999999999993, -3.1000000000000014, -8.099999999999984, -3.8999999999999986, -7.0999999999999925, -3.799999999999999, -5.699999999999992, -6.999999999999988, -6.099999999999991, -5.5999999999999925, -4.099999999999998, -6.999999999999992, -7.2999999999999865, -3.9999999999999982, -7.399999999999986], "episode_lengths": [84, 58, 57, 50, 252, 156, 170, 54, 132, 108, 85, 75, 49, 53, 56, 97, 46, 65, 73, 63, 91, 104, 85, 61, 63, 67, 119, 127, 100, 73, 72, 38, 78, 66, 115, 72, 113, 63, 50, 78, 77, 68, 77, 104, 66, 50, 86, 64, 68, 52, 46, 88, 77, 70, 48, 176, 66, 71, 83, 60, 61, 156, 62, 59, 57, 62, 63, 98, 50, 59, 105, 67, 83, 73, 38, 58, 170, 50, 51, 52, 55, 53, 88, 77, 54, 67, 42, 92, 50, 76, 49, 68, 81, 72, 67, 52, 76, 84, 51, 85]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2549788798748304, "mean_inference_ms": 0.7227613490413393, "mean_action_processing_ms": 0.07624801934378944, "mean_env_wait_ms": 6.384808685148442, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006852388381958008, "StateBufferConnector_ms": 0.004058361053466797, "ViewRequirementAgentConnector_ms": 0.09127521514892578}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000, "num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 543.1545408714887, "num_env_steps_trained_throughput_per_sec": 543.1545408714887, "timesteps_total": 60000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 60000, "timers": {"training_iteration_time_ms": 7392.181, "sample_time_ms": 3893.066, "load_time_ms": 0.947, "load_throughput": 4222064.071, "learn_time_ms": 3494.486, "learn_throughput": 1144.661, "synch_weights_time_ms": 3.015}, "counters": {"num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000}, "done": false, "episodes_total": 388, "training_iteration": 15, "trial_id": "133f9_00000", "date": "2024-03-07_13-13-08", "timestamp": 1709835188, "time_this_iter_s": 7.367124080657959, "time_total_s": 110.3784511089325, "pid": 117779, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7efea6399f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 110.3784511089325, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 29.240000000000002, "ram_util_percent": 50.73, "gpu_util_percent0": 0.08700000000000001, "vram_util_percent0": 0.09396158854166667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 1.948042485530999, "policy_loss": -0.020244748323595012, "vf_loss": 1.966659135123094, "vf_explained_var": 0.5965673243486753, "kl": 0.008140483940842304, "entropy": 0.935591717496995, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 14415.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000}, "sampler_results": {"episode_reward_max": -2.5000000000000018, "episode_reward_min": -16.299999999999976, "episode_reward_mean": -6.0679999999999925, "episode_len_mean": 68.88, "episode_media": {}, "episodes_this_iter": 60, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4.999999999999995, -15.099999999999966, -5.099999999999994, -4.799999999999995, -4.599999999999996, -5.099999999999994, -5.199999999999994, -8.699999999999982, -3.8999999999999986, -4.799999999999995, -9.899999999999983, -5.5999999999999925, -7.199999999999987, -6.19999999999999, -2.700000000000002, -4.699999999999996, -16.299999999999976, -3.8999999999999986, -3.9999999999999982, -4.099999999999998, -4.399999999999997, -4.1999999999999975, -7.999999999999984, -6.599999999999989, -4.299999999999997, -5.699999999999993, -3.1000000000000014, -8.099999999999984, -3.8999999999999986, -7.0999999999999925, -3.799999999999999, -5.699999999999992, -6.999999999999988, -6.099999999999991, -5.5999999999999925, -4.099999999999998, -6.999999999999992, -7.2999999999999865, -3.9999999999999982, -7.399999999999986, -3.200000000000001, -6.19999999999999, -4.899999999999995, -4.1999999999999975, -3.9999999999999982, -2.5000000000000018, -3.4000000000000004, -5.4999999999999964, -3.5, -15.299999999999962, -7.199999999999994, -3.8999999999999986, -4.899999999999995, -5.499999999999993, -5.499999999999993, -14.69999999999996, -15.599999999999959, -4.099999999999998, -6.099999999999991, -11.49999999999998, -4.4999999999999964, -8.199999999999996, -4.099999999999998, -6.799999999999988, -4.699999999999996, -9.699999999999992, -6.899999999999997, -6.799999999999988, -3.799999999999999, -6.5999999999999925, -5.8999999999999915, -2.900000000000002, -6.400000000000002, -4.999999999999998, -4.899999999999996, -7.399999999999995, -3.3000000000000016, -4.099999999999998, -5.299999999999994, -4.699999999999996, -7.099999999999987, -4.699999999999996, -5.699999999999992, -5.099999999999994, -5.4999999999999964, -3.0000000000000018, -6.299999999999994, -7.099999999999996, -6.599999999999998, -4.5, -4.599999999999996, -11.79999999999997, -5.099999999999994, -4.899999999999995, -8.599999999999993, -10.499999999999977, -4.599999999999999, -7.699999999999992, -4.899999999999995, -4.4999999999999964], "episode_lengths": [61, 156, 62, 59, 57, 62, 63, 98, 50, 59, 105, 67, 83, 73, 38, 58, 170, 50, 51, 52, 55, 53, 88, 77, 54, 67, 42, 92, 50, 76, 49, 68, 81, 72, 67, 52, 76, 84, 51, 85, 43, 73, 60, 53, 51, 36, 45, 59, 46, 144, 75, 50, 60, 66, 66, 149, 161, 52, 72, 99, 56, 73, 52, 79, 58, 88, 70, 79, 49, 73, 70, 40, 61, 57, 59, 76, 42, 52, 64, 58, 82, 58, 68, 62, 62, 41, 70, 72, 67, 52, 57, 109, 62, 60, 82, 104, 54, 81, 60, 56]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.25887070801477774, "mean_inference_ms": 0.7226050566751974, "mean_action_processing_ms": 0.07618216335584808, "mean_env_wait_ms": 6.400463112674133, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0065555572509765625, "StateBufferConnector_ms": 0.003968000411987305, "ViewRequirementAgentConnector_ms": 0.09002971649169922}}, "episode_reward_max": -2.5000000000000018, "episode_reward_min": -16.299999999999976, "episode_reward_mean": -6.0679999999999925, "episode_len_mean": 68.88, "episodes_this_iter": 60, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-4.999999999999995, -15.099999999999966, -5.099999999999994, -4.799999999999995, -4.599999999999996, -5.099999999999994, -5.199999999999994, -8.699999999999982, -3.8999999999999986, -4.799999999999995, -9.899999999999983, -5.5999999999999925, -7.199999999999987, -6.19999999999999, -2.700000000000002, -4.699999999999996, -16.299999999999976, -3.8999999999999986, -3.9999999999999982, -4.099999999999998, -4.399999999999997, -4.1999999999999975, -7.999999999999984, -6.599999999999989, -4.299999999999997, -5.699999999999993, -3.1000000000000014, -8.099999999999984, -3.8999999999999986, -7.0999999999999925, -3.799999999999999, -5.699999999999992, -6.999999999999988, -6.099999999999991, -5.5999999999999925, -4.099999999999998, -6.999999999999992, -7.2999999999999865, -3.9999999999999982, -7.399999999999986, -3.200000000000001, -6.19999999999999, -4.899999999999995, -4.1999999999999975, -3.9999999999999982, -2.5000000000000018, -3.4000000000000004, -5.4999999999999964, -3.5, -15.299999999999962, -7.199999999999994, -3.8999999999999986, -4.899999999999995, -5.499999999999993, -5.499999999999993, -14.69999999999996, -15.599999999999959, -4.099999999999998, -6.099999999999991, -11.49999999999998, -4.4999999999999964, -8.199999999999996, -4.099999999999998, -6.799999999999988, -4.699999999999996, -9.699999999999992, -6.899999999999997, -6.799999999999988, -3.799999999999999, -6.5999999999999925, -5.8999999999999915, -2.900000000000002, -6.400000000000002, -4.999999999999998, -4.899999999999996, -7.399999999999995, -3.3000000000000016, -4.099999999999998, -5.299999999999994, -4.699999999999996, -7.099999999999987, -4.699999999999996, -5.699999999999992, -5.099999999999994, -5.4999999999999964, -3.0000000000000018, -6.299999999999994, -7.099999999999996, -6.599999999999998, -4.5, -4.599999999999996, -11.79999999999997, -5.099999999999994, -4.899999999999995, -8.599999999999993, -10.499999999999977, -4.599999999999999, -7.699999999999992, -4.899999999999995, -4.4999999999999964], "episode_lengths": [61, 156, 62, 59, 57, 62, 63, 98, 50, 59, 105, 67, 83, 73, 38, 58, 170, 50, 51, 52, 55, 53, 88, 77, 54, 67, 42, 92, 50, 76, 49, 68, 81, 72, 67, 52, 76, 84, 51, 85, 43, 73, 60, 53, 51, 36, 45, 59, 46, 144, 75, 50, 60, 66, 66, 149, 161, 52, 72, 99, 56, 73, 52, 79, 58, 88, 70, 79, 49, 73, 70, 40, 61, 57, 59, 76, 42, 52, 64, 58, 82, 58, 68, 62, 62, 41, 70, 72, 67, 52, 57, 109, 62, 60, 82, 104, 54, 81, 60, 56]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.25887070801477774, "mean_inference_ms": 0.7226050566751974, "mean_action_processing_ms": 0.07618216335584808, "mean_env_wait_ms": 6.400463112674133, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0065555572509765625, "StateBufferConnector_ms": 0.003968000411987305, "ViewRequirementAgentConnector_ms": 0.09002971649169922}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000, "num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 529.903202078197, "num_env_steps_trained_throughput_per_sec": 529.903202078197, "timesteps_total": 64000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 64000, "timers": {"training_iteration_time_ms": 7402.178, "sample_time_ms": 3910.393, "load_time_ms": 0.95, "load_throughput": 4212417.395, "learn_time_ms": 3487.207, "learn_throughput": 1147.05, "synch_weights_time_ms": 2.96}, "counters": {"num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000}, "done": false, "episodes_total": 448, "training_iteration": 16, "trial_id": "133f9_00000", "date": "2024-03-07_13-13-15", "timestamp": 1709835195, "time_this_iter_s": 7.551150798797607, "time_total_s": 117.9296019077301, "pid": 117779, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7efea6399f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 117.9296019077301, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 32.211111111111116, "ram_util_percent": 50.72222222222222, "gpu_util_percent0": 0.08, "vram_util_percent0": 0.09395797164351853}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 0.7361511949857857, "policy_loss": -0.014975950730744229, "vf_loss": 0.7490628466090208, "vf_explained_var": 0.8258426571405062, "kl": 0.01032149616102755, "entropy": 0.9359719976302117, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 15345.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_agent_steps_sampled": 68000, "num_agent_steps_trained": 68000}, "sampler_results": {"episode_reward_max": -2.900000000000002, "episode_reward_min": -11.79999999999997, "episode_reward_mean": -5.518999999999994, "episode_len_mean": 64.19, "episode_media": {}, "episodes_this_iter": 65, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-9.699999999999992, -6.899999999999997, -6.799999999999988, -3.799999999999999, -6.5999999999999925, -5.8999999999999915, -2.900000000000002, -6.400000000000002, -4.999999999999998, -4.899999999999996, -7.399999999999995, -3.3000000000000016, -4.099999999999998, -5.299999999999994, -4.699999999999996, -7.099999999999987, -4.699999999999996, -5.699999999999992, -5.099999999999994, -5.4999999999999964, -3.0000000000000018, -6.299999999999994, -7.099999999999996, -6.599999999999998, -4.5, -4.599999999999996, -11.79999999999997, -5.099999999999994, -4.899999999999995, -8.599999999999993, -10.499999999999977, -4.599999999999999, -7.699999999999992, -4.899999999999995, -4.4999999999999964, -6.899999999999988, -4.899999999999995, -9.999999999999977, -4.099999999999998, -3.5, -5.399999999999993, -4.599999999999996, -3.9999999999999982, -7.899999999999984, -6.39999999999999, -4.999999999999995, -4.299999999999997, -4.1999999999999975, -8.299999999999985, -4.899999999999995, -5.999999999999991, -3.5, -7.2999999999999865, -5.999999999999991, -3.799999999999999, -4.4999999999999964, -4.299999999999997, -6.099999999999991, -4.199999999999998, -8.099999999999984, -5.5999999999999925, -4.1999999999999975, -5.999999999999991, -6.499999999999989, -5.199999999999994, -6.099999999999991, -8.599999999999982, -8.199999999999983, -5.399999999999993, -2.900000000000002, -3.5, -6.499999999999989, -6.29999999999999, -5.999999999999995, -4.399999999999997, -6.199999999999993, -4.599999999999996, -5.199999999999994, -3.5, -3.1000000000000014, -4.799999999999995, -5.5999999999999925, -4.599999999999996, -3.9999999999999982, -7.199999999999992, -3.9999999999999982, -5.399999999999993, -4.899999999999995, -7.2999999999999865, -3.6999999999999993, -7.699999999999996, -5.699999999999997, -4.399999999999997, -3.5999999999999996, -3.5999999999999996, -3.200000000000001, -4.4999999999999964, -4.799999999999995, -3.6999999999999993, -6.499999999999989], "episode_lengths": [88, 70, 79, 49, 73, 70, 40, 61, 57, 59, 76, 42, 52, 64, 58, 82, 58, 68, 62, 62, 41, 70, 72, 67, 52, 57, 109, 62, 60, 82, 104, 54, 81, 60, 56, 80, 60, 106, 52, 46, 65, 57, 51, 90, 75, 61, 54, 53, 88, 60, 71, 46, 84, 71, 49, 56, 54, 72, 52, 92, 67, 53, 71, 76, 63, 72, 95, 93, 65, 40, 46, 76, 74, 67, 55, 70, 57, 63, 46, 42, 59, 67, 57, 51, 77, 51, 65, 60, 84, 48, 73, 63, 55, 47, 47, 43, 56, 59, 48, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2626805103565505, "mean_inference_ms": 0.7229569808172022, "mean_action_processing_ms": 0.07616469964111587, "mean_env_wait_ms": 6.420903863314737, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006518363952636719, "StateBufferConnector_ms": 0.003977775573730469, "ViewRequirementAgentConnector_ms": 0.0904545783996582}}, "episode_reward_max": -2.900000000000002, "episode_reward_min": -11.79999999999997, "episode_reward_mean": -5.518999999999994, "episode_len_mean": 64.19, "episodes_this_iter": 65, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-9.699999999999992, -6.899999999999997, -6.799999999999988, -3.799999999999999, -6.5999999999999925, -5.8999999999999915, -2.900000000000002, -6.400000000000002, -4.999999999999998, -4.899999999999996, -7.399999999999995, -3.3000000000000016, -4.099999999999998, -5.299999999999994, -4.699999999999996, -7.099999999999987, -4.699999999999996, -5.699999999999992, -5.099999999999994, -5.4999999999999964, -3.0000000000000018, -6.299999999999994, -7.099999999999996, -6.599999999999998, -4.5, -4.599999999999996, -11.79999999999997, -5.099999999999994, -4.899999999999995, -8.599999999999993, -10.499999999999977, -4.599999999999999, -7.699999999999992, -4.899999999999995, -4.4999999999999964, -6.899999999999988, -4.899999999999995, -9.999999999999977, -4.099999999999998, -3.5, -5.399999999999993, -4.599999999999996, -3.9999999999999982, -7.899999999999984, -6.39999999999999, -4.999999999999995, -4.299999999999997, -4.1999999999999975, -8.299999999999985, -4.899999999999995, -5.999999999999991, -3.5, -7.2999999999999865, -5.999999999999991, -3.799999999999999, -4.4999999999999964, -4.299999999999997, -6.099999999999991, -4.199999999999998, -8.099999999999984, -5.5999999999999925, -4.1999999999999975, -5.999999999999991, -6.499999999999989, -5.199999999999994, -6.099999999999991, -8.599999999999982, -8.199999999999983, -5.399999999999993, -2.900000000000002, -3.5, -6.499999999999989, -6.29999999999999, -5.999999999999995, -4.399999999999997, -6.199999999999993, -4.599999999999996, -5.199999999999994, -3.5, -3.1000000000000014, -4.799999999999995, -5.5999999999999925, -4.599999999999996, -3.9999999999999982, -7.199999999999992, -3.9999999999999982, -5.399999999999993, -4.899999999999995, -7.2999999999999865, -3.6999999999999993, -7.699999999999996, -5.699999999999997, -4.399999999999997, -3.5999999999999996, -3.5999999999999996, -3.200000000000001, -4.4999999999999964, -4.799999999999995, -3.6999999999999993, -6.499999999999989], "episode_lengths": [88, 70, 79, 49, 73, 70, 40, 61, 57, 59, 76, 42, 52, 64, 58, 82, 58, 68, 62, 62, 41, 70, 72, 67, 52, 57, 109, 62, 60, 82, 104, 54, 81, 60, 56, 80, 60, 106, 52, 46, 65, 57, 51, 90, 75, 61, 54, 53, 88, 60, 71, 46, 84, 71, 49, 56, 54, 72, 52, 92, 67, 53, 71, 76, 63, 72, 95, 93, 65, 40, 46, 76, 74, 67, 55, 70, 57, 63, 46, 42, 59, 67, 57, 51, 77, 51, 65, 60, 84, 48, 73, 63, 55, 47, 47, 43, 56, 59, 48, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2626805103565505, "mean_inference_ms": 0.7229569808172022, "mean_action_processing_ms": 0.07616469964111587, "mean_env_wait_ms": 6.420903863314737, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006518363952636719, "StateBufferConnector_ms": 0.003977775573730469, "ViewRequirementAgentConnector_ms": 0.0904545783996582}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 68000, "num_agent_steps_trained": 68000, "num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 535.2874546278174, "num_env_steps_trained_throughput_per_sec": 535.2874546278174, "timesteps_total": 68000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 68000, "timers": {"training_iteration_time_ms": 7401.143, "sample_time_ms": 3910.006, "load_time_ms": 0.95, "load_throughput": 4210831.514, "learn_time_ms": 3486.576, "learn_throughput": 1147.257, "synch_weights_time_ms": 2.944}, "counters": {"num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_agent_steps_sampled": 68000, "num_agent_steps_trained": 68000}, "done": false, "episodes_total": 513, "training_iteration": 17, "trial_id": "133f9_00000", "date": "2024-03-07_13-13-23", "timestamp": 1709835203, "time_this_iter_s": 7.475542068481445, "time_total_s": 125.40514397621155, "pid": 117779, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7efea6399f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 125.40514397621155, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 29.869999999999997, "ram_util_percent": 50.8, "gpu_util_percent0": 0.092, "vram_util_percent0": 0.0939453125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 1.2613944440939895, "policy_loss": -0.012978556191408506, "vf_loss": 1.2721450630174849, "vf_explained_var": 0.6629293037999061, "kl": 0.011139637418435067, "entropy": 0.8960830884595071, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 16275.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000}, "sampler_results": {"episode_reward_max": -2.4000000000000017, "episode_reward_min": -27.600000000000094, "episode_reward_mean": -5.023999999999996, "episode_len_mean": 60.25, "episode_media": {}, "episodes_this_iter": 67, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8.199999999999983, -5.399999999999993, -2.900000000000002, -3.5, -6.499999999999989, -6.29999999999999, -5.999999999999995, -4.399999999999997, -6.199999999999993, -4.599999999999996, -5.199999999999994, -3.5, -3.1000000000000014, -4.799999999999995, -5.5999999999999925, -4.599999999999996, -3.9999999999999982, -7.199999999999992, -3.9999999999999982, -5.399999999999993, -4.899999999999995, -7.2999999999999865, -3.6999999999999993, -7.699999999999996, -5.699999999999997, -4.399999999999997, -3.5999999999999996, -3.5999999999999996, -3.200000000000001, -4.4999999999999964, -4.799999999999995, -3.6999999999999993, -6.499999999999989, -5.799999999999992, -8.099999999999984, -6.29999999999999, -3.4000000000000004, -4.899999999999995, -4.4999999999999964, -10.49999999999998, -3.5, -4.999999999999996, -3.4000000000000004, -5.8999999999999915, -5.899999999999996, -4.999999999999995, -9.699999999999978, -5.5999999999999925, -3.799999999999999, -27.600000000000094, -4.999999999999995, -3.8999999999999986, -3.200000000000001, -4.899999999999995, -6.499999999999989, -3.0000000000000018, -4.599999999999996, -4.399999999999997, -7.999999999999984, -3.799999999999999, -3.1000000000000014, -2.700000000000002, -3.799999999999999, -4.4999999999999964, -4.099999999999998, -8.699999999999983, -7.599999999999987, -3.5, -7.499999999999998, -2.700000000000002, -2.600000000000002, -4.599999999999996, -6.999999999999988, -3.8999999999999986, -3.799999999999999, -4.399999999999997, -3.799999999999999, -4.799999999999995, -4.299999999999997, -4.899999999999995, -4.099999999999998, -3.3000000000000007, -4.599999999999996, -7.099999999999998, -4.799999999999995, -4.400000000000001, -4.399999999999997, -2.800000000000002, -2.900000000000002, -3.8999999999999986, -2.800000000000002, -3.4000000000000004, -3.3000000000000007, -3.1000000000000014, -3.8999999999999995, -5.299999999999994, -3.0000000000000018, -2.4000000000000017, -5.499999999999993, -3.8999999999999986], "episode_lengths": [93, 65, 40, 46, 76, 74, 67, 55, 70, 57, 63, 46, 42, 59, 67, 57, 51, 77, 51, 65, 60, 84, 48, 73, 63, 55, 47, 47, 43, 56, 59, 48, 76, 69, 92, 73, 45, 60, 56, 107, 46, 60, 45, 70, 65, 61, 108, 67, 48, 275, 61, 50, 43, 60, 76, 41, 57, 55, 91, 49, 42, 38, 49, 56, 52, 94, 84, 46, 73, 38, 37, 57, 81, 50, 49, 55, 49, 59, 54, 60, 52, 44, 57, 71, 59, 50, 55, 39, 40, 50, 39, 45, 44, 42, 49, 64, 41, 35, 66, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2664236784100292, "mean_inference_ms": 0.7232223312563687, "mean_action_processing_ms": 0.07613658775396645, "mean_env_wait_ms": 6.433731519696867, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00668025016784668, "StateBufferConnector_ms": 0.004072427749633789, "ViewRequirementAgentConnector_ms": 0.09115934371948242}}, "episode_reward_max": -2.4000000000000017, "episode_reward_min": -27.600000000000094, "episode_reward_mean": -5.023999999999996, "episode_len_mean": 60.25, "episodes_this_iter": 67, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-8.199999999999983, -5.399999999999993, -2.900000000000002, -3.5, -6.499999999999989, -6.29999999999999, -5.999999999999995, -4.399999999999997, -6.199999999999993, -4.599999999999996, -5.199999999999994, -3.5, -3.1000000000000014, -4.799999999999995, -5.5999999999999925, -4.599999999999996, -3.9999999999999982, -7.199999999999992, -3.9999999999999982, -5.399999999999993, -4.899999999999995, -7.2999999999999865, -3.6999999999999993, -7.699999999999996, -5.699999999999997, -4.399999999999997, -3.5999999999999996, -3.5999999999999996, -3.200000000000001, -4.4999999999999964, -4.799999999999995, -3.6999999999999993, -6.499999999999989, -5.799999999999992, -8.099999999999984, -6.29999999999999, -3.4000000000000004, -4.899999999999995, -4.4999999999999964, -10.49999999999998, -3.5, -4.999999999999996, -3.4000000000000004, -5.8999999999999915, -5.899999999999996, -4.999999999999995, -9.699999999999978, -5.5999999999999925, -3.799999999999999, -27.600000000000094, -4.999999999999995, -3.8999999999999986, -3.200000000000001, -4.899999999999995, -6.499999999999989, -3.0000000000000018, -4.599999999999996, -4.399999999999997, -7.999999999999984, -3.799999999999999, -3.1000000000000014, -2.700000000000002, -3.799999999999999, -4.4999999999999964, -4.099999999999998, -8.699999999999983, -7.599999999999987, -3.5, -7.499999999999998, -2.700000000000002, -2.600000000000002, -4.599999999999996, -6.999999999999988, -3.8999999999999986, -3.799999999999999, -4.399999999999997, -3.799999999999999, -4.799999999999995, -4.299999999999997, -4.899999999999995, -4.099999999999998, -3.3000000000000007, -4.599999999999996, -7.099999999999998, -4.799999999999995, -4.400000000000001, -4.399999999999997, -2.800000000000002, -2.900000000000002, -3.8999999999999986, -2.800000000000002, -3.4000000000000004, -3.3000000000000007, -3.1000000000000014, -3.8999999999999995, -5.299999999999994, -3.0000000000000018, -2.4000000000000017, -5.499999999999993, -3.8999999999999986], "episode_lengths": [93, 65, 40, 46, 76, 74, 67, 55, 70, 57, 63, 46, 42, 59, 67, 57, 51, 77, 51, 65, 60, 84, 48, 73, 63, 55, 47, 47, 43, 56, 59, 48, 76, 69, 92, 73, 45, 60, 56, 107, 46, 60, 45, 70, 65, 61, 108, 67, 48, 275, 61, 50, 43, 60, 76, 41, 57, 55, 91, 49, 42, 38, 49, 56, 52, 94, 84, 46, 73, 38, 37, 57, 81, 50, 49, 55, 49, 59, 54, 60, 52, 44, 57, 71, 59, 50, 55, 39, 40, 50, 39, 45, 44, 42, 49, 64, 41, 35, 66, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2664236784100292, "mean_inference_ms": 0.7232223312563687, "mean_action_processing_ms": 0.07613658775396645, "mean_env_wait_ms": 6.433731519696867, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00668025016784668, "StateBufferConnector_ms": 0.004072427749633789, "ViewRequirementAgentConnector_ms": 0.09115934371948242}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000, "num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 516.0660359157896, "num_env_steps_trained_throughput_per_sec": 516.0660359157896, "timesteps_total": 72000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 72000, "timers": {"training_iteration_time_ms": 7446.334, "sample_time_ms": 3961.611, "load_time_ms": 0.941, "load_throughput": 4248902.396, "learn_time_ms": 3480.299, "learn_throughput": 1149.327, "synch_weights_time_ms": 2.84}, "counters": {"num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000}, "done": false, "episodes_total": 580, "training_iteration": 18, "trial_id": "133f9_00000", "date": "2024-03-07_13-13-30", "timestamp": 1709835210, "time_this_iter_s": 7.753550291061401, "time_total_s": 133.15869426727295, "pid": 117779, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7efea6399f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 133.15869426727295, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 30.110000000000003, "ram_util_percent": 50.779999999999994, "gpu_util_percent0": 0.075, "vram_util_percent0": 0.09395345052083333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 0.5092115423359197, "policy_loss": -0.018850844896208214, "vf_loss": 0.5261634198247745, "vf_explained_var": 0.8028763829379953, "kl": 0.009494838383237635, "entropy": 0.8277685911424698, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 17205.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_agent_steps_sampled": 76000, "num_agent_steps_trained": 76000}, "sampler_results": {"episode_reward_max": -2.2000000000000015, "episode_reward_min": -10.299999999999992, "episode_reward_mean": -3.818999999999999, "episode_len_mean": 48.27, "episode_media": {}, "episodes_this_iter": 83, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-7.099999999999998, -4.799999999999995, -4.400000000000001, -4.399999999999997, -2.800000000000002, -2.900000000000002, -3.8999999999999986, -2.800000000000002, -3.4000000000000004, -3.3000000000000007, -3.1000000000000014, -3.8999999999999995, -5.299999999999994, -3.0000000000000018, -2.4000000000000017, -5.499999999999993, -3.8999999999999986, -3.1000000000000014, -5.5, -4.1999999999999975, -3.999999999999999, -3.0000000000000018, -5.100000000000002, -2.800000000000002, -3.5, -3.6999999999999993, -6.599999999999989, -2.5000000000000018, -3.3000000000000007, -4.4999999999999964, -3.6999999999999993, -6.599999999999989, -2.900000000000002, -5.299999999999998, -3.8999999999999986, -2.900000000000002, -2.2000000000000015, -2.600000000000002, -5.099999999999994, -3.1000000000000014, -3.200000000000001, -3.3000000000000007, -3.4000000000000004, -3.4000000000000004, -4.1999999999999975, -2.900000000000002, -2.800000000000002, -2.3000000000000016, -2.900000000000002, -3.200000000000001, -3.5, -4.599999999999996, -3.0000000000000018, -2.2000000000000015, -3.200000000000001, -2.5000000000000018, -3.0000000000000018, -2.900000000000002, -4.100000000000001, -4.100000000000001, -4.299999999999997, -3.8999999999999986, -3.5999999999999996, -3.200000000000001, -3.6999999999999993, -10.299999999999992, -2.600000000000002, -4.799999999999995, -3.0000000000000018, -3.0000000000000018, -7.699999999999992, -3.3000000000000007, -5.999999999999994, -2.4000000000000017, -3.4000000000000004, -2.700000000000002, -4.299999999999997, -5.399999999999993, -3.6999999999999993, -3.799999999999999, -3.5999999999999996, -3.799999999999999, -2.4000000000000017, -4.999999999999995, -2.800000000000002, -2.600000000000002, -3.6999999999999993, -4.699999999999996, -3.5999999999999996, -5.499999999999998, -3.799999999999999, -3.200000000000001, -2.900000000000002, -3.5, -5.799999999999992, -2.900000000000002, -3.0000000000000018, -4.299999999999997, -4.099999999999998, -3.8999999999999986], "episode_lengths": [71, 59, 50, 55, 39, 40, 50, 39, 45, 44, 42, 49, 64, 41, 35, 66, 50, 42, 58, 53, 50, 41, 53, 39, 46, 48, 77, 36, 44, 56, 48, 77, 40, 59, 50, 40, 33, 37, 62, 42, 43, 44, 45, 45, 53, 40, 39, 34, 40, 43, 46, 57, 41, 33, 43, 36, 41, 40, 48, 48, 54, 50, 47, 43, 48, 89, 37, 59, 41, 41, 78, 44, 68, 35, 45, 38, 54, 65, 48, 49, 47, 49, 35, 61, 39, 37, 48, 58, 47, 60, 49, 43, 40, 46, 69, 40, 41, 54, 52, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.27161573080142903, "mean_inference_ms": 0.7241373164200254, "mean_action_processing_ms": 0.07623342482836776, "mean_env_wait_ms": 6.4552153414806375, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006682872772216797, "StateBufferConnector_ms": 0.00411534309387207, "ViewRequirementAgentConnector_ms": 0.09122443199157715}}, "episode_reward_max": -2.2000000000000015, "episode_reward_min": -10.299999999999992, "episode_reward_mean": -3.818999999999999, "episode_len_mean": 48.27, "episodes_this_iter": 83, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-7.099999999999998, -4.799999999999995, -4.400000000000001, -4.399999999999997, -2.800000000000002, -2.900000000000002, -3.8999999999999986, -2.800000000000002, -3.4000000000000004, -3.3000000000000007, -3.1000000000000014, -3.8999999999999995, -5.299999999999994, -3.0000000000000018, -2.4000000000000017, -5.499999999999993, -3.8999999999999986, -3.1000000000000014, -5.5, -4.1999999999999975, -3.999999999999999, -3.0000000000000018, -5.100000000000002, -2.800000000000002, -3.5, -3.6999999999999993, -6.599999999999989, -2.5000000000000018, -3.3000000000000007, -4.4999999999999964, -3.6999999999999993, -6.599999999999989, -2.900000000000002, -5.299999999999998, -3.8999999999999986, -2.900000000000002, -2.2000000000000015, -2.600000000000002, -5.099999999999994, -3.1000000000000014, -3.200000000000001, -3.3000000000000007, -3.4000000000000004, -3.4000000000000004, -4.1999999999999975, -2.900000000000002, -2.800000000000002, -2.3000000000000016, -2.900000000000002, -3.200000000000001, -3.5, -4.599999999999996, -3.0000000000000018, -2.2000000000000015, -3.200000000000001, -2.5000000000000018, -3.0000000000000018, -2.900000000000002, -4.100000000000001, -4.100000000000001, -4.299999999999997, -3.8999999999999986, -3.5999999999999996, -3.200000000000001, -3.6999999999999993, -10.299999999999992, -2.600000000000002, -4.799999999999995, -3.0000000000000018, -3.0000000000000018, -7.699999999999992, -3.3000000000000007, -5.999999999999994, -2.4000000000000017, -3.4000000000000004, -2.700000000000002, -4.299999999999997, -5.399999999999993, -3.6999999999999993, -3.799999999999999, -3.5999999999999996, -3.799999999999999, -2.4000000000000017, -4.999999999999995, -2.800000000000002, -2.600000000000002, -3.6999999999999993, -4.699999999999996, -3.5999999999999996, -5.499999999999998, -3.799999999999999, -3.200000000000001, -2.900000000000002, -3.5, -5.799999999999992, -2.900000000000002, -3.0000000000000018, -4.299999999999997, -4.099999999999998, -3.8999999999999986], "episode_lengths": [71, 59, 50, 55, 39, 40, 50, 39, 45, 44, 42, 49, 64, 41, 35, 66, 50, 42, 58, 53, 50, 41, 53, 39, 46, 48, 77, 36, 44, 56, 48, 77, 40, 59, 50, 40, 33, 37, 62, 42, 43, 44, 45, 45, 53, 40, 39, 34, 40, 43, 46, 57, 41, 33, 43, 36, 41, 40, 48, 48, 54, 50, 47, 43, 48, 89, 37, 59, 41, 41, 78, 44, 68, 35, 45, 38, 54, 65, 48, 49, 47, 49, 35, 61, 39, 37, 48, 58, 47, 60, 49, 43, 40, 46, 69, 40, 41, 54, 52, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.27161573080142903, "mean_inference_ms": 0.7241373164200254, "mean_action_processing_ms": 0.07623342482836776, "mean_env_wait_ms": 6.4552153414806375, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006682872772216797, "StateBufferConnector_ms": 0.00411534309387207, "ViewRequirementAgentConnector_ms": 0.09122443199157715}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 76000, "num_agent_steps_trained": 76000, "num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 529.194976961216, "num_env_steps_trained_throughput_per_sec": 529.194976961216, "timesteps_total": 76000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 76000, "timers": {"training_iteration_time_ms": 7477.435, "sample_time_ms": 4000.469, "load_time_ms": 0.943, "load_throughput": 4240418.552, "learn_time_ms": 3472.524, "learn_throughput": 1151.9, "synch_weights_time_ms": 2.858}, "counters": {"num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_agent_steps_sampled": 76000, "num_agent_steps_trained": 76000}, "done": false, "episodes_total": 663, "training_iteration": 19, "trial_id": "133f9_00000", "date": "2024-03-07_13-13-38", "timestamp": 1709835218, "time_this_iter_s": 7.561352729797363, "time_total_s": 140.7200469970703, "pid": 117779, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7efea6399f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 140.7200469970703, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 30.679999999999996, "ram_util_percent": 50.79, "gpu_util_percent0": 0.086, "vram_util_percent0": 0.09396158854166667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 0.4519711576169357, "policy_loss": -0.019524933986606135, "vf_loss": 0.4690692007141088, "vf_explained_var": 0.8341179639421483, "kl": 0.012134446438203002, "entropy": 0.7298873001529325, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 18135.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000}, "sampler_results": {"episode_reward_max": -1.700000000000001, "episode_reward_min": -11.299999999999974, "episode_reward_mean": -3.2640000000000002, "episode_len_mean": 43.51, "episode_media": {}, "episodes_this_iter": 91, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.200000000000001, -2.900000000000002, -3.5, -5.799999999999992, -2.900000000000002, -3.0000000000000018, -4.299999999999997, -4.099999999999998, -3.8999999999999986, -4.2, -4.299999999999997, -2.5000000000000018, -2.2000000000000015, -5.899999999999997, -11.299999999999974, -3.799999999999999, -3.3000000000000007, -2.3000000000000016, -2.700000000000002, -2.2000000000000015, -3.1000000000000014, -2.700000000000002, -3.9999999999999982, -2.3000000000000016, -2.4000000000000017, -3.1000000000000014, -2.700000000000002, -3.5, -2.1000000000000014, -2.1000000000000014, -3.4000000000000004, -3.6999999999999993, -3.6999999999999993, -2.4000000000000017, -3.1000000000000014, -3.0000000000000018, -2.5000000000000018, -2.600000000000002, -3.0000000000000018, -3.200000000000001, -3.0000000000000018, -2.800000000000002, -3.8999999999999986, -2.1000000000000014, -2.0000000000000013, -3.5999999999999996, -4.599999999999996, -2.600000000000002, -3.8999999999999986, -2.5000000000000018, -3.0000000000000018, -3.8999999999999986, -5.099999999999994, -3.0000000000000018, -3.0000000000000018, -3.1000000000000014, -2.2000000000000015, -3.3000000000000007, -2.800000000000002, -3.200000000000001, -2.600000000000002, -2.5000000000000018, -4.099999999999998, -2.700000000000002, -2.600000000000002, -2.700000000000002, -4.1999999999999975, -2.800000000000002, -2.800000000000002, -3.799999999999999, -2.2000000000000015, -3.200000000000001, -3.1000000000000014, -5.2999999999999945, -3.200000000000001, -4.399999999999997, -2.5000000000000018, -3.3000000000000007, -2.800000000000002, -3.0000000000000018, -2.900000000000002, -3.0000000000000018, -4.4999999999999964, -3.200000000000001, -3.0000000000000018, -3.6999999999999993, -3.1000000000000014, -5.299999999999994, -2.700000000000002, -2.5000000000000018, -2.1000000000000014, -3.0000000000000018, -2.900000000000002, -3.200000000000001, -3.1000000000000014, -1.700000000000001, -2.800000000000002, -2.800000000000002, -3.0000000000000018, -3.5999999999999996], "episode_lengths": [43, 40, 46, 69, 40, 41, 54, 52, 50, 49, 54, 36, 33, 64, 122, 49, 44, 34, 38, 33, 42, 38, 51, 34, 35, 42, 38, 46, 32, 32, 45, 48, 48, 35, 42, 41, 36, 37, 41, 43, 41, 39, 50, 32, 31, 47, 57, 37, 50, 36, 41, 50, 62, 41, 41, 42, 33, 44, 39, 43, 37, 36, 52, 38, 37, 38, 53, 39, 39, 49, 33, 43, 42, 63, 43, 55, 36, 44, 39, 41, 40, 41, 56, 43, 41, 48, 42, 64, 38, 36, 32, 41, 40, 43, 42, 28, 39, 39, 41, 47]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2763129049575219, "mean_inference_ms": 0.7243047986864934, "mean_action_processing_ms": 0.07618108327017041, "mean_env_wait_ms": 6.487742014346635, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00667572021484375, "StateBufferConnector_ms": 0.004075050354003906, "ViewRequirementAgentConnector_ms": 0.09052848815917969}}, "episode_reward_max": -1.700000000000001, "episode_reward_min": -11.299999999999974, "episode_reward_mean": -3.2640000000000002, "episode_len_mean": 43.51, "episodes_this_iter": 91, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3.200000000000001, -2.900000000000002, -3.5, -5.799999999999992, -2.900000000000002, -3.0000000000000018, -4.299999999999997, -4.099999999999998, -3.8999999999999986, -4.2, -4.299999999999997, -2.5000000000000018, -2.2000000000000015, -5.899999999999997, -11.299999999999974, -3.799999999999999, -3.3000000000000007, -2.3000000000000016, -2.700000000000002, -2.2000000000000015, -3.1000000000000014, -2.700000000000002, -3.9999999999999982, -2.3000000000000016, -2.4000000000000017, -3.1000000000000014, -2.700000000000002, -3.5, -2.1000000000000014, -2.1000000000000014, -3.4000000000000004, -3.6999999999999993, -3.6999999999999993, -2.4000000000000017, -3.1000000000000014, -3.0000000000000018, -2.5000000000000018, -2.600000000000002, -3.0000000000000018, -3.200000000000001, -3.0000000000000018, -2.800000000000002, -3.8999999999999986, -2.1000000000000014, -2.0000000000000013, -3.5999999999999996, -4.599999999999996, -2.600000000000002, -3.8999999999999986, -2.5000000000000018, -3.0000000000000018, -3.8999999999999986, -5.099999999999994, -3.0000000000000018, -3.0000000000000018, -3.1000000000000014, -2.2000000000000015, -3.3000000000000007, -2.800000000000002, -3.200000000000001, -2.600000000000002, -2.5000000000000018, -4.099999999999998, -2.700000000000002, -2.600000000000002, -2.700000000000002, -4.1999999999999975, -2.800000000000002, -2.800000000000002, -3.799999999999999, -2.2000000000000015, -3.200000000000001, -3.1000000000000014, -5.2999999999999945, -3.200000000000001, -4.399999999999997, -2.5000000000000018, -3.3000000000000007, -2.800000000000002, -3.0000000000000018, -2.900000000000002, -3.0000000000000018, -4.4999999999999964, -3.200000000000001, -3.0000000000000018, -3.6999999999999993, -3.1000000000000014, -5.299999999999994, -2.700000000000002, -2.5000000000000018, -2.1000000000000014, -3.0000000000000018, -2.900000000000002, -3.200000000000001, -3.1000000000000014, -1.700000000000001, -2.800000000000002, -2.800000000000002, -3.0000000000000018, -3.5999999999999996], "episode_lengths": [43, 40, 46, 69, 40, 41, 54, 52, 50, 49, 54, 36, 33, 64, 122, 49, 44, 34, 38, 33, 42, 38, 51, 34, 35, 42, 38, 46, 32, 32, 45, 48, 48, 35, 42, 41, 36, 37, 41, 43, 41, 39, 50, 32, 31, 47, 57, 37, 50, 36, 41, 50, 62, 41, 41, 42, 33, 44, 39, 43, 37, 36, 52, 38, 37, 38, 53, 39, 39, 49, 33, 43, 42, 63, 43, 55, 36, 44, 39, 41, 40, 41, 56, 43, 41, 48, 42, 64, 38, 36, 32, 41, 40, 43, 42, 28, 39, 39, 41, 47]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2763129049575219, "mean_inference_ms": 0.7243047986864934, "mean_action_processing_ms": 0.07618108327017041, "mean_env_wait_ms": 6.487742014346635, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00667572021484375, "StateBufferConnector_ms": 0.004075050354003906, "ViewRequirementAgentConnector_ms": 0.09052848815917969}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000, "num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 509.39827257396695, "num_env_steps_trained_throughput_per_sec": 509.39827257396695, "timesteps_total": 80000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 80000, "timers": {"training_iteration_time_ms": 7536.615, "sample_time_ms": 4048.818, "load_time_ms": 0.946, "load_throughput": 4226531.301, "learn_time_ms": 3483.363, "learn_throughput": 1148.316, "synch_weights_time_ms": 2.843}, "counters": {"num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000}, "done": false, "episodes_total": 754, "training_iteration": 20, "trial_id": "133f9_00000", "date": "2024-03-07_13-13-46", "timestamp": 1709835226, "time_this_iter_s": 7.855175495147705, "time_total_s": 148.57522249221802, "pid": 117779, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7efea6399f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 148.57522249221802, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 31.790000000000003, "ram_util_percent": 50.760000000000005, "gpu_util_percent0": 0.07200000000000001, "vram_util_percent0": 0.09396158854166667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 0.38902080091416225, "policy_loss": -0.014064595512845503, "vf_loss": 0.40141166296577263, "vf_explained_var": 0.8198183064178753, "kl": 0.00836864764037908, "entropy": 0.63749572006605, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 19065.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 84000}, "sampler_results": {"episode_reward_max": -1.600000000000001, "episode_reward_min": -13.799999999999963, "episode_reward_mean": -2.961538461538462, "episode_len_mean": 39.875, "episode_media": {}, "episodes_this_iter": 104, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2.3000000000000016, -2.900000000000002, -1.8000000000000012, -2.2000000000000015, -2.1000000000000014, -2.800000000000002, -2.2000000000000015, -2.700000000000002, -2.3000000000000016, -3.0000000000000018, -2.700000000000002, -2.600000000000002, -2.700000000000002, -1.8000000000000012, -3.3000000000000007, -1.600000000000001, -3.0000000000000018, -2.600000000000002, -3.5, -3.3000000000000007, -1.8000000000000012, -4.099999999999998, -6.700000000000003, -2.0000000000000013, -3.3000000000000007, -3.3000000000000007, -3.4000000000000004, -4.4999999999999964, -2.700000000000002, -2.700000000000002, -2.800000000000002, -3.1000000000000014, -2.900000000000002, -3.1000000000000014, -2.2000000000000015, -3.799999999999999, -2.3000000000000016, -4.199999999999998, -8.999999999999993, -2.700000000000002, -2.0000000000000013, -2.4000000000000017, -3.3000000000000007, -2.600000000000002, -2.700000000000002, -2.4000000000000017, -3.4000000000000004, -2.600000000000002, -2.4000000000000017, -2.1000000000000014, -2.5000000000000018, -3.200000000000001, -3.6999999999999993, -1.9000000000000012, -2.5000000000000018, -3.200000000000001, -3.5, -2.700000000000002, -3.0000000000000018, -2.700000000000002, -2.4000000000000017, -3.0000000000000018, -3.0000000000000018, -2.4000000000000017, -2.5000000000000018, -2.3000000000000016, -2.3000000000000016, -2.3000000000000016, -4.8, -3.5, -2.700000000000002, -3.0000000000000018, -2.0000000000000013, -3.4000000000000004, -2.4000000000000017, -2.0000000000000013, -2.0000000000000013, -3.400000000000002, -13.799999999999963, -2.5000000000000018, -2.700000000000002, -2.5000000000000018, -2.2000000000000015, -2.3000000000000016, -2.700000000000002, -2.600000000000002, -2.700000000000002, -2.900000000000002, -3.3000000000000025, -2.800000000000002, -2.3000000000000016, -2.5000000000000018, -3.1000000000000014, -2.1000000000000014, -6.199999999999998, -2.600000000000002, -2.700000000000002, -3.3000000000000007, -2.800000000000002, -2.3000000000000016, -2.700000000000002, -1.9000000000000012, -2.2000000000000015, -2.1000000000000014], "episode_lengths": [34, 40, 29, 33, 32, 39, 33, 38, 34, 41, 38, 37, 38, 29, 44, 27, 41, 37, 46, 44, 29, 52, 62, 31, 44, 44, 45, 56, 38, 38, 39, 42, 40, 42, 33, 49, 34, 52, 77, 38, 31, 35, 44, 37, 38, 35, 45, 37, 35, 32, 36, 43, 48, 30, 36, 43, 46, 38, 41, 38, 35, 41, 41, 35, 36, 34, 34, 34, 54, 46, 38, 41, 31, 45, 35, 31, 31, 42, 135, 36, 35, 36, 33, 34, 38, 37, 38, 40, 42, 39, 34, 36, 42, 32, 64, 37, 38, 44, 39, 34, 38, 30, 33, 32]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2822452725644792, "mean_inference_ms": 0.7247194911618138, "mean_action_processing_ms": 0.07650669791228946, "mean_env_wait_ms": 6.535283907077035, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0067360126055203955, "StateBufferConnector_ms": 0.004010246350215032, "ViewRequirementAgentConnector_ms": 0.0907377554820134}}, "episode_reward_max": -1.600000000000001, "episode_reward_min": -13.799999999999963, "episode_reward_mean": -2.961538461538462, "episode_len_mean": 39.875, "episodes_this_iter": 104, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-2.3000000000000016, -2.900000000000002, -1.8000000000000012, -2.2000000000000015, -2.1000000000000014, -2.800000000000002, -2.2000000000000015, -2.700000000000002, -2.3000000000000016, -3.0000000000000018, -2.700000000000002, -2.600000000000002, -2.700000000000002, -1.8000000000000012, -3.3000000000000007, -1.600000000000001, -3.0000000000000018, -2.600000000000002, -3.5, -3.3000000000000007, -1.8000000000000012, -4.099999999999998, -6.700000000000003, -2.0000000000000013, -3.3000000000000007, -3.3000000000000007, -3.4000000000000004, -4.4999999999999964, -2.700000000000002, -2.700000000000002, -2.800000000000002, -3.1000000000000014, -2.900000000000002, -3.1000000000000014, -2.2000000000000015, -3.799999999999999, -2.3000000000000016, -4.199999999999998, -8.999999999999993, -2.700000000000002, -2.0000000000000013, -2.4000000000000017, -3.3000000000000007, -2.600000000000002, -2.700000000000002, -2.4000000000000017, -3.4000000000000004, -2.600000000000002, -2.4000000000000017, -2.1000000000000014, -2.5000000000000018, -3.200000000000001, -3.6999999999999993, -1.9000000000000012, -2.5000000000000018, -3.200000000000001, -3.5, -2.700000000000002, -3.0000000000000018, -2.700000000000002, -2.4000000000000017, -3.0000000000000018, -3.0000000000000018, -2.4000000000000017, -2.5000000000000018, -2.3000000000000016, -2.3000000000000016, -2.3000000000000016, -4.8, -3.5, -2.700000000000002, -3.0000000000000018, -2.0000000000000013, -3.4000000000000004, -2.4000000000000017, -2.0000000000000013, -2.0000000000000013, -3.400000000000002, -13.799999999999963, -2.5000000000000018, -2.700000000000002, -2.5000000000000018, -2.2000000000000015, -2.3000000000000016, -2.700000000000002, -2.600000000000002, -2.700000000000002, -2.900000000000002, -3.3000000000000025, -2.800000000000002, -2.3000000000000016, -2.5000000000000018, -3.1000000000000014, -2.1000000000000014, -6.199999999999998, -2.600000000000002, -2.700000000000002, -3.3000000000000007, -2.800000000000002, -2.3000000000000016, -2.700000000000002, -1.9000000000000012, -2.2000000000000015, -2.1000000000000014], "episode_lengths": [34, 40, 29, 33, 32, 39, 33, 38, 34, 41, 38, 37, 38, 29, 44, 27, 41, 37, 46, 44, 29, 52, 62, 31, 44, 44, 45, 56, 38, 38, 39, 42, 40, 42, 33, 49, 34, 52, 77, 38, 31, 35, 44, 37, 38, 35, 45, 37, 35, 32, 36, 43, 48, 30, 36, 43, 46, 38, 41, 38, 35, 41, 41, 35, 36, 34, 34, 34, 54, 46, 38, 41, 31, 45, 35, 31, 31, 42, 135, 36, 35, 36, 33, 34, 38, 37, 38, 40, 42, 39, 34, 36, 42, 32, 64, 37, 38, 44, 39, 34, 38, 30, 33, 32]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2822452725644792, "mean_inference_ms": 0.7247194911618138, "mean_action_processing_ms": 0.07650669791228946, "mean_env_wait_ms": 6.535283907077035, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0067360126055203955, "StateBufferConnector_ms": 0.004010246350215032, "ViewRequirementAgentConnector_ms": 0.0907377554820134}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 84000, "num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 484.3896845063384, "num_env_steps_trained_throughput_per_sec": 484.3896845063384, "timesteps_total": 84000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 84000, "timers": {"training_iteration_time_ms": 7622.593, "sample_time_ms": 4128.41, "load_time_ms": 0.94, "load_throughput": 4254828.942, "learn_time_ms": 3489.819, "learn_throughput": 1146.191, "synch_weights_time_ms": 2.785}, "counters": {"num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 84000}, "done": false, "episodes_total": 858, "training_iteration": 21, "trial_id": "133f9_00000", "date": "2024-03-07_13-13-54", "timestamp": 1709835234, "time_this_iter_s": 8.260878562927246, "time_total_s": 156.83610105514526, "pid": 117779, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7efea6399f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 156.83610105514526, "iterations_since_restore": 21, "perf": {"cpu_util_percent": 29.36363636363636, "ram_util_percent": 50.7, "gpu_util_percent0": 0.07, "vram_util_percent0": 0.09394975142045454}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 1.529250729752965, "policy_loss": -0.003263520409343063, "vf_loss": 1.530679765872417, "vf_explained_var": 0.6511892930794788, "kl": 0.009172466920354066, "entropy": 0.6394193710819367, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 19995.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_agent_steps_sampled": 88000, "num_agent_steps_trained": 88000}, "sampler_results": {"episode_reward_max": -1.600000000000001, "episode_reward_min": -73.7000000000005, "episode_reward_mean": -3.4120000000000057, "episode_len_mean": 40.73, "episode_media": {}, "episodes_this_iter": 97, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1.9000000000000012, -2.2000000000000015, -2.1000000000000014, -2.0000000000000013, -73.7000000000005, -2.2000000000000015, -2.3000000000000016, -2.0000000000000013, -3.9999999999999982, -2.800000000000002, -1.9000000000000012, -2.2000000000000015, -4.1, -3.6000000000000014, -1.8000000000000012, -2.1000000000000014, -2.0000000000000013, -2.2000000000000015, -2.900000000000002, -2.0000000000000013, -2.4000000000000017, -2.600000000000002, -1.8000000000000012, -2.900000000000002, -2.3000000000000016, -2.2000000000000015, -2.600000000000002, -4.500000000000001, -1.8000000000000012, -2.5000000000000018, -1.8000000000000012, -2.1000000000000014, -3.9999999999999982, -3.0000000000000018, -2.2000000000000015, -3.3000000000000007, -4.3999999999999995, -2.800000000000002, -1.600000000000001, -3.8999999999999986, -3.5, -2.4000000000000017, -2.2000000000000015, -1.700000000000001, -2.1000000000000014, -2.5000000000000018, -6.8, -2.700000000000002, -2.2000000000000015, -2.1000000000000014, -2.600000000000002, -1.8000000000000012, -4.799999999999996, -2.3000000000000016, -2.2000000000000015, -2.700000000000002, -2.3000000000000016, -3.0000000000000018, -3.0000000000000018, -2.5000000000000018, -1.8000000000000012, -2.5000000000000018, -2.600000000000002, -2.600000000000002, -1.8000000000000012, -2.1000000000000014, -3.0000000000000018, -1.9000000000000012, -1.9000000000000012, -2.5000000000000018, -3.4000000000000004, -2.2000000000000015, -2.2000000000000015, -2.800000000000002, -2.4000000000000017, -2.2000000000000015, -1.9000000000000012, -2.1000000000000014, -2.1000000000000014, -2.4000000000000017, -3.200000000000001, -3.700000000000002, -2.1000000000000014, -2.2000000000000015, -2.5000000000000018, -10.999999999999988, -2.1000000000000014, -2.800000000000002, -2.4000000000000017, -2.5000000000000018, -2.5000000000000018, -2.900000000000002, -3.1000000000000014, -2.1000000000000014, -3.200000000000001, -2.4000000000000017, -3.4000000000000004, -1.9000000000000012, -6.300000000000002, -2.4000000000000017], "episode_lengths": [30, 33, 32, 31, 400, 33, 34, 31, 51, 39, 30, 33, 47, 45, 29, 32, 31, 33, 40, 31, 35, 37, 29, 40, 34, 33, 37, 45, 29, 36, 29, 32, 51, 41, 33, 44, 49, 38, 27, 50, 46, 35, 33, 28, 32, 36, 66, 38, 33, 32, 37, 29, 58, 34, 33, 38, 34, 41, 41, 36, 29, 36, 37, 37, 29, 32, 41, 30, 30, 36, 45, 33, 33, 39, 35, 33, 30, 32, 32, 35, 43, 42, 32, 33, 36, 88, 32, 39, 35, 36, 36, 40, 42, 32, 43, 35, 45, 30, 61, 35]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2867130255773113, "mean_inference_ms": 0.7240721632763232, "mean_action_processing_ms": 0.07609897901947395, "mean_env_wait_ms": 6.561333961618594, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006552696228027344, "StateBufferConnector_ms": 0.0040094852447509766, "ViewRequirementAgentConnector_ms": 0.08977341651916504}}, "episode_reward_max": -1.600000000000001, "episode_reward_min": -73.7000000000005, "episode_reward_mean": -3.4120000000000057, "episode_len_mean": 40.73, "episodes_this_iter": 97, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1.9000000000000012, -2.2000000000000015, -2.1000000000000014, -2.0000000000000013, -73.7000000000005, -2.2000000000000015, -2.3000000000000016, -2.0000000000000013, -3.9999999999999982, -2.800000000000002, -1.9000000000000012, -2.2000000000000015, -4.1, -3.6000000000000014, -1.8000000000000012, -2.1000000000000014, -2.0000000000000013, -2.2000000000000015, -2.900000000000002, -2.0000000000000013, -2.4000000000000017, -2.600000000000002, -1.8000000000000012, -2.900000000000002, -2.3000000000000016, -2.2000000000000015, -2.600000000000002, -4.500000000000001, -1.8000000000000012, -2.5000000000000018, -1.8000000000000012, -2.1000000000000014, -3.9999999999999982, -3.0000000000000018, -2.2000000000000015, -3.3000000000000007, -4.3999999999999995, -2.800000000000002, -1.600000000000001, -3.8999999999999986, -3.5, -2.4000000000000017, -2.2000000000000015, -1.700000000000001, -2.1000000000000014, -2.5000000000000018, -6.8, -2.700000000000002, -2.2000000000000015, -2.1000000000000014, -2.600000000000002, -1.8000000000000012, -4.799999999999996, -2.3000000000000016, -2.2000000000000015, -2.700000000000002, -2.3000000000000016, -3.0000000000000018, -3.0000000000000018, -2.5000000000000018, -1.8000000000000012, -2.5000000000000018, -2.600000000000002, -2.600000000000002, -1.8000000000000012, -2.1000000000000014, -3.0000000000000018, -1.9000000000000012, -1.9000000000000012, -2.5000000000000018, -3.4000000000000004, -2.2000000000000015, -2.2000000000000015, -2.800000000000002, -2.4000000000000017, -2.2000000000000015, -1.9000000000000012, -2.1000000000000014, -2.1000000000000014, -2.4000000000000017, -3.200000000000001, -3.700000000000002, -2.1000000000000014, -2.2000000000000015, -2.5000000000000018, -10.999999999999988, -2.1000000000000014, -2.800000000000002, -2.4000000000000017, -2.5000000000000018, -2.5000000000000018, -2.900000000000002, -3.1000000000000014, -2.1000000000000014, -3.200000000000001, -2.4000000000000017, -3.4000000000000004, -1.9000000000000012, -6.300000000000002, -2.4000000000000017], "episode_lengths": [30, 33, 32, 31, 400, 33, 34, 31, 51, 39, 30, 33, 47, 45, 29, 32, 31, 33, 40, 31, 35, 37, 29, 40, 34, 33, 37, 45, 29, 36, 29, 32, 51, 41, 33, 44, 49, 38, 27, 50, 46, 35, 33, 28, 32, 36, 66, 38, 33, 32, 37, 29, 58, 34, 33, 38, 34, 41, 41, 36, 29, 36, 37, 37, 29, 32, 41, 30, 30, 36, 45, 33, 33, 39, 35, 33, 30, 32, 32, 35, 43, 42, 32, 33, 36, 88, 32, 39, 35, 36, 36, 40, 42, 32, 43, 35, 45, 30, 61, 35]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2867130255773113, "mean_inference_ms": 0.7240721632763232, "mean_action_processing_ms": 0.07609897901947395, "mean_env_wait_ms": 6.561333961618594, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006552696228027344, "StateBufferConnector_ms": 0.0040094852447509766, "ViewRequirementAgentConnector_ms": 0.08977341651916504}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 88000, "num_agent_steps_trained": 88000, "num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 501.1087452012668, "num_env_steps_trained_throughput_per_sec": 501.1087452012668, "timesteps_total": 88000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 88000, "timers": {"training_iteration_time_ms": 7657.641, "sample_time_ms": 4162.507, "load_time_ms": 0.949, "load_throughput": 4214427.893, "learn_time_ms": 3490.79, "learn_throughput": 1145.872, "synch_weights_time_ms": 2.754}, "counters": {"num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_agent_steps_sampled": 88000, "num_agent_steps_trained": 88000}, "done": false, "episodes_total": 955, "training_iteration": 22, "trial_id": "133f9_00000", "date": "2024-03-07_13-14-02", "timestamp": 1709835242, "time_this_iter_s": 7.985191822052002, "time_total_s": 164.82129287719727, "pid": 117779, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7efea6399f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 164.82129287719727, "iterations_since_restore": 22, "perf": {"cpu_util_percent": 30.949999999999996, "ram_util_percent": 50.7, "gpu_util_percent0": 0.06999999999999999, "vram_util_percent0": 0.0939453125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 0.30452848152853346, "policy_loss": -0.013459912607426284, "vf_loss": 0.31649012135602134, "vf_explained_var": 0.8454975892138737, "kl": 0.007491361648838989, "entropy": 0.5578140829519559, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 20925.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_agent_steps_sampled": 92000, "num_agent_steps_trained": 92000}, "sampler_results": {"episode_reward_max": -1.5000000000000009, "episode_reward_min": -5.099999999999994, "episode_reward_mean": -2.5272727272727287, "episode_len_mean": 35.981818181818184, "episode_media": {}, "episodes_this_iter": 110, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2.2000000000000015, -2.2000000000000015, -2.600000000000002, -2.1000000000000014, -2.2000000000000015, -2.700000000000002, -3.5999999999999996, -2.600000000000002, -3.200000000000001, -2.2000000000000015, -2.900000000000002, -2.4000000000000017, -1.700000000000001, -1.9000000000000012, -3.0000000000000018, -2.600000000000002, -4.299999999999997, -3.5, -2.5000000000000018, -2.2000000000000015, -1.8000000000000012, -4.200000000000003, -3.1000000000000014, -2.4000000000000017, -2.2000000000000015, -3.0000000000000018, -2.3000000000000016, -2.5000000000000018, -2.2000000000000015, -3.200000000000001, -3.1000000000000014, -1.8000000000000012, -3.8999999999999986, -3.4000000000000004, -2.5000000000000018, -2.1000000000000014, -2.600000000000002, -3.5000000000000018, -2.4000000000000017, -1.8000000000000012, -2.1000000000000014, -2.900000000000002, -3.7, -1.8000000000000012, -2.3000000000000016, -2.5000000000000018, -2.700000000000002, -2.600000000000002, -2.5000000000000018, -1.600000000000001, -2.0000000000000013, -2.3000000000000016, -2.2000000000000015, -2.3000000000000016, -4.299999999999998, -2.0000000000000013, -1.700000000000001, -3.8, -3.200000000000001, -2.2000000000000015, -1.9000000000000012, -2.3000000000000016, -1.8000000000000012, -2.3000000000000016, -2.0000000000000013, -2.800000000000002, -2.5000000000000018, -2.1000000000000014, -1.600000000000001, -1.600000000000001, -2.700000000000002, -2.1000000000000014, -3.4000000000000004, -2.900000000000002, -2.3000000000000016, -2.800000000000002, -2.4000000000000017, -1.5000000000000009, -1.9000000000000012, -2.800000000000002, -1.9000000000000012, -1.8000000000000012, -2.1000000000000014, -2.4000000000000017, -2.3000000000000016, -2.4000000000000017, -2.0000000000000013, -3.0000000000000018, -2.600000000000002, -1.9000000000000012, -1.700000000000001, -2.1000000000000014, -2.0000000000000013, -1.8000000000000012, -2.800000000000002, -1.9000000000000012, -2.4000000000000017, -2.3000000000000016, -5.099999999999994, -2.4000000000000017, -3.4000000000000012, -3.1000000000000014, -2.800000000000002, -2.600000000000002, -3.5999999999999996, -2.600000000000002, -2.600000000000002, -2.5000000000000018, -2.900000000000002, -2.0000000000000013], "episode_lengths": [33, 33, 37, 32, 33, 38, 47, 37, 43, 33, 40, 35, 28, 30, 40, 37, 54, 46, 36, 33, 29, 42, 42, 35, 33, 41, 34, 36, 33, 43, 42, 29, 50, 42, 36, 32, 35, 42, 35, 29, 32, 40, 44, 29, 34, 36, 38, 37, 36, 27, 31, 34, 33, 34, 52, 31, 28, 48, 43, 33, 30, 34, 29, 34, 31, 39, 36, 32, 27, 27, 38, 32, 45, 40, 34, 39, 35, 26, 30, 39, 30, 29, 32, 35, 34, 35, 31, 41, 37, 30, 28, 32, 31, 29, 39, 30, 35, 34, 62, 35, 41, 42, 39, 37, 47, 37, 37, 36, 40, 31]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2911844039151587, "mean_inference_ms": 0.7245206053428429, "mean_action_processing_ms": 0.07645773104219365, "mean_env_wait_ms": 6.596180959237885, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006587938828901811, "StateBufferConnector_ms": 0.003964900970458984, "ViewRequirementAgentConnector_ms": 0.0902204080061479}}, "episode_reward_max": -1.5000000000000009, "episode_reward_min": -5.099999999999994, "episode_reward_mean": -2.5272727272727287, "episode_len_mean": 35.981818181818184, "episodes_this_iter": 110, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-2.2000000000000015, -2.2000000000000015, -2.600000000000002, -2.1000000000000014, -2.2000000000000015, -2.700000000000002, -3.5999999999999996, -2.600000000000002, -3.200000000000001, -2.2000000000000015, -2.900000000000002, -2.4000000000000017, -1.700000000000001, -1.9000000000000012, -3.0000000000000018, -2.600000000000002, -4.299999999999997, -3.5, -2.5000000000000018, -2.2000000000000015, -1.8000000000000012, -4.200000000000003, -3.1000000000000014, -2.4000000000000017, -2.2000000000000015, -3.0000000000000018, -2.3000000000000016, -2.5000000000000018, -2.2000000000000015, -3.200000000000001, -3.1000000000000014, -1.8000000000000012, -3.8999999999999986, -3.4000000000000004, -2.5000000000000018, -2.1000000000000014, -2.600000000000002, -3.5000000000000018, -2.4000000000000017, -1.8000000000000012, -2.1000000000000014, -2.900000000000002, -3.7, -1.8000000000000012, -2.3000000000000016, -2.5000000000000018, -2.700000000000002, -2.600000000000002, -2.5000000000000018, -1.600000000000001, -2.0000000000000013, -2.3000000000000016, -2.2000000000000015, -2.3000000000000016, -4.299999999999998, -2.0000000000000013, -1.700000000000001, -3.8, -3.200000000000001, -2.2000000000000015, -1.9000000000000012, -2.3000000000000016, -1.8000000000000012, -2.3000000000000016, -2.0000000000000013, -2.800000000000002, -2.5000000000000018, -2.1000000000000014, -1.600000000000001, -1.600000000000001, -2.700000000000002, -2.1000000000000014, -3.4000000000000004, -2.900000000000002, -2.3000000000000016, -2.800000000000002, -2.4000000000000017, -1.5000000000000009, -1.9000000000000012, -2.800000000000002, -1.9000000000000012, -1.8000000000000012, -2.1000000000000014, -2.4000000000000017, -2.3000000000000016, -2.4000000000000017, -2.0000000000000013, -3.0000000000000018, -2.600000000000002, -1.9000000000000012, -1.700000000000001, -2.1000000000000014, -2.0000000000000013, -1.8000000000000012, -2.800000000000002, -1.9000000000000012, -2.4000000000000017, -2.3000000000000016, -5.099999999999994, -2.4000000000000017, -3.4000000000000012, -3.1000000000000014, -2.800000000000002, -2.600000000000002, -3.5999999999999996, -2.600000000000002, -2.600000000000002, -2.5000000000000018, -2.900000000000002, -2.0000000000000013], "episode_lengths": [33, 33, 37, 32, 33, 38, 47, 37, 43, 33, 40, 35, 28, 30, 40, 37, 54, 46, 36, 33, 29, 42, 42, 35, 33, 41, 34, 36, 33, 43, 42, 29, 50, 42, 36, 32, 35, 42, 35, 29, 32, 40, 44, 29, 34, 36, 38, 37, 36, 27, 31, 34, 33, 34, 52, 31, 28, 48, 43, 33, 30, 34, 29, 34, 31, 39, 36, 32, 27, 27, 38, 32, 45, 40, 34, 39, 35, 26, 30, 39, 30, 29, 32, 35, 34, 35, 31, 41, 37, 30, 28, 32, 31, 29, 39, 30, 35, 34, 62, 35, 41, 42, 39, 37, 47, 37, 37, 36, 40, 31]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2911844039151587, "mean_inference_ms": 0.7245206053428429, "mean_action_processing_ms": 0.07645773104219365, "mean_env_wait_ms": 6.596180959237885, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006587938828901811, "StateBufferConnector_ms": 0.003964900970458984, "ViewRequirementAgentConnector_ms": 0.0902204080061479}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 92000, "num_agent_steps_trained": 92000, "num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 510.66856511864177, "num_env_steps_trained_throughput_per_sec": 510.66856511864177, "timesteps_total": 92000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 92000, "timers": {"training_iteration_time_ms": 7712.695, "sample_time_ms": 4211.879, "load_time_ms": 0.953, "load_throughput": 4196192.287, "learn_time_ms": 3496.471, "learn_throughput": 1144.011, "synch_weights_time_ms": 2.757}, "counters": {"num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_agent_steps_sampled": 92000, "num_agent_steps_trained": 92000}, "done": false, "episodes_total": 1065, "training_iteration": 23, "trial_id": "133f9_00000", "date": "2024-03-07_13-14-10", "timestamp": 1709835250, "time_this_iter_s": 7.835610389709473, "time_total_s": 172.65690326690674, "pid": 117779, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7efea6399f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 172.65690326690674, "iterations_since_restore": 23, "perf": {"cpu_util_percent": 31.98, "ram_util_percent": 50.7, "gpu_util_percent0": 0.074, "vram_util_percent0": 0.09398600260416667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 0.1716838177890637, "policy_loss": -0.010580556136706182, "vf_loss": 0.18110336285204656, "vf_explained_var": 0.8581716074738451, "kl": 0.00580505356537616, "entropy": 0.5055367236816755, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 21855.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000}, "sampler_results": {"episode_reward_max": -1.4000000000000008, "episode_reward_min": -4.8000000000000025, "episode_reward_mean": -2.409401709401711, "episode_len_mean": 34.837606837606835, "episode_media": {}, "episodes_this_iter": 117, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.4000000000000012, -2.0000000000000013, -2.1000000000000014, -2.0000000000000013, -2.2000000000000015, -1.9000000000000012, -1.9000000000000012, -2.0000000000000013, -1.9000000000000012, -2.0000000000000013, -1.8000000000000012, -1.5000000000000009, -2.4000000000000017, -2.3000000000000016, -2.2000000000000015, -2.0000000000000013, -2.4000000000000017, -3.4000000000000004, -2.4000000000000017, -1.9000000000000012, -1.8000000000000012, -2.700000000000002, -2.4000000000000017, -2.5000000000000018, -2.2000000000000015, -2.1000000000000014, -1.9000000000000012, -1.600000000000001, -2.800000000000002, -2.2000000000000015, -2.800000000000002, -4.299999999999997, -2.900000000000002, -1.700000000000001, -3.799999999999999, -1.8000000000000012, -1.8000000000000012, -1.600000000000001, -2.4000000000000017, -2.5000000000000018, -1.9000000000000012, -3.200000000000001, -2.700000000000002, -2.2000000000000015, -2.700000000000002, -4.200000000000001, -2.900000000000002, -1.8000000000000012, -3.0000000000000018, -1.9000000000000012, -3.5, -2.0000000000000013, -2.1000000000000014, -2.2000000000000015, -2.3000000000000016, -2.0000000000000013, -4.2, -1.5000000000000009, -2.4000000000000017, -2.1000000000000014, -3.5999999999999996, -2.700000000000002, -1.600000000000001, -3.3000000000000007, -2.5000000000000018, -2.3000000000000016, -3.8999999999999986, -2.800000000000002, -2.1000000000000014, -2.1000000000000014, -2.4000000000000017, -3.200000000000001, -3.200000000000001, -2.5000000000000018, -3.3000000000000007, -3.3000000000000007, -1.4000000000000008, -1.8000000000000012, -2.600000000000002, -1.8000000000000012, -3.4000000000000004, -2.800000000000002, -2.1000000000000014, -1.9000000000000012, -2.800000000000002, -2.4000000000000017, -2.5000000000000018, -4.8000000000000025, -3.4000000000000004, -1.600000000000001, -2.1000000000000014, -1.700000000000001, -1.8000000000000012, -1.8000000000000012, -3.0000000000000018, -1.9000000000000012, -2.2000000000000015, -3.9999999999999982, -1.9000000000000012, -2.700000000000002, -2.1000000000000014, -2.0000000000000013, -1.700000000000001, -2.4000000000000017, -1.8000000000000012, -4.1999999999999975, -1.8000000000000012, -2.800000000000002, -2.1000000000000014, -2.3000000000000016, -1.8000000000000012, -2.0000000000000013, -1.600000000000001, -2.2000000000000015, -1.600000000000001, -2.0000000000000013, -2.0000000000000013], "episode_lengths": [41, 31, 32, 31, 33, 30, 30, 31, 30, 31, 29, 26, 35, 34, 33, 31, 35, 45, 35, 30, 29, 38, 35, 36, 33, 32, 30, 27, 38, 33, 39, 53, 40, 28, 49, 29, 29, 27, 35, 36, 30, 43, 38, 33, 38, 48, 40, 29, 41, 30, 46, 31, 32, 33, 34, 31, 46, 26, 35, 32, 47, 38, 27, 44, 36, 34, 50, 39, 32, 32, 35, 43, 43, 36, 44, 44, 25, 29, 37, 29, 45, 39, 32, 30, 39, 35, 36, 47, 45, 27, 32, 28, 29, 29, 41, 30, 33, 51, 30, 38, 32, 31, 28, 35, 29, 53, 29, 39, 32, 34, 29, 31, 27, 33, 27, 31, 31]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2960823763196365, "mean_inference_ms": 0.724992166388649, "mean_action_processing_ms": 0.07645959981618348, "mean_env_wait_ms": 6.628089603695055, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006749691107334235, "StateBufferConnector_ms": 0.004022345583663028, "ViewRequirementAgentConnector_ms": 0.09025162101810814}}, "episode_reward_max": -1.4000000000000008, "episode_reward_min": -4.8000000000000025, "episode_reward_mean": -2.409401709401711, "episode_len_mean": 34.837606837606835, "episodes_this_iter": 117, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3.4000000000000012, -2.0000000000000013, -2.1000000000000014, -2.0000000000000013, -2.2000000000000015, -1.9000000000000012, -1.9000000000000012, -2.0000000000000013, -1.9000000000000012, -2.0000000000000013, -1.8000000000000012, -1.5000000000000009, -2.4000000000000017, -2.3000000000000016, -2.2000000000000015, -2.0000000000000013, -2.4000000000000017, -3.4000000000000004, -2.4000000000000017, -1.9000000000000012, -1.8000000000000012, -2.700000000000002, -2.4000000000000017, -2.5000000000000018, -2.2000000000000015, -2.1000000000000014, -1.9000000000000012, -1.600000000000001, -2.800000000000002, -2.2000000000000015, -2.800000000000002, -4.299999999999997, -2.900000000000002, -1.700000000000001, -3.799999999999999, -1.8000000000000012, -1.8000000000000012, -1.600000000000001, -2.4000000000000017, -2.5000000000000018, -1.9000000000000012, -3.200000000000001, -2.700000000000002, -2.2000000000000015, -2.700000000000002, -4.200000000000001, -2.900000000000002, -1.8000000000000012, -3.0000000000000018, -1.9000000000000012, -3.5, -2.0000000000000013, -2.1000000000000014, -2.2000000000000015, -2.3000000000000016, -2.0000000000000013, -4.2, -1.5000000000000009, -2.4000000000000017, -2.1000000000000014, -3.5999999999999996, -2.700000000000002, -1.600000000000001, -3.3000000000000007, -2.5000000000000018, -2.3000000000000016, -3.8999999999999986, -2.800000000000002, -2.1000000000000014, -2.1000000000000014, -2.4000000000000017, -3.200000000000001, -3.200000000000001, -2.5000000000000018, -3.3000000000000007, -3.3000000000000007, -1.4000000000000008, -1.8000000000000012, -2.600000000000002, -1.8000000000000012, -3.4000000000000004, -2.800000000000002, -2.1000000000000014, -1.9000000000000012, -2.800000000000002, -2.4000000000000017, -2.5000000000000018, -4.8000000000000025, -3.4000000000000004, -1.600000000000001, -2.1000000000000014, -1.700000000000001, -1.8000000000000012, -1.8000000000000012, -3.0000000000000018, -1.9000000000000012, -2.2000000000000015, -3.9999999999999982, -1.9000000000000012, -2.700000000000002, -2.1000000000000014, -2.0000000000000013, -1.700000000000001, -2.4000000000000017, -1.8000000000000012, -4.1999999999999975, -1.8000000000000012, -2.800000000000002, -2.1000000000000014, -2.3000000000000016, -1.8000000000000012, -2.0000000000000013, -1.600000000000001, -2.2000000000000015, -1.600000000000001, -2.0000000000000013, -2.0000000000000013], "episode_lengths": [41, 31, 32, 31, 33, 30, 30, 31, 30, 31, 29, 26, 35, 34, 33, 31, 35, 45, 35, 30, 29, 38, 35, 36, 33, 32, 30, 27, 38, 33, 39, 53, 40, 28, 49, 29, 29, 27, 35, 36, 30, 43, 38, 33, 38, 48, 40, 29, 41, 30, 46, 31, 32, 33, 34, 31, 46, 26, 35, 32, 47, 38, 27, 44, 36, 34, 50, 39, 32, 32, 35, 43, 43, 36, 44, 44, 25, 29, 37, 29, 45, 39, 32, 30, 39, 35, 36, 47, 45, 27, 32, 28, 29, 29, 41, 30, 33, 51, 30, 38, 32, 31, 28, 35, 29, 53, 29, 39, 32, 34, 29, 31, 27, 33, 27, 31, 31]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2960823763196365, "mean_inference_ms": 0.724992166388649, "mean_action_processing_ms": 0.07645959981618348, "mean_env_wait_ms": 6.628089603695055, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006749691107334235, "StateBufferConnector_ms": 0.004022345583663028, "ViewRequirementAgentConnector_ms": 0.09025162101810814}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000, "num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 510.38632069103295, "num_env_steps_trained_throughput_per_sec": 510.38632069103295, "timesteps_total": 96000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 96000, "timers": {"training_iteration_time_ms": 7745.737, "sample_time_ms": 4258.397, "load_time_ms": 0.956, "load_throughput": 4183531.407, "learn_time_ms": 3482.998, "learn_throughput": 1148.436, "synch_weights_time_ms": 2.75}, "counters": {"num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000}, "done": false, "episodes_total": 1182, "training_iteration": 24, "trial_id": "133f9_00000", "date": "2024-03-07_13-14-18", "timestamp": 1709835258, "time_this_iter_s": 7.840290784835815, "time_total_s": 180.49719405174255, "pid": 117779, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7efea6399f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 180.49719405174255, "iterations_since_restore": 24, "perf": {"cpu_util_percent": 30.10909090909091, "ram_util_percent": 50.7, "gpu_util_percent0": 0.09090909090909091, "vram_util_percent0": 0.09401633522727272}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 0.22776424745197899, "policy_loss": -0.009999090382048199, "vf_loss": 0.23551216118077758, "vf_explained_var": 0.9098903073418525, "kl": 0.01125587264316999, "entropy": 0.4620761446094, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 22785.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_agent_steps_sampled": 100000, "num_agent_steps_trained": 100000}, "sampler_results": {"episode_reward_max": -1.5000000000000009, "episode_reward_min": -10.599999999999987, "episode_reward_mean": -2.2783333333333347, "episode_len_mean": 33.46666666666667, "episode_media": {}, "episodes_this_iter": 120, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2.0000000000000013, -6.199999999999994, -3.0000000000000018, -2.5000000000000018, -2.1000000000000014, -1.8000000000000012, -2.2000000000000015, -2.1000000000000014, -3.5999999999999996, -2.3000000000000016, -2.600000000000002, -2.800000000000002, -2.4000000000000017, -1.8000000000000012, -2.3000000000000016, -2.2000000000000015, -2.600000000000002, -2.700000000000002, -1.8000000000000012, -2.1000000000000014, -2.3000000000000016, -1.8000000000000012, -2.5000000000000018, -2.3000000000000016, -2.2000000000000015, -1.600000000000001, -1.700000000000001, -1.9000000000000012, -2.1000000000000014, -2.3000000000000016, -2.1000000000000014, -10.599999999999987, -1.8000000000000012, -2.2000000000000015, -1.600000000000001, -3.500000000000001, -1.8000000000000012, -2.3000000000000016, -1.600000000000001, -2.5000000000000018, -3.1000000000000014, -1.700000000000001, -2.0000000000000013, -1.600000000000001, -2.4000000000000017, -3.799999999999999, -1.9000000000000012, -1.700000000000001, -1.700000000000001, -2.2000000000000015, -1.9000000000000012, -2.1000000000000014, -2.1000000000000014, -2.1000000000000014, -2.3000000000000016, -2.3000000000000016, -3.0000000000000018, -2.700000000000002, -1.8000000000000012, -2.1000000000000014, -2.1000000000000014, -1.700000000000001, -1.5000000000000009, -2.4000000000000017, -2.700000000000002, -2.0000000000000013, -1.8000000000000012, -1.700000000000001, -2.700000000000002, -2.1000000000000014, -1.600000000000001, -2.1000000000000014, -2.5000000000000018, -2.700000000000002, -2.1000000000000014, -2.0000000000000013, -2.4000000000000017, -1.700000000000001, -2.5000000000000018, -2.5000000000000018, -1.8000000000000012, -1.700000000000001, -2.3000000000000016, -2.0000000000000013, -2.800000000000002, -2.2000000000000015, -1.700000000000001, -2.2000000000000015, -2.900000000000002, -1.9000000000000012, -2.1000000000000014, -1.9000000000000012, -2.4000000000000017, -1.8000000000000012, -2.2000000000000015, -1.700000000000001, -1.700000000000001, -2.1000000000000014, -1.8000000000000012, -1.700000000000001, -1.700000000000001, -1.8000000000000012, -2.3000000000000016, -2.2000000000000015, -3.200000000000001, -2.1000000000000014, -2.1000000000000014, -2.0000000000000013, -1.8000000000000012, -2.4000000000000017, -2.3000000000000016, -1.5000000000000009, -2.0000000000000013, -1.9000000000000012, -2.4000000000000017, -1.700000000000001, -2.900000000000002, -2.0000000000000013, -2.2000000000000015, -2.900000000000002], "episode_lengths": [31, 69, 41, 36, 32, 29, 33, 32, 47, 34, 37, 39, 35, 29, 34, 33, 37, 38, 29, 32, 34, 29, 36, 34, 33, 27, 28, 30, 32, 34, 32, 87, 29, 33, 27, 45, 29, 34, 27, 36, 42, 28, 31, 27, 35, 49, 30, 28, 28, 33, 30, 32, 32, 32, 34, 34, 41, 38, 29, 32, 32, 28, 26, 35, 38, 31, 29, 28, 38, 32, 27, 32, 36, 38, 32, 31, 35, 28, 35, 34, 29, 28, 34, 31, 39, 33, 28, 33, 40, 30, 32, 30, 35, 29, 33, 28, 28, 32, 29, 28, 28, 29, 34, 33, 43, 32, 32, 31, 29, 35, 34, 26, 31, 30, 35, 28, 40, 31, 33, 40]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.301050775398163, "mean_inference_ms": 0.7249482634213563, "mean_action_processing_ms": 0.07636750538762443, "mean_env_wait_ms": 6.662407451873302, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006834069887797038, "StateBufferConnector_ms": 0.004037817319234212, "ViewRequirementAgentConnector_ms": 0.09060462315877278}}, "episode_reward_max": -1.5000000000000009, "episode_reward_min": -10.599999999999987, "episode_reward_mean": -2.2783333333333347, "episode_len_mean": 33.46666666666667, "episodes_this_iter": 120, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-2.0000000000000013, -6.199999999999994, -3.0000000000000018, -2.5000000000000018, -2.1000000000000014, -1.8000000000000012, -2.2000000000000015, -2.1000000000000014, -3.5999999999999996, -2.3000000000000016, -2.600000000000002, -2.800000000000002, -2.4000000000000017, -1.8000000000000012, -2.3000000000000016, -2.2000000000000015, -2.600000000000002, -2.700000000000002, -1.8000000000000012, -2.1000000000000014, -2.3000000000000016, -1.8000000000000012, -2.5000000000000018, -2.3000000000000016, -2.2000000000000015, -1.600000000000001, -1.700000000000001, -1.9000000000000012, -2.1000000000000014, -2.3000000000000016, -2.1000000000000014, -10.599999999999987, -1.8000000000000012, -2.2000000000000015, -1.600000000000001, -3.500000000000001, -1.8000000000000012, -2.3000000000000016, -1.600000000000001, -2.5000000000000018, -3.1000000000000014, -1.700000000000001, -2.0000000000000013, -1.600000000000001, -2.4000000000000017, -3.799999999999999, -1.9000000000000012, -1.700000000000001, -1.700000000000001, -2.2000000000000015, -1.9000000000000012, -2.1000000000000014, -2.1000000000000014, -2.1000000000000014, -2.3000000000000016, -2.3000000000000016, -3.0000000000000018, -2.700000000000002, -1.8000000000000012, -2.1000000000000014, -2.1000000000000014, -1.700000000000001, -1.5000000000000009, -2.4000000000000017, -2.700000000000002, -2.0000000000000013, -1.8000000000000012, -1.700000000000001, -2.700000000000002, -2.1000000000000014, -1.600000000000001, -2.1000000000000014, -2.5000000000000018, -2.700000000000002, -2.1000000000000014, -2.0000000000000013, -2.4000000000000017, -1.700000000000001, -2.5000000000000018, -2.5000000000000018, -1.8000000000000012, -1.700000000000001, -2.3000000000000016, -2.0000000000000013, -2.800000000000002, -2.2000000000000015, -1.700000000000001, -2.2000000000000015, -2.900000000000002, -1.9000000000000012, -2.1000000000000014, -1.9000000000000012, -2.4000000000000017, -1.8000000000000012, -2.2000000000000015, -1.700000000000001, -1.700000000000001, -2.1000000000000014, -1.8000000000000012, -1.700000000000001, -1.700000000000001, -1.8000000000000012, -2.3000000000000016, -2.2000000000000015, -3.200000000000001, -2.1000000000000014, -2.1000000000000014, -2.0000000000000013, -1.8000000000000012, -2.4000000000000017, -2.3000000000000016, -1.5000000000000009, -2.0000000000000013, -1.9000000000000012, -2.4000000000000017, -1.700000000000001, -2.900000000000002, -2.0000000000000013, -2.2000000000000015, -2.900000000000002], "episode_lengths": [31, 69, 41, 36, 32, 29, 33, 32, 47, 34, 37, 39, 35, 29, 34, 33, 37, 38, 29, 32, 34, 29, 36, 34, 33, 27, 28, 30, 32, 34, 32, 87, 29, 33, 27, 45, 29, 34, 27, 36, 42, 28, 31, 27, 35, 49, 30, 28, 28, 33, 30, 32, 32, 32, 34, 34, 41, 38, 29, 32, 32, 28, 26, 35, 38, 31, 29, 28, 38, 32, 27, 32, 36, 38, 32, 31, 35, 28, 35, 34, 29, 28, 34, 31, 39, 33, 28, 33, 40, 30, 32, 30, 35, 29, 33, 28, 28, 32, 29, 28, 28, 29, 34, 33, 43, 32, 32, 31, 29, 35, 34, 26, 31, 30, 35, 28, 40, 31, 33, 40]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.301050775398163, "mean_inference_ms": 0.7249482634213563, "mean_action_processing_ms": 0.07636750538762443, "mean_env_wait_ms": 6.662407451873302, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006834069887797038, "StateBufferConnector_ms": 0.004037817319234212, "ViewRequirementAgentConnector_ms": 0.09060462315877278}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 100000, "num_agent_steps_trained": 100000, "num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 492.4438997767315, "num_env_steps_trained_throughput_per_sec": 492.4438997767315, "timesteps_total": 100000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 100000, "timers": {"training_iteration_time_ms": 7821.575, "sample_time_ms": 4316.449, "load_time_ms": 0.96, "load_throughput": 4166596.136, "learn_time_ms": 3500.809, "learn_throughput": 1142.593, "synch_weights_time_ms": 2.725}, "counters": {"num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_agent_steps_sampled": 100000, "num_agent_steps_trained": 100000}, "done": false, "episodes_total": 1302, "training_iteration": 25, "trial_id": "133f9_00000", "date": "2024-03-07_13-14-26", "timestamp": 1709835266, "time_this_iter_s": 8.125746250152588, "time_total_s": 188.62294030189514, "pid": 117779, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7efea6399f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 188.62294030189514, "iterations_since_restore": 25, "perf": {"cpu_util_percent": 34.39999999999999, "ram_util_percent": 50.7, "gpu_util_percent0": 0.094, "vram_util_percent0": 0.0940185546875}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 0.07124307921991223, "policy_loss": -0.005564281701420744, "vf_loss": 0.07562418729767845, "vf_explained_var": 0.937225498819864, "kl": 0.005915874416387723, "entropy": 0.3996938463821206, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 23715.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 104000, "num_env_steps_trained": 104000, "num_agent_steps_sampled": 104000, "num_agent_steps_trained": 104000}, "sampler_results": {"episode_reward_max": -1.4000000000000008, "episode_reward_min": -4.000000000000003, "episode_reward_mean": -2.1120000000000014, "episode_len_mean": 31.976, "episode_media": {}, "episodes_this_iter": 125, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1.5000000000000009, -2.1000000000000014, -2.0000000000000013, -2.4000000000000017, -1.600000000000001, -2.0000000000000013, -1.9000000000000012, -1.9000000000000012, -1.600000000000001, -1.5000000000000009, -1.700000000000001, -2.0000000000000013, -2.0000000000000013, -1.700000000000001, -1.8000000000000012, -1.9000000000000012, -1.700000000000001, -2.2000000000000015, -2.2000000000000015, -2.900000000000002, -2.5000000000000018, -2.4000000000000017, -1.8000000000000012, -1.9000000000000012, -2.2000000000000015, -1.9000000000000012, -2.700000000000002, -1.8000000000000012, -3.200000000000001, -2.3000000000000016, -1.8000000000000012, -1.700000000000001, -2.800000000000002, -1.700000000000001, -2.5000000000000018, -2.3000000000000016, -1.9000000000000012, -2.2000000000000015, -2.600000000000002, -2.2000000000000015, -1.9000000000000012, -1.8000000000000012, -1.8000000000000012, -2.1000000000000014, -2.2000000000000015, -1.600000000000001, -2.0000000000000013, -1.8000000000000012, -2.1000000000000014, -3.5, -1.8000000000000012, -1.700000000000001, -2.2000000000000015, -2.1000000000000014, -1.9000000000000012, -1.9000000000000012, -2.5000000000000018, -2.2000000000000015, -1.700000000000001, -1.8000000000000012, -3.0000000000000018, -2.700000000000002, -2.3000000000000016, -1.9000000000000012, -1.5000000000000009, -2.4000000000000017, -2.0000000000000013, -1.700000000000001, -1.8000000000000012, -2.0000000000000013, -2.4000000000000017, -2.4000000000000017, -2.2000000000000015, -2.0000000000000013, -2.4000000000000017, -3.1000000000000014, -2.700000000000002, -2.3000000000000016, -3.1000000000000014, -2.0000000000000013, -1.8000000000000012, -3.0000000000000018, -1.700000000000001, -2.800000000000002, -2.900000000000002, -2.5000000000000018, -1.8000000000000012, -1.8000000000000012, -1.700000000000001, -1.4000000000000008, -2.0000000000000013, -3.4000000000000004, -1.5000000000000009, -2.3000000000000016, -1.8000000000000012, -2.1000000000000014, -1.600000000000001, -1.5000000000000009, -4.000000000000003, -2.4000000000000017, -2.3000000000000016, -1.700000000000001, -1.4000000000000008, -1.9000000000000012, -2.2000000000000015, -2.4000000000000017, -2.800000000000002, -2.3000000000000016, -2.0000000000000013, -1.8000000000000012, -1.700000000000001, -2.800000000000002, -1.700000000000001, -2.0000000000000013, -2.3000000000000016, -1.8000000000000012, -2.2000000000000015, -1.700000000000001, -2.800000000000002, -1.8000000000000012, -1.9000000000000012, -1.600000000000001, -1.8000000000000012, -1.9000000000000012, -1.700000000000001], "episode_lengths": [26, 32, 31, 35, 27, 31, 30, 30, 27, 26, 28, 31, 31, 28, 29, 30, 28, 33, 33, 40, 36, 35, 29, 30, 33, 30, 38, 29, 39, 34, 29, 28, 39, 28, 36, 34, 30, 33, 37, 33, 30, 29, 29, 32, 33, 27, 31, 29, 32, 46, 29, 28, 33, 32, 30, 30, 36, 33, 28, 29, 41, 34, 34, 30, 26, 35, 31, 28, 29, 31, 35, 32, 33, 31, 35, 42, 38, 34, 42, 31, 29, 41, 28, 39, 40, 36, 29, 29, 28, 25, 31, 45, 26, 34, 29, 32, 27, 26, 44, 35, 34, 28, 25, 30, 33, 35, 39, 34, 31, 29, 28, 39, 28, 31, 34, 29, 33, 28, 39, 29, 30, 27, 29, 30, 28]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3057117044040859, "mean_inference_ms": 0.7255061230066419, "mean_action_processing_ms": 0.07650207752503302, "mean_env_wait_ms": 6.6983569297558745, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0066986083984375, "StateBufferConnector_ms": 0.0040340423583984375, "ViewRequirementAgentConnector_ms": 0.09122371673583984}}, "episode_reward_max": -1.4000000000000008, "episode_reward_min": -4.000000000000003, "episode_reward_mean": -2.1120000000000014, "episode_len_mean": 31.976, "episodes_this_iter": 125, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1.5000000000000009, -2.1000000000000014, -2.0000000000000013, -2.4000000000000017, -1.600000000000001, -2.0000000000000013, -1.9000000000000012, -1.9000000000000012, -1.600000000000001, -1.5000000000000009, -1.700000000000001, -2.0000000000000013, -2.0000000000000013, -1.700000000000001, -1.8000000000000012, -1.9000000000000012, -1.700000000000001, -2.2000000000000015, -2.2000000000000015, -2.900000000000002, -2.5000000000000018, -2.4000000000000017, -1.8000000000000012, -1.9000000000000012, -2.2000000000000015, -1.9000000000000012, -2.700000000000002, -1.8000000000000012, -3.200000000000001, -2.3000000000000016, -1.8000000000000012, -1.700000000000001, -2.800000000000002, -1.700000000000001, -2.5000000000000018, -2.3000000000000016, -1.9000000000000012, -2.2000000000000015, -2.600000000000002, -2.2000000000000015, -1.9000000000000012, -1.8000000000000012, -1.8000000000000012, -2.1000000000000014, -2.2000000000000015, -1.600000000000001, -2.0000000000000013, -1.8000000000000012, -2.1000000000000014, -3.5, -1.8000000000000012, -1.700000000000001, -2.2000000000000015, -2.1000000000000014, -1.9000000000000012, -1.9000000000000012, -2.5000000000000018, -2.2000000000000015, -1.700000000000001, -1.8000000000000012, -3.0000000000000018, -2.700000000000002, -2.3000000000000016, -1.9000000000000012, -1.5000000000000009, -2.4000000000000017, -2.0000000000000013, -1.700000000000001, -1.8000000000000012, -2.0000000000000013, -2.4000000000000017, -2.4000000000000017, -2.2000000000000015, -2.0000000000000013, -2.4000000000000017, -3.1000000000000014, -2.700000000000002, -2.3000000000000016, -3.1000000000000014, -2.0000000000000013, -1.8000000000000012, -3.0000000000000018, -1.700000000000001, -2.800000000000002, -2.900000000000002, -2.5000000000000018, -1.8000000000000012, -1.8000000000000012, -1.700000000000001, -1.4000000000000008, -2.0000000000000013, -3.4000000000000004, -1.5000000000000009, -2.3000000000000016, -1.8000000000000012, -2.1000000000000014, -1.600000000000001, -1.5000000000000009, -4.000000000000003, -2.4000000000000017, -2.3000000000000016, -1.700000000000001, -1.4000000000000008, -1.9000000000000012, -2.2000000000000015, -2.4000000000000017, -2.800000000000002, -2.3000000000000016, -2.0000000000000013, -1.8000000000000012, -1.700000000000001, -2.800000000000002, -1.700000000000001, -2.0000000000000013, -2.3000000000000016, -1.8000000000000012, -2.2000000000000015, -1.700000000000001, -2.800000000000002, -1.8000000000000012, -1.9000000000000012, -1.600000000000001, -1.8000000000000012, -1.9000000000000012, -1.700000000000001], "episode_lengths": [26, 32, 31, 35, 27, 31, 30, 30, 27, 26, 28, 31, 31, 28, 29, 30, 28, 33, 33, 40, 36, 35, 29, 30, 33, 30, 38, 29, 39, 34, 29, 28, 39, 28, 36, 34, 30, 33, 37, 33, 30, 29, 29, 32, 33, 27, 31, 29, 32, 46, 29, 28, 33, 32, 30, 30, 36, 33, 28, 29, 41, 34, 34, 30, 26, 35, 31, 28, 29, 31, 35, 32, 33, 31, 35, 42, 38, 34, 42, 31, 29, 41, 28, 39, 40, 36, 29, 29, 28, 25, 31, 45, 26, 34, 29, 32, 27, 26, 44, 35, 34, 28, 25, 30, 33, 35, 39, 34, 31, 29, 28, 39, 28, 31, 34, 29, 33, 28, 39, 29, 30, 27, 29, 30, 28]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3057117044040859, "mean_inference_ms": 0.7255061230066419, "mean_action_processing_ms": 0.07650207752503302, "mean_env_wait_ms": 6.6983569297558745, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0066986083984375, "StateBufferConnector_ms": 0.0040340423583984375, "ViewRequirementAgentConnector_ms": 0.09122371673583984}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 104000, "num_agent_steps_trained": 104000, "num_env_steps_sampled": 104000, "num_env_steps_trained": 104000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 485.038488466412, "num_env_steps_trained_throughput_per_sec": 485.038488466412, "timesteps_total": 104000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 104000, "timers": {"training_iteration_time_ms": 7891.396, "sample_time_ms": 4395.95, "load_time_ms": 0.96, "load_throughput": 4164734.386, "learn_time_ms": 3491.102, "learn_throughput": 1145.77, "synch_weights_time_ms": 2.75}, "counters": {"num_env_steps_sampled": 104000, "num_env_steps_trained": 104000, "num_agent_steps_sampled": 104000, "num_agent_steps_trained": 104000}, "done": false, "episodes_total": 1427, "training_iteration": 26, "trial_id": "133f9_00000", "date": "2024-03-07_13-14-34", "timestamp": 1709835274, "time_this_iter_s": 8.249975681304932, "time_total_s": 196.87291598320007, "pid": 117779, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7efea6399f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 196.87291598320007, "iterations_since_restore": 26, "perf": {"cpu_util_percent": 30.11818181818182, "ram_util_percent": 50.7, "gpu_util_percent0": 0.07636363636363637, "vram_util_percent0": 0.09401633522727272}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 0.026150182146398773, "policy_loss": -0.004771955187122027, "vf_loss": 0.029265804667907055, "vf_explained_var": 0.9691354218349661, "kl": 0.008281668285291132, "entropy": 0.3470081752987318, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 24645.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_agent_steps_sampled": 108000, "num_agent_steps_trained": 108000}, "sampler_results": {"episode_reward_max": -1.4000000000000008, "episode_reward_min": -3.200000000000001, "episode_reward_mean": -1.971755725190841, "episode_len_mean": 30.717557251908396, "episode_media": {}, "episodes_this_iter": 131, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1.700000000000001, -1.9000000000000012, -1.700000000000001, -1.8000000000000012, -1.8000000000000012, -2.0000000000000013, -1.5000000000000009, -2.1000000000000014, -2.2000000000000015, -2.800000000000002, -1.700000000000001, -2.2000000000000015, -2.1000000000000014, -1.8000000000000012, -2.1000000000000014, -2.0000000000000013, -1.8000000000000012, -2.600000000000002, -1.600000000000001, -1.9000000000000012, -2.2000000000000015, -2.3000000000000016, -1.9000000000000012, -1.9000000000000012, -2.600000000000002, -1.700000000000001, -1.9000000000000012, -1.9000000000000012, -2.3000000000000016, -2.0000000000000013, -1.600000000000001, -1.700000000000001, -2.600000000000002, -1.700000000000001, -2.0000000000000013, -1.600000000000001, -2.3000000000000016, -1.8000000000000012, -2.0000000000000013, -2.3000000000000016, -2.0000000000000013, -2.4000000000000017, -1.600000000000001, -1.9000000000000012, -1.700000000000001, -1.8000000000000012, -1.700000000000001, -2.700000000000002, -1.700000000000001, -2.0000000000000013, -2.0000000000000013, -2.4000000000000017, -1.9000000000000012, -1.8000000000000012, -2.1000000000000014, -2.1000000000000014, -2.1000000000000014, -2.4000000000000017, -1.9000000000000012, -2.0000000000000013, -2.3000000000000016, -1.700000000000001, -2.1000000000000014, -1.8000000000000012, -2.0000000000000013, -2.2000000000000015, -2.3000000000000016, -3.200000000000001, -1.700000000000001, -1.600000000000001, -1.9000000000000012, -1.600000000000001, -1.700000000000001, -1.600000000000001, -1.9000000000000012, -1.8000000000000012, -2.900000000000002, -1.700000000000001, -2.700000000000002, -1.600000000000001, -2.1000000000000014, -1.600000000000001, -1.8000000000000012, -2.2000000000000015, -1.8000000000000012, -1.5000000000000009, -2.2000000000000015, -1.600000000000001, -1.4000000000000008, -1.700000000000001, -2.1000000000000014, -1.9000000000000012, -1.8000000000000012, -2.2000000000000015, -2.2000000000000015, -2.4000000000000017, -1.700000000000001, -2.2000000000000015, -2.1000000000000014, -2.1000000000000014, -1.8000000000000012, -1.700000000000001, -1.8000000000000012, -3.200000000000001, -2.0000000000000013, -1.600000000000001, -1.9000000000000012, -1.8000000000000012, -1.8000000000000012, -2.0000000000000013, -1.5000000000000009, -1.9000000000000012, -1.9000000000000012, -2.0000000000000013, -2.3000000000000016, -1.5000000000000009, -2.2000000000000015, -2.600000000000002, -2.1000000000000014, -1.4000000000000008, -1.4000000000000008, -1.9000000000000012, -2.0000000000000013, -1.8000000000000012, -1.600000000000001, -2.1000000000000014, -1.8000000000000012, -2.2000000000000015, -1.9000000000000012, -1.600000000000001, -2.3000000000000016], "episode_lengths": [28, 30, 28, 29, 29, 31, 26, 32, 33, 39, 28, 33, 32, 29, 32, 31, 29, 37, 27, 30, 33, 34, 30, 30, 37, 28, 30, 30, 34, 31, 27, 28, 37, 28, 31, 27, 34, 29, 31, 34, 31, 35, 27, 30, 28, 29, 28, 38, 28, 31, 31, 35, 30, 29, 32, 32, 32, 35, 30, 31, 34, 28, 32, 29, 31, 33, 34, 43, 28, 27, 30, 27, 28, 27, 30, 29, 40, 28, 38, 27, 32, 27, 29, 33, 29, 26, 33, 27, 25, 28, 32, 30, 29, 33, 33, 35, 28, 33, 32, 32, 29, 28, 29, 43, 31, 27, 30, 29, 29, 31, 26, 30, 30, 31, 34, 26, 33, 37, 32, 25, 25, 30, 31, 29, 27, 32, 29, 33, 30, 27, 34]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3103728878696786, "mean_inference_ms": 0.7253671407296115, "mean_action_processing_ms": 0.07644984171990087, "mean_env_wait_ms": 6.7293186457557095, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0066955580966163225, "StateBufferConnector_ms": 0.004024906012848133, "ViewRequirementAgentConnector_ms": 0.09073865322666314}}, "episode_reward_max": -1.4000000000000008, "episode_reward_min": -3.200000000000001, "episode_reward_mean": -1.971755725190841, "episode_len_mean": 30.717557251908396, "episodes_this_iter": 131, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1.700000000000001, -1.9000000000000012, -1.700000000000001, -1.8000000000000012, -1.8000000000000012, -2.0000000000000013, -1.5000000000000009, -2.1000000000000014, -2.2000000000000015, -2.800000000000002, -1.700000000000001, -2.2000000000000015, -2.1000000000000014, -1.8000000000000012, -2.1000000000000014, -2.0000000000000013, -1.8000000000000012, -2.600000000000002, -1.600000000000001, -1.9000000000000012, -2.2000000000000015, -2.3000000000000016, -1.9000000000000012, -1.9000000000000012, -2.600000000000002, -1.700000000000001, -1.9000000000000012, -1.9000000000000012, -2.3000000000000016, -2.0000000000000013, -1.600000000000001, -1.700000000000001, -2.600000000000002, -1.700000000000001, -2.0000000000000013, -1.600000000000001, -2.3000000000000016, -1.8000000000000012, -2.0000000000000013, -2.3000000000000016, -2.0000000000000013, -2.4000000000000017, -1.600000000000001, -1.9000000000000012, -1.700000000000001, -1.8000000000000012, -1.700000000000001, -2.700000000000002, -1.700000000000001, -2.0000000000000013, -2.0000000000000013, -2.4000000000000017, -1.9000000000000012, -1.8000000000000012, -2.1000000000000014, -2.1000000000000014, -2.1000000000000014, -2.4000000000000017, -1.9000000000000012, -2.0000000000000013, -2.3000000000000016, -1.700000000000001, -2.1000000000000014, -1.8000000000000012, -2.0000000000000013, -2.2000000000000015, -2.3000000000000016, -3.200000000000001, -1.700000000000001, -1.600000000000001, -1.9000000000000012, -1.600000000000001, -1.700000000000001, -1.600000000000001, -1.9000000000000012, -1.8000000000000012, -2.900000000000002, -1.700000000000001, -2.700000000000002, -1.600000000000001, -2.1000000000000014, -1.600000000000001, -1.8000000000000012, -2.2000000000000015, -1.8000000000000012, -1.5000000000000009, -2.2000000000000015, -1.600000000000001, -1.4000000000000008, -1.700000000000001, -2.1000000000000014, -1.9000000000000012, -1.8000000000000012, -2.2000000000000015, -2.2000000000000015, -2.4000000000000017, -1.700000000000001, -2.2000000000000015, -2.1000000000000014, -2.1000000000000014, -1.8000000000000012, -1.700000000000001, -1.8000000000000012, -3.200000000000001, -2.0000000000000013, -1.600000000000001, -1.9000000000000012, -1.8000000000000012, -1.8000000000000012, -2.0000000000000013, -1.5000000000000009, -1.9000000000000012, -1.9000000000000012, -2.0000000000000013, -2.3000000000000016, -1.5000000000000009, -2.2000000000000015, -2.600000000000002, -2.1000000000000014, -1.4000000000000008, -1.4000000000000008, -1.9000000000000012, -2.0000000000000013, -1.8000000000000012, -1.600000000000001, -2.1000000000000014, -1.8000000000000012, -2.2000000000000015, -1.9000000000000012, -1.600000000000001, -2.3000000000000016], "episode_lengths": [28, 30, 28, 29, 29, 31, 26, 32, 33, 39, 28, 33, 32, 29, 32, 31, 29, 37, 27, 30, 33, 34, 30, 30, 37, 28, 30, 30, 34, 31, 27, 28, 37, 28, 31, 27, 34, 29, 31, 34, 31, 35, 27, 30, 28, 29, 28, 38, 28, 31, 31, 35, 30, 29, 32, 32, 32, 35, 30, 31, 34, 28, 32, 29, 31, 33, 34, 43, 28, 27, 30, 27, 28, 27, 30, 29, 40, 28, 38, 27, 32, 27, 29, 33, 29, 26, 33, 27, 25, 28, 32, 30, 29, 33, 33, 35, 28, 33, 32, 32, 29, 28, 29, 43, 31, 27, 30, 29, 29, 31, 26, 30, 30, 31, 34, 26, 33, 37, 32, 25, 25, 30, 31, 29, 27, 32, 29, 33, 30, 27, 34]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3103728878696786, "mean_inference_ms": 0.7253671407296115, "mean_action_processing_ms": 0.07644984171990087, "mean_env_wait_ms": 6.7293186457557095, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0066955580966163225, "StateBufferConnector_ms": 0.004024906012848133, "ViewRequirementAgentConnector_ms": 0.09073865322666314}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 108000, "num_agent_steps_trained": 108000, "num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 497.0391047450581, "num_env_steps_trained_throughput_per_sec": 497.0391047450581, "timesteps_total": 108000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 108000, "timers": {"training_iteration_time_ms": 7948.903, "sample_time_ms": 4454.026, "load_time_ms": 0.984, "load_throughput": 4066710.944, "learn_time_ms": 3490.549, "learn_throughput": 1145.952, "synch_weights_time_ms": 2.698}, "counters": {"num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_agent_steps_sampled": 108000, "num_agent_steps_trained": 108000}, "done": false, "episodes_total": 1558, "training_iteration": 27, "trial_id": "133f9_00000", "date": "2024-03-07_13-14-42", "timestamp": 1709835282, "time_this_iter_s": 8.050644636154175, "time_total_s": 204.92356061935425, "pid": 117779, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7efea6399f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 204.92356061935425, "iterations_since_restore": 27, "perf": {"cpu_util_percent": 31.97, "ram_util_percent": 50.7, "gpu_util_percent0": 0.07500000000000001, "vram_util_percent0": 0.09400227864583334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 0.0760469546917105, "policy_loss": -0.015460418369020186, "vf_loss": 0.08964978759777882, "vf_explained_var": 0.9568861180736172, "kl": 0.009287929452414584, "entropy": 0.3199916000487984, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 25575.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_agent_steps_sampled": 112000, "num_agent_steps_trained": 112000}, "sampler_results": {"episode_reward_max": -1.4000000000000008, "episode_reward_min": -5.5999999999999925, "episode_reward_mean": -1.9393939393939408, "episode_len_mean": 30.386363636363637, "episode_media": {}, "episodes_this_iter": 132, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1.700000000000001, -1.9000000000000012, -1.5000000000000009, -1.700000000000001, -2.3000000000000016, -2.3000000000000016, -1.9000000000000012, -1.700000000000001, -1.5000000000000009, -2.1000000000000014, -2.0000000000000013, -1.8000000000000012, -1.8000000000000012, -2.0000000000000013, -1.8000000000000012, -1.8000000000000012, -2.1000000000000014, -1.600000000000001, -1.700000000000001, -1.9000000000000012, -1.8000000000000012, -2.900000000000002, -1.8000000000000012, -2.4000000000000017, -2.3000000000000016, -1.700000000000001, -1.8000000000000012, -2.1000000000000014, -1.700000000000001, -1.700000000000001, -1.600000000000001, -2.1000000000000014, -1.700000000000001, -2.1000000000000014, -1.5000000000000009, -1.600000000000001, -2.2000000000000015, -1.8000000000000012, -1.700000000000001, -1.9000000000000012, -1.8000000000000012, -1.600000000000001, -2.0000000000000013, -1.5000000000000009, -1.600000000000001, -1.600000000000001, -1.9000000000000012, -1.600000000000001, -1.600000000000001, -1.8000000000000012, -2.1000000000000014, -1.8000000000000012, -1.9000000000000012, -2.2000000000000015, -1.600000000000001, -1.600000000000001, -1.5000000000000009, -2.0000000000000013, -2.1000000000000014, -1.700000000000001, -2.1000000000000014, -1.700000000000001, -1.9000000000000012, -1.700000000000001, -2.0000000000000013, -2.1000000000000014, -1.600000000000001, -1.600000000000001, -1.4000000000000008, -1.4000000000000008, -2.1000000000000014, -1.8000000000000012, -2.0000000000000013, -2.1000000000000014, -2.2000000000000015, -1.5000000000000009, -1.8000000000000012, -2.0000000000000013, -1.5000000000000009, -2.2000000000000015, -1.600000000000001, -2.1000000000000014, -1.600000000000001, -1.9000000000000012, -1.600000000000001, -1.9000000000000012, -1.9000000000000012, -1.700000000000001, -2.1000000000000014, -1.700000000000001, -1.8000000000000012, -2.5000000000000018, -1.8000000000000012, -5.5999999999999925, -1.9000000000000012, -2.2000000000000015, -1.700000000000001, -2.5000000000000018, -1.8000000000000012, -2.4000000000000017, -2.3000000000000016, -1.600000000000001, -1.9000000000000012, -2.2000000000000015, -2.2000000000000015, -2.0000000000000013, -2.1000000000000014, -1.4000000000000008, -1.700000000000001, -1.700000000000001, -1.9000000000000012, -1.8000000000000012, -1.9000000000000012, -2.1000000000000014, -1.700000000000001, -2.3000000000000016, -2.4000000000000017, -2.3000000000000016, -2.2000000000000015, -1.600000000000001, -1.700000000000001, -2.4000000000000017, -2.0000000000000013, -2.1000000000000014, -2.800000000000002, -2.4000000000000017, -2.3000000000000016, -1.8000000000000012, -2.3000000000000016, -2.0000000000000013, -2.2000000000000015, -2.700000000000002], "episode_lengths": [28, 30, 26, 28, 34, 34, 30, 28, 26, 32, 31, 29, 29, 31, 29, 29, 32, 27, 28, 30, 29, 40, 29, 35, 34, 28, 29, 32, 28, 28, 27, 32, 28, 32, 26, 27, 33, 29, 28, 30, 29, 27, 31, 26, 27, 27, 30, 27, 27, 29, 32, 29, 30, 33, 27, 27, 26, 31, 32, 28, 32, 28, 30, 28, 31, 32, 27, 27, 25, 25, 32, 29, 31, 32, 33, 26, 29, 31, 26, 33, 27, 31, 27, 30, 27, 30, 30, 28, 32, 28, 29, 36, 29, 67, 30, 33, 28, 36, 29, 35, 34, 27, 30, 33, 33, 31, 32, 25, 28, 28, 30, 29, 30, 32, 28, 34, 35, 34, 33, 27, 28, 35, 31, 32, 39, 35, 34, 29, 34, 31, 33, 38]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.31520626176529115, "mean_inference_ms": 0.7261280531700909, "mean_action_processing_ms": 0.07651847571123795, "mean_env_wait_ms": 6.766769498810413, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006956403905695135, "StateBufferConnector_ms": 0.004178827459161932, "ViewRequirementAgentConnector_ms": 0.09316061482285008}}, "episode_reward_max": -1.4000000000000008, "episode_reward_min": -5.5999999999999925, "episode_reward_mean": -1.9393939393939408, "episode_len_mean": 30.386363636363637, "episodes_this_iter": 132, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1.700000000000001, -1.9000000000000012, -1.5000000000000009, -1.700000000000001, -2.3000000000000016, -2.3000000000000016, -1.9000000000000012, -1.700000000000001, -1.5000000000000009, -2.1000000000000014, -2.0000000000000013, -1.8000000000000012, -1.8000000000000012, -2.0000000000000013, -1.8000000000000012, -1.8000000000000012, -2.1000000000000014, -1.600000000000001, -1.700000000000001, -1.9000000000000012, -1.8000000000000012, -2.900000000000002, -1.8000000000000012, -2.4000000000000017, -2.3000000000000016, -1.700000000000001, -1.8000000000000012, -2.1000000000000014, -1.700000000000001, -1.700000000000001, -1.600000000000001, -2.1000000000000014, -1.700000000000001, -2.1000000000000014, -1.5000000000000009, -1.600000000000001, -2.2000000000000015, -1.8000000000000012, -1.700000000000001, -1.9000000000000012, -1.8000000000000012, -1.600000000000001, -2.0000000000000013, -1.5000000000000009, -1.600000000000001, -1.600000000000001, -1.9000000000000012, -1.600000000000001, -1.600000000000001, -1.8000000000000012, -2.1000000000000014, -1.8000000000000012, -1.9000000000000012, -2.2000000000000015, -1.600000000000001, -1.600000000000001, -1.5000000000000009, -2.0000000000000013, -2.1000000000000014, -1.700000000000001, -2.1000000000000014, -1.700000000000001, -1.9000000000000012, -1.700000000000001, -2.0000000000000013, -2.1000000000000014, -1.600000000000001, -1.600000000000001, -1.4000000000000008, -1.4000000000000008, -2.1000000000000014, -1.8000000000000012, -2.0000000000000013, -2.1000000000000014, -2.2000000000000015, -1.5000000000000009, -1.8000000000000012, -2.0000000000000013, -1.5000000000000009, -2.2000000000000015, -1.600000000000001, -2.1000000000000014, -1.600000000000001, -1.9000000000000012, -1.600000000000001, -1.9000000000000012, -1.9000000000000012, -1.700000000000001, -2.1000000000000014, -1.700000000000001, -1.8000000000000012, -2.5000000000000018, -1.8000000000000012, -5.5999999999999925, -1.9000000000000012, -2.2000000000000015, -1.700000000000001, -2.5000000000000018, -1.8000000000000012, -2.4000000000000017, -2.3000000000000016, -1.600000000000001, -1.9000000000000012, -2.2000000000000015, -2.2000000000000015, -2.0000000000000013, -2.1000000000000014, -1.4000000000000008, -1.700000000000001, -1.700000000000001, -1.9000000000000012, -1.8000000000000012, -1.9000000000000012, -2.1000000000000014, -1.700000000000001, -2.3000000000000016, -2.4000000000000017, -2.3000000000000016, -2.2000000000000015, -1.600000000000001, -1.700000000000001, -2.4000000000000017, -2.0000000000000013, -2.1000000000000014, -2.800000000000002, -2.4000000000000017, -2.3000000000000016, -1.8000000000000012, -2.3000000000000016, -2.0000000000000013, -2.2000000000000015, -2.700000000000002], "episode_lengths": [28, 30, 26, 28, 34, 34, 30, 28, 26, 32, 31, 29, 29, 31, 29, 29, 32, 27, 28, 30, 29, 40, 29, 35, 34, 28, 29, 32, 28, 28, 27, 32, 28, 32, 26, 27, 33, 29, 28, 30, 29, 27, 31, 26, 27, 27, 30, 27, 27, 29, 32, 29, 30, 33, 27, 27, 26, 31, 32, 28, 32, 28, 30, 28, 31, 32, 27, 27, 25, 25, 32, 29, 31, 32, 33, 26, 29, 31, 26, 33, 27, 31, 27, 30, 27, 30, 30, 28, 32, 28, 29, 36, 29, 67, 30, 33, 28, 36, 29, 35, 34, 27, 30, 33, 33, 31, 32, 25, 28, 28, 30, 29, 30, 32, 28, 34, 35, 34, 33, 27, 28, 35, 31, 32, 39, 35, 34, 29, 34, 31, 33, 38]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.31520626176529115, "mean_inference_ms": 0.7261280531700909, "mean_action_processing_ms": 0.07651847571123795, "mean_env_wait_ms": 6.766769498810413, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006956403905695135, "StateBufferConnector_ms": 0.004178827459161932, "ViewRequirementAgentConnector_ms": 0.09316061482285008}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 112000, "num_agent_steps_trained": 112000, "num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 489.5562055199181, "num_env_steps_trained_throughput_per_sec": 489.5562055199181, "timesteps_total": 112000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 112000, "timers": {"training_iteration_time_ms": 7990.875, "sample_time_ms": 4493.931, "load_time_ms": 0.984, "load_throughput": 4064641.923, "learn_time_ms": 3492.64, "learn_throughput": 1145.265, "synch_weights_time_ms": 2.671}, "counters": {"num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_agent_steps_sampled": 112000, "num_agent_steps_trained": 112000}, "done": false, "episodes_total": 1690, "training_iteration": 28, "trial_id": "133f9_00000", "date": "2024-03-07_13-14-50", "timestamp": 1709835290, "time_this_iter_s": 8.173714637756348, "time_total_s": 213.0972752571106, "pid": 117779, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7efea6399f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 213.0972752571106, "iterations_since_restore": 28, "perf": {"cpu_util_percent": 31.809090909090912, "ram_util_percent": 50.72727272727273, "gpu_util_percent0": 0.07909090909090909, "vram_util_percent0": 0.09400893702651514}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 0.12779672272723688, "policy_loss": -0.0036683140322566034, "vf_loss": 0.12954021679658081, "vf_explained_var": 0.9173586355742588, "kl": 0.00962409440486949, "entropy": 0.3123393536895834, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 26505.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 116000, "num_env_steps_trained": 116000, "num_agent_steps_sampled": 116000, "num_agent_steps_trained": 116000}, "sampler_results": {"episode_reward_max": -1.4000000000000008, "episode_reward_min": -5.300000000000003, "episode_reward_mean": -1.903759398496242, "episode_len_mean": 29.834586466165412, "episode_media": {}, "episodes_this_iter": 133, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2.0000000000000013, -1.8000000000000012, -1.8000000000000012, -1.700000000000001, -1.700000000000001, -1.4000000000000008, -1.700000000000001, -1.8000000000000012, -1.700000000000001, -1.5000000000000009, -2.1000000000000014, -1.5000000000000009, -2.0000000000000013, -1.8000000000000012, -1.600000000000001, -5.300000000000003, -1.4000000000000008, -1.700000000000001, -1.8000000000000012, -2.600000000000002, -1.600000000000001, -1.700000000000001, -2.3000000000000016, -1.8000000000000012, -1.9000000000000012, -1.700000000000001, -2.2000000000000015, -3.1000000000000014, -1.4000000000000008, -1.8000000000000012, -1.8000000000000012, -1.700000000000001, -1.8000000000000012, -2.2000000000000015, -1.5000000000000009, -1.600000000000001, -2.3000000000000016, -2.0000000000000013, -1.700000000000001, -1.700000000000001, -1.8000000000000012, -1.5000000000000009, -2.2000000000000015, -1.5000000000000009, -1.600000000000001, -1.4000000000000008, -1.9000000000000012, -1.9000000000000012, -1.600000000000001, -1.700000000000001, -1.700000000000001, -2.1000000000000014, -1.600000000000001, -1.9000000000000012, -1.700000000000001, -2.5000000000000018, -1.600000000000001, -1.9000000000000012, -1.9000000000000012, -1.600000000000001, -1.4000000000000008, -2.3000000000000016, -1.700000000000001, -1.700000000000001, -2.1000000000000014, -1.700000000000001, -1.5000000000000009, -1.700000000000001, -1.700000000000001, -1.9000000000000012, -1.9000000000000012, -1.8000000000000012, -2.3000000000000016, -2.2000000000000015, -2.1000000000000014, -2.0000000000000013, -1.8000000000000012, -1.9000000000000012, -1.600000000000001, -2.1000000000000014, -1.9000000000000012, -1.600000000000001, -1.700000000000001, -2.0000000000000013, -1.9000000000000012, -1.9000000000000012, -2.0000000000000013, -2.4000000000000017, -3.4000000000000004, -2.3000000000000016, -1.8000000000000012, -1.5000000000000009, -1.5000000000000009, -2.4000000000000017, -1.700000000000001, -2.2000000000000015, -3.0000000000000018, -2.5000000000000018, -1.8000000000000012, -2.3000000000000016, -2.3000000000000016, -1.8000000000000012, -2.0000000000000013, -2.0000000000000013, -2.2000000000000015, -1.8000000000000012, -2.4000000000000017, -2.0000000000000013, -1.8000000000000012, -2.0000000000000013, -2.0000000000000013, -2.0000000000000013, -1.700000000000001, -2.0000000000000013, -1.5000000000000009, -1.600000000000001, -1.4000000000000008, -1.700000000000001, -1.600000000000001, -2.0000000000000013, -1.9000000000000012, -2.1000000000000014, -2.3000000000000016, -1.9000000000000012, -2.4000000000000017, -2.2000000000000015, -1.8000000000000012, -1.5000000000000009, -1.600000000000001, -1.4000000000000008, -1.8000000000000012, -1.5000000000000009, -1.5000000000000009], "episode_lengths": [31, 29, 29, 28, 28, 25, 28, 29, 28, 26, 32, 26, 31, 29, 27, 46, 25, 28, 29, 37, 27, 28, 34, 29, 30, 28, 33, 37, 25, 29, 29, 28, 29, 33, 26, 27, 34, 31, 28, 28, 29, 26, 33, 26, 27, 25, 30, 30, 27, 28, 28, 32, 27, 30, 28, 36, 27, 30, 30, 27, 25, 34, 28, 28, 32, 28, 26, 28, 28, 30, 30, 29, 34, 33, 32, 31, 29, 30, 27, 32, 30, 27, 28, 31, 30, 30, 31, 35, 43, 34, 29, 26, 26, 35, 28, 33, 41, 36, 29, 34, 34, 29, 31, 31, 33, 29, 35, 31, 29, 31, 31, 31, 28, 31, 26, 27, 25, 28, 27, 31, 30, 32, 34, 30, 33, 33, 29, 26, 27, 25, 29, 26, 26]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3193606410625291, "mean_inference_ms": 0.726262510080007, "mean_action_processing_ms": 0.0765307685690268, "mean_env_wait_ms": 6.797118597378166, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0068413583855879935, "StateBufferConnector_ms": 0.004107073733681126, "ViewRequirementAgentConnector_ms": 0.09138261465201701}}, "episode_reward_max": -1.4000000000000008, "episode_reward_min": -5.300000000000003, "episode_reward_mean": -1.903759398496242, "episode_len_mean": 29.834586466165412, "episodes_this_iter": 133, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-2.0000000000000013, -1.8000000000000012, -1.8000000000000012, -1.700000000000001, -1.700000000000001, -1.4000000000000008, -1.700000000000001, -1.8000000000000012, -1.700000000000001, -1.5000000000000009, -2.1000000000000014, -1.5000000000000009, -2.0000000000000013, -1.8000000000000012, -1.600000000000001, -5.300000000000003, -1.4000000000000008, -1.700000000000001, -1.8000000000000012, -2.600000000000002, -1.600000000000001, -1.700000000000001, -2.3000000000000016, -1.8000000000000012, -1.9000000000000012, -1.700000000000001, -2.2000000000000015, -3.1000000000000014, -1.4000000000000008, -1.8000000000000012, -1.8000000000000012, -1.700000000000001, -1.8000000000000012, -2.2000000000000015, -1.5000000000000009, -1.600000000000001, -2.3000000000000016, -2.0000000000000013, -1.700000000000001, -1.700000000000001, -1.8000000000000012, -1.5000000000000009, -2.2000000000000015, -1.5000000000000009, -1.600000000000001, -1.4000000000000008, -1.9000000000000012, -1.9000000000000012, -1.600000000000001, -1.700000000000001, -1.700000000000001, -2.1000000000000014, -1.600000000000001, -1.9000000000000012, -1.700000000000001, -2.5000000000000018, -1.600000000000001, -1.9000000000000012, -1.9000000000000012, -1.600000000000001, -1.4000000000000008, -2.3000000000000016, -1.700000000000001, -1.700000000000001, -2.1000000000000014, -1.700000000000001, -1.5000000000000009, -1.700000000000001, -1.700000000000001, -1.9000000000000012, -1.9000000000000012, -1.8000000000000012, -2.3000000000000016, -2.2000000000000015, -2.1000000000000014, -2.0000000000000013, -1.8000000000000012, -1.9000000000000012, -1.600000000000001, -2.1000000000000014, -1.9000000000000012, -1.600000000000001, -1.700000000000001, -2.0000000000000013, -1.9000000000000012, -1.9000000000000012, -2.0000000000000013, -2.4000000000000017, -3.4000000000000004, -2.3000000000000016, -1.8000000000000012, -1.5000000000000009, -1.5000000000000009, -2.4000000000000017, -1.700000000000001, -2.2000000000000015, -3.0000000000000018, -2.5000000000000018, -1.8000000000000012, -2.3000000000000016, -2.3000000000000016, -1.8000000000000012, -2.0000000000000013, -2.0000000000000013, -2.2000000000000015, -1.8000000000000012, -2.4000000000000017, -2.0000000000000013, -1.8000000000000012, -2.0000000000000013, -2.0000000000000013, -2.0000000000000013, -1.700000000000001, -2.0000000000000013, -1.5000000000000009, -1.600000000000001, -1.4000000000000008, -1.700000000000001, -1.600000000000001, -2.0000000000000013, -1.9000000000000012, -2.1000000000000014, -2.3000000000000016, -1.9000000000000012, -2.4000000000000017, -2.2000000000000015, -1.8000000000000012, -1.5000000000000009, -1.600000000000001, -1.4000000000000008, -1.8000000000000012, -1.5000000000000009, -1.5000000000000009], "episode_lengths": [31, 29, 29, 28, 28, 25, 28, 29, 28, 26, 32, 26, 31, 29, 27, 46, 25, 28, 29, 37, 27, 28, 34, 29, 30, 28, 33, 37, 25, 29, 29, 28, 29, 33, 26, 27, 34, 31, 28, 28, 29, 26, 33, 26, 27, 25, 30, 30, 27, 28, 28, 32, 27, 30, 28, 36, 27, 30, 30, 27, 25, 34, 28, 28, 32, 28, 26, 28, 28, 30, 30, 29, 34, 33, 32, 31, 29, 30, 27, 32, 30, 27, 28, 31, 30, 30, 31, 35, 43, 34, 29, 26, 26, 35, 28, 33, 41, 36, 29, 34, 34, 29, 31, 31, 33, 29, 35, 31, 29, 31, 31, 31, 28, 31, 26, 27, 25, 28, 27, 31, 30, 32, 34, 30, 33, 33, 29, 26, 27, 25, 29, 26, 26]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3193606410625291, "mean_inference_ms": 0.726262510080007, "mean_action_processing_ms": 0.0765307685690268, "mean_env_wait_ms": 6.797118597378166, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0068413583855879935, "StateBufferConnector_ms": 0.004107073733681126, "ViewRequirementAgentConnector_ms": 0.09138261465201701}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 116000, "num_agent_steps_trained": 116000, "num_env_steps_sampled": 116000, "num_env_steps_trained": 116000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 501.2196925746739, "num_env_steps_trained_throughput_per_sec": 501.2196925746739, "timesteps_total": 116000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 116000, "timers": {"training_iteration_time_ms": 8033.063, "sample_time_ms": 4534.337, "load_time_ms": 0.986, "load_throughput": 4058840.208, "learn_time_ms": 3494.444, "learn_throughput": 1144.674, "synch_weights_time_ms": 2.65}, "counters": {"num_env_steps_sampled": 116000, "num_env_steps_trained": 116000, "num_agent_steps_sampled": 116000, "num_agent_steps_trained": 116000}, "done": false, "episodes_total": 1823, "training_iteration": 29, "trial_id": "133f9_00000", "date": "2024-03-07_13-14-58", "timestamp": 1709835298, "time_this_iter_s": 7.983673095703125, "time_total_s": 221.08094835281372, "pid": 117779, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7efea6399f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 221.08094835281372, "iterations_since_restore": 29, "perf": {"cpu_util_percent": 32.64, "ram_util_percent": 50.7, "gpu_util_percent0": 0.077, "vram_util_percent0": 0.0940185546875}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 0.2046344612298223, "policy_loss": -0.011512944769735137, "vf_loss": 0.2145250065978216, "vf_explained_var": 0.8818407102297711, "kl": 0.008111975447755887, "entropy": 0.28915196194123194, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 27435.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 120000, "num_env_steps_trained": 120000, "num_agent_steps_sampled": 120000, "num_agent_steps_trained": 120000}, "sampler_results": {"episode_reward_max": -1.4000000000000008, "episode_reward_min": -8.7, "episode_reward_mean": -1.9578947368421065, "episode_len_mean": 30.18796992481203, "episode_media": {}, "episodes_this_iter": 133, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1.600000000000001, -1.9000000000000012, -1.8000000000000012, -1.600000000000001, -1.5000000000000009, -1.5000000000000009, -1.5000000000000009, -2.600000000000002, -2.0000000000000013, -1.9000000000000012, -1.700000000000001, -1.8000000000000012, -2.0000000000000013, -1.700000000000001, -2.700000000000002, -2.0000000000000013, -1.700000000000001, -1.9000000000000012, -2.2000000000000015, -1.9000000000000012, -1.9000000000000012, -1.5000000000000009, -2.0000000000000013, -2.0000000000000013, -1.9000000000000012, -2.2000000000000015, -1.600000000000001, -2.1000000000000014, -1.600000000000001, -1.4000000000000008, -1.700000000000001, -2.0000000000000013, -1.9000000000000012, -2.5000000000000018, -1.700000000000001, -2.0000000000000013, -2.0000000000000013, -1.600000000000001, -1.5000000000000009, -1.9000000000000012, -1.700000000000001, -8.7, -2.2000000000000015, -2.1000000000000014, -3.0000000000000018, -1.5000000000000009, -1.9000000000000012, -1.5000000000000009, -1.600000000000001, -1.700000000000001, -2.1000000000000014, -2.1000000000000014, -3.4000000000000012, -1.4000000000000008, -1.9000000000000012, -1.8000000000000012, -1.8000000000000012, -1.5000000000000009, -1.600000000000001, -1.700000000000001, -1.9000000000000012, -1.8000000000000012, -2.4000000000000017, -2.0000000000000013, -1.5000000000000009, -1.8000000000000012, -1.700000000000001, -1.5000000000000009, -1.8000000000000012, -1.700000000000001, -1.700000000000001, -3.200000000000001, -1.700000000000001, -1.5000000000000009, -1.8000000000000012, -2.0000000000000013, -1.700000000000001, -1.9000000000000012, -1.700000000000001, -1.700000000000001, -1.8000000000000012, -1.9000000000000012, -1.8000000000000012, -2.2000000000000015, -2.2000000000000015, -1.700000000000001, -1.700000000000001, -1.700000000000001, -1.600000000000001, -1.9000000000000012, -2.3000000000000016, -1.700000000000001, -1.9000000000000012, -2.0000000000000013, -1.8000000000000012, -1.8000000000000012, -2.5000000000000018, -1.8000000000000012, -1.600000000000001, -1.600000000000001, -2.0000000000000013, -1.700000000000001, -4.6, -1.600000000000001, -1.700000000000001, -1.700000000000001, -2.700000000000002, -2.2000000000000015, -1.9000000000000012, -1.5000000000000009, -2.700000000000002, -2.800000000000002, -1.4000000000000008, -1.8000000000000012, -1.600000000000001, -1.600000000000001, -2.0000000000000013, -1.600000000000001, -1.700000000000001, -1.5000000000000009, -1.9000000000000012, -1.600000000000001, -2.2000000000000015, -2.3000000000000016, -2.3000000000000016, -1.600000000000001, -2.1000000000000014, -1.9000000000000012, -1.5000000000000009, -2.0000000000000013, -1.700000000000001, -1.8000000000000012, -3.0000000000000018], "episode_lengths": [27, 30, 29, 27, 26, 26, 26, 37, 31, 30, 28, 29, 31, 28, 38, 31, 28, 30, 33, 30, 30, 26, 31, 31, 30, 33, 27, 32, 27, 25, 28, 31, 30, 36, 28, 31, 31, 27, 26, 30, 28, 71, 33, 32, 40, 26, 30, 26, 27, 28, 32, 32, 40, 25, 30, 29, 29, 26, 27, 28, 30, 29, 35, 31, 26, 29, 28, 26, 29, 28, 28, 43, 28, 26, 29, 31, 28, 30, 28, 28, 29, 30, 29, 33, 33, 28, 28, 28, 27, 30, 34, 28, 30, 31, 29, 29, 36, 29, 27, 27, 31, 28, 48, 27, 28, 28, 33, 33, 30, 26, 37, 39, 25, 29, 27, 27, 31, 27, 28, 26, 30, 27, 33, 34, 34, 27, 32, 30, 26, 31, 28, 29, 37]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.32325852182335973, "mean_inference_ms": 0.7261762607149805, "mean_action_processing_ms": 0.07649219871533419, "mean_env_wait_ms": 6.825491340812984, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006810704568274936, "StateBufferConnector_ms": 0.004059390017860814, "ViewRequirementAgentConnector_ms": 0.09100204123590226}}, "episode_reward_max": -1.4000000000000008, "episode_reward_min": -8.7, "episode_reward_mean": -1.9578947368421065, "episode_len_mean": 30.18796992481203, "episodes_this_iter": 133, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1.600000000000001, -1.9000000000000012, -1.8000000000000012, -1.600000000000001, -1.5000000000000009, -1.5000000000000009, -1.5000000000000009, -2.600000000000002, -2.0000000000000013, -1.9000000000000012, -1.700000000000001, -1.8000000000000012, -2.0000000000000013, -1.700000000000001, -2.700000000000002, -2.0000000000000013, -1.700000000000001, -1.9000000000000012, -2.2000000000000015, -1.9000000000000012, -1.9000000000000012, -1.5000000000000009, -2.0000000000000013, -2.0000000000000013, -1.9000000000000012, -2.2000000000000015, -1.600000000000001, -2.1000000000000014, -1.600000000000001, -1.4000000000000008, -1.700000000000001, -2.0000000000000013, -1.9000000000000012, -2.5000000000000018, -1.700000000000001, -2.0000000000000013, -2.0000000000000013, -1.600000000000001, -1.5000000000000009, -1.9000000000000012, -1.700000000000001, -8.7, -2.2000000000000015, -2.1000000000000014, -3.0000000000000018, -1.5000000000000009, -1.9000000000000012, -1.5000000000000009, -1.600000000000001, -1.700000000000001, -2.1000000000000014, -2.1000000000000014, -3.4000000000000012, -1.4000000000000008, -1.9000000000000012, -1.8000000000000012, -1.8000000000000012, -1.5000000000000009, -1.600000000000001, -1.700000000000001, -1.9000000000000012, -1.8000000000000012, -2.4000000000000017, -2.0000000000000013, -1.5000000000000009, -1.8000000000000012, -1.700000000000001, -1.5000000000000009, -1.8000000000000012, -1.700000000000001, -1.700000000000001, -3.200000000000001, -1.700000000000001, -1.5000000000000009, -1.8000000000000012, -2.0000000000000013, -1.700000000000001, -1.9000000000000012, -1.700000000000001, -1.700000000000001, -1.8000000000000012, -1.9000000000000012, -1.8000000000000012, -2.2000000000000015, -2.2000000000000015, -1.700000000000001, -1.700000000000001, -1.700000000000001, -1.600000000000001, -1.9000000000000012, -2.3000000000000016, -1.700000000000001, -1.9000000000000012, -2.0000000000000013, -1.8000000000000012, -1.8000000000000012, -2.5000000000000018, -1.8000000000000012, -1.600000000000001, -1.600000000000001, -2.0000000000000013, -1.700000000000001, -4.6, -1.600000000000001, -1.700000000000001, -1.700000000000001, -2.700000000000002, -2.2000000000000015, -1.9000000000000012, -1.5000000000000009, -2.700000000000002, -2.800000000000002, -1.4000000000000008, -1.8000000000000012, -1.600000000000001, -1.600000000000001, -2.0000000000000013, -1.600000000000001, -1.700000000000001, -1.5000000000000009, -1.9000000000000012, -1.600000000000001, -2.2000000000000015, -2.3000000000000016, -2.3000000000000016, -1.600000000000001, -2.1000000000000014, -1.9000000000000012, -1.5000000000000009, -2.0000000000000013, -1.700000000000001, -1.8000000000000012, -3.0000000000000018], "episode_lengths": [27, 30, 29, 27, 26, 26, 26, 37, 31, 30, 28, 29, 31, 28, 38, 31, 28, 30, 33, 30, 30, 26, 31, 31, 30, 33, 27, 32, 27, 25, 28, 31, 30, 36, 28, 31, 31, 27, 26, 30, 28, 71, 33, 32, 40, 26, 30, 26, 27, 28, 32, 32, 40, 25, 30, 29, 29, 26, 27, 28, 30, 29, 35, 31, 26, 29, 28, 26, 29, 28, 28, 43, 28, 26, 29, 31, 28, 30, 28, 28, 29, 30, 29, 33, 33, 28, 28, 28, 27, 30, 34, 28, 30, 31, 29, 29, 36, 29, 27, 27, 31, 28, 48, 27, 28, 28, 33, 33, 30, 26, 37, 39, 25, 29, 27, 27, 31, 27, 28, 26, 30, 27, 33, 34, 34, 27, 32, 30, 26, 31, 28, 29, 37]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.32325852182335973, "mean_inference_ms": 0.7261762607149805, "mean_action_processing_ms": 0.07649219871533419, "mean_env_wait_ms": 6.825491340812984, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006810704568274936, "StateBufferConnector_ms": 0.004059390017860814, "ViewRequirementAgentConnector_ms": 0.09100204123590226}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 120000, "num_agent_steps_trained": 120000, "num_env_steps_sampled": 120000, "num_env_steps_trained": 120000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 497.914185771507, "num_env_steps_trained_throughput_per_sec": 497.914185771507, "timesteps_total": 120000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 120000, "timers": {"training_iteration_time_ms": 8051.174, "sample_time_ms": 4561.191, "load_time_ms": 0.984, "load_throughput": 4065134.356, "learn_time_ms": 3485.699, "learn_throughput": 1147.546, "synch_weights_time_ms": 2.653}, "counters": {"num_env_steps_sampled": 120000, "num_env_steps_trained": 120000, "num_agent_steps_sampled": 120000, "num_agent_steps_trained": 120000}, "done": false, "episodes_total": 1956, "training_iteration": 30, "trial_id": "133f9_00000", "date": "2024-03-07_13-15-06", "timestamp": 1709835306, "time_this_iter_s": 8.036808967590332, "time_total_s": 229.11775732040405, "pid": 117779, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7efea6399f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 229.11775732040405, "iterations_since_restore": 30, "perf": {"cpu_util_percent": 32.8, "ram_util_percent": 50.7, "gpu_util_percent0": 0.076, "vram_util_percent0": 0.0940185546875}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 0.3965005916317985, "policy_loss": -0.009645757429622193, "vf_loss": 0.4041159191268987, "vf_explained_var": 0.8093186739952334, "kl": 0.01015213909369112, "entropy": 0.3133865246208765, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 28365.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 124000, "num_env_steps_trained": 124000, "num_agent_steps_sampled": 124000, "num_agent_steps_trained": 124000}, "sampler_results": {"episode_reward_max": -1.4000000000000008, "episode_reward_min": -7.400000000000004, "episode_reward_mean": -1.9115384615384625, "episode_len_mean": 29.83076923076923, "episode_media": {}, "episodes_this_iter": 130, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1.600000000000001, -2.0000000000000013, -1.700000000000001, -1.5000000000000009, -2.0000000000000013, -1.700000000000001, -1.5000000000000009, -2.3000000000000016, -1.8000000000000012, -1.8000000000000012, -2.1000000000000014, -2.0000000000000013, -2.900000000000002, -1.8000000000000012, -1.9000000000000012, -1.600000000000001, -1.700000000000001, -2.1000000000000014, -1.5000000000000009, -1.600000000000001, -1.700000000000001, -1.700000000000001, -1.600000000000001, -2.1000000000000014, -1.5000000000000009, -1.600000000000001, -6.49999999999999, -2.1000000000000014, -1.5000000000000009, -1.5000000000000009, -1.700000000000001, -1.5000000000000009, -2.3000000000000016, -1.4000000000000008, -1.600000000000001, -1.8000000000000012, -1.5000000000000009, -1.700000000000001, -1.8000000000000012, -2.1000000000000014, -1.8000000000000012, -1.8000000000000012, -1.600000000000001, -1.5000000000000009, -2.5000000000000018, -2.1000000000000014, -1.600000000000001, -1.8000000000000012, -1.9000000000000012, -1.9000000000000012, -2.0000000000000013, -1.8000000000000012, -2.2000000000000015, -1.9000000000000012, -1.5000000000000009, -1.8000000000000012, -1.5000000000000009, -1.8000000000000012, -7.400000000000004, -2.2000000000000015, -1.9000000000000012, -1.600000000000001, -1.8000000000000012, -1.5000000000000009, -1.9000000000000012, -2.0000000000000013, -1.9000000000000012, -1.8000000000000012, -1.5000000000000009, -2.0000000000000013, -2.1000000000000014, -1.5000000000000009, -2.1000000000000014, -2.0000000000000013, -1.700000000000001, -1.700000000000001, -1.700000000000001, -1.700000000000001, -1.8000000000000012, -1.8000000000000012, -1.600000000000001, -1.9000000000000012, -1.8000000000000012, -1.600000000000001, -1.5000000000000009, -1.9000000000000012, -1.700000000000001, -1.600000000000001, -1.5000000000000009, -2.2000000000000015, -2.0000000000000013, -1.9000000000000012, -2.2000000000000015, -2.3000000000000016, -1.8000000000000012, -1.700000000000001, -2.1000000000000014, -1.9000000000000012, -1.600000000000001, -1.700000000000001, -1.8000000000000012, -2.0000000000000013, -1.8000000000000012, -1.4000000000000008, -1.700000000000001, -1.8000000000000012, -2.0000000000000013, -1.600000000000001, -1.9000000000000012, -3.200000000000001, -1.5000000000000009, -1.9000000000000012, -3.3000000000000007, -1.9000000000000012, -1.8000000000000012, -1.600000000000001, -1.4000000000000008, -1.700000000000001, -1.600000000000001, -1.8000000000000012, -1.8000000000000012, -1.700000000000001, -2.700000000000002, -1.700000000000001, -1.5000000000000009, -2.3000000000000016, -2.1000000000000014, -1.5000000000000009, -2.0000000000000013, -2.1000000000000014], "episode_lengths": [27, 31, 28, 26, 31, 28, 26, 34, 29, 29, 32, 31, 36, 29, 30, 27, 28, 32, 26, 27, 28, 28, 27, 32, 26, 27, 71, 32, 26, 26, 28, 26, 34, 25, 27, 29, 26, 28, 29, 32, 29, 29, 27, 26, 36, 32, 27, 29, 30, 30, 31, 29, 33, 30, 26, 29, 26, 29, 60, 33, 30, 27, 29, 26, 30, 31, 30, 29, 26, 31, 32, 26, 32, 31, 28, 28, 28, 28, 29, 29, 27, 30, 29, 27, 26, 30, 28, 27, 26, 33, 31, 30, 33, 34, 29, 28, 32, 30, 27, 28, 29, 31, 29, 25, 28, 29, 31, 27, 30, 40, 26, 30, 44, 30, 29, 27, 25, 28, 27, 29, 29, 28, 38, 28, 26, 34, 32, 26, 31, 32]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3267132110112224, "mean_inference_ms": 0.7263184283522033, "mean_action_processing_ms": 0.07649351055925589, "mean_env_wait_ms": 6.84942201236238, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0068642542912409855, "StateBufferConnector_ms": 0.004093096806452825, "ViewRequirementAgentConnector_ms": 0.09192943572998047}}, "episode_reward_max": -1.4000000000000008, "episode_reward_min": -7.400000000000004, "episode_reward_mean": -1.9115384615384625, "episode_len_mean": 29.83076923076923, "episodes_this_iter": 130, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1.600000000000001, -2.0000000000000013, -1.700000000000001, -1.5000000000000009, -2.0000000000000013, -1.700000000000001, -1.5000000000000009, -2.3000000000000016, -1.8000000000000012, -1.8000000000000012, -2.1000000000000014, -2.0000000000000013, -2.900000000000002, -1.8000000000000012, -1.9000000000000012, -1.600000000000001, -1.700000000000001, -2.1000000000000014, -1.5000000000000009, -1.600000000000001, -1.700000000000001, -1.700000000000001, -1.600000000000001, -2.1000000000000014, -1.5000000000000009, -1.600000000000001, -6.49999999999999, -2.1000000000000014, -1.5000000000000009, -1.5000000000000009, -1.700000000000001, -1.5000000000000009, -2.3000000000000016, -1.4000000000000008, -1.600000000000001, -1.8000000000000012, -1.5000000000000009, -1.700000000000001, -1.8000000000000012, -2.1000000000000014, -1.8000000000000012, -1.8000000000000012, -1.600000000000001, -1.5000000000000009, -2.5000000000000018, -2.1000000000000014, -1.600000000000001, -1.8000000000000012, -1.9000000000000012, -1.9000000000000012, -2.0000000000000013, -1.8000000000000012, -2.2000000000000015, -1.9000000000000012, -1.5000000000000009, -1.8000000000000012, -1.5000000000000009, -1.8000000000000012, -7.400000000000004, -2.2000000000000015, -1.9000000000000012, -1.600000000000001, -1.8000000000000012, -1.5000000000000009, -1.9000000000000012, -2.0000000000000013, -1.9000000000000012, -1.8000000000000012, -1.5000000000000009, -2.0000000000000013, -2.1000000000000014, -1.5000000000000009, -2.1000000000000014, -2.0000000000000013, -1.700000000000001, -1.700000000000001, -1.700000000000001, -1.700000000000001, -1.8000000000000012, -1.8000000000000012, -1.600000000000001, -1.9000000000000012, -1.8000000000000012, -1.600000000000001, -1.5000000000000009, -1.9000000000000012, -1.700000000000001, -1.600000000000001, -1.5000000000000009, -2.2000000000000015, -2.0000000000000013, -1.9000000000000012, -2.2000000000000015, -2.3000000000000016, -1.8000000000000012, -1.700000000000001, -2.1000000000000014, -1.9000000000000012, -1.600000000000001, -1.700000000000001, -1.8000000000000012, -2.0000000000000013, -1.8000000000000012, -1.4000000000000008, -1.700000000000001, -1.8000000000000012, -2.0000000000000013, -1.600000000000001, -1.9000000000000012, -3.200000000000001, -1.5000000000000009, -1.9000000000000012, -3.3000000000000007, -1.9000000000000012, -1.8000000000000012, -1.600000000000001, -1.4000000000000008, -1.700000000000001, -1.600000000000001, -1.8000000000000012, -1.8000000000000012, -1.700000000000001, -2.700000000000002, -1.700000000000001, -1.5000000000000009, -2.3000000000000016, -2.1000000000000014, -1.5000000000000009, -2.0000000000000013, -2.1000000000000014], "episode_lengths": [27, 31, 28, 26, 31, 28, 26, 34, 29, 29, 32, 31, 36, 29, 30, 27, 28, 32, 26, 27, 28, 28, 27, 32, 26, 27, 71, 32, 26, 26, 28, 26, 34, 25, 27, 29, 26, 28, 29, 32, 29, 29, 27, 26, 36, 32, 27, 29, 30, 30, 31, 29, 33, 30, 26, 29, 26, 29, 60, 33, 30, 27, 29, 26, 30, 31, 30, 29, 26, 31, 32, 26, 32, 31, 28, 28, 28, 28, 29, 29, 27, 30, 29, 27, 26, 30, 28, 27, 26, 33, 31, 30, 33, 34, 29, 28, 32, 30, 27, 28, 29, 31, 29, 25, 28, 29, 31, 27, 30, 40, 26, 30, 44, 30, 29, 27, 25, 28, 27, 29, 29, 28, 38, 28, 26, 34, 32, 26, 31, 32]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3267132110112224, "mean_inference_ms": 0.7263184283522033, "mean_action_processing_ms": 0.07649351055925589, "mean_env_wait_ms": 6.84942201236238, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0068642542912409855, "StateBufferConnector_ms": 0.004093096806452825, "ViewRequirementAgentConnector_ms": 0.09192943572998047}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 124000, "num_agent_steps_trained": 124000, "num_env_steps_sampled": 124000, "num_env_steps_trained": 124000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 499.13379371339903, "num_env_steps_trained_throughput_per_sec": 499.13379371339903, "timesteps_total": 124000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 124000, "timers": {"training_iteration_time_ms": 8026.781, "sample_time_ms": 4539.947, "load_time_ms": 0.993, "load_throughput": 4027079.523, "learn_time_ms": 3482.46, "learn_throughput": 1148.613, "synch_weights_time_ms": 2.736}, "counters": {"num_env_steps_sampled": 124000, "num_env_steps_trained": 124000, "num_agent_steps_sampled": 124000, "num_agent_steps_trained": 124000}, "done": false, "episodes_total": 2086, "training_iteration": 31, "trial_id": "133f9_00000", "date": "2024-03-07_13-15-14", "timestamp": 1709835314, "time_this_iter_s": 8.0170259475708, "time_total_s": 237.13478326797485, "pid": 117779, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7efea6399f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 237.13478326797485, "iterations_since_restore": 31, "perf": {"cpu_util_percent": 30.327272727272728, "ram_util_percent": 50.7, "gpu_util_percent0": 0.08454545454545456, "vram_util_percent0": 0.09401633522727272}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 0.2613489038344743, "policy_loss": -0.012175804258434363, "vf_loss": 0.27054450545179587, "vf_explained_var": 0.8571082982324785, "kl": 0.014901001153007831, "entropy": 0.31920739069420806, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 29295.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 128000, "num_env_steps_trained": 128000, "num_agent_steps_sampled": 128000, "num_agent_steps_trained": 128000}, "sampler_results": {"episode_reward_max": -1.4000000000000008, "episode_reward_min": -9.19999999999998, "episode_reward_mean": -2.0045112781954897, "episode_len_mean": 30.646616541353385, "episode_media": {}, "episodes_this_iter": 133, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1.9000000000000012, -2.0000000000000013, -2.2000000000000015, -1.700000000000001, -1.600000000000001, -1.8000000000000012, -1.600000000000001, -1.8000000000000012, -1.5000000000000009, -1.8000000000000012, -1.9000000000000012, -2.0000000000000013, -1.700000000000001, -1.700000000000001, -2.0000000000000013, -1.8000000000000012, -3.4000000000000012, -1.700000000000001, -1.600000000000001, -2.5000000000000018, -1.600000000000001, -1.700000000000001, -1.9000000000000012, -2.2000000000000015, -2.0000000000000013, -1.600000000000001, -1.5000000000000009, -1.5000000000000009, -1.8000000000000012, -1.600000000000001, -1.9000000000000012, -1.700000000000001, -5.699999999999992, -1.700000000000001, -1.700000000000001, -2.3000000000000016, -2.2000000000000015, -1.4000000000000008, -1.8000000000000012, -2.5000000000000018, -1.5000000000000009, -2.1000000000000014, -1.600000000000001, -1.700000000000001, -1.8000000000000012, -1.700000000000001, -2.0000000000000013, -1.9000000000000012, -1.700000000000001, -1.9000000000000012, -3.6999999999999993, -1.5000000000000009, -1.5000000000000009, -2.4000000000000017, -1.8000000000000012, -2.5000000000000018, -1.4000000000000008, -1.5000000000000009, -2.1000000000000014, -2.0000000000000013, -2.1000000000000014, -2.0000000000000013, -1.8000000000000012, -2.5000000000000018, -1.700000000000001, -1.8000000000000012, -1.8000000000000012, -1.8000000000000012, -3.700000000000002, -2.0000000000000013, -1.5000000000000009, -2.1000000000000014, -1.700000000000001, -1.9000000000000012, -1.5000000000000009, -2.3000000000000016, -1.8000000000000012, -1.700000000000001, -2.2000000000000015, -1.9000000000000012, -2.4000000000000017, -1.8000000000000012, -1.5000000000000009, -9.19999999999998, -2.0000000000000013, -1.600000000000001, -2.0000000000000013, -1.700000000000001, -1.700000000000001, -1.700000000000001, -2.0000000000000013, -1.700000000000001, -1.700000000000001, -1.8000000000000012, -1.8000000000000012, -2.3000000000000016, -1.5000000000000009, -1.600000000000001, -1.700000000000001, -2.1000000000000014, -1.8000000000000012, -1.600000000000001, -1.5000000000000009, -2.0000000000000013, -1.600000000000001, -1.5000000000000009, -1.4000000000000008, -1.600000000000001, -1.5000000000000009, -3.0000000000000018, -1.4000000000000008, -1.8000000000000012, -1.5000000000000009, -3.700000000000001, -3.4000000000000012, -6.7000000000000055, -1.9000000000000012, -1.9000000000000012, -2.0000000000000013, -1.8000000000000012, -1.700000000000001, -1.700000000000001, -1.9000000000000012, -1.8000000000000012, -1.700000000000001, -1.700000000000001, -1.5000000000000009, -1.700000000000001, -2.0000000000000013, -2.0000000000000013, -1.700000000000001, -1.600000000000001, -1.600000000000001], "episode_lengths": [30, 31, 33, 28, 27, 29, 27, 29, 26, 29, 30, 31, 28, 28, 31, 29, 39, 28, 27, 32, 27, 28, 30, 33, 31, 27, 26, 26, 29, 27, 30, 28, 68, 28, 28, 34, 32, 25, 29, 36, 26, 32, 27, 28, 29, 28, 31, 30, 28, 30, 48, 26, 26, 35, 29, 36, 25, 26, 32, 31, 32, 31, 29, 36, 28, 29, 29, 29, 41, 31, 26, 32, 28, 30, 26, 34, 29, 28, 33, 30, 35, 29, 26, 103, 31, 27, 31, 28, 28, 28, 31, 28, 28, 29, 29, 32, 26, 27, 28, 32, 29, 27, 26, 31, 27, 26, 25, 27, 26, 40, 25, 29, 26, 41, 40, 58, 30, 30, 31, 29, 28, 28, 30, 29, 28, 28, 26, 28, 31, 31, 28, 27, 27]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.33017776546087513, "mean_inference_ms": 0.7262240286856737, "mean_action_processing_ms": 0.07647669786493488, "mean_env_wait_ms": 6.873606477201225, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0067960050769318315, "StateBufferConnector_ms": 0.004095959484129024, "ViewRequirementAgentConnector_ms": 0.09171765549738604}}, "episode_reward_max": -1.4000000000000008, "episode_reward_min": -9.19999999999998, "episode_reward_mean": -2.0045112781954897, "episode_len_mean": 30.646616541353385, "episodes_this_iter": 133, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1.9000000000000012, -2.0000000000000013, -2.2000000000000015, -1.700000000000001, -1.600000000000001, -1.8000000000000012, -1.600000000000001, -1.8000000000000012, -1.5000000000000009, -1.8000000000000012, -1.9000000000000012, -2.0000000000000013, -1.700000000000001, -1.700000000000001, -2.0000000000000013, -1.8000000000000012, -3.4000000000000012, -1.700000000000001, -1.600000000000001, -2.5000000000000018, -1.600000000000001, -1.700000000000001, -1.9000000000000012, -2.2000000000000015, -2.0000000000000013, -1.600000000000001, -1.5000000000000009, -1.5000000000000009, -1.8000000000000012, -1.600000000000001, -1.9000000000000012, -1.700000000000001, -5.699999999999992, -1.700000000000001, -1.700000000000001, -2.3000000000000016, -2.2000000000000015, -1.4000000000000008, -1.8000000000000012, -2.5000000000000018, -1.5000000000000009, -2.1000000000000014, -1.600000000000001, -1.700000000000001, -1.8000000000000012, -1.700000000000001, -2.0000000000000013, -1.9000000000000012, -1.700000000000001, -1.9000000000000012, -3.6999999999999993, -1.5000000000000009, -1.5000000000000009, -2.4000000000000017, -1.8000000000000012, -2.5000000000000018, -1.4000000000000008, -1.5000000000000009, -2.1000000000000014, -2.0000000000000013, -2.1000000000000014, -2.0000000000000013, -1.8000000000000012, -2.5000000000000018, -1.700000000000001, -1.8000000000000012, -1.8000000000000012, -1.8000000000000012, -3.700000000000002, -2.0000000000000013, -1.5000000000000009, -2.1000000000000014, -1.700000000000001, -1.9000000000000012, -1.5000000000000009, -2.3000000000000016, -1.8000000000000012, -1.700000000000001, -2.2000000000000015, -1.9000000000000012, -2.4000000000000017, -1.8000000000000012, -1.5000000000000009, -9.19999999999998, -2.0000000000000013, -1.600000000000001, -2.0000000000000013, -1.700000000000001, -1.700000000000001, -1.700000000000001, -2.0000000000000013, -1.700000000000001, -1.700000000000001, -1.8000000000000012, -1.8000000000000012, -2.3000000000000016, -1.5000000000000009, -1.600000000000001, -1.700000000000001, -2.1000000000000014, -1.8000000000000012, -1.600000000000001, -1.5000000000000009, -2.0000000000000013, -1.600000000000001, -1.5000000000000009, -1.4000000000000008, -1.600000000000001, -1.5000000000000009, -3.0000000000000018, -1.4000000000000008, -1.8000000000000012, -1.5000000000000009, -3.700000000000001, -3.4000000000000012, -6.7000000000000055, -1.9000000000000012, -1.9000000000000012, -2.0000000000000013, -1.8000000000000012, -1.700000000000001, -1.700000000000001, -1.9000000000000012, -1.8000000000000012, -1.700000000000001, -1.700000000000001, -1.5000000000000009, -1.700000000000001, -2.0000000000000013, -2.0000000000000013, -1.700000000000001, -1.600000000000001, -1.600000000000001], "episode_lengths": [30, 31, 33, 28, 27, 29, 27, 29, 26, 29, 30, 31, 28, 28, 31, 29, 39, 28, 27, 32, 27, 28, 30, 33, 31, 27, 26, 26, 29, 27, 30, 28, 68, 28, 28, 34, 32, 25, 29, 36, 26, 32, 27, 28, 29, 28, 31, 30, 28, 30, 48, 26, 26, 35, 29, 36, 25, 26, 32, 31, 32, 31, 29, 36, 28, 29, 29, 29, 41, 31, 26, 32, 28, 30, 26, 34, 29, 28, 33, 30, 35, 29, 26, 103, 31, 27, 31, 28, 28, 28, 31, 28, 28, 29, 29, 32, 26, 27, 28, 32, 29, 27, 26, 31, 27, 26, 25, 27, 26, 40, 25, 29, 26, 41, 40, 58, 30, 30, 31, 29, 28, 28, 30, 29, 28, 28, 26, 28, 31, 31, 28, 27, 27]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.33017776546087513, "mean_inference_ms": 0.7262240286856737, "mean_action_processing_ms": 0.07647669786493488, "mean_env_wait_ms": 6.873606477201225, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0067960050769318315, "StateBufferConnector_ms": 0.004095959484129024, "ViewRequirementAgentConnector_ms": 0.09171765549738604}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 128000, "num_agent_steps_trained": 128000, "num_env_steps_sampled": 128000, "num_env_steps_trained": 128000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 495.56553277246365, "num_env_steps_trained_throughput_per_sec": 495.56553277246365, "timesteps_total": 128000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 128000, "timers": {"training_iteration_time_ms": 8035.71, "sample_time_ms": 4550.373, "load_time_ms": 0.99, "load_throughput": 4040949.949, "learn_time_ms": 3481.001, "learn_throughput": 1149.095, "synch_weights_time_ms": 2.696}, "counters": {"num_env_steps_sampled": 128000, "num_env_steps_trained": 128000, "num_agent_steps_sampled": 128000, "num_agent_steps_trained": 128000}, "done": false, "episodes_total": 2219, "training_iteration": 32, "trial_id": "133f9_00000", "date": "2024-03-07_13-15-23", "timestamp": 1709835323, "time_this_iter_s": 8.074570894241333, "time_total_s": 245.2093541622162, "pid": 117779, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7efea6399f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 245.2093541622162, "iterations_since_restore": 32, "perf": {"cpu_util_percent": 33.050000000000004, "ram_util_percent": 50.7, "gpu_util_percent0": 0.074, "vram_util_percent0": 0.09400227864583334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 0.08449184435559938, "policy_loss": -0.009766942723303713, "vf_loss": 0.09203815474976054, "vf_explained_var": 0.9355354411627657, "kl": 0.011103156625913784, "entropy": 0.3196679606553047, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 30225.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 132000, "num_env_steps_trained": 132000, "num_agent_steps_sampled": 132000, "num_agent_steps_trained": 132000}, "sampler_results": {"episode_reward_max": -1.4000000000000008, "episode_reward_min": -4.900000000000001, "episode_reward_mean": -1.8777777777777789, "episode_len_mean": 29.614814814814814, "episode_media": {}, "episodes_this_iter": 135, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1.700000000000001, -1.8000000000000012, -1.700000000000001, -1.4000000000000008, -2.3000000000000016, -1.700000000000001, -1.700000000000001, -1.8000000000000012, -2.5000000000000018, -1.4000000000000008, -1.8000000000000012, -1.9000000000000012, -1.700000000000001, -2.1000000000000014, -1.700000000000001, -1.700000000000001, -1.700000000000001, -1.4000000000000008, -2.1000000000000014, -1.600000000000001, -1.5000000000000009, -2.0000000000000013, -1.9000000000000012, -1.8000000000000012, -2.3000000000000016, -1.9000000000000012, -1.600000000000001, -1.9000000000000012, -3.4000000000000004, -1.5000000000000009, -1.700000000000001, -1.700000000000001, -1.5000000000000009, -1.8000000000000012, -1.9000000000000012, -1.5000000000000009, -1.8000000000000012, -2.0000000000000013, -1.600000000000001, -1.8000000000000012, -2.2000000000000015, -2.0000000000000013, -1.700000000000001, -1.8000000000000012, -1.5000000000000009, -2.800000000000002, -2.1000000000000014, -1.8000000000000012, -1.8000000000000012, -1.8000000000000012, -2.0000000000000013, -1.600000000000001, -1.600000000000001, -2.2000000000000015, -1.9000000000000012, -1.9000000000000012, -1.600000000000001, -1.5000000000000009, -2.700000000000002, -1.600000000000001, -2.0000000000000013, -2.0000000000000013, -4.900000000000001, -2.0000000000000013, -1.700000000000001, -2.2000000000000015, -1.9000000000000012, -1.9000000000000012, -1.5000000000000009, -1.700000000000001, -2.1000000000000014, -1.9000000000000012, -1.8000000000000012, -1.8000000000000012, -1.8000000000000012, -1.8000000000000012, -1.9000000000000012, -1.4000000000000008, -2.1000000000000014, -1.600000000000001, -1.5000000000000009, -1.9000000000000012, -2.3000000000000016, -1.5000000000000009, -1.600000000000001, -2.600000000000002, -2.4000000000000017, -1.5000000000000009, -2.2000000000000015, -2.2000000000000015, -1.5000000000000009, -1.700000000000001, -2.2000000000000015, -1.600000000000001, -1.8000000000000012, -2.1000000000000014, -1.8000000000000012, -1.9000000000000012, -1.8000000000000012, -1.700000000000001, -1.8000000000000012, -1.700000000000001, -1.8000000000000012, -1.9000000000000012, -2.1000000000000014, -2.2000000000000015, -1.8000000000000012, -1.600000000000001, -1.8000000000000012, -1.4000000000000008, -2.3000000000000016, -2.3000000000000016, -1.4000000000000008, -1.8000000000000012, -1.9000000000000012, -2.1000000000000014, -1.700000000000001, -1.700000000000001, -1.700000000000001, -2.1000000000000014, -1.5000000000000009, -1.700000000000001, -1.700000000000001, -2.4000000000000017, -1.8000000000000012, -1.9000000000000012, -1.5000000000000009, -2.0000000000000013, -1.8000000000000012, -2.3000000000000016, -1.600000000000001, -1.8000000000000012, -1.4000000000000008, -2.700000000000002, -1.600000000000001], "episode_lengths": [28, 29, 28, 25, 34, 28, 28, 29, 36, 25, 29, 30, 28, 32, 28, 28, 28, 25, 32, 27, 26, 31, 30, 29, 34, 30, 27, 30, 39, 26, 28, 28, 26, 29, 30, 26, 29, 31, 27, 29, 33, 31, 28, 29, 26, 39, 32, 29, 29, 29, 31, 27, 27, 33, 30, 30, 27, 26, 36, 27, 31, 31, 48, 31, 28, 33, 30, 30, 26, 28, 32, 30, 29, 29, 29, 29, 30, 25, 32, 27, 26, 30, 34, 26, 27, 35, 35, 26, 33, 33, 26, 28, 33, 27, 29, 32, 29, 30, 29, 28, 29, 28, 29, 30, 32, 33, 29, 27, 29, 25, 34, 34, 25, 29, 30, 32, 28, 28, 28, 32, 26, 28, 28, 35, 29, 30, 26, 31, 29, 34, 27, 29, 25, 38, 27]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.33354581239999553, "mean_inference_ms": 0.7265150497928644, "mean_action_processing_ms": 0.07652367420821274, "mean_env_wait_ms": 6.901017039279189, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006778681719744647, "StateBufferConnector_ms": 0.0040275079232675055, "ViewRequirementAgentConnector_ms": 0.09133409570764613}}, "episode_reward_max": -1.4000000000000008, "episode_reward_min": -4.900000000000001, "episode_reward_mean": -1.8777777777777789, "episode_len_mean": 29.614814814814814, "episodes_this_iter": 135, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1.700000000000001, -1.8000000000000012, -1.700000000000001, -1.4000000000000008, -2.3000000000000016, -1.700000000000001, -1.700000000000001, -1.8000000000000012, -2.5000000000000018, -1.4000000000000008, -1.8000000000000012, -1.9000000000000012, -1.700000000000001, -2.1000000000000014, -1.700000000000001, -1.700000000000001, -1.700000000000001, -1.4000000000000008, -2.1000000000000014, -1.600000000000001, -1.5000000000000009, -2.0000000000000013, -1.9000000000000012, -1.8000000000000012, -2.3000000000000016, -1.9000000000000012, -1.600000000000001, -1.9000000000000012, -3.4000000000000004, -1.5000000000000009, -1.700000000000001, -1.700000000000001, -1.5000000000000009, -1.8000000000000012, -1.9000000000000012, -1.5000000000000009, -1.8000000000000012, -2.0000000000000013, -1.600000000000001, -1.8000000000000012, -2.2000000000000015, -2.0000000000000013, -1.700000000000001, -1.8000000000000012, -1.5000000000000009, -2.800000000000002, -2.1000000000000014, -1.8000000000000012, -1.8000000000000012, -1.8000000000000012, -2.0000000000000013, -1.600000000000001, -1.600000000000001, -2.2000000000000015, -1.9000000000000012, -1.9000000000000012, -1.600000000000001, -1.5000000000000009, -2.700000000000002, -1.600000000000001, -2.0000000000000013, -2.0000000000000013, -4.900000000000001, -2.0000000000000013, -1.700000000000001, -2.2000000000000015, -1.9000000000000012, -1.9000000000000012, -1.5000000000000009, -1.700000000000001, -2.1000000000000014, -1.9000000000000012, -1.8000000000000012, -1.8000000000000012, -1.8000000000000012, -1.8000000000000012, -1.9000000000000012, -1.4000000000000008, -2.1000000000000014, -1.600000000000001, -1.5000000000000009, -1.9000000000000012, -2.3000000000000016, -1.5000000000000009, -1.600000000000001, -2.600000000000002, -2.4000000000000017, -1.5000000000000009, -2.2000000000000015, -2.2000000000000015, -1.5000000000000009, -1.700000000000001, -2.2000000000000015, -1.600000000000001, -1.8000000000000012, -2.1000000000000014, -1.8000000000000012, -1.9000000000000012, -1.8000000000000012, -1.700000000000001, -1.8000000000000012, -1.700000000000001, -1.8000000000000012, -1.9000000000000012, -2.1000000000000014, -2.2000000000000015, -1.8000000000000012, -1.600000000000001, -1.8000000000000012, -1.4000000000000008, -2.3000000000000016, -2.3000000000000016, -1.4000000000000008, -1.8000000000000012, -1.9000000000000012, -2.1000000000000014, -1.700000000000001, -1.700000000000001, -1.700000000000001, -2.1000000000000014, -1.5000000000000009, -1.700000000000001, -1.700000000000001, -2.4000000000000017, -1.8000000000000012, -1.9000000000000012, -1.5000000000000009, -2.0000000000000013, -1.8000000000000012, -2.3000000000000016, -1.600000000000001, -1.8000000000000012, -1.4000000000000008, -2.700000000000002, -1.600000000000001], "episode_lengths": [28, 29, 28, 25, 34, 28, 28, 29, 36, 25, 29, 30, 28, 32, 28, 28, 28, 25, 32, 27, 26, 31, 30, 29, 34, 30, 27, 30, 39, 26, 28, 28, 26, 29, 30, 26, 29, 31, 27, 29, 33, 31, 28, 29, 26, 39, 32, 29, 29, 29, 31, 27, 27, 33, 30, 30, 27, 26, 36, 27, 31, 31, 48, 31, 28, 33, 30, 30, 26, 28, 32, 30, 29, 29, 29, 29, 30, 25, 32, 27, 26, 30, 34, 26, 27, 35, 35, 26, 33, 33, 26, 28, 33, 27, 29, 32, 29, 30, 29, 28, 29, 28, 29, 30, 32, 33, 29, 27, 29, 25, 34, 34, 25, 29, 30, 32, 28, 28, 28, 32, 26, 28, 28, 35, 29, 30, 26, 31, 29, 34, 27, 29, 25, 38, 27]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.33354581239999553, "mean_inference_ms": 0.7265150497928644, "mean_action_processing_ms": 0.07652367420821274, "mean_env_wait_ms": 6.901017039279189, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006778681719744647, "StateBufferConnector_ms": 0.0040275079232675055, "ViewRequirementAgentConnector_ms": 0.09133409570764613}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 132000, "num_agent_steps_trained": 132000, "num_env_steps_sampled": 132000, "num_env_steps_trained": 132000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 501.9841838569925, "num_env_steps_trained_throughput_per_sec": 501.9841838569925, "timesteps_total": 132000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 132000, "timers": {"training_iteration_time_ms": 8049.261, "sample_time_ms": 4571.755, "load_time_ms": 0.986, "load_throughput": 4055112.271, "learn_time_ms": 3473.132, "learn_throughput": 1151.698, "synch_weights_time_ms": 2.737}, "counters": {"num_env_steps_sampled": 132000, "num_env_steps_trained": 132000, "num_agent_steps_sampled": 132000, "num_agent_steps_trained": 132000}, "done": false, "episodes_total": 2354, "training_iteration": 33, "trial_id": "133f9_00000", "date": "2024-03-07_13-15-31", "timestamp": 1709835331, "time_this_iter_s": 7.971480369567871, "time_total_s": 253.18083453178406, "pid": 117779, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7efea6399f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 253.18083453178406, "iterations_since_restore": 33, "perf": {"cpu_util_percent": 32.92, "ram_util_percent": 50.7, "gpu_util_percent0": 0.07400000000000001, "vram_util_percent0": 0.09401041666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 0.0379346390865663, "policy_loss": -0.012920749083321581, "vf_loss": 0.048576642628208364, "vf_explained_var": 0.951653169367903, "kl": 0.011393725251494494, "entropy": 0.29907949912932613, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 31155.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 136000, "num_env_steps_trained": 136000, "num_agent_steps_sampled": 136000, "num_agent_steps_trained": 136000}, "sampler_results": {"episode_reward_max": -1.4000000000000008, "episode_reward_min": -3.4000000000000004, "episode_reward_mean": -1.8822222222222231, "episode_len_mean": 29.733333333333334, "episode_media": {}, "episodes_this_iter": 135, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1.9000000000000012, -1.600000000000001, -1.9000000000000012, -1.8000000000000012, -1.700000000000001, -1.700000000000001, -1.8000000000000012, -1.600000000000001, -1.700000000000001, -1.700000000000001, -1.8000000000000012, -2.1000000000000014, -1.700000000000001, -1.8000000000000012, -1.700000000000001, -1.8000000000000012, -1.700000000000001, -1.9000000000000012, -1.700000000000001, -1.700000000000001, -1.4000000000000008, -1.700000000000001, -1.8000000000000012, -2.1000000000000014, -2.700000000000002, -1.9000000000000012, -1.700000000000001, -1.9000000000000012, -1.8000000000000012, -1.8000000000000012, -2.3000000000000016, -2.1000000000000014, -1.5000000000000009, -1.700000000000001, -2.1000000000000014, -1.8000000000000012, -2.0000000000000013, -2.3000000000000016, -1.8000000000000012, -1.9000000000000012, -1.700000000000001, -1.8000000000000012, -1.9000000000000012, -1.9000000000000012, -1.700000000000001, -1.9000000000000012, -2.3000000000000016, -1.700000000000001, -2.0000000000000013, -1.5000000000000009, -1.700000000000001, -1.8000000000000012, -3.0000000000000018, -1.700000000000001, -1.600000000000001, -2.0000000000000013, -2.4000000000000017, -1.8000000000000012, -1.600000000000001, -1.9000000000000012, -1.8000000000000012, -1.600000000000001, -2.0000000000000013, -2.0000000000000013, -3.4000000000000004, -1.9000000000000012, -2.600000000000002, -1.600000000000001, -1.700000000000001, -1.600000000000001, -1.8000000000000012, -1.700000000000001, -2.3000000000000016, -2.0000000000000013, -1.600000000000001, -1.4000000000000008, -2.1000000000000014, -2.1000000000000014, -1.8000000000000012, -2.1000000000000014, -2.2000000000000015, -2.1000000000000014, -2.800000000000002, -1.9000000000000012, -1.8000000000000012, -1.9000000000000012, -2.1000000000000014, -2.5000000000000018, -1.9000000000000012, -1.700000000000001, -1.5000000000000009, -2.2000000000000015, -1.9000000000000012, -1.9000000000000012, -1.5000000000000009, -3.0000000000000018, -1.9000000000000012, -2.600000000000002, -1.8000000000000012, -1.600000000000001, -2.0000000000000013, -1.9000000000000012, -1.5000000000000009, -1.600000000000001, -2.0000000000000013, -2.1000000000000014, -1.5000000000000009, -1.5000000000000009, -1.8000000000000012, -2.0000000000000013, -1.600000000000001, -1.700000000000001, -1.600000000000001, -1.700000000000001, -2.0000000000000013, -1.700000000000001, -1.600000000000001, -2.0000000000000013, -1.700000000000001, -1.700000000000001, -1.8000000000000012, -1.9000000000000012, -1.8000000000000012, -2.5000000000000018, -1.600000000000001, -1.8000000000000012, -2.0000000000000013, -1.8000000000000012, -1.8000000000000012, -1.5000000000000009, -1.600000000000001, -2.4000000000000017, -1.4000000000000008, -1.5000000000000009, -2.1000000000000014], "episode_lengths": [30, 27, 30, 29, 28, 28, 29, 27, 28, 28, 29, 32, 28, 29, 28, 29, 28, 30, 28, 28, 25, 28, 29, 32, 38, 30, 28, 30, 29, 29, 34, 32, 26, 28, 32, 29, 31, 34, 29, 30, 28, 29, 30, 30, 28, 30, 34, 28, 31, 26, 28, 29, 41, 28, 27, 31, 35, 29, 27, 30, 29, 27, 31, 31, 40, 30, 37, 27, 28, 27, 29, 28, 34, 31, 27, 25, 32, 32, 29, 32, 33, 32, 39, 30, 29, 30, 32, 36, 30, 28, 26, 32, 30, 30, 26, 37, 30, 37, 29, 27, 31, 30, 26, 27, 31, 32, 26, 26, 29, 31, 27, 28, 27, 28, 29, 28, 27, 31, 28, 28, 29, 30, 29, 36, 27, 29, 31, 29, 29, 26, 27, 35, 25, 26, 32]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.33672175902823687, "mean_inference_ms": 0.7266265309717842, "mean_action_processing_ms": 0.0764984105122071, "mean_env_wait_ms": 6.921948601928859, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006951579341182002, "StateBufferConnector_ms": 0.0040681273848922166, "ViewRequirementAgentConnector_ms": 0.09169084054452402}}, "episode_reward_max": -1.4000000000000008, "episode_reward_min": -3.4000000000000004, "episode_reward_mean": -1.8822222222222231, "episode_len_mean": 29.733333333333334, "episodes_this_iter": 135, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1.9000000000000012, -1.600000000000001, -1.9000000000000012, -1.8000000000000012, -1.700000000000001, -1.700000000000001, -1.8000000000000012, -1.600000000000001, -1.700000000000001, -1.700000000000001, -1.8000000000000012, -2.1000000000000014, -1.700000000000001, -1.8000000000000012, -1.700000000000001, -1.8000000000000012, -1.700000000000001, -1.9000000000000012, -1.700000000000001, -1.700000000000001, -1.4000000000000008, -1.700000000000001, -1.8000000000000012, -2.1000000000000014, -2.700000000000002, -1.9000000000000012, -1.700000000000001, -1.9000000000000012, -1.8000000000000012, -1.8000000000000012, -2.3000000000000016, -2.1000000000000014, -1.5000000000000009, -1.700000000000001, -2.1000000000000014, -1.8000000000000012, -2.0000000000000013, -2.3000000000000016, -1.8000000000000012, -1.9000000000000012, -1.700000000000001, -1.8000000000000012, -1.9000000000000012, -1.9000000000000012, -1.700000000000001, -1.9000000000000012, -2.3000000000000016, -1.700000000000001, -2.0000000000000013, -1.5000000000000009, -1.700000000000001, -1.8000000000000012, -3.0000000000000018, -1.700000000000001, -1.600000000000001, -2.0000000000000013, -2.4000000000000017, -1.8000000000000012, -1.600000000000001, -1.9000000000000012, -1.8000000000000012, -1.600000000000001, -2.0000000000000013, -2.0000000000000013, -3.4000000000000004, -1.9000000000000012, -2.600000000000002, -1.600000000000001, -1.700000000000001, -1.600000000000001, -1.8000000000000012, -1.700000000000001, -2.3000000000000016, -2.0000000000000013, -1.600000000000001, -1.4000000000000008, -2.1000000000000014, -2.1000000000000014, -1.8000000000000012, -2.1000000000000014, -2.2000000000000015, -2.1000000000000014, -2.800000000000002, -1.9000000000000012, -1.8000000000000012, -1.9000000000000012, -2.1000000000000014, -2.5000000000000018, -1.9000000000000012, -1.700000000000001, -1.5000000000000009, -2.2000000000000015, -1.9000000000000012, -1.9000000000000012, -1.5000000000000009, -3.0000000000000018, -1.9000000000000012, -2.600000000000002, -1.8000000000000012, -1.600000000000001, -2.0000000000000013, -1.9000000000000012, -1.5000000000000009, -1.600000000000001, -2.0000000000000013, -2.1000000000000014, -1.5000000000000009, -1.5000000000000009, -1.8000000000000012, -2.0000000000000013, -1.600000000000001, -1.700000000000001, -1.600000000000001, -1.700000000000001, -2.0000000000000013, -1.700000000000001, -1.600000000000001, -2.0000000000000013, -1.700000000000001, -1.700000000000001, -1.8000000000000012, -1.9000000000000012, -1.8000000000000012, -2.5000000000000018, -1.600000000000001, -1.8000000000000012, -2.0000000000000013, -1.8000000000000012, -1.8000000000000012, -1.5000000000000009, -1.600000000000001, -2.4000000000000017, -1.4000000000000008, -1.5000000000000009, -2.1000000000000014], "episode_lengths": [30, 27, 30, 29, 28, 28, 29, 27, 28, 28, 29, 32, 28, 29, 28, 29, 28, 30, 28, 28, 25, 28, 29, 32, 38, 30, 28, 30, 29, 29, 34, 32, 26, 28, 32, 29, 31, 34, 29, 30, 28, 29, 30, 30, 28, 30, 34, 28, 31, 26, 28, 29, 41, 28, 27, 31, 35, 29, 27, 30, 29, 27, 31, 31, 40, 30, 37, 27, 28, 27, 29, 28, 34, 31, 27, 25, 32, 32, 29, 32, 33, 32, 39, 30, 29, 30, 32, 36, 30, 28, 26, 32, 30, 30, 26, 37, 30, 37, 29, 27, 31, 30, 26, 27, 31, 32, 26, 26, 29, 31, 27, 28, 27, 28, 29, 28, 27, 31, 28, 28, 29, 30, 29, 36, 27, 29, 31, 29, 29, 26, 27, 35, 25, 26, 32]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.33672175902823687, "mean_inference_ms": 0.7266265309717842, "mean_action_processing_ms": 0.0764984105122071, "mean_env_wait_ms": 6.921948601928859, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006951579341182002, "StateBufferConnector_ms": 0.0040681273848922166, "ViewRequirementAgentConnector_ms": 0.09169084054452402}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 136000, "num_agent_steps_trained": 136000, "num_env_steps_sampled": 136000, "num_env_steps_trained": 136000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 489.47497927263385, "num_env_steps_trained_throughput_per_sec": 489.47497927263385, "timesteps_total": 136000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 136000, "timers": {"training_iteration_time_ms": 8082.743, "sample_time_ms": 4604.48, "load_time_ms": 0.986, "load_throughput": 4056092.643, "learn_time_ms": 3473.941, "learn_throughput": 1151.43, "synch_weights_time_ms": 2.686}, "counters": {"num_env_steps_sampled": 136000, "num_env_steps_trained": 136000, "num_agent_steps_sampled": 136000, "num_agent_steps_trained": 136000}, "done": false, "episodes_total": 2489, "training_iteration": 34, "trial_id": "133f9_00000", "date": "2024-03-07_13-15-39", "timestamp": 1709835339, "time_this_iter_s": 8.175256729125977, "time_total_s": 261.35609126091003, "pid": 117779, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7efea6399f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 261.35609126091003, "iterations_since_restore": 34, "perf": {"cpu_util_percent": 30.5, "ram_util_percent": 50.7, "gpu_util_percent0": 0.07999999999999999, "vram_util_percent0": 0.09401633522727272}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 0.0023251939009154036, "policy_loss": -0.016655409528363134, "vf_loss": 0.01710470194067125, "vf_explained_var": 0.9796854665202479, "kl": 0.009379510726840411, "entropy": 0.25394401575929376, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 32085.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 140000, "num_env_steps_trained": 140000, "num_agent_steps_sampled": 140000, "num_agent_steps_trained": 140000}, "sampler_results": {"episode_reward_max": -1.4000000000000008, "episode_reward_min": -2.700000000000002, "episode_reward_mean": -1.8007299270073005, "episode_len_mean": 29.00729927007299, "episode_media": {}, "episodes_this_iter": 137, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1.700000000000001, -1.700000000000001, -1.700000000000001, -1.8000000000000012, -2.5000000000000018, -2.4000000000000017, -1.5000000000000009, -1.8000000000000012, -1.8000000000000012, -1.600000000000001, -2.0000000000000013, -1.700000000000001, -1.700000000000001, -1.600000000000001, -2.0000000000000013, -1.5000000000000009, -1.8000000000000012, -1.9000000000000012, -2.0000000000000013, -1.9000000000000012, -2.0000000000000013, -1.9000000000000012, -1.600000000000001, -2.0000000000000013, -1.9000000000000012, -2.0000000000000013, -2.0000000000000013, -1.8000000000000012, -1.9000000000000012, -1.600000000000001, -2.0000000000000013, -1.700000000000001, -1.5000000000000009, -2.1000000000000014, -1.4000000000000008, -1.600000000000001, -1.600000000000001, -1.9000000000000012, -2.700000000000002, -1.5000000000000009, -1.8000000000000012, -1.8000000000000012, -1.5000000000000009, -1.700000000000001, -2.1000000000000014, -2.0000000000000013, -2.1000000000000014, -2.0000000000000013, -1.9000000000000012, -1.8000000000000012, -1.4000000000000008, -1.8000000000000012, -1.9000000000000012, -2.1000000000000014, -1.700000000000001, -1.9000000000000012, -1.4000000000000008, -1.5000000000000009, -1.700000000000001, -2.4000000000000017, -1.8000000000000012, -2.0000000000000013, -1.9000000000000012, -1.4000000000000008, -1.700000000000001, -1.8000000000000012, -2.1000000000000014, -1.700000000000001, -1.9000000000000012, -1.700000000000001, -1.700000000000001, -1.700000000000001, -2.0000000000000013, -1.700000000000001, -1.4000000000000008, -1.700000000000001, -2.0000000000000013, -1.9000000000000012, -2.2000000000000015, -2.1000000000000014, -2.4000000000000017, -1.600000000000001, -2.0000000000000013, -1.700000000000001, -1.8000000000000012, -2.1000000000000014, -1.9000000000000012, -1.600000000000001, -1.600000000000001, -1.700000000000001, -1.600000000000001, -1.8000000000000012, -1.600000000000001, -1.700000000000001, -1.600000000000001, -1.600000000000001, -1.700000000000001, -2.1000000000000014, -1.5000000000000009, -1.8000000000000012, -1.8000000000000012, -1.9000000000000012, -2.0000000000000013, -1.600000000000001, -1.700000000000001, -1.8000000000000012, -1.600000000000001, -1.5000000000000009, -2.3000000000000016, -1.700000000000001, -1.9000000000000012, -1.600000000000001, -2.0000000000000013, -1.5000000000000009, -1.600000000000001, -1.9000000000000012, -2.1000000000000014, -1.5000000000000009, -1.600000000000001, -1.700000000000001, -1.600000000000001, -1.700000000000001, -1.9000000000000012, -1.9000000000000012, -1.9000000000000012, -1.8000000000000012, -1.9000000000000012, -1.5000000000000009, -1.5000000000000009, -1.700000000000001, -2.0000000000000013, -1.5000000000000009, -1.5000000000000009, -2.0000000000000013, -2.0000000000000013, -1.8000000000000012, -1.600000000000001], "episode_lengths": [28, 28, 28, 29, 36, 35, 26, 29, 29, 27, 31, 28, 28, 27, 31, 26, 29, 30, 31, 30, 31, 30, 27, 31, 30, 31, 31, 29, 30, 27, 31, 28, 26, 32, 25, 27, 27, 30, 38, 26, 29, 29, 26, 28, 32, 31, 32, 31, 30, 29, 25, 29, 30, 32, 28, 30, 25, 26, 28, 35, 29, 31, 30, 25, 28, 29, 32, 28, 30, 28, 28, 28, 31, 28, 25, 28, 31, 30, 33, 32, 35, 27, 31, 28, 29, 32, 30, 27, 27, 28, 27, 29, 27, 28, 27, 27, 28, 32, 26, 29, 29, 30, 31, 27, 28, 29, 27, 26, 34, 28, 30, 27, 31, 26, 27, 30, 32, 26, 27, 28, 27, 28, 30, 30, 30, 29, 30, 26, 26, 28, 31, 26, 26, 31, 31, 29, 27]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.33981103100592464, "mean_inference_ms": 0.7268218568398596, "mean_action_processing_ms": 0.07649852580089707, "mean_env_wait_ms": 6.9448444856624025, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006834433896698221, "StateBufferConnector_ms": 0.004092620237030252, "ViewRequirementAgentConnector_ms": 0.09224815090207288}}, "episode_reward_max": -1.4000000000000008, "episode_reward_min": -2.700000000000002, "episode_reward_mean": -1.8007299270073005, "episode_len_mean": 29.00729927007299, "episodes_this_iter": 137, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1.700000000000001, -1.700000000000001, -1.700000000000001, -1.8000000000000012, -2.5000000000000018, -2.4000000000000017, -1.5000000000000009, -1.8000000000000012, -1.8000000000000012, -1.600000000000001, -2.0000000000000013, -1.700000000000001, -1.700000000000001, -1.600000000000001, -2.0000000000000013, -1.5000000000000009, -1.8000000000000012, -1.9000000000000012, -2.0000000000000013, -1.9000000000000012, -2.0000000000000013, -1.9000000000000012, -1.600000000000001, -2.0000000000000013, -1.9000000000000012, -2.0000000000000013, -2.0000000000000013, -1.8000000000000012, -1.9000000000000012, -1.600000000000001, -2.0000000000000013, -1.700000000000001, -1.5000000000000009, -2.1000000000000014, -1.4000000000000008, -1.600000000000001, -1.600000000000001, -1.9000000000000012, -2.700000000000002, -1.5000000000000009, -1.8000000000000012, -1.8000000000000012, -1.5000000000000009, -1.700000000000001, -2.1000000000000014, -2.0000000000000013, -2.1000000000000014, -2.0000000000000013, -1.9000000000000012, -1.8000000000000012, -1.4000000000000008, -1.8000000000000012, -1.9000000000000012, -2.1000000000000014, -1.700000000000001, -1.9000000000000012, -1.4000000000000008, -1.5000000000000009, -1.700000000000001, -2.4000000000000017, -1.8000000000000012, -2.0000000000000013, -1.9000000000000012, -1.4000000000000008, -1.700000000000001, -1.8000000000000012, -2.1000000000000014, -1.700000000000001, -1.9000000000000012, -1.700000000000001, -1.700000000000001, -1.700000000000001, -2.0000000000000013, -1.700000000000001, -1.4000000000000008, -1.700000000000001, -2.0000000000000013, -1.9000000000000012, -2.2000000000000015, -2.1000000000000014, -2.4000000000000017, -1.600000000000001, -2.0000000000000013, -1.700000000000001, -1.8000000000000012, -2.1000000000000014, -1.9000000000000012, -1.600000000000001, -1.600000000000001, -1.700000000000001, -1.600000000000001, -1.8000000000000012, -1.600000000000001, -1.700000000000001, -1.600000000000001, -1.600000000000001, -1.700000000000001, -2.1000000000000014, -1.5000000000000009, -1.8000000000000012, -1.8000000000000012, -1.9000000000000012, -2.0000000000000013, -1.600000000000001, -1.700000000000001, -1.8000000000000012, -1.600000000000001, -1.5000000000000009, -2.3000000000000016, -1.700000000000001, -1.9000000000000012, -1.600000000000001, -2.0000000000000013, -1.5000000000000009, -1.600000000000001, -1.9000000000000012, -2.1000000000000014, -1.5000000000000009, -1.600000000000001, -1.700000000000001, -1.600000000000001, -1.700000000000001, -1.9000000000000012, -1.9000000000000012, -1.9000000000000012, -1.8000000000000012, -1.9000000000000012, -1.5000000000000009, -1.5000000000000009, -1.700000000000001, -2.0000000000000013, -1.5000000000000009, -1.5000000000000009, -2.0000000000000013, -2.0000000000000013, -1.8000000000000012, -1.600000000000001], "episode_lengths": [28, 28, 28, 29, 36, 35, 26, 29, 29, 27, 31, 28, 28, 27, 31, 26, 29, 30, 31, 30, 31, 30, 27, 31, 30, 31, 31, 29, 30, 27, 31, 28, 26, 32, 25, 27, 27, 30, 38, 26, 29, 29, 26, 28, 32, 31, 32, 31, 30, 29, 25, 29, 30, 32, 28, 30, 25, 26, 28, 35, 29, 31, 30, 25, 28, 29, 32, 28, 30, 28, 28, 28, 31, 28, 25, 28, 31, 30, 33, 32, 35, 27, 31, 28, 29, 32, 30, 27, 27, 28, 27, 29, 27, 28, 27, 27, 28, 32, 26, 29, 29, 30, 31, 27, 28, 29, 27, 26, 34, 28, 30, 27, 31, 26, 27, 30, 32, 26, 27, 28, 27, 28, 30, 30, 30, 29, 30, 26, 26, 28, 31, 26, 26, 31, 31, 29, 27]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.33981103100592464, "mean_inference_ms": 0.7268218568398596, "mean_action_processing_ms": 0.07649852580089707, "mean_env_wait_ms": 6.9448444856624025, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006834433896698221, "StateBufferConnector_ms": 0.004092620237030252, "ViewRequirementAgentConnector_ms": 0.09224815090207288}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 140000, "num_agent_steps_trained": 140000, "num_env_steps_sampled": 140000, "num_env_steps_trained": 140000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 494.1299519418642, "num_env_steps_trained_throughput_per_sec": 494.1299519418642, "timesteps_total": 140000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 140000, "timers": {"training_iteration_time_ms": 8079.971, "sample_time_ms": 4618.107, "load_time_ms": 0.983, "load_throughput": 4069769.067, "learn_time_ms": 3457.52, "learn_throughput": 1156.899, "synch_weights_time_ms": 2.703}, "counters": {"num_env_steps_sampled": 140000, "num_env_steps_trained": 140000, "num_agent_steps_sampled": 140000, "num_agent_steps_trained": 140000}, "done": false, "episodes_total": 2626, "training_iteration": 35, "trial_id": "133f9_00000", "date": "2024-03-07_13-15-47", "timestamp": 1709835347, "time_this_iter_s": 8.098089694976807, "time_total_s": 269.45418095588684, "pid": 117779, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7efea6399f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 269.45418095588684, "iterations_since_restore": 35, "perf": {"cpu_util_percent": 31.53636363636364, "ram_util_percent": 50.7, "gpu_util_percent0": 0.08272727272727272, "vram_util_percent0": 0.09401633522727272}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 0.020730839120925115, "policy_loss": -0.006845666163711138, "vf_loss": 0.026382012674534914, "vf_explained_var": 0.9682975174278341, "kl": 0.005972459562894762, "entropy": 0.23096203469140555, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 33015.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_agent_steps_sampled": 144000, "num_agent_steps_trained": 144000}, "sampler_results": {"episode_reward_max": -1.4000000000000008, "episode_reward_min": -4.400000000000002, "episode_reward_mean": -1.7640845070422546, "episode_len_mean": 28.591549295774648, "episode_media": {}, "episodes_this_iter": 142, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1.600000000000001, -1.700000000000001, -1.700000000000001, -2.0000000000000013, -1.9000000000000012, -2.1000000000000014, -1.5000000000000009, -1.5000000000000009, -1.600000000000001, -1.700000000000001, -1.700000000000001, -1.9000000000000012, -2.1000000000000014, -1.600000000000001, -1.700000000000001, -1.700000000000001, -2.1000000000000014, -1.700000000000001, -2.4000000000000017, -1.5000000000000009, -2.3000000000000016, -1.5000000000000009, -1.700000000000001, -1.5000000000000009, -1.600000000000001, -1.700000000000001, -1.5000000000000009, -1.8000000000000012, -1.700000000000001, -1.600000000000001, -1.8000000000000012, -2.1000000000000014, -2.2000000000000015, -1.5000000000000009, -1.4000000000000008, -1.9000000000000012, -1.5000000000000009, -1.700000000000001, -1.600000000000001, -1.600000000000001, -2.1000000000000014, -1.600000000000001, -2.0000000000000013, -1.4000000000000008, -1.600000000000001, -1.5000000000000009, -1.5000000000000009, -1.9000000000000012, -1.8000000000000012, -2.0000000000000013, -1.5000000000000009, -2.0000000000000013, -1.8000000000000012, -2.0000000000000013, -1.9000000000000012, -1.4000000000000008, -2.0000000000000013, -1.700000000000001, -1.5000000000000009, -1.8000000000000012, -1.8000000000000012, -1.5000000000000009, -2.1000000000000014, -1.8000000000000012, -2.1000000000000014, -1.9000000000000012, -1.5000000000000009, -1.700000000000001, -2.0000000000000013, -1.600000000000001, -1.5000000000000009, -1.700000000000001, -1.5000000000000009, -1.8000000000000012, -1.8000000000000012, -1.600000000000001, -1.8000000000000012, -1.9000000000000012, -1.4000000000000008, -1.5000000000000009, -1.9000000000000012, -1.700000000000001, -1.5000000000000009, -1.9000000000000012, -1.8000000000000012, -1.9000000000000012, -1.600000000000001, -1.700000000000001, -1.4000000000000008, -4.400000000000002, -2.1000000000000014, -1.4000000000000008, -1.700000000000001, -1.700000000000001, -1.700000000000001, -1.8000000000000012, -1.600000000000001, -1.700000000000001, -1.5000000000000009, -1.9000000000000012, -1.8000000000000012, -1.5000000000000009, -2.1000000000000014, -1.9000000000000012, -1.700000000000001, -1.9000000000000012, -2.0000000000000013, -1.600000000000001, -2.1000000000000014, -1.9000000000000012, -1.8000000000000012, -1.8000000000000012, -1.9000000000000012, -1.5000000000000009, -2.2000000000000015, -1.8000000000000012, -1.8000000000000012, -1.600000000000001, -1.700000000000001, -1.9000000000000012, -1.8000000000000012, -1.8000000000000012, -1.9000000000000012, -1.700000000000001, -2.2000000000000015, -1.9000000000000012, -1.5000000000000009, -1.4000000000000008, -1.5000000000000009, -1.4000000000000008, -1.4000000000000008, -1.700000000000001, -1.600000000000001, -1.5000000000000009, -1.4000000000000008, -1.700000000000001, -2.0000000000000013, -2.2000000000000015, -1.700000000000001, -2.3000000000000016, -1.5000000000000009, -1.600000000000001], "episode_lengths": [27, 28, 28, 31, 30, 32, 26, 26, 27, 28, 28, 30, 32, 27, 28, 28, 32, 28, 35, 26, 34, 26, 28, 26, 27, 28, 26, 29, 28, 27, 29, 32, 33, 26, 25, 30, 26, 28, 27, 27, 32, 27, 31, 25, 27, 26, 26, 30, 29, 31, 26, 31, 29, 31, 30, 25, 31, 28, 26, 29, 29, 26, 32, 29, 32, 30, 26, 28, 31, 27, 26, 28, 26, 29, 29, 27, 29, 30, 25, 26, 30, 28, 26, 30, 29, 30, 27, 28, 25, 48, 32, 25, 28, 28, 28, 29, 27, 28, 26, 30, 29, 26, 32, 30, 28, 30, 31, 27, 32, 30, 29, 29, 30, 26, 33, 29, 29, 27, 28, 30, 29, 29, 30, 28, 33, 30, 26, 25, 26, 25, 25, 28, 27, 26, 25, 28, 31, 33, 28, 34, 26, 27]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.34313708232083, "mean_inference_ms": 0.7271460017933611, "mean_action_processing_ms": 0.07654810573240388, "mean_env_wait_ms": 6.971835943742831, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006840598415321027, "StateBufferConnector_ms": 0.004146300571065554, "ViewRequirementAgentConnector_ms": 0.09256164792557837}}, "episode_reward_max": -1.4000000000000008, "episode_reward_min": -4.400000000000002, "episode_reward_mean": -1.7640845070422546, "episode_len_mean": 28.591549295774648, "episodes_this_iter": 142, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1.600000000000001, -1.700000000000001, -1.700000000000001, -2.0000000000000013, -1.9000000000000012, -2.1000000000000014, -1.5000000000000009, -1.5000000000000009, -1.600000000000001, -1.700000000000001, -1.700000000000001, -1.9000000000000012, -2.1000000000000014, -1.600000000000001, -1.700000000000001, -1.700000000000001, -2.1000000000000014, -1.700000000000001, -2.4000000000000017, -1.5000000000000009, -2.3000000000000016, -1.5000000000000009, -1.700000000000001, -1.5000000000000009, -1.600000000000001, -1.700000000000001, -1.5000000000000009, -1.8000000000000012, -1.700000000000001, -1.600000000000001, -1.8000000000000012, -2.1000000000000014, -2.2000000000000015, -1.5000000000000009, -1.4000000000000008, -1.9000000000000012, -1.5000000000000009, -1.700000000000001, -1.600000000000001, -1.600000000000001, -2.1000000000000014, -1.600000000000001, -2.0000000000000013, -1.4000000000000008, -1.600000000000001, -1.5000000000000009, -1.5000000000000009, -1.9000000000000012, -1.8000000000000012, -2.0000000000000013, -1.5000000000000009, -2.0000000000000013, -1.8000000000000012, -2.0000000000000013, -1.9000000000000012, -1.4000000000000008, -2.0000000000000013, -1.700000000000001, -1.5000000000000009, -1.8000000000000012, -1.8000000000000012, -1.5000000000000009, -2.1000000000000014, -1.8000000000000012, -2.1000000000000014, -1.9000000000000012, -1.5000000000000009, -1.700000000000001, -2.0000000000000013, -1.600000000000001, -1.5000000000000009, -1.700000000000001, -1.5000000000000009, -1.8000000000000012, -1.8000000000000012, -1.600000000000001, -1.8000000000000012, -1.9000000000000012, -1.4000000000000008, -1.5000000000000009, -1.9000000000000012, -1.700000000000001, -1.5000000000000009, -1.9000000000000012, -1.8000000000000012, -1.9000000000000012, -1.600000000000001, -1.700000000000001, -1.4000000000000008, -4.400000000000002, -2.1000000000000014, -1.4000000000000008, -1.700000000000001, -1.700000000000001, -1.700000000000001, -1.8000000000000012, -1.600000000000001, -1.700000000000001, -1.5000000000000009, -1.9000000000000012, -1.8000000000000012, -1.5000000000000009, -2.1000000000000014, -1.9000000000000012, -1.700000000000001, -1.9000000000000012, -2.0000000000000013, -1.600000000000001, -2.1000000000000014, -1.9000000000000012, -1.8000000000000012, -1.8000000000000012, -1.9000000000000012, -1.5000000000000009, -2.2000000000000015, -1.8000000000000012, -1.8000000000000012, -1.600000000000001, -1.700000000000001, -1.9000000000000012, -1.8000000000000012, -1.8000000000000012, -1.9000000000000012, -1.700000000000001, -2.2000000000000015, -1.9000000000000012, -1.5000000000000009, -1.4000000000000008, -1.5000000000000009, -1.4000000000000008, -1.4000000000000008, -1.700000000000001, -1.600000000000001, -1.5000000000000009, -1.4000000000000008, -1.700000000000001, -2.0000000000000013, -2.2000000000000015, -1.700000000000001, -2.3000000000000016, -1.5000000000000009, -1.600000000000001], "episode_lengths": [27, 28, 28, 31, 30, 32, 26, 26, 27, 28, 28, 30, 32, 27, 28, 28, 32, 28, 35, 26, 34, 26, 28, 26, 27, 28, 26, 29, 28, 27, 29, 32, 33, 26, 25, 30, 26, 28, 27, 27, 32, 27, 31, 25, 27, 26, 26, 30, 29, 31, 26, 31, 29, 31, 30, 25, 31, 28, 26, 29, 29, 26, 32, 29, 32, 30, 26, 28, 31, 27, 26, 28, 26, 29, 29, 27, 29, 30, 25, 26, 30, 28, 26, 30, 29, 30, 27, 28, 25, 48, 32, 25, 28, 28, 28, 29, 27, 28, 26, 30, 29, 26, 32, 30, 28, 30, 31, 27, 32, 30, 29, 29, 30, 26, 33, 29, 29, 27, 28, 30, 29, 29, 30, 28, 33, 30, 26, 25, 26, 25, 25, 28, 27, 26, 25, 28, 31, 33, 28, 34, 26, 27]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.34313708232083, "mean_inference_ms": 0.7271460017933611, "mean_action_processing_ms": 0.07654810573240388, "mean_env_wait_ms": 6.971835943742831, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006840598415321027, "StateBufferConnector_ms": 0.004146300571065554, "ViewRequirementAgentConnector_ms": 0.09256164792557837}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 144000, "num_agent_steps_trained": 144000, "num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 470.6131443417317, "num_env_steps_trained_throughput_per_sec": 470.6131443417317, "timesteps_total": 144000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 144000, "timers": {"training_iteration_time_ms": 8105.249, "sample_time_ms": 4639.815, "load_time_ms": 0.984, "load_throughput": 4067006.691, "learn_time_ms": 3461.088, "learn_throughput": 1155.706, "synch_weights_time_ms": 2.709}, "counters": {"num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_agent_steps_sampled": 144000, "num_agent_steps_trained": 144000}, "done": false, "episodes_total": 2768, "training_iteration": 36, "trial_id": "133f9_00000", "date": "2024-03-07_13-15-55", "timestamp": 1709835355, "time_this_iter_s": 8.502553224563599, "time_total_s": 277.95673418045044, "pid": 117779, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7efea6399f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 277.95673418045044, "iterations_since_restore": 36, "perf": {"cpu_util_percent": 30.972727272727266, "ram_util_percent": 50.7, "gpu_util_percent0": 0.08363636363636363, "vram_util_percent0": 0.09401633522727272}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 0.5768899096979669, "policy_loss": -0.017647285278766387, "vf_loss": 0.5908721696132273, "vf_explained_var": 0.7437618592093068, "kl": 0.018325116567245475, "entropy": 0.25531273024377005, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 33945.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 148000, "num_env_steps_trained": 148000, "num_agent_steps_sampled": 148000, "num_agent_steps_trained": 148000}, "sampler_results": {"episode_reward_max": -1.4000000000000008, "episode_reward_min": -16.899999999999984, "episode_reward_mean": -1.9586466165413543, "episode_len_mean": 30.36842105263158, "episode_media": {}, "episodes_this_iter": 133, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-13.199999999999966, -1.700000000000001, -1.4000000000000008, -1.600000000000001, -1.8000000000000012, -1.700000000000001, -1.8000000000000012, -1.4000000000000008, -1.8000000000000012, -2.1000000000000014, -1.5000000000000009, -1.8000000000000012, -1.9000000000000012, -1.700000000000001, -1.700000000000001, -1.4000000000000008, -2.2000000000000015, -1.700000000000001, -1.700000000000001, -1.4000000000000008, -1.700000000000001, -1.5000000000000009, -2.600000000000002, -1.8000000000000012, -1.700000000000001, -2.0000000000000013, -2.0000000000000013, -1.8000000000000012, -1.9000000000000012, -1.5000000000000009, -1.5000000000000009, -2.5000000000000018, -1.5000000000000009, -1.600000000000001, -2.0000000000000013, -2.2000000000000015, -1.8000000000000012, -2.0000000000000013, -3.200000000000001, -1.5000000000000009, -2.3000000000000016, -1.5000000000000009, -1.8000000000000012, -2.1000000000000014, -1.5000000000000009, -1.8000000000000012, -1.5000000000000009, -1.9000000000000012, -1.5000000000000009, -1.4000000000000008, -1.700000000000001, -1.700000000000001, -1.600000000000001, -16.899999999999984, -3.6000000000000014, -1.8000000000000012, -1.5000000000000009, -1.600000000000001, -1.5000000000000009, -1.600000000000001, -1.8000000000000012, -1.5000000000000009, -2.0000000000000013, -1.600000000000001, -1.4000000000000008, -1.5000000000000009, -1.8000000000000012, -1.9000000000000012, -1.600000000000001, -1.600000000000001, -1.5000000000000009, -1.5000000000000009, -1.700000000000001, -1.700000000000001, -1.9000000000000012, -1.4000000000000008, -1.5000000000000009, -1.600000000000001, -1.5000000000000009, -1.600000000000001, -1.8000000000000012, -2.1000000000000014, -1.600000000000001, -1.4000000000000008, -1.700000000000001, -1.600000000000001, -1.4000000000000008, -1.5000000000000009, -1.600000000000001, -1.4000000000000008, -1.8000000000000012, -1.700000000000001, -1.700000000000001, -1.700000000000001, -2.600000000000002, -1.9000000000000012, -3.3000000000000007, -1.4000000000000008, -2.0000000000000013, -1.600000000000001, -1.600000000000001, -1.8000000000000012, -1.5000000000000009, -1.8000000000000012, -1.600000000000001, -1.9000000000000012, -1.5000000000000009, -4.799999999999997, -1.5000000000000009, -1.4000000000000008, -1.8000000000000012, -1.5000000000000009, -1.600000000000001, -1.700000000000001, -1.9000000000000012, -1.600000000000001, -1.4000000000000008, -1.4000000000000008, -1.5000000000000009, -1.700000000000001, -1.5000000000000009, -2.0000000000000013, -1.600000000000001, -1.5000000000000009, -1.4000000000000008, -1.4000000000000008, -1.9000000000000012, -1.5000000000000009, -1.700000000000001, -2.1000000000000014, -2.1000000000000014, -1.4000000000000008, -1.9000000000000012], "episode_lengths": [140, 28, 25, 27, 28, 28, 29, 25, 29, 32, 26, 29, 30, 28, 28, 25, 33, 28, 28, 25, 28, 26, 37, 29, 28, 31, 31, 29, 30, 26, 26, 36, 26, 27, 31, 31, 29, 31, 42, 26, 34, 26, 29, 32, 26, 29, 26, 30, 26, 25, 28, 28, 27, 177, 39, 29, 26, 27, 26, 27, 29, 26, 31, 27, 25, 26, 29, 30, 27, 27, 26, 26, 28, 28, 30, 25, 26, 27, 26, 27, 29, 32, 27, 25, 28, 27, 25, 26, 27, 25, 29, 28, 28, 28, 37, 30, 41, 25, 31, 27, 27, 29, 26, 29, 27, 30, 26, 51, 26, 25, 29, 26, 27, 28, 30, 27, 25, 25, 26, 28, 26, 31, 27, 26, 25, 25, 30, 26, 28, 32, 32, 25, 30]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3456179689795758, "mean_inference_ms": 0.7270552637444282, "mean_action_processing_ms": 0.0764830813994003, "mean_env_wait_ms": 6.993943538011462, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0067551333205144205, "StateBufferConnector_ms": 0.004074268771293468, "ViewRequirementAgentConnector_ms": 0.09095704645142519}}, "episode_reward_max": -1.4000000000000008, "episode_reward_min": -16.899999999999984, "episode_reward_mean": -1.9586466165413543, "episode_len_mean": 30.36842105263158, "episodes_this_iter": 133, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-13.199999999999966, -1.700000000000001, -1.4000000000000008, -1.600000000000001, -1.8000000000000012, -1.700000000000001, -1.8000000000000012, -1.4000000000000008, -1.8000000000000012, -2.1000000000000014, -1.5000000000000009, -1.8000000000000012, -1.9000000000000012, -1.700000000000001, -1.700000000000001, -1.4000000000000008, -2.2000000000000015, -1.700000000000001, -1.700000000000001, -1.4000000000000008, -1.700000000000001, -1.5000000000000009, -2.600000000000002, -1.8000000000000012, -1.700000000000001, -2.0000000000000013, -2.0000000000000013, -1.8000000000000012, -1.9000000000000012, -1.5000000000000009, -1.5000000000000009, -2.5000000000000018, -1.5000000000000009, -1.600000000000001, -2.0000000000000013, -2.2000000000000015, -1.8000000000000012, -2.0000000000000013, -3.200000000000001, -1.5000000000000009, -2.3000000000000016, -1.5000000000000009, -1.8000000000000012, -2.1000000000000014, -1.5000000000000009, -1.8000000000000012, -1.5000000000000009, -1.9000000000000012, -1.5000000000000009, -1.4000000000000008, -1.700000000000001, -1.700000000000001, -1.600000000000001, -16.899999999999984, -3.6000000000000014, -1.8000000000000012, -1.5000000000000009, -1.600000000000001, -1.5000000000000009, -1.600000000000001, -1.8000000000000012, -1.5000000000000009, -2.0000000000000013, -1.600000000000001, -1.4000000000000008, -1.5000000000000009, -1.8000000000000012, -1.9000000000000012, -1.600000000000001, -1.600000000000001, -1.5000000000000009, -1.5000000000000009, -1.700000000000001, -1.700000000000001, -1.9000000000000012, -1.4000000000000008, -1.5000000000000009, -1.600000000000001, -1.5000000000000009, -1.600000000000001, -1.8000000000000012, -2.1000000000000014, -1.600000000000001, -1.4000000000000008, -1.700000000000001, -1.600000000000001, -1.4000000000000008, -1.5000000000000009, -1.600000000000001, -1.4000000000000008, -1.8000000000000012, -1.700000000000001, -1.700000000000001, -1.700000000000001, -2.600000000000002, -1.9000000000000012, -3.3000000000000007, -1.4000000000000008, -2.0000000000000013, -1.600000000000001, -1.600000000000001, -1.8000000000000012, -1.5000000000000009, -1.8000000000000012, -1.600000000000001, -1.9000000000000012, -1.5000000000000009, -4.799999999999997, -1.5000000000000009, -1.4000000000000008, -1.8000000000000012, -1.5000000000000009, -1.600000000000001, -1.700000000000001, -1.9000000000000012, -1.600000000000001, -1.4000000000000008, -1.4000000000000008, -1.5000000000000009, -1.700000000000001, -1.5000000000000009, -2.0000000000000013, -1.600000000000001, -1.5000000000000009, -1.4000000000000008, -1.4000000000000008, -1.9000000000000012, -1.5000000000000009, -1.700000000000001, -2.1000000000000014, -2.1000000000000014, -1.4000000000000008, -1.9000000000000012], "episode_lengths": [140, 28, 25, 27, 28, 28, 29, 25, 29, 32, 26, 29, 30, 28, 28, 25, 33, 28, 28, 25, 28, 26, 37, 29, 28, 31, 31, 29, 30, 26, 26, 36, 26, 27, 31, 31, 29, 31, 42, 26, 34, 26, 29, 32, 26, 29, 26, 30, 26, 25, 28, 28, 27, 177, 39, 29, 26, 27, 26, 27, 29, 26, 31, 27, 25, 26, 29, 30, 27, 27, 26, 26, 28, 28, 30, 25, 26, 27, 26, 27, 29, 32, 27, 25, 28, 27, 25, 26, 27, 25, 29, 28, 28, 28, 37, 30, 41, 25, 31, 27, 27, 29, 26, 29, 27, 30, 26, 51, 26, 25, 29, 26, 27, 28, 30, 27, 25, 25, 26, 28, 26, 31, 27, 26, 25, 25, 30, 26, 28, 32, 32, 25, 30]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3456179689795758, "mean_inference_ms": 0.7270552637444282, "mean_action_processing_ms": 0.0764830813994003, "mean_env_wait_ms": 6.993943538011462, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0067551333205144205, "StateBufferConnector_ms": 0.004074268771293468, "ViewRequirementAgentConnector_ms": 0.09095704645142519}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 148000, "num_agent_steps_trained": 148000, "num_env_steps_sampled": 148000, "num_env_steps_trained": 148000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 486.66345516045897, "num_env_steps_trained_throughput_per_sec": 486.66345516045897, "timesteps_total": 148000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 148000, "timers": {"training_iteration_time_ms": 8122.407, "sample_time_ms": 4659.86, "load_time_ms": 0.96, "load_throughput": 4168770.282, "learn_time_ms": 3458.179, "learn_throughput": 1156.678, "synch_weights_time_ms": 2.764}, "counters": {"num_env_steps_sampled": 148000, "num_env_steps_trained": 148000, "num_agent_steps_sampled": 148000, "num_agent_steps_trained": 148000}, "done": false, "episodes_total": 2901, "training_iteration": 37, "trial_id": "133f9_00000", "date": "2024-03-07_13-16-04", "timestamp": 1709835364, "time_this_iter_s": 8.22213888168335, "time_total_s": 286.1788730621338, "pid": 117779, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7efea6399f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 286.1788730621338, "iterations_since_restore": 37, "perf": {"cpu_util_percent": 33.01, "ram_util_percent": 50.7, "gpu_util_percent0": 0.074, "vram_util_percent0": 0.09401041666666668}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 0.253478565598808, "policy_loss": -0.010053751473465274, "vf_loss": 0.2606847603975605, "vf_explained_var": 0.8291510686438571, "kl": 0.014237772446371725, "entropy": 0.2506770795391452, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 34875.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 152000, "num_env_steps_trained": 152000, "num_agent_steps_sampled": 152000, "num_agent_steps_trained": 152000}, "sampler_results": {"episode_reward_max": -1.4000000000000008, "episode_reward_min": -5.499999999999993, "episode_reward_mean": -1.8895522388059711, "episode_len_mean": 29.51492537313433, "episode_media": {}, "episodes_this_iter": 134, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1.5000000000000009, -1.600000000000001, -3.1000000000000014, -1.5000000000000009, -1.700000000000001, -1.700000000000001, -1.700000000000001, -1.9000000000000012, -2.0000000000000013, -2.1000000000000014, -2.700000000000002, -1.5000000000000009, -1.600000000000001, -1.5000000000000009, -1.8000000000000012, -2.600000000000002, -1.600000000000001, -1.600000000000001, -1.600000000000001, -1.5000000000000009, -1.9000000000000012, -2.1000000000000014, -1.9000000000000012, -2.0000000000000013, -1.600000000000001, -1.600000000000001, -1.4000000000000008, -2.5000000000000018, -1.4000000000000008, -1.8000000000000012, -1.5000000000000009, -1.8000000000000012, -1.600000000000001, -1.700000000000001, -1.8000000000000012, -1.5000000000000009, -1.8000000000000012, -1.8000000000000012, -4.6000000000000005, -1.4000000000000008, -3.8999999999999986, -1.600000000000001, -1.600000000000001, -4.799999999999995, -1.5000000000000009, -1.600000000000001, -2.5000000000000018, -1.600000000000001, -1.600000000000001, -1.5000000000000009, -1.600000000000001, -1.700000000000001, -1.600000000000001, -1.9000000000000012, -1.5000000000000009, -1.700000000000001, -1.5000000000000009, -1.9000000000000012, -1.5000000000000009, -1.600000000000001, -1.9000000000000012, -2.1000000000000014, -1.8000000000000012, -2.0000000000000013, -1.8000000000000012, -1.8000000000000012, -1.5000000000000009, -1.9000000000000012, -2.3000000000000016, -1.9000000000000012, -2.0000000000000013, -2.5000000000000018, -1.600000000000001, -1.8000000000000012, -1.9000000000000012, -1.9000000000000012, -1.600000000000001, -1.700000000000001, -2.1000000000000014, -1.4000000000000008, -2.0000000000000013, -1.5000000000000009, -1.5000000000000009, -1.5000000000000009, -1.700000000000001, -1.700000000000001, -1.700000000000001, -3.0000000000000018, -1.600000000000001, -1.5000000000000009, -2.0000000000000013, -1.700000000000001, -5.499999999999993, -1.4000000000000008, -1.700000000000001, -1.600000000000001, -1.5000000000000009, -1.8000000000000012, -1.700000000000001, -1.600000000000001, -1.5000000000000009, -2.0000000000000013, -1.700000000000001, -1.700000000000001, -1.8000000000000012, -1.700000000000001, -2.5000000000000018, -1.600000000000001, -1.9000000000000012, -2.900000000000002, -1.700000000000001, -1.5000000000000009, -1.9000000000000012, -1.8000000000000012, -1.9000000000000012, -1.9000000000000012, -2.3000000000000016, -1.4000000000000008, -2.3000000000000016, -1.4000000000000008, -3.0000000000000018, -1.5000000000000009, -1.700000000000001, -3.4000000000000004, -1.600000000000001, -1.600000000000001, -1.8000000000000012, -1.600000000000001, -1.8000000000000012, -1.600000000000001, -2.0000000000000013, -1.600000000000001, -2.3000000000000016, -1.4000000000000008], "episode_lengths": [26, 27, 37, 26, 28, 28, 28, 30, 31, 32, 38, 26, 27, 26, 29, 37, 27, 27, 27, 26, 30, 32, 30, 31, 27, 27, 25, 34, 25, 29, 26, 29, 27, 28, 29, 26, 29, 29, 50, 25, 44, 27, 27, 59, 26, 27, 32, 27, 27, 26, 27, 28, 27, 30, 26, 28, 26, 30, 26, 27, 30, 32, 29, 31, 29, 29, 26, 30, 34, 30, 31, 36, 27, 29, 30, 30, 27, 28, 32, 25, 31, 26, 26, 26, 28, 28, 28, 35, 27, 26, 31, 28, 63, 25, 28, 27, 26, 29, 28, 27, 26, 31, 28, 28, 29, 28, 36, 27, 30, 36, 28, 26, 30, 29, 30, 30, 34, 25, 31, 25, 36, 26, 28, 39, 27, 27, 29, 27, 29, 27, 31, 27, 34, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3481309804032448, "mean_inference_ms": 0.7273755560700967, "mean_action_processing_ms": 0.07655623202474049, "mean_env_wait_ms": 7.015964023117423, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006796886671834917, "StateBufferConnector_ms": 0.004107560684431845, "ViewRequirementAgentConnector_ms": 0.09075687892401396}}, "episode_reward_max": -1.4000000000000008, "episode_reward_min": -5.499999999999993, "episode_reward_mean": -1.8895522388059711, "episode_len_mean": 29.51492537313433, "episodes_this_iter": 134, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1.5000000000000009, -1.600000000000001, -3.1000000000000014, -1.5000000000000009, -1.700000000000001, -1.700000000000001, -1.700000000000001, -1.9000000000000012, -2.0000000000000013, -2.1000000000000014, -2.700000000000002, -1.5000000000000009, -1.600000000000001, -1.5000000000000009, -1.8000000000000012, -2.600000000000002, -1.600000000000001, -1.600000000000001, -1.600000000000001, -1.5000000000000009, -1.9000000000000012, -2.1000000000000014, -1.9000000000000012, -2.0000000000000013, -1.600000000000001, -1.600000000000001, -1.4000000000000008, -2.5000000000000018, -1.4000000000000008, -1.8000000000000012, -1.5000000000000009, -1.8000000000000012, -1.600000000000001, -1.700000000000001, -1.8000000000000012, -1.5000000000000009, -1.8000000000000012, -1.8000000000000012, -4.6000000000000005, -1.4000000000000008, -3.8999999999999986, -1.600000000000001, -1.600000000000001, -4.799999999999995, -1.5000000000000009, -1.600000000000001, -2.5000000000000018, -1.600000000000001, -1.600000000000001, -1.5000000000000009, -1.600000000000001, -1.700000000000001, -1.600000000000001, -1.9000000000000012, -1.5000000000000009, -1.700000000000001, -1.5000000000000009, -1.9000000000000012, -1.5000000000000009, -1.600000000000001, -1.9000000000000012, -2.1000000000000014, -1.8000000000000012, -2.0000000000000013, -1.8000000000000012, -1.8000000000000012, -1.5000000000000009, -1.9000000000000012, -2.3000000000000016, -1.9000000000000012, -2.0000000000000013, -2.5000000000000018, -1.600000000000001, -1.8000000000000012, -1.9000000000000012, -1.9000000000000012, -1.600000000000001, -1.700000000000001, -2.1000000000000014, -1.4000000000000008, -2.0000000000000013, -1.5000000000000009, -1.5000000000000009, -1.5000000000000009, -1.700000000000001, -1.700000000000001, -1.700000000000001, -3.0000000000000018, -1.600000000000001, -1.5000000000000009, -2.0000000000000013, -1.700000000000001, -5.499999999999993, -1.4000000000000008, -1.700000000000001, -1.600000000000001, -1.5000000000000009, -1.8000000000000012, -1.700000000000001, -1.600000000000001, -1.5000000000000009, -2.0000000000000013, -1.700000000000001, -1.700000000000001, -1.8000000000000012, -1.700000000000001, -2.5000000000000018, -1.600000000000001, -1.9000000000000012, -2.900000000000002, -1.700000000000001, -1.5000000000000009, -1.9000000000000012, -1.8000000000000012, -1.9000000000000012, -1.9000000000000012, -2.3000000000000016, -1.4000000000000008, -2.3000000000000016, -1.4000000000000008, -3.0000000000000018, -1.5000000000000009, -1.700000000000001, -3.4000000000000004, -1.600000000000001, -1.600000000000001, -1.8000000000000012, -1.600000000000001, -1.8000000000000012, -1.600000000000001, -2.0000000000000013, -1.600000000000001, -2.3000000000000016, -1.4000000000000008], "episode_lengths": [26, 27, 37, 26, 28, 28, 28, 30, 31, 32, 38, 26, 27, 26, 29, 37, 27, 27, 27, 26, 30, 32, 30, 31, 27, 27, 25, 34, 25, 29, 26, 29, 27, 28, 29, 26, 29, 29, 50, 25, 44, 27, 27, 59, 26, 27, 32, 27, 27, 26, 27, 28, 27, 30, 26, 28, 26, 30, 26, 27, 30, 32, 29, 31, 29, 29, 26, 30, 34, 30, 31, 36, 27, 29, 30, 30, 27, 28, 32, 25, 31, 26, 26, 26, 28, 28, 28, 35, 27, 26, 31, 28, 63, 25, 28, 27, 26, 29, 28, 27, 26, 31, 28, 28, 29, 28, 36, 27, 30, 36, 28, 26, 30, 29, 30, 30, 34, 25, 31, 25, 36, 26, 28, 39, 27, 27, 29, 27, 29, 27, 31, 27, 34, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3481309804032448, "mean_inference_ms": 0.7273755560700967, "mean_action_processing_ms": 0.07655623202474049, "mean_env_wait_ms": 7.015964023117423, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006796886671834917, "StateBufferConnector_ms": 0.004107560684431845, "ViewRequirementAgentConnector_ms": 0.09075687892401396}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 152000, "num_agent_steps_trained": 152000, "num_env_steps_sampled": 152000, "num_env_steps_trained": 152000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 490.3062096305163, "num_env_steps_trained_throughput_per_sec": 490.3062096305163, "timesteps_total": 152000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 152000, "timers": {"training_iteration_time_ms": 8121.157, "sample_time_ms": 4659.258, "load_time_ms": 0.969, "load_throughput": 4126627.312, "learn_time_ms": 3457.542, "learn_throughput": 1156.891, "synch_weights_time_ms": 2.751}, "counters": {"num_env_steps_sampled": 152000, "num_env_steps_trained": 152000, "num_agent_steps_sampled": 152000, "num_agent_steps_trained": 152000}, "done": false, "episodes_total": 3035, "training_iteration": 38, "trial_id": "133f9_00000", "date": "2024-03-07_13-16-12", "timestamp": 1709835372, "time_this_iter_s": 8.161323547363281, "time_total_s": 294.34019660949707, "pid": 117779, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7efea6399f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 294.34019660949707, "iterations_since_restore": 38, "perf": {"cpu_util_percent": 30.709090909090904, "ram_util_percent": 50.7, "gpu_util_percent0": 0.06909090909090909, "vram_util_percent0": 0.09400153882575757}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 0.1377121599906835, "policy_loss": -0.011135028667187179, "vf_loss": 0.14593749754230984, "vf_explained_var": 0.8919265222164893, "kl": 0.01454846008974125, "entropy": 0.2712753252156319, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 35805.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 156000, "num_env_steps_trained": 156000, "num_agent_steps_sampled": 156000, "num_agent_steps_trained": 156000}, "sampler_results": {"episode_reward_max": -1.4000000000000008, "episode_reward_min": -5.700000000000003, "episode_reward_mean": -1.8304347826086969, "episode_len_mean": 29.036231884057973, "episode_media": {}, "episodes_this_iter": 138, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1.700000000000001, -2.5000000000000018, -2.0000000000000013, -1.8000000000000012, -1.700000000000001, -1.5000000000000009, -1.9000000000000012, -1.600000000000001, -2.0000000000000013, -1.600000000000001, -1.600000000000001, -1.4000000000000008, -1.700000000000001, -1.600000000000001, -2.0000000000000013, -1.700000000000001, -1.600000000000001, -1.600000000000001, -1.8000000000000012, -1.600000000000001, -2.2000000000000015, -1.5000000000000009, -1.600000000000001, -1.5000000000000009, -1.700000000000001, -1.700000000000001, -1.8000000000000012, -1.9000000000000012, -1.700000000000001, -1.600000000000001, -1.8000000000000012, -1.5000000000000009, -1.700000000000001, -1.8000000000000012, -3.4000000000000012, -1.600000000000001, -1.8000000000000012, -3.1000000000000014, -1.9000000000000012, -2.4000000000000017, -1.9000000000000012, -1.8000000000000012, -1.8000000000000012, -1.700000000000001, -1.9000000000000012, -1.4000000000000008, -1.600000000000001, -2.1000000000000014, -1.600000000000001, -1.8000000000000012, -1.9000000000000012, -1.9000000000000012, -1.9000000000000012, -1.700000000000001, -1.8000000000000012, -2.2000000000000015, -2.800000000000002, -2.0000000000000013, -1.5000000000000009, -1.5000000000000009, -1.4000000000000008, -1.5000000000000009, -1.8000000000000012, -1.700000000000001, -2.5000000000000018, -1.5000000000000009, -2.5000000000000018, -1.600000000000001, -1.8000000000000012, -1.600000000000001, -1.600000000000001, -1.8000000000000012, -1.4000000000000008, -1.4000000000000008, -2.1000000000000014, -5.700000000000003, -1.700000000000001, -1.700000000000001, -1.9000000000000012, -1.4000000000000008, -1.5000000000000009, -1.700000000000001, -1.5000000000000009, -2.3000000000000016, -2.2000000000000015, -1.5000000000000009, -2.0000000000000013, -2.700000000000002, -1.700000000000001, -1.700000000000001, -1.5000000000000009, -1.5000000000000009, -1.600000000000001, -1.5000000000000009, -2.1000000000000014, -2.3000000000000016, -1.5000000000000009, -1.5000000000000009, -1.9000000000000012, -1.5000000000000009, -1.700000000000001, -2.1000000000000014, -1.4000000000000008, -1.600000000000001, -1.8000000000000012, -1.600000000000001, -1.4000000000000008, -2.1000000000000014, -1.600000000000001, -2.2000000000000015, -1.9000000000000012, -1.9000000000000012, -1.600000000000001, -1.8000000000000012, -1.8000000000000012, -2.600000000000002, -1.9000000000000012, -1.600000000000001, -1.8000000000000012, -1.700000000000001, -1.700000000000001, -1.8000000000000012, -1.9000000000000012, -1.8000000000000012, -1.5000000000000009, -2.0000000000000013, -1.8000000000000012, -1.700000000000001, -1.9000000000000012, -1.700000000000001, -1.700000000000001, -1.9000000000000012, -1.700000000000001, -2.0000000000000013, -1.8000000000000012, -2.0000000000000013, -1.8000000000000012, -1.600000000000001], "episode_lengths": [28, 36, 31, 29, 28, 26, 30, 27, 31, 27, 27, 25, 28, 27, 31, 28, 27, 27, 29, 27, 33, 26, 27, 26, 28, 28, 29, 30, 28, 27, 29, 26, 28, 29, 39, 27, 29, 36, 30, 35, 30, 29, 29, 28, 30, 25, 27, 32, 27, 29, 30, 30, 30, 28, 29, 32, 36, 31, 26, 26, 25, 26, 29, 28, 34, 26, 32, 27, 29, 27, 27, 29, 25, 25, 32, 56, 28, 28, 30, 25, 26, 28, 26, 34, 33, 26, 31, 35, 28, 28, 26, 26, 27, 26, 32, 34, 26, 26, 30, 26, 28, 32, 25, 27, 29, 27, 25, 32, 27, 33, 30, 30, 27, 29, 29, 37, 30, 27, 29, 28, 28, 29, 30, 29, 26, 31, 29, 28, 30, 28, 28, 30, 28, 31, 29, 31, 29, 27]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3505607197572982, "mean_inference_ms": 0.7273426822203455, "mean_action_processing_ms": 0.07653785733743539, "mean_env_wait_ms": 7.030948915225701, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006758821183356686, "StateBufferConnector_ms": 0.004050697105518286, "ViewRequirementAgentConnector_ms": 0.09119441543800244}}, "episode_reward_max": -1.4000000000000008, "episode_reward_min": -5.700000000000003, "episode_reward_mean": -1.8304347826086969, "episode_len_mean": 29.036231884057973, "episodes_this_iter": 138, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1.700000000000001, -2.5000000000000018, -2.0000000000000013, -1.8000000000000012, -1.700000000000001, -1.5000000000000009, -1.9000000000000012, -1.600000000000001, -2.0000000000000013, -1.600000000000001, -1.600000000000001, -1.4000000000000008, -1.700000000000001, -1.600000000000001, -2.0000000000000013, -1.700000000000001, -1.600000000000001, -1.600000000000001, -1.8000000000000012, -1.600000000000001, -2.2000000000000015, -1.5000000000000009, -1.600000000000001, -1.5000000000000009, -1.700000000000001, -1.700000000000001, -1.8000000000000012, -1.9000000000000012, -1.700000000000001, -1.600000000000001, -1.8000000000000012, -1.5000000000000009, -1.700000000000001, -1.8000000000000012, -3.4000000000000012, -1.600000000000001, -1.8000000000000012, -3.1000000000000014, -1.9000000000000012, -2.4000000000000017, -1.9000000000000012, -1.8000000000000012, -1.8000000000000012, -1.700000000000001, -1.9000000000000012, -1.4000000000000008, -1.600000000000001, -2.1000000000000014, -1.600000000000001, -1.8000000000000012, -1.9000000000000012, -1.9000000000000012, -1.9000000000000012, -1.700000000000001, -1.8000000000000012, -2.2000000000000015, -2.800000000000002, -2.0000000000000013, -1.5000000000000009, -1.5000000000000009, -1.4000000000000008, -1.5000000000000009, -1.8000000000000012, -1.700000000000001, -2.5000000000000018, -1.5000000000000009, -2.5000000000000018, -1.600000000000001, -1.8000000000000012, -1.600000000000001, -1.600000000000001, -1.8000000000000012, -1.4000000000000008, -1.4000000000000008, -2.1000000000000014, -5.700000000000003, -1.700000000000001, -1.700000000000001, -1.9000000000000012, -1.4000000000000008, -1.5000000000000009, -1.700000000000001, -1.5000000000000009, -2.3000000000000016, -2.2000000000000015, -1.5000000000000009, -2.0000000000000013, -2.700000000000002, -1.700000000000001, -1.700000000000001, -1.5000000000000009, -1.5000000000000009, -1.600000000000001, -1.5000000000000009, -2.1000000000000014, -2.3000000000000016, -1.5000000000000009, -1.5000000000000009, -1.9000000000000012, -1.5000000000000009, -1.700000000000001, -2.1000000000000014, -1.4000000000000008, -1.600000000000001, -1.8000000000000012, -1.600000000000001, -1.4000000000000008, -2.1000000000000014, -1.600000000000001, -2.2000000000000015, -1.9000000000000012, -1.9000000000000012, -1.600000000000001, -1.8000000000000012, -1.8000000000000012, -2.600000000000002, -1.9000000000000012, -1.600000000000001, -1.8000000000000012, -1.700000000000001, -1.700000000000001, -1.8000000000000012, -1.9000000000000012, -1.8000000000000012, -1.5000000000000009, -2.0000000000000013, -1.8000000000000012, -1.700000000000001, -1.9000000000000012, -1.700000000000001, -1.700000000000001, -1.9000000000000012, -1.700000000000001, -2.0000000000000013, -1.8000000000000012, -2.0000000000000013, -1.8000000000000012, -1.600000000000001], "episode_lengths": [28, 36, 31, 29, 28, 26, 30, 27, 31, 27, 27, 25, 28, 27, 31, 28, 27, 27, 29, 27, 33, 26, 27, 26, 28, 28, 29, 30, 28, 27, 29, 26, 28, 29, 39, 27, 29, 36, 30, 35, 30, 29, 29, 28, 30, 25, 27, 32, 27, 29, 30, 30, 30, 28, 29, 32, 36, 31, 26, 26, 25, 26, 29, 28, 34, 26, 32, 27, 29, 27, 27, 29, 25, 25, 32, 56, 28, 28, 30, 25, 26, 28, 26, 34, 33, 26, 31, 35, 28, 28, 26, 26, 27, 26, 32, 34, 26, 26, 30, 26, 28, 32, 25, 27, 29, 27, 25, 32, 27, 33, 30, 30, 27, 29, 29, 37, 30, 27, 29, 28, 28, 29, 30, 29, 26, 31, 29, 28, 30, 28, 28, 30, 28, 31, 29, 31, 29, 27]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3505607197572982, "mean_inference_ms": 0.7273426822203455, "mean_action_processing_ms": 0.07653785733743539, "mean_env_wait_ms": 7.030948915225701, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006758821183356686, "StateBufferConnector_ms": 0.004050697105518286, "ViewRequirementAgentConnector_ms": 0.09119441543800244}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 156000, "num_agent_steps_trained": 156000, "num_env_steps_sampled": 156000, "num_env_steps_trained": 156000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 501.2801496990834, "num_env_steps_trained_throughput_per_sec": 501.2801496990834, "timesteps_total": 156000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 156000, "timers": {"training_iteration_time_ms": 8121.061, "sample_time_ms": 4654.083, "load_time_ms": 0.974, "load_throughput": 4106124.966, "learn_time_ms": 3462.588, "learn_throughput": 1155.205, "synch_weights_time_ms": 2.774}, "counters": {"num_env_steps_sampled": 156000, "num_env_steps_trained": 156000, "num_agent_steps_sampled": 156000, "num_agent_steps_trained": 156000}, "done": false, "episodes_total": 3173, "training_iteration": 39, "trial_id": "133f9_00000", "date": "2024-03-07_13-16-20", "timestamp": 1709835380, "time_this_iter_s": 7.982573509216309, "time_total_s": 302.3227701187134, "pid": 117779, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7efea6399f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 302.3227701187134, "iterations_since_restore": 39, "perf": {"cpu_util_percent": 32.6, "ram_util_percent": 50.7, "gpu_util_percent0": 0.075, "vram_util_percent0": 0.0940185546875}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 0.1171255204068955, "policy_loss": -0.006740941489816353, "vf_loss": 0.12220675623725338, "vf_explained_var": 0.9166946083627722, "kl": 0.008298531139150304, "entropy": 0.264776435262093, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 36735.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 160000, "num_env_steps_trained": 160000, "num_agent_steps_sampled": 160000, "num_agent_steps_trained": 160000}, "sampler_results": {"episode_reward_max": -1.4000000000000008, "episode_reward_min": -5.099999999999995, "episode_reward_mean": -1.8401459854014612, "episode_len_mean": 29.197080291970803, "episode_media": {}, "episodes_this_iter": 137, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1.8000000000000012, -3.700000000000003, -1.600000000000001, -1.600000000000001, -1.600000000000001, -2.4000000000000017, -1.700000000000001, -1.600000000000001, -1.700000000000001, -1.600000000000001, -1.8000000000000012, -1.5000000000000009, -2.0000000000000013, -1.700000000000001, -1.5000000000000009, -2.5000000000000018, -1.700000000000001, -1.700000000000001, -1.8000000000000012, -2.0000000000000013, -1.600000000000001, -1.8000000000000012, -1.700000000000001, -1.600000000000001, -1.600000000000001, -1.600000000000001, -2.1000000000000014, -3.1000000000000014, -1.9000000000000012, -1.4000000000000008, -1.8000000000000012, -1.600000000000001, -1.5000000000000009, -1.9000000000000012, -1.700000000000001, -1.600000000000001, -1.600000000000001, -1.5000000000000009, -1.8000000000000012, -1.8000000000000012, -1.5000000000000009, -1.700000000000001, -2.1000000000000014, -1.4000000000000008, -1.700000000000001, -1.4000000000000008, -1.600000000000001, -1.700000000000001, -1.700000000000001, -1.700000000000001, -1.700000000000001, -2.0000000000000013, -1.9000000000000012, -1.9000000000000012, -2.3000000000000016, -2.0000000000000013, -2.2000000000000015, -1.5000000000000009, -1.5000000000000009, -1.600000000000001, -1.9000000000000012, -1.9000000000000012, -2.0000000000000013, -2.0000000000000013, -1.5000000000000009, -1.8000000000000012, -1.700000000000001, -2.2000000000000015, -1.5000000000000009, -2.0000000000000013, -1.9000000000000012, -1.8000000000000012, -1.8000000000000012, -1.5000000000000009, -1.600000000000001, -1.600000000000001, -1.4000000000000008, -5.099999999999995, -1.9000000000000012, -1.700000000000001, -1.9000000000000012, -2.0000000000000013, -1.600000000000001, -1.5000000000000009, -1.8000000000000012, -1.9000000000000012, -2.800000000000002, -1.600000000000001, -1.600000000000001, -1.9000000000000012, -1.9000000000000012, -1.700000000000001, -2.3000000000000016, -1.700000000000001, -1.600000000000001, -1.8000000000000012, -1.700000000000001, -1.700000000000001, -1.5000000000000009, -1.700000000000001, -2.4000000000000017, -1.5000000000000009, -2.1000000000000014, -2.0000000000000013, -1.8000000000000012, -1.600000000000001, -1.5000000000000009, -2.1000000000000014, -1.700000000000001, -1.4000000000000008, -1.600000000000001, -1.700000000000001, -1.700000000000001, -1.8000000000000012, -1.600000000000001, -1.8000000000000012, -1.8000000000000012, -2.0000000000000013, -2.0000000000000013, -1.600000000000001, -2.5000000000000018, -1.600000000000001, -2.600000000000002, -1.700000000000001, -2.800000000000002, -1.700000000000001, -2.1000000000000014, -1.600000000000001, -2.1000000000000014, -2.0000000000000013, -1.9000000000000012, -2.5000000000000018, -1.5000000000000009, -1.700000000000001, -1.8000000000000012, -1.700000000000001, -1.8000000000000012], "episode_lengths": [29, 38, 27, 27, 27, 35, 28, 27, 28, 27, 29, 26, 31, 28, 26, 36, 28, 28, 29, 31, 27, 29, 28, 27, 27, 27, 32, 38, 30, 25, 29, 27, 26, 30, 28, 27, 27, 26, 29, 29, 26, 28, 32, 25, 28, 25, 27, 28, 28, 28, 28, 31, 30, 30, 34, 31, 33, 26, 26, 27, 30, 30, 31, 31, 26, 29, 28, 33, 26, 31, 30, 29, 29, 26, 27, 27, 25, 54, 30, 28, 30, 31, 27, 26, 29, 30, 35, 27, 27, 30, 30, 28, 34, 28, 27, 29, 28, 28, 26, 28, 35, 26, 32, 31, 29, 27, 26, 32, 28, 25, 27, 28, 28, 29, 27, 29, 29, 31, 31, 27, 34, 27, 37, 28, 39, 28, 32, 27, 32, 31, 30, 36, 26, 28, 29, 28, 29]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3529051453327272, "mean_inference_ms": 0.7274612890934534, "mean_action_processing_ms": 0.076539624679507, "mean_env_wait_ms": 7.045675936247624, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0069753967062400205, "StateBufferConnector_ms": 0.004091053983590899, "ViewRequirementAgentConnector_ms": 0.09166672281975294}}, "episode_reward_max": -1.4000000000000008, "episode_reward_min": -5.099999999999995, "episode_reward_mean": -1.8401459854014612, "episode_len_mean": 29.197080291970803, "episodes_this_iter": 137, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1.8000000000000012, -3.700000000000003, -1.600000000000001, -1.600000000000001, -1.600000000000001, -2.4000000000000017, -1.700000000000001, -1.600000000000001, -1.700000000000001, -1.600000000000001, -1.8000000000000012, -1.5000000000000009, -2.0000000000000013, -1.700000000000001, -1.5000000000000009, -2.5000000000000018, -1.700000000000001, -1.700000000000001, -1.8000000000000012, -2.0000000000000013, -1.600000000000001, -1.8000000000000012, -1.700000000000001, -1.600000000000001, -1.600000000000001, -1.600000000000001, -2.1000000000000014, -3.1000000000000014, -1.9000000000000012, -1.4000000000000008, -1.8000000000000012, -1.600000000000001, -1.5000000000000009, -1.9000000000000012, -1.700000000000001, -1.600000000000001, -1.600000000000001, -1.5000000000000009, -1.8000000000000012, -1.8000000000000012, -1.5000000000000009, -1.700000000000001, -2.1000000000000014, -1.4000000000000008, -1.700000000000001, -1.4000000000000008, -1.600000000000001, -1.700000000000001, -1.700000000000001, -1.700000000000001, -1.700000000000001, -2.0000000000000013, -1.9000000000000012, -1.9000000000000012, -2.3000000000000016, -2.0000000000000013, -2.2000000000000015, -1.5000000000000009, -1.5000000000000009, -1.600000000000001, -1.9000000000000012, -1.9000000000000012, -2.0000000000000013, -2.0000000000000013, -1.5000000000000009, -1.8000000000000012, -1.700000000000001, -2.2000000000000015, -1.5000000000000009, -2.0000000000000013, -1.9000000000000012, -1.8000000000000012, -1.8000000000000012, -1.5000000000000009, -1.600000000000001, -1.600000000000001, -1.4000000000000008, -5.099999999999995, -1.9000000000000012, -1.700000000000001, -1.9000000000000012, -2.0000000000000013, -1.600000000000001, -1.5000000000000009, -1.8000000000000012, -1.9000000000000012, -2.800000000000002, -1.600000000000001, -1.600000000000001, -1.9000000000000012, -1.9000000000000012, -1.700000000000001, -2.3000000000000016, -1.700000000000001, -1.600000000000001, -1.8000000000000012, -1.700000000000001, -1.700000000000001, -1.5000000000000009, -1.700000000000001, -2.4000000000000017, -1.5000000000000009, -2.1000000000000014, -2.0000000000000013, -1.8000000000000012, -1.600000000000001, -1.5000000000000009, -2.1000000000000014, -1.700000000000001, -1.4000000000000008, -1.600000000000001, -1.700000000000001, -1.700000000000001, -1.8000000000000012, -1.600000000000001, -1.8000000000000012, -1.8000000000000012, -2.0000000000000013, -2.0000000000000013, -1.600000000000001, -2.5000000000000018, -1.600000000000001, -2.600000000000002, -1.700000000000001, -2.800000000000002, -1.700000000000001, -2.1000000000000014, -1.600000000000001, -2.1000000000000014, -2.0000000000000013, -1.9000000000000012, -2.5000000000000018, -1.5000000000000009, -1.700000000000001, -1.8000000000000012, -1.700000000000001, -1.8000000000000012], "episode_lengths": [29, 38, 27, 27, 27, 35, 28, 27, 28, 27, 29, 26, 31, 28, 26, 36, 28, 28, 29, 31, 27, 29, 28, 27, 27, 27, 32, 38, 30, 25, 29, 27, 26, 30, 28, 27, 27, 26, 29, 29, 26, 28, 32, 25, 28, 25, 27, 28, 28, 28, 28, 31, 30, 30, 34, 31, 33, 26, 26, 27, 30, 30, 31, 31, 26, 29, 28, 33, 26, 31, 30, 29, 29, 26, 27, 27, 25, 54, 30, 28, 30, 31, 27, 26, 29, 30, 35, 27, 27, 30, 30, 28, 34, 28, 27, 29, 28, 28, 26, 28, 35, 26, 32, 31, 29, 27, 26, 32, 28, 25, 27, 28, 28, 29, 27, 29, 29, 31, 31, 27, 34, 27, 37, 28, 39, 28, 32, 27, 32, 31, 30, 36, 26, 28, 29, 28, 29]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3529051453327272, "mean_inference_ms": 0.7274612890934534, "mean_action_processing_ms": 0.076539624679507, "mean_env_wait_ms": 7.045675936247624, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0069753967062400205, "StateBufferConnector_ms": 0.004091053983590899, "ViewRequirementAgentConnector_ms": 0.09166672281975294}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 160000, "num_agent_steps_trained": 160000, "num_env_steps_sampled": 160000, "num_env_steps_trained": 160000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 488.9467601042183, "num_env_steps_trained_throughput_per_sec": 488.9467601042183, "timesteps_total": 160000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 160000, "timers": {"training_iteration_time_ms": 8135.791, "sample_time_ms": 4652.274, "load_time_ms": 0.978, "load_throughput": 4091305.387, "learn_time_ms": 3478.917, "learn_throughput": 1149.783, "synch_weights_time_ms": 2.952}, "counters": {"num_env_steps_sampled": 160000, "num_env_steps_trained": 160000, "num_agent_steps_sampled": 160000, "num_agent_steps_trained": 160000}, "done": false, "episodes_total": 3310, "training_iteration": 40, "trial_id": "133f9_00000", "date": "2024-03-07_13-16-28", "timestamp": 1709835388, "time_this_iter_s": 8.18437647819519, "time_total_s": 310.50714659690857, "pid": 117779, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7efea6399f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 310.50714659690857, "iterations_since_restore": 40, "perf": {"cpu_util_percent": 30.8090909090909, "ram_util_percent": 50.70909090909092, "gpu_util_percent0": 0.06727272727272728, "vram_util_percent0": 0.09400893702651514}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 0.3210376808434845, "policy_loss": -0.006792862138520646, "vf_loss": 0.3256125024089249, "vf_explained_var": 0.8537632733903905, "kl": 0.011090210036020459, "entropy": 0.2670745680088638, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 37665.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 164000, "num_env_steps_trained": 164000, "num_agent_steps_sampled": 164000, "num_agent_steps_trained": 164000}, "sampler_results": {"episode_reward_max": -1.4000000000000008, "episode_reward_min": -11.19999999999999, "episode_reward_mean": -1.910370370370371, "episode_len_mean": 29.48148148148148, "episode_media": {}, "episodes_this_iter": 135, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1.5000000000000009, -1.5000000000000009, -1.8000000000000012, -1.4000000000000008, -1.700000000000001, -2.3000000000000016, -1.700000000000001, -1.700000000000001, -1.4000000000000008, -1.9000000000000012, -1.5000000000000009, -1.5000000000000009, -1.5000000000000009, -1.8000000000000012, -1.9000000000000012, -1.4000000000000008, -1.600000000000001, -1.700000000000001, -1.9000000000000012, -1.700000000000001, -1.700000000000001, -1.600000000000001, -1.700000000000001, -1.9000000000000012, -1.8000000000000012, -1.600000000000001, -1.600000000000001, -1.5000000000000009, -2.0000000000000013, -2.0000000000000013, -2.0000000000000013, -1.8000000000000012, -1.700000000000001, -1.600000000000001, -1.600000000000001, -1.700000000000001, -1.9000000000000012, -1.8000000000000012, -1.5000000000000009, -1.5000000000000009, -1.600000000000001, -1.8000000000000012, -1.5000000000000009, -2.2000000000000015, -2.0000000000000013, -1.8000000000000012, -1.600000000000001, -11.19999999999999, -1.9000000000000012, -1.9000000000000012, -1.5000000000000009, -1.700000000000001, -1.600000000000001, -1.700000000000001, -1.600000000000001, -1.9000000000000012, -2.0000000000000013, -1.600000000000001, -1.8000000000000012, -1.600000000000001, -4.799999999999997, -1.600000000000001, -1.700000000000001, -1.600000000000001, -1.600000000000001, -1.8000000000000012, -2.4000000000000017, -2.0000000000000013, -1.8000000000000012, -1.4000000000000008, -1.700000000000001, -2.0000000000000013, -1.600000000000001, -1.4000000000000008, -1.4000000000000008, -1.600000000000001, -1.8000000000000012, -1.700000000000001, -1.9000000000000012, -1.9000000000000012, -2.700000000000002, -1.9000000000000012, -7.799999999999988, -1.5000000000000009, -1.700000000000001, -1.9000000000000012, -1.8000000000000012, -1.8000000000000012, -1.5000000000000009, -2.1000000000000014, -2.1000000000000014, -1.5000000000000009, -1.600000000000001, -2.3000000000000016, -2.0000000000000013, -1.8000000000000012, -1.5000000000000009, -2.1000000000000014, -1.5000000000000009, -1.8000000000000012, -1.8000000000000012, -2.3000000000000016, -1.8000000000000012, -1.5000000000000009, -4.000000000000003, -1.5000000000000009, -1.8000000000000012, -2.0000000000000013, -1.8000000000000012, -1.5000000000000009, -1.600000000000001, -1.600000000000001, -2.1000000000000014, -1.4000000000000008, -1.9000000000000012, -1.600000000000001, -2.0000000000000013, -1.600000000000001, -1.700000000000001, -1.600000000000001, -1.600000000000001, -1.9000000000000012, -1.5000000000000009, -3.400000000000002, -1.9000000000000012, -1.700000000000001, -1.700000000000001, -2.0000000000000013, -1.8000000000000012, -1.8000000000000012, -1.4000000000000008, -1.9000000000000012, -1.700000000000001, -1.5000000000000009, -2.0000000000000013], "episode_lengths": [26, 26, 29, 25, 28, 34, 28, 28, 25, 30, 26, 26, 26, 29, 30, 25, 27, 28, 30, 28, 28, 27, 28, 30, 29, 27, 27, 26, 31, 31, 31, 29, 28, 27, 27, 28, 30, 29, 26, 26, 27, 29, 26, 33, 31, 29, 27, 78, 30, 30, 26, 28, 27, 28, 27, 30, 31, 27, 29, 27, 51, 27, 28, 27, 27, 29, 34, 31, 29, 25, 28, 31, 27, 25, 25, 27, 29, 28, 30, 30, 36, 30, 80, 26, 28, 30, 29, 29, 26, 32, 32, 26, 27, 34, 31, 29, 26, 32, 26, 29, 29, 34, 29, 26, 39, 26, 29, 31, 29, 26, 27, 27, 32, 25, 30, 27, 31, 27, 28, 27, 27, 30, 26, 38, 30, 28, 28, 31, 29, 29, 25, 30, 28, 26, 31]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3550136219210436, "mean_inference_ms": 0.7275309294245925, "mean_action_processing_ms": 0.07655604263350127, "mean_env_wait_ms": 7.0648382901299, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006730821397569444, "StateBufferConnector_ms": 0.0040829623187029805, "ViewRequirementAgentConnector_ms": 0.09128270325837312}}, "episode_reward_max": -1.4000000000000008, "episode_reward_min": -11.19999999999999, "episode_reward_mean": -1.910370370370371, "episode_len_mean": 29.48148148148148, "episodes_this_iter": 135, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1.5000000000000009, -1.5000000000000009, -1.8000000000000012, -1.4000000000000008, -1.700000000000001, -2.3000000000000016, -1.700000000000001, -1.700000000000001, -1.4000000000000008, -1.9000000000000012, -1.5000000000000009, -1.5000000000000009, -1.5000000000000009, -1.8000000000000012, -1.9000000000000012, -1.4000000000000008, -1.600000000000001, -1.700000000000001, -1.9000000000000012, -1.700000000000001, -1.700000000000001, -1.600000000000001, -1.700000000000001, -1.9000000000000012, -1.8000000000000012, -1.600000000000001, -1.600000000000001, -1.5000000000000009, -2.0000000000000013, -2.0000000000000013, -2.0000000000000013, -1.8000000000000012, -1.700000000000001, -1.600000000000001, -1.600000000000001, -1.700000000000001, -1.9000000000000012, -1.8000000000000012, -1.5000000000000009, -1.5000000000000009, -1.600000000000001, -1.8000000000000012, -1.5000000000000009, -2.2000000000000015, -2.0000000000000013, -1.8000000000000012, -1.600000000000001, -11.19999999999999, -1.9000000000000012, -1.9000000000000012, -1.5000000000000009, -1.700000000000001, -1.600000000000001, -1.700000000000001, -1.600000000000001, -1.9000000000000012, -2.0000000000000013, -1.600000000000001, -1.8000000000000012, -1.600000000000001, -4.799999999999997, -1.600000000000001, -1.700000000000001, -1.600000000000001, -1.600000000000001, -1.8000000000000012, -2.4000000000000017, -2.0000000000000013, -1.8000000000000012, -1.4000000000000008, -1.700000000000001, -2.0000000000000013, -1.600000000000001, -1.4000000000000008, -1.4000000000000008, -1.600000000000001, -1.8000000000000012, -1.700000000000001, -1.9000000000000012, -1.9000000000000012, -2.700000000000002, -1.9000000000000012, -7.799999999999988, -1.5000000000000009, -1.700000000000001, -1.9000000000000012, -1.8000000000000012, -1.8000000000000012, -1.5000000000000009, -2.1000000000000014, -2.1000000000000014, -1.5000000000000009, -1.600000000000001, -2.3000000000000016, -2.0000000000000013, -1.8000000000000012, -1.5000000000000009, -2.1000000000000014, -1.5000000000000009, -1.8000000000000012, -1.8000000000000012, -2.3000000000000016, -1.8000000000000012, -1.5000000000000009, -4.000000000000003, -1.5000000000000009, -1.8000000000000012, -2.0000000000000013, -1.8000000000000012, -1.5000000000000009, -1.600000000000001, -1.600000000000001, -2.1000000000000014, -1.4000000000000008, -1.9000000000000012, -1.600000000000001, -2.0000000000000013, -1.600000000000001, -1.700000000000001, -1.600000000000001, -1.600000000000001, -1.9000000000000012, -1.5000000000000009, -3.400000000000002, -1.9000000000000012, -1.700000000000001, -1.700000000000001, -2.0000000000000013, -1.8000000000000012, -1.8000000000000012, -1.4000000000000008, -1.9000000000000012, -1.700000000000001, -1.5000000000000009, -2.0000000000000013], "episode_lengths": [26, 26, 29, 25, 28, 34, 28, 28, 25, 30, 26, 26, 26, 29, 30, 25, 27, 28, 30, 28, 28, 27, 28, 30, 29, 27, 27, 26, 31, 31, 31, 29, 28, 27, 27, 28, 30, 29, 26, 26, 27, 29, 26, 33, 31, 29, 27, 78, 30, 30, 26, 28, 27, 28, 27, 30, 31, 27, 29, 27, 51, 27, 28, 27, 27, 29, 34, 31, 29, 25, 28, 31, 27, 25, 25, 27, 29, 28, 30, 30, 36, 30, 80, 26, 28, 30, 29, 29, 26, 32, 32, 26, 27, 34, 31, 29, 26, 32, 26, 29, 29, 34, 29, 26, 39, 26, 29, 31, 29, 26, 27, 27, 32, 25, 30, 27, 31, 27, 28, 27, 27, 30, 26, 38, 30, 28, 28, 31, 29, 29, 25, 30, 28, 26, 31]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3550136219210436, "mean_inference_ms": 0.7275309294245925, "mean_action_processing_ms": 0.07655604263350127, "mean_env_wait_ms": 7.0648382901299, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006730821397569444, "StateBufferConnector_ms": 0.0040829623187029805, "ViewRequirementAgentConnector_ms": 0.09128270325837312}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 164000, "num_agent_steps_trained": 164000, "num_env_steps_sampled": 164000, "num_env_steps_trained": 164000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 497.2354102689097, "num_env_steps_trained_throughput_per_sec": 497.2354102689097, "timesteps_total": 164000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 164000, "timers": {"training_iteration_time_ms": 8138.851, "sample_time_ms": 4655.883, "load_time_ms": 0.977, "load_throughput": 4096200.01, "learn_time_ms": 3478.367, "learn_throughput": 1149.965, "synch_weights_time_ms": 2.949}, "counters": {"num_env_steps_sampled": 164000, "num_env_steps_trained": 164000, "num_agent_steps_sampled": 164000, "num_agent_steps_trained": 164000}, "done": false, "episodes_total": 3445, "training_iteration": 41, "trial_id": "133f9_00000", "date": "2024-03-07_13-16-36", "timestamp": 1709835396, "time_this_iter_s": 8.047606468200684, "time_total_s": 318.55475306510925, "pid": 117779, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7efea6399f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 318.55475306510925, "iterations_since_restore": 41, "perf": {"cpu_util_percent": 32.760000000000005, "ram_util_percent": 50.739999999999995, "gpu_util_percent0": 0.07, "vram_util_percent0": 0.09401041666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 0.0633966687920263, "policy_loss": -0.005878968742145325, "vf_loss": 0.06766756016120154, "vf_explained_var": 0.9454484890225113, "kl": 0.008040389610434092, "entropy": 0.21810578508402712, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 38595.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 168000, "num_env_steps_trained": 168000, "num_agent_steps_sampled": 168000, "num_agent_steps_trained": 168000}, "sampler_results": {"episode_reward_max": -1.4000000000000008, "episode_reward_min": -4.799999999999995, "episode_reward_mean": -1.7595744680851075, "episode_len_mean": 28.5531914893617, "episode_media": {}, "episodes_this_iter": 141, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2.0000000000000013, -1.9000000000000012, -1.700000000000001, -1.9000000000000012, -1.9000000000000012, -1.600000000000001, -1.8000000000000012, -1.700000000000001, -2.1000000000000014, -1.600000000000001, -1.700000000000001, -1.8000000000000012, -1.700000000000001, -1.5000000000000009, -1.700000000000001, -1.600000000000001, -1.600000000000001, -2.0000000000000013, -1.9000000000000012, -1.8000000000000012, -1.5000000000000009, -1.8000000000000012, -1.8000000000000012, -1.4000000000000008, -1.600000000000001, -1.5000000000000009, -1.600000000000001, -1.700000000000001, -1.700000000000001, -1.9000000000000012, -1.5000000000000009, -2.0000000000000013, -2.0000000000000013, -2.1000000000000014, -1.600000000000001, -1.8000000000000012, -1.8000000000000012, -1.4000000000000008, -1.5000000000000009, -1.9000000000000012, -1.5000000000000009, -4.799999999999995, -1.8000000000000012, -1.700000000000001, -1.8000000000000012, -1.600000000000001, -1.8000000000000012, -2.0000000000000013, -1.700000000000001, -1.5000000000000009, -1.700000000000001, -1.700000000000001, -1.700000000000001, -2.1000000000000014, -1.600000000000001, -1.700000000000001, -1.700000000000001, -1.700000000000001, -1.700000000000001, -1.700000000000001, -1.8000000000000012, -1.9000000000000012, -1.9000000000000012, -1.600000000000001, -2.0000000000000013, -2.1000000000000014, -1.5000000000000009, -1.700000000000001, -1.600000000000001, -1.8000000000000012, -1.600000000000001, -1.8000000000000012, -2.1000000000000014, -1.4000000000000008, -2.0000000000000013, -1.600000000000001, -1.4000000000000008, -2.0000000000000013, -1.8000000000000012, -1.8000000000000012, -1.700000000000001, -2.0000000000000013, -1.8000000000000012, -1.700000000000001, -1.700000000000001, -1.700000000000001, -1.700000000000001, -1.9000000000000012, -1.5000000000000009, -1.600000000000001, -2.1000000000000014, -1.700000000000001, -1.600000000000001, -2.0000000000000013, -1.600000000000001, -2.2000000000000015, -1.4000000000000008, -1.600000000000001, -1.8000000000000012, -2.1000000000000014, -1.600000000000001, -1.700000000000001, -1.700000000000001, -1.5000000000000009, -1.5000000000000009, -1.700000000000001, -1.600000000000001, -1.700000000000001, -1.700000000000001, -1.600000000000001, -1.4000000000000008, -2.2000000000000015, -1.9000000000000012, -1.700000000000001, -1.5000000000000009, -1.8000000000000012, -1.600000000000001, -1.5000000000000009, -1.9000000000000012, -1.9000000000000012, -1.8000000000000012, -1.700000000000001, -1.8000000000000012, -1.600000000000001, -1.600000000000001, -1.600000000000001, -1.700000000000001, -1.600000000000001, -1.5000000000000009, -1.9000000000000012, -1.600000000000001, -1.600000000000001, -2.2000000000000015, -2.4000000000000017, -2.2000000000000015, -1.700000000000001, -1.700000000000001, -1.8000000000000012, -1.4000000000000008, -1.4000000000000008, -1.700000000000001], "episode_lengths": [31, 30, 28, 30, 30, 27, 29, 28, 32, 27, 28, 29, 28, 26, 28, 27, 27, 31, 30, 29, 26, 29, 29, 25, 27, 26, 27, 28, 28, 30, 26, 31, 31, 32, 27, 29, 29, 25, 26, 30, 26, 54, 29, 28, 29, 27, 29, 31, 28, 26, 28, 28, 28, 32, 27, 28, 28, 28, 28, 28, 29, 30, 30, 27, 31, 32, 26, 28, 27, 29, 27, 29, 32, 25, 31, 27, 25, 31, 29, 29, 28, 31, 29, 28, 28, 28, 28, 30, 26, 27, 32, 28, 27, 31, 27, 33, 25, 27, 29, 32, 27, 28, 28, 26, 26, 28, 27, 28, 28, 27, 25, 33, 30, 28, 26, 29, 27, 26, 30, 30, 29, 28, 29, 27, 27, 27, 28, 27, 26, 30, 27, 27, 33, 35, 33, 28, 28, 28, 25, 25, 28]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3572832818844184, "mean_inference_ms": 0.7276263766047772, "mean_action_processing_ms": 0.07655743827702967, "mean_env_wait_ms": 7.08058778433565, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006798649510593279, "StateBufferConnector_ms": 0.004117201406059536, "ViewRequirementAgentConnector_ms": 0.09146142513193983}}, "episode_reward_max": -1.4000000000000008, "episode_reward_min": -4.799999999999995, "episode_reward_mean": -1.7595744680851075, "episode_len_mean": 28.5531914893617, "episodes_this_iter": 141, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-2.0000000000000013, -1.9000000000000012, -1.700000000000001, -1.9000000000000012, -1.9000000000000012, -1.600000000000001, -1.8000000000000012, -1.700000000000001, -2.1000000000000014, -1.600000000000001, -1.700000000000001, -1.8000000000000012, -1.700000000000001, -1.5000000000000009, -1.700000000000001, -1.600000000000001, -1.600000000000001, -2.0000000000000013, -1.9000000000000012, -1.8000000000000012, -1.5000000000000009, -1.8000000000000012, -1.8000000000000012, -1.4000000000000008, -1.600000000000001, -1.5000000000000009, -1.600000000000001, -1.700000000000001, -1.700000000000001, -1.9000000000000012, -1.5000000000000009, -2.0000000000000013, -2.0000000000000013, -2.1000000000000014, -1.600000000000001, -1.8000000000000012, -1.8000000000000012, -1.4000000000000008, -1.5000000000000009, -1.9000000000000012, -1.5000000000000009, -4.799999999999995, -1.8000000000000012, -1.700000000000001, -1.8000000000000012, -1.600000000000001, -1.8000000000000012, -2.0000000000000013, -1.700000000000001, -1.5000000000000009, -1.700000000000001, -1.700000000000001, -1.700000000000001, -2.1000000000000014, -1.600000000000001, -1.700000000000001, -1.700000000000001, -1.700000000000001, -1.700000000000001, -1.700000000000001, -1.8000000000000012, -1.9000000000000012, -1.9000000000000012, -1.600000000000001, -2.0000000000000013, -2.1000000000000014, -1.5000000000000009, -1.700000000000001, -1.600000000000001, -1.8000000000000012, -1.600000000000001, -1.8000000000000012, -2.1000000000000014, -1.4000000000000008, -2.0000000000000013, -1.600000000000001, -1.4000000000000008, -2.0000000000000013, -1.8000000000000012, -1.8000000000000012, -1.700000000000001, -2.0000000000000013, -1.8000000000000012, -1.700000000000001, -1.700000000000001, -1.700000000000001, -1.700000000000001, -1.9000000000000012, -1.5000000000000009, -1.600000000000001, -2.1000000000000014, -1.700000000000001, -1.600000000000001, -2.0000000000000013, -1.600000000000001, -2.2000000000000015, -1.4000000000000008, -1.600000000000001, -1.8000000000000012, -2.1000000000000014, -1.600000000000001, -1.700000000000001, -1.700000000000001, -1.5000000000000009, -1.5000000000000009, -1.700000000000001, -1.600000000000001, -1.700000000000001, -1.700000000000001, -1.600000000000001, -1.4000000000000008, -2.2000000000000015, -1.9000000000000012, -1.700000000000001, -1.5000000000000009, -1.8000000000000012, -1.600000000000001, -1.5000000000000009, -1.9000000000000012, -1.9000000000000012, -1.8000000000000012, -1.700000000000001, -1.8000000000000012, -1.600000000000001, -1.600000000000001, -1.600000000000001, -1.700000000000001, -1.600000000000001, -1.5000000000000009, -1.9000000000000012, -1.600000000000001, -1.600000000000001, -2.2000000000000015, -2.4000000000000017, -2.2000000000000015, -1.700000000000001, -1.700000000000001, -1.8000000000000012, -1.4000000000000008, -1.4000000000000008, -1.700000000000001], "episode_lengths": [31, 30, 28, 30, 30, 27, 29, 28, 32, 27, 28, 29, 28, 26, 28, 27, 27, 31, 30, 29, 26, 29, 29, 25, 27, 26, 27, 28, 28, 30, 26, 31, 31, 32, 27, 29, 29, 25, 26, 30, 26, 54, 29, 28, 29, 27, 29, 31, 28, 26, 28, 28, 28, 32, 27, 28, 28, 28, 28, 28, 29, 30, 30, 27, 31, 32, 26, 28, 27, 29, 27, 29, 32, 25, 31, 27, 25, 31, 29, 29, 28, 31, 29, 28, 28, 28, 28, 30, 26, 27, 32, 28, 27, 31, 27, 33, 25, 27, 29, 32, 27, 28, 28, 26, 26, 28, 27, 28, 28, 27, 25, 33, 30, 28, 26, 29, 27, 26, 30, 30, 29, 28, 29, 27, 27, 27, 28, 27, 26, 30, 27, 27, 33, 35, 33, 28, 28, 28, 25, 25, 28]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3572832818844184, "mean_inference_ms": 0.7276263766047772, "mean_action_processing_ms": 0.07655743827702967, "mean_env_wait_ms": 7.08058778433565, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006798649510593279, "StateBufferConnector_ms": 0.004117201406059536, "ViewRequirementAgentConnector_ms": 0.09146142513193983}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 168000, "num_agent_steps_trained": 168000, "num_env_steps_sampled": 168000, "num_env_steps_trained": 168000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 486.90047939794954, "num_env_steps_trained_throughput_per_sec": 486.90047939794954, "timesteps_total": 168000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 168000, "timers": {"training_iteration_time_ms": 8153.213, "sample_time_ms": 4673.5, "load_time_ms": 0.978, "load_throughput": 4091405.16, "learn_time_ms": 3475.069, "learn_throughput": 1151.056, "synch_weights_time_ms": 2.993}, "counters": {"num_env_steps_sampled": 168000, "num_env_steps_trained": 168000, "num_agent_steps_sampled": 168000, "num_agent_steps_trained": 168000}, "done": false, "episodes_total": 3586, "training_iteration": 42, "trial_id": "133f9_00000", "date": "2024-03-07_13-16-44", "timestamp": 1709835404, "time_this_iter_s": 8.218231439590454, "time_total_s": 326.7729845046997, "pid": 117779, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7efea6399f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 326.7729845046997, "iterations_since_restore": 42, "perf": {"cpu_util_percent": 31.69090909090909, "ram_util_percent": 50.78181818181818, "gpu_util_percent0": 0.08272727272727272, "vram_util_percent0": 0.09400893702651515}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 0.04400082869750638, "policy_loss": -0.0030691611580550672, "vf_loss": 0.04489126172021873, "vf_explained_var": 0.964380003688156, "kl": 0.01089363078442237, "entropy": 0.225593061665053, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 39525.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 172000, "num_env_steps_trained": 172000, "num_agent_steps_sampled": 172000, "num_agent_steps_trained": 172000}, "sampler_results": {"episode_reward_max": -1.4000000000000008, "episode_reward_min": -3.999999999999999, "episode_reward_mean": -1.7397163120567385, "episode_len_mean": 28.31205673758865, "episode_media": {}, "episodes_this_iter": 141, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1.8000000000000012, -1.600000000000001, -1.5000000000000009, -1.600000000000001, -1.8000000000000012, -2.1000000000000014, -2.2000000000000015, -2.800000000000002, -1.4000000000000008, -1.5000000000000009, -1.8000000000000012, -1.8000000000000012, -1.700000000000001, -2.2000000000000015, -1.8000000000000012, -1.8000000000000012, -1.5000000000000009, -1.600000000000001, -1.700000000000001, -2.0000000000000013, -1.4000000000000008, -1.9000000000000012, -2.0000000000000013, -1.4000000000000008, -2.1000000000000014, -1.4000000000000008, -1.8000000000000012, -1.5000000000000009, -1.600000000000001, -1.600000000000001, -1.600000000000001, -1.5000000000000009, -1.5000000000000009, -1.600000000000001, -1.9000000000000012, -2.3000000000000016, -1.700000000000001, -2.1000000000000014, -1.600000000000001, -1.5000000000000009, -2.2000000000000015, -1.8000000000000012, -1.700000000000001, -2.0000000000000013, -1.600000000000001, -1.4000000000000008, -1.5000000000000009, -1.8000000000000012, -2.2000000000000015, -1.5000000000000009, -1.8000000000000012, -1.5000000000000009, -1.600000000000001, -2.0000000000000013, -1.700000000000001, -1.8000000000000012, -1.8000000000000012, -1.600000000000001, -1.700000000000001, -1.9000000000000012, -1.4000000000000008, -1.4000000000000008, -2.4000000000000017, -1.9000000000000012, -1.5000000000000009, -1.5000000000000009, -1.9000000000000012, -1.5000000000000009, -1.8000000000000012, -1.5000000000000009, -1.600000000000001, -1.5000000000000009, -1.5000000000000009, -1.8000000000000012, -1.700000000000001, -1.5000000000000009, -1.700000000000001, -1.4000000000000008, -2.0000000000000013, -1.9000000000000012, -1.600000000000001, -1.600000000000001, -1.700000000000001, -1.4000000000000008, -1.700000000000001, -1.700000000000001, -2.0000000000000013, -1.8000000000000012, -1.600000000000001, -1.8000000000000012, -1.600000000000001, -2.0000000000000013, -1.600000000000001, -1.700000000000001, -1.5000000000000009, -1.600000000000001, -2.0000000000000013, -1.4000000000000008, -1.700000000000001, -1.4000000000000008, -1.600000000000001, -1.8000000000000012, -1.5000000000000009, -1.600000000000001, -1.700000000000001, -1.5000000000000009, -1.700000000000001, -1.700000000000001, -1.700000000000001, -1.5000000000000009, -1.5000000000000009, -1.8000000000000012, -1.9000000000000012, -1.700000000000001, -1.8000000000000012, -1.9000000000000012, -1.5000000000000009, -1.600000000000001, -1.9000000000000012, -1.5000000000000009, -1.8000000000000012, -3.999999999999999, -1.700000000000001, -2.4000000000000017, -1.600000000000001, -1.700000000000001, -1.700000000000001, -1.600000000000001, -1.700000000000001, -1.700000000000001, -1.700000000000001, -1.8000000000000012, -1.700000000000001, -1.9000000000000012, -1.9000000000000012, -1.700000000000001, -1.8000000000000012, -1.700000000000001, -1.700000000000001, -2.2000000000000015, -1.8000000000000012], "episode_lengths": [29, 27, 26, 27, 29, 32, 33, 35, 25, 26, 29, 29, 28, 33, 29, 29, 26, 27, 28, 31, 25, 30, 31, 25, 32, 25, 29, 26, 27, 27, 27, 26, 26, 27, 30, 34, 28, 32, 27, 26, 33, 29, 28, 31, 27, 25, 26, 29, 33, 26, 29, 26, 27, 31, 28, 29, 29, 27, 28, 30, 25, 25, 33, 30, 26, 26, 30, 26, 29, 26, 27, 26, 26, 29, 28, 26, 28, 25, 31, 30, 27, 27, 28, 25, 28, 28, 31, 29, 27, 29, 27, 31, 27, 28, 26, 27, 31, 25, 28, 25, 27, 29, 26, 27, 28, 26, 28, 28, 28, 26, 26, 29, 30, 28, 29, 30, 26, 27, 30, 26, 29, 45, 28, 35, 27, 28, 28, 27, 28, 28, 28, 29, 28, 30, 30, 28, 29, 28, 28, 33, 29]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.359844353667955, "mean_inference_ms": 0.7282283640001628, "mean_action_processing_ms": 0.07660514317494423, "mean_env_wait_ms": 7.103376412337862, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0070538081175892066, "StateBufferConnector_ms": 0.004207665193165447, "ViewRequirementAgentConnector_ms": 0.09443387917593016}}, "episode_reward_max": -1.4000000000000008, "episode_reward_min": -3.999999999999999, "episode_reward_mean": -1.7397163120567385, "episode_len_mean": 28.31205673758865, "episodes_this_iter": 141, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1.8000000000000012, -1.600000000000001, -1.5000000000000009, -1.600000000000001, -1.8000000000000012, -2.1000000000000014, -2.2000000000000015, -2.800000000000002, -1.4000000000000008, -1.5000000000000009, -1.8000000000000012, -1.8000000000000012, -1.700000000000001, -2.2000000000000015, -1.8000000000000012, -1.8000000000000012, -1.5000000000000009, -1.600000000000001, -1.700000000000001, -2.0000000000000013, -1.4000000000000008, -1.9000000000000012, -2.0000000000000013, -1.4000000000000008, -2.1000000000000014, -1.4000000000000008, -1.8000000000000012, -1.5000000000000009, -1.600000000000001, -1.600000000000001, -1.600000000000001, -1.5000000000000009, -1.5000000000000009, -1.600000000000001, -1.9000000000000012, -2.3000000000000016, -1.700000000000001, -2.1000000000000014, -1.600000000000001, -1.5000000000000009, -2.2000000000000015, -1.8000000000000012, -1.700000000000001, -2.0000000000000013, -1.600000000000001, -1.4000000000000008, -1.5000000000000009, -1.8000000000000012, -2.2000000000000015, -1.5000000000000009, -1.8000000000000012, -1.5000000000000009, -1.600000000000001, -2.0000000000000013, -1.700000000000001, -1.8000000000000012, -1.8000000000000012, -1.600000000000001, -1.700000000000001, -1.9000000000000012, -1.4000000000000008, -1.4000000000000008, -2.4000000000000017, -1.9000000000000012, -1.5000000000000009, -1.5000000000000009, -1.9000000000000012, -1.5000000000000009, -1.8000000000000012, -1.5000000000000009, -1.600000000000001, -1.5000000000000009, -1.5000000000000009, -1.8000000000000012, -1.700000000000001, -1.5000000000000009, -1.700000000000001, -1.4000000000000008, -2.0000000000000013, -1.9000000000000012, -1.600000000000001, -1.600000000000001, -1.700000000000001, -1.4000000000000008, -1.700000000000001, -1.700000000000001, -2.0000000000000013, -1.8000000000000012, -1.600000000000001, -1.8000000000000012, -1.600000000000001, -2.0000000000000013, -1.600000000000001, -1.700000000000001, -1.5000000000000009, -1.600000000000001, -2.0000000000000013, -1.4000000000000008, -1.700000000000001, -1.4000000000000008, -1.600000000000001, -1.8000000000000012, -1.5000000000000009, -1.600000000000001, -1.700000000000001, -1.5000000000000009, -1.700000000000001, -1.700000000000001, -1.700000000000001, -1.5000000000000009, -1.5000000000000009, -1.8000000000000012, -1.9000000000000012, -1.700000000000001, -1.8000000000000012, -1.9000000000000012, -1.5000000000000009, -1.600000000000001, -1.9000000000000012, -1.5000000000000009, -1.8000000000000012, -3.999999999999999, -1.700000000000001, -2.4000000000000017, -1.600000000000001, -1.700000000000001, -1.700000000000001, -1.600000000000001, -1.700000000000001, -1.700000000000001, -1.700000000000001, -1.8000000000000012, -1.700000000000001, -1.9000000000000012, -1.9000000000000012, -1.700000000000001, -1.8000000000000012, -1.700000000000001, -1.700000000000001, -2.2000000000000015, -1.8000000000000012], "episode_lengths": [29, 27, 26, 27, 29, 32, 33, 35, 25, 26, 29, 29, 28, 33, 29, 29, 26, 27, 28, 31, 25, 30, 31, 25, 32, 25, 29, 26, 27, 27, 27, 26, 26, 27, 30, 34, 28, 32, 27, 26, 33, 29, 28, 31, 27, 25, 26, 29, 33, 26, 29, 26, 27, 31, 28, 29, 29, 27, 28, 30, 25, 25, 33, 30, 26, 26, 30, 26, 29, 26, 27, 26, 26, 29, 28, 26, 28, 25, 31, 30, 27, 27, 28, 25, 28, 28, 31, 29, 27, 29, 27, 31, 27, 28, 26, 27, 31, 25, 28, 25, 27, 29, 26, 27, 28, 26, 28, 28, 28, 26, 26, 29, 30, 28, 29, 30, 26, 27, 30, 26, 29, 45, 28, 35, 27, 28, 28, 27, 28, 28, 28, 29, 28, 30, 30, 28, 29, 28, 28, 33, 29]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.359844353667955, "mean_inference_ms": 0.7282283640001628, "mean_action_processing_ms": 0.07660514317494423, "mean_env_wait_ms": 7.103376412337862, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0070538081175892066, "StateBufferConnector_ms": 0.004207665193165447, "ViewRequirementAgentConnector_ms": 0.09443387917593016}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 172000, "num_agent_steps_trained": 172000, "num_env_steps_sampled": 172000, "num_env_steps_trained": 172000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 488.0166078840676, "num_env_steps_trained_throughput_per_sec": 488.0166078840676, "timesteps_total": 172000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 172000, "timers": {"training_iteration_time_ms": 8176.02, "sample_time_ms": 4693.016, "load_time_ms": 0.971, "load_throughput": 4119028.75, "learn_time_ms": 3478.422, "learn_throughput": 1149.947, "synch_weights_time_ms": 2.938}, "counters": {"num_env_steps_sampled": 172000, "num_env_steps_trained": 172000, "num_agent_steps_sampled": 172000, "num_agent_steps_trained": 172000}, "done": false, "episodes_total": 3727, "training_iteration": 43, "trial_id": "133f9_00000", "date": "2024-03-07_13-16-53", "timestamp": 1709835413, "time_this_iter_s": 8.199588060379028, "time_total_s": 334.97257256507874, "pid": 117779, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7efea6399f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 334.97257256507874, "iterations_since_restore": 43, "perf": {"cpu_util_percent": 34.62, "ram_util_percent": 50.760000000000005, "gpu_util_percent0": 0.074, "vram_util_percent0": 0.093994140625}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 0.0586143321529161, "policy_loss": -0.008819598786693106, "vf_loss": 0.06548222118553014, "vf_explained_var": 0.937075150205243, "kl": 0.009758549347153797, "entropy": 0.22248647218590142, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 40455.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 176000, "num_env_steps_trained": 176000, "num_agent_steps_sampled": 176000, "num_agent_steps_trained": 176000}, "sampler_results": {"episode_reward_max": -1.4000000000000008, "episode_reward_min": -3.500000000000001, "episode_reward_mean": -1.7690647482014399, "episode_len_mean": 28.510791366906474, "episode_media": {}, "episodes_this_iter": 139, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1.700000000000001, -1.9000000000000012, -1.700000000000001, -1.600000000000001, -1.8000000000000012, -1.600000000000001, -1.600000000000001, -1.700000000000001, -1.600000000000001, -2.1000000000000014, -1.5000000000000009, -1.600000000000001, -1.700000000000001, -1.700000000000001, -2.0000000000000013, -2.0000000000000013, -2.2000000000000015, -1.4000000000000008, -1.8000000000000012, -1.8000000000000012, -1.5000000000000009, -1.8000000000000012, -1.700000000000001, -1.600000000000001, -1.700000000000001, -1.700000000000001, -1.600000000000001, -1.4000000000000008, -1.700000000000001, -2.3000000000000016, -2.0000000000000013, -3.500000000000001, -1.5000000000000009, -1.700000000000001, -1.700000000000001, -1.9000000000000012, -1.8000000000000012, -2.0000000000000013, -1.700000000000001, -1.4000000000000008, -2.0000000000000013, -1.600000000000001, -2.5000000000000018, -1.700000000000001, -1.4000000000000008, -1.4000000000000008, -2.5000000000000018, -1.8000000000000012, -1.5000000000000009, -1.4000000000000008, -2.0000000000000013, -1.700000000000001, -1.8000000000000012, -1.9000000000000012, -1.5000000000000009, -2.0000000000000013, -1.600000000000001, -1.600000000000001, -1.9000000000000012, -1.5000000000000009, -1.9000000000000012, -1.8000000000000012, -1.600000000000001, -1.5000000000000009, -1.700000000000001, -1.8000000000000012, -1.9000000000000012, -1.700000000000001, -1.600000000000001, -1.8000000000000012, -1.600000000000001, -1.700000000000001, -1.8000000000000012, -1.5000000000000009, -1.700000000000001, -1.8000000000000012, -1.5000000000000009, -1.8000000000000012, -1.9000000000000012, -1.700000000000001, -1.700000000000001, -1.9000000000000012, -1.600000000000001, -1.4000000000000008, -1.700000000000001, -2.1000000000000014, -1.5000000000000009, -1.9000000000000012, -1.8000000000000012, -1.700000000000001, -1.5000000000000009, -1.4000000000000008, -1.600000000000001, -1.700000000000001, -1.4000000000000008, -1.600000000000001, -1.8000000000000012, -1.4000000000000008, -1.5000000000000009, -2.4000000000000017, -1.8000000000000012, -1.600000000000001, -2.1000000000000014, -1.600000000000001, -1.700000000000001, -1.600000000000001, -1.4000000000000008, -2.0000000000000013, -1.600000000000001, -1.5000000000000009, -2.1000000000000014, -2.0000000000000013, -1.8000000000000012, -2.1000000000000014, -1.700000000000001, -2.2000000000000015, -1.9000000000000012, -1.600000000000001, -1.600000000000001, -3.1000000000000014, -1.4000000000000008, -1.5000000000000009, -1.5000000000000009, -1.5000000000000009, -1.9000000000000012, -1.8000000000000012, -1.5000000000000009, -1.5000000000000009, -2.900000000000002, -1.700000000000001, -2.600000000000002, -2.3000000000000016, -2.0000000000000013, -1.700000000000001, -1.700000000000001, -2.5000000000000018, -1.5000000000000009, -1.4000000000000008, -1.600000000000001], "episode_lengths": [28, 30, 28, 27, 29, 27, 27, 28, 27, 32, 26, 27, 28, 28, 31, 31, 33, 25, 29, 29, 26, 29, 28, 27, 28, 28, 27, 25, 28, 34, 31, 39, 26, 28, 28, 30, 29, 31, 28, 25, 31, 27, 35, 28, 25, 25, 32, 29, 26, 25, 31, 28, 29, 30, 26, 31, 27, 27, 30, 26, 30, 29, 27, 26, 28, 29, 30, 28, 27, 29, 27, 28, 29, 26, 28, 29, 26, 29, 30, 28, 28, 30, 27, 25, 28, 32, 26, 30, 29, 28, 26, 25, 27, 28, 25, 27, 29, 25, 26, 35, 29, 27, 32, 27, 28, 27, 25, 31, 27, 26, 32, 31, 29, 32, 28, 33, 30, 27, 27, 35, 25, 26, 26, 26, 30, 29, 26, 26, 39, 28, 36, 34, 31, 28, 28, 32, 26, 25, 27]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.36180471983053225, "mean_inference_ms": 0.7281881966311329, "mean_action_processing_ms": 0.07658819901605315, "mean_env_wait_ms": 7.11748342465711, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006698018355335263, "StateBufferConnector_ms": 0.0040802166616316325, "ViewRequirementAgentConnector_ms": 0.09133301192907978}}, "episode_reward_max": -1.4000000000000008, "episode_reward_min": -3.500000000000001, "episode_reward_mean": -1.7690647482014399, "episode_len_mean": 28.510791366906474, "episodes_this_iter": 139, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1.700000000000001, -1.9000000000000012, -1.700000000000001, -1.600000000000001, -1.8000000000000012, -1.600000000000001, -1.600000000000001, -1.700000000000001, -1.600000000000001, -2.1000000000000014, -1.5000000000000009, -1.600000000000001, -1.700000000000001, -1.700000000000001, -2.0000000000000013, -2.0000000000000013, -2.2000000000000015, -1.4000000000000008, -1.8000000000000012, -1.8000000000000012, -1.5000000000000009, -1.8000000000000012, -1.700000000000001, -1.600000000000001, -1.700000000000001, -1.700000000000001, -1.600000000000001, -1.4000000000000008, -1.700000000000001, -2.3000000000000016, -2.0000000000000013, -3.500000000000001, -1.5000000000000009, -1.700000000000001, -1.700000000000001, -1.9000000000000012, -1.8000000000000012, -2.0000000000000013, -1.700000000000001, -1.4000000000000008, -2.0000000000000013, -1.600000000000001, -2.5000000000000018, -1.700000000000001, -1.4000000000000008, -1.4000000000000008, -2.5000000000000018, -1.8000000000000012, -1.5000000000000009, -1.4000000000000008, -2.0000000000000013, -1.700000000000001, -1.8000000000000012, -1.9000000000000012, -1.5000000000000009, -2.0000000000000013, -1.600000000000001, -1.600000000000001, -1.9000000000000012, -1.5000000000000009, -1.9000000000000012, -1.8000000000000012, -1.600000000000001, -1.5000000000000009, -1.700000000000001, -1.8000000000000012, -1.9000000000000012, -1.700000000000001, -1.600000000000001, -1.8000000000000012, -1.600000000000001, -1.700000000000001, -1.8000000000000012, -1.5000000000000009, -1.700000000000001, -1.8000000000000012, -1.5000000000000009, -1.8000000000000012, -1.9000000000000012, -1.700000000000001, -1.700000000000001, -1.9000000000000012, -1.600000000000001, -1.4000000000000008, -1.700000000000001, -2.1000000000000014, -1.5000000000000009, -1.9000000000000012, -1.8000000000000012, -1.700000000000001, -1.5000000000000009, -1.4000000000000008, -1.600000000000001, -1.700000000000001, -1.4000000000000008, -1.600000000000001, -1.8000000000000012, -1.4000000000000008, -1.5000000000000009, -2.4000000000000017, -1.8000000000000012, -1.600000000000001, -2.1000000000000014, -1.600000000000001, -1.700000000000001, -1.600000000000001, -1.4000000000000008, -2.0000000000000013, -1.600000000000001, -1.5000000000000009, -2.1000000000000014, -2.0000000000000013, -1.8000000000000012, -2.1000000000000014, -1.700000000000001, -2.2000000000000015, -1.9000000000000012, -1.600000000000001, -1.600000000000001, -3.1000000000000014, -1.4000000000000008, -1.5000000000000009, -1.5000000000000009, -1.5000000000000009, -1.9000000000000012, -1.8000000000000012, -1.5000000000000009, -1.5000000000000009, -2.900000000000002, -1.700000000000001, -2.600000000000002, -2.3000000000000016, -2.0000000000000013, -1.700000000000001, -1.700000000000001, -2.5000000000000018, -1.5000000000000009, -1.4000000000000008, -1.600000000000001], "episode_lengths": [28, 30, 28, 27, 29, 27, 27, 28, 27, 32, 26, 27, 28, 28, 31, 31, 33, 25, 29, 29, 26, 29, 28, 27, 28, 28, 27, 25, 28, 34, 31, 39, 26, 28, 28, 30, 29, 31, 28, 25, 31, 27, 35, 28, 25, 25, 32, 29, 26, 25, 31, 28, 29, 30, 26, 31, 27, 27, 30, 26, 30, 29, 27, 26, 28, 29, 30, 28, 27, 29, 27, 28, 29, 26, 28, 29, 26, 29, 30, 28, 28, 30, 27, 25, 28, 32, 26, 30, 29, 28, 26, 25, 27, 28, 25, 27, 29, 25, 26, 35, 29, 27, 32, 27, 28, 27, 25, 31, 27, 26, 32, 31, 29, 32, 28, 33, 30, 27, 27, 35, 25, 26, 26, 26, 30, 29, 26, 26, 39, 28, 36, 34, 31, 28, 28, 32, 26, 25, 27]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.36180471983053225, "mean_inference_ms": 0.7281881966311329, "mean_action_processing_ms": 0.07658819901605315, "mean_env_wait_ms": 7.11748342465711, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006698018355335263, "StateBufferConnector_ms": 0.0040802166616316325, "ViewRequirementAgentConnector_ms": 0.09133301192907978}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 176000, "num_agent_steps_trained": 176000, "num_env_steps_sampled": 176000, "num_env_steps_trained": 176000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 496.03025683522935, "num_env_steps_trained_throughput_per_sec": 496.03025683522935, "timesteps_total": 176000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 176000, "timers": {"training_iteration_time_ms": 8165.221, "sample_time_ms": 4680.311, "load_time_ms": 0.961, "load_throughput": 4160190.438, "learn_time_ms": 3480.335, "learn_throughput": 1149.315, "synch_weights_time_ms": 2.946}, "counters": {"num_env_steps_sampled": 176000, "num_env_steps_trained": 176000, "num_agent_steps_sampled": 176000, "num_agent_steps_trained": 176000}, "done": false, "episodes_total": 3866, "training_iteration": 44, "trial_id": "133f9_00000", "date": "2024-03-07_13-17-01", "timestamp": 1709835421, "time_this_iter_s": 8.06698203086853, "time_total_s": 343.03955459594727, "pid": 117779, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7efea6399f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 343.03955459594727, "iterations_since_restore": 44, "perf": {"cpu_util_percent": 30.818181818181824, "ram_util_percent": 50.8, "gpu_util_percent0": 0.08454545454545456, "vram_util_percent0": 0.09400893702651514}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 0.004905307769552574, "policy_loss": -0.016552361431381394, "vf_loss": 0.020109410277788117, "vf_explained_var": 0.9787255305115895, "kl": 0.0067412895389058645, "entropy": 0.19351532532963703, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 41385.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 180000, "num_env_steps_trained": 180000, "num_agent_steps_sampled": 180000, "num_agent_steps_trained": 180000}, "sampler_results": {"episode_reward_max": -1.4000000000000008, "episode_reward_min": -2.700000000000002, "episode_reward_mean": -1.7443661971830997, "episode_len_mean": 28.41549295774648, "episode_media": {}, "episodes_this_iter": 142, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1.600000000000001, -1.8000000000000012, -1.5000000000000009, -1.4000000000000008, -1.700000000000001, -1.5000000000000009, -1.4000000000000008, -1.9000000000000012, -2.0000000000000013, -2.0000000000000013, -1.9000000000000012, -1.8000000000000012, -1.9000000000000012, -1.600000000000001, -1.700000000000001, -2.1000000000000014, -2.700000000000002, -1.9000000000000012, -1.700000000000001, -1.700000000000001, -2.3000000000000016, -1.600000000000001, -1.9000000000000012, -2.3000000000000016, -1.8000000000000012, -2.2000000000000015, -2.0000000000000013, -1.8000000000000012, -1.700000000000001, -2.0000000000000013, -1.700000000000001, -1.5000000000000009, -1.4000000000000008, -2.700000000000002, -1.8000000000000012, -1.5000000000000009, -1.8000000000000012, -1.4000000000000008, -1.8000000000000012, -1.8000000000000012, -1.9000000000000012, -1.5000000000000009, -1.600000000000001, -1.4000000000000008, -1.9000000000000012, -1.600000000000001, -1.5000000000000009, -1.9000000000000012, -2.0000000000000013, -1.8000000000000012, -2.2000000000000015, -1.5000000000000009, -1.5000000000000009, -2.2000000000000015, -1.5000000000000009, -1.600000000000001, -1.600000000000001, -1.600000000000001, -1.5000000000000009, -2.1000000000000014, -1.700000000000001, -1.600000000000001, -1.5000000000000009, -1.700000000000001, -1.600000000000001, -2.0000000000000013, -1.4000000000000008, -2.3000000000000016, -1.5000000000000009, -1.700000000000001, -2.1000000000000014, -1.5000000000000009, -1.8000000000000012, -1.700000000000001, -1.5000000000000009, -1.9000000000000012, -2.0000000000000013, -1.8000000000000012, -1.8000000000000012, -1.5000000000000009, -1.4000000000000008, -1.5000000000000009, -1.5000000000000009, -2.0000000000000013, -1.600000000000001, -1.5000000000000009, -1.5000000000000009, -2.600000000000002, -2.1000000000000014, -1.4000000000000008, -1.600000000000001, -1.9000000000000012, -1.9000000000000012, -1.4000000000000008, -2.0000000000000013, -1.4000000000000008, -2.1000000000000014, -1.5000000000000009, -1.600000000000001, -1.600000000000001, -1.5000000000000009, -1.5000000000000009, -1.5000000000000009, -2.600000000000002, -1.5000000000000009, -1.9000000000000012, -1.700000000000001, -1.4000000000000008, -1.5000000000000009, -1.4000000000000008, -1.9000000000000012, -1.8000000000000012, -1.9000000000000012, -2.0000000000000013, -1.600000000000001, -1.700000000000001, -1.5000000000000009, -1.600000000000001, -1.5000000000000009, -1.8000000000000012, -1.600000000000001, -1.5000000000000009, -1.600000000000001, -1.9000000000000012, -1.9000000000000012, -2.0000000000000013, -1.8000000000000012, -1.9000000000000012, -1.5000000000000009, -1.5000000000000009, -1.600000000000001, -1.700000000000001, -1.4000000000000008, -2.4000000000000017, -1.700000000000001, -1.4000000000000008, -1.8000000000000012, -1.8000000000000012, -1.8000000000000012, -1.8000000000000012, -1.700000000000001, -1.700000000000001], "episode_lengths": [27, 29, 26, 25, 28, 26, 25, 30, 31, 31, 30, 29, 30, 27, 28, 32, 38, 30, 28, 28, 34, 27, 30, 34, 29, 33, 31, 29, 28, 31, 28, 26, 25, 38, 29, 26, 29, 25, 29, 29, 30, 26, 27, 25, 30, 27, 26, 30, 31, 29, 33, 26, 26, 33, 26, 27, 27, 27, 26, 32, 28, 27, 26, 28, 27, 31, 25, 34, 26, 28, 32, 26, 29, 28, 26, 30, 31, 29, 29, 26, 25, 26, 26, 31, 27, 26, 26, 37, 32, 25, 27, 30, 30, 25, 31, 25, 32, 26, 27, 27, 26, 26, 26, 33, 26, 30, 28, 25, 26, 25, 30, 29, 30, 31, 27, 28, 26, 27, 26, 29, 27, 26, 27, 30, 30, 31, 29, 30, 26, 26, 27, 28, 25, 35, 28, 25, 29, 29, 29, 29, 28, 28]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.36381413496450427, "mean_inference_ms": 0.7282502727754383, "mean_action_processing_ms": 0.07660371742356485, "mean_env_wait_ms": 7.12987295089876, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00683035649044413, "StateBufferConnector_ms": 0.004105332871557961, "ViewRequirementAgentConnector_ms": 0.09200203586632097}}, "episode_reward_max": -1.4000000000000008, "episode_reward_min": -2.700000000000002, "episode_reward_mean": -1.7443661971830997, "episode_len_mean": 28.41549295774648, "episodes_this_iter": 142, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1.600000000000001, -1.8000000000000012, -1.5000000000000009, -1.4000000000000008, -1.700000000000001, -1.5000000000000009, -1.4000000000000008, -1.9000000000000012, -2.0000000000000013, -2.0000000000000013, -1.9000000000000012, -1.8000000000000012, -1.9000000000000012, -1.600000000000001, -1.700000000000001, -2.1000000000000014, -2.700000000000002, -1.9000000000000012, -1.700000000000001, -1.700000000000001, -2.3000000000000016, -1.600000000000001, -1.9000000000000012, -2.3000000000000016, -1.8000000000000012, -2.2000000000000015, -2.0000000000000013, -1.8000000000000012, -1.700000000000001, -2.0000000000000013, -1.700000000000001, -1.5000000000000009, -1.4000000000000008, -2.700000000000002, -1.8000000000000012, -1.5000000000000009, -1.8000000000000012, -1.4000000000000008, -1.8000000000000012, -1.8000000000000012, -1.9000000000000012, -1.5000000000000009, -1.600000000000001, -1.4000000000000008, -1.9000000000000012, -1.600000000000001, -1.5000000000000009, -1.9000000000000012, -2.0000000000000013, -1.8000000000000012, -2.2000000000000015, -1.5000000000000009, -1.5000000000000009, -2.2000000000000015, -1.5000000000000009, -1.600000000000001, -1.600000000000001, -1.600000000000001, -1.5000000000000009, -2.1000000000000014, -1.700000000000001, -1.600000000000001, -1.5000000000000009, -1.700000000000001, -1.600000000000001, -2.0000000000000013, -1.4000000000000008, -2.3000000000000016, -1.5000000000000009, -1.700000000000001, -2.1000000000000014, -1.5000000000000009, -1.8000000000000012, -1.700000000000001, -1.5000000000000009, -1.9000000000000012, -2.0000000000000013, -1.8000000000000012, -1.8000000000000012, -1.5000000000000009, -1.4000000000000008, -1.5000000000000009, -1.5000000000000009, -2.0000000000000013, -1.600000000000001, -1.5000000000000009, -1.5000000000000009, -2.600000000000002, -2.1000000000000014, -1.4000000000000008, -1.600000000000001, -1.9000000000000012, -1.9000000000000012, -1.4000000000000008, -2.0000000000000013, -1.4000000000000008, -2.1000000000000014, -1.5000000000000009, -1.600000000000001, -1.600000000000001, -1.5000000000000009, -1.5000000000000009, -1.5000000000000009, -2.600000000000002, -1.5000000000000009, -1.9000000000000012, -1.700000000000001, -1.4000000000000008, -1.5000000000000009, -1.4000000000000008, -1.9000000000000012, -1.8000000000000012, -1.9000000000000012, -2.0000000000000013, -1.600000000000001, -1.700000000000001, -1.5000000000000009, -1.600000000000001, -1.5000000000000009, -1.8000000000000012, -1.600000000000001, -1.5000000000000009, -1.600000000000001, -1.9000000000000012, -1.9000000000000012, -2.0000000000000013, -1.8000000000000012, -1.9000000000000012, -1.5000000000000009, -1.5000000000000009, -1.600000000000001, -1.700000000000001, -1.4000000000000008, -2.4000000000000017, -1.700000000000001, -1.4000000000000008, -1.8000000000000012, -1.8000000000000012, -1.8000000000000012, -1.8000000000000012, -1.700000000000001, -1.700000000000001], "episode_lengths": [27, 29, 26, 25, 28, 26, 25, 30, 31, 31, 30, 29, 30, 27, 28, 32, 38, 30, 28, 28, 34, 27, 30, 34, 29, 33, 31, 29, 28, 31, 28, 26, 25, 38, 29, 26, 29, 25, 29, 29, 30, 26, 27, 25, 30, 27, 26, 30, 31, 29, 33, 26, 26, 33, 26, 27, 27, 27, 26, 32, 28, 27, 26, 28, 27, 31, 25, 34, 26, 28, 32, 26, 29, 28, 26, 30, 31, 29, 29, 26, 25, 26, 26, 31, 27, 26, 26, 37, 32, 25, 27, 30, 30, 25, 31, 25, 32, 26, 27, 27, 26, 26, 26, 33, 26, 30, 28, 25, 26, 25, 30, 29, 30, 31, 27, 28, 26, 27, 26, 29, 27, 26, 27, 30, 30, 31, 29, 30, 26, 26, 27, 28, 25, 35, 28, 25, 29, 29, 29, 29, 28, 28]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.36381413496450427, "mean_inference_ms": 0.7282502727754383, "mean_action_processing_ms": 0.07660371742356485, "mean_env_wait_ms": 7.12987295089876, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00683035649044413, "StateBufferConnector_ms": 0.004105332871557961, "ViewRequirementAgentConnector_ms": 0.09200203586632097}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 180000, "num_agent_steps_trained": 180000, "num_env_steps_sampled": 180000, "num_env_steps_trained": 180000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 497.7992021903951, "num_env_steps_trained_throughput_per_sec": 497.7992021903951, "timesteps_total": 180000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 180000, "timers": {"training_iteration_time_ms": 8159.254, "sample_time_ms": 4679.1, "load_time_ms": 0.961, "load_throughput": 4162874.299, "learn_time_ms": 3475.556, "learn_throughput": 1150.895, "synch_weights_time_ms": 2.972}, "counters": {"num_env_steps_sampled": 180000, "num_env_steps_trained": 180000, "num_agent_steps_sampled": 180000, "num_agent_steps_trained": 180000}, "done": false, "episodes_total": 4008, "training_iteration": 45, "trial_id": "133f9_00000", "date": "2024-03-07_13-17-09", "timestamp": 1709835429, "time_this_iter_s": 8.03849458694458, "time_total_s": 351.07804918289185, "pid": 117779, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7efea6399f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 351.07804918289185, "iterations_since_restore": 45, "perf": {"cpu_util_percent": 33.2, "ram_util_percent": 50.8, "gpu_util_percent0": 0.074, "vram_util_percent0": 0.09259440104166668}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 0.010146865344378517, "policy_loss": -0.008456509271937031, "vf_loss": 0.01622421714296985, "vf_explained_var": 0.9825074217011852, "kl": 0.011895784661197038, "entropy": 0.18169278621032675, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 42315.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 184000, "num_env_steps_trained": 184000, "num_agent_steps_sampled": 184000, "num_agent_steps_trained": 184000}, "sampler_results": {"episode_reward_max": -1.4000000000000008, "episode_reward_min": -3.0000000000000018, "episode_reward_mean": -1.714788732394367, "episode_len_mean": 28.112676056338028, "episode_media": {}, "episodes_this_iter": 142, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1.600000000000001, -1.5000000000000009, -1.5000000000000009, -1.9000000000000012, -1.600000000000001, -1.600000000000001, -1.8000000000000012, -1.5000000000000009, -1.600000000000001, -1.9000000000000012, -1.700000000000001, -1.700000000000001, -1.5000000000000009, -1.8000000000000012, -1.700000000000001, -1.700000000000001, -1.600000000000001, -1.8000000000000012, -1.700000000000001, -1.600000000000001, -2.3000000000000016, -1.4000000000000008, -1.9000000000000012, -1.9000000000000012, -3.0000000000000018, -1.600000000000001, -1.700000000000001, -1.8000000000000012, -1.600000000000001, -2.0000000000000013, -2.2000000000000015, -1.600000000000001, -1.5000000000000009, -1.5000000000000009, -1.600000000000001, -1.8000000000000012, -1.4000000000000008, -2.0000000000000013, -1.5000000000000009, -1.5000000000000009, -1.600000000000001, -1.600000000000001, -1.700000000000001, -1.5000000000000009, -1.600000000000001, -1.600000000000001, -1.5000000000000009, -1.8000000000000012, -1.700000000000001, -1.9000000000000012, -1.9000000000000012, -2.0000000000000013, -1.600000000000001, -2.0000000000000013, -1.8000000000000012, -1.5000000000000009, -1.9000000000000012, -1.8000000000000012, -1.4000000000000008, -1.700000000000001, -1.700000000000001, -1.4000000000000008, -1.700000000000001, -1.9000000000000012, -1.600000000000001, -1.8000000000000012, -1.8000000000000012, -1.5000000000000009, -1.700000000000001, -1.5000000000000009, -1.700000000000001, -1.700000000000001, -1.8000000000000012, -1.8000000000000012, -1.700000000000001, -2.1000000000000014, -2.0000000000000013, -1.600000000000001, -1.700000000000001, -1.8000000000000012, -2.2000000000000015, -1.4000000000000008, -2.1000000000000014, -1.700000000000001, -1.8000000000000012, -1.5000000000000009, -1.600000000000001, -1.600000000000001, -1.600000000000001, -1.9000000000000012, -1.5000000000000009, -1.600000000000001, -1.8000000000000012, -2.0000000000000013, -1.700000000000001, -1.700000000000001, -2.0000000000000013, -1.4000000000000008, -2.0000000000000013, -2.0000000000000013, -1.5000000000000009, -1.8000000000000012, -1.9000000000000012, -1.5000000000000009, -1.9000000000000012, -1.4000000000000008, -1.700000000000001, -1.600000000000001, -1.5000000000000009, -1.600000000000001, -1.5000000000000009, -1.8000000000000012, -1.8000000000000012, -1.4000000000000008, -1.8000000000000012, -1.600000000000001, -1.700000000000001, -1.700000000000001, -1.600000000000001, -2.1000000000000014, -1.5000000000000009, -1.5000000000000009, -1.8000000000000012, -1.600000000000001, -1.9000000000000012, -1.700000000000001, -1.4000000000000008, -1.5000000000000009, -2.1000000000000014, -1.700000000000001, -1.600000000000001, -2.1000000000000014, -1.600000000000001, -2.1000000000000014, -1.8000000000000012, -1.4000000000000008, -1.9000000000000012, -1.600000000000001, -1.4000000000000008, -1.700000000000001, -1.5000000000000009, -1.9000000000000012], "episode_lengths": [27, 26, 26, 30, 27, 27, 29, 26, 27, 30, 28, 28, 26, 29, 28, 28, 27, 29, 28, 27, 34, 25, 30, 30, 36, 27, 28, 29, 27, 31, 33, 27, 26, 26, 27, 29, 25, 31, 26, 26, 27, 27, 28, 26, 27, 27, 26, 29, 28, 30, 30, 31, 27, 31, 29, 26, 30, 29, 25, 28, 28, 25, 28, 30, 27, 29, 29, 26, 28, 26, 28, 28, 29, 29, 28, 32, 31, 27, 28, 29, 33, 25, 32, 28, 29, 26, 27, 27, 27, 30, 26, 27, 29, 31, 28, 28, 31, 25, 31, 31, 26, 29, 30, 26, 30, 25, 28, 27, 26, 27, 26, 29, 29, 25, 29, 27, 28, 28, 27, 32, 26, 26, 29, 27, 30, 28, 25, 26, 32, 28, 27, 32, 27, 32, 29, 25, 30, 27, 25, 28, 26, 30]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.36579344230685507, "mean_inference_ms": 0.7283635649074932, "mean_action_processing_ms": 0.07660431017626217, "mean_env_wait_ms": 7.14427268397696, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006958128700793629, "StateBufferConnector_ms": 0.004109866182569047, "ViewRequirementAgentConnector_ms": 0.09187510315801056}}, "episode_reward_max": -1.4000000000000008, "episode_reward_min": -3.0000000000000018, "episode_reward_mean": -1.714788732394367, "episode_len_mean": 28.112676056338028, "episodes_this_iter": 142, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1.600000000000001, -1.5000000000000009, -1.5000000000000009, -1.9000000000000012, -1.600000000000001, -1.600000000000001, -1.8000000000000012, -1.5000000000000009, -1.600000000000001, -1.9000000000000012, -1.700000000000001, -1.700000000000001, -1.5000000000000009, -1.8000000000000012, -1.700000000000001, -1.700000000000001, -1.600000000000001, -1.8000000000000012, -1.700000000000001, -1.600000000000001, -2.3000000000000016, -1.4000000000000008, -1.9000000000000012, -1.9000000000000012, -3.0000000000000018, -1.600000000000001, -1.700000000000001, -1.8000000000000012, -1.600000000000001, -2.0000000000000013, -2.2000000000000015, -1.600000000000001, -1.5000000000000009, -1.5000000000000009, -1.600000000000001, -1.8000000000000012, -1.4000000000000008, -2.0000000000000013, -1.5000000000000009, -1.5000000000000009, -1.600000000000001, -1.600000000000001, -1.700000000000001, -1.5000000000000009, -1.600000000000001, -1.600000000000001, -1.5000000000000009, -1.8000000000000012, -1.700000000000001, -1.9000000000000012, -1.9000000000000012, -2.0000000000000013, -1.600000000000001, -2.0000000000000013, -1.8000000000000012, -1.5000000000000009, -1.9000000000000012, -1.8000000000000012, -1.4000000000000008, -1.700000000000001, -1.700000000000001, -1.4000000000000008, -1.700000000000001, -1.9000000000000012, -1.600000000000001, -1.8000000000000012, -1.8000000000000012, -1.5000000000000009, -1.700000000000001, -1.5000000000000009, -1.700000000000001, -1.700000000000001, -1.8000000000000012, -1.8000000000000012, -1.700000000000001, -2.1000000000000014, -2.0000000000000013, -1.600000000000001, -1.700000000000001, -1.8000000000000012, -2.2000000000000015, -1.4000000000000008, -2.1000000000000014, -1.700000000000001, -1.8000000000000012, -1.5000000000000009, -1.600000000000001, -1.600000000000001, -1.600000000000001, -1.9000000000000012, -1.5000000000000009, -1.600000000000001, -1.8000000000000012, -2.0000000000000013, -1.700000000000001, -1.700000000000001, -2.0000000000000013, -1.4000000000000008, -2.0000000000000013, -2.0000000000000013, -1.5000000000000009, -1.8000000000000012, -1.9000000000000012, -1.5000000000000009, -1.9000000000000012, -1.4000000000000008, -1.700000000000001, -1.600000000000001, -1.5000000000000009, -1.600000000000001, -1.5000000000000009, -1.8000000000000012, -1.8000000000000012, -1.4000000000000008, -1.8000000000000012, -1.600000000000001, -1.700000000000001, -1.700000000000001, -1.600000000000001, -2.1000000000000014, -1.5000000000000009, -1.5000000000000009, -1.8000000000000012, -1.600000000000001, -1.9000000000000012, -1.700000000000001, -1.4000000000000008, -1.5000000000000009, -2.1000000000000014, -1.700000000000001, -1.600000000000001, -2.1000000000000014, -1.600000000000001, -2.1000000000000014, -1.8000000000000012, -1.4000000000000008, -1.9000000000000012, -1.600000000000001, -1.4000000000000008, -1.700000000000001, -1.5000000000000009, -1.9000000000000012], "episode_lengths": [27, 26, 26, 30, 27, 27, 29, 26, 27, 30, 28, 28, 26, 29, 28, 28, 27, 29, 28, 27, 34, 25, 30, 30, 36, 27, 28, 29, 27, 31, 33, 27, 26, 26, 27, 29, 25, 31, 26, 26, 27, 27, 28, 26, 27, 27, 26, 29, 28, 30, 30, 31, 27, 31, 29, 26, 30, 29, 25, 28, 28, 25, 28, 30, 27, 29, 29, 26, 28, 26, 28, 28, 29, 29, 28, 32, 31, 27, 28, 29, 33, 25, 32, 28, 29, 26, 27, 27, 27, 30, 26, 27, 29, 31, 28, 28, 31, 25, 31, 31, 26, 29, 30, 26, 30, 25, 28, 27, 26, 27, 26, 29, 29, 25, 29, 27, 28, 28, 27, 32, 26, 26, 29, 27, 30, 28, 25, 26, 32, 28, 27, 32, 27, 32, 29, 25, 30, 27, 25, 28, 26, 30]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.36579344230685507, "mean_inference_ms": 0.7283635649074932, "mean_action_processing_ms": 0.07660431017626217, "mean_env_wait_ms": 7.14427268397696, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006958128700793629, "StateBufferConnector_ms": 0.004109866182569047, "ViewRequirementAgentConnector_ms": 0.09187510315801056}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 184000, "num_agent_steps_trained": 184000, "num_env_steps_sampled": 184000, "num_env_steps_trained": 184000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 492.94439266885917, "num_env_steps_trained_throughput_per_sec": 492.94439266885917, "timesteps_total": 184000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 184000, "timers": {"training_iteration_time_ms": 8120.75, "sample_time_ms": 4636.58, "load_time_ms": 0.962, "load_throughput": 4157922.181, "learn_time_ms": 3479.574, "learn_throughput": 1149.566, "synch_weights_time_ms": 2.964}, "counters": {"num_env_steps_sampled": 184000, "num_env_steps_trained": 184000, "num_agent_steps_sampled": 184000, "num_agent_steps_trained": 184000}, "done": false, "episodes_total": 4150, "training_iteration": 46, "trial_id": "133f9_00000", "date": "2024-03-07_13-17-17", "timestamp": 1709835437, "time_this_iter_s": 8.117537260055542, "time_total_s": 359.1955864429474, "pid": 117779, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7efea6399f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 359.1955864429474, "iterations_since_restore": 46, "perf": {"cpu_util_percent": 30.64545454545454, "ram_util_percent": 50.8, "gpu_util_percent0": 0.08363636363636363, "vram_util_percent0": 0.09164891098484848}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 0.03556048102527907, "policy_loss": -0.00652905059577797, "vf_loss": 0.04013946447471377, "vf_explained_var": 0.9687648109210435, "kl": 0.00975032912268973, "entropy": 0.19616368163016534, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 43245.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 188000, "num_env_steps_trained": 188000, "num_agent_steps_sampled": 188000, "num_agent_steps_trained": 188000}, "sampler_results": {"episode_reward_max": -1.4000000000000008, "episode_reward_min": -3.8999999999999995, "episode_reward_mean": -1.7104895104895115, "episode_len_mean": 28.055944055944057, "episode_media": {}, "episodes_this_iter": 143, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1.600000000000001, -1.5000000000000009, -3.8999999999999995, -1.700000000000001, -1.600000000000001, -1.9000000000000012, -1.600000000000001, -1.8000000000000012, -1.8000000000000012, -1.8000000000000012, -1.5000000000000009, -1.5000000000000009, -1.9000000000000012, -1.8000000000000012, -1.8000000000000012, -2.1000000000000014, -1.4000000000000008, -1.700000000000001, -1.8000000000000012, -1.700000000000001, -1.8000000000000012, -1.600000000000001, -1.600000000000001, -1.600000000000001, -1.600000000000001, -2.0000000000000013, -1.5000000000000009, -1.9000000000000012, -1.5000000000000009, -1.600000000000001, -1.600000000000001, -1.700000000000001, -1.700000000000001, -1.700000000000001, -1.600000000000001, -1.4000000000000008, -1.8000000000000012, -1.5000000000000009, -1.700000000000001, -1.8000000000000012, -1.8000000000000012, -1.700000000000001, -1.4000000000000008, -1.9000000000000012, -1.700000000000001, -1.9000000000000012, -1.4000000000000008, -1.700000000000001, -1.600000000000001, -1.9000000000000012, -1.600000000000001, -1.600000000000001, -2.0000000000000013, -1.8000000000000012, -1.600000000000001, -1.5000000000000009, -1.9000000000000012, -1.600000000000001, -1.9000000000000012, -1.600000000000001, -1.5000000000000009, -1.600000000000001, -1.700000000000001, -2.3000000000000016, -1.9000000000000012, -2.0000000000000013, -1.700000000000001, -1.600000000000001, -1.600000000000001, -1.9000000000000012, -1.700000000000001, -1.8000000000000012, -1.600000000000001, -1.5000000000000009, -1.4000000000000008, -1.700000000000001, -1.700000000000001, -1.700000000000001, -2.1000000000000014, -1.600000000000001, -1.600000000000001, -1.8000000000000012, -1.700000000000001, -2.2000000000000015, -2.4000000000000017, -1.700000000000001, -1.600000000000001, -2.4000000000000017, -1.4000000000000008, -1.5000000000000009, -1.600000000000001, -1.5000000000000009, -1.5000000000000009, -1.9000000000000012, -1.5000000000000009, -1.4000000000000008, -1.4000000000000008, -1.8000000000000012, -1.8000000000000012, -1.600000000000001, -1.4000000000000008, -1.700000000000001, -1.4000000000000008, -1.700000000000001, -2.1000000000000014, -1.4000000000000008, -1.600000000000001, -1.9000000000000012, -1.700000000000001, -1.8000000000000012, -1.600000000000001, -1.600000000000001, -1.9000000000000012, -1.600000000000001, -1.4000000000000008, -1.700000000000001, -1.700000000000001, -1.700000000000001, -1.9000000000000012, -1.5000000000000009, -1.600000000000001, -1.700000000000001, -1.700000000000001, -1.600000000000001, -1.700000000000001, -1.4000000000000008, -1.5000000000000009, -1.600000000000001, -1.600000000000001, -1.600000000000001, -1.9000000000000012, -1.700000000000001, -1.4000000000000008, -1.700000000000001, -1.700000000000001, -2.0000000000000013, -1.8000000000000012, -1.8000000000000012, -1.9000000000000012, -1.700000000000001, -1.5000000000000009, -2.1000000000000014, -1.5000000000000009], "episode_lengths": [27, 26, 43, 28, 27, 30, 27, 29, 29, 29, 26, 26, 30, 29, 29, 32, 25, 28, 29, 28, 29, 27, 27, 27, 27, 31, 26, 30, 26, 27, 27, 28, 28, 28, 27, 25, 29, 26, 28, 29, 29, 28, 25, 30, 28, 30, 25, 28, 27, 30, 27, 27, 31, 29, 27, 26, 30, 27, 30, 27, 26, 27, 28, 34, 30, 31, 28, 27, 27, 30, 28, 29, 27, 26, 25, 28, 28, 28, 32, 27, 27, 29, 28, 33, 35, 28, 27, 35, 25, 26, 27, 26, 26, 30, 26, 25, 25, 29, 29, 27, 25, 28, 25, 28, 32, 25, 27, 30, 28, 29, 27, 27, 30, 27, 25, 28, 28, 28, 30, 26, 27, 28, 28, 27, 28, 25, 26, 27, 27, 27, 30, 28, 25, 28, 28, 31, 29, 29, 30, 28, 26, 32, 26]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3677106539662725, "mean_inference_ms": 0.7283662732658137, "mean_action_processing_ms": 0.0765879435273294, "mean_env_wait_ms": 7.157533008287556, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0069734933493020654, "StateBufferConnector_ms": 0.004101299739384151, "ViewRequirementAgentConnector_ms": 0.09188952145876585}}, "episode_reward_max": -1.4000000000000008, "episode_reward_min": -3.8999999999999995, "episode_reward_mean": -1.7104895104895115, "episode_len_mean": 28.055944055944057, "episodes_this_iter": 143, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1.600000000000001, -1.5000000000000009, -3.8999999999999995, -1.700000000000001, -1.600000000000001, -1.9000000000000012, -1.600000000000001, -1.8000000000000012, -1.8000000000000012, -1.8000000000000012, -1.5000000000000009, -1.5000000000000009, -1.9000000000000012, -1.8000000000000012, -1.8000000000000012, -2.1000000000000014, -1.4000000000000008, -1.700000000000001, -1.8000000000000012, -1.700000000000001, -1.8000000000000012, -1.600000000000001, -1.600000000000001, -1.600000000000001, -1.600000000000001, -2.0000000000000013, -1.5000000000000009, -1.9000000000000012, -1.5000000000000009, -1.600000000000001, -1.600000000000001, -1.700000000000001, -1.700000000000001, -1.700000000000001, -1.600000000000001, -1.4000000000000008, -1.8000000000000012, -1.5000000000000009, -1.700000000000001, -1.8000000000000012, -1.8000000000000012, -1.700000000000001, -1.4000000000000008, -1.9000000000000012, -1.700000000000001, -1.9000000000000012, -1.4000000000000008, -1.700000000000001, -1.600000000000001, -1.9000000000000012, -1.600000000000001, -1.600000000000001, -2.0000000000000013, -1.8000000000000012, -1.600000000000001, -1.5000000000000009, -1.9000000000000012, -1.600000000000001, -1.9000000000000012, -1.600000000000001, -1.5000000000000009, -1.600000000000001, -1.700000000000001, -2.3000000000000016, -1.9000000000000012, -2.0000000000000013, -1.700000000000001, -1.600000000000001, -1.600000000000001, -1.9000000000000012, -1.700000000000001, -1.8000000000000012, -1.600000000000001, -1.5000000000000009, -1.4000000000000008, -1.700000000000001, -1.700000000000001, -1.700000000000001, -2.1000000000000014, -1.600000000000001, -1.600000000000001, -1.8000000000000012, -1.700000000000001, -2.2000000000000015, -2.4000000000000017, -1.700000000000001, -1.600000000000001, -2.4000000000000017, -1.4000000000000008, -1.5000000000000009, -1.600000000000001, -1.5000000000000009, -1.5000000000000009, -1.9000000000000012, -1.5000000000000009, -1.4000000000000008, -1.4000000000000008, -1.8000000000000012, -1.8000000000000012, -1.600000000000001, -1.4000000000000008, -1.700000000000001, -1.4000000000000008, -1.700000000000001, -2.1000000000000014, -1.4000000000000008, -1.600000000000001, -1.9000000000000012, -1.700000000000001, -1.8000000000000012, -1.600000000000001, -1.600000000000001, -1.9000000000000012, -1.600000000000001, -1.4000000000000008, -1.700000000000001, -1.700000000000001, -1.700000000000001, -1.9000000000000012, -1.5000000000000009, -1.600000000000001, -1.700000000000001, -1.700000000000001, -1.600000000000001, -1.700000000000001, -1.4000000000000008, -1.5000000000000009, -1.600000000000001, -1.600000000000001, -1.600000000000001, -1.9000000000000012, -1.700000000000001, -1.4000000000000008, -1.700000000000001, -1.700000000000001, -2.0000000000000013, -1.8000000000000012, -1.8000000000000012, -1.9000000000000012, -1.700000000000001, -1.5000000000000009, -2.1000000000000014, -1.5000000000000009], "episode_lengths": [27, 26, 43, 28, 27, 30, 27, 29, 29, 29, 26, 26, 30, 29, 29, 32, 25, 28, 29, 28, 29, 27, 27, 27, 27, 31, 26, 30, 26, 27, 27, 28, 28, 28, 27, 25, 29, 26, 28, 29, 29, 28, 25, 30, 28, 30, 25, 28, 27, 30, 27, 27, 31, 29, 27, 26, 30, 27, 30, 27, 26, 27, 28, 34, 30, 31, 28, 27, 27, 30, 28, 29, 27, 26, 25, 28, 28, 28, 32, 27, 27, 29, 28, 33, 35, 28, 27, 35, 25, 26, 27, 26, 26, 30, 26, 25, 25, 29, 29, 27, 25, 28, 25, 28, 32, 25, 27, 30, 28, 29, 27, 27, 30, 27, 25, 28, 28, 28, 30, 26, 27, 28, 28, 27, 28, 25, 26, 27, 27, 27, 30, 28, 25, 28, 28, 31, 29, 29, 30, 28, 26, 32, 26]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3677106539662725, "mean_inference_ms": 0.7283662732658137, "mean_action_processing_ms": 0.0765879435273294, "mean_env_wait_ms": 7.157533008287556, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0069734933493020654, "StateBufferConnector_ms": 0.004101299739384151, "ViewRequirementAgentConnector_ms": 0.09188952145876585}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 188000, "num_agent_steps_trained": 188000, "num_env_steps_sampled": 188000, "num_env_steps_trained": 188000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 487.41768522781143, "num_env_steps_trained_throughput_per_sec": 487.41768522781143, "timesteps_total": 188000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 188000, "timers": {"training_iteration_time_ms": 8119.478, "sample_time_ms": 4626.696, "load_time_ms": 0.964, "load_throughput": 4151029.517, "learn_time_ms": 3488.228, "learn_throughput": 1146.714, "synch_weights_time_ms": 2.919}, "counters": {"num_env_steps_sampled": 188000, "num_env_steps_trained": 188000, "num_agent_steps_sampled": 188000, "num_agent_steps_trained": 188000}, "done": false, "episodes_total": 4293, "training_iteration": 47, "trial_id": "133f9_00000", "date": "2024-03-07_13-17-25", "timestamp": 1709835445, "time_this_iter_s": 8.20952558517456, "time_total_s": 367.40511202812195, "pid": 117779, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7efea6399f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 367.40511202812195, "iterations_since_restore": 47, "perf": {"cpu_util_percent": 33.28000000000001, "ram_util_percent": 50.8, "gpu_util_percent0": 0.074, "vram_util_percent0": 0.091650390625}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 0.2333657188761619, "policy_loss": -0.012607569738181048, "vf_loss": 0.2419527797802021, "vf_explained_var": 0.8511965065233169, "kl": 0.02010254411246546, "entropy": 0.2042537496134799, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 44175.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 192000, "num_env_steps_trained": 192000, "num_agent_steps_sampled": 192000, "num_agent_steps_trained": 192000}, "sampler_results": {"episode_reward_max": -1.4000000000000008, "episode_reward_min": -6.999999999999994, "episode_reward_mean": -1.7826086956521747, "episode_len_mean": 28.55072463768116, "episode_media": {}, "episodes_this_iter": 138, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1.8000000000000012, -1.5000000000000009, -1.700000000000001, -1.600000000000001, -1.700000000000001, -1.700000000000001, -1.600000000000001, -1.9000000000000012, -1.9000000000000012, -1.700000000000001, -1.4000000000000008, -1.9000000000000012, -1.8000000000000012, -1.600000000000001, -1.700000000000001, -2.1000000000000014, -4.399999999999997, -1.700000000000001, -1.700000000000001, -1.600000000000001, -1.9000000000000012, -1.600000000000001, -1.600000000000001, -4.3000000000000025, -1.600000000000001, -1.5000000000000009, -2.0000000000000013, -1.4000000000000008, -1.8000000000000012, -1.9000000000000012, -1.600000000000001, -1.5000000000000009, -1.700000000000001, -1.700000000000001, -1.8000000000000012, -1.5000000000000009, -1.700000000000001, -1.700000000000001, -1.700000000000001, -1.5000000000000009, -1.5000000000000009, -2.0000000000000013, -1.600000000000001, -1.600000000000001, -1.600000000000001, -1.8000000000000012, -1.4000000000000008, -1.5000000000000009, -1.4000000000000008, -1.8000000000000012, -1.5000000000000009, -1.8000000000000012, -1.600000000000001, -1.9000000000000012, -2.0000000000000013, -1.5000000000000009, -1.700000000000001, -1.4000000000000008, -2.0000000000000013, -1.9000000000000012, -1.8000000000000012, -1.4000000000000008, -1.9000000000000012, -2.1000000000000014, -1.5000000000000009, -2.0000000000000013, -1.4000000000000008, -6.999999999999994, -1.8000000000000012, -1.5000000000000009, -1.600000000000001, -1.600000000000001, -1.8000000000000012, -2.0000000000000013, -1.600000000000001, -1.8000000000000012, -1.600000000000001, -1.5000000000000009, -1.5000000000000009, -1.700000000000001, -1.600000000000001, -1.9000000000000012, -1.700000000000001, -2.2000000000000015, -1.600000000000001, -1.700000000000001, -1.600000000000001, -1.700000000000001, -1.700000000000001, -1.700000000000001, -1.600000000000001, -1.700000000000001, -1.5000000000000009, -4.099999999999998, -1.600000000000001, -1.9000000000000012, -1.600000000000001, -1.700000000000001, -1.5000000000000009, -1.700000000000001, -1.5000000000000009, -2.0000000000000013, -1.8000000000000012, -1.8000000000000012, -1.5000000000000009, -1.600000000000001, -1.8000000000000012, -1.600000000000001, -2.5000000000000018, -1.600000000000001, -1.600000000000001, -1.600000000000001, -1.700000000000001, -1.600000000000001, -1.4000000000000008, -1.5000000000000009, -1.600000000000001, -1.700000000000001, -1.600000000000001, -1.5000000000000009, -1.600000000000001, -1.4000000000000008, -1.9000000000000012, -1.5000000000000009, -1.700000000000001, -1.5000000000000009, -3.0000000000000018, -1.4000000000000008, -1.8000000000000012, -1.8000000000000012, -1.700000000000001, -1.600000000000001, -1.4000000000000008, -1.5000000000000009, -1.700000000000001, -1.600000000000001, -1.8000000000000012, -1.700000000000001], "episode_lengths": [29, 26, 28, 27, 28, 28, 27, 30, 30, 28, 25, 30, 29, 27, 28, 32, 51, 28, 28, 27, 30, 27, 27, 41, 27, 26, 31, 25, 29, 30, 27, 26, 28, 28, 29, 26, 28, 28, 28, 26, 26, 31, 27, 27, 27, 29, 25, 26, 25, 29, 26, 29, 27, 30, 31, 26, 28, 25, 31, 30, 29, 25, 30, 32, 26, 31, 25, 70, 29, 26, 27, 27, 29, 30, 27, 29, 27, 26, 26, 28, 27, 30, 28, 33, 27, 28, 27, 28, 28, 28, 27, 28, 26, 48, 27, 30, 27, 28, 26, 28, 26, 31, 29, 29, 26, 27, 29, 27, 36, 27, 27, 27, 28, 27, 25, 26, 27, 28, 27, 26, 27, 25, 30, 26, 28, 26, 36, 25, 29, 29, 28, 27, 25, 26, 28, 27, 29, 28]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.36925622938498276, "mean_inference_ms": 0.7284233694916458, "mean_action_processing_ms": 0.07659207633134874, "mean_env_wait_ms": 7.169565659888577, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006839157878488734, "StateBufferConnector_ms": 0.004110992818638898, "ViewRequirementAgentConnector_ms": 0.09122378584267436}}, "episode_reward_max": -1.4000000000000008, "episode_reward_min": -6.999999999999994, "episode_reward_mean": -1.7826086956521747, "episode_len_mean": 28.55072463768116, "episodes_this_iter": 138, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1.8000000000000012, -1.5000000000000009, -1.700000000000001, -1.600000000000001, -1.700000000000001, -1.700000000000001, -1.600000000000001, -1.9000000000000012, -1.9000000000000012, -1.700000000000001, -1.4000000000000008, -1.9000000000000012, -1.8000000000000012, -1.600000000000001, -1.700000000000001, -2.1000000000000014, -4.399999999999997, -1.700000000000001, -1.700000000000001, -1.600000000000001, -1.9000000000000012, -1.600000000000001, -1.600000000000001, -4.3000000000000025, -1.600000000000001, -1.5000000000000009, -2.0000000000000013, -1.4000000000000008, -1.8000000000000012, -1.9000000000000012, -1.600000000000001, -1.5000000000000009, -1.700000000000001, -1.700000000000001, -1.8000000000000012, -1.5000000000000009, -1.700000000000001, -1.700000000000001, -1.700000000000001, -1.5000000000000009, -1.5000000000000009, -2.0000000000000013, -1.600000000000001, -1.600000000000001, -1.600000000000001, -1.8000000000000012, -1.4000000000000008, -1.5000000000000009, -1.4000000000000008, -1.8000000000000012, -1.5000000000000009, -1.8000000000000012, -1.600000000000001, -1.9000000000000012, -2.0000000000000013, -1.5000000000000009, -1.700000000000001, -1.4000000000000008, -2.0000000000000013, -1.9000000000000012, -1.8000000000000012, -1.4000000000000008, -1.9000000000000012, -2.1000000000000014, -1.5000000000000009, -2.0000000000000013, -1.4000000000000008, -6.999999999999994, -1.8000000000000012, -1.5000000000000009, -1.600000000000001, -1.600000000000001, -1.8000000000000012, -2.0000000000000013, -1.600000000000001, -1.8000000000000012, -1.600000000000001, -1.5000000000000009, -1.5000000000000009, -1.700000000000001, -1.600000000000001, -1.9000000000000012, -1.700000000000001, -2.2000000000000015, -1.600000000000001, -1.700000000000001, -1.600000000000001, -1.700000000000001, -1.700000000000001, -1.700000000000001, -1.600000000000001, -1.700000000000001, -1.5000000000000009, -4.099999999999998, -1.600000000000001, -1.9000000000000012, -1.600000000000001, -1.700000000000001, -1.5000000000000009, -1.700000000000001, -1.5000000000000009, -2.0000000000000013, -1.8000000000000012, -1.8000000000000012, -1.5000000000000009, -1.600000000000001, -1.8000000000000012, -1.600000000000001, -2.5000000000000018, -1.600000000000001, -1.600000000000001, -1.600000000000001, -1.700000000000001, -1.600000000000001, -1.4000000000000008, -1.5000000000000009, -1.600000000000001, -1.700000000000001, -1.600000000000001, -1.5000000000000009, -1.600000000000001, -1.4000000000000008, -1.9000000000000012, -1.5000000000000009, -1.700000000000001, -1.5000000000000009, -3.0000000000000018, -1.4000000000000008, -1.8000000000000012, -1.8000000000000012, -1.700000000000001, -1.600000000000001, -1.4000000000000008, -1.5000000000000009, -1.700000000000001, -1.600000000000001, -1.8000000000000012, -1.700000000000001], "episode_lengths": [29, 26, 28, 27, 28, 28, 27, 30, 30, 28, 25, 30, 29, 27, 28, 32, 51, 28, 28, 27, 30, 27, 27, 41, 27, 26, 31, 25, 29, 30, 27, 26, 28, 28, 29, 26, 28, 28, 28, 26, 26, 31, 27, 27, 27, 29, 25, 26, 25, 29, 26, 29, 27, 30, 31, 26, 28, 25, 31, 30, 29, 25, 30, 32, 26, 31, 25, 70, 29, 26, 27, 27, 29, 30, 27, 29, 27, 26, 26, 28, 27, 30, 28, 33, 27, 28, 27, 28, 28, 28, 27, 28, 26, 48, 27, 30, 27, 28, 26, 28, 26, 31, 29, 29, 26, 27, 29, 27, 36, 27, 27, 27, 28, 27, 25, 26, 27, 28, 27, 26, 27, 25, 30, 26, 28, 26, 36, 25, 29, 29, 28, 27, 25, 26, 28, 27, 29, 28]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.36925622938498276, "mean_inference_ms": 0.7284233694916458, "mean_action_processing_ms": 0.07659207633134874, "mean_env_wait_ms": 7.169565659888577, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006839157878488734, "StateBufferConnector_ms": 0.004110992818638898, "ViewRequirementAgentConnector_ms": 0.09122378584267436}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 192000, "num_agent_steps_trained": 192000, "num_env_steps_sampled": 192000, "num_env_steps_trained": 192000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 498.8316245366459, "num_env_steps_trained_throughput_per_sec": 498.8316245366459, "timesteps_total": 192000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 192000, "timers": {"training_iteration_time_ms": 8105.534, "sample_time_ms": 4613.804, "load_time_ms": 0.964, "load_throughput": 4148155.767, "learn_time_ms": 3487.132, "learn_throughput": 1147.074, "synch_weights_time_ms": 2.956}, "counters": {"num_env_steps_sampled": 192000, "num_env_steps_trained": 192000, "num_agent_steps_sampled": 192000, "num_agent_steps_trained": 192000}, "done": false, "episodes_total": 4431, "training_iteration": 48, "trial_id": "133f9_00000", "date": "2024-03-07_13-17-33", "timestamp": 1709835453, "time_this_iter_s": 8.021800994873047, "time_total_s": 375.426913022995, "pid": 117779, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7efea6399f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 375.426913022995, "iterations_since_restore": 48, "perf": {"cpu_util_percent": 30.499999999999996, "ram_util_percent": 50.8, "gpu_util_percent0": 0.08363636363636363, "vram_util_percent0": 0.09164151278409091}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.3, "cur_lr": 0.0010000000000000005, "total_loss": 0.03700767676008024, "policy_loss": -0.005202102909485499, "vf_loss": 0.04001262948663044, "vf_explained_var": 0.9685288068427834, "kl": 0.007323833689443252, "entropy": 0.18646904443220425, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 45105.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 196000, "num_env_steps_trained": 196000, "num_agent_steps_sampled": 196000, "num_agent_steps_trained": 196000}, "sampler_results": {"episode_reward_max": -1.4000000000000008, "episode_reward_min": -4.000000000000001, "episode_reward_mean": -1.7450704225352125, "episode_len_mean": 28.359154929577464, "episode_media": {}, "episodes_this_iter": 142, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1.5000000000000009, -1.8000000000000012, -1.4000000000000008, -1.700000000000001, -1.5000000000000009, -1.700000000000001, -1.9000000000000012, -2.0000000000000013, -1.700000000000001, -1.600000000000001, -1.8000000000000012, -4.000000000000001, -1.700000000000001, -2.2000000000000015, -1.600000000000001, -1.700000000000001, -2.0000000000000013, -1.600000000000001, -1.700000000000001, -1.8000000000000012, -1.9000000000000012, -1.600000000000001, -1.700000000000001, -1.700000000000001, -1.700000000000001, -1.4000000000000008, -1.600000000000001, -1.8000000000000012, -1.600000000000001, -1.600000000000001, -1.5000000000000009, -2.2000000000000015, -1.9000000000000012, -2.0000000000000013, -1.5000000000000009, -1.5000000000000009, -1.600000000000001, -1.700000000000001, -1.700000000000001, -1.5000000000000009, -1.600000000000001, -1.5000000000000009, -1.600000000000001, -1.8000000000000012, -1.700000000000001, -1.5000000000000009, -1.5000000000000009, -1.600000000000001, -1.9000000000000012, -2.800000000000002, -1.4000000000000008, -1.9000000000000012, -1.700000000000001, -1.8000000000000012, -2.1000000000000014, -2.1000000000000014, -1.5000000000000009, -2.4000000000000017, -1.600000000000001, -2.1000000000000014, -2.4000000000000017, -1.700000000000001, -1.9000000000000012, -1.600000000000001, -2.2000000000000015, -1.8000000000000012, -1.5000000000000009, -1.5000000000000009, -1.600000000000001, -1.9000000000000012, -1.8000000000000012, -1.8000000000000012, -1.4000000000000008, -1.9000000000000012, -1.5000000000000009, -1.5000000000000009, -1.700000000000001, -1.5000000000000009, -1.8000000000000012, -1.700000000000001, -1.700000000000001, -1.8000000000000012, -1.700000000000001, -1.700000000000001, -1.4000000000000008, -1.700000000000001, -1.700000000000001, -1.600000000000001, -1.8000000000000012, -2.0000000000000013, -1.5000000000000009, -2.0000000000000013, -1.8000000000000012, -1.700000000000001, -1.600000000000001, -1.600000000000001, -1.5000000000000009, -1.4000000000000008, -1.700000000000001, -1.600000000000001, -1.8000000000000012, -1.600000000000001, -1.5000000000000009, -1.600000000000001, -2.0000000000000013, -1.700000000000001, -2.600000000000002, -1.600000000000001, -1.8000000000000012, -1.600000000000001, -1.9000000000000012, -1.700000000000001, -1.5000000000000009, -1.5000000000000009, -1.9000000000000012, -1.700000000000001, -1.700000000000001, -1.9000000000000012, -1.5000000000000009, -1.8000000000000012, -1.5000000000000009, -1.600000000000001, -1.700000000000001, -2.2000000000000015, -1.700000000000001, -1.700000000000001, -1.9000000000000012, -1.700000000000001, -1.600000000000001, -1.700000000000001, -2.1000000000000014, -2.1000000000000014, -1.5000000000000009, -1.700000000000001, -1.700000000000001, -1.5000000000000009, -1.9000000000000012, -1.5000000000000009, -1.5000000000000009, -2.0000000000000013, -1.8000000000000012, -1.4000000000000008], "episode_lengths": [26, 29, 25, 28, 26, 28, 30, 31, 28, 27, 29, 42, 28, 33, 27, 28, 31, 27, 28, 29, 30, 27, 28, 28, 28, 25, 27, 29, 27, 27, 26, 33, 30, 31, 26, 26, 27, 28, 28, 26, 27, 26, 27, 29, 28, 26, 26, 27, 30, 39, 25, 30, 28, 29, 32, 32, 26, 35, 27, 32, 35, 28, 30, 27, 33, 29, 26, 26, 27, 30, 29, 29, 25, 30, 26, 26, 28, 26, 29, 28, 28, 29, 28, 28, 25, 28, 28, 27, 29, 31, 26, 31, 29, 28, 27, 27, 26, 25, 28, 27, 29, 27, 26, 27, 31, 28, 33, 27, 29, 27, 30, 28, 26, 26, 30, 28, 28, 30, 26, 29, 26, 27, 28, 33, 28, 28, 30, 28, 27, 28, 32, 32, 26, 28, 28, 26, 30, 26, 26, 31, 29, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.370897785659536, "mean_inference_ms": 0.7283676917634315, "mean_action_processing_ms": 0.07657203008027064, "mean_env_wait_ms": 7.179850884382034, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006751443298769669, "StateBufferConnector_ms": 0.004094419345049791, "ViewRequirementAgentConnector_ms": 0.09129450354777591}}, "episode_reward_max": -1.4000000000000008, "episode_reward_min": -4.000000000000001, "episode_reward_mean": -1.7450704225352125, "episode_len_mean": 28.359154929577464, "episodes_this_iter": 142, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1.5000000000000009, -1.8000000000000012, -1.4000000000000008, -1.700000000000001, -1.5000000000000009, -1.700000000000001, -1.9000000000000012, -2.0000000000000013, -1.700000000000001, -1.600000000000001, -1.8000000000000012, -4.000000000000001, -1.700000000000001, -2.2000000000000015, -1.600000000000001, -1.700000000000001, -2.0000000000000013, -1.600000000000001, -1.700000000000001, -1.8000000000000012, -1.9000000000000012, -1.600000000000001, -1.700000000000001, -1.700000000000001, -1.700000000000001, -1.4000000000000008, -1.600000000000001, -1.8000000000000012, -1.600000000000001, -1.600000000000001, -1.5000000000000009, -2.2000000000000015, -1.9000000000000012, -2.0000000000000013, -1.5000000000000009, -1.5000000000000009, -1.600000000000001, -1.700000000000001, -1.700000000000001, -1.5000000000000009, -1.600000000000001, -1.5000000000000009, -1.600000000000001, -1.8000000000000012, -1.700000000000001, -1.5000000000000009, -1.5000000000000009, -1.600000000000001, -1.9000000000000012, -2.800000000000002, -1.4000000000000008, -1.9000000000000012, -1.700000000000001, -1.8000000000000012, -2.1000000000000014, -2.1000000000000014, -1.5000000000000009, -2.4000000000000017, -1.600000000000001, -2.1000000000000014, -2.4000000000000017, -1.700000000000001, -1.9000000000000012, -1.600000000000001, -2.2000000000000015, -1.8000000000000012, -1.5000000000000009, -1.5000000000000009, -1.600000000000001, -1.9000000000000012, -1.8000000000000012, -1.8000000000000012, -1.4000000000000008, -1.9000000000000012, -1.5000000000000009, -1.5000000000000009, -1.700000000000001, -1.5000000000000009, -1.8000000000000012, -1.700000000000001, -1.700000000000001, -1.8000000000000012, -1.700000000000001, -1.700000000000001, -1.4000000000000008, -1.700000000000001, -1.700000000000001, -1.600000000000001, -1.8000000000000012, -2.0000000000000013, -1.5000000000000009, -2.0000000000000013, -1.8000000000000012, -1.700000000000001, -1.600000000000001, -1.600000000000001, -1.5000000000000009, -1.4000000000000008, -1.700000000000001, -1.600000000000001, -1.8000000000000012, -1.600000000000001, -1.5000000000000009, -1.600000000000001, -2.0000000000000013, -1.700000000000001, -2.600000000000002, -1.600000000000001, -1.8000000000000012, -1.600000000000001, -1.9000000000000012, -1.700000000000001, -1.5000000000000009, -1.5000000000000009, -1.9000000000000012, -1.700000000000001, -1.700000000000001, -1.9000000000000012, -1.5000000000000009, -1.8000000000000012, -1.5000000000000009, -1.600000000000001, -1.700000000000001, -2.2000000000000015, -1.700000000000001, -1.700000000000001, -1.9000000000000012, -1.700000000000001, -1.600000000000001, -1.700000000000001, -2.1000000000000014, -2.1000000000000014, -1.5000000000000009, -1.700000000000001, -1.700000000000001, -1.5000000000000009, -1.9000000000000012, -1.5000000000000009, -1.5000000000000009, -2.0000000000000013, -1.8000000000000012, -1.4000000000000008], "episode_lengths": [26, 29, 25, 28, 26, 28, 30, 31, 28, 27, 29, 42, 28, 33, 27, 28, 31, 27, 28, 29, 30, 27, 28, 28, 28, 25, 27, 29, 27, 27, 26, 33, 30, 31, 26, 26, 27, 28, 28, 26, 27, 26, 27, 29, 28, 26, 26, 27, 30, 39, 25, 30, 28, 29, 32, 32, 26, 35, 27, 32, 35, 28, 30, 27, 33, 29, 26, 26, 27, 30, 29, 29, 25, 30, 26, 26, 28, 26, 29, 28, 28, 29, 28, 28, 25, 28, 28, 27, 29, 31, 26, 31, 29, 28, 27, 27, 26, 25, 28, 27, 29, 27, 26, 27, 31, 28, 33, 27, 29, 27, 30, 28, 26, 26, 30, 28, 28, 30, 26, 29, 26, 27, 28, 33, 28, 28, 30, 28, 27, 28, 32, 32, 26, 28, 28, 26, 30, 26, 26, 31, 29, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.370897785659536, "mean_inference_ms": 0.7283676917634315, "mean_action_processing_ms": 0.07657203008027064, "mean_env_wait_ms": 7.179850884382034, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006751443298769669, "StateBufferConnector_ms": 0.004094419345049791, "ViewRequirementAgentConnector_ms": 0.09129450354777591}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 196000, "num_agent_steps_trained": 196000, "num_env_steps_sampled": 196000, "num_env_steps_trained": 196000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 502.1663483257755, "num_env_steps_trained_throughput_per_sec": 502.1663483257755, "timesteps_total": 196000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 196000, "timers": {"training_iteration_time_ms": 8104.125, "sample_time_ms": 4616.369, "load_time_ms": 0.957, "load_throughput": 4179258.669, "learn_time_ms": 3483.24, "learn_throughput": 1148.356, "synch_weights_time_ms": 2.883}, "counters": {"num_env_steps_sampled": 196000, "num_env_steps_trained": 196000, "num_agent_steps_sampled": 196000, "num_agent_steps_trained": 196000}, "done": false, "episodes_total": 4573, "training_iteration": 49, "trial_id": "133f9_00000", "date": "2024-03-07_13-17-41", "timestamp": 1709835461, "time_this_iter_s": 7.968419551849365, "time_total_s": 383.39533257484436, "pid": 117779, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7efea6399f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 383.39533257484436, "iterations_since_restore": 49, "perf": {"cpu_util_percent": 32.54, "ram_util_percent": 50.79, "gpu_util_percent0": 0.088, "vram_util_percent0": 0.09164225260416667}}
{"evaluation": {"sampler_results": {"episode_reward_max": -1.5000000000000009, "episode_reward_min": -2.2000000000000015, "episode_reward_mean": -1.750000000000001, "episode_len_mean": 28.5, "episode_media": {}, "episodes_this_iter": 20, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1.600000000000001, -1.600000000000001, -1.700000000000001, -1.8000000000000012, -2.1000000000000014, -1.9000000000000012, -1.600000000000001, -1.9000000000000012, -1.8000000000000012, -2.2000000000000015, -1.8000000000000012, -1.700000000000001, -1.5000000000000009, -1.5000000000000009, -1.8000000000000012, -1.5000000000000009, -1.8000000000000012, -1.700000000000001, -1.600000000000001, -1.9000000000000012], "episode_lengths": [27, 27, 28, 29, 32, 30, 27, 30, 29, 33, 29, 28, 26, 26, 29, 26, 29, 28, 27, 30]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37351715168059396, "mean_inference_ms": 1.0723971652483566, "mean_action_processing_ms": 0.06580436292337663, "mean_env_wait_ms": 7.041082699536861, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004270076751708984, "StateBufferConnector_ms": 0.0029027462005615234, "ViewRequirementAgentConnector_ms": 0.06469488143920898}}, "episode_reward_max": -1.5000000000000009, "episode_reward_min": -2.2000000000000015, "episode_reward_mean": -1.750000000000001, "episode_len_mean": 28.5, "episode_media": {}, "episodes_this_iter": 20, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1.600000000000001, -1.600000000000001, -1.700000000000001, -1.8000000000000012, -2.1000000000000014, -1.9000000000000012, -1.600000000000001, -1.9000000000000012, -1.8000000000000012, -2.2000000000000015, -1.8000000000000012, -1.700000000000001, -1.5000000000000009, -1.5000000000000009, -1.8000000000000012, -1.5000000000000009, -1.8000000000000012, -1.700000000000001, -1.600000000000001, -1.9000000000000012], "episode_lengths": [27, 27, 28, 29, 32, 30, 27, 30, 29, 33, 29, 28, 26, 26, 29, 26, 29, 28, 27, 30]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37351715168059396, "mean_inference_ms": 1.0723971652483566, "mean_action_processing_ms": 0.06580436292337663, "mean_env_wait_ms": 7.041082699536861, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004270076751708984, "StateBufferConnector_ms": 0.0029027462005615234, "ViewRequirementAgentConnector_ms": 0.06469488143920898}, "num_agent_steps_sampled_this_iter": 570, "num_env_steps_sampled_this_iter": 570, "timesteps_this_iter": 570, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.3, "cur_lr": 0.0010000000000000005, "total_loss": 0.17194466074848527, "policy_loss": -0.009888165932829662, "vf_loss": 0.17890570511370496, "vf_explained_var": 0.9103843255068667, "kl": 0.009757078767406027, "entropy": 0.19182176817488927, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 46035.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 200000, "num_env_steps_trained": 200000, "num_agent_steps_sampled": 200000, "num_agent_steps_trained": 200000}, "sampler_results": {"episode_reward_max": -1.4000000000000008, "episode_reward_min": -5.7999999999999945, "episode_reward_mean": -1.8042253521126772, "episode_len_mean": 28.676056338028168, "episode_media": {}, "episodes_this_iter": 142, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2.1000000000000014, -2.3000000000000016, -1.700000000000001, -1.700000000000001, -1.5000000000000009, -1.600000000000001, -1.8000000000000012, -2.2000000000000015, -4.800000000000003, -1.8000000000000012, -1.600000000000001, -1.600000000000001, -1.5000000000000009, -1.8000000000000012, -1.700000000000001, -1.8000000000000012, -1.700000000000001, -1.5000000000000009, -1.700000000000001, -1.8000000000000012, -1.5000000000000009, -1.9000000000000012, -1.600000000000001, -1.8000000000000012, -1.5000000000000009, -1.600000000000001, -1.8000000000000012, -2.1000000000000014, -1.600000000000001, -1.600000000000001, -1.700000000000001, -1.600000000000001, -1.4000000000000008, -1.700000000000001, -2.2000000000000015, -1.600000000000001, -1.600000000000001, -1.600000000000001, -2.0000000000000013, -1.4000000000000008, -1.700000000000001, -1.8000000000000012, -3.6000000000000014, -1.700000000000001, -1.700000000000001, -1.600000000000001, -1.600000000000001, -1.600000000000001, -2.2000000000000015, -1.600000000000001, -1.700000000000001, -1.5000000000000009, -1.600000000000001, -1.5000000000000009, -1.700000000000001, -2.0000000000000013, -1.8000000000000012, -1.5000000000000009, -1.5000000000000009, -1.600000000000001, -1.5000000000000009, -1.5000000000000009, -1.600000000000001, -1.5000000000000009, -1.8000000000000012, -3.200000000000001, -1.600000000000001, -1.600000000000001, -1.8000000000000012, -1.9000000000000012, -1.9000000000000012, -1.600000000000001, -1.700000000000001, -1.700000000000001, -1.5000000000000009, -1.8000000000000012, -1.600000000000001, -1.8000000000000012, -1.5000000000000009, -1.700000000000001, -1.9000000000000012, -1.600000000000001, -1.600000000000001, -1.600000000000001, -3.200000000000001, -1.600000000000001, -1.5000000000000009, -1.8000000000000012, -1.600000000000001, -1.9000000000000012, -1.5000000000000009, -2.2000000000000015, -1.9000000000000012, -3.0000000000000018, -4.100000000000002, -1.8000000000000012, -1.700000000000001, -1.5000000000000009, -1.700000000000001, -1.5000000000000009, -1.600000000000001, -1.9000000000000012, -1.9000000000000012, -1.5000000000000009, -2.5000000000000018, -1.700000000000001, -1.4000000000000008, -1.4000000000000008, -1.700000000000001, -1.700000000000001, -1.600000000000001, -1.700000000000001, -1.5000000000000009, -1.600000000000001, -1.5000000000000009, -2.1000000000000014, -1.700000000000001, -1.5000000000000009, -1.600000000000001, -1.600000000000001, -1.600000000000001, -1.8000000000000012, -1.600000000000001, -1.8000000000000012, -1.5000000000000009, -1.8000000000000012, -1.700000000000001, -1.600000000000001, -1.5000000000000009, -2.0000000000000013, -1.5000000000000009, -5.7999999999999945, -1.5000000000000009, -1.600000000000001, -1.8000000000000012, -1.700000000000001, -1.600000000000001, -1.9000000000000012, -1.9000000000000012, -1.600000000000001, -1.600000000000001, -1.600000000000001], "episode_lengths": [32, 34, 28, 28, 26, 27, 29, 33, 46, 29, 27, 27, 26, 29, 28, 29, 28, 26, 28, 29, 26, 30, 27, 29, 26, 27, 29, 32, 27, 27, 28, 27, 25, 28, 32, 27, 27, 27, 31, 25, 28, 29, 41, 28, 28, 27, 27, 27, 33, 27, 28, 26, 27, 26, 28, 31, 29, 26, 26, 27, 26, 26, 27, 26, 29, 39, 27, 27, 29, 30, 30, 27, 28, 28, 26, 29, 27, 29, 26, 28, 30, 27, 27, 27, 38, 27, 26, 29, 27, 30, 26, 33, 30, 35, 43, 29, 28, 26, 28, 26, 27, 30, 30, 26, 36, 28, 25, 25, 28, 28, 27, 28, 26, 27, 26, 32, 28, 26, 27, 27, 27, 29, 27, 29, 26, 29, 28, 27, 26, 31, 26, 61, 26, 27, 29, 28, 27, 30, 30, 27, 27, 27]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3728253779275451, "mean_inference_ms": 0.7288594278659315, "mean_action_processing_ms": 0.07663235882261452, "mean_env_wait_ms": 7.198224585560782, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0069415065604196465, "StateBufferConnector_ms": 0.004209934825628576, "ViewRequirementAgentConnector_ms": 0.09389460926324548}}, "episode_reward_max": -1.4000000000000008, "episode_reward_min": -5.7999999999999945, "episode_reward_mean": -1.8042253521126772, "episode_len_mean": 28.676056338028168, "episodes_this_iter": 142, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-2.1000000000000014, -2.3000000000000016, -1.700000000000001, -1.700000000000001, -1.5000000000000009, -1.600000000000001, -1.8000000000000012, -2.2000000000000015, -4.800000000000003, -1.8000000000000012, -1.600000000000001, -1.600000000000001, -1.5000000000000009, -1.8000000000000012, -1.700000000000001, -1.8000000000000012, -1.700000000000001, -1.5000000000000009, -1.700000000000001, -1.8000000000000012, -1.5000000000000009, -1.9000000000000012, -1.600000000000001, -1.8000000000000012, -1.5000000000000009, -1.600000000000001, -1.8000000000000012, -2.1000000000000014, -1.600000000000001, -1.600000000000001, -1.700000000000001, -1.600000000000001, -1.4000000000000008, -1.700000000000001, -2.2000000000000015, -1.600000000000001, -1.600000000000001, -1.600000000000001, -2.0000000000000013, -1.4000000000000008, -1.700000000000001, -1.8000000000000012, -3.6000000000000014, -1.700000000000001, -1.700000000000001, -1.600000000000001, -1.600000000000001, -1.600000000000001, -2.2000000000000015, -1.600000000000001, -1.700000000000001, -1.5000000000000009, -1.600000000000001, -1.5000000000000009, -1.700000000000001, -2.0000000000000013, -1.8000000000000012, -1.5000000000000009, -1.5000000000000009, -1.600000000000001, -1.5000000000000009, -1.5000000000000009, -1.600000000000001, -1.5000000000000009, -1.8000000000000012, -3.200000000000001, -1.600000000000001, -1.600000000000001, -1.8000000000000012, -1.9000000000000012, -1.9000000000000012, -1.600000000000001, -1.700000000000001, -1.700000000000001, -1.5000000000000009, -1.8000000000000012, -1.600000000000001, -1.8000000000000012, -1.5000000000000009, -1.700000000000001, -1.9000000000000012, -1.600000000000001, -1.600000000000001, -1.600000000000001, -3.200000000000001, -1.600000000000001, -1.5000000000000009, -1.8000000000000012, -1.600000000000001, -1.9000000000000012, -1.5000000000000009, -2.2000000000000015, -1.9000000000000012, -3.0000000000000018, -4.100000000000002, -1.8000000000000012, -1.700000000000001, -1.5000000000000009, -1.700000000000001, -1.5000000000000009, -1.600000000000001, -1.9000000000000012, -1.9000000000000012, -1.5000000000000009, -2.5000000000000018, -1.700000000000001, -1.4000000000000008, -1.4000000000000008, -1.700000000000001, -1.700000000000001, -1.600000000000001, -1.700000000000001, -1.5000000000000009, -1.600000000000001, -1.5000000000000009, -2.1000000000000014, -1.700000000000001, -1.5000000000000009, -1.600000000000001, -1.600000000000001, -1.600000000000001, -1.8000000000000012, -1.600000000000001, -1.8000000000000012, -1.5000000000000009, -1.8000000000000012, -1.700000000000001, -1.600000000000001, -1.5000000000000009, -2.0000000000000013, -1.5000000000000009, -5.7999999999999945, -1.5000000000000009, -1.600000000000001, -1.8000000000000012, -1.700000000000001, -1.600000000000001, -1.9000000000000012, -1.9000000000000012, -1.600000000000001, -1.600000000000001, -1.600000000000001], "episode_lengths": [32, 34, 28, 28, 26, 27, 29, 33, 46, 29, 27, 27, 26, 29, 28, 29, 28, 26, 28, 29, 26, 30, 27, 29, 26, 27, 29, 32, 27, 27, 28, 27, 25, 28, 32, 27, 27, 27, 31, 25, 28, 29, 41, 28, 28, 27, 27, 27, 33, 27, 28, 26, 27, 26, 28, 31, 29, 26, 26, 27, 26, 26, 27, 26, 29, 39, 27, 27, 29, 30, 30, 27, 28, 28, 26, 29, 27, 29, 26, 28, 30, 27, 27, 27, 38, 27, 26, 29, 27, 30, 26, 33, 30, 35, 43, 29, 28, 26, 28, 26, 27, 30, 30, 26, 36, 28, 25, 25, 28, 28, 27, 28, 26, 27, 26, 32, 28, 26, 27, 27, 27, 29, 27, 29, 26, 29, 28, 27, 26, 31, 26, 61, 26, 27, 29, 28, 27, 30, 30, 27, 27, 27]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3728253779275451, "mean_inference_ms": 0.7288594278659315, "mean_action_processing_ms": 0.07663235882261452, "mean_env_wait_ms": 7.198224585560782, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0069415065604196465, "StateBufferConnector_ms": 0.004209934825628576, "ViewRequirementAgentConnector_ms": 0.09389460926324548}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 200000, "num_agent_steps_trained": 200000, "num_env_steps_sampled": 200000, "num_env_steps_trained": 200000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 464.9178458040021, "num_env_steps_trained_throughput_per_sec": 464.9178458040021, "timesteps_total": 200000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 200000, "timers": {"training_iteration_time_ms": 8146.41, "sample_time_ms": 4674.035, "load_time_ms": 0.958, "load_throughput": 4176033.852, "learn_time_ms": 3468.064, "learn_throughput": 1153.381, "synch_weights_time_ms": 2.706}, "counters": {"num_env_steps_sampled": 200000, "num_env_steps_trained": 200000, "num_agent_steps_sampled": 200000, "num_agent_steps_trained": 200000}, "done": true, "episodes_total": 4715, "training_iteration": 50, "trial_id": "133f9_00000", "date": "2024-03-07_13-17-55", "timestamp": 1709835475, "time_this_iter_s": 13.502103328704834, "time_total_s": 396.8974359035492, "pid": 117779, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7efea6399f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 396.8974359035492, "iterations_since_restore": 50, "perf": {"cpu_util_percent": 23.91176470588235, "ram_util_percent": 50.83529411764705, "gpu_util_percent0": 0.04764705882352942, "vram_util_percent0": 0.09166283700980393}}
