{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 7.594263047140132, "policy_loss": 0.00429395536982244, "vf_loss": 7.5887363637206695, "vf_explained_var": 0.0015162659588680472, "kl": 0.006163805962267095, "entropy": 1.0924175430369634, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 465.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000}, "sampler_results": {"episode_reward_max": -9.29999999999998, "episode_reward_min": -67.20000000000041, "episode_reward_mean": -40.60000000000022, "episode_len_mean": 308.45454545454544, "episode_media": {}, "episodes_this_iter": 11, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-51.40000000000042, -57.70000000000028, -9.29999999999998, -67.20000000000041, -19.90000000000002, -42.30000000000025, -59.50000000000041, -53.40000000000032, -48.30000000000031, -16.19999999999997, -21.40000000000001], "episode_lengths": [400, 400, 104, 400, 182, 368, 400, 400, 400, 142, 197]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19722631847855182, "mean_inference_ms": 0.6185816263440151, "mean_action_processing_ms": 0.06851622935114868, "mean_env_wait_ms": 6.115907523214369, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00670823183926669, "StateBufferConnector_ms": 0.0034223903309215198, "ViewRequirementAgentConnector_ms": 0.07489811290394176}}, "episode_reward_max": -9.29999999999998, "episode_reward_min": -67.20000000000041, "episode_reward_mean": -40.60000000000022, "episode_len_mean": 308.45454545454544, "episodes_this_iter": 11, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-51.40000000000042, -57.70000000000028, -9.29999999999998, -67.20000000000041, -19.90000000000002, -42.30000000000025, -59.50000000000041, -53.40000000000032, -48.30000000000031, -16.19999999999997, -21.40000000000001], "episode_lengths": [400, 400, 104, 400, 182, 368, 400, 400, 400, 142, 197]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19722631847855182, "mean_inference_ms": 0.6185816263440151, "mean_action_processing_ms": 0.06851622935114868, "mean_env_wait_ms": 6.115907523214369, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00670823183926669, "StateBufferConnector_ms": 0.0034223903309215198, "ViewRequirementAgentConnector_ms": 0.07489811290394176}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 375.4762659398555, "num_env_steps_trained_throughput_per_sec": 375.4762659398555, "timesteps_total": 4000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 4000, "timers": {"training_iteration_time_ms": 10653.077, "sample_time_ms": 7110.972, "load_time_ms": 1.247, "load_throughput": 3207880.688, "learn_time_ms": 3535.379, "learn_throughput": 1131.42, "synch_weights_time_ms": 1.661}, "counters": {"num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000}, "done": false, "episodes_total": 11, "training_iteration": 1, "trial_id": "83204_00000", "date": "2024-03-07_12-03-00", "timestamp": 1709830980, "time_this_iter_s": 10.655012607574463, "time_total_s": 10.655012607574463, "pid": 102666, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fcd19c36f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 10.655012607574463, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 19.507142857142856, "ram_util_percent": 43.72142857142858, "gpu_util_percent0": 0.07571428571428572, "vram_util_percent0": 0.10928199404761905}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 5.160696568460234, "policy_loss": -0.01004583217924641, "vf_loss": 5.1695181540423825, "vf_explained_var": -0.023884594312278174, "kl": 0.006121203601956128, "entropy": 1.0911082060106339, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 1395.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000}, "sampler_results": {"episode_reward_max": -9.29999999999998, "episode_reward_min": -69.30000000000048, "episode_reward_mean": -46.936363636363915, "episode_len_mean": 342.27272727272725, "episode_media": {}, "episodes_this_iter": 11, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-51.40000000000042, -57.70000000000028, -9.29999999999998, -67.20000000000041, -19.90000000000002, -42.30000000000025, -59.50000000000041, -53.40000000000032, -48.30000000000031, -16.19999999999997, -21.40000000000001, -59.40000000000039, -57.10000000000026, -60.50000000000036, -49.30000000000033, -19.3, -55.60000000000047, -52.90000000000033, -69.30000000000048, -52.100000000000286, -51.80000000000036, -58.70000000000037], "episode_lengths": [400, 400, 104, 400, 182, 368, 400, 400, 400, 142, 197, 400, 400, 400, 400, 170, 400, 400, 400, 367, 400, 400]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1966378407375133, "mean_inference_ms": 0.6185855025728294, "mean_action_processing_ms": 0.06815014811809544, "mean_env_wait_ms": 6.136069094102624, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006633455103093927, "StateBufferConnector_ms": 0.0033747066151012073, "ViewRequirementAgentConnector_ms": 0.07448629899458452}}, "episode_reward_max": -9.29999999999998, "episode_reward_min": -69.30000000000048, "episode_reward_mean": -46.936363636363915, "episode_len_mean": 342.27272727272725, "episodes_this_iter": 11, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-51.40000000000042, -57.70000000000028, -9.29999999999998, -67.20000000000041, -19.90000000000002, -42.30000000000025, -59.50000000000041, -53.40000000000032, -48.30000000000031, -16.19999999999997, -21.40000000000001, -59.40000000000039, -57.10000000000026, -60.50000000000036, -49.30000000000033, -19.3, -55.60000000000047, -52.90000000000033, -69.30000000000048, -52.100000000000286, -51.80000000000036, -58.70000000000037], "episode_lengths": [400, 400, 104, 400, 182, 368, 400, 400, 400, 142, 197, 400, 400, 400, 400, 170, 400, 400, 400, 367, 400, 400]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1966378407375133, "mean_inference_ms": 0.6185855025728294, "mean_action_processing_ms": 0.06815014811809544, "mean_env_wait_ms": 6.136069094102624, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006633455103093927, "StateBufferConnector_ms": 0.0033747066151012073, "ViewRequirementAgentConnector_ms": 0.07448629899458452}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 378.34727715018886, "num_env_steps_trained_throughput_per_sec": 378.34727715018886, "timesteps_total": 8000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 8000, "timers": {"training_iteration_time_ms": 10612.668, "sample_time_ms": 7129.049, "load_time_ms": 1.084, "load_throughput": 3688516.214, "learn_time_ms": 3478.667, "learn_throughput": 1149.866, "synch_weights_time_ms": 1.652}, "counters": {"num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000}, "done": false, "episodes_total": 22, "training_iteration": 2, "trial_id": "83204_00000", "date": "2024-03-07_12-03-11", "timestamp": 1709830991, "time_this_iter_s": 10.574390888214111, "time_total_s": 21.229403495788574, "pid": 102666, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fcd19c36f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 21.229403495788574, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 19.599999999999998, "ram_util_percent": 44.10000000000001, "gpu_util_percent0": 0.08214285714285714, "vram_util_percent0": 0.10986328125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 5.114802130896558, "policy_loss": -0.009290421910343632, "vf_loss": 5.122772989510208, "vf_explained_var": -0.020032428926037203, "kl": 0.006597748946065729, "entropy": 1.0788959181436928, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 2325.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000}, "sampler_results": {"episode_reward_max": -9.29999999999998, "episode_reward_min": -69.70000000000044, "episode_reward_mean": -48.169696969697256, "episode_len_mean": 346.42424242424244, "episode_media": {}, "episodes_this_iter": 11, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-51.40000000000042, -57.70000000000028, -9.29999999999998, -67.20000000000041, -19.90000000000002, -42.30000000000025, -59.50000000000041, -53.40000000000032, -48.30000000000031, -16.19999999999997, -21.40000000000001, -59.40000000000039, -57.10000000000026, -60.50000000000036, -49.30000000000033, -19.3, -55.60000000000047, -52.90000000000033, -69.30000000000048, -52.100000000000286, -51.80000000000036, -58.70000000000037, -57.600000000000286, -64.00000000000058, -69.70000000000044, -21.899999999999995, -60.900000000000404, -55.20000000000035, -57.90000000000034, -34.20000000000012, -52.70000000000037, -58.60000000000035, -24.30000000000009], "episode_lengths": [400, 400, 104, 400, 182, 368, 400, 400, 400, 142, 197, 400, 400, 400, 400, 170, 400, 400, 400, 367, 400, 400, 400, 400, 400, 174, 400, 400, 400, 294, 400, 400, 234]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19655326055362193, "mean_inference_ms": 0.6189406657525025, "mean_action_processing_ms": 0.06805153650818224, "mean_env_wait_ms": 6.146682071492932, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0066945047089547825, "StateBufferConnector_ms": 0.0033804864594430633, "ViewRequirementAgentConnector_ms": 0.07530342448841441}}, "episode_reward_max": -9.29999999999998, "episode_reward_min": -69.70000000000044, "episode_reward_mean": -48.169696969697256, "episode_len_mean": 346.42424242424244, "episodes_this_iter": 11, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-51.40000000000042, -57.70000000000028, -9.29999999999998, -67.20000000000041, -19.90000000000002, -42.30000000000025, -59.50000000000041, -53.40000000000032, -48.30000000000031, -16.19999999999997, -21.40000000000001, -59.40000000000039, -57.10000000000026, -60.50000000000036, -49.30000000000033, -19.3, -55.60000000000047, -52.90000000000033, -69.30000000000048, -52.100000000000286, -51.80000000000036, -58.70000000000037, -57.600000000000286, -64.00000000000058, -69.70000000000044, -21.899999999999995, -60.900000000000404, -55.20000000000035, -57.90000000000034, -34.20000000000012, -52.70000000000037, -58.60000000000035, -24.30000000000009], "episode_lengths": [400, 400, 104, 400, 182, 368, 400, 400, 400, 142, 197, 400, 400, 400, 400, 170, 400, 400, 400, 367, 400, 400, 400, 400, 400, 174, 400, 400, 400, 294, 400, 400, 234]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19655326055362193, "mean_inference_ms": 0.6189406657525025, "mean_action_processing_ms": 0.06805153650818224, "mean_env_wait_ms": 6.146682071492932, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0066945047089547825, "StateBufferConnector_ms": 0.0033804864594430633, "ViewRequirementAgentConnector_ms": 0.07530342448841441}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 370.6162632681598, "num_env_steps_trained_throughput_per_sec": 370.6162632681598, "timesteps_total": 12000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 12000, "timers": {"training_iteration_time_ms": 10672.709, "sample_time_ms": 7200.744, "load_time_ms": 1.024, "load_throughput": 3905007.991, "learn_time_ms": 3467.634, "learn_throughput": 1153.524, "synch_weights_time_ms": 1.636}, "counters": {"num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000}, "done": false, "episodes_total": 33, "training_iteration": 3, "trial_id": "83204_00000", "date": "2024-03-07_12-03-21", "timestamp": 1709831001, "time_this_iter_s": 10.794692039489746, "time_total_s": 32.02409553527832, "pid": 102666, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fcd19c36f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 32.02409553527832, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 19.342857142857145, "ram_util_percent": 44.12142857142858, "gpu_util_percent0": 0.07428571428571429, "vram_util_percent0": 0.10986328125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 3.8369140504188435, "policy_loss": -0.012808499997982415, "vf_loss": 3.848520571450072, "vf_explained_var": -0.08216238278214649, "kl": 0.006009880285063711, "entropy": 1.079574751853943, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 3255.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000}, "sampler_results": {"episode_reward_max": -6.599999999999995, "episode_reward_min": -69.70000000000044, "episode_reward_mean": -46.62000000000027, "episode_len_mean": 337.2888888888889, "episode_media": {}, "episodes_this_iter": 12, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-51.40000000000042, -57.70000000000028, -9.29999999999998, -67.20000000000041, -19.90000000000002, -42.30000000000025, -59.50000000000041, -53.40000000000032, -48.30000000000031, -16.19999999999997, -21.40000000000001, -59.40000000000039, -57.10000000000026, -60.50000000000036, -49.30000000000033, -19.3, -55.60000000000047, -52.90000000000033, -69.30000000000048, -52.100000000000286, -51.80000000000036, -58.70000000000037, -57.600000000000286, -64.00000000000058, -69.70000000000044, -21.899999999999995, -60.900000000000404, -55.20000000000035, -57.90000000000034, -34.20000000000012, -52.70000000000037, -58.60000000000035, -24.30000000000009, -59.70000000000033, -36.40000000000001, -50.300000000000374, -16.899999999999967, -60.50000000000039, -50.50000000000033, -47.60000000000016, -10.799999999999974, -61.000000000000384, -6.599999999999995, -52.800000000000345, -55.200000000000415], "episode_lengths": [400, 400, 104, 400, 182, 368, 400, 400, 400, 142, 197, 400, 400, 400, 400, 170, 400, 400, 400, 367, 400, 400, 400, 400, 400, 174, 400, 400, 400, 294, 400, 400, 234, 400, 289, 400, 146, 400, 400, 325, 116, 400, 70, 400, 400]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19646380317582057, "mean_inference_ms": 0.6193115203072916, "mean_action_processing_ms": 0.06798096361356999, "mean_env_wait_ms": 6.151671911417225, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006433592902289497, "StateBufferConnector_ms": 0.0033124287923177085, "ViewRequirementAgentConnector_ms": 0.07515271504720052}}, "episode_reward_max": -6.599999999999995, "episode_reward_min": -69.70000000000044, "episode_reward_mean": -46.62000000000027, "episode_len_mean": 337.2888888888889, "episodes_this_iter": 12, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-51.40000000000042, -57.70000000000028, -9.29999999999998, -67.20000000000041, -19.90000000000002, -42.30000000000025, -59.50000000000041, -53.40000000000032, -48.30000000000031, -16.19999999999997, -21.40000000000001, -59.40000000000039, -57.10000000000026, -60.50000000000036, -49.30000000000033, -19.3, -55.60000000000047, -52.90000000000033, -69.30000000000048, -52.100000000000286, -51.80000000000036, -58.70000000000037, -57.600000000000286, -64.00000000000058, -69.70000000000044, -21.899999999999995, -60.900000000000404, -55.20000000000035, -57.90000000000034, -34.20000000000012, -52.70000000000037, -58.60000000000035, -24.30000000000009, -59.70000000000033, -36.40000000000001, -50.300000000000374, -16.899999999999967, -60.50000000000039, -50.50000000000033, -47.60000000000016, -10.799999999999974, -61.000000000000384, -6.599999999999995, -52.800000000000345, -55.200000000000415], "episode_lengths": [400, 400, 104, 400, 182, 368, 400, 400, 400, 142, 197, 400, 400, 400, 400, 170, 400, 400, 400, 367, 400, 400, 400, 400, 400, 174, 400, 400, 400, 294, 400, 400, 234, 400, 289, 400, 146, 400, 400, 325, 116, 400, 70, 400, 400]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19646380317582057, "mean_inference_ms": 0.6193115203072916, "mean_action_processing_ms": 0.06798096361356999, "mean_env_wait_ms": 6.151671911417225, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006433592902289497, "StateBufferConnector_ms": 0.0033124287923177085, "ViewRequirementAgentConnector_ms": 0.07515271504720052}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 381.1738312504717, "num_env_steps_trained_throughput_per_sec": 381.1738312504717, "timesteps_total": 16000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 16000, "timers": {"training_iteration_time_ms": 10627.998, "sample_time_ms": 7165.324, "load_time_ms": 1.007, "load_throughput": 3971643.724, "learn_time_ms": 3458.623, "learn_throughput": 1156.53, "synch_weights_time_ms": 1.643}, "counters": {"num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000}, "done": false, "episodes_total": 45, "training_iteration": 4, "trial_id": "83204_00000", "date": "2024-03-07_12-03-32", "timestamp": 1709831012, "time_this_iter_s": 10.495922088623047, "time_total_s": 42.52001762390137, "pid": 102666, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fcd19c36f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 42.52001762390137, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 19.428571428571434, "ram_util_percent": 44.114285714285714, "gpu_util_percent0": 0.08857142857142856, "vram_util_percent0": 0.10986328125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 5.138425046654158, "policy_loss": -0.013633903083942269, "vf_loss": 5.15070678514819, "vf_explained_var": -0.057155713791488316, "kl": 0.006760946228500279, "entropy": 1.063217979861844, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 4185.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 20000}, "sampler_results": {"episode_reward_max": -6.599999999999995, "episode_reward_min": -69.70000000000044, "episode_reward_mean": -43.139344262295324, "episode_len_mean": 322.1475409836066, "episode_media": {}, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-51.40000000000042, -57.70000000000028, -9.29999999999998, -67.20000000000041, -19.90000000000002, -42.30000000000025, -59.50000000000041, -53.40000000000032, -48.30000000000031, -16.19999999999997, -21.40000000000001, -59.40000000000039, -57.10000000000026, -60.50000000000036, -49.30000000000033, -19.3, -55.60000000000047, -52.90000000000033, -69.30000000000048, -52.100000000000286, -51.80000000000036, -58.70000000000037, -57.600000000000286, -64.00000000000058, -69.70000000000044, -21.899999999999995, -60.900000000000404, -55.20000000000035, -57.90000000000034, -34.20000000000012, -52.70000000000037, -58.60000000000035, -24.30000000000009, -59.70000000000033, -36.40000000000001, -50.300000000000374, -16.899999999999967, -60.50000000000039, -50.50000000000033, -47.60000000000016, -10.799999999999974, -61.000000000000384, -6.599999999999995, -52.800000000000345, -55.200000000000415, -49.5000000000003, -47.70000000000027, -12.699999999999974, -49.900000000000425, -48.50000000000033, -8.299999999999983, -25.300000000000008, -46.100000000000286, -51.40000000000032, -10.999999999999973, -9.699999999999978, -16.59999999999997, -9.499999999999984, -42.900000000000176, -50.40000000000035, -54.10000000000031], "episode_lengths": [400, 400, 104, 400, 182, 368, 400, 400, 400, 142, 197, 400, 400, 400, 400, 170, 400, 400, 400, 367, 400, 400, 400, 400, 400, 174, 400, 400, 400, 294, 400, 400, 234, 400, 289, 400, 146, 400, 400, 325, 116, 400, 70, 400, 400, 400, 400, 111, 400, 400, 93, 221, 400, 400, 112, 106, 159, 97, 374, 400, 400]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19680616342404758, "mean_inference_ms": 0.6193992148200106, "mean_action_processing_ms": 0.06787298524040182, "mean_env_wait_ms": 6.150747653560681, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0061437731883564935, "StateBufferConnector_ms": 0.0032596900814869365, "ViewRequirementAgentConnector_ms": 0.07460977210373175}}, "episode_reward_max": -6.599999999999995, "episode_reward_min": -69.70000000000044, "episode_reward_mean": -43.139344262295324, "episode_len_mean": 322.1475409836066, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-51.40000000000042, -57.70000000000028, -9.29999999999998, -67.20000000000041, -19.90000000000002, -42.30000000000025, -59.50000000000041, -53.40000000000032, -48.30000000000031, -16.19999999999997, -21.40000000000001, -59.40000000000039, -57.10000000000026, -60.50000000000036, -49.30000000000033, -19.3, -55.60000000000047, -52.90000000000033, -69.30000000000048, -52.100000000000286, -51.80000000000036, -58.70000000000037, -57.600000000000286, -64.00000000000058, -69.70000000000044, -21.899999999999995, -60.900000000000404, -55.20000000000035, -57.90000000000034, -34.20000000000012, -52.70000000000037, -58.60000000000035, -24.30000000000009, -59.70000000000033, -36.40000000000001, -50.300000000000374, -16.899999999999967, -60.50000000000039, -50.50000000000033, -47.60000000000016, -10.799999999999974, -61.000000000000384, -6.599999999999995, -52.800000000000345, -55.200000000000415, -49.5000000000003, -47.70000000000027, -12.699999999999974, -49.900000000000425, -48.50000000000033, -8.299999999999983, -25.300000000000008, -46.100000000000286, -51.40000000000032, -10.999999999999973, -9.699999999999978, -16.59999999999997, -9.499999999999984, -42.900000000000176, -50.40000000000035, -54.10000000000031], "episode_lengths": [400, 400, 104, 400, 182, 368, 400, 400, 400, 142, 197, 400, 400, 400, 400, 170, 400, 400, 400, 367, 400, 400, 400, 400, 400, 174, 400, 400, 400, 294, 400, 400, 234, 400, 289, 400, 146, 400, 400, 325, 116, 400, 70, 400, 400, 400, 400, 111, 400, 400, 93, 221, 400, 400, 112, 106, 159, 97, 374, 400, 400]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19680616342404758, "mean_inference_ms": 0.6193992148200106, "mean_action_processing_ms": 0.06787298524040182, "mean_env_wait_ms": 6.150747653560681, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0061437731883564935, "StateBufferConnector_ms": 0.0032596900814869365, "ViewRequirementAgentConnector_ms": 0.07460977210373175}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 20000, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 380.7888949161467, "num_env_steps_trained_throughput_per_sec": 380.7888949161467, "timesteps_total": 20000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 20000, "timers": {"training_iteration_time_ms": 10603.294, "sample_time_ms": 7137.112, "load_time_ms": 1.039, "load_throughput": 3849751.262, "learn_time_ms": 3462.247, "learn_throughput": 1155.319, "synch_weights_time_ms": 1.657}, "counters": {"num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 20000}, "done": false, "episodes_total": 61, "training_iteration": 5, "trial_id": "83204_00000", "date": "2024-03-07_12-03-42", "timestamp": 1709831022, "time_this_iter_s": 10.506307601928711, "time_total_s": 53.02632522583008, "pid": 102666, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fcd19c36f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 53.02632522583008, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 20.46153846153846, "ram_util_percent": 44.12307692307692, "gpu_util_percent0": 0.08, "vram_util_percent0": 0.10986328125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 4.517604894086879, "policy_loss": -0.01177739085609554, "vf_loss": 4.528171445893985, "vf_explained_var": -0.1601227202723103, "kl": 0.006054238099164586, "entropy": 1.0453860470043717, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 5115.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000}, "sampler_results": {"episode_reward_max": -6.599999999999995, "episode_reward_min": -69.70000000000044, "episode_reward_mean": -41.88108108108132, "episode_len_mean": 318.2162162162162, "episode_media": {}, "episodes_this_iter": 13, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-51.40000000000042, -57.70000000000028, -9.29999999999998, -67.20000000000041, -19.90000000000002, -42.30000000000025, -59.50000000000041, -53.40000000000032, -48.30000000000031, -16.19999999999997, -21.40000000000001, -59.40000000000039, -57.10000000000026, -60.50000000000036, -49.30000000000033, -19.3, -55.60000000000047, -52.90000000000033, -69.30000000000048, -52.100000000000286, -51.80000000000036, -58.70000000000037, -57.600000000000286, -64.00000000000058, -69.70000000000044, -21.899999999999995, -60.900000000000404, -55.20000000000035, -57.90000000000034, -34.20000000000012, -52.70000000000037, -58.60000000000035, -24.30000000000009, -59.70000000000033, -36.40000000000001, -50.300000000000374, -16.899999999999967, -60.50000000000039, -50.50000000000033, -47.60000000000016, -10.799999999999974, -61.000000000000384, -6.599999999999995, -52.800000000000345, -55.200000000000415, -49.5000000000003, -47.70000000000027, -12.699999999999974, -49.900000000000425, -48.50000000000033, -8.299999999999983, -25.300000000000008, -46.100000000000286, -51.40000000000032, -10.999999999999973, -9.699999999999978, -16.59999999999997, -9.499999999999984, -42.900000000000176, -50.40000000000035, -54.10000000000031, -47.7000000000003, -44.00000000000032, -10.799999999999974, -11.89999999999997, -52.40000000000034, -47.90000000000035, -42.90000000000012, -38.600000000000236, -46.700000000000266, -40.2000000000003, -65.20000000000029, -10.599999999999987, -8.799999999999981], "episode_lengths": [400, 400, 104, 400, 182, 368, 400, 400, 400, 142, 197, 400, 400, 400, 400, 170, 400, 400, 400, 367, 400, 400, 400, 400, 400, 174, 400, 400, 400, 294, 400, 400, 234, 400, 289, 400, 146, 400, 400, 325, 116, 400, 70, 400, 400, 400, 400, 111, 400, 400, 93, 221, 400, 400, 112, 106, 159, 97, 374, 400, 400, 400, 400, 119, 130, 400, 400, 313, 336, 400, 400, 400, 100, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19700880554471853, "mean_inference_ms": 0.6195346808660186, "mean_action_processing_ms": 0.06782280238487236, "mean_env_wait_ms": 6.147591437436157, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0061257465465648754, "StateBufferConnector_ms": 0.00321897300514015, "ViewRequirementAgentConnector_ms": 0.07428059706816802}}, "episode_reward_max": -6.599999999999995, "episode_reward_min": -69.70000000000044, "episode_reward_mean": -41.88108108108132, "episode_len_mean": 318.2162162162162, "episodes_this_iter": 13, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-51.40000000000042, -57.70000000000028, -9.29999999999998, -67.20000000000041, -19.90000000000002, -42.30000000000025, -59.50000000000041, -53.40000000000032, -48.30000000000031, -16.19999999999997, -21.40000000000001, -59.40000000000039, -57.10000000000026, -60.50000000000036, -49.30000000000033, -19.3, -55.60000000000047, -52.90000000000033, -69.30000000000048, -52.100000000000286, -51.80000000000036, -58.70000000000037, -57.600000000000286, -64.00000000000058, -69.70000000000044, -21.899999999999995, -60.900000000000404, -55.20000000000035, -57.90000000000034, -34.20000000000012, -52.70000000000037, -58.60000000000035, -24.30000000000009, -59.70000000000033, -36.40000000000001, -50.300000000000374, -16.899999999999967, -60.50000000000039, -50.50000000000033, -47.60000000000016, -10.799999999999974, -61.000000000000384, -6.599999999999995, -52.800000000000345, -55.200000000000415, -49.5000000000003, -47.70000000000027, -12.699999999999974, -49.900000000000425, -48.50000000000033, -8.299999999999983, -25.300000000000008, -46.100000000000286, -51.40000000000032, -10.999999999999973, -9.699999999999978, -16.59999999999997, -9.499999999999984, -42.900000000000176, -50.40000000000035, -54.10000000000031, -47.7000000000003, -44.00000000000032, -10.799999999999974, -11.89999999999997, -52.40000000000034, -47.90000000000035, -42.90000000000012, -38.600000000000236, -46.700000000000266, -40.2000000000003, -65.20000000000029, -10.599999999999987, -8.799999999999981], "episode_lengths": [400, 400, 104, 400, 182, 368, 400, 400, 400, 142, 197, 400, 400, 400, 400, 170, 400, 400, 400, 367, 400, 400, 400, 400, 400, 174, 400, 400, 400, 294, 400, 400, 234, 400, 289, 400, 146, 400, 400, 325, 116, 400, 70, 400, 400, 400, 400, 111, 400, 400, 93, 221, 400, 400, 112, 106, 159, 97, 374, 400, 400, 400, 400, 119, 130, 400, 400, 313, 336, 400, 400, 400, 100, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19700880554471853, "mean_inference_ms": 0.6195346808660186, "mean_action_processing_ms": 0.06782280238487236, "mean_env_wait_ms": 6.147591437436157, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0061257465465648754, "StateBufferConnector_ms": 0.00321897300514015, "ViewRequirementAgentConnector_ms": 0.07428059706816802}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 380.9489901405485, "num_env_steps_trained_throughput_per_sec": 380.9489901405485, "timesteps_total": 24000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 24000, "timers": {"training_iteration_time_ms": 10586.088, "sample_time_ms": 7120.738, "load_time_ms": 1.065, "load_throughput": 3755532.607, "learn_time_ms": 3461.477, "learn_throughput": 1155.576, "synch_weights_time_ms": 1.662}, "counters": {"num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000}, "done": false, "episodes_total": 74, "training_iteration": 6, "trial_id": "83204_00000", "date": "2024-03-07_12-03-53", "timestamp": 1709831033, "time_this_iter_s": 10.501939296722412, "time_total_s": 63.52826452255249, "pid": 102666, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fcd19c36f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 63.52826452255249, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 20.05, "ram_util_percent": 44.10000000000001, "gpu_util_percent0": 0.08357142857142856, "vram_util_percent0": 0.10986328125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 4.606376872428002, "policy_loss": -0.013060650353630384, "vf_loss": 4.618157359765422, "vf_explained_var": -0.013678268463380876, "kl": 0.00640074898530113, "entropy": 1.028381895698527, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 6045.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 28000}, "sampler_results": {"episode_reward_max": -5.199999999999994, "episode_reward_min": -69.70000000000044, "episode_reward_mean": -40.035955056179986, "episode_len_mean": 310.438202247191, "episode_media": {}, "episodes_this_iter": 15, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-51.40000000000042, -57.70000000000028, -9.29999999999998, -67.20000000000041, -19.90000000000002, -42.30000000000025, -59.50000000000041, -53.40000000000032, -48.30000000000031, -16.19999999999997, -21.40000000000001, -59.40000000000039, -57.10000000000026, -60.50000000000036, -49.30000000000033, -19.3, -55.60000000000047, -52.90000000000033, -69.30000000000048, -52.100000000000286, -51.80000000000036, -58.70000000000037, -57.600000000000286, -64.00000000000058, -69.70000000000044, -21.899999999999995, -60.900000000000404, -55.20000000000035, -57.90000000000034, -34.20000000000012, -52.70000000000037, -58.60000000000035, -24.30000000000009, -59.70000000000033, -36.40000000000001, -50.300000000000374, -16.899999999999967, -60.50000000000039, -50.50000000000033, -47.60000000000016, -10.799999999999974, -61.000000000000384, -6.599999999999995, -52.800000000000345, -55.200000000000415, -49.5000000000003, -47.70000000000027, -12.699999999999974, -49.900000000000425, -48.50000000000033, -8.299999999999983, -25.300000000000008, -46.100000000000286, -51.40000000000032, -10.999999999999973, -9.699999999999978, -16.59999999999997, -9.499999999999984, -42.900000000000176, -50.40000000000035, -54.10000000000031, -47.7000000000003, -44.00000000000032, -10.799999999999974, -11.89999999999997, -52.40000000000034, -47.90000000000035, -42.90000000000012, -38.600000000000236, -46.700000000000266, -40.2000000000003, -65.20000000000029, -10.599999999999987, -8.799999999999981, -20.900000000000023, -41.70000000000027, -11.299999999999972, -41.40000000000032, -25.500000000000025, -46.0000000000003, -54.00000000000021, -52.00000000000022, -15.499999999999964, -31.0000000000001, -5.199999999999994, -11.79999999999997, -51.60000000000029, -18.3, -37.80000000000015], "episode_lengths": [400, 400, 104, 400, 182, 368, 400, 400, 400, 142, 197, 400, 400, 400, 400, 170, 400, 400, 400, 367, 400, 400, 400, 400, 400, 174, 400, 400, 400, 294, 400, 400, 234, 400, 289, 400, 146, 400, 400, 325, 116, 400, 70, 400, 400, 400, 400, 111, 400, 400, 93, 221, 400, 400, 112, 106, 159, 97, 374, 400, 400, 400, 400, 119, 130, 400, 400, 313, 336, 400, 400, 400, 100, 99, 215, 400, 124, 400, 214, 400, 400, 400, 166, 290, 63, 113, 400, 190, 306]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1972496255930181, "mean_inference_ms": 0.6195798106487291, "mean_action_processing_ms": 0.06778558936228002, "mean_env_wait_ms": 6.142214435178108, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0059883246261082336, "StateBufferConnector_ms": 0.0032151682992999473, "ViewRequirementAgentConnector_ms": 0.07432471500353867}}, "episode_reward_max": -5.199999999999994, "episode_reward_min": -69.70000000000044, "episode_reward_mean": -40.035955056179986, "episode_len_mean": 310.438202247191, "episodes_this_iter": 15, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-51.40000000000042, -57.70000000000028, -9.29999999999998, -67.20000000000041, -19.90000000000002, -42.30000000000025, -59.50000000000041, -53.40000000000032, -48.30000000000031, -16.19999999999997, -21.40000000000001, -59.40000000000039, -57.10000000000026, -60.50000000000036, -49.30000000000033, -19.3, -55.60000000000047, -52.90000000000033, -69.30000000000048, -52.100000000000286, -51.80000000000036, -58.70000000000037, -57.600000000000286, -64.00000000000058, -69.70000000000044, -21.899999999999995, -60.900000000000404, -55.20000000000035, -57.90000000000034, -34.20000000000012, -52.70000000000037, -58.60000000000035, -24.30000000000009, -59.70000000000033, -36.40000000000001, -50.300000000000374, -16.899999999999967, -60.50000000000039, -50.50000000000033, -47.60000000000016, -10.799999999999974, -61.000000000000384, -6.599999999999995, -52.800000000000345, -55.200000000000415, -49.5000000000003, -47.70000000000027, -12.699999999999974, -49.900000000000425, -48.50000000000033, -8.299999999999983, -25.300000000000008, -46.100000000000286, -51.40000000000032, -10.999999999999973, -9.699999999999978, -16.59999999999997, -9.499999999999984, -42.900000000000176, -50.40000000000035, -54.10000000000031, -47.7000000000003, -44.00000000000032, -10.799999999999974, -11.89999999999997, -52.40000000000034, -47.90000000000035, -42.90000000000012, -38.600000000000236, -46.700000000000266, -40.2000000000003, -65.20000000000029, -10.599999999999987, -8.799999999999981, -20.900000000000023, -41.70000000000027, -11.299999999999972, -41.40000000000032, -25.500000000000025, -46.0000000000003, -54.00000000000021, -52.00000000000022, -15.499999999999964, -31.0000000000001, -5.199999999999994, -11.79999999999997, -51.60000000000029, -18.3, -37.80000000000015], "episode_lengths": [400, 400, 104, 400, 182, 368, 400, 400, 400, 142, 197, 400, 400, 400, 400, 170, 400, 400, 400, 367, 400, 400, 400, 400, 400, 174, 400, 400, 400, 294, 400, 400, 234, 400, 289, 400, 146, 400, 400, 325, 116, 400, 70, 400, 400, 400, 400, 111, 400, 400, 93, 221, 400, 400, 112, 106, 159, 97, 374, 400, 400, 400, 400, 119, 130, 400, 400, 313, 336, 400, 400, 400, 100, 99, 215, 400, 124, 400, 214, 400, 400, 400, 166, 290, 63, 113, 400, 190, 306]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1972496255930181, "mean_inference_ms": 0.6195798106487291, "mean_action_processing_ms": 0.06778558936228002, "mean_env_wait_ms": 6.142214435178108, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0059883246261082336, "StateBufferConnector_ms": 0.0032151682992999473, "ViewRequirementAgentConnector_ms": 0.07432471500353867}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 28000, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 382.12495454964954, "num_env_steps_trained_throughput_per_sec": 382.12495454964954, "timesteps_total": 28000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 28000, "timers": {"training_iteration_time_ms": 10569.167, "sample_time_ms": 7096.271, "load_time_ms": 1.051, "load_throughput": 3805960.139, "learn_time_ms": 3467.34, "learn_throughput": 1153.622, "synch_weights_time_ms": 3.401}, "counters": {"num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 28000}, "done": false, "episodes_total": 89, "training_iteration": 7, "trial_id": "83204_00000", "date": "2024-03-07_12-04-03", "timestamp": 1709831043, "time_this_iter_s": 10.470266342163086, "time_total_s": 73.99853086471558, "pid": 102666, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fcd19c36f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 73.99853086471558, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 19.107142857142858, "ram_util_percent": 44.10000000000001, "gpu_util_percent0": 0.08785714285714286, "vram_util_percent0": 0.10986328125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 4.557456835046891, "policy_loss": -0.0007136778525447333, "vf_loss": 4.557051767232598, "vf_explained_var": 0.027256214234136766, "kl": 0.005593763850484593, "entropy": 1.0249124991637404, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 6975.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000}, "sampler_results": {"episode_reward_max": -5.199999999999994, "episode_reward_min": -69.70000000000044, "episode_reward_mean": -37.877000000000194, "episode_len_mean": 300.89, "episode_media": {}, "episodes_this_iter": 15, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-19.90000000000002, -42.30000000000025, -59.50000000000041, -53.40000000000032, -48.30000000000031, -16.19999999999997, -21.40000000000001, -59.40000000000039, -57.10000000000026, -60.50000000000036, -49.30000000000033, -19.3, -55.60000000000047, -52.90000000000033, -69.30000000000048, -52.100000000000286, -51.80000000000036, -58.70000000000037, -57.600000000000286, -64.00000000000058, -69.70000000000044, -21.899999999999995, -60.900000000000404, -55.20000000000035, -57.90000000000034, -34.20000000000012, -52.70000000000037, -58.60000000000035, -24.30000000000009, -59.70000000000033, -36.40000000000001, -50.300000000000374, -16.899999999999967, -60.50000000000039, -50.50000000000033, -47.60000000000016, -10.799999999999974, -61.000000000000384, -6.599999999999995, -52.800000000000345, -55.200000000000415, -49.5000000000003, -47.70000000000027, -12.699999999999974, -49.900000000000425, -48.50000000000033, -8.299999999999983, -25.300000000000008, -46.100000000000286, -51.40000000000032, -10.999999999999973, -9.699999999999978, -16.59999999999997, -9.499999999999984, -42.900000000000176, -50.40000000000035, -54.10000000000031, -47.7000000000003, -44.00000000000032, -10.799999999999974, -11.89999999999997, -52.40000000000034, -47.90000000000035, -42.90000000000012, -38.600000000000236, -46.700000000000266, -40.2000000000003, -65.20000000000029, -10.599999999999987, -8.799999999999981, -20.900000000000023, -41.70000000000027, -11.299999999999972, -41.40000000000032, -25.500000000000025, -46.0000000000003, -54.00000000000021, -52.00000000000022, -15.499999999999964, -31.0000000000001, -5.199999999999994, -11.79999999999997, -51.60000000000029, -18.3, -37.80000000000015, -19.49999999999995, -37.00000000000022, -9.199999999999985, -40.90000000000023, -33.70000000000006, -42.70000000000019, -29.20000000000013, -41.50000000000027, -34.10000000000011, -7.499999999999986, -22.40000000000001, -42.30000000000026, -11.999999999999973, -20.10000000000003, -17.999999999999975], "episode_lengths": [182, 368, 400, 400, 400, 142, 197, 400, 400, 400, 400, 170, 400, 400, 400, 367, 400, 400, 400, 400, 400, 174, 400, 400, 400, 294, 400, 400, 234, 400, 289, 400, 146, 400, 400, 325, 116, 400, 70, 400, 400, 400, 400, 111, 400, 400, 93, 221, 400, 400, 112, 106, 159, 97, 374, 400, 400, 400, 400, 119, 130, 400, 400, 313, 336, 400, 400, 400, 100, 99, 215, 400, 124, 400, 214, 400, 400, 400, 166, 290, 63, 113, 400, 190, 306, 161, 346, 93, 360, 287, 363, 286, 400, 306, 86, 207, 400, 113, 192, 164]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1974337296819276, "mean_inference_ms": 0.6196362434729259, "mean_action_processing_ms": 0.06768483267204294, "mean_env_wait_ms": 6.139047615667555, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005811929702758789, "StateBufferConnector_ms": 0.0031957626342773438, "ViewRequirementAgentConnector_ms": 0.07425093650817871}}, "episode_reward_max": -5.199999999999994, "episode_reward_min": -69.70000000000044, "episode_reward_mean": -37.877000000000194, "episode_len_mean": 300.89, "episodes_this_iter": 15, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-19.90000000000002, -42.30000000000025, -59.50000000000041, -53.40000000000032, -48.30000000000031, -16.19999999999997, -21.40000000000001, -59.40000000000039, -57.10000000000026, -60.50000000000036, -49.30000000000033, -19.3, -55.60000000000047, -52.90000000000033, -69.30000000000048, -52.100000000000286, -51.80000000000036, -58.70000000000037, -57.600000000000286, -64.00000000000058, -69.70000000000044, -21.899999999999995, -60.900000000000404, -55.20000000000035, -57.90000000000034, -34.20000000000012, -52.70000000000037, -58.60000000000035, -24.30000000000009, -59.70000000000033, -36.40000000000001, -50.300000000000374, -16.899999999999967, -60.50000000000039, -50.50000000000033, -47.60000000000016, -10.799999999999974, -61.000000000000384, -6.599999999999995, -52.800000000000345, -55.200000000000415, -49.5000000000003, -47.70000000000027, -12.699999999999974, -49.900000000000425, -48.50000000000033, -8.299999999999983, -25.300000000000008, -46.100000000000286, -51.40000000000032, -10.999999999999973, -9.699999999999978, -16.59999999999997, -9.499999999999984, -42.900000000000176, -50.40000000000035, -54.10000000000031, -47.7000000000003, -44.00000000000032, -10.799999999999974, -11.89999999999997, -52.40000000000034, -47.90000000000035, -42.90000000000012, -38.600000000000236, -46.700000000000266, -40.2000000000003, -65.20000000000029, -10.599999999999987, -8.799999999999981, -20.900000000000023, -41.70000000000027, -11.299999999999972, -41.40000000000032, -25.500000000000025, -46.0000000000003, -54.00000000000021, -52.00000000000022, -15.499999999999964, -31.0000000000001, -5.199999999999994, -11.79999999999997, -51.60000000000029, -18.3, -37.80000000000015, -19.49999999999995, -37.00000000000022, -9.199999999999985, -40.90000000000023, -33.70000000000006, -42.70000000000019, -29.20000000000013, -41.50000000000027, -34.10000000000011, -7.499999999999986, -22.40000000000001, -42.30000000000026, -11.999999999999973, -20.10000000000003, -17.999999999999975], "episode_lengths": [182, 368, 400, 400, 400, 142, 197, 400, 400, 400, 400, 170, 400, 400, 400, 367, 400, 400, 400, 400, 400, 174, 400, 400, 400, 294, 400, 400, 234, 400, 289, 400, 146, 400, 400, 325, 116, 400, 70, 400, 400, 400, 400, 111, 400, 400, 93, 221, 400, 400, 112, 106, 159, 97, 374, 400, 400, 400, 400, 119, 130, 400, 400, 313, 336, 400, 400, 400, 100, 99, 215, 400, 124, 400, 214, 400, 400, 400, 166, 290, 63, 113, 400, 190, 306, 161, 346, 93, 360, 287, 363, 286, 400, 306, 86, 207, 400, 113, 192, 164]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1974337296819276, "mean_inference_ms": 0.6196362434729259, "mean_action_processing_ms": 0.06768483267204294, "mean_env_wait_ms": 6.139047615667555, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005811929702758789, "StateBufferConnector_ms": 0.0031957626342773438, "ViewRequirementAgentConnector_ms": 0.07425093650817871}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 382.1390633456415, "num_env_steps_trained_throughput_per_sec": 382.1390633456415, "timesteps_total": 32000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 32000, "timers": {"training_iteration_time_ms": 10556.441, "sample_time_ms": 7082.098, "load_time_ms": 1.038, "load_throughput": 3855169.553, "learn_time_ms": 3469.078, "learn_throughput": 1153.044, "synch_weights_time_ms": 3.186}, "counters": {"num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000}, "done": false, "episodes_total": 104, "training_iteration": 8, "trial_id": "83204_00000", "date": "2024-03-07_12-04-14", "timestamp": 1709831054, "time_this_iter_s": 10.469807863235474, "time_total_s": 84.46833872795105, "pid": 102666, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fcd19c36f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 84.46833872795105, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 20.12307692307692, "ram_util_percent": 44.16153846153846, "gpu_util_percent0": 0.07846153846153846, "vram_util_percent0": 0.10986328125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 5.147219433258939, "policy_loss": -0.011077134888018331, "vf_loss": 5.157133000031594, "vf_explained_var": -0.11870619430336901, "kl": 0.005817872316625869, "entropy": 1.038159341581406, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 7905.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000}, "sampler_results": {"episode_reward_max": -5.199999999999994, "episode_reward_min": -69.70000000000044, "episode_reward_mean": -33.882000000000154, "episode_len_mean": 279.62, "episode_media": {}, "episodes_this_iter": 18, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-57.600000000000286, -64.00000000000058, -69.70000000000044, -21.899999999999995, -60.900000000000404, -55.20000000000035, -57.90000000000034, -34.20000000000012, -52.70000000000037, -58.60000000000035, -24.30000000000009, -59.70000000000033, -36.40000000000001, -50.300000000000374, -16.899999999999967, -60.50000000000039, -50.50000000000033, -47.60000000000016, -10.799999999999974, -61.000000000000384, -6.599999999999995, -52.800000000000345, -55.200000000000415, -49.5000000000003, -47.70000000000027, -12.699999999999974, -49.900000000000425, -48.50000000000033, -8.299999999999983, -25.300000000000008, -46.100000000000286, -51.40000000000032, -10.999999999999973, -9.699999999999978, -16.59999999999997, -9.499999999999984, -42.900000000000176, -50.40000000000035, -54.10000000000031, -47.7000000000003, -44.00000000000032, -10.799999999999974, -11.89999999999997, -52.40000000000034, -47.90000000000035, -42.90000000000012, -38.600000000000236, -46.700000000000266, -40.2000000000003, -65.20000000000029, -10.599999999999987, -8.799999999999981, -20.900000000000023, -41.70000000000027, -11.299999999999972, -41.40000000000032, -25.500000000000025, -46.0000000000003, -54.00000000000021, -52.00000000000022, -15.499999999999964, -31.0000000000001, -5.199999999999994, -11.79999999999997, -51.60000000000029, -18.3, -37.80000000000015, -19.49999999999995, -37.00000000000022, -9.199999999999985, -40.90000000000023, -33.70000000000006, -42.70000000000019, -29.20000000000013, -41.50000000000027, -34.10000000000011, -7.499999999999986, -22.40000000000001, -42.30000000000026, -11.999999999999973, -20.10000000000003, -17.999999999999975, -19.299999999999955, -9.19999999999998, -5.199999999999994, -40.3000000000003, -6.899999999999988, -12.999999999999966, -29.80000000000004, -28.000000000000046, -29.800000000000125, -34.6000000000002, -48.000000000000206, -12.199999999999969, -25.600000000000065, -43.70000000000023, -33.70000000000014, -5.699999999999992, -53.80000000000037, -8.699999999999982], "episode_lengths": [400, 400, 400, 174, 400, 400, 400, 294, 400, 400, 234, 400, 289, 400, 146, 400, 400, 325, 116, 400, 70, 400, 400, 400, 400, 111, 400, 400, 93, 221, 400, 400, 112, 106, 159, 97, 374, 400, 400, 400, 400, 119, 130, 400, 400, 313, 336, 400, 400, 400, 100, 99, 215, 400, 124, 400, 214, 400, 400, 400, 166, 290, 63, 113, 400, 190, 306, 161, 346, 93, 360, 287, 363, 286, 400, 306, 86, 207, 400, 113, 192, 164, 186, 103, 63, 400, 80, 141, 250, 248, 274, 330, 398, 127, 252, 362, 319, 68, 400, 98]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19808470707034678, "mean_inference_ms": 0.6196412786204799, "mean_action_processing_ms": 0.0676426572072988, "mean_env_wait_ms": 6.127481141699154, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0057010650634765625, "StateBufferConnector_ms": 0.0031652450561523438, "ViewRequirementAgentConnector_ms": 0.07433891296386719}}, "episode_reward_max": -5.199999999999994, "episode_reward_min": -69.70000000000044, "episode_reward_mean": -33.882000000000154, "episode_len_mean": 279.62, "episodes_this_iter": 18, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-57.600000000000286, -64.00000000000058, -69.70000000000044, -21.899999999999995, -60.900000000000404, -55.20000000000035, -57.90000000000034, -34.20000000000012, -52.70000000000037, -58.60000000000035, -24.30000000000009, -59.70000000000033, -36.40000000000001, -50.300000000000374, -16.899999999999967, -60.50000000000039, -50.50000000000033, -47.60000000000016, -10.799999999999974, -61.000000000000384, -6.599999999999995, -52.800000000000345, -55.200000000000415, -49.5000000000003, -47.70000000000027, -12.699999999999974, -49.900000000000425, -48.50000000000033, -8.299999999999983, -25.300000000000008, -46.100000000000286, -51.40000000000032, -10.999999999999973, -9.699999999999978, -16.59999999999997, -9.499999999999984, -42.900000000000176, -50.40000000000035, -54.10000000000031, -47.7000000000003, -44.00000000000032, -10.799999999999974, -11.89999999999997, -52.40000000000034, -47.90000000000035, -42.90000000000012, -38.600000000000236, -46.700000000000266, -40.2000000000003, -65.20000000000029, -10.599999999999987, -8.799999999999981, -20.900000000000023, -41.70000000000027, -11.299999999999972, -41.40000000000032, -25.500000000000025, -46.0000000000003, -54.00000000000021, -52.00000000000022, -15.499999999999964, -31.0000000000001, -5.199999999999994, -11.79999999999997, -51.60000000000029, -18.3, -37.80000000000015, -19.49999999999995, -37.00000000000022, -9.199999999999985, -40.90000000000023, -33.70000000000006, -42.70000000000019, -29.20000000000013, -41.50000000000027, -34.10000000000011, -7.499999999999986, -22.40000000000001, -42.30000000000026, -11.999999999999973, -20.10000000000003, -17.999999999999975, -19.299999999999955, -9.19999999999998, -5.199999999999994, -40.3000000000003, -6.899999999999988, -12.999999999999966, -29.80000000000004, -28.000000000000046, -29.800000000000125, -34.6000000000002, -48.000000000000206, -12.199999999999969, -25.600000000000065, -43.70000000000023, -33.70000000000014, -5.699999999999992, -53.80000000000037, -8.699999999999982], "episode_lengths": [400, 400, 400, 174, 400, 400, 400, 294, 400, 400, 234, 400, 289, 400, 146, 400, 400, 325, 116, 400, 70, 400, 400, 400, 400, 111, 400, 400, 93, 221, 400, 400, 112, 106, 159, 97, 374, 400, 400, 400, 400, 119, 130, 400, 400, 313, 336, 400, 400, 400, 100, 99, 215, 400, 124, 400, 214, 400, 400, 400, 166, 290, 63, 113, 400, 190, 306, 161, 346, 93, 360, 287, 363, 286, 400, 306, 86, 207, 400, 113, 192, 164, 186, 103, 63, 400, 80, 141, 250, 248, 274, 330, 398, 127, 252, 362, 319, 68, 400, 98]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19808470707034678, "mean_inference_ms": 0.6196412786204799, "mean_action_processing_ms": 0.0676426572072988, "mean_env_wait_ms": 6.127481141699154, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0057010650634765625, "StateBufferConnector_ms": 0.0031652450561523438, "ViewRequirementAgentConnector_ms": 0.07433891296386719}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 381.54808372972514, "num_env_steps_trained_throughput_per_sec": 381.54808372972514, "timesteps_total": 36000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 36000, "timers": {"training_iteration_time_ms": 10548.345, "sample_time_ms": 7070.341, "load_time_ms": 1.03, "load_throughput": 3884414.077, "learn_time_ms": 3472.97, "learn_throughput": 1151.752, "synch_weights_time_ms": 3.015}, "counters": {"num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000}, "done": false, "episodes_total": 122, "training_iteration": 9, "trial_id": "83204_00000", "date": "2024-03-07_12-04-24", "timestamp": 1709831064, "time_this_iter_s": 10.486084699630737, "time_total_s": 94.95442342758179, "pid": 102666, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fcd19c36f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 94.95442342758179, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 19.135714285714283, "ram_util_percent": 44.2, "gpu_util_percent0": 0.075, "vram_util_percent0": 0.10986328125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 5.1915543740795504, "policy_loss": -0.012332821646404844, "vf_loss": 5.202356123155163, "vf_explained_var": -0.3431395144872768, "kl": 0.007655425155024011, "entropy": 1.0170815599861966, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 8835.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000}, "sampler_results": {"episode_reward_max": -5.199999999999994, "episode_reward_min": -65.20000000000029, "episode_reward_mean": -29.676000000000126, "episode_len_mean": 259.46, "episode_media": {}, "episodes_this_iter": 18, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10.799999999999974, -61.000000000000384, -6.599999999999995, -52.800000000000345, -55.200000000000415, -49.5000000000003, -47.70000000000027, -12.699999999999974, -49.900000000000425, -48.50000000000033, -8.299999999999983, -25.300000000000008, -46.100000000000286, -51.40000000000032, -10.999999999999973, -9.699999999999978, -16.59999999999997, -9.499999999999984, -42.900000000000176, -50.40000000000035, -54.10000000000031, -47.7000000000003, -44.00000000000032, -10.799999999999974, -11.89999999999997, -52.40000000000034, -47.90000000000035, -42.90000000000012, -38.600000000000236, -46.700000000000266, -40.2000000000003, -65.20000000000029, -10.599999999999987, -8.799999999999981, -20.900000000000023, -41.70000000000027, -11.299999999999972, -41.40000000000032, -25.500000000000025, -46.0000000000003, -54.00000000000021, -52.00000000000022, -15.499999999999964, -31.0000000000001, -5.199999999999994, -11.79999999999997, -51.60000000000029, -18.3, -37.80000000000015, -19.49999999999995, -37.00000000000022, -9.199999999999985, -40.90000000000023, -33.70000000000006, -42.70000000000019, -29.20000000000013, -41.50000000000027, -34.10000000000011, -7.499999999999986, -22.40000000000001, -42.30000000000026, -11.999999999999973, -20.10000000000003, -17.999999999999975, -19.299999999999955, -9.19999999999998, -5.199999999999994, -40.3000000000003, -6.899999999999988, -12.999999999999966, -29.80000000000004, -28.000000000000046, -29.800000000000125, -34.6000000000002, -48.000000000000206, -12.199999999999969, -25.600000000000065, -43.70000000000023, -33.70000000000014, -5.699999999999992, -53.80000000000037, -8.699999999999982, -54.80000000000029, -10.299999999999976, -45.00000000000038, -11.399999999999972, -40.70000000000028, -6.599999999999989, -28.000000000000043, -15.19999999999996, -9.59999999999998, -42.7000000000003, -27.800000000000132, -10.099999999999978, -44.3000000000003, -20.599999999999945, -23.30000000000003, -26.000000000000107, -21.50000000000005, -20.400000000000027], "episode_lengths": [116, 400, 70, 400, 400, 400, 400, 111, 400, 400, 93, 221, 400, 400, 112, 106, 159, 97, 374, 400, 400, 400, 400, 119, 130, 400, 400, 313, 336, 400, 400, 400, 100, 99, 215, 400, 124, 400, 214, 400, 400, 400, 166, 290, 63, 113, 400, 190, 306, 161, 346, 93, 360, 287, 363, 286, 400, 306, 86, 207, 400, 113, 192, 164, 186, 103, 63, 400, 80, 141, 250, 248, 274, 330, 398, 127, 252, 362, 319, 68, 400, 98, 400, 114, 400, 125, 387, 77, 255, 146, 97, 400, 279, 97, 400, 177, 207, 268, 222, 195]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19864052906245036, "mean_inference_ms": 0.6191924163660913, "mean_action_processing_ms": 0.0675227985927137, "mean_env_wait_ms": 6.111155247539191, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005448579788208008, "StateBufferConnector_ms": 0.0031363964080810547, "ViewRequirementAgentConnector_ms": 0.07367897033691406}}, "episode_reward_max": -5.199999999999994, "episode_reward_min": -65.20000000000029, "episode_reward_mean": -29.676000000000126, "episode_len_mean": 259.46, "episodes_this_iter": 18, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10.799999999999974, -61.000000000000384, -6.599999999999995, -52.800000000000345, -55.200000000000415, -49.5000000000003, -47.70000000000027, -12.699999999999974, -49.900000000000425, -48.50000000000033, -8.299999999999983, -25.300000000000008, -46.100000000000286, -51.40000000000032, -10.999999999999973, -9.699999999999978, -16.59999999999997, -9.499999999999984, -42.900000000000176, -50.40000000000035, -54.10000000000031, -47.7000000000003, -44.00000000000032, -10.799999999999974, -11.89999999999997, -52.40000000000034, -47.90000000000035, -42.90000000000012, -38.600000000000236, -46.700000000000266, -40.2000000000003, -65.20000000000029, -10.599999999999987, -8.799999999999981, -20.900000000000023, -41.70000000000027, -11.299999999999972, -41.40000000000032, -25.500000000000025, -46.0000000000003, -54.00000000000021, -52.00000000000022, -15.499999999999964, -31.0000000000001, -5.199999999999994, -11.79999999999997, -51.60000000000029, -18.3, -37.80000000000015, -19.49999999999995, -37.00000000000022, -9.199999999999985, -40.90000000000023, -33.70000000000006, -42.70000000000019, -29.20000000000013, -41.50000000000027, -34.10000000000011, -7.499999999999986, -22.40000000000001, -42.30000000000026, -11.999999999999973, -20.10000000000003, -17.999999999999975, -19.299999999999955, -9.19999999999998, -5.199999999999994, -40.3000000000003, -6.899999999999988, -12.999999999999966, -29.80000000000004, -28.000000000000046, -29.800000000000125, -34.6000000000002, -48.000000000000206, -12.199999999999969, -25.600000000000065, -43.70000000000023, -33.70000000000014, -5.699999999999992, -53.80000000000037, -8.699999999999982, -54.80000000000029, -10.299999999999976, -45.00000000000038, -11.399999999999972, -40.70000000000028, -6.599999999999989, -28.000000000000043, -15.19999999999996, -9.59999999999998, -42.7000000000003, -27.800000000000132, -10.099999999999978, -44.3000000000003, -20.599999999999945, -23.30000000000003, -26.000000000000107, -21.50000000000005, -20.400000000000027], "episode_lengths": [116, 400, 70, 400, 400, 400, 400, 111, 400, 400, 93, 221, 400, 400, 112, 106, 159, 97, 374, 400, 400, 400, 400, 119, 130, 400, 400, 313, 336, 400, 400, 400, 100, 99, 215, 400, 124, 400, 214, 400, 400, 400, 166, 290, 63, 113, 400, 190, 306, 161, 346, 93, 360, 287, 363, 286, 400, 306, 86, 207, 400, 113, 192, 164, 186, 103, 63, 400, 80, 141, 250, 248, 274, 330, 398, 127, 252, 362, 319, 68, 400, 98, 400, 114, 400, 125, 387, 77, 255, 146, 97, 400, 279, 97, 400, 177, 207, 268, 222, 195]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19864052906245036, "mean_inference_ms": 0.6191924163660913, "mean_action_processing_ms": 0.0675227985927137, "mean_env_wait_ms": 6.111155247539191, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005448579788208008, "StateBufferConnector_ms": 0.0031363964080810547, "ViewRequirementAgentConnector_ms": 0.07367897033691406}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 382.1998362054335, "num_env_steps_trained_throughput_per_sec": 382.1998362054335, "timesteps_total": 40000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 40000, "timers": {"training_iteration_time_ms": 10540.08, "sample_time_ms": 7059.622, "load_time_ms": 1.022, "load_throughput": 3912323.298, "learn_time_ms": 3475.593, "learn_throughput": 1150.883, "synch_weights_time_ms": 2.894}, "counters": {"num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000}, "done": false, "episodes_total": 140, "training_iteration": 10, "trial_id": "83204_00000", "date": "2024-03-07_12-04-35", "timestamp": 1709831075, "time_this_iter_s": 10.46774411201477, "time_total_s": 105.42216753959656, "pid": 102666, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fcd19c36f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 105.42216753959656, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 19.25, "ram_util_percent": 44.2, "gpu_util_percent0": 0.08571428571428572, "vram_util_percent0": 0.10986328125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 4.659340674838712, "policy_loss": -0.002017165165674943, "vf_loss": 4.659862312514295, "vf_explained_var": -0.1458589788406126, "kl": 0.00747767803523384, "entropy": 0.9942347140081467, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 9765.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_agent_steps_sampled": 44000, "num_agent_steps_trained": 44000}, "sampler_results": {"episode_reward_max": -5.199999999999994, "episode_reward_min": -65.20000000000029, "episode_reward_mean": -28.302000000000113, "episode_len_mean": 252.8, "episode_media": {}, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-16.59999999999997, -9.499999999999984, -42.900000000000176, -50.40000000000035, -54.10000000000031, -47.7000000000003, -44.00000000000032, -10.799999999999974, -11.89999999999997, -52.40000000000034, -47.90000000000035, -42.90000000000012, -38.600000000000236, -46.700000000000266, -40.2000000000003, -65.20000000000029, -10.599999999999987, -8.799999999999981, -20.900000000000023, -41.70000000000027, -11.299999999999972, -41.40000000000032, -25.500000000000025, -46.0000000000003, -54.00000000000021, -52.00000000000022, -15.499999999999964, -31.0000000000001, -5.199999999999994, -11.79999999999997, -51.60000000000029, -18.3, -37.80000000000015, -19.49999999999995, -37.00000000000022, -9.199999999999985, -40.90000000000023, -33.70000000000006, -42.70000000000019, -29.20000000000013, -41.50000000000027, -34.10000000000011, -7.499999999999986, -22.40000000000001, -42.30000000000026, -11.999999999999973, -20.10000000000003, -17.999999999999975, -19.299999999999955, -9.19999999999998, -5.199999999999994, -40.3000000000003, -6.899999999999988, -12.999999999999966, -29.80000000000004, -28.000000000000046, -29.800000000000125, -34.6000000000002, -48.000000000000206, -12.199999999999969, -25.600000000000065, -43.70000000000023, -33.70000000000014, -5.699999999999992, -53.80000000000037, -8.699999999999982, -54.80000000000029, -10.299999999999976, -45.00000000000038, -11.399999999999972, -40.70000000000028, -6.599999999999989, -28.000000000000043, -15.19999999999996, -9.59999999999998, -42.7000000000003, -27.800000000000132, -10.099999999999978, -44.3000000000003, -20.599999999999945, -23.30000000000003, -26.000000000000107, -21.50000000000005, -20.400000000000027, -18.200000000000003, -19.600000000000016, -42.60000000000034, -46.800000000000374, -51.100000000000406, -21.800000000000054, -35.50000000000023, -42.50000000000028, -7.099999999999989, -12.19999999999997, -24.600000000000094, -9.899999999999977, -10.999999999999979, -18.50000000000001, -24.5, -23.200000000000063], "episode_lengths": [159, 97, 374, 400, 400, 400, 400, 119, 130, 400, 400, 313, 336, 400, 400, 400, 100, 99, 215, 400, 124, 400, 214, 400, 400, 400, 166, 290, 63, 113, 400, 190, 306, 161, 346, 93, 360, 287, 363, 286, 400, 306, 86, 207, 400, 113, 192, 164, 186, 103, 63, 400, 80, 141, 250, 248, 274, 330, 398, 127, 252, 362, 319, 68, 400, 98, 400, 114, 400, 125, 387, 77, 255, 146, 97, 400, 279, 97, 400, 177, 207, 268, 222, 195, 185, 198, 390, 400, 400, 224, 338, 400, 80, 117, 247, 102, 98, 167, 196, 221]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19910493689993344, "mean_inference_ms": 0.6186272008403386, "mean_action_processing_ms": 0.06744719988681672, "mean_env_wait_ms": 6.097138364844984, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0054471492767333984, "StateBufferConnector_ms": 0.0031197071075439453, "ViewRequirementAgentConnector_ms": 0.07359075546264648}}, "episode_reward_max": -5.199999999999994, "episode_reward_min": -65.20000000000029, "episode_reward_mean": -28.302000000000113, "episode_len_mean": 252.8, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-16.59999999999997, -9.499999999999984, -42.900000000000176, -50.40000000000035, -54.10000000000031, -47.7000000000003, -44.00000000000032, -10.799999999999974, -11.89999999999997, -52.40000000000034, -47.90000000000035, -42.90000000000012, -38.600000000000236, -46.700000000000266, -40.2000000000003, -65.20000000000029, -10.599999999999987, -8.799999999999981, -20.900000000000023, -41.70000000000027, -11.299999999999972, -41.40000000000032, -25.500000000000025, -46.0000000000003, -54.00000000000021, -52.00000000000022, -15.499999999999964, -31.0000000000001, -5.199999999999994, -11.79999999999997, -51.60000000000029, -18.3, -37.80000000000015, -19.49999999999995, -37.00000000000022, -9.199999999999985, -40.90000000000023, -33.70000000000006, -42.70000000000019, -29.20000000000013, -41.50000000000027, -34.10000000000011, -7.499999999999986, -22.40000000000001, -42.30000000000026, -11.999999999999973, -20.10000000000003, -17.999999999999975, -19.299999999999955, -9.19999999999998, -5.199999999999994, -40.3000000000003, -6.899999999999988, -12.999999999999966, -29.80000000000004, -28.000000000000046, -29.800000000000125, -34.6000000000002, -48.000000000000206, -12.199999999999969, -25.600000000000065, -43.70000000000023, -33.70000000000014, -5.699999999999992, -53.80000000000037, -8.699999999999982, -54.80000000000029, -10.299999999999976, -45.00000000000038, -11.399999999999972, -40.70000000000028, -6.599999999999989, -28.000000000000043, -15.19999999999996, -9.59999999999998, -42.7000000000003, -27.800000000000132, -10.099999999999978, -44.3000000000003, -20.599999999999945, -23.30000000000003, -26.000000000000107, -21.50000000000005, -20.400000000000027, -18.200000000000003, -19.600000000000016, -42.60000000000034, -46.800000000000374, -51.100000000000406, -21.800000000000054, -35.50000000000023, -42.50000000000028, -7.099999999999989, -12.19999999999997, -24.600000000000094, -9.899999999999977, -10.999999999999979, -18.50000000000001, -24.5, -23.200000000000063], "episode_lengths": [159, 97, 374, 400, 400, 400, 400, 119, 130, 400, 400, 313, 336, 400, 400, 400, 100, 99, 215, 400, 124, 400, 214, 400, 400, 400, 166, 290, 63, 113, 400, 190, 306, 161, 346, 93, 360, 287, 363, 286, 400, 306, 86, 207, 400, 113, 192, 164, 186, 103, 63, 400, 80, 141, 250, 248, 274, 330, 398, 127, 252, 362, 319, 68, 400, 98, 400, 114, 400, 125, 387, 77, 255, 146, 97, 400, 279, 97, 400, 177, 207, 268, 222, 195, 185, 198, 390, 400, 400, 224, 338, 400, 80, 117, 247, 102, 98, 167, 196, 221]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19910493689993344, "mean_inference_ms": 0.6186272008403386, "mean_action_processing_ms": 0.06744719988681672, "mean_env_wait_ms": 6.097138364844984, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0054471492767333984, "StateBufferConnector_ms": 0.0031197071075439453, "ViewRequirementAgentConnector_ms": 0.07359075546264648}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 44000, "num_agent_steps_trained": 44000, "num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 374.10658312522526, "num_env_steps_trained_throughput_per_sec": 374.10658312522526, "timesteps_total": 44000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 44000, "timers": {"training_iteration_time_ms": 10543.983, "sample_time_ms": 7062.061, "load_time_ms": 0.994, "load_throughput": 4025630.099, "learn_time_ms": 3477.406, "learn_throughput": 1150.283, "synch_weights_time_ms": 2.896}, "counters": {"num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_agent_steps_sampled": 44000, "num_agent_steps_trained": 44000}, "done": false, "episodes_total": 156, "training_iteration": 11, "trial_id": "83204_00000", "date": "2024-03-07_12-04-46", "timestamp": 1709831086, "time_this_iter_s": 10.694175243377686, "time_total_s": 116.11634278297424, "pid": 102666, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fcd19c36f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 116.11634278297424, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 20.27692307692308, "ram_util_percent": 44.26153846153846, "gpu_util_percent0": 0.07538461538461538, "vram_util_percent0": 0.10986328125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 5.695786520742601, "policy_loss": -0.013866420865299241, "vf_loss": 5.70843953692144, "vf_explained_var": -0.14513380072450124, "kl": 0.0060669324699421465, "entropy": 0.9966431134490557, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 10695.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000}, "sampler_results": {"episode_reward_max": -4.4999999999999964, "episode_reward_min": -54.80000000000029, "episode_reward_mean": -24.99000000000009, "episode_len_mean": 226.82, "episode_media": {}, "episodes_this_iter": 23, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-46.0000000000003, -54.00000000000021, -52.00000000000022, -15.499999999999964, -31.0000000000001, -5.199999999999994, -11.79999999999997, -51.60000000000029, -18.3, -37.80000000000015, -19.49999999999995, -37.00000000000022, -9.199999999999985, -40.90000000000023, -33.70000000000006, -42.70000000000019, -29.20000000000013, -41.50000000000027, -34.10000000000011, -7.499999999999986, -22.40000000000001, -42.30000000000026, -11.999999999999973, -20.10000000000003, -17.999999999999975, -19.299999999999955, -9.19999999999998, -5.199999999999994, -40.3000000000003, -6.899999999999988, -12.999999999999966, -29.80000000000004, -28.000000000000046, -29.800000000000125, -34.6000000000002, -48.000000000000206, -12.199999999999969, -25.600000000000065, -43.70000000000023, -33.70000000000014, -5.699999999999992, -53.80000000000037, -8.699999999999982, -54.80000000000029, -10.299999999999976, -45.00000000000038, -11.399999999999972, -40.70000000000028, -6.599999999999989, -28.000000000000043, -15.19999999999996, -9.59999999999998, -42.7000000000003, -27.800000000000132, -10.099999999999978, -44.3000000000003, -20.599999999999945, -23.30000000000003, -26.000000000000107, -21.50000000000005, -20.400000000000027, -18.200000000000003, -19.600000000000016, -42.60000000000034, -46.800000000000374, -51.100000000000406, -21.800000000000054, -35.50000000000023, -42.50000000000028, -7.099999999999989, -12.19999999999997, -24.600000000000094, -9.899999999999977, -10.999999999999979, -18.50000000000001, -24.5, -23.200000000000063, -28.60000000000015, -53.20000000000034, -6.999999999999988, -7.299999999999988, -18.700000000000003, -7.299999999999988, -14.59999999999996, -8.299999999999983, -5.699999999999992, -15.899999999999967, -11.89999999999997, -40.100000000000286, -30.700000000000095, -13.499999999999972, -24.70000000000001, -5.5999999999999925, -31.399999999999956, -8.199999999999983, -4.4999999999999964, -22.40000000000001, -51.200000000000216, -25.70000000000001, -14.299999999999962], "episode_lengths": [400, 400, 400, 166, 290, 63, 113, 400, 190, 306, 161, 346, 93, 360, 287, 363, 286, 400, 306, 86, 207, 400, 113, 192, 164, 186, 103, 63, 400, 80, 141, 250, 248, 274, 330, 398, 127, 252, 362, 319, 68, 400, 98, 400, 114, 400, 125, 387, 77, 255, 146, 97, 400, 279, 97, 400, 177, 207, 268, 222, 195, 185, 198, 390, 400, 400, 224, 338, 400, 80, 117, 247, 102, 98, 167, 196, 221, 294, 400, 81, 83, 193, 82, 139, 93, 68, 139, 127, 391, 289, 113, 225, 67, 239, 93, 56, 201, 346, 221, 142]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19990970826244378, "mean_inference_ms": 0.6180747537689497, "mean_action_processing_ms": 0.06739570896917359, "mean_env_wait_ms": 6.081620925630233, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005381107330322266, "StateBufferConnector_ms": 0.0031371116638183594, "ViewRequirementAgentConnector_ms": 0.07359647750854492}}, "episode_reward_max": -4.4999999999999964, "episode_reward_min": -54.80000000000029, "episode_reward_mean": -24.99000000000009, "episode_len_mean": 226.82, "episodes_this_iter": 23, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-46.0000000000003, -54.00000000000021, -52.00000000000022, -15.499999999999964, -31.0000000000001, -5.199999999999994, -11.79999999999997, -51.60000000000029, -18.3, -37.80000000000015, -19.49999999999995, -37.00000000000022, -9.199999999999985, -40.90000000000023, -33.70000000000006, -42.70000000000019, -29.20000000000013, -41.50000000000027, -34.10000000000011, -7.499999999999986, -22.40000000000001, -42.30000000000026, -11.999999999999973, -20.10000000000003, -17.999999999999975, -19.299999999999955, -9.19999999999998, -5.199999999999994, -40.3000000000003, -6.899999999999988, -12.999999999999966, -29.80000000000004, -28.000000000000046, -29.800000000000125, -34.6000000000002, -48.000000000000206, -12.199999999999969, -25.600000000000065, -43.70000000000023, -33.70000000000014, -5.699999999999992, -53.80000000000037, -8.699999999999982, -54.80000000000029, -10.299999999999976, -45.00000000000038, -11.399999999999972, -40.70000000000028, -6.599999999999989, -28.000000000000043, -15.19999999999996, -9.59999999999998, -42.7000000000003, -27.800000000000132, -10.099999999999978, -44.3000000000003, -20.599999999999945, -23.30000000000003, -26.000000000000107, -21.50000000000005, -20.400000000000027, -18.200000000000003, -19.600000000000016, -42.60000000000034, -46.800000000000374, -51.100000000000406, -21.800000000000054, -35.50000000000023, -42.50000000000028, -7.099999999999989, -12.19999999999997, -24.600000000000094, -9.899999999999977, -10.999999999999979, -18.50000000000001, -24.5, -23.200000000000063, -28.60000000000015, -53.20000000000034, -6.999999999999988, -7.299999999999988, -18.700000000000003, -7.299999999999988, -14.59999999999996, -8.299999999999983, -5.699999999999992, -15.899999999999967, -11.89999999999997, -40.100000000000286, -30.700000000000095, -13.499999999999972, -24.70000000000001, -5.5999999999999925, -31.399999999999956, -8.199999999999983, -4.4999999999999964, -22.40000000000001, -51.200000000000216, -25.70000000000001, -14.299999999999962], "episode_lengths": [400, 400, 400, 166, 290, 63, 113, 400, 190, 306, 161, 346, 93, 360, 287, 363, 286, 400, 306, 86, 207, 400, 113, 192, 164, 186, 103, 63, 400, 80, 141, 250, 248, 274, 330, 398, 127, 252, 362, 319, 68, 400, 98, 400, 114, 400, 125, 387, 77, 255, 146, 97, 400, 279, 97, 400, 177, 207, 268, 222, 195, 185, 198, 390, 400, 400, 224, 338, 400, 80, 117, 247, 102, 98, 167, 196, 221, 294, 400, 81, 83, 193, 82, 139, 93, 68, 139, 127, 391, 289, 113, 225, 67, 239, 93, 56, 201, 346, 221, 142]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19990970826244378, "mean_inference_ms": 0.6180747537689497, "mean_action_processing_ms": 0.06739570896917359, "mean_env_wait_ms": 6.081620925630233, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005381107330322266, "StateBufferConnector_ms": 0.0031371116638183594, "ViewRequirementAgentConnector_ms": 0.07359647750854492}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000, "num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 377.5285445889292, "num_env_steps_trained_throughput_per_sec": 377.5285445889292, "timesteps_total": 48000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 48000, "timers": {"training_iteration_time_ms": 10546.277, "sample_time_ms": 7058.514, "load_time_ms": 0.996, "load_throughput": 4016955.418, "learn_time_ms": 3483.244, "learn_throughput": 1148.355, "synch_weights_time_ms": 2.898}, "counters": {"num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000}, "done": false, "episodes_total": 179, "training_iteration": 12, "trial_id": "83204_00000", "date": "2024-03-07_12-04-56", "timestamp": 1709831096, "time_this_iter_s": 10.597740411758423, "time_total_s": 126.71408319473267, "pid": 102666, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fcd19c36f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 126.71408319473267, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 19.564285714285713, "ram_util_percent": 44.21428571428572, "gpu_util_percent0": 0.07999999999999999, "vram_util_percent0": 0.10986328125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 5.503687750972727, "policy_loss": -0.01434448709691404, "vf_loss": 5.516482073965893, "vf_explained_var": -0.005568058131843485, "kl": 0.007750841462095761, "entropy": 1.017077398620626, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 11625.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_agent_steps_sampled": 52000, "num_agent_steps_trained": 52000}, "sampler_results": {"episode_reward_max": -3.8999999999999986, "episode_reward_min": -54.80000000000029, "episode_reward_mean": -20.65800000000005, "episode_len_mean": 190.8, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-28.000000000000046, -29.800000000000125, -34.6000000000002, -48.000000000000206, -12.199999999999969, -25.600000000000065, -43.70000000000023, -33.70000000000014, -5.699999999999992, -53.80000000000037, -8.699999999999982, -54.80000000000029, -10.299999999999976, -45.00000000000038, -11.399999999999972, -40.70000000000028, -6.599999999999989, -28.000000000000043, -15.19999999999996, -9.59999999999998, -42.7000000000003, -27.800000000000132, -10.099999999999978, -44.3000000000003, -20.599999999999945, -23.30000000000003, -26.000000000000107, -21.50000000000005, -20.400000000000027, -18.200000000000003, -19.600000000000016, -42.60000000000034, -46.800000000000374, -51.100000000000406, -21.800000000000054, -35.50000000000023, -42.50000000000028, -7.099999999999989, -12.19999999999997, -24.600000000000094, -9.899999999999977, -10.999999999999979, -18.50000000000001, -24.5, -23.200000000000063, -28.60000000000015, -53.20000000000034, -6.999999999999988, -7.299999999999988, -18.700000000000003, -7.299999999999988, -14.59999999999996, -8.299999999999983, -5.699999999999992, -15.899999999999967, -11.89999999999997, -40.100000000000286, -30.700000000000095, -13.499999999999972, -24.70000000000001, -5.5999999999999925, -31.399999999999956, -8.199999999999983, -4.4999999999999964, -22.40000000000001, -51.200000000000216, -25.70000000000001, -14.299999999999962, -5.5999999999999925, -8.699999999999989, -16.299999999999976, -14.199999999999962, -17.799999999999983, -11.199999999999978, -12.799999999999967, -6.099999999999991, -31.900000000000084, -17.69999999999997, -42.80000000000022, -10.29999999999998, -7.299999999999997, -13.899999999999963, -7.39999999999999, -5.399999999999993, -6.599999999999989, -3.8999999999999986, -7.499999999999989, -19.899999999999984, -6.699999999999989, -7.899999999999993, -4.599999999999996, -18.299999999999965, -4.999999999999995, -24.700000000000028, -19.899999999999988, -10.599999999999978, -11.099999999999975, -15.499999999999972, -24.99999999999997, -7.199999999999989], "episode_lengths": [248, 274, 330, 398, 127, 252, 362, 319, 68, 400, 98, 400, 114, 400, 125, 387, 77, 255, 146, 97, 400, 279, 97, 400, 177, 207, 268, 222, 195, 185, 198, 390, 400, 400, 224, 338, 400, 80, 117, 247, 102, 98, 167, 196, 221, 294, 400, 81, 83, 193, 82, 139, 93, 68, 139, 127, 391, 289, 113, 225, 67, 239, 93, 56, 201, 346, 221, 142, 67, 83, 165, 133, 179, 115, 120, 72, 274, 181, 398, 98, 73, 139, 81, 65, 77, 50, 80, 170, 78, 80, 57, 178, 61, 210, 189, 113, 109, 131, 207, 80]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20131722732826993, "mean_inference_ms": 0.6175166546350109, "mean_action_processing_ms": 0.06731337681783053, "mean_env_wait_ms": 6.071545222245022, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0052852630615234375, "StateBufferConnector_ms": 0.003141641616821289, "ViewRequirementAgentConnector_ms": 0.07361555099487305}}, "episode_reward_max": -3.8999999999999986, "episode_reward_min": -54.80000000000029, "episode_reward_mean": -20.65800000000005, "episode_len_mean": 190.8, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-28.000000000000046, -29.800000000000125, -34.6000000000002, -48.000000000000206, -12.199999999999969, -25.600000000000065, -43.70000000000023, -33.70000000000014, -5.699999999999992, -53.80000000000037, -8.699999999999982, -54.80000000000029, -10.299999999999976, -45.00000000000038, -11.399999999999972, -40.70000000000028, -6.599999999999989, -28.000000000000043, -15.19999999999996, -9.59999999999998, -42.7000000000003, -27.800000000000132, -10.099999999999978, -44.3000000000003, -20.599999999999945, -23.30000000000003, -26.000000000000107, -21.50000000000005, -20.400000000000027, -18.200000000000003, -19.600000000000016, -42.60000000000034, -46.800000000000374, -51.100000000000406, -21.800000000000054, -35.50000000000023, -42.50000000000028, -7.099999999999989, -12.19999999999997, -24.600000000000094, -9.899999999999977, -10.999999999999979, -18.50000000000001, -24.5, -23.200000000000063, -28.60000000000015, -53.20000000000034, -6.999999999999988, -7.299999999999988, -18.700000000000003, -7.299999999999988, -14.59999999999996, -8.299999999999983, -5.699999999999992, -15.899999999999967, -11.89999999999997, -40.100000000000286, -30.700000000000095, -13.499999999999972, -24.70000000000001, -5.5999999999999925, -31.399999999999956, -8.199999999999983, -4.4999999999999964, -22.40000000000001, -51.200000000000216, -25.70000000000001, -14.299999999999962, -5.5999999999999925, -8.699999999999989, -16.299999999999976, -14.199999999999962, -17.799999999999983, -11.199999999999978, -12.799999999999967, -6.099999999999991, -31.900000000000084, -17.69999999999997, -42.80000000000022, -10.29999999999998, -7.299999999999997, -13.899999999999963, -7.39999999999999, -5.399999999999993, -6.599999999999989, -3.8999999999999986, -7.499999999999989, -19.899999999999984, -6.699999999999989, -7.899999999999993, -4.599999999999996, -18.299999999999965, -4.999999999999995, -24.700000000000028, -19.899999999999988, -10.599999999999978, -11.099999999999975, -15.499999999999972, -24.99999999999997, -7.199999999999989], "episode_lengths": [248, 274, 330, 398, 127, 252, 362, 319, 68, 400, 98, 400, 114, 400, 125, 387, 77, 255, 146, 97, 400, 279, 97, 400, 177, 207, 268, 222, 195, 185, 198, 390, 400, 400, 224, 338, 400, 80, 117, 247, 102, 98, 167, 196, 221, 294, 400, 81, 83, 193, 82, 139, 93, 68, 139, 127, 391, 289, 113, 225, 67, 239, 93, 56, 201, 346, 221, 142, 67, 83, 165, 133, 179, 115, 120, 72, 274, 181, 398, 98, 73, 139, 81, 65, 77, 50, 80, 170, 78, 80, 57, 178, 61, 210, 189, 113, 109, 131, 207, 80]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20131722732826993, "mean_inference_ms": 0.6175166546350109, "mean_action_processing_ms": 0.06731337681783053, "mean_env_wait_ms": 6.071545222245022, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0052852630615234375, "StateBufferConnector_ms": 0.003141641616821289, "ViewRequirementAgentConnector_ms": 0.07361555099487305}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 52000, "num_agent_steps_trained": 52000, "num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 376.9341046022821, "num_env_steps_trained_throughput_per_sec": 376.9341046022821, "timesteps_total": 52000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 52000, "timers": {"training_iteration_time_ms": 10528.187, "sample_time_ms": 7040.215, "load_time_ms": 1.002, "load_throughput": 3991249.197, "learn_time_ms": 3483.422, "learn_throughput": 1148.296, "synch_weights_time_ms": 2.916}, "counters": {"num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_agent_steps_sampled": 52000, "num_agent_steps_trained": 52000}, "done": false, "episodes_total": 211, "training_iteration": 13, "trial_id": "83204_00000", "date": "2024-03-07_12-05-07", "timestamp": 1709831107, "time_this_iter_s": 10.614232063293457, "time_total_s": 137.32831525802612, "pid": 102666, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fcd19c36f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 137.32831525802612, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 19.50714285714286, "ram_util_percent": 44.2, "gpu_util_percent0": 0.075, "vram_util_percent0": 0.10986328125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 6.154063579792617, "policy_loss": -0.008487045887096594, "vf_loss": 6.161314692292162, "vf_explained_var": -0.2812816886491673, "kl": 0.006179629927045206, "entropy": 0.9916726164920355, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 12555.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 56000}, "sampler_results": {"episode_reward_max": -3.8999999999999986, "episode_reward_min": -53.20000000000034, "episode_reward_mean": -16.92800000000003, "episode_len_mean": 160.69, "episode_media": {}, "episodes_this_iter": 26, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-26.000000000000107, -21.50000000000005, -20.400000000000027, -18.200000000000003, -19.600000000000016, -42.60000000000034, -46.800000000000374, -51.100000000000406, -21.800000000000054, -35.50000000000023, -42.50000000000028, -7.099999999999989, -12.19999999999997, -24.600000000000094, -9.899999999999977, -10.999999999999979, -18.50000000000001, -24.5, -23.200000000000063, -28.60000000000015, -53.20000000000034, -6.999999999999988, -7.299999999999988, -18.700000000000003, -7.299999999999988, -14.59999999999996, -8.299999999999983, -5.699999999999992, -15.899999999999967, -11.89999999999997, -40.100000000000286, -30.700000000000095, -13.499999999999972, -24.70000000000001, -5.5999999999999925, -31.399999999999956, -8.199999999999983, -4.4999999999999964, -22.40000000000001, -51.200000000000216, -25.70000000000001, -14.299999999999962, -5.5999999999999925, -8.699999999999989, -16.299999999999976, -14.199999999999962, -17.799999999999983, -11.199999999999978, -12.799999999999967, -6.099999999999991, -31.900000000000084, -17.69999999999997, -42.80000000000022, -10.29999999999998, -7.299999999999997, -13.899999999999963, -7.39999999999999, -5.399999999999993, -6.599999999999989, -3.8999999999999986, -7.499999999999989, -19.899999999999984, -6.699999999999989, -7.899999999999993, -4.599999999999996, -18.299999999999965, -4.999999999999995, -24.700000000000028, -19.899999999999988, -10.599999999999978, -11.099999999999975, -15.499999999999972, -24.99999999999997, -7.199999999999989, -18.600000000000012, -21.400000000000045, -37.7000000000002, -7.199999999999992, -13.499999999999964, -45.90000000000026, -6.39999999999999, -4.599999999999996, -12.099999999999973, -16.89999999999998, -7.099999999999987, -7.69999999999999, -6.29999999999999, -8.099999999999985, -4.899999999999995, -36.50000000000016, -4.899999999999995, -8.699999999999982, -8.799999999999985, -13.699999999999964, -4.799999999999995, -4.999999999999995, -15.399999999999967, -5.499999999999994, -12.599999999999975, -6.899999999999988], "episode_lengths": [268, 222, 195, 185, 198, 390, 400, 400, 224, 338, 400, 80, 117, 247, 102, 98, 167, 196, 221, 294, 400, 81, 83, 193, 82, 139, 93, 68, 139, 127, 391, 289, 113, 225, 67, 239, 93, 56, 201, 346, 221, 142, 67, 83, 165, 133, 179, 115, 120, 72, 274, 181, 398, 98, 73, 139, 81, 65, 77, 50, 80, 170, 78, 80, 57, 178, 61, 210, 189, 113, 109, 131, 207, 80, 184, 223, 315, 78, 146, 400, 75, 57, 126, 162, 82, 81, 74, 86, 60, 343, 60, 91, 93, 135, 59, 61, 163, 65, 127, 80]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20265826313436897, "mean_inference_ms": 0.6172329091488984, "mean_action_processing_ms": 0.06724567833723148, "mean_env_wait_ms": 6.072363710063646, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005226850509643555, "StateBufferConnector_ms": 0.0031316280364990234, "ViewRequirementAgentConnector_ms": 0.07340598106384277}}, "episode_reward_max": -3.8999999999999986, "episode_reward_min": -53.20000000000034, "episode_reward_mean": -16.92800000000003, "episode_len_mean": 160.69, "episodes_this_iter": 26, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-26.000000000000107, -21.50000000000005, -20.400000000000027, -18.200000000000003, -19.600000000000016, -42.60000000000034, -46.800000000000374, -51.100000000000406, -21.800000000000054, -35.50000000000023, -42.50000000000028, -7.099999999999989, -12.19999999999997, -24.600000000000094, -9.899999999999977, -10.999999999999979, -18.50000000000001, -24.5, -23.200000000000063, -28.60000000000015, -53.20000000000034, -6.999999999999988, -7.299999999999988, -18.700000000000003, -7.299999999999988, -14.59999999999996, -8.299999999999983, -5.699999999999992, -15.899999999999967, -11.89999999999997, -40.100000000000286, -30.700000000000095, -13.499999999999972, -24.70000000000001, -5.5999999999999925, -31.399999999999956, -8.199999999999983, -4.4999999999999964, -22.40000000000001, -51.200000000000216, -25.70000000000001, -14.299999999999962, -5.5999999999999925, -8.699999999999989, -16.299999999999976, -14.199999999999962, -17.799999999999983, -11.199999999999978, -12.799999999999967, -6.099999999999991, -31.900000000000084, -17.69999999999997, -42.80000000000022, -10.29999999999998, -7.299999999999997, -13.899999999999963, -7.39999999999999, -5.399999999999993, -6.599999999999989, -3.8999999999999986, -7.499999999999989, -19.899999999999984, -6.699999999999989, -7.899999999999993, -4.599999999999996, -18.299999999999965, -4.999999999999995, -24.700000000000028, -19.899999999999988, -10.599999999999978, -11.099999999999975, -15.499999999999972, -24.99999999999997, -7.199999999999989, -18.600000000000012, -21.400000000000045, -37.7000000000002, -7.199999999999992, -13.499999999999964, -45.90000000000026, -6.39999999999999, -4.599999999999996, -12.099999999999973, -16.89999999999998, -7.099999999999987, -7.69999999999999, -6.29999999999999, -8.099999999999985, -4.899999999999995, -36.50000000000016, -4.899999999999995, -8.699999999999982, -8.799999999999985, -13.699999999999964, -4.799999999999995, -4.999999999999995, -15.399999999999967, -5.499999999999994, -12.599999999999975, -6.899999999999988], "episode_lengths": [268, 222, 195, 185, 198, 390, 400, 400, 224, 338, 400, 80, 117, 247, 102, 98, 167, 196, 221, 294, 400, 81, 83, 193, 82, 139, 93, 68, 139, 127, 391, 289, 113, 225, 67, 239, 93, 56, 201, 346, 221, 142, 67, 83, 165, 133, 179, 115, 120, 72, 274, 181, 398, 98, 73, 139, 81, 65, 77, 50, 80, 170, 78, 80, 57, 178, 61, 210, 189, 113, 109, 131, 207, 80, 184, 223, 315, 78, 146, 400, 75, 57, 126, 162, 82, 81, 74, 86, 60, 343, 60, 91, 93, 135, 59, 61, 163, 65, 127, 80]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20265826313436897, "mean_inference_ms": 0.6172329091488984, "mean_action_processing_ms": 0.06724567833723148, "mean_env_wait_ms": 6.072363710063646, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005226850509643555, "StateBufferConnector_ms": 0.0031316280364990234, "ViewRequirementAgentConnector_ms": 0.07340598106384277}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 56000, "num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 372.83176132816624, "num_env_steps_trained_throughput_per_sec": 372.83176132816624, "timesteps_total": 56000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 56000, "timers": {"training_iteration_time_ms": 10551.667, "sample_time_ms": 7057.543, "load_time_ms": 1.043, "load_throughput": 3836370.621, "learn_time_ms": 3489.512, "learn_throughput": 1146.292, "synch_weights_time_ms": 2.919}, "counters": {"num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 56000}, "done": false, "episodes_total": 237, "training_iteration": 14, "trial_id": "83204_00000", "date": "2024-03-07_12-05-18", "timestamp": 1709831118, "time_this_iter_s": 10.730936765670776, "time_total_s": 148.0592520236969, "pid": 102666, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fcd19c36f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 148.0592520236969, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 19.685714285714283, "ram_util_percent": 44.2, "gpu_util_percent0": 0.075, "vram_util_percent0": 0.10986328125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 3.3956210931532724, "policy_loss": -0.010225290196236744, "vf_loss": 3.4042809554005182, "vf_explained_var": 0.35488004915175897, "kl": 0.007827174935919341, "entropy": 0.9741279664859976, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 13485.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000}, "sampler_results": {"episode_reward_max": -3.8999999999999986, "episode_reward_min": -65.60000000000043, "episode_reward_mean": -13.702000000000007, "episode_len_mean": 131.8, "episode_media": {}, "episodes_this_iter": 36, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8.199999999999983, -4.4999999999999964, -22.40000000000001, -51.200000000000216, -25.70000000000001, -14.299999999999962, -5.5999999999999925, -8.699999999999989, -16.299999999999976, -14.199999999999962, -17.799999999999983, -11.199999999999978, -12.799999999999967, -6.099999999999991, -31.900000000000084, -17.69999999999997, -42.80000000000022, -10.29999999999998, -7.299999999999997, -13.899999999999963, -7.39999999999999, -5.399999999999993, -6.599999999999989, -3.8999999999999986, -7.499999999999989, -19.899999999999984, -6.699999999999989, -7.899999999999993, -4.599999999999996, -18.299999999999965, -4.999999999999995, -24.700000000000028, -19.899999999999988, -10.599999999999978, -11.099999999999975, -15.499999999999972, -24.99999999999997, -7.199999999999989, -18.600000000000012, -21.400000000000045, -37.7000000000002, -7.199999999999992, -13.499999999999964, -45.90000000000026, -6.39999999999999, -4.599999999999996, -12.099999999999973, -16.89999999999998, -7.099999999999987, -7.69999999999999, -6.29999999999999, -8.099999999999985, -4.899999999999995, -36.50000000000016, -4.899999999999995, -8.699999999999982, -8.799999999999985, -13.699999999999964, -4.799999999999995, -4.999999999999995, -15.399999999999967, -5.499999999999994, -12.599999999999975, -6.899999999999988, -65.60000000000043, -9.09999999999998, -4.599999999999996, -6.499999999999992, -34.30000000000015, -29.80000000000013, -5.399999999999993, -19.999999999999996, -12.999999999999968, -11.899999999999972, -6.29999999999999, -6.599999999999989, -7.499999999999986, -30.500000000000117, -7.599999999999994, -17.799999999999997, -6.099999999999991, -11.699999999999976, -10.799999999999974, -10.899999999999979, -6.099999999999992, -14.099999999999962, -8.099999999999984, -6.29999999999999, -37.80000000000011, -4.999999999999995, -7.099999999999987, -21.700000000000003, -7.999999999999993, -6.399999999999991, -5.499999999999993, -4.1999999999999975, -6.19999999999999, -5.699999999999992, -9.79999999999998, -10.899999999999977], "episode_lengths": [93, 56, 201, 346, 221, 142, 67, 83, 165, 133, 179, 115, 120, 72, 274, 181, 398, 98, 73, 139, 81, 65, 77, 50, 80, 170, 78, 80, 57, 178, 61, 210, 189, 113, 109, 131, 207, 80, 184, 223, 315, 78, 146, 400, 75, 57, 126, 162, 82, 81, 74, 86, 60, 343, 60, 91, 93, 135, 59, 61, 163, 65, 127, 80, 400, 101, 57, 73, 329, 266, 65, 188, 130, 129, 74, 77, 86, 292, 77, 183, 72, 115, 116, 109, 71, 142, 90, 74, 317, 61, 82, 175, 78, 74, 66, 53, 73, 68, 107, 112]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20479350720244058, "mean_inference_ms": 0.6173792820914837, "mean_action_processing_ms": 0.06717928232413328, "mean_env_wait_ms": 6.079998134803295, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005197763442993164, "StateBufferConnector_ms": 0.003148794174194336, "ViewRequirementAgentConnector_ms": 0.07370996475219727}}, "episode_reward_max": -3.8999999999999986, "episode_reward_min": -65.60000000000043, "episode_reward_mean": -13.702000000000007, "episode_len_mean": 131.8, "episodes_this_iter": 36, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-8.199999999999983, -4.4999999999999964, -22.40000000000001, -51.200000000000216, -25.70000000000001, -14.299999999999962, -5.5999999999999925, -8.699999999999989, -16.299999999999976, -14.199999999999962, -17.799999999999983, -11.199999999999978, -12.799999999999967, -6.099999999999991, -31.900000000000084, -17.69999999999997, -42.80000000000022, -10.29999999999998, -7.299999999999997, -13.899999999999963, -7.39999999999999, -5.399999999999993, -6.599999999999989, -3.8999999999999986, -7.499999999999989, -19.899999999999984, -6.699999999999989, -7.899999999999993, -4.599999999999996, -18.299999999999965, -4.999999999999995, -24.700000000000028, -19.899999999999988, -10.599999999999978, -11.099999999999975, -15.499999999999972, -24.99999999999997, -7.199999999999989, -18.600000000000012, -21.400000000000045, -37.7000000000002, -7.199999999999992, -13.499999999999964, -45.90000000000026, -6.39999999999999, -4.599999999999996, -12.099999999999973, -16.89999999999998, -7.099999999999987, -7.69999999999999, -6.29999999999999, -8.099999999999985, -4.899999999999995, -36.50000000000016, -4.899999999999995, -8.699999999999982, -8.799999999999985, -13.699999999999964, -4.799999999999995, -4.999999999999995, -15.399999999999967, -5.499999999999994, -12.599999999999975, -6.899999999999988, -65.60000000000043, -9.09999999999998, -4.599999999999996, -6.499999999999992, -34.30000000000015, -29.80000000000013, -5.399999999999993, -19.999999999999996, -12.999999999999968, -11.899999999999972, -6.29999999999999, -6.599999999999989, -7.499999999999986, -30.500000000000117, -7.599999999999994, -17.799999999999997, -6.099999999999991, -11.699999999999976, -10.799999999999974, -10.899999999999979, -6.099999999999992, -14.099999999999962, -8.099999999999984, -6.29999999999999, -37.80000000000011, -4.999999999999995, -7.099999999999987, -21.700000000000003, -7.999999999999993, -6.399999999999991, -5.499999999999993, -4.1999999999999975, -6.19999999999999, -5.699999999999992, -9.79999999999998, -10.899999999999977], "episode_lengths": [93, 56, 201, 346, 221, 142, 67, 83, 165, 133, 179, 115, 120, 72, 274, 181, 398, 98, 73, 139, 81, 65, 77, 50, 80, 170, 78, 80, 57, 178, 61, 210, 189, 113, 109, 131, 207, 80, 184, 223, 315, 78, 146, 400, 75, 57, 126, 162, 82, 81, 74, 86, 60, 343, 60, 91, 93, 135, 59, 61, 163, 65, 127, 80, 400, 101, 57, 73, 329, 266, 65, 188, 130, 129, 74, 77, 86, 292, 77, 183, 72, 115, 116, 109, 71, 142, 90, 74, 317, 61, 82, 175, 78, 74, 66, 53, 73, 68, 107, 112]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20479350720244058, "mean_inference_ms": 0.6173792820914837, "mean_action_processing_ms": 0.06717928232413328, "mean_env_wait_ms": 6.079998134803295, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005197763442993164, "StateBufferConnector_ms": 0.003148794174194336, "ViewRequirementAgentConnector_ms": 0.07370996475219727}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000, "num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 368.8375928540038, "num_env_steps_trained_throughput_per_sec": 368.8375928540038, "timesteps_total": 60000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 60000, "timers": {"training_iteration_time_ms": 10585.705, "sample_time_ms": 7085.024, "load_time_ms": 1.023, "load_throughput": 3911867.189, "learn_time_ms": 3496.103, "learn_throughput": 1144.131, "synch_weights_time_ms": 2.907}, "counters": {"num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000}, "done": false, "episodes_total": 273, "training_iteration": 15, "trial_id": "83204_00000", "date": "2024-03-07_12-05-28", "timestamp": 1709831128, "time_this_iter_s": 10.847182035446167, "time_total_s": 158.90643405914307, "pid": 102666, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fcd19c36f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 158.90643405914307, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 19.407142857142855, "ram_util_percent": 44.11428571428572, "gpu_util_percent0": 0.07642857142857143, "vram_util_percent0": 0.10986328125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 2.571681088220919, "policy_loss": -0.00819025038421074, "vf_loss": 2.578250231457654, "vf_explained_var": 0.46681590669898576, "kl": 0.008105499504655294, "entropy": 0.9704403048561465, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 14415.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000}, "sampler_results": {"episode_reward_max": -3.9999999999999982, "episode_reward_min": -65.60000000000043, "episode_reward_mean": -11.975000000000012, "episode_len_mean": 120.23, "episode_media": {}, "episodes_this_iter": 38, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-18.600000000000012, -21.400000000000045, -37.7000000000002, -7.199999999999992, -13.499999999999964, -45.90000000000026, -6.39999999999999, -4.599999999999996, -12.099999999999973, -16.89999999999998, -7.099999999999987, -7.69999999999999, -6.29999999999999, -8.099999999999985, -4.899999999999995, -36.50000000000016, -4.899999999999995, -8.699999999999982, -8.799999999999985, -13.699999999999964, -4.799999999999995, -4.999999999999995, -15.399999999999967, -5.499999999999994, -12.599999999999975, -6.899999999999988, -65.60000000000043, -9.09999999999998, -4.599999999999996, -6.499999999999992, -34.30000000000015, -29.80000000000013, -5.399999999999993, -19.999999999999996, -12.999999999999968, -11.899999999999972, -6.29999999999999, -6.599999999999989, -7.499999999999986, -30.500000000000117, -7.599999999999994, -17.799999999999997, -6.099999999999991, -11.699999999999976, -10.799999999999974, -10.899999999999979, -6.099999999999992, -14.099999999999962, -8.099999999999984, -6.29999999999999, -37.80000000000011, -4.999999999999995, -7.099999999999987, -21.700000000000003, -7.999999999999993, -6.399999999999991, -5.499999999999993, -4.1999999999999975, -6.19999999999999, -5.699999999999992, -9.79999999999998, -10.899999999999977, -14.99999999999996, -4.699999999999996, -7.999999999999988, -4.399999999999997, -6.699999999999989, -8.899999999999986, -40.00000000000026, -10.699999999999974, -21.300000000000022, -8.499999999999982, -5.299999999999994, -12.299999999999969, -5.8999999999999915, -5.999999999999991, -4.899999999999995, -8.099999999999987, -8.899999999999983, -9.89999999999998, -23.900000000000034, -5.199999999999994, -5.699999999999998, -5.099999999999994, -8.999999999999988, -3.9999999999999982, -37.20000000000025, -10.499999999999977, -4.799999999999995, -8.499999999999982, -7.2999999999999865, -8.89999999999998, -8.399999999999986, -5.099999999999994, -4.899999999999995, -5.299999999999994, -11.399999999999977, -8.199999999999983, -8.199999999999989, -6.29999999999999], "episode_lengths": [184, 223, 315, 78, 146, 400, 75, 57, 126, 162, 82, 81, 74, 86, 60, 343, 60, 91, 93, 135, 59, 61, 163, 65, 127, 80, 400, 101, 57, 73, 329, 266, 65, 188, 130, 129, 74, 77, 86, 292, 77, 183, 72, 115, 116, 109, 71, 142, 90, 74, 317, 61, 82, 175, 78, 74, 66, 53, 73, 68, 107, 112, 139, 58, 84, 55, 78, 94, 398, 116, 217, 91, 64, 134, 70, 71, 60, 85, 92, 101, 236, 63, 61, 62, 93, 51, 363, 106, 59, 96, 84, 96, 90, 62, 60, 64, 113, 93, 82, 74]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20695809666704096, "mean_inference_ms": 0.6176449982828979, "mean_action_processing_ms": 0.06719748275268904, "mean_env_wait_ms": 6.085182041435801, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005384922027587891, "StateBufferConnector_ms": 0.0031409263610839844, "ViewRequirementAgentConnector_ms": 0.07413005828857422}}, "episode_reward_max": -3.9999999999999982, "episode_reward_min": -65.60000000000043, "episode_reward_mean": -11.975000000000012, "episode_len_mean": 120.23, "episodes_this_iter": 38, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-18.600000000000012, -21.400000000000045, -37.7000000000002, -7.199999999999992, -13.499999999999964, -45.90000000000026, -6.39999999999999, -4.599999999999996, -12.099999999999973, -16.89999999999998, -7.099999999999987, -7.69999999999999, -6.29999999999999, -8.099999999999985, -4.899999999999995, -36.50000000000016, -4.899999999999995, -8.699999999999982, -8.799999999999985, -13.699999999999964, -4.799999999999995, -4.999999999999995, -15.399999999999967, -5.499999999999994, -12.599999999999975, -6.899999999999988, -65.60000000000043, -9.09999999999998, -4.599999999999996, -6.499999999999992, -34.30000000000015, -29.80000000000013, -5.399999999999993, -19.999999999999996, -12.999999999999968, -11.899999999999972, -6.29999999999999, -6.599999999999989, -7.499999999999986, -30.500000000000117, -7.599999999999994, -17.799999999999997, -6.099999999999991, -11.699999999999976, -10.799999999999974, -10.899999999999979, -6.099999999999992, -14.099999999999962, -8.099999999999984, -6.29999999999999, -37.80000000000011, -4.999999999999995, -7.099999999999987, -21.700000000000003, -7.999999999999993, -6.399999999999991, -5.499999999999993, -4.1999999999999975, -6.19999999999999, -5.699999999999992, -9.79999999999998, -10.899999999999977, -14.99999999999996, -4.699999999999996, -7.999999999999988, -4.399999999999997, -6.699999999999989, -8.899999999999986, -40.00000000000026, -10.699999999999974, -21.300000000000022, -8.499999999999982, -5.299999999999994, -12.299999999999969, -5.8999999999999915, -5.999999999999991, -4.899999999999995, -8.099999999999987, -8.899999999999983, -9.89999999999998, -23.900000000000034, -5.199999999999994, -5.699999999999998, -5.099999999999994, -8.999999999999988, -3.9999999999999982, -37.20000000000025, -10.499999999999977, -4.799999999999995, -8.499999999999982, -7.2999999999999865, -8.89999999999998, -8.399999999999986, -5.099999999999994, -4.899999999999995, -5.299999999999994, -11.399999999999977, -8.199999999999983, -8.199999999999989, -6.29999999999999], "episode_lengths": [184, 223, 315, 78, 146, 400, 75, 57, 126, 162, 82, 81, 74, 86, 60, 343, 60, 91, 93, 135, 59, 61, 163, 65, 127, 80, 400, 101, 57, 73, 329, 266, 65, 188, 130, 129, 74, 77, 86, 292, 77, 183, 72, 115, 116, 109, 71, 142, 90, 74, 317, 61, 82, 175, 78, 74, 66, 53, 73, 68, 107, 112, 139, 58, 84, 55, 78, 94, 398, 116, 217, 91, 64, 134, 70, 71, 60, 85, 92, 101, 236, 63, 61, 62, 93, 51, 363, 106, 59, 96, 84, 96, 90, 62, 60, 64, 113, 93, 82, 74]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20695809666704096, "mean_inference_ms": 0.6176449982828979, "mean_action_processing_ms": 0.06719748275268904, "mean_env_wait_ms": 6.085182041435801, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005384922027587891, "StateBufferConnector_ms": 0.0031409263610839844, "ViewRequirementAgentConnector_ms": 0.07413005828857422}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000, "num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 375.1577942293706, "num_env_steps_trained_throughput_per_sec": 375.1577942293706, "timesteps_total": 64000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 64000, "timers": {"training_iteration_time_ms": 10601.914, "sample_time_ms": 7098.023, "load_time_ms": 1.002, "load_throughput": 3993814.512, "learn_time_ms": 3499.329, "learn_throughput": 1143.076, "synch_weights_time_ms": 2.92}, "counters": {"num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000}, "done": false, "episodes_total": 311, "training_iteration": 16, "trial_id": "83204_00000", "date": "2024-03-07_12-05-39", "timestamp": 1709831139, "time_this_iter_s": 10.664250612258911, "time_total_s": 169.57068467140198, "pid": 102666, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fcd19c36f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 169.57068467140198, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 19.571428571428566, "ram_util_percent": 44.10000000000001, "gpu_util_percent0": 0.07214285714285715, "vram_util_percent0": 0.10986328125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 3.7850213628432523, "policy_loss": -0.007643031669400072, "vf_loss": 3.7914281722358476, "vf_explained_var": 0.2289270156173296, "kl": 0.006181067141741342, "entropy": 0.9678824560616606, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 15345.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_agent_steps_sampled": 68000, "num_agent_steps_trained": 68000}, "sampler_results": {"episode_reward_max": -3.4000000000000004, "episode_reward_min": -42.400000000000304, "episode_reward_mean": -10.333000000000004, "episode_len_mean": 108.27, "episode_media": {}, "episodes_this_iter": 37, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-6.599999999999989, -7.499999999999986, -30.500000000000117, -7.599999999999994, -17.799999999999997, -6.099999999999991, -11.699999999999976, -10.799999999999974, -10.899999999999979, -6.099999999999992, -14.099999999999962, -8.099999999999984, -6.29999999999999, -37.80000000000011, -4.999999999999995, -7.099999999999987, -21.700000000000003, -7.999999999999993, -6.399999999999991, -5.499999999999993, -4.1999999999999975, -6.19999999999999, -5.699999999999992, -9.79999999999998, -10.899999999999977, -14.99999999999996, -4.699999999999996, -7.999999999999988, -4.399999999999997, -6.699999999999989, -8.899999999999986, -40.00000000000026, -10.699999999999974, -21.300000000000022, -8.499999999999982, -5.299999999999994, -12.299999999999969, -5.8999999999999915, -5.999999999999991, -4.899999999999995, -8.099999999999987, -8.899999999999983, -9.89999999999998, -23.900000000000034, -5.199999999999994, -5.699999999999998, -5.099999999999994, -8.999999999999988, -3.9999999999999982, -37.20000000000025, -10.499999999999977, -4.799999999999995, -8.499999999999982, -7.2999999999999865, -8.89999999999998, -8.399999999999986, -5.099999999999994, -4.899999999999995, -5.299999999999994, -11.399999999999977, -8.199999999999983, -8.199999999999989, -6.29999999999999, -6.499999999999989, -6.799999999999988, -5.799999999999992, -14.599999999999962, -30.600000000000076, -3.6999999999999993, -22.499999999999996, -4.299999999999997, -5.199999999999994, -10.399999999999975, -4.799999999999995, -42.400000000000304, -16.399999999999974, -27.20000000000008, -6.799999999999995, -9.799999999999978, -6.19999999999999, -5.699999999999992, -4.699999999999996, -8.199999999999983, -4.999999999999995, -6.19999999999999, -7.899999999999984, -5.699999999999994, -3.8999999999999986, -4.399999999999997, -8.199999999999985, -6.799999999999992, -11.299999999999972, -5.299999999999994, -41.50000000000031, -3.4000000000000004, -8.499999999999982, -4.4999999999999964, -4.4999999999999964, -7.199999999999989, -6.599999999999989], "episode_lengths": [77, 86, 292, 77, 183, 72, 115, 116, 109, 71, 142, 90, 74, 317, 61, 82, 175, 78, 74, 66, 53, 73, 68, 107, 112, 139, 58, 84, 55, 78, 94, 398, 116, 217, 91, 64, 134, 70, 71, 60, 85, 92, 101, 236, 63, 61, 62, 93, 51, 363, 106, 59, 96, 84, 96, 90, 62, 60, 64, 113, 93, 82, 74, 76, 79, 69, 153, 281, 48, 212, 54, 63, 109, 59, 400, 167, 256, 71, 107, 73, 61, 58, 93, 61, 73, 90, 66, 50, 55, 91, 75, 120, 64, 400, 45, 96, 56, 53, 81, 77]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20912008800991658, "mean_inference_ms": 0.6180058877193274, "mean_action_processing_ms": 0.06718845783231632, "mean_env_wait_ms": 6.093205860275235, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0054361820220947266, "StateBufferConnector_ms": 0.0031774044036865234, "ViewRequirementAgentConnector_ms": 0.07426309585571289}}, "episode_reward_max": -3.4000000000000004, "episode_reward_min": -42.400000000000304, "episode_reward_mean": -10.333000000000004, "episode_len_mean": 108.27, "episodes_this_iter": 37, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-6.599999999999989, -7.499999999999986, -30.500000000000117, -7.599999999999994, -17.799999999999997, -6.099999999999991, -11.699999999999976, -10.799999999999974, -10.899999999999979, -6.099999999999992, -14.099999999999962, -8.099999999999984, -6.29999999999999, -37.80000000000011, -4.999999999999995, -7.099999999999987, -21.700000000000003, -7.999999999999993, -6.399999999999991, -5.499999999999993, -4.1999999999999975, -6.19999999999999, -5.699999999999992, -9.79999999999998, -10.899999999999977, -14.99999999999996, -4.699999999999996, -7.999999999999988, -4.399999999999997, -6.699999999999989, -8.899999999999986, -40.00000000000026, -10.699999999999974, -21.300000000000022, -8.499999999999982, -5.299999999999994, -12.299999999999969, -5.8999999999999915, -5.999999999999991, -4.899999999999995, -8.099999999999987, -8.899999999999983, -9.89999999999998, -23.900000000000034, -5.199999999999994, -5.699999999999998, -5.099999999999994, -8.999999999999988, -3.9999999999999982, -37.20000000000025, -10.499999999999977, -4.799999999999995, -8.499999999999982, -7.2999999999999865, -8.89999999999998, -8.399999999999986, -5.099999999999994, -4.899999999999995, -5.299999999999994, -11.399999999999977, -8.199999999999983, -8.199999999999989, -6.29999999999999, -6.499999999999989, -6.799999999999988, -5.799999999999992, -14.599999999999962, -30.600000000000076, -3.6999999999999993, -22.499999999999996, -4.299999999999997, -5.199999999999994, -10.399999999999975, -4.799999999999995, -42.400000000000304, -16.399999999999974, -27.20000000000008, -6.799999999999995, -9.799999999999978, -6.19999999999999, -5.699999999999992, -4.699999999999996, -8.199999999999983, -4.999999999999995, -6.19999999999999, -7.899999999999984, -5.699999999999994, -3.8999999999999986, -4.399999999999997, -8.199999999999985, -6.799999999999992, -11.299999999999972, -5.299999999999994, -41.50000000000031, -3.4000000000000004, -8.499999999999982, -4.4999999999999964, -4.4999999999999964, -7.199999999999989, -6.599999999999989], "episode_lengths": [77, 86, 292, 77, 183, 72, 115, 116, 109, 71, 142, 90, 74, 317, 61, 82, 175, 78, 74, 66, 53, 73, 68, 107, 112, 139, 58, 84, 55, 78, 94, 398, 116, 217, 91, 64, 134, 70, 71, 60, 85, 92, 101, 236, 63, 61, 62, 93, 51, 363, 106, 59, 96, 84, 96, 90, 62, 60, 64, 113, 93, 82, 74, 76, 79, 69, 153, 281, 48, 212, 54, 63, 109, 59, 400, 167, 256, 71, 107, 73, 61, 58, 93, 61, 73, 90, 66, 50, 55, 91, 75, 120, 64, 400, 45, 96, 56, 53, 81, 77]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20912008800991658, "mean_inference_ms": 0.6180058877193274, "mean_action_processing_ms": 0.06718845783231632, "mean_env_wait_ms": 6.093205860275235, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0054361820220947266, "StateBufferConnector_ms": 0.0031774044036865234, "ViewRequirementAgentConnector_ms": 0.07426309585571289}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 68000, "num_agent_steps_trained": 68000, "num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 374.84279348816386, "num_env_steps_trained_throughput_per_sec": 374.84279348816386, "timesteps_total": 68000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 68000, "timers": {"training_iteration_time_ms": 10622.26, "sample_time_ms": 7134.02, "load_time_ms": 1.005, "load_throughput": 3980642.988, "learn_time_ms": 3484.911, "learn_throughput": 1147.806, "synch_weights_time_ms": 1.705}, "counters": {"num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_agent_steps_sampled": 68000, "num_agent_steps_trained": 68000}, "done": false, "episodes_total": 348, "training_iteration": 17, "trial_id": "83204_00000", "date": "2024-03-07_12-05-50", "timestamp": 1709831150, "time_this_iter_s": 10.673548698425293, "time_total_s": 180.24423336982727, "pid": 102666, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fcd19c36f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 180.24423336982727, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 20.50714285714286, "ram_util_percent": 44.10000000000001, "gpu_util_percent0": 0.07571428571428572, "vram_util_percent0": 0.10986328125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 2.523609075041348, "policy_loss": -0.008870697041512818, "vf_loss": 2.5309748958355636, "vf_explained_var": 0.41482071979071505, "kl": 0.007524387920176362, "entropy": 0.9595943786123747, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 16275.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000}, "sampler_results": {"episode_reward_max": -2.700000000000002, "episode_reward_min": -42.400000000000304, "episode_reward_mean": -9.141, "episode_len_mean": 97.86, "episode_media": {}, "episodes_this_iter": 46, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-5.099999999999994, -8.999999999999988, -3.9999999999999982, -37.20000000000025, -10.499999999999977, -4.799999999999995, -8.499999999999982, -7.2999999999999865, -8.89999999999998, -8.399999999999986, -5.099999999999994, -4.899999999999995, -5.299999999999994, -11.399999999999977, -8.199999999999983, -8.199999999999989, -6.29999999999999, -6.499999999999989, -6.799999999999988, -5.799999999999992, -14.599999999999962, -30.600000000000076, -3.6999999999999993, -22.499999999999996, -4.299999999999997, -5.199999999999994, -10.399999999999975, -4.799999999999995, -42.400000000000304, -16.399999999999974, -27.20000000000008, -6.799999999999995, -9.799999999999978, -6.19999999999999, -5.699999999999992, -4.699999999999996, -8.199999999999983, -4.999999999999995, -6.19999999999999, -7.899999999999984, -5.699999999999994, -3.8999999999999986, -4.399999999999997, -8.199999999999985, -6.799999999999992, -11.299999999999972, -5.299999999999994, -41.50000000000031, -3.4000000000000004, -8.499999999999982, -4.4999999999999964, -4.4999999999999964, -7.199999999999989, -6.599999999999989, -2.800000000000002, -16.29999999999998, -6.099999999999991, -12.199999999999969, -5.099999999999994, -5.299999999999994, -8.89999999999998, -10.39999999999998, -18.499999999999982, -7.2999999999999865, -7.899999999999984, -5.199999999999994, -11.99999999999997, -20.400000000000023, -6.399999999999995, -11.499999999999975, -3.6999999999999993, -5.999999999999991, -3.6999999999999993, -5.099999999999994, -6.3999999999999915, -22.500000000000068, -4.699999999999996, -6.39999999999999, -4.299999999999997, -5.1999999999999975, -3.799999999999999, -4.999999999999995, -7.3999999999999915, -5.5999999999999925, -6.0999999999999925, -7.599999999999991, -12.599999999999977, -6.599999999999992, -2.700000000000002, -6.999999999999988, -12.999999999999966, -11.399999999999979, -3.5, -6.599999999999992, -3.8999999999999986, -16.999999999999993, -14.599999999999962, -8.099999999999985, -7.3999999999999915, -3.3000000000000007], "episode_lengths": [62, 93, 51, 363, 106, 59, 96, 84, 96, 90, 62, 60, 64, 113, 93, 82, 74, 76, 79, 69, 153, 281, 48, 212, 54, 63, 109, 59, 400, 167, 256, 71, 107, 73, 61, 58, 93, 61, 73, 90, 66, 50, 55, 91, 75, 120, 64, 400, 45, 96, 56, 53, 81, 77, 39, 170, 65, 133, 62, 64, 100, 104, 174, 80, 88, 63, 129, 204, 69, 122, 48, 71, 48, 62, 73, 212, 58, 75, 54, 59, 49, 61, 79, 67, 70, 81, 111, 74, 38, 81, 140, 118, 46, 74, 50, 166, 154, 88, 79, 44]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21164371531570147, "mean_inference_ms": 0.6184121534355489, "mean_action_processing_ms": 0.06724591358644105, "mean_env_wait_ms": 6.104132763158618, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0054569244384765625, "StateBufferConnector_ms": 0.00322723388671875, "ViewRequirementAgentConnector_ms": 0.07422280311584473}}, "episode_reward_max": -2.700000000000002, "episode_reward_min": -42.400000000000304, "episode_reward_mean": -9.141, "episode_len_mean": 97.86, "episodes_this_iter": 46, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-5.099999999999994, -8.999999999999988, -3.9999999999999982, -37.20000000000025, -10.499999999999977, -4.799999999999995, -8.499999999999982, -7.2999999999999865, -8.89999999999998, -8.399999999999986, -5.099999999999994, -4.899999999999995, -5.299999999999994, -11.399999999999977, -8.199999999999983, -8.199999999999989, -6.29999999999999, -6.499999999999989, -6.799999999999988, -5.799999999999992, -14.599999999999962, -30.600000000000076, -3.6999999999999993, -22.499999999999996, -4.299999999999997, -5.199999999999994, -10.399999999999975, -4.799999999999995, -42.400000000000304, -16.399999999999974, -27.20000000000008, -6.799999999999995, -9.799999999999978, -6.19999999999999, -5.699999999999992, -4.699999999999996, -8.199999999999983, -4.999999999999995, -6.19999999999999, -7.899999999999984, -5.699999999999994, -3.8999999999999986, -4.399999999999997, -8.199999999999985, -6.799999999999992, -11.299999999999972, -5.299999999999994, -41.50000000000031, -3.4000000000000004, -8.499999999999982, -4.4999999999999964, -4.4999999999999964, -7.199999999999989, -6.599999999999989, -2.800000000000002, -16.29999999999998, -6.099999999999991, -12.199999999999969, -5.099999999999994, -5.299999999999994, -8.89999999999998, -10.39999999999998, -18.499999999999982, -7.2999999999999865, -7.899999999999984, -5.199999999999994, -11.99999999999997, -20.400000000000023, -6.399999999999995, -11.499999999999975, -3.6999999999999993, -5.999999999999991, -3.6999999999999993, -5.099999999999994, -6.3999999999999915, -22.500000000000068, -4.699999999999996, -6.39999999999999, -4.299999999999997, -5.1999999999999975, -3.799999999999999, -4.999999999999995, -7.3999999999999915, -5.5999999999999925, -6.0999999999999925, -7.599999999999991, -12.599999999999977, -6.599999999999992, -2.700000000000002, -6.999999999999988, -12.999999999999966, -11.399999999999979, -3.5, -6.599999999999992, -3.8999999999999986, -16.999999999999993, -14.599999999999962, -8.099999999999985, -7.3999999999999915, -3.3000000000000007], "episode_lengths": [62, 93, 51, 363, 106, 59, 96, 84, 96, 90, 62, 60, 64, 113, 93, 82, 74, 76, 79, 69, 153, 281, 48, 212, 54, 63, 109, 59, 400, 167, 256, 71, 107, 73, 61, 58, 93, 61, 73, 90, 66, 50, 55, 91, 75, 120, 64, 400, 45, 96, 56, 53, 81, 77, 39, 170, 65, 133, 62, 64, 100, 104, 174, 80, 88, 63, 129, 204, 69, 122, 48, 71, 48, 62, 73, 212, 58, 75, 54, 59, 49, 61, 79, 67, 70, 81, 111, 74, 38, 81, 140, 118, 46, 74, 50, 166, 154, 88, 79, 44]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21164371531570147, "mean_inference_ms": 0.6184121534355489, "mean_action_processing_ms": 0.06724591358644105, "mean_env_wait_ms": 6.104132763158618, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0054569244384765625, "StateBufferConnector_ms": 0.00322723388671875, "ViewRequirementAgentConnector_ms": 0.07422280311584473}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000, "num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 372.33645652952936, "num_env_steps_trained_throughput_per_sec": 372.33645652952936, "timesteps_total": 72000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 72000, "timers": {"training_iteration_time_ms": 10649.818, "sample_time_ms": 7164.776, "load_time_ms": 1.004, "load_throughput": 3984897.63, "learn_time_ms": 3481.708, "learn_throughput": 1148.861, "synch_weights_time_ms": 1.712}, "counters": {"num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000}, "done": false, "episodes_total": 394, "training_iteration": 18, "trial_id": "83204_00000", "date": "2024-03-07_12-06-01", "timestamp": 1709831161, "time_this_iter_s": 10.745423078536987, "time_total_s": 190.98965644836426, "pid": 102666, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fcd19c36f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 190.98965644836426, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 19.785714285714285, "ram_util_percent": 44.10000000000001, "gpu_util_percent0": 0.07571428571428572, "vram_util_percent0": 0.10984584263392858}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 2.9389920883974114, "policy_loss": -0.005408939671131872, "vf_loss": 2.9430160407257335, "vf_explained_var": 0.3733027972200865, "kl": 0.006924942615057104, "entropy": 0.9293606905527012, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 17205.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_agent_steps_sampled": 76000, "num_agent_steps_trained": 76000}, "sampler_results": {"episode_reward_max": -2.700000000000002, "episode_reward_min": -53.30000000000043, "episode_reward_mean": -8.524000000000003, "episode_len_mean": 90.93, "episode_media": {}, "episodes_this_iter": 44, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-6.799999999999992, -11.299999999999972, -5.299999999999994, -41.50000000000031, -3.4000000000000004, -8.499999999999982, -4.4999999999999964, -4.4999999999999964, -7.199999999999989, -6.599999999999989, -2.800000000000002, -16.29999999999998, -6.099999999999991, -12.199999999999969, -5.099999999999994, -5.299999999999994, -8.89999999999998, -10.39999999999998, -18.499999999999982, -7.2999999999999865, -7.899999999999984, -5.199999999999994, -11.99999999999997, -20.400000000000023, -6.399999999999995, -11.499999999999975, -3.6999999999999993, -5.999999999999991, -3.6999999999999993, -5.099999999999994, -6.3999999999999915, -22.500000000000068, -4.699999999999996, -6.39999999999999, -4.299999999999997, -5.1999999999999975, -3.799999999999999, -4.999999999999995, -7.3999999999999915, -5.5999999999999925, -6.0999999999999925, -7.599999999999991, -12.599999999999977, -6.599999999999992, -2.700000000000002, -6.999999999999988, -12.999999999999966, -11.399999999999979, -3.5, -6.599999999999992, -3.8999999999999986, -16.999999999999993, -14.599999999999962, -8.099999999999985, -7.3999999999999915, -3.3000000000000007, -5.499999999999995, -8.299999999999985, -6.999999999999991, -5.199999999999994, -31.100000000000158, -6.599999999999993, -18.100000000000005, -5.599999999999995, -4.899999999999995, -16.49999999999998, -3.4000000000000004, -7.599999999999991, -8.499999999999982, -5.799999999999995, -6.499999999999996, -3.5999999999999996, -5.799999999999992, -5.299999999999994, -5.699999999999992, -7.499999999999993, -4.899999999999996, -5.299999999999994, -4.299999999999997, -3.9999999999999982, -22.60000000000007, -3.9999999999999982, -5.8999999999999915, -6.19999999999999, -6.799999999999988, -7.399999999999993, -7.899999999999995, -12.799999999999967, -3.200000000000001, -3.200000000000002, -3.9999999999999982, -4.599999999999996, -8.499999999999988, -4.899999999999995, -10.599999999999975, -53.30000000000043, -4.399999999999998, -7.399999999999986, -5.099999999999994, -5.499999999999994], "episode_lengths": [75, 120, 64, 400, 45, 96, 56, 53, 81, 77, 39, 170, 65, 133, 62, 64, 100, 104, 174, 80, 88, 63, 129, 204, 69, 122, 48, 71, 48, 62, 73, 212, 58, 75, 54, 59, 49, 61, 79, 67, 70, 81, 111, 74, 38, 81, 140, 118, 46, 74, 50, 166, 154, 88, 79, 44, 64, 89, 77, 63, 304, 72, 151, 64, 60, 164, 45, 82, 92, 65, 68, 47, 69, 64, 68, 78, 59, 64, 54, 51, 224, 51, 70, 73, 79, 78, 78, 139, 43, 41, 51, 57, 89, 60, 117, 400, 54, 85, 62, 65]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21355027136196678, "mean_inference_ms": 0.6186001774930148, "mean_action_processing_ms": 0.06729296555078176, "mean_env_wait_ms": 6.105626548412484, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005337238311767578, "StateBufferConnector_ms": 0.003173351287841797, "ViewRequirementAgentConnector_ms": 0.0736699104309082}}, "episode_reward_max": -2.700000000000002, "episode_reward_min": -53.30000000000043, "episode_reward_mean": -8.524000000000003, "episode_len_mean": 90.93, "episodes_this_iter": 44, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-6.799999999999992, -11.299999999999972, -5.299999999999994, -41.50000000000031, -3.4000000000000004, -8.499999999999982, -4.4999999999999964, -4.4999999999999964, -7.199999999999989, -6.599999999999989, -2.800000000000002, -16.29999999999998, -6.099999999999991, -12.199999999999969, -5.099999999999994, -5.299999999999994, -8.89999999999998, -10.39999999999998, -18.499999999999982, -7.2999999999999865, -7.899999999999984, -5.199999999999994, -11.99999999999997, -20.400000000000023, -6.399999999999995, -11.499999999999975, -3.6999999999999993, -5.999999999999991, -3.6999999999999993, -5.099999999999994, -6.3999999999999915, -22.500000000000068, -4.699999999999996, -6.39999999999999, -4.299999999999997, -5.1999999999999975, -3.799999999999999, -4.999999999999995, -7.3999999999999915, -5.5999999999999925, -6.0999999999999925, -7.599999999999991, -12.599999999999977, -6.599999999999992, -2.700000000000002, -6.999999999999988, -12.999999999999966, -11.399999999999979, -3.5, -6.599999999999992, -3.8999999999999986, -16.999999999999993, -14.599999999999962, -8.099999999999985, -7.3999999999999915, -3.3000000000000007, -5.499999999999995, -8.299999999999985, -6.999999999999991, -5.199999999999994, -31.100000000000158, -6.599999999999993, -18.100000000000005, -5.599999999999995, -4.899999999999995, -16.49999999999998, -3.4000000000000004, -7.599999999999991, -8.499999999999982, -5.799999999999995, -6.499999999999996, -3.5999999999999996, -5.799999999999992, -5.299999999999994, -5.699999999999992, -7.499999999999993, -4.899999999999996, -5.299999999999994, -4.299999999999997, -3.9999999999999982, -22.60000000000007, -3.9999999999999982, -5.8999999999999915, -6.19999999999999, -6.799999999999988, -7.399999999999993, -7.899999999999995, -12.799999999999967, -3.200000000000001, -3.200000000000002, -3.9999999999999982, -4.599999999999996, -8.499999999999988, -4.899999999999995, -10.599999999999975, -53.30000000000043, -4.399999999999998, -7.399999999999986, -5.099999999999994, -5.499999999999994], "episode_lengths": [75, 120, 64, 400, 45, 96, 56, 53, 81, 77, 39, 170, 65, 133, 62, 64, 100, 104, 174, 80, 88, 63, 129, 204, 69, 122, 48, 71, 48, 62, 73, 212, 58, 75, 54, 59, 49, 61, 79, 67, 70, 81, 111, 74, 38, 81, 140, 118, 46, 74, 50, 166, 154, 88, 79, 44, 64, 89, 77, 63, 304, 72, 151, 64, 60, 164, 45, 82, 92, 65, 68, 47, 69, 64, 68, 78, 59, 64, 54, 51, 224, 51, 70, 73, 79, 78, 78, 139, 43, 41, 51, 57, 89, 60, 117, 400, 54, 85, 62, 65]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21355027136196678, "mean_inference_ms": 0.6186001774930148, "mean_action_processing_ms": 0.06729296555078176, "mean_env_wait_ms": 6.105626548412484, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005337238311767578, "StateBufferConnector_ms": 0.003173351287841797, "ViewRequirementAgentConnector_ms": 0.0736699104309082}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 76000, "num_agent_steps_trained": 76000, "num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 374.1842383459347, "num_env_steps_trained_throughput_per_sec": 374.1842383459347, "timesteps_total": 76000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 76000, "timers": {"training_iteration_time_ms": 10670.449, "sample_time_ms": 7187.174, "load_time_ms": 1.005, "load_throughput": 3980737.437, "learn_time_ms": 3479.938, "learn_throughput": 1149.446, "synch_weights_time_ms": 1.713}, "counters": {"num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_agent_steps_sampled": 76000, "num_agent_steps_trained": 76000}, "done": false, "episodes_total": 438, "training_iteration": 19, "trial_id": "83204_00000", "date": "2024-03-07_12-06-11", "timestamp": 1709831171, "time_this_iter_s": 10.692043781280518, "time_total_s": 201.68170022964478, "pid": 102666, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fcd19c36f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 201.68170022964478, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 19.678571428571423, "ram_util_percent": 44.08571428571429, "gpu_util_percent0": 0.075, "vram_util_percent0": 0.109619140625}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 1.5363968646257704, "policy_loss": -0.015936174131529306, "vf_loss": 1.5505595692223118, "vf_explained_var": 0.5920704444890381, "kl": 0.008867369212177222, "entropy": 0.9215199848657013, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 18135.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000}, "sampler_results": {"episode_reward_max": -3.200000000000001, "episode_reward_min": -53.30000000000043, "episode_reward_mean": -7.517000000000001, "episode_len_mean": 81.27, "episode_media": {}, "episodes_this_iter": 54, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-7.3999999999999915, -3.3000000000000007, -5.499999999999995, -8.299999999999985, -6.999999999999991, -5.199999999999994, -31.100000000000158, -6.599999999999993, -18.100000000000005, -5.599999999999995, -4.899999999999995, -16.49999999999998, -3.4000000000000004, -7.599999999999991, -8.499999999999982, -5.799999999999995, -6.499999999999996, -3.5999999999999996, -5.799999999999992, -5.299999999999994, -5.699999999999992, -7.499999999999993, -4.899999999999996, -5.299999999999994, -4.299999999999997, -3.9999999999999982, -22.60000000000007, -3.9999999999999982, -5.8999999999999915, -6.19999999999999, -6.799999999999988, -7.399999999999993, -7.899999999999995, -12.799999999999967, -3.200000000000001, -3.200000000000002, -3.9999999999999982, -4.599999999999996, -8.499999999999988, -4.899999999999995, -10.599999999999975, -53.30000000000043, -4.399999999999998, -7.399999999999986, -5.099999999999994, -5.499999999999994, -22.700000000000067, -5.199999999999994, -6.0, -4.1999999999999975, -3.3000000000000007, -5.699999999999992, -4.999999999999995, -5.8999999999999915, -3.9999999999999982, -8.79999999999999, -7.19999999999999, -18.600000000000016, -4.4999999999999964, -5.599999999999999, -6.0999999999999925, -15.69999999999997, -6.599999999999989, -6.39999999999999, -5.199999999999994, -13.09999999999997, -5.199999999999994, -4.599999999999996, -4.899999999999995, -4.599999999999996, -5.699999999999994, -17.599999999999987, -3.5999999999999996, -13.599999999999966, -4.699999999999996, -7.499999999999993, -4.699999999999996, -4.799999999999995, -5.1, -3.4000000000000004, -3.799999999999999, -8.099999999999984, -3.5999999999999996, -5.999999999999996, -4.1999999999999975, -4.299999999999997, -5.8999999999999915, -6.099999999999995, -7.79999999999999, -4.1999999999999975, -5.499999999999993, -5.599999999999997, -7.399999999999986, -4.699999999999996, -4.899999999999995, -5.899999999999996, -8.699999999999989, -5.299999999999994, -4.899999999999995, -8.99999999999998], "episode_lengths": [79, 44, 64, 89, 77, 63, 304, 72, 151, 64, 60, 164, 45, 82, 92, 65, 68, 47, 69, 64, 68, 78, 59, 64, 54, 51, 224, 51, 70, 73, 79, 78, 78, 139, 43, 41, 51, 57, 89, 60, 117, 400, 54, 85, 62, 65, 232, 63, 61, 53, 44, 66, 61, 70, 51, 86, 79, 180, 56, 60, 60, 160, 77, 75, 63, 117, 63, 57, 60, 57, 66, 183, 47, 143, 58, 79, 58, 59, 56, 45, 49, 92, 47, 66, 53, 54, 70, 67, 80, 53, 66, 62, 85, 58, 60, 65, 83, 64, 60, 95]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21601278327270929, "mean_inference_ms": 0.6187946227097012, "mean_action_processing_ms": 0.06735587050738287, "mean_env_wait_ms": 6.113463142730768, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005384683609008789, "StateBufferConnector_ms": 0.003160238265991211, "ViewRequirementAgentConnector_ms": 0.07333731651306152}}, "episode_reward_max": -3.200000000000001, "episode_reward_min": -53.30000000000043, "episode_reward_mean": -7.517000000000001, "episode_len_mean": 81.27, "episodes_this_iter": 54, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-7.3999999999999915, -3.3000000000000007, -5.499999999999995, -8.299999999999985, -6.999999999999991, -5.199999999999994, -31.100000000000158, -6.599999999999993, -18.100000000000005, -5.599999999999995, -4.899999999999995, -16.49999999999998, -3.4000000000000004, -7.599999999999991, -8.499999999999982, -5.799999999999995, -6.499999999999996, -3.5999999999999996, -5.799999999999992, -5.299999999999994, -5.699999999999992, -7.499999999999993, -4.899999999999996, -5.299999999999994, -4.299999999999997, -3.9999999999999982, -22.60000000000007, -3.9999999999999982, -5.8999999999999915, -6.19999999999999, -6.799999999999988, -7.399999999999993, -7.899999999999995, -12.799999999999967, -3.200000000000001, -3.200000000000002, -3.9999999999999982, -4.599999999999996, -8.499999999999988, -4.899999999999995, -10.599999999999975, -53.30000000000043, -4.399999999999998, -7.399999999999986, -5.099999999999994, -5.499999999999994, -22.700000000000067, -5.199999999999994, -6.0, -4.1999999999999975, -3.3000000000000007, -5.699999999999992, -4.999999999999995, -5.8999999999999915, -3.9999999999999982, -8.79999999999999, -7.19999999999999, -18.600000000000016, -4.4999999999999964, -5.599999999999999, -6.0999999999999925, -15.69999999999997, -6.599999999999989, -6.39999999999999, -5.199999999999994, -13.09999999999997, -5.199999999999994, -4.599999999999996, -4.899999999999995, -4.599999999999996, -5.699999999999994, -17.599999999999987, -3.5999999999999996, -13.599999999999966, -4.699999999999996, -7.499999999999993, -4.699999999999996, -4.799999999999995, -5.1, -3.4000000000000004, -3.799999999999999, -8.099999999999984, -3.5999999999999996, -5.999999999999996, -4.1999999999999975, -4.299999999999997, -5.8999999999999915, -6.099999999999995, -7.79999999999999, -4.1999999999999975, -5.499999999999993, -5.599999999999997, -7.399999999999986, -4.699999999999996, -4.899999999999995, -5.899999999999996, -8.699999999999989, -5.299999999999994, -4.899999999999995, -8.99999999999998], "episode_lengths": [79, 44, 64, 89, 77, 63, 304, 72, 151, 64, 60, 164, 45, 82, 92, 65, 68, 47, 69, 64, 68, 78, 59, 64, 54, 51, 224, 51, 70, 73, 79, 78, 78, 139, 43, 41, 51, 57, 89, 60, 117, 400, 54, 85, 62, 65, 232, 63, 61, 53, 44, 66, 61, 70, 51, 86, 79, 180, 56, 60, 60, 160, 77, 75, 63, 117, 63, 57, 60, 57, 66, 183, 47, 143, 58, 79, 58, 59, 56, 45, 49, 92, 47, 66, 53, 54, 70, 67, 80, 53, 66, 62, 85, 58, 60, 65, 83, 64, 60, 95]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21601278327270929, "mean_inference_ms": 0.6187946227097012, "mean_action_processing_ms": 0.06735587050738287, "mean_env_wait_ms": 6.113463142730768, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005384683609008789, "StateBufferConnector_ms": 0.003160238265991211, "ViewRequirementAgentConnector_ms": 0.07333731651306152}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000, "num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 369.3273338575071, "num_env_steps_trained_throughput_per_sec": 369.3273338575071, "timesteps_total": 80000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 80000, "timers": {"training_iteration_time_ms": 10706.927, "sample_time_ms": 7227.961, "load_time_ms": 1.003, "load_throughput": 3988876.843, "learn_time_ms": 3475.635, "learn_throughput": 1150.869, "synch_weights_time_ms": 1.707}, "counters": {"num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000}, "done": false, "episodes_total": 492, "training_iteration": 20, "trial_id": "83204_00000", "date": "2024-03-07_12-06-22", "timestamp": 1709831182, "time_this_iter_s": 10.832713842391968, "time_total_s": 212.51441407203674, "pid": 102666, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fcd19c36f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 212.51441407203674, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 20.12142857142857, "ram_util_percent": 43.97142857142857, "gpu_util_percent0": 0.07428571428571429, "vram_util_percent0": 0.109619140625}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 1.2267088478472414, "policy_loss": -0.00891617627674213, "vf_loss": 1.2339572651972694, "vf_explained_var": 0.6939115545442027, "kl": 0.00833880634129999, "entropy": 0.8937049272880759, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 19065.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 84000}, "sampler_results": {"episode_reward_max": -3.1000000000000014, "episode_reward_min": -17.599999999999987, "episode_reward_mean": -6.0229999999999935, "episode_len_mean": 69.19, "episode_media": {}, "episodes_this_iter": 61, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-15.69999999999997, -6.599999999999989, -6.39999999999999, -5.199999999999994, -13.09999999999997, -5.199999999999994, -4.599999999999996, -4.899999999999995, -4.599999999999996, -5.699999999999994, -17.599999999999987, -3.5999999999999996, -13.599999999999966, -4.699999999999996, -7.499999999999993, -4.699999999999996, -4.799999999999995, -5.1, -3.4000000000000004, -3.799999999999999, -8.099999999999984, -3.5999999999999996, -5.999999999999996, -4.1999999999999975, -4.299999999999997, -5.8999999999999915, -6.099999999999995, -7.79999999999999, -4.1999999999999975, -5.499999999999993, -5.599999999999997, -7.399999999999986, -4.699999999999996, -4.899999999999995, -5.899999999999996, -8.699999999999989, -5.299999999999994, -4.899999999999995, -8.99999999999998, -6.099999999999995, -5.799999999999998, -4.7, -3.9999999999999982, -6.19999999999999, -4.599999999999996, -5.099999999999994, -6.499999999999989, -4.399999999999999, -13.099999999999966, -4.599999999999998, -4.299999999999998, -5.999999999999993, -3.200000000000001, -4.799999999999995, -4.799999999999995, -8.099999999999987, -3.6999999999999993, -4.999999999999995, -5.399999999999993, -4.599999999999996, -7.19999999999999, -5.699999999999994, -5.099999999999994, -4.1999999999999975, -3.8999999999999986, -5.199999999999994, -6.499999999999995, -7.89999999999999, -5.5999999999999925, -4.499999999999999, -7.899999999999984, -4.999999999999995, -5.199999999999994, -14.79999999999996, -4.999999999999996, -6.29999999999999, -4.4999999999999964, -3.200000000000001, -4.599999999999996, -5.299999999999994, -3.6999999999999993, -3.200000000000001, -4.299999999999997, -4.899999999999995, -4.399999999999997, -4.399999999999997, -4.799999999999995, -5.499999999999993, -6.899999999999992, -5.099999999999994, -12.89999999999997, -5.299999999999994, -5.099999999999994, -4.6000000000000005, -3.1000000000000014, -5.099999999999994, -14.999999999999961, -7.599999999999996, -5.699999999999996, -5.199999999999994], "episode_lengths": [160, 77, 75, 63, 117, 63, 57, 60, 57, 66, 183, 47, 143, 58, 79, 58, 59, 56, 45, 49, 92, 47, 66, 53, 54, 70, 67, 80, 53, 66, 62, 85, 58, 60, 65, 83, 64, 60, 95, 67, 61, 53, 51, 73, 57, 62, 76, 53, 141, 55, 53, 69, 43, 59, 59, 86, 48, 61, 65, 57, 79, 66, 62, 53, 50, 63, 70, 84, 67, 49, 90, 61, 63, 155, 60, 74, 56, 43, 57, 64, 48, 43, 54, 60, 55, 55, 59, 66, 75, 62, 133, 64, 62, 52, 42, 62, 160, 75, 62, 63]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21905107693311002, "mean_inference_ms": 0.618926674937259, "mean_action_processing_ms": 0.06725013161855908, "mean_env_wait_ms": 6.12526483149061, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005403757095336914, "StateBufferConnector_ms": 0.0031287670135498047, "ViewRequirementAgentConnector_ms": 0.07305359840393066}}, "episode_reward_max": -3.1000000000000014, "episode_reward_min": -17.599999999999987, "episode_reward_mean": -6.0229999999999935, "episode_len_mean": 69.19, "episodes_this_iter": 61, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-15.69999999999997, -6.599999999999989, -6.39999999999999, -5.199999999999994, -13.09999999999997, -5.199999999999994, -4.599999999999996, -4.899999999999995, -4.599999999999996, -5.699999999999994, -17.599999999999987, -3.5999999999999996, -13.599999999999966, -4.699999999999996, -7.499999999999993, -4.699999999999996, -4.799999999999995, -5.1, -3.4000000000000004, -3.799999999999999, -8.099999999999984, -3.5999999999999996, -5.999999999999996, -4.1999999999999975, -4.299999999999997, -5.8999999999999915, -6.099999999999995, -7.79999999999999, -4.1999999999999975, -5.499999999999993, -5.599999999999997, -7.399999999999986, -4.699999999999996, -4.899999999999995, -5.899999999999996, -8.699999999999989, -5.299999999999994, -4.899999999999995, -8.99999999999998, -6.099999999999995, -5.799999999999998, -4.7, -3.9999999999999982, -6.19999999999999, -4.599999999999996, -5.099999999999994, -6.499999999999989, -4.399999999999999, -13.099999999999966, -4.599999999999998, -4.299999999999998, -5.999999999999993, -3.200000000000001, -4.799999999999995, -4.799999999999995, -8.099999999999987, -3.6999999999999993, -4.999999999999995, -5.399999999999993, -4.599999999999996, -7.19999999999999, -5.699999999999994, -5.099999999999994, -4.1999999999999975, -3.8999999999999986, -5.199999999999994, -6.499999999999995, -7.89999999999999, -5.5999999999999925, -4.499999999999999, -7.899999999999984, -4.999999999999995, -5.199999999999994, -14.79999999999996, -4.999999999999996, -6.29999999999999, -4.4999999999999964, -3.200000000000001, -4.599999999999996, -5.299999999999994, -3.6999999999999993, -3.200000000000001, -4.299999999999997, -4.899999999999995, -4.399999999999997, -4.399999999999997, -4.799999999999995, -5.499999999999993, -6.899999999999992, -5.099999999999994, -12.89999999999997, -5.299999999999994, -5.099999999999994, -4.6000000000000005, -3.1000000000000014, -5.099999999999994, -14.999999999999961, -7.599999999999996, -5.699999999999996, -5.199999999999994], "episode_lengths": [160, 77, 75, 63, 117, 63, 57, 60, 57, 66, 183, 47, 143, 58, 79, 58, 59, 56, 45, 49, 92, 47, 66, 53, 54, 70, 67, 80, 53, 66, 62, 85, 58, 60, 65, 83, 64, 60, 95, 67, 61, 53, 51, 73, 57, 62, 76, 53, 141, 55, 53, 69, 43, 59, 59, 86, 48, 61, 65, 57, 79, 66, 62, 53, 50, 63, 70, 84, 67, 49, 90, 61, 63, 155, 60, 74, 56, 43, 57, 64, 48, 43, 54, 60, 55, 55, 59, 66, 75, 62, 133, 64, 62, 52, 42, 62, 160, 75, 62, 63]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21905107693311002, "mean_inference_ms": 0.618926674937259, "mean_action_processing_ms": 0.06725013161855908, "mean_env_wait_ms": 6.12526483149061, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005403757095336914, "StateBufferConnector_ms": 0.0031287670135498047, "ViewRequirementAgentConnector_ms": 0.07305359840393066}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 84000, "num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 368.8229734733367, "num_env_steps_trained_throughput_per_sec": 368.8229734733367, "timesteps_total": 84000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 84000, "timers": {"training_iteration_time_ms": 10722.244, "sample_time_ms": 7253.282, "load_time_ms": 1.005, "load_throughput": 3981398.704, "learn_time_ms": 3465.627, "learn_throughput": 1154.192, "synch_weights_time_ms": 1.708}, "counters": {"num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 84000}, "done": false, "episodes_total": 553, "training_iteration": 21, "trial_id": "83204_00000", "date": "2024-03-07_12-06-33", "timestamp": 1709831193, "time_this_iter_s": 10.847710132598877, "time_total_s": 223.36212420463562, "pid": 102666, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fcd19c36f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 223.36212420463562, "iterations_since_restore": 21, "perf": {"cpu_util_percent": 19.857142857142854, "ram_util_percent": 43.921428571428564, "gpu_util_percent0": 0.07428571428571429, "vram_util_percent0": 0.109619140625}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 2.937272693509216, "policy_loss": -0.00767901786352678, "vf_loss": 2.9431906680906974, "vf_explained_var": 0.3066364324861957, "kl": 0.008805272502616932, "entropy": 0.8944363590850625, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 19995.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_agent_steps_sampled": 88000, "num_agent_steps_trained": 88000}, "sampler_results": {"episode_reward_max": -2.700000000000002, "episode_reward_min": -42.6000000000003, "episode_reward_mean": -6.476, "episode_len_mean": 73.45, "episode_media": {}, "episodes_this_iter": 46, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-6.499999999999989, -4.399999999999999, -13.099999999999966, -4.599999999999998, -4.299999999999998, -5.999999999999993, -3.200000000000001, -4.799999999999995, -4.799999999999995, -8.099999999999987, -3.6999999999999993, -4.999999999999995, -5.399999999999993, -4.599999999999996, -7.19999999999999, -5.699999999999994, -5.099999999999994, -4.1999999999999975, -3.8999999999999986, -5.199999999999994, -6.499999999999995, -7.89999999999999, -5.5999999999999925, -4.499999999999999, -7.899999999999984, -4.999999999999995, -5.199999999999994, -14.79999999999996, -4.999999999999996, -6.29999999999999, -4.4999999999999964, -3.200000000000001, -4.599999999999996, -5.299999999999994, -3.6999999999999993, -3.200000000000001, -4.299999999999997, -4.899999999999995, -4.399999999999997, -4.399999999999997, -4.799999999999995, -5.499999999999993, -6.899999999999992, -5.099999999999994, -12.89999999999997, -5.299999999999994, -5.099999999999994, -4.6000000000000005, -3.1000000000000014, -5.099999999999994, -14.999999999999961, -7.599999999999996, -5.699999999999996, -5.199999999999994, -5.5999999999999925, -4.299999999999998, -3.0000000000000018, -10.499999999999975, -13.999999999999964, -9.999999999999977, -42.6000000000003, -5.499999999999993, -4.599999999999996, -4.799999999999995, -3.1000000000000014, -5.5999999999999925, -4.399999999999997, -3.6999999999999993, -3.799999999999999, -6.099999999999992, -2.700000000000002, -14.299999999999965, -5.299999999999994, -5.099999999999995, -4.099999999999998, -4.4999999999999964, -4.399999999999997, -3.9999999999999982, -3.5, -33.90000000000021, -4.299999999999997, -2.900000000000002, -10.199999999999976, -4.599999999999996, -3.6999999999999993, -4.4999999999999964, -4.7, -4.699999999999996, -3.3000000000000007, -4.899999999999995, -3.8, -4.699999999999996, -4.099999999999998, -6.899999999999991, -6.399999999999995, -6.799999999999996, -22.10000000000003, -5.899999999999992, -9.09999999999998, -3.6999999999999993], "episode_lengths": [76, 53, 141, 55, 53, 69, 43, 59, 59, 86, 48, 61, 65, 57, 79, 66, 62, 53, 50, 63, 70, 84, 67, 49, 90, 61, 63, 155, 60, 74, 56, 43, 57, 64, 48, 43, 54, 60, 55, 55, 59, 66, 75, 62, 133, 64, 62, 52, 42, 62, 160, 75, 62, 63, 67, 53, 41, 113, 149, 111, 400, 64, 57, 59, 42, 67, 55, 48, 49, 71, 38, 127, 64, 61, 52, 56, 55, 51, 46, 321, 54, 40, 107, 57, 48, 56, 53, 58, 44, 60, 46, 58, 52, 77, 69, 70, 217, 69, 102, 48]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.22067977054767585, "mean_inference_ms": 0.6189912671117892, "mean_action_processing_ms": 0.06726281111524617, "mean_env_wait_ms": 6.129468225167966, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005319833755493164, "StateBufferConnector_ms": 0.003192901611328125, "ViewRequirementAgentConnector_ms": 0.07327961921691895}}, "episode_reward_max": -2.700000000000002, "episode_reward_min": -42.6000000000003, "episode_reward_mean": -6.476, "episode_len_mean": 73.45, "episodes_this_iter": 46, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-6.499999999999989, -4.399999999999999, -13.099999999999966, -4.599999999999998, -4.299999999999998, -5.999999999999993, -3.200000000000001, -4.799999999999995, -4.799999999999995, -8.099999999999987, -3.6999999999999993, -4.999999999999995, -5.399999999999993, -4.599999999999996, -7.19999999999999, -5.699999999999994, -5.099999999999994, -4.1999999999999975, -3.8999999999999986, -5.199999999999994, -6.499999999999995, -7.89999999999999, -5.5999999999999925, -4.499999999999999, -7.899999999999984, -4.999999999999995, -5.199999999999994, -14.79999999999996, -4.999999999999996, -6.29999999999999, -4.4999999999999964, -3.200000000000001, -4.599999999999996, -5.299999999999994, -3.6999999999999993, -3.200000000000001, -4.299999999999997, -4.899999999999995, -4.399999999999997, -4.399999999999997, -4.799999999999995, -5.499999999999993, -6.899999999999992, -5.099999999999994, -12.89999999999997, -5.299999999999994, -5.099999999999994, -4.6000000000000005, -3.1000000000000014, -5.099999999999994, -14.999999999999961, -7.599999999999996, -5.699999999999996, -5.199999999999994, -5.5999999999999925, -4.299999999999998, -3.0000000000000018, -10.499999999999975, -13.999999999999964, -9.999999999999977, -42.6000000000003, -5.499999999999993, -4.599999999999996, -4.799999999999995, -3.1000000000000014, -5.5999999999999925, -4.399999999999997, -3.6999999999999993, -3.799999999999999, -6.099999999999992, -2.700000000000002, -14.299999999999965, -5.299999999999994, -5.099999999999995, -4.099999999999998, -4.4999999999999964, -4.399999999999997, -3.9999999999999982, -3.5, -33.90000000000021, -4.299999999999997, -2.900000000000002, -10.199999999999976, -4.599999999999996, -3.6999999999999993, -4.4999999999999964, -4.7, -4.699999999999996, -3.3000000000000007, -4.899999999999995, -3.8, -4.699999999999996, -4.099999999999998, -6.899999999999991, -6.399999999999995, -6.799999999999996, -22.10000000000003, -5.899999999999992, -9.09999999999998, -3.6999999999999993], "episode_lengths": [76, 53, 141, 55, 53, 69, 43, 59, 59, 86, 48, 61, 65, 57, 79, 66, 62, 53, 50, 63, 70, 84, 67, 49, 90, 61, 63, 155, 60, 74, 56, 43, 57, 64, 48, 43, 54, 60, 55, 55, 59, 66, 75, 62, 133, 64, 62, 52, 42, 62, 160, 75, 62, 63, 67, 53, 41, 113, 149, 111, 400, 64, 57, 59, 42, 67, 55, 48, 49, 71, 38, 127, 64, 61, 52, 56, 55, 51, 46, 321, 54, 40, 107, 57, 48, 56, 53, 58, 44, 60, 46, 58, 52, 77, 69, 70, 217, 69, 102, 48]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.22067977054767585, "mean_inference_ms": 0.6189912671117892, "mean_action_processing_ms": 0.06726281111524617, "mean_env_wait_ms": 6.129468225167966, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005319833755493164, "StateBufferConnector_ms": 0.003192901611328125, "ViewRequirementAgentConnector_ms": 0.07327961921691895}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 88000, "num_agent_steps_trained": 88000, "num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 365.1610422824794, "num_env_steps_trained_throughput_per_sec": 365.1610422824794, "timesteps_total": 88000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 88000, "timers": {"training_iteration_time_ms": 10758.12, "sample_time_ms": 7279.22, "load_time_ms": 1.01, "load_throughput": 3958571.092, "learn_time_ms": 3474.225, "learn_throughput": 1151.336, "synch_weights_time_ms": 3.009}, "counters": {"num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_agent_steps_sampled": 88000, "num_agent_steps_trained": 88000}, "done": false, "episodes_total": 599, "training_iteration": 22, "trial_id": "83204_00000", "date": "2024-03-07_12-06-44", "timestamp": 1709831204, "time_this_iter_s": 10.9569411277771, "time_total_s": 234.31906533241272, "pid": 102666, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fcd19c36f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 234.31906533241272, "iterations_since_restore": 22, "perf": {"cpu_util_percent": 19.00666666666667, "ram_util_percent": 43.89999999999999, "gpu_util_percent0": 0.08333333333333333, "vram_util_percent0": 0.109619140625}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 1.1431022804945217, "policy_loss": -0.010689226177430922, "vf_loss": 1.1523363295822375, "vf_explained_var": 0.6712501915552282, "kl": 0.007275851480179306, "entropy": 0.8712397596528453, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 20925.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_agent_steps_sampled": 92000, "num_agent_steps_trained": 92000}, "sampler_results": {"episode_reward_max": -2.600000000000002, "episode_reward_min": -36.50000000000018, "episode_reward_mean": -6.0280000000000005, "episode_len_mean": 68.04, "episode_media": {}, "episodes_this_iter": 63, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4.799999999999995, -3.1000000000000014, -5.5999999999999925, -4.399999999999997, -3.6999999999999993, -3.799999999999999, -6.099999999999992, -2.700000000000002, -14.299999999999965, -5.299999999999994, -5.099999999999995, -4.099999999999998, -4.4999999999999964, -4.399999999999997, -3.9999999999999982, -3.5, -33.90000000000021, -4.299999999999997, -2.900000000000002, -10.199999999999976, -4.599999999999996, -3.6999999999999993, -4.4999999999999964, -4.7, -4.699999999999996, -3.3000000000000007, -4.899999999999995, -3.8, -4.699999999999996, -4.099999999999998, -6.899999999999991, -6.399999999999995, -6.799999999999996, -22.10000000000003, -5.899999999999992, -9.09999999999998, -3.6999999999999993, -8.899999999999988, -3.200000000000001, -5.199999999999994, -4.9999999999999964, -6.899999999999997, -4.099999999999998, -5.099999999999994, -4.099999999999998, -4.6999999999999975, -3.6999999999999993, -4.399999999999997, -7.89999999999999, -4.799999999999995, -4.299999999999999, -6.499999999999989, -3.8999999999999986, -36.50000000000018, -6.199999999999996, -4.000000000000001, -10.499999999999975, -3.799999999999999, -4.999999999999995, -4.299999999999997, -6.29999999999999, -3.3000000000000007, -5.7999999999999945, -5.499999999999998, -3.6999999999999993, -3.799999999999999, -6.599999999999993, -4.099999999999998, -7.000000000000002, -4.600000000000001, -7.699999999999994, -6.699999999999997, -5.1, -5.499999999999993, -16.999999999999986, -3.799999999999999, -5.199999999999994, -6.0999999999999925, -2.600000000000002, -4.099999999999998, -5.499999999999994, -3.8999999999999986, -5.099999999999995, -5.499999999999993, -3.9999999999999982, -4.799999999999996, -4.599999999999996, -5.399999999999997, -5.299999999999997, -6.099999999999994, -4.199999999999998, -3.5, -6.100000000000004, -4.899999999999995, -5.399999999999997, -5.999999999999997, -4.8999999999999995, -5.499999999999995, -5.199999999999998, -4.799999999999995], "episode_lengths": [59, 42, 67, 55, 48, 49, 71, 38, 127, 64, 61, 52, 56, 55, 51, 46, 321, 54, 40, 107, 57, 48, 56, 53, 58, 44, 60, 46, 58, 52, 77, 69, 70, 217, 69, 102, 48, 88, 43, 63, 59, 70, 52, 62, 52, 56, 48, 55, 82, 59, 52, 76, 50, 336, 67, 48, 116, 49, 61, 54, 74, 44, 66, 60, 48, 49, 72, 52, 64, 48, 79, 69, 56, 66, 175, 49, 63, 70, 37, 52, 65, 50, 61, 66, 50, 58, 57, 60, 60, 68, 52, 46, 52, 60, 61, 64, 55, 64, 58, 59]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.22318752225702596, "mean_inference_ms": 0.6198538857683938, "mean_action_processing_ms": 0.06726324027185378, "mean_env_wait_ms": 6.145139395325803, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0054891109466552734, "StateBufferConnector_ms": 0.0032320022583007812, "ViewRequirementAgentConnector_ms": 0.07455325126647949}}, "episode_reward_max": -2.600000000000002, "episode_reward_min": -36.50000000000018, "episode_reward_mean": -6.0280000000000005, "episode_len_mean": 68.04, "episodes_this_iter": 63, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-4.799999999999995, -3.1000000000000014, -5.5999999999999925, -4.399999999999997, -3.6999999999999993, -3.799999999999999, -6.099999999999992, -2.700000000000002, -14.299999999999965, -5.299999999999994, -5.099999999999995, -4.099999999999998, -4.4999999999999964, -4.399999999999997, -3.9999999999999982, -3.5, -33.90000000000021, -4.299999999999997, -2.900000000000002, -10.199999999999976, -4.599999999999996, -3.6999999999999993, -4.4999999999999964, -4.7, -4.699999999999996, -3.3000000000000007, -4.899999999999995, -3.8, -4.699999999999996, -4.099999999999998, -6.899999999999991, -6.399999999999995, -6.799999999999996, -22.10000000000003, -5.899999999999992, -9.09999999999998, -3.6999999999999993, -8.899999999999988, -3.200000000000001, -5.199999999999994, -4.9999999999999964, -6.899999999999997, -4.099999999999998, -5.099999999999994, -4.099999999999998, -4.6999999999999975, -3.6999999999999993, -4.399999999999997, -7.89999999999999, -4.799999999999995, -4.299999999999999, -6.499999999999989, -3.8999999999999986, -36.50000000000018, -6.199999999999996, -4.000000000000001, -10.499999999999975, -3.799999999999999, -4.999999999999995, -4.299999999999997, -6.29999999999999, -3.3000000000000007, -5.7999999999999945, -5.499999999999998, -3.6999999999999993, -3.799999999999999, -6.599999999999993, -4.099999999999998, -7.000000000000002, -4.600000000000001, -7.699999999999994, -6.699999999999997, -5.1, -5.499999999999993, -16.999999999999986, -3.799999999999999, -5.199999999999994, -6.0999999999999925, -2.600000000000002, -4.099999999999998, -5.499999999999994, -3.8999999999999986, -5.099999999999995, -5.499999999999993, -3.9999999999999982, -4.799999999999996, -4.599999999999996, -5.399999999999997, -5.299999999999997, -6.099999999999994, -4.199999999999998, -3.5, -6.100000000000004, -4.899999999999995, -5.399999999999997, -5.999999999999997, -4.8999999999999995, -5.499999999999995, -5.199999999999998, -4.799999999999995], "episode_lengths": [59, 42, 67, 55, 48, 49, 71, 38, 127, 64, 61, 52, 56, 55, 51, 46, 321, 54, 40, 107, 57, 48, 56, 53, 58, 44, 60, 46, 58, 52, 77, 69, 70, 217, 69, 102, 48, 88, 43, 63, 59, 70, 52, 62, 52, 56, 48, 55, 82, 59, 52, 76, 50, 336, 67, 48, 116, 49, 61, 54, 74, 44, 66, 60, 48, 49, 72, 52, 64, 48, 79, 69, 56, 66, 175, 49, 63, 70, 37, 52, 65, 50, 61, 66, 50, 58, 57, 60, 60, 68, 52, 46, 52, 60, 61, 64, 55, 64, 58, 59]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.22318752225702596, "mean_inference_ms": 0.6198538857683938, "mean_action_processing_ms": 0.06726324027185378, "mean_env_wait_ms": 6.145139395325803, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0054891109466552734, "StateBufferConnector_ms": 0.0032320022583007812, "ViewRequirementAgentConnector_ms": 0.07455325126647949}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 92000, "num_agent_steps_trained": 92000, "num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 364.54834004766946, "num_env_steps_trained_throughput_per_sec": 364.54834004766946, "timesteps_total": 92000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 92000, "timers": {"training_iteration_time_ms": 10794.175, "sample_time_ms": 7316.139, "load_time_ms": 1.01, "load_throughput": 3958757.905, "learn_time_ms": 3473.384, "learn_throughput": 1151.615, "synch_weights_time_ms": 2.99}, "counters": {"num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_agent_steps_sampled": 92000, "num_agent_steps_trained": 92000}, "done": false, "episodes_total": 662, "training_iteration": 23, "trial_id": "83204_00000", "date": "2024-03-07_12-06-55", "timestamp": 1709831215, "time_this_iter_s": 10.974895715713501, "time_total_s": 245.29396104812622, "pid": 102666, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fcd19c36f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 245.29396104812622, "iterations_since_restore": 23, "perf": {"cpu_util_percent": 20.821428571428577, "ram_util_percent": 43.978571428571435, "gpu_util_percent0": 0.07714285714285715, "vram_util_percent0": 0.109619140625}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 0.6764505433918838, "policy_loss": -0.008962933343624876, "vf_loss": 0.6833779857443866, "vf_explained_var": 0.7471993418790961, "kl": 0.010177455020163954, "entropy": 0.8132818656582986, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 21855.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000}, "sampler_results": {"episode_reward_max": -2.5000000000000018, "episode_reward_min": -27.300000000000054, "episode_reward_mean": -5.221999999999998, "episode_len_mean": 60.48, "episode_media": {}, "episodes_this_iter": 70, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-7.699999999999994, -6.699999999999997, -5.1, -5.499999999999993, -16.999999999999986, -3.799999999999999, -5.199999999999994, -6.0999999999999925, -2.600000000000002, -4.099999999999998, -5.499999999999994, -3.8999999999999986, -5.099999999999995, -5.499999999999993, -3.9999999999999982, -4.799999999999996, -4.599999999999996, -5.399999999999997, -5.299999999999997, -6.099999999999994, -4.199999999999998, -3.5, -6.100000000000004, -4.899999999999995, -5.399999999999997, -5.999999999999997, -4.8999999999999995, -5.499999999999995, -5.199999999999998, -4.799999999999995, -27.300000000000054, -3.799999999999999, -9.299999999999992, -2.600000000000002, -5.899999999999992, -5.799999999999993, -4.999999999999995, -3.9999999999999982, -5.299999999999994, -3.5999999999999996, -4.799999999999998, -3.8, -4.299999999999997, -4.999999999999997, -5.099999999999999, -4.899999999999995, -19.50000000000001, -2.700000000000002, -3.200000000000001, -3.9999999999999982, -3.9999999999999982, -2.5000000000000018, -5.199999999999999, -3.5999999999999996, -6.6999999999999895, -4.099999999999999, -5.5999999999999925, -3.9999999999999982, -3.799999999999999, -3.8999999999999986, -4.699999999999996, -3.9999999999999982, -4.1, -5.499999999999993, -5.999999999999991, -4.3, -4.799999999999998, -4.899999999999995, -4.9, -3.1000000000000014, -4.9999999999999964, -3.4000000000000004, -3.5999999999999996, -6.199999999999996, -5.399999999999993, -4.5, -4.599999999999996, -4.799999999999995, -5.399999999999999, -3.0000000000000018, -3.8000000000000016, -5.999999999999992, -7.6, -4.299999999999998, -4.399999999999998, -4.799999999999995, -4.1999999999999975, -4.699999999999999, -4.299999999999999, -3.8999999999999986, -3.3000000000000007, -3.6999999999999993, -5.399999999999997, -3.5, -3.200000000000001, -6.499999999999993, -3.6999999999999993, -5.399999999999993, -3.4000000000000004, -6.099999999999994], "episode_lengths": [79, 69, 56, 66, 175, 49, 63, 70, 37, 52, 65, 50, 61, 66, 50, 58, 57, 60, 60, 68, 52, 46, 52, 60, 61, 64, 55, 64, 58, 59, 242, 49, 86, 37, 69, 68, 61, 51, 64, 47, 56, 45, 54, 57, 57, 60, 193, 38, 43, 51, 51, 36, 56, 47, 77, 47, 67, 51, 49, 50, 58, 51, 50, 66, 71, 51, 56, 60, 54, 42, 59, 45, 47, 67, 65, 51, 57, 59, 59, 41, 45, 70, 71, 53, 53, 59, 53, 52, 52, 50, 44, 48, 61, 46, 43, 72, 48, 65, 45, 68]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.22628829535015163, "mean_inference_ms": 0.6226681732445194, "mean_action_processing_ms": 0.06723955678920938, "mean_env_wait_ms": 6.167965023053418, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005456447601318359, "StateBufferConnector_ms": 0.0031099319458007812, "ViewRequirementAgentConnector_ms": 0.07395648956298828}}, "episode_reward_max": -2.5000000000000018, "episode_reward_min": -27.300000000000054, "episode_reward_mean": -5.221999999999998, "episode_len_mean": 60.48, "episodes_this_iter": 70, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-7.699999999999994, -6.699999999999997, -5.1, -5.499999999999993, -16.999999999999986, -3.799999999999999, -5.199999999999994, -6.0999999999999925, -2.600000000000002, -4.099999999999998, -5.499999999999994, -3.8999999999999986, -5.099999999999995, -5.499999999999993, -3.9999999999999982, -4.799999999999996, -4.599999999999996, -5.399999999999997, -5.299999999999997, -6.099999999999994, -4.199999999999998, -3.5, -6.100000000000004, -4.899999999999995, -5.399999999999997, -5.999999999999997, -4.8999999999999995, -5.499999999999995, -5.199999999999998, -4.799999999999995, -27.300000000000054, -3.799999999999999, -9.299999999999992, -2.600000000000002, -5.899999999999992, -5.799999999999993, -4.999999999999995, -3.9999999999999982, -5.299999999999994, -3.5999999999999996, -4.799999999999998, -3.8, -4.299999999999997, -4.999999999999997, -5.099999999999999, -4.899999999999995, -19.50000000000001, -2.700000000000002, -3.200000000000001, -3.9999999999999982, -3.9999999999999982, -2.5000000000000018, -5.199999999999999, -3.5999999999999996, -6.6999999999999895, -4.099999999999999, -5.5999999999999925, -3.9999999999999982, -3.799999999999999, -3.8999999999999986, -4.699999999999996, -3.9999999999999982, -4.1, -5.499999999999993, -5.999999999999991, -4.3, -4.799999999999998, -4.899999999999995, -4.9, -3.1000000000000014, -4.9999999999999964, -3.4000000000000004, -3.5999999999999996, -6.199999999999996, -5.399999999999993, -4.5, -4.599999999999996, -4.799999999999995, -5.399999999999999, -3.0000000000000018, -3.8000000000000016, -5.999999999999992, -7.6, -4.299999999999998, -4.399999999999998, -4.799999999999995, -4.1999999999999975, -4.699999999999999, -4.299999999999999, -3.8999999999999986, -3.3000000000000007, -3.6999999999999993, -5.399999999999997, -3.5, -3.200000000000001, -6.499999999999993, -3.6999999999999993, -5.399999999999993, -3.4000000000000004, -6.099999999999994], "episode_lengths": [79, 69, 56, 66, 175, 49, 63, 70, 37, 52, 65, 50, 61, 66, 50, 58, 57, 60, 60, 68, 52, 46, 52, 60, 61, 64, 55, 64, 58, 59, 242, 49, 86, 37, 69, 68, 61, 51, 64, 47, 56, 45, 54, 57, 57, 60, 193, 38, 43, 51, 51, 36, 56, 47, 77, 47, 67, 51, 49, 50, 58, 51, 50, 66, 71, 51, 56, 60, 54, 42, 59, 45, 47, 67, 65, 51, 57, 59, 59, 41, 45, 70, 71, 53, 53, 59, 53, 52, 52, 50, 44, 48, 61, 46, 43, 72, 48, 65, 45, 68]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.22628829535015163, "mean_inference_ms": 0.6226681732445194, "mean_action_processing_ms": 0.06723955678920938, "mean_env_wait_ms": 6.167965023053418, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005456447601318359, "StateBufferConnector_ms": 0.0031099319458007812, "ViewRequirementAgentConnector_ms": 0.07395648956298828}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000, "num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 362.0803565464708, "num_env_steps_trained_throughput_per_sec": 362.0803565464708, "timesteps_total": 96000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 96000, "timers": {"training_iteration_time_ms": 10826.031, "sample_time_ms": 7352.213, "load_time_ms": 0.976, "load_throughput": 4098902.055, "learn_time_ms": 3469.21, "learn_throughput": 1153.0, "synch_weights_time_ms": 2.993}, "counters": {"num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000}, "done": false, "episodes_total": 732, "training_iteration": 24, "trial_id": "83204_00000", "date": "2024-03-07_12-07-06", "timestamp": 1709831226, "time_this_iter_s": 11.04962968826294, "time_total_s": 256.34359073638916, "pid": 102666, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fcd19c36f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 256.34359073638916, "iterations_since_restore": 24, "perf": {"cpu_util_percent": 20.564285714285717, "ram_util_percent": 44.0, "gpu_util_percent0": 0.07428571428571429, "vram_util_percent0": 0.10654994419642858}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 1.5153434896363467, "policy_loss": -0.008725207154789279, "vf_loss": 1.5222865635028449, "vf_explained_var": 0.5906206582182197, "kl": 0.008910687941780602, "entropy": 0.8032165253034202, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 22785.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_agent_steps_sampled": 100000, "num_agent_steps_trained": 100000}, "sampler_results": {"episode_reward_max": -2.1000000000000014, "episode_reward_min": -48.00000000000037, "episode_reward_mean": -4.9810000000000025, "episode_len_mean": 57.64, "episode_media": {}, "episodes_this_iter": 66, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4.799999999999998, -4.899999999999995, -4.9, -3.1000000000000014, -4.9999999999999964, -3.4000000000000004, -3.5999999999999996, -6.199999999999996, -5.399999999999993, -4.5, -4.599999999999996, -4.799999999999995, -5.399999999999999, -3.0000000000000018, -3.8000000000000016, -5.999999999999992, -7.6, -4.299999999999998, -4.399999999999998, -4.799999999999995, -4.1999999999999975, -4.699999999999999, -4.299999999999999, -3.8999999999999986, -3.3000000000000007, -3.6999999999999993, -5.399999999999997, -3.5, -3.200000000000001, -6.499999999999993, -3.6999999999999993, -5.399999999999993, -3.4000000000000004, -6.099999999999994, -3.6999999999999993, -4.399999999999999, -3.5999999999999996, -2.800000000000002, -3.6999999999999993, -5.999999999999997, -2.4000000000000017, -48.00000000000037, -4.299999999999997, -4.899999999999995, -4.299999999999998, -5.899999999999999, -4.1999999999999975, -6.100000000000001, -3.200000000000001, -4.399999999999997, -4.399999999999997, -21.50000000000005, -3.0000000000000018, -4.099999999999998, -4.3999999999999995, -4.9, -3.5, -5.5999999999999925, -4.899999999999995, -3.8999999999999986, -3.0000000000000018, -3.5, -3.5999999999999996, -3.5999999999999996, -3.3000000000000007, -3.1000000000000014, -4.299999999999997, -5.1999999999999975, -2.800000000000002, -3.200000000000001, -4.099999999999998, -4.399999999999997, -3.799999999999999, -3.9000000000000012, -5.099999999999998, -5.399999999999995, -5.299999999999997, -5.999999999999996, -2.1000000000000014, -3.8999999999999986, -4.199999999999999, -4.1999999999999975, -3.500000000000001, -5.699999999999992, -12.89999999999998, -3.0000000000000018, -2.600000000000002, -5.099999999999997, -6.0, -3.7, -5.799999999999993, -6.499999999999996, -3.200000000000001, -3.6999999999999993, -4.199999999999999, -2.1000000000000014, -3.1000000000000014, -3.1000000000000014, -3.9999999999999982, -3.9999999999999982], "episode_lengths": [56, 60, 54, 42, 59, 45, 47, 67, 65, 51, 57, 59, 59, 41, 45, 70, 71, 53, 53, 59, 53, 52, 52, 50, 44, 48, 61, 46, 43, 72, 48, 65, 45, 68, 48, 51, 47, 39, 48, 64, 34, 400, 54, 60, 53, 62, 53, 59, 41, 55, 55, 208, 41, 52, 52, 54, 46, 67, 60, 50, 41, 46, 47, 47, 44, 42, 54, 59, 39, 43, 52, 55, 49, 47, 58, 60, 60, 66, 32, 50, 51, 53, 45, 68, 108, 41, 37, 59, 59, 47, 68, 69, 43, 48, 51, 32, 42, 42, 46, 51]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2289602886349409, "mean_inference_ms": 0.6233788372230117, "mean_action_processing_ms": 0.06716922229698967, "mean_env_wait_ms": 6.183591931131666, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00583958625793457, "StateBufferConnector_ms": 0.0032150745391845703, "ViewRequirementAgentConnector_ms": 0.07529902458190918}}, "episode_reward_max": -2.1000000000000014, "episode_reward_min": -48.00000000000037, "episode_reward_mean": -4.9810000000000025, "episode_len_mean": 57.64, "episodes_this_iter": 66, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-4.799999999999998, -4.899999999999995, -4.9, -3.1000000000000014, -4.9999999999999964, -3.4000000000000004, -3.5999999999999996, -6.199999999999996, -5.399999999999993, -4.5, -4.599999999999996, -4.799999999999995, -5.399999999999999, -3.0000000000000018, -3.8000000000000016, -5.999999999999992, -7.6, -4.299999999999998, -4.399999999999998, -4.799999999999995, -4.1999999999999975, -4.699999999999999, -4.299999999999999, -3.8999999999999986, -3.3000000000000007, -3.6999999999999993, -5.399999999999997, -3.5, -3.200000000000001, -6.499999999999993, -3.6999999999999993, -5.399999999999993, -3.4000000000000004, -6.099999999999994, -3.6999999999999993, -4.399999999999999, -3.5999999999999996, -2.800000000000002, -3.6999999999999993, -5.999999999999997, -2.4000000000000017, -48.00000000000037, -4.299999999999997, -4.899999999999995, -4.299999999999998, -5.899999999999999, -4.1999999999999975, -6.100000000000001, -3.200000000000001, -4.399999999999997, -4.399999999999997, -21.50000000000005, -3.0000000000000018, -4.099999999999998, -4.3999999999999995, -4.9, -3.5, -5.5999999999999925, -4.899999999999995, -3.8999999999999986, -3.0000000000000018, -3.5, -3.5999999999999996, -3.5999999999999996, -3.3000000000000007, -3.1000000000000014, -4.299999999999997, -5.1999999999999975, -2.800000000000002, -3.200000000000001, -4.099999999999998, -4.399999999999997, -3.799999999999999, -3.9000000000000012, -5.099999999999998, -5.399999999999995, -5.299999999999997, -5.999999999999996, -2.1000000000000014, -3.8999999999999986, -4.199999999999999, -4.1999999999999975, -3.500000000000001, -5.699999999999992, -12.89999999999998, -3.0000000000000018, -2.600000000000002, -5.099999999999997, -6.0, -3.7, -5.799999999999993, -6.499999999999996, -3.200000000000001, -3.6999999999999993, -4.199999999999999, -2.1000000000000014, -3.1000000000000014, -3.1000000000000014, -3.9999999999999982, -3.9999999999999982], "episode_lengths": [56, 60, 54, 42, 59, 45, 47, 67, 65, 51, 57, 59, 59, 41, 45, 70, 71, 53, 53, 59, 53, 52, 52, 50, 44, 48, 61, 46, 43, 72, 48, 65, 45, 68, 48, 51, 47, 39, 48, 64, 34, 400, 54, 60, 53, 62, 53, 59, 41, 55, 55, 208, 41, 52, 52, 54, 46, 67, 60, 50, 41, 46, 47, 47, 44, 42, 54, 59, 39, 43, 52, 55, 49, 47, 58, 60, 60, 66, 32, 50, 51, 53, 45, 68, 108, 41, 37, 59, 59, 47, 68, 69, 43, 48, 51, 32, 42, 42, 46, 51]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2289602886349409, "mean_inference_ms": 0.6233788372230117, "mean_action_processing_ms": 0.06716922229698967, "mean_env_wait_ms": 6.183591931131666, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00583958625793457, "StateBufferConnector_ms": 0.0032150745391845703, "ViewRequirementAgentConnector_ms": 0.07529902458190918}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 100000, "num_agent_steps_trained": 100000, "num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 361.4427249703166, "num_env_steps_trained_throughput_per_sec": 361.4427249703166, "timesteps_total": 100000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 100000, "timers": {"training_iteration_time_ms": 10848.218, "sample_time_ms": 7381.083, "load_time_ms": 0.975, "load_throughput": 4104517.676, "learn_time_ms": 3462.527, "learn_throughput": 1155.226, "synch_weights_time_ms": 2.995}, "counters": {"num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_agent_steps_sampled": 100000, "num_agent_steps_trained": 100000}, "done": false, "episodes_total": 798, "training_iteration": 25, "trial_id": "83204_00000", "date": "2024-03-07_12-07-17", "timestamp": 1709831237, "time_this_iter_s": 11.069014549255371, "time_total_s": 267.41260528564453, "pid": 102666, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fcd19c36f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 267.41260528564453, "iterations_since_restore": 25, "perf": {"cpu_util_percent": 19.360000000000003, "ram_util_percent": 44.0, "gpu_util_percent0": 0.08466666666666667, "vram_util_percent0": 0.098876953125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 1.43796554079069, "policy_loss": -0.010188785283475794, "vf_loss": 1.4461221328786305, "vf_explained_var": 0.5927749153747354, "kl": 0.010160998105692943, "entropy": 0.7750211113242693, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 23715.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 104000, "num_env_steps_trained": 104000, "num_agent_steps_sampled": 104000, "num_agent_steps_trained": 104000}, "sampler_results": {"episode_reward_max": -1.9000000000000012, "episode_reward_min": -16.999999999999993, "episode_reward_mean": -4.233999999999998, "episode_len_mean": 51.28, "episode_media": {}, "episodes_this_iter": 77, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-5.999999999999996, -2.1000000000000014, -3.8999999999999986, -4.199999999999999, -4.1999999999999975, -3.500000000000001, -5.699999999999992, -12.89999999999998, -3.0000000000000018, -2.600000000000002, -5.099999999999997, -6.0, -3.7, -5.799999999999993, -6.499999999999996, -3.200000000000001, -3.6999999999999993, -4.199999999999999, -2.1000000000000014, -3.1000000000000014, -3.1000000000000014, -3.9999999999999982, -3.9999999999999982, -3.799999999999999, -3.200000000000001, -4.399999999999997, -3.0000000000000018, -3.200000000000001, -3.0000000000000018, -3.0000000000000018, -6.500000000000001, -7.099999999999998, -2.800000000000002, -3.0000000000000018, -7.699999999999987, -4.1999999999999975, -2.3000000000000016, -8.199999999999985, -4.999999999999995, -4.099999999999998, -3.6999999999999993, -2.900000000000002, -4.900000000000001, -4.699999999999996, -2.600000000000002, -2.600000000000002, -6.000000000000003, -2.3000000000000016, -16.999999999999993, -2.5000000000000018, -3.9999999999999982, -4.299999999999997, -2.5000000000000018, -3.8999999999999986, -4.3, -2.900000000000002, -2.1000000000000014, -3.1000000000000014, -2.5000000000000018, -7.999999999999989, -2.900000000000002, -3.799999999999999, -4.299999999999999, -4.599999999999997, -4.7, -5.699999999999996, -3.4000000000000004, -3.5999999999999996, -3.3000000000000007, -2.4000000000000017, -2.1000000000000014, -3.1000000000000014, -3.8999999999999986, -4.799999999999995, -2.1000000000000014, -2.600000000000002, -4.299999999999999, -5.099999999999994, -3.4000000000000004, -2.600000000000002, -4.899999999999995, -5.299999999999994, -4.5, -12.399999999999977, -3.200000000000001, -3.3000000000000007, -3.3000000000000007, -3.999999999999999, -3.9999999999999982, -10.199999999999978, -1.9000000000000012, -4.899999999999995, -3.1000000000000014, -3.799999999999999, -3.8999999999999986, -2.800000000000002, -3.5999999999999996, -2.0000000000000013, -3.4000000000000012, -2.3000000000000016], "episode_lengths": [66, 32, 50, 51, 53, 45, 68, 108, 41, 37, 59, 59, 47, 68, 69, 43, 48, 51, 32, 42, 42, 46, 51, 49, 43, 55, 41, 43, 41, 41, 63, 70, 39, 41, 85, 49, 34, 92, 61, 52, 48, 40, 52, 58, 37, 37, 56, 34, 173, 36, 51, 54, 36, 49, 50, 40, 32, 42, 36, 80, 40, 49, 52, 56, 52, 64, 45, 43, 44, 35, 32, 42, 50, 59, 32, 37, 52, 62, 45, 37, 60, 64, 52, 106, 43, 44, 44, 50, 51, 112, 30, 60, 42, 49, 50, 39, 47, 31, 44, 34]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23141812142641768, "mean_inference_ms": 0.6232716577423293, "mean_action_processing_ms": 0.0673177971095887, "mean_env_wait_ms": 6.1996197453889685, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005486965179443359, "StateBufferConnector_ms": 0.0032002925872802734, "ViewRequirementAgentConnector_ms": 0.07405447959899902}}, "episode_reward_max": -1.9000000000000012, "episode_reward_min": -16.999999999999993, "episode_reward_mean": -4.233999999999998, "episode_len_mean": 51.28, "episodes_this_iter": 77, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-5.999999999999996, -2.1000000000000014, -3.8999999999999986, -4.199999999999999, -4.1999999999999975, -3.500000000000001, -5.699999999999992, -12.89999999999998, -3.0000000000000018, -2.600000000000002, -5.099999999999997, -6.0, -3.7, -5.799999999999993, -6.499999999999996, -3.200000000000001, -3.6999999999999993, -4.199999999999999, -2.1000000000000014, -3.1000000000000014, -3.1000000000000014, -3.9999999999999982, -3.9999999999999982, -3.799999999999999, -3.200000000000001, -4.399999999999997, -3.0000000000000018, -3.200000000000001, -3.0000000000000018, -3.0000000000000018, -6.500000000000001, -7.099999999999998, -2.800000000000002, -3.0000000000000018, -7.699999999999987, -4.1999999999999975, -2.3000000000000016, -8.199999999999985, -4.999999999999995, -4.099999999999998, -3.6999999999999993, -2.900000000000002, -4.900000000000001, -4.699999999999996, -2.600000000000002, -2.600000000000002, -6.000000000000003, -2.3000000000000016, -16.999999999999993, -2.5000000000000018, -3.9999999999999982, -4.299999999999997, -2.5000000000000018, -3.8999999999999986, -4.3, -2.900000000000002, -2.1000000000000014, -3.1000000000000014, -2.5000000000000018, -7.999999999999989, -2.900000000000002, -3.799999999999999, -4.299999999999999, -4.599999999999997, -4.7, -5.699999999999996, -3.4000000000000004, -3.5999999999999996, -3.3000000000000007, -2.4000000000000017, -2.1000000000000014, -3.1000000000000014, -3.8999999999999986, -4.799999999999995, -2.1000000000000014, -2.600000000000002, -4.299999999999999, -5.099999999999994, -3.4000000000000004, -2.600000000000002, -4.899999999999995, -5.299999999999994, -4.5, -12.399999999999977, -3.200000000000001, -3.3000000000000007, -3.3000000000000007, -3.999999999999999, -3.9999999999999982, -10.199999999999978, -1.9000000000000012, -4.899999999999995, -3.1000000000000014, -3.799999999999999, -3.8999999999999986, -2.800000000000002, -3.5999999999999996, -2.0000000000000013, -3.4000000000000012, -2.3000000000000016], "episode_lengths": [66, 32, 50, 51, 53, 45, 68, 108, 41, 37, 59, 59, 47, 68, 69, 43, 48, 51, 32, 42, 42, 46, 51, 49, 43, 55, 41, 43, 41, 41, 63, 70, 39, 41, 85, 49, 34, 92, 61, 52, 48, 40, 52, 58, 37, 37, 56, 34, 173, 36, 51, 54, 36, 49, 50, 40, 32, 42, 36, 80, 40, 49, 52, 56, 52, 64, 45, 43, 44, 35, 32, 42, 50, 59, 32, 37, 52, 62, 45, 37, 60, 64, 52, 106, 43, 44, 44, 50, 51, 112, 30, 60, 42, 49, 50, 39, 47, 31, 44, 34]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23141812142641768, "mean_inference_ms": 0.6232716577423293, "mean_action_processing_ms": 0.0673177971095887, "mean_env_wait_ms": 6.1996197453889685, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005486965179443359, "StateBufferConnector_ms": 0.0032002925872802734, "ViewRequirementAgentConnector_ms": 0.07405447959899902}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 104000, "num_agent_steps_trained": 104000, "num_env_steps_sampled": 104000, "num_env_steps_trained": 104000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 353.36218409854837, "num_env_steps_trained_throughput_per_sec": 353.36218409854837, "timesteps_total": 104000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 104000, "timers": {"training_iteration_time_ms": 10913.983, "sample_time_ms": 7452.214, "load_time_ms": 0.975, "load_throughput": 4102410.016, "learn_time_ms": 3457.155, "learn_throughput": 1157.021, "synch_weights_time_ms": 2.999}, "counters": {"num_env_steps_sampled": 104000, "num_env_steps_trained": 104000, "num_agent_steps_sampled": 104000, "num_agent_steps_trained": 104000}, "done": false, "episodes_total": 875, "training_iteration": 26, "trial_id": "83204_00000", "date": "2024-03-07_12-07-28", "timestamp": 1709831248, "time_this_iter_s": 11.322428941726685, "time_total_s": 278.7350342273712, "pid": 102666, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fcd19c36f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 278.7350342273712, "iterations_since_restore": 26, "perf": {"cpu_util_percent": 20.45, "ram_util_percent": 44.050000000000004, "gpu_util_percent0": 0.07714285714285715, "vram_util_percent0": 0.098876953125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 1.9275340101215364, "policy_loss": -0.013491307807865963, "vf_loss": 1.9395047953212132, "vf_explained_var": 0.49201477932673626, "kl": 0.007602612695684336, "entropy": 0.7855665781805592, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 24645.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_agent_steps_sampled": 108000, "num_agent_steps_trained": 108000}, "sampler_results": {"episode_reward_max": -1.9000000000000012, "episode_reward_min": -43.50000000000035, "episode_reward_mean": -4.828000000000004, "episode_len_mean": 56.73, "episode_media": {}, "episodes_this_iter": 69, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2.4000000000000017, -2.1000000000000014, -3.1000000000000014, -3.8999999999999986, -4.799999999999995, -2.1000000000000014, -2.600000000000002, -4.299999999999999, -5.099999999999994, -3.4000000000000004, -2.600000000000002, -4.899999999999995, -5.299999999999994, -4.5, -12.399999999999977, -3.200000000000001, -3.3000000000000007, -3.3000000000000007, -3.999999999999999, -3.9999999999999982, -10.199999999999978, -1.9000000000000012, -4.899999999999995, -3.1000000000000014, -3.799999999999999, -3.8999999999999986, -2.800000000000002, -3.5999999999999996, -2.0000000000000013, -3.4000000000000012, -2.3000000000000016, -3.1000000000000014, -4.099999999999999, -2.900000000000002, -3.6999999999999993, -3.1000000000000014, -4.799999999999999, -2.800000000000002, -3.1000000000000014, -8.199999999999996, -3.1000000000000014, -4.100000000000001, -5.299999999999994, -2.5000000000000018, -4.4, -3.799999999999999, -3.5999999999999996, -4.600000000000001, -4.599999999999996, -3.0000000000000018, -5.7999999999999945, -4.299999999999997, -3.799999999999999, -3.9999999999999982, -2.5000000000000018, -3.5, -5.099999999999996, -20.70000000000003, -2.600000000000002, -3.9999999999999982, -2.3000000000000016, -3.4000000000000004, -3.900000000000002, -3.7, -3.4000000000000012, -3.200000000000001, -2.5000000000000018, -5.099999999999996, -3.1000000000000014, -4.299999999999997, -19.90000000000003, -5.199999999999994, -28.000000000000146, -4.199999999999998, -2.800000000000002, -2.3000000000000016, -2.700000000000002, -3.9999999999999982, -2.800000000000002, -2.700000000000002, -2.900000000000002, -4.000000000000001, -3.200000000000001, -3.3000000000000007, -4.900000000000001, -3.1000000000000014, -2.900000000000002, -3.9999999999999982, -2.900000000000002, -3.3000000000000007, -3.0000000000000018, -4.9999999999999964, -4.4999999999999964, -3.0000000000000018, -3.8999999999999986, -2.800000000000002, -5.7, -9.699999999999996, -3.4000000000000004, -43.50000000000035], "episode_lengths": [35, 32, 42, 50, 59, 32, 37, 52, 62, 45, 37, 60, 64, 52, 106, 43, 44, 44, 50, 51, 112, 30, 60, 42, 49, 50, 39, 47, 31, 44, 34, 42, 51, 40, 48, 42, 55, 39, 42, 73, 42, 48, 64, 36, 51, 49, 47, 51, 57, 41, 57, 54, 49, 51, 36, 46, 60, 200, 37, 51, 34, 44, 45, 47, 44, 43, 36, 60, 42, 54, 189, 63, 276, 52, 39, 34, 38, 51, 39, 38, 40, 46, 43, 44, 53, 42, 40, 51, 40, 44, 38, 59, 56, 40, 50, 39, 59, 82, 45, 400]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23359124569106313, "mean_inference_ms": 0.6233537485775064, "mean_action_processing_ms": 0.06734794704027261, "mean_env_wait_ms": 6.212397796837142, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0052509307861328125, "StateBufferConnector_ms": 0.0030622482299804688, "ViewRequirementAgentConnector_ms": 0.07332420349121094}}, "episode_reward_max": -1.9000000000000012, "episode_reward_min": -43.50000000000035, "episode_reward_mean": -4.828000000000004, "episode_len_mean": 56.73, "episodes_this_iter": 69, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-2.4000000000000017, -2.1000000000000014, -3.1000000000000014, -3.8999999999999986, -4.799999999999995, -2.1000000000000014, -2.600000000000002, -4.299999999999999, -5.099999999999994, -3.4000000000000004, -2.600000000000002, -4.899999999999995, -5.299999999999994, -4.5, -12.399999999999977, -3.200000000000001, -3.3000000000000007, -3.3000000000000007, -3.999999999999999, -3.9999999999999982, -10.199999999999978, -1.9000000000000012, -4.899999999999995, -3.1000000000000014, -3.799999999999999, -3.8999999999999986, -2.800000000000002, -3.5999999999999996, -2.0000000000000013, -3.4000000000000012, -2.3000000000000016, -3.1000000000000014, -4.099999999999999, -2.900000000000002, -3.6999999999999993, -3.1000000000000014, -4.799999999999999, -2.800000000000002, -3.1000000000000014, -8.199999999999996, -3.1000000000000014, -4.100000000000001, -5.299999999999994, -2.5000000000000018, -4.4, -3.799999999999999, -3.5999999999999996, -4.600000000000001, -4.599999999999996, -3.0000000000000018, -5.7999999999999945, -4.299999999999997, -3.799999999999999, -3.9999999999999982, -2.5000000000000018, -3.5, -5.099999999999996, -20.70000000000003, -2.600000000000002, -3.9999999999999982, -2.3000000000000016, -3.4000000000000004, -3.900000000000002, -3.7, -3.4000000000000012, -3.200000000000001, -2.5000000000000018, -5.099999999999996, -3.1000000000000014, -4.299999999999997, -19.90000000000003, -5.199999999999994, -28.000000000000146, -4.199999999999998, -2.800000000000002, -2.3000000000000016, -2.700000000000002, -3.9999999999999982, -2.800000000000002, -2.700000000000002, -2.900000000000002, -4.000000000000001, -3.200000000000001, -3.3000000000000007, -4.900000000000001, -3.1000000000000014, -2.900000000000002, -3.9999999999999982, -2.900000000000002, -3.3000000000000007, -3.0000000000000018, -4.9999999999999964, -4.4999999999999964, -3.0000000000000018, -3.8999999999999986, -2.800000000000002, -5.7, -9.699999999999996, -3.4000000000000004, -43.50000000000035], "episode_lengths": [35, 32, 42, 50, 59, 32, 37, 52, 62, 45, 37, 60, 64, 52, 106, 43, 44, 44, 50, 51, 112, 30, 60, 42, 49, 50, 39, 47, 31, 44, 34, 42, 51, 40, 48, 42, 55, 39, 42, 73, 42, 48, 64, 36, 51, 49, 47, 51, 57, 41, 57, 54, 49, 51, 36, 46, 60, 200, 37, 51, 34, 44, 45, 47, 44, 43, 36, 60, 42, 54, 189, 63, 276, 52, 39, 34, 38, 51, 39, 38, 40, 46, 43, 44, 53, 42, 40, 51, 40, 44, 38, 59, 56, 40, 50, 39, 59, 82, 45, 400]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23359124569106313, "mean_inference_ms": 0.6233537485775064, "mean_action_processing_ms": 0.06734794704027261, "mean_env_wait_ms": 6.212397796837142, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0052509307861328125, "StateBufferConnector_ms": 0.0030622482299804688, "ViewRequirementAgentConnector_ms": 0.07332420349121094}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 108000, "num_agent_steps_trained": 108000, "num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 350.7707155279223, "num_env_steps_trained_throughput_per_sec": 350.7707155279223, "timesteps_total": 108000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 108000, "timers": {"training_iteration_time_ms": 10987.216, "sample_time_ms": 7512.955, "load_time_ms": 0.973, "load_throughput": 4109443.982, "learn_time_ms": 3469.648, "learn_throughput": 1152.855, "synch_weights_time_ms": 3.002}, "counters": {"num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_agent_steps_sampled": 108000, "num_agent_steps_trained": 108000}, "done": false, "episodes_total": 944, "training_iteration": 27, "trial_id": "83204_00000", "date": "2024-03-07_12-07-40", "timestamp": 1709831260, "time_this_iter_s": 11.406034231185913, "time_total_s": 290.14106845855713, "pid": 102666, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fcd19c36f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 290.14106845855713, "iterations_since_restore": 27, "perf": {"cpu_util_percent": 19.30666666666667, "ram_util_percent": 44.013333333333335, "gpu_util_percent0": 0.08066666666666666, "vram_util_percent0": 0.098876953125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 0.7029767780026461, "policy_loss": -0.013309162442562401, "vf_loss": 0.7148697562756077, "vf_explained_var": 0.7829812005642922, "kl": 0.007080924980778781, "entropy": 0.7347384022128197, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 25575.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_agent_steps_sampled": 112000, "num_agent_steps_trained": 112000}, "sampler_results": {"episode_reward_max": -2.0000000000000013, "episode_reward_min": -43.50000000000035, "episode_reward_mean": -4.200000000000002, "episode_len_mean": 50.95, "episode_media": {}, "episodes_this_iter": 84, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4.900000000000001, -3.1000000000000014, -2.900000000000002, -3.9999999999999982, -2.900000000000002, -3.3000000000000007, -3.0000000000000018, -4.9999999999999964, -4.4999999999999964, -3.0000000000000018, -3.8999999999999986, -2.800000000000002, -5.7, -9.699999999999996, -3.4000000000000004, -43.50000000000035, -3.4000000000000004, -4.1999999999999975, -4.399999999999997, -3.9999999999999982, -2.700000000000002, -2.700000000000002, -3.4000000000000004, -4.099999999999999, -5.099999999999995, -2.4000000000000017, -3.5999999999999996, -3.0000000000000018, -3.0000000000000018, -3.5999999999999996, -3.1000000000000014, -3.5, -2.600000000000002, -3.4000000000000004, -3.799999999999999, -3.200000000000001, -3.200000000000001, -2.5000000000000018, -3.1000000000000014, -5.299999999999996, -3.6999999999999993, -5.1000000000000005, -4.599999999999998, -3.8999999999999986, -2.3000000000000016, -3.5999999999999996, -2.800000000000002, -3.3000000000000007, -2.0000000000000013, -2.2000000000000015, -2.1000000000000014, -2.700000000000002, -3.200000000000001, -3.8999999999999986, -9.399999999999979, -2.5000000000000018, -2.600000000000002, -2.800000000000002, -2.900000000000002, -3.0000000000000018, -4.999999999999997, -3.4000000000000004, -4.699999999999997, -14.89999999999997, -2.800000000000002, -2.700000000000002, -5.399999999999999, -6.299999999999996, -4.899999999999998, -4.799999999999999, -3.5, -3.8, -3.3000000000000007, -3.4000000000000004, -4.8, -2.700000000000002, -2.600000000000002, -6.000000000000002, -2.800000000000002, -3.799999999999999, -3.0000000000000018, -3.1000000000000014, -4.999999999999995, -3.4000000000000004, -3.9999999999999982, -5.399999999999997, -2.4000000000000017, -3.4000000000000004, -2.1000000000000014, -3.3000000000000007, -3.4000000000000004, -2.700000000000002, -4.1999999999999975, -4.099999999999998, -3.5, -3.5999999999999996, -3.200000000000001, -3.799999999999999, -2.900000000000002, -4.399999999999999], "episode_lengths": [53, 42, 40, 51, 40, 44, 38, 59, 56, 40, 50, 39, 59, 82, 45, 400, 45, 53, 55, 51, 38, 38, 45, 48, 61, 35, 47, 41, 41, 47, 42, 46, 37, 45, 49, 43, 43, 36, 42, 61, 48, 55, 55, 50, 34, 44, 39, 44, 31, 33, 32, 38, 43, 49, 105, 36, 37, 39, 40, 41, 58, 45, 57, 133, 39, 38, 59, 67, 56, 55, 46, 47, 44, 45, 54, 38, 37, 58, 39, 49, 41, 42, 61, 45, 51, 52, 35, 45, 32, 44, 45, 38, 53, 52, 44, 47, 43, 49, 40, 52]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23637341461454597, "mean_inference_ms": 0.6237873280307619, "mean_action_processing_ms": 0.06743992285043382, "mean_env_wait_ms": 6.230150207714689, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005402326583862305, "StateBufferConnector_ms": 0.003206491470336914, "ViewRequirementAgentConnector_ms": 0.07497000694274902}}, "episode_reward_max": -2.0000000000000013, "episode_reward_min": -43.50000000000035, "episode_reward_mean": -4.200000000000002, "episode_len_mean": 50.95, "episodes_this_iter": 84, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-4.900000000000001, -3.1000000000000014, -2.900000000000002, -3.9999999999999982, -2.900000000000002, -3.3000000000000007, -3.0000000000000018, -4.9999999999999964, -4.4999999999999964, -3.0000000000000018, -3.8999999999999986, -2.800000000000002, -5.7, -9.699999999999996, -3.4000000000000004, -43.50000000000035, -3.4000000000000004, -4.1999999999999975, -4.399999999999997, -3.9999999999999982, -2.700000000000002, -2.700000000000002, -3.4000000000000004, -4.099999999999999, -5.099999999999995, -2.4000000000000017, -3.5999999999999996, -3.0000000000000018, -3.0000000000000018, -3.5999999999999996, -3.1000000000000014, -3.5, -2.600000000000002, -3.4000000000000004, -3.799999999999999, -3.200000000000001, -3.200000000000001, -2.5000000000000018, -3.1000000000000014, -5.299999999999996, -3.6999999999999993, -5.1000000000000005, -4.599999999999998, -3.8999999999999986, -2.3000000000000016, -3.5999999999999996, -2.800000000000002, -3.3000000000000007, -2.0000000000000013, -2.2000000000000015, -2.1000000000000014, -2.700000000000002, -3.200000000000001, -3.8999999999999986, -9.399999999999979, -2.5000000000000018, -2.600000000000002, -2.800000000000002, -2.900000000000002, -3.0000000000000018, -4.999999999999997, -3.4000000000000004, -4.699999999999997, -14.89999999999997, -2.800000000000002, -2.700000000000002, -5.399999999999999, -6.299999999999996, -4.899999999999998, -4.799999999999999, -3.5, -3.8, -3.3000000000000007, -3.4000000000000004, -4.8, -2.700000000000002, -2.600000000000002, -6.000000000000002, -2.800000000000002, -3.799999999999999, -3.0000000000000018, -3.1000000000000014, -4.999999999999995, -3.4000000000000004, -3.9999999999999982, -5.399999999999997, -2.4000000000000017, -3.4000000000000004, -2.1000000000000014, -3.3000000000000007, -3.4000000000000004, -2.700000000000002, -4.1999999999999975, -4.099999999999998, -3.5, -3.5999999999999996, -3.200000000000001, -3.799999999999999, -2.900000000000002, -4.399999999999999], "episode_lengths": [53, 42, 40, 51, 40, 44, 38, 59, 56, 40, 50, 39, 59, 82, 45, 400, 45, 53, 55, 51, 38, 38, 45, 48, 61, 35, 47, 41, 41, 47, 42, 46, 37, 45, 49, 43, 43, 36, 42, 61, 48, 55, 55, 50, 34, 44, 39, 44, 31, 33, 32, 38, 43, 49, 105, 36, 37, 39, 40, 41, 58, 45, 57, 133, 39, 38, 59, 67, 56, 55, 46, 47, 44, 45, 54, 38, 37, 58, 39, 49, 41, 42, 61, 45, 51, 52, 35, 45, 32, 44, 45, 38, 53, 52, 44, 47, 43, 49, 40, 52]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23637341461454597, "mean_inference_ms": 0.6237873280307619, "mean_action_processing_ms": 0.06743992285043382, "mean_env_wait_ms": 6.230150207714689, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005402326583862305, "StateBufferConnector_ms": 0.003206491470336914, "ViewRequirementAgentConnector_ms": 0.07497000694274902}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 112000, "num_agent_steps_trained": 112000, "num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 354.51423490402016, "num_env_steps_trained_throughput_per_sec": 354.51423490402016, "timesteps_total": 112000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 112000, "timers": {"training_iteration_time_ms": 11041.223, "sample_time_ms": 7568.86, "load_time_ms": 2.091, "load_throughput": 1913198.011, "learn_time_ms": 3466.625, "learn_throughput": 1153.86, "synch_weights_time_ms": 3.007}, "counters": {"num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_agent_steps_sampled": 112000, "num_agent_steps_trained": 112000}, "done": false, "episodes_total": 1028, "training_iteration": 28, "trial_id": "83204_00000", "date": "2024-03-07_12-07-51", "timestamp": 1709831271, "time_this_iter_s": 11.285675525665283, "time_total_s": 301.4267439842224, "pid": 102666, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fcd19c36f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 301.4267439842224, "iterations_since_restore": 28, "perf": {"cpu_util_percent": 20.519999999999996, "ram_util_percent": 44.02666666666667, "gpu_util_percent0": 0.07133333333333332, "vram_util_percent0": 0.098876953125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 0.5464122122766385, "policy_loss": -0.01086677955163102, "vf_loss": 0.5556061077422352, "vf_explained_var": 0.7713675961699537, "kl": 0.008364412019282777, "entropy": 0.6844273914573014, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 26505.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 116000, "num_env_steps_trained": 116000, "num_agent_steps_sampled": 116000, "num_agent_steps_trained": 116000}, "sampler_results": {"episode_reward_max": -1.5000000000000009, "episode_reward_min": -16.29999999999999, "episode_reward_mean": -3.349, "episode_len_mean": 43.27, "episode_media": {}, "episodes_this_iter": 94, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.5, -3.5999999999999996, -3.200000000000001, -3.799999999999999, -2.900000000000002, -4.399999999999999, -4.799999999999995, -2.5000000000000018, -2.4000000000000017, -3.1000000000000014, -3.3000000000000016, -3.0000000000000018, -3.4000000000000004, -3.200000000000001, -3.1000000000000014, -2.5000000000000018, -2.3000000000000016, -2.800000000000002, -10.099999999999989, -2.800000000000002, -3.1000000000000014, -3.3000000000000007, -2.5000000000000018, -3.6999999999999993, -2.800000000000002, -3.1000000000000014, -2.700000000000002, -4.1999999999999975, -2.700000000000002, -2.800000000000002, -2.1000000000000014, -2.800000000000002, -3.6999999999999993, -2.1000000000000014, -2.3000000000000016, -4.1000000000000005, -2.5000000000000018, -4.999999999999995, -2.600000000000002, -3.3000000000000016, -3.5999999999999996, -5.899999999999999, -3.9999999999999982, -2.5000000000000018, -2.2000000000000015, -2.800000000000002, -2.800000000000002, -6.599999999999999, -3.3000000000000007, -2.4000000000000017, -3.1000000000000014, -2.2000000000000015, -3.8999999999999995, -16.29999999999999, -2.3000000000000016, -3.0000000000000018, -3.8999999999999986, -2.800000000000002, -2.1000000000000014, -2.700000000000002, -2.800000000000002, -3.6999999999999993, -2.900000000000002, -2.900000000000002, -2.800000000000002, -3.0000000000000018, -3.6999999999999993, -2.3000000000000016, -2.900000000000002, -2.900000000000002, -3.3000000000000007, -2.700000000000002, -3.6999999999999993, -3.3000000000000007, -2.700000000000002, -5.1000000000000005, -4.099999999999998, -3.5999999999999996, -3.1000000000000014, -2.0000000000000013, -2.5000000000000018, -3.400000000000002, -2.800000000000002, -3.4000000000000004, -3.1000000000000014, -3.0000000000000018, -4.199999999999999, -2.600000000000002, -1.9000000000000012, -1.5000000000000009, -2.600000000000002, -3.6000000000000005, -2.1000000000000014, -4.200000000000001, -5.199999999999998, -3.5, -2.600000000000002, -2.700000000000002, -3.1000000000000014, -2.900000000000002], "episode_lengths": [44, 47, 43, 49, 40, 52, 59, 36, 35, 41, 42, 41, 45, 43, 42, 36, 34, 39, 85, 39, 42, 44, 36, 48, 39, 42, 38, 53, 38, 39, 32, 39, 47, 32, 34, 49, 36, 61, 37, 41, 47, 58, 51, 36, 33, 39, 39, 66, 44, 35, 42, 33, 49, 145, 34, 41, 50, 39, 32, 38, 39, 48, 40, 40, 39, 41, 48, 34, 40, 40, 44, 36, 48, 44, 38, 55, 52, 47, 42, 31, 36, 41, 39, 45, 42, 41, 50, 37, 30, 26, 37, 46, 32, 49, 58, 46, 37, 38, 41, 40]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23979932039376306, "mean_inference_ms": 0.6239976247552329, "mean_action_processing_ms": 0.06751044313520478, "mean_env_wait_ms": 6.250984338342023, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0055599212646484375, "StateBufferConnector_ms": 0.0032265186309814453, "ViewRequirementAgentConnector_ms": 0.0745706558227539}}, "episode_reward_max": -1.5000000000000009, "episode_reward_min": -16.29999999999999, "episode_reward_mean": -3.349, "episode_len_mean": 43.27, "episodes_this_iter": 94, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3.5, -3.5999999999999996, -3.200000000000001, -3.799999999999999, -2.900000000000002, -4.399999999999999, -4.799999999999995, -2.5000000000000018, -2.4000000000000017, -3.1000000000000014, -3.3000000000000016, -3.0000000000000018, -3.4000000000000004, -3.200000000000001, -3.1000000000000014, -2.5000000000000018, -2.3000000000000016, -2.800000000000002, -10.099999999999989, -2.800000000000002, -3.1000000000000014, -3.3000000000000007, -2.5000000000000018, -3.6999999999999993, -2.800000000000002, -3.1000000000000014, -2.700000000000002, -4.1999999999999975, -2.700000000000002, -2.800000000000002, -2.1000000000000014, -2.800000000000002, -3.6999999999999993, -2.1000000000000014, -2.3000000000000016, -4.1000000000000005, -2.5000000000000018, -4.999999999999995, -2.600000000000002, -3.3000000000000016, -3.5999999999999996, -5.899999999999999, -3.9999999999999982, -2.5000000000000018, -2.2000000000000015, -2.800000000000002, -2.800000000000002, -6.599999999999999, -3.3000000000000007, -2.4000000000000017, -3.1000000000000014, -2.2000000000000015, -3.8999999999999995, -16.29999999999999, -2.3000000000000016, -3.0000000000000018, -3.8999999999999986, -2.800000000000002, -2.1000000000000014, -2.700000000000002, -2.800000000000002, -3.6999999999999993, -2.900000000000002, -2.900000000000002, -2.800000000000002, -3.0000000000000018, -3.6999999999999993, -2.3000000000000016, -2.900000000000002, -2.900000000000002, -3.3000000000000007, -2.700000000000002, -3.6999999999999993, -3.3000000000000007, -2.700000000000002, -5.1000000000000005, -4.099999999999998, -3.5999999999999996, -3.1000000000000014, -2.0000000000000013, -2.5000000000000018, -3.400000000000002, -2.800000000000002, -3.4000000000000004, -3.1000000000000014, -3.0000000000000018, -4.199999999999999, -2.600000000000002, -1.9000000000000012, -1.5000000000000009, -2.600000000000002, -3.6000000000000005, -2.1000000000000014, -4.200000000000001, -5.199999999999998, -3.5, -2.600000000000002, -2.700000000000002, -3.1000000000000014, -2.900000000000002], "episode_lengths": [44, 47, 43, 49, 40, 52, 59, 36, 35, 41, 42, 41, 45, 43, 42, 36, 34, 39, 85, 39, 42, 44, 36, 48, 39, 42, 38, 53, 38, 39, 32, 39, 47, 32, 34, 49, 36, 61, 37, 41, 47, 58, 51, 36, 33, 39, 39, 66, 44, 35, 42, 33, 49, 145, 34, 41, 50, 39, 32, 38, 39, 48, 40, 40, 39, 41, 48, 34, 40, 40, 44, 36, 48, 44, 38, 55, 52, 47, 42, 31, 36, 41, 39, 45, 42, 41, 50, 37, 30, 26, 37, 46, 32, 49, 58, 46, 37, 38, 41, 40]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23979932039376306, "mean_inference_ms": 0.6239976247552329, "mean_action_processing_ms": 0.06751044313520478, "mean_env_wait_ms": 6.250984338342023, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0055599212646484375, "StateBufferConnector_ms": 0.0032265186309814453, "ViewRequirementAgentConnector_ms": 0.0745706558227539}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 116000, "num_agent_steps_trained": 116000, "num_env_steps_sampled": 116000, "num_env_steps_trained": 116000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 348.3093635757551, "num_env_steps_trained_throughput_per_sec": 348.3093635757551, "timesteps_total": 116000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 116000, "timers": {"training_iteration_time_ms": 11120.636, "sample_time_ms": 7652.42, "load_time_ms": 2.091, "load_throughput": 1912718.152, "learn_time_ms": 3462.47, "learn_throughput": 1155.245, "synch_weights_time_ms": 3.006}, "counters": {"num_env_steps_sampled": 116000, "num_env_steps_trained": 116000, "num_agent_steps_sampled": 116000, "num_agent_steps_trained": 116000}, "done": false, "episodes_total": 1122, "training_iteration": 29, "trial_id": "83204_00000", "date": "2024-03-07_12-08-03", "timestamp": 1709831283, "time_this_iter_s": 11.486629724502563, "time_total_s": 312.913373708725, "pid": 102666, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fcd19c36f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 312.913373708725, "iterations_since_restore": 29, "perf": {"cpu_util_percent": 19.906666666666663, "ram_util_percent": 44.06000000000001, "gpu_util_percent0": 0.07533333333333334, "vram_util_percent0": 0.098876953125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 0.5898743233067655, "policy_loss": -0.004954645374128895, "vf_loss": 0.5933590359405003, "vf_explained_var": 0.8230412626138297, "kl": 0.007349677721485339, "entropy": 0.6682495831802328, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 27435.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 120000, "num_env_steps_trained": 120000, "num_agent_steps_sampled": 120000, "num_agent_steps_trained": 120000}, "sampler_results": {"episode_reward_max": -1.8000000000000012, "episode_reward_min": -22.40000000000001, "episode_reward_mean": -3.1120000000000014, "episode_len_mean": 41.16, "episode_media": {}, "episodes_this_iter": 97, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2.700000000000002, -3.1000000000000014, -2.900000000000002, -3.0000000000000018, -4.599999999999996, -2.2000000000000015, -1.8000000000000012, -2.4000000000000017, -3.0000000000000018, -3.200000000000001, -3.200000000000001, -3.8999999999999986, -3.4000000000000004, -2.900000000000002, -2.600000000000002, -2.900000000000002, -3.0000000000000018, -2.5000000000000018, -2.900000000000002, -2.800000000000002, -2.4000000000000017, -2.5000000000000018, -2.3000000000000016, -2.800000000000002, -2.5000000000000018, -1.9000000000000012, -3.0000000000000018, -2.1000000000000014, -2.3000000000000016, -2.600000000000002, -3.200000000000001, -2.3000000000000016, -2.600000000000002, -2.3000000000000016, -2.3000000000000016, -2.800000000000002, -3.8999999999999986, -2.700000000000002, -2.3000000000000016, -3.0000000000000018, -3.200000000000001, -2.4000000000000017, -3.4000000000000004, -2.600000000000002, -3.1000000000000014, -2.800000000000002, -3.8999999999999986, -2.1000000000000014, -2.3000000000000016, -2.4000000000000017, -4.099999999999999, -2.800000000000002, -3.3000000000000007, -2.4000000000000017, -4.1999999999999975, -2.0000000000000013, -3.1000000000000014, -2.3000000000000016, -3.0000000000000018, -3.799999999999999, -2.0000000000000013, -2.1000000000000014, -2.0000000000000013, -3.0000000000000018, -2.3000000000000016, -2.5000000000000018, -2.0000000000000013, -2.5000000000000018, -2.600000000000002, -6.9999999999999964, -2.0000000000000013, -8.499999999999988, -22.40000000000001, -3.4000000000000012, -2.700000000000002, -2.800000000000002, -5.999999999999991, -3.200000000000001, -3.1000000000000014, -2.900000000000002, -3.0000000000000018, -3.5999999999999996, -3.0000000000000018, -2.5000000000000018, -2.600000000000002, -2.5000000000000018, -3.1000000000000014, -2.900000000000002, -2.600000000000002, -2.800000000000002, -3.5999999999999996, -3.1000000000000014, -2.1000000000000014, -2.1000000000000014, -2.600000000000002, -2.900000000000002, -2.600000000000002, -3.1000000000000014, -2.5000000000000018, -3.0000000000000018], "episode_lengths": [38, 41, 40, 41, 57, 33, 29, 35, 41, 43, 43, 50, 45, 40, 37, 40, 41, 36, 40, 39, 35, 36, 34, 39, 36, 30, 41, 32, 34, 37, 39, 34, 37, 34, 34, 39, 50, 38, 34, 41, 43, 35, 45, 37, 42, 39, 50, 32, 34, 35, 51, 39, 44, 35, 53, 31, 42, 34, 41, 47, 31, 32, 31, 41, 34, 36, 31, 36, 37, 71, 31, 89, 165, 44, 38, 39, 71, 43, 42, 40, 41, 47, 41, 36, 37, 36, 42, 40, 37, 39, 47, 42, 32, 32, 37, 40, 37, 42, 36, 41]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24304074160056785, "mean_inference_ms": 0.6242827981817977, "mean_action_processing_ms": 0.0675852197878533, "mean_env_wait_ms": 6.271134107554173, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0054399967193603516, "StateBufferConnector_ms": 0.003134012222290039, "ViewRequirementAgentConnector_ms": 0.07456135749816895}}, "episode_reward_max": -1.8000000000000012, "episode_reward_min": -22.40000000000001, "episode_reward_mean": -3.1120000000000014, "episode_len_mean": 41.16, "episodes_this_iter": 97, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-2.700000000000002, -3.1000000000000014, -2.900000000000002, -3.0000000000000018, -4.599999999999996, -2.2000000000000015, -1.8000000000000012, -2.4000000000000017, -3.0000000000000018, -3.200000000000001, -3.200000000000001, -3.8999999999999986, -3.4000000000000004, -2.900000000000002, -2.600000000000002, -2.900000000000002, -3.0000000000000018, -2.5000000000000018, -2.900000000000002, -2.800000000000002, -2.4000000000000017, -2.5000000000000018, -2.3000000000000016, -2.800000000000002, -2.5000000000000018, -1.9000000000000012, -3.0000000000000018, -2.1000000000000014, -2.3000000000000016, -2.600000000000002, -3.200000000000001, -2.3000000000000016, -2.600000000000002, -2.3000000000000016, -2.3000000000000016, -2.800000000000002, -3.8999999999999986, -2.700000000000002, -2.3000000000000016, -3.0000000000000018, -3.200000000000001, -2.4000000000000017, -3.4000000000000004, -2.600000000000002, -3.1000000000000014, -2.800000000000002, -3.8999999999999986, -2.1000000000000014, -2.3000000000000016, -2.4000000000000017, -4.099999999999999, -2.800000000000002, -3.3000000000000007, -2.4000000000000017, -4.1999999999999975, -2.0000000000000013, -3.1000000000000014, -2.3000000000000016, -3.0000000000000018, -3.799999999999999, -2.0000000000000013, -2.1000000000000014, -2.0000000000000013, -3.0000000000000018, -2.3000000000000016, -2.5000000000000018, -2.0000000000000013, -2.5000000000000018, -2.600000000000002, -6.9999999999999964, -2.0000000000000013, -8.499999999999988, -22.40000000000001, -3.4000000000000012, -2.700000000000002, -2.800000000000002, -5.999999999999991, -3.200000000000001, -3.1000000000000014, -2.900000000000002, -3.0000000000000018, -3.5999999999999996, -3.0000000000000018, -2.5000000000000018, -2.600000000000002, -2.5000000000000018, -3.1000000000000014, -2.900000000000002, -2.600000000000002, -2.800000000000002, -3.5999999999999996, -3.1000000000000014, -2.1000000000000014, -2.1000000000000014, -2.600000000000002, -2.900000000000002, -2.600000000000002, -3.1000000000000014, -2.5000000000000018, -3.0000000000000018], "episode_lengths": [38, 41, 40, 41, 57, 33, 29, 35, 41, 43, 43, 50, 45, 40, 37, 40, 41, 36, 40, 39, 35, 36, 34, 39, 36, 30, 41, 32, 34, 37, 39, 34, 37, 34, 34, 39, 50, 38, 34, 41, 43, 35, 45, 37, 42, 39, 50, 32, 34, 35, 51, 39, 44, 35, 53, 31, 42, 34, 41, 47, 31, 32, 31, 41, 34, 36, 31, 36, 37, 71, 31, 89, 165, 44, 38, 39, 71, 43, 42, 40, 41, 47, 41, 36, 37, 36, 42, 40, 37, 39, 47, 42, 32, 32, 37, 40, 37, 42, 36, 41]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24304074160056785, "mean_inference_ms": 0.6242827981817977, "mean_action_processing_ms": 0.0675852197878533, "mean_env_wait_ms": 6.271134107554173, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0054399967193603516, "StateBufferConnector_ms": 0.003134012222290039, "ViewRequirementAgentConnector_ms": 0.07456135749816895}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 120000, "num_agent_steps_trained": 120000, "num_env_steps_sampled": 120000, "num_env_steps_trained": 120000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 345.07253176150505, "num_env_steps_trained_throughput_per_sec": 345.07253176150505, "timesteps_total": 120000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 120000, "timers": {"training_iteration_time_ms": 11196.763, "sample_time_ms": 7718.552, "load_time_ms": 2.095, "load_throughput": 1909235.496, "learn_time_ms": 3472.485, "learn_throughput": 1151.913, "synch_weights_time_ms": 2.985}, "counters": {"num_env_steps_sampled": 120000, "num_env_steps_trained": 120000, "num_agent_steps_sampled": 120000, "num_agent_steps_trained": 120000}, "done": false, "episodes_total": 1219, "training_iteration": 30, "trial_id": "83204_00000", "date": "2024-03-07_12-08-14", "timestamp": 1709831294, "time_this_iter_s": 11.594229936599731, "time_total_s": 324.5076036453247, "pid": 102666, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fcd19c36f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 324.5076036453247, "iterations_since_restore": 30, "perf": {"cpu_util_percent": 20.186666666666664, "ram_util_percent": 44.0, "gpu_util_percent0": 0.07066666666666666, "vram_util_percent0": 0.098876953125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 0.6441532605928519, "policy_loss": -0.005526898150402372, "vf_loss": 0.6482563959654941, "vf_explained_var": 0.7147962836168146, "kl": 0.007118824963981751, "entropy": 0.6187319017866606, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 28365.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 124000, "num_env_steps_trained": 124000, "num_agent_steps_sampled": 124000, "num_agent_steps_trained": 124000}, "sampler_results": {"episode_reward_max": -1.600000000000001, "episode_reward_min": -15.799999999999986, "episode_reward_mean": -2.9594059405940607, "episode_len_mean": 39.91089108910891, "episode_media": {}, "episodes_this_iter": 101, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2.800000000000002, -3.4000000000000004, -2.5000000000000018, -2.5000000000000018, -2.700000000000002, -3.3000000000000007, -2.0000000000000013, -3.3000000000000007, -2.1000000000000014, -2.5000000000000018, -2.0000000000000013, -3.3000000000000007, -2.600000000000002, -1.8000000000000012, -2.900000000000002, -2.2000000000000015, -3.8999999999999995, -3.8000000000000016, -3.0000000000000018, -3.1000000000000014, -3.6999999999999993, -2.900000000000002, -2.800000000000002, -3.200000000000001, -2.2000000000000015, -1.600000000000001, -4.099999999999999, -4.099999999999998, -1.9000000000000012, -2.4000000000000017, -2.0000000000000013, -2.4000000000000017, -3.200000000000001, -2.5000000000000018, -2.900000000000002, -2.3000000000000016, -2.700000000000002, -1.700000000000001, -2.900000000000002, -11.399999999999986, -2.2000000000000015, -2.2000000000000015, -2.600000000000002, -2.5000000000000018, -2.4000000000000017, -3.5, -1.700000000000001, -6.29999999999999, -2.600000000000002, -3.5, -2.3000000000000016, -15.799999999999986, -2.700000000000002, -2.4000000000000017, -2.900000000000002, -3.200000000000001, -2.600000000000002, -3.6999999999999993, -1.8000000000000012, -2.700000000000002, -3.0000000000000018, -2.5000000000000018, -2.2000000000000015, -2.800000000000002, -2.5000000000000018, -2.700000000000002, -2.5000000000000018, -5.000000000000001, -3.3000000000000007, -3.5999999999999996, -2.3000000000000016, -2.900000000000002, -3.4000000000000004, -2.3000000000000016, -2.1000000000000014, -2.5000000000000018, -1.9000000000000012, -2.700000000000002, -2.2000000000000015, -8.099999999999987, -2.0000000000000013, -2.2000000000000015, -2.2000000000000015, -2.1000000000000014, -3.0000000000000018, -2.1000000000000014, -2.4000000000000017, -2.5000000000000018, -1.9000000000000012, -3.0000000000000018, -2.0000000000000013, -2.1000000000000014, -2.700000000000002, -2.900000000000002, -1.700000000000001, -1.600000000000001, -2.600000000000002, -2.3000000000000016, -3.1000000000000014, -2.800000000000002, -3.0000000000000018], "episode_lengths": [39, 45, 36, 36, 38, 44, 31, 44, 32, 36, 31, 44, 37, 29, 40, 33, 49, 45, 41, 42, 48, 40, 39, 43, 33, 27, 51, 52, 30, 35, 31, 35, 43, 36, 40, 34, 38, 28, 40, 106, 33, 33, 37, 36, 35, 46, 28, 74, 37, 46, 34, 138, 38, 35, 40, 43, 37, 48, 29, 38, 41, 36, 33, 39, 36, 38, 36, 54, 44, 47, 34, 40, 45, 34, 32, 36, 30, 38, 33, 86, 31, 33, 33, 32, 41, 32, 35, 36, 30, 41, 31, 32, 38, 40, 28, 27, 37, 34, 42, 39, 41]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24631860334281297, "mean_inference_ms": 0.6244565909650899, "mean_action_processing_ms": 0.06761020820962166, "mean_env_wait_ms": 6.293247266836829, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005319094893955948, "StateBufferConnector_ms": 0.003164121420076578, "ViewRequirementAgentConnector_ms": 0.0748988425377572}}, "episode_reward_max": -1.600000000000001, "episode_reward_min": -15.799999999999986, "episode_reward_mean": -2.9594059405940607, "episode_len_mean": 39.91089108910891, "episodes_this_iter": 101, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-2.800000000000002, -3.4000000000000004, -2.5000000000000018, -2.5000000000000018, -2.700000000000002, -3.3000000000000007, -2.0000000000000013, -3.3000000000000007, -2.1000000000000014, -2.5000000000000018, -2.0000000000000013, -3.3000000000000007, -2.600000000000002, -1.8000000000000012, -2.900000000000002, -2.2000000000000015, -3.8999999999999995, -3.8000000000000016, -3.0000000000000018, -3.1000000000000014, -3.6999999999999993, -2.900000000000002, -2.800000000000002, -3.200000000000001, -2.2000000000000015, -1.600000000000001, -4.099999999999999, -4.099999999999998, -1.9000000000000012, -2.4000000000000017, -2.0000000000000013, -2.4000000000000017, -3.200000000000001, -2.5000000000000018, -2.900000000000002, -2.3000000000000016, -2.700000000000002, -1.700000000000001, -2.900000000000002, -11.399999999999986, -2.2000000000000015, -2.2000000000000015, -2.600000000000002, -2.5000000000000018, -2.4000000000000017, -3.5, -1.700000000000001, -6.29999999999999, -2.600000000000002, -3.5, -2.3000000000000016, -15.799999999999986, -2.700000000000002, -2.4000000000000017, -2.900000000000002, -3.200000000000001, -2.600000000000002, -3.6999999999999993, -1.8000000000000012, -2.700000000000002, -3.0000000000000018, -2.5000000000000018, -2.2000000000000015, -2.800000000000002, -2.5000000000000018, -2.700000000000002, -2.5000000000000018, -5.000000000000001, -3.3000000000000007, -3.5999999999999996, -2.3000000000000016, -2.900000000000002, -3.4000000000000004, -2.3000000000000016, -2.1000000000000014, -2.5000000000000018, -1.9000000000000012, -2.700000000000002, -2.2000000000000015, -8.099999999999987, -2.0000000000000013, -2.2000000000000015, -2.2000000000000015, -2.1000000000000014, -3.0000000000000018, -2.1000000000000014, -2.4000000000000017, -2.5000000000000018, -1.9000000000000012, -3.0000000000000018, -2.0000000000000013, -2.1000000000000014, -2.700000000000002, -2.900000000000002, -1.700000000000001, -1.600000000000001, -2.600000000000002, -2.3000000000000016, -3.1000000000000014, -2.800000000000002, -3.0000000000000018], "episode_lengths": [39, 45, 36, 36, 38, 44, 31, 44, 32, 36, 31, 44, 37, 29, 40, 33, 49, 45, 41, 42, 48, 40, 39, 43, 33, 27, 51, 52, 30, 35, 31, 35, 43, 36, 40, 34, 38, 28, 40, 106, 33, 33, 37, 36, 35, 46, 28, 74, 37, 46, 34, 138, 38, 35, 40, 43, 37, 48, 29, 38, 41, 36, 33, 39, 36, 38, 36, 54, 44, 47, 34, 40, 45, 34, 32, 36, 30, 38, 33, 86, 31, 33, 33, 32, 41, 32, 35, 36, 30, 41, 31, 32, 38, 40, 28, 27, 37, 34, 42, 39, 41]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24631860334281297, "mean_inference_ms": 0.6244565909650899, "mean_action_processing_ms": 0.06761020820962166, "mean_env_wait_ms": 6.293247266836829, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005319094893955948, "StateBufferConnector_ms": 0.003164121420076578, "ViewRequirementAgentConnector_ms": 0.0748988425377572}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 124000, "num_agent_steps_trained": 124000, "num_env_steps_sampled": 124000, "num_env_steps_trained": 124000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 348.71584036432097, "num_env_steps_trained_throughput_per_sec": 348.71584036432097, "timesteps_total": 124000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 124000, "timers": {"training_iteration_time_ms": 11259.297, "sample_time_ms": 7783.223, "load_time_ms": 2.129, "load_throughput": 1878453.098, "learn_time_ms": 3470.302, "learn_throughput": 1152.637, "synch_weights_time_ms": 2.984}, "counters": {"num_env_steps_sampled": 124000, "num_env_steps_trained": 124000, "num_agent_steps_sampled": 124000, "num_agent_steps_trained": 124000}, "done": false, "episodes_total": 1320, "training_iteration": 31, "trial_id": "83204_00000", "date": "2024-03-07_12-08-26", "timestamp": 1709831306, "time_this_iter_s": 11.473283290863037, "time_total_s": 335.98088693618774, "pid": 102666, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fcd19c36f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 335.98088693618774, "iterations_since_restore": 31, "perf": {"cpu_util_percent": 20.093333333333337, "ram_util_percent": 44.040000000000006, "gpu_util_percent0": 0.07, "vram_util_percent0": 0.098876953125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 0.3693515577150123, "policy_loss": -0.00891176871154257, "vf_loss": 0.37639479154660815, "vf_explained_var": 0.8740842774350156, "kl": 0.009342655556881607, "entropy": 0.5550615707712788, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 29295.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 128000, "num_env_steps_trained": 128000, "num_agent_steps_sampled": 128000, "num_agent_steps_trained": 128000}, "sampler_results": {"episode_reward_max": -1.600000000000001, "episode_reward_min": -25.200000000000024, "episode_reward_mean": -2.732075471698115, "episode_len_mean": 37.41509433962264, "episode_media": {}, "episodes_this_iter": 106, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2.4000000000000017, -2.5000000000000018, -2.5000000000000018, -2.700000000000002, -2.5000000000000018, -2.0000000000000013, -2.700000000000002, -3.4000000000000004, -2.900000000000002, -2.0000000000000013, -2.2000000000000015, -2.1000000000000014, -2.2000000000000015, -3.3000000000000007, -2.800000000000002, -2.2000000000000015, -2.4000000000000017, -2.4000000000000017, -3.8999999999999986, -2.2000000000000015, -2.3000000000000016, -2.3000000000000016, -2.0000000000000013, -1.700000000000001, -2.0000000000000013, -2.600000000000002, -3.5999999999999996, -2.600000000000002, -2.0000000000000013, -2.700000000000002, -2.5000000000000018, -2.5000000000000018, -2.1000000000000014, -2.5000000000000018, -2.600000000000002, -2.4000000000000017, -2.4000000000000017, -2.800000000000002, -25.200000000000024, -2.900000000000002, -2.2000000000000015, -2.5000000000000018, -2.900000000000002, -2.700000000000002, -2.1000000000000014, -2.0000000000000013, -3.3000000000000007, -1.9000000000000012, -2.0000000000000013, -2.5000000000000018, -2.700000000000002, -1.9000000000000012, -2.600000000000002, -3.0000000000000018, -2.700000000000002, -1.9000000000000012, -1.8000000000000012, -3.0000000000000018, -2.4000000000000017, -3.500000000000001, -1.8000000000000012, -2.600000000000002, -3.4000000000000004, -3.1000000000000014, -2.1000000000000014, -2.600000000000002, -2.3000000000000016, -3.3000000000000007, -2.3000000000000016, -2.2000000000000015, -2.4000000000000017, -1.600000000000001, -3.0000000000000018, -1.9000000000000012, -2.4000000000000017, -3.500000000000001, -2.3000000000000016, -2.800000000000002, -3.1000000000000014, -2.5000000000000018, -2.800000000000002, -2.4000000000000017, -1.8000000000000012, -2.700000000000002, -2.0000000000000013, -2.900000000000002, -2.1000000000000014, -2.0000000000000013, -2.700000000000002, -2.800000000000002, -2.700000000000002, -1.8000000000000012, -2.5000000000000018, -2.600000000000002, -2.0000000000000013, -2.5000000000000018, -3.8999999999999986, -2.800000000000002, -2.4000000000000017, -3.3000000000000007, -3.4000000000000004, -1.600000000000001, -3.3000000000000007, -2.4000000000000017, -2.3000000000000016, -2.1000000000000014], "episode_lengths": [35, 36, 36, 38, 36, 31, 38, 45, 40, 31, 33, 32, 33, 44, 39, 33, 35, 35, 50, 33, 34, 34, 31, 28, 31, 37, 47, 37, 31, 38, 36, 36, 32, 36, 37, 35, 35, 39, 176, 40, 33, 36, 40, 38, 32, 31, 44, 30, 31, 34, 38, 30, 37, 41, 38, 30, 29, 41, 35, 44, 29, 33, 45, 42, 32, 37, 34, 44, 34, 33, 35, 27, 41, 30, 35, 45, 34, 39, 42, 36, 39, 35, 29, 38, 31, 40, 32, 31, 38, 39, 38, 29, 36, 37, 31, 36, 50, 39, 35, 44, 45, 27, 44, 35, 34, 32]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24956957056213822, "mean_inference_ms": 0.6247483628423799, "mean_action_processing_ms": 0.06764886918834084, "mean_env_wait_ms": 6.315875440669215, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0055947393741247785, "StateBufferConnector_ms": 0.003171192025238613, "ViewRequirementAgentConnector_ms": 0.07419653658596974}}, "episode_reward_max": -1.600000000000001, "episode_reward_min": -25.200000000000024, "episode_reward_mean": -2.732075471698115, "episode_len_mean": 37.41509433962264, "episodes_this_iter": 106, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-2.4000000000000017, -2.5000000000000018, -2.5000000000000018, -2.700000000000002, -2.5000000000000018, -2.0000000000000013, -2.700000000000002, -3.4000000000000004, -2.900000000000002, -2.0000000000000013, -2.2000000000000015, -2.1000000000000014, -2.2000000000000015, -3.3000000000000007, -2.800000000000002, -2.2000000000000015, -2.4000000000000017, -2.4000000000000017, -3.8999999999999986, -2.2000000000000015, -2.3000000000000016, -2.3000000000000016, -2.0000000000000013, -1.700000000000001, -2.0000000000000013, -2.600000000000002, -3.5999999999999996, -2.600000000000002, -2.0000000000000013, -2.700000000000002, -2.5000000000000018, -2.5000000000000018, -2.1000000000000014, -2.5000000000000018, -2.600000000000002, -2.4000000000000017, -2.4000000000000017, -2.800000000000002, -25.200000000000024, -2.900000000000002, -2.2000000000000015, -2.5000000000000018, -2.900000000000002, -2.700000000000002, -2.1000000000000014, -2.0000000000000013, -3.3000000000000007, -1.9000000000000012, -2.0000000000000013, -2.5000000000000018, -2.700000000000002, -1.9000000000000012, -2.600000000000002, -3.0000000000000018, -2.700000000000002, -1.9000000000000012, -1.8000000000000012, -3.0000000000000018, -2.4000000000000017, -3.500000000000001, -1.8000000000000012, -2.600000000000002, -3.4000000000000004, -3.1000000000000014, -2.1000000000000014, -2.600000000000002, -2.3000000000000016, -3.3000000000000007, -2.3000000000000016, -2.2000000000000015, -2.4000000000000017, -1.600000000000001, -3.0000000000000018, -1.9000000000000012, -2.4000000000000017, -3.500000000000001, -2.3000000000000016, -2.800000000000002, -3.1000000000000014, -2.5000000000000018, -2.800000000000002, -2.4000000000000017, -1.8000000000000012, -2.700000000000002, -2.0000000000000013, -2.900000000000002, -2.1000000000000014, -2.0000000000000013, -2.700000000000002, -2.800000000000002, -2.700000000000002, -1.8000000000000012, -2.5000000000000018, -2.600000000000002, -2.0000000000000013, -2.5000000000000018, -3.8999999999999986, -2.800000000000002, -2.4000000000000017, -3.3000000000000007, -3.4000000000000004, -1.600000000000001, -3.3000000000000007, -2.4000000000000017, -2.3000000000000016, -2.1000000000000014], "episode_lengths": [35, 36, 36, 38, 36, 31, 38, 45, 40, 31, 33, 32, 33, 44, 39, 33, 35, 35, 50, 33, 34, 34, 31, 28, 31, 37, 47, 37, 31, 38, 36, 36, 32, 36, 37, 35, 35, 39, 176, 40, 33, 36, 40, 38, 32, 31, 44, 30, 31, 34, 38, 30, 37, 41, 38, 30, 29, 41, 35, 44, 29, 33, 45, 42, 32, 37, 34, 44, 34, 33, 35, 27, 41, 30, 35, 45, 34, 39, 42, 36, 39, 35, 29, 38, 31, 40, 32, 31, 38, 39, 38, 29, 36, 37, 31, 36, 50, 39, 35, 44, 45, 27, 44, 35, 34, 32]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24956957056213822, "mean_inference_ms": 0.6247483628423799, "mean_action_processing_ms": 0.06764886918834084, "mean_env_wait_ms": 6.315875440669215, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0055947393741247785, "StateBufferConnector_ms": 0.003171192025238613, "ViewRequirementAgentConnector_ms": 0.07419653658596974}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 128000, "num_agent_steps_trained": 128000, "num_env_steps_sampled": 128000, "num_env_steps_trained": 128000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 347.0822143953252, "num_env_steps_trained_throughput_per_sec": 347.0822143953252, "timesteps_total": 128000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 128000, "timers": {"training_iteration_time_ms": 11316.363, "sample_time_ms": 7865.543, "load_time_ms": 2.129, "load_throughput": 1878873.833, "learn_time_ms": 3446.377, "learn_throughput": 1160.639, "synch_weights_time_ms": 1.686}, "counters": {"num_env_steps_sampled": 128000, "num_env_steps_trained": 128000, "num_agent_steps_sampled": 128000, "num_agent_steps_trained": 128000}, "done": false, "episodes_total": 1426, "training_iteration": 32, "trial_id": "83204_00000", "date": "2024-03-07_12-08-37", "timestamp": 1709831317, "time_this_iter_s": 11.5271635055542, "time_total_s": 347.50805044174194, "pid": 102666, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fcd19c36f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 347.50805044174194, "iterations_since_restore": 32, "perf": {"cpu_util_percent": 20.419999999999998, "ram_util_percent": 44.026666666666664, "gpu_util_percent0": 0.07266666666666666, "vram_util_percent0": 0.098876953125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 0.2275990374997178, "policy_loss": -0.0027350986696859842, "vf_loss": 0.22857377520532057, "vf_explained_var": 0.8811676738082722, "kl": 0.008801802508729712, "entropy": 0.49405293298024006, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 30225.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 132000, "num_env_steps_trained": 132000, "num_agent_steps_sampled": 132000, "num_agent_steps_trained": 132000}, "sampler_results": {"episode_reward_max": -1.4000000000000008, "episode_reward_min": -7.599999999999989, "episode_reward_mean": -2.349572649572651, "episode_len_mean": 34.30769230769231, "episode_media": {}, "episodes_this_iter": 117, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1.9000000000000012, -2.1000000000000014, -2.700000000000002, -2.5000000000000018, -2.4000000000000017, -1.8000000000000012, -2.700000000000002, -1.9000000000000012, -2.600000000000002, -1.9000000000000012, -3.0000000000000018, -2.0000000000000013, -3.200000000000001, -5.199999999999995, -2.1000000000000014, -1.5000000000000009, -1.4000000000000008, -2.700000000000002, -1.9000000000000012, -2.0000000000000013, -2.600000000000002, -2.2000000000000015, -1.8000000000000012, -1.8000000000000012, -2.1000000000000014, -2.600000000000002, -2.1000000000000014, -2.1000000000000014, -2.0000000000000013, -2.2000000000000015, -1.9000000000000012, -1.8000000000000012, -1.9000000000000012, -3.4000000000000004, -3.200000000000001, -4.1999999999999975, -2.2000000000000015, -2.3000000000000016, -1.700000000000001, -2.1000000000000014, -2.0000000000000013, -1.9000000000000012, -2.700000000000002, -2.900000000000002, -2.5000000000000018, -2.0000000000000013, -1.4000000000000008, -1.8000000000000012, -2.2000000000000015, -1.8000000000000012, -1.8000000000000012, -2.3000000000000016, -2.5000000000000018, -1.700000000000001, -1.9000000000000012, -2.2000000000000015, -2.0000000000000013, -2.2000000000000015, -3.4000000000000004, -2.2000000000000015, -3.1000000000000014, -1.700000000000001, -1.9000000000000012, -2.3000000000000016, -2.900000000000002, -1.9000000000000012, -3.200000000000001, -2.800000000000002, -2.5000000000000018, -2.0000000000000013, -2.600000000000002, -2.4000000000000017, -2.600000000000002, -2.1000000000000014, -2.0000000000000013, -2.600000000000002, -1.8000000000000012, -7.599999999999989, -2.700000000000002, -2.1000000000000014, -1.700000000000001, -2.5000000000000018, -3.3000000000000007, -1.700000000000001, -2.3000000000000016, -2.0000000000000013, -2.5000000000000018, -2.900000000000002, -2.700000000000002, -1.9000000000000012, -2.700000000000002, -2.600000000000002, -1.9000000000000012, -2.4000000000000017, -2.3000000000000016, -2.0000000000000013, -2.3000000000000016, -2.2000000000000015, -2.700000000000002, -2.900000000000002, -2.0000000000000013, -2.900000000000002, -2.700000000000002, -2.800000000000002, -2.5000000000000018, -2.0000000000000013, -2.2000000000000015, -1.4000000000000008, -1.8000000000000012, -2.600000000000002, -1.8000000000000012, -2.4000000000000017, -2.0000000000000013, -2.3000000000000016, -2.0000000000000013, -2.1000000000000014, -2.0000000000000013], "episode_lengths": [30, 32, 38, 36, 35, 29, 38, 30, 37, 30, 41, 31, 39, 62, 32, 26, 25, 38, 30, 31, 37, 33, 29, 29, 32, 37, 32, 32, 31, 33, 30, 29, 30, 43, 39, 53, 33, 32, 28, 32, 31, 30, 37, 40, 36, 31, 25, 29, 33, 29, 29, 34, 36, 28, 30, 33, 31, 33, 45, 33, 42, 28, 30, 34, 40, 30, 43, 39, 36, 31, 37, 35, 37, 32, 31, 37, 29, 79, 38, 32, 28, 36, 44, 28, 34, 31, 36, 40, 38, 30, 38, 37, 30, 35, 34, 31, 34, 33, 38, 40, 31, 40, 38, 39, 36, 31, 33, 25, 29, 37, 29, 35, 31, 34, 31, 32, 31]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.25325249887677503, "mean_inference_ms": 0.625466850897562, "mean_action_processing_ms": 0.06768131104868837, "mean_env_wait_ms": 6.3404250727006985, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0059303055461655315, "StateBufferConnector_ms": 0.0033066822932316707, "ViewRequirementAgentConnector_ms": 0.07705973763751169}}, "episode_reward_max": -1.4000000000000008, "episode_reward_min": -7.599999999999989, "episode_reward_mean": -2.349572649572651, "episode_len_mean": 34.30769230769231, "episodes_this_iter": 117, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1.9000000000000012, -2.1000000000000014, -2.700000000000002, -2.5000000000000018, -2.4000000000000017, -1.8000000000000012, -2.700000000000002, -1.9000000000000012, -2.600000000000002, -1.9000000000000012, -3.0000000000000018, -2.0000000000000013, -3.200000000000001, -5.199999999999995, -2.1000000000000014, -1.5000000000000009, -1.4000000000000008, -2.700000000000002, -1.9000000000000012, -2.0000000000000013, -2.600000000000002, -2.2000000000000015, -1.8000000000000012, -1.8000000000000012, -2.1000000000000014, -2.600000000000002, -2.1000000000000014, -2.1000000000000014, -2.0000000000000013, -2.2000000000000015, -1.9000000000000012, -1.8000000000000012, -1.9000000000000012, -3.4000000000000004, -3.200000000000001, -4.1999999999999975, -2.2000000000000015, -2.3000000000000016, -1.700000000000001, -2.1000000000000014, -2.0000000000000013, -1.9000000000000012, -2.700000000000002, -2.900000000000002, -2.5000000000000018, -2.0000000000000013, -1.4000000000000008, -1.8000000000000012, -2.2000000000000015, -1.8000000000000012, -1.8000000000000012, -2.3000000000000016, -2.5000000000000018, -1.700000000000001, -1.9000000000000012, -2.2000000000000015, -2.0000000000000013, -2.2000000000000015, -3.4000000000000004, -2.2000000000000015, -3.1000000000000014, -1.700000000000001, -1.9000000000000012, -2.3000000000000016, -2.900000000000002, -1.9000000000000012, -3.200000000000001, -2.800000000000002, -2.5000000000000018, -2.0000000000000013, -2.600000000000002, -2.4000000000000017, -2.600000000000002, -2.1000000000000014, -2.0000000000000013, -2.600000000000002, -1.8000000000000012, -7.599999999999989, -2.700000000000002, -2.1000000000000014, -1.700000000000001, -2.5000000000000018, -3.3000000000000007, -1.700000000000001, -2.3000000000000016, -2.0000000000000013, -2.5000000000000018, -2.900000000000002, -2.700000000000002, -1.9000000000000012, -2.700000000000002, -2.600000000000002, -1.9000000000000012, -2.4000000000000017, -2.3000000000000016, -2.0000000000000013, -2.3000000000000016, -2.2000000000000015, -2.700000000000002, -2.900000000000002, -2.0000000000000013, -2.900000000000002, -2.700000000000002, -2.800000000000002, -2.5000000000000018, -2.0000000000000013, -2.2000000000000015, -1.4000000000000008, -1.8000000000000012, -2.600000000000002, -1.8000000000000012, -2.4000000000000017, -2.0000000000000013, -2.3000000000000016, -2.0000000000000013, -2.1000000000000014, -2.0000000000000013], "episode_lengths": [30, 32, 38, 36, 35, 29, 38, 30, 37, 30, 41, 31, 39, 62, 32, 26, 25, 38, 30, 31, 37, 33, 29, 29, 32, 37, 32, 32, 31, 33, 30, 29, 30, 43, 39, 53, 33, 32, 28, 32, 31, 30, 37, 40, 36, 31, 25, 29, 33, 29, 29, 34, 36, 28, 30, 33, 31, 33, 45, 33, 42, 28, 30, 34, 40, 30, 43, 39, 36, 31, 37, 35, 37, 32, 31, 37, 29, 79, 38, 32, 28, 36, 44, 28, 34, 31, 36, 40, 38, 30, 38, 37, 30, 35, 34, 31, 34, 33, 38, 40, 31, 40, 38, 39, 36, 31, 33, 25, 29, 37, 29, 35, 31, 34, 31, 32, 31]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.25325249887677503, "mean_inference_ms": 0.625466850897562, "mean_action_processing_ms": 0.06768131104868837, "mean_env_wait_ms": 6.3404250727006985, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0059303055461655315, "StateBufferConnector_ms": 0.0033066822932316707, "ViewRequirementAgentConnector_ms": 0.07705973763751169}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 132000, "num_agent_steps_trained": 132000, "num_env_steps_sampled": 132000, "num_env_steps_trained": 132000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 336.6060427801371, "num_env_steps_trained_throughput_per_sec": 336.6060427801371, "timesteps_total": 132000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 132000, "timers": {"training_iteration_time_ms": 11407.448, "sample_time_ms": 7953.797, "load_time_ms": 2.128, "load_throughput": 1879505.288, "learn_time_ms": 3449.18, "learn_throughput": 1159.696, "synch_weights_time_ms": 1.711}, "counters": {"num_env_steps_sampled": 132000, "num_env_steps_trained": 132000, "num_agent_steps_sampled": 132000, "num_agent_steps_trained": 132000}, "done": false, "episodes_total": 1543, "training_iteration": 33, "trial_id": "83204_00000", "date": "2024-03-07_12-08-49", "timestamp": 1709831329, "time_this_iter_s": 11.886102437973022, "time_total_s": 359.39415287971497, "pid": 102666, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fcd19c36f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 359.39415287971497, "iterations_since_restore": 33, "perf": {"cpu_util_percent": 20.44375, "ram_util_percent": 44.03125, "gpu_util_percent0": 0.08, "vram_util_percent0": 0.098876953125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 0.35392856214549745, "policy_loss": -0.0052593683753843585, "vf_loss": 0.35777109172595767, "vf_explained_var": 0.8215327862770326, "kl": 0.007084191727322899, "entropy": 0.4573585711179241, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 31155.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 136000, "num_env_steps_trained": 136000, "num_agent_steps_sampled": 136000, "num_agent_steps_trained": 136000}, "sampler_results": {"episode_reward_max": -1.4000000000000008, "episode_reward_min": -7.100000000000005, "episode_reward_mean": -2.3829059829059847, "episode_len_mean": 34.111111111111114, "episode_media": {}, "episodes_this_iter": 117, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-5.199999999999994, -2.0000000000000013, -3.1000000000000014, -3.6000000000000014, -2.0000000000000013, -1.9000000000000012, -2.600000000000002, -2.0000000000000013, -1.700000000000001, -2.4000000000000017, -1.9000000000000012, -2.5000000000000018, -2.700000000000002, -1.9000000000000012, -2.900000000000002, -2.3000000000000016, -3.200000000000001, -2.1000000000000014, -2.2000000000000015, -2.5000000000000018, -2.0000000000000013, -2.700000000000002, -7.000000000000005, -1.9000000000000012, -3.200000000000001, -1.9000000000000012, -2.1000000000000014, -2.5000000000000018, -1.9000000000000012, -2.700000000000002, -1.9000000000000012, -3.200000000000001, -3.3000000000000007, -2.800000000000002, -2.0000000000000013, -2.3000000000000016, -2.0000000000000013, -2.4000000000000017, -1.700000000000001, -1.700000000000001, -2.1000000000000014, -5.200000000000002, -2.0000000000000013, -2.2000000000000015, -2.2000000000000015, -2.5000000000000018, -2.0000000000000013, -1.700000000000001, -2.3000000000000016, -1.700000000000001, -1.8000000000000012, -1.9000000000000012, -1.700000000000001, -1.700000000000001, -2.1000000000000014, -1.9000000000000012, -1.600000000000001, -2.2000000000000015, -1.700000000000001, -1.700000000000001, -2.600000000000002, -2.5000000000000018, -1.700000000000001, -2.800000000000002, -1.8000000000000012, -2.600000000000002, -2.4000000000000017, -1.5000000000000009, -1.8000000000000012, -1.8000000000000012, -2.1000000000000014, -2.4000000000000017, -1.600000000000001, -1.600000000000001, -2.0000000000000013, -1.8000000000000012, -1.4000000000000008, -3.6000000000000014, -3.6000000000000005, -2.1000000000000014, -2.0000000000000013, -2.2000000000000015, -2.2000000000000015, -1.9000000000000012, -2.600000000000002, -2.0000000000000013, -2.4000000000000017, -2.2000000000000015, -3.9000000000000004, -2.800000000000002, -2.4000000000000017, -2.800000000000002, -1.9000000000000012, -3.5, -2.1000000000000014, -1.700000000000001, -1.8000000000000012, -1.600000000000001, -2.3000000000000016, -1.700000000000001, -1.8000000000000012, -2.800000000000002, -2.1000000000000014, -2.2000000000000015, -1.8000000000000012, -2.0000000000000013, -2.5000000000000018, -1.9000000000000012, -2.900000000000002, -2.700000000000002, -2.700000000000002, -2.4000000000000017, -2.3000000000000016, -2.5000000000000018, -2.800000000000002, -7.100000000000005, -2.5000000000000018], "episode_lengths": [63, 31, 39, 44, 31, 30, 37, 31, 28, 35, 30, 36, 38, 30, 40, 34, 43, 32, 33, 32, 31, 38, 62, 30, 43, 30, 32, 36, 30, 38, 30, 43, 44, 39, 31, 34, 31, 35, 28, 28, 32, 45, 31, 33, 33, 36, 31, 28, 34, 28, 29, 30, 28, 28, 32, 30, 27, 33, 28, 28, 37, 36, 28, 39, 29, 37, 35, 26, 29, 29, 32, 35, 27, 27, 31, 29, 25, 41, 46, 32, 31, 33, 33, 30, 37, 31, 35, 33, 45, 39, 35, 39, 30, 46, 32, 28, 29, 27, 34, 28, 29, 39, 32, 33, 29, 31, 36, 30, 37, 38, 38, 35, 34, 36, 39, 60, 36]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2566154645745191, "mean_inference_ms": 0.6258082167415967, "mean_action_processing_ms": 0.06769843411396943, "mean_env_wait_ms": 6.364616494435213, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005704724890554053, "StateBufferConnector_ms": 0.0032268018804044807, "ViewRequirementAgentConnector_ms": 0.07529971945999014}}, "episode_reward_max": -1.4000000000000008, "episode_reward_min": -7.100000000000005, "episode_reward_mean": -2.3829059829059847, "episode_len_mean": 34.111111111111114, "episodes_this_iter": 117, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-5.199999999999994, -2.0000000000000013, -3.1000000000000014, -3.6000000000000014, -2.0000000000000013, -1.9000000000000012, -2.600000000000002, -2.0000000000000013, -1.700000000000001, -2.4000000000000017, -1.9000000000000012, -2.5000000000000018, -2.700000000000002, -1.9000000000000012, -2.900000000000002, -2.3000000000000016, -3.200000000000001, -2.1000000000000014, -2.2000000000000015, -2.5000000000000018, -2.0000000000000013, -2.700000000000002, -7.000000000000005, -1.9000000000000012, -3.200000000000001, -1.9000000000000012, -2.1000000000000014, -2.5000000000000018, -1.9000000000000012, -2.700000000000002, -1.9000000000000012, -3.200000000000001, -3.3000000000000007, -2.800000000000002, -2.0000000000000013, -2.3000000000000016, -2.0000000000000013, -2.4000000000000017, -1.700000000000001, -1.700000000000001, -2.1000000000000014, -5.200000000000002, -2.0000000000000013, -2.2000000000000015, -2.2000000000000015, -2.5000000000000018, -2.0000000000000013, -1.700000000000001, -2.3000000000000016, -1.700000000000001, -1.8000000000000012, -1.9000000000000012, -1.700000000000001, -1.700000000000001, -2.1000000000000014, -1.9000000000000012, -1.600000000000001, -2.2000000000000015, -1.700000000000001, -1.700000000000001, -2.600000000000002, -2.5000000000000018, -1.700000000000001, -2.800000000000002, -1.8000000000000012, -2.600000000000002, -2.4000000000000017, -1.5000000000000009, -1.8000000000000012, -1.8000000000000012, -2.1000000000000014, -2.4000000000000017, -1.600000000000001, -1.600000000000001, -2.0000000000000013, -1.8000000000000012, -1.4000000000000008, -3.6000000000000014, -3.6000000000000005, -2.1000000000000014, -2.0000000000000013, -2.2000000000000015, -2.2000000000000015, -1.9000000000000012, -2.600000000000002, -2.0000000000000013, -2.4000000000000017, -2.2000000000000015, -3.9000000000000004, -2.800000000000002, -2.4000000000000017, -2.800000000000002, -1.9000000000000012, -3.5, -2.1000000000000014, -1.700000000000001, -1.8000000000000012, -1.600000000000001, -2.3000000000000016, -1.700000000000001, -1.8000000000000012, -2.800000000000002, -2.1000000000000014, -2.2000000000000015, -1.8000000000000012, -2.0000000000000013, -2.5000000000000018, -1.9000000000000012, -2.900000000000002, -2.700000000000002, -2.700000000000002, -2.4000000000000017, -2.3000000000000016, -2.5000000000000018, -2.800000000000002, -7.100000000000005, -2.5000000000000018], "episode_lengths": [63, 31, 39, 44, 31, 30, 37, 31, 28, 35, 30, 36, 38, 30, 40, 34, 43, 32, 33, 32, 31, 38, 62, 30, 43, 30, 32, 36, 30, 38, 30, 43, 44, 39, 31, 34, 31, 35, 28, 28, 32, 45, 31, 33, 33, 36, 31, 28, 34, 28, 29, 30, 28, 28, 32, 30, 27, 33, 28, 28, 37, 36, 28, 39, 29, 37, 35, 26, 29, 29, 32, 35, 27, 27, 31, 29, 25, 41, 46, 32, 31, 33, 33, 30, 37, 31, 35, 33, 45, 39, 35, 39, 30, 46, 32, 28, 29, 27, 34, 28, 29, 39, 32, 33, 29, 31, 36, 30, 37, 38, 38, 35, 34, 36, 39, 60, 36]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2566154645745191, "mean_inference_ms": 0.6258082167415967, "mean_action_processing_ms": 0.06769843411396943, "mean_env_wait_ms": 6.364616494435213, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005704724890554053, "StateBufferConnector_ms": 0.0032268018804044807, "ViewRequirementAgentConnector_ms": 0.07529971945999014}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 136000, "num_agent_steps_trained": 136000, "num_env_steps_sampled": 136000, "num_env_steps_trained": 136000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 339.2316458671838, "num_env_steps_trained_throughput_per_sec": 339.2316458671838, "timesteps_total": 136000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 136000, "timers": {"training_iteration_time_ms": 11481.857, "sample_time_ms": 8026.705, "load_time_ms": 2.132, "load_throughput": 1876205.366, "learn_time_ms": 3450.672, "learn_throughput": 1159.195, "synch_weights_time_ms": 1.716}, "counters": {"num_env_steps_sampled": 136000, "num_env_steps_trained": 136000, "num_agent_steps_sampled": 136000, "num_agent_steps_trained": 136000}, "done": false, "episodes_total": 1660, "training_iteration": 34, "trial_id": "83204_00000", "date": "2024-03-07_12-09-01", "timestamp": 1709831341, "time_this_iter_s": 11.793843746185303, "time_total_s": 371.18799662590027, "pid": 102666, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fcd19c36f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 371.18799662590027, "iterations_since_restore": 34, "perf": {"cpu_util_percent": 20.58, "ram_util_percent": 44.040000000000006, "gpu_util_percent0": 0.072, "vram_util_percent0": 0.098876953125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 0.29075299466970145, "policy_loss": -0.011778515819660438, "vf_loss": 0.30110282861497456, "vf_explained_var": 0.8547350346401174, "kl": 0.007143416659216148, "entropy": 0.44035818246744013, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 32085.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 140000, "num_env_steps_trained": 140000, "num_agent_steps_sampled": 140000, "num_agent_steps_trained": 140000}, "sampler_results": {"episode_reward_max": -1.4000000000000008, "episode_reward_min": -7.8999999999999915, "episode_reward_mean": -2.1869918699187, "episode_len_mean": 32.520325203252035, "episode_media": {}, "episodes_this_iter": 123, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1.600000000000001, -2.0000000000000013, -2.0000000000000013, -2.700000000000002, -2.800000000000002, -1.700000000000001, -2.0000000000000013, -1.9000000000000012, -1.5000000000000009, -2.2000000000000015, -1.700000000000001, -1.5000000000000009, -2.1000000000000014, -2.1000000000000014, -2.700000000000002, -1.8000000000000012, -1.600000000000001, -1.700000000000001, -2.0000000000000013, -7.8999999999999915, -2.600000000000002, -2.3000000000000016, -1.8000000000000012, -1.600000000000001, -1.700000000000001, -2.5000000000000018, -3.5, -2.0000000000000013, -2.0000000000000013, -3.200000000000001, -1.700000000000001, -1.8000000000000012, -2.3000000000000016, -1.5000000000000009, -2.3000000000000016, -1.5000000000000009, -2.0000000000000013, -1.600000000000001, -2.5000000000000018, -2.600000000000002, -2.5000000000000018, -2.2000000000000015, -2.1000000000000014, -1.600000000000001, -2.600000000000002, -2.0000000000000013, -2.1000000000000014, -3.200000000000001, -2.1000000000000014, -3.200000000000001, -1.8000000000000012, -1.8000000000000012, -1.600000000000001, -3.200000000000001, -1.9000000000000012, -2.3000000000000016, -2.700000000000002, -2.800000000000002, -3.1000000000000014, -2.1000000000000014, -1.600000000000001, -2.2000000000000015, -2.2000000000000015, -2.0000000000000013, -3.9999999999999982, -2.3000000000000016, -2.4000000000000017, -1.5000000000000009, -1.9000000000000012, -1.9000000000000012, -2.700000000000002, -1.8000000000000012, -1.600000000000001, -2.0000000000000013, -1.700000000000001, -2.0000000000000013, -1.5000000000000009, -2.4000000000000017, -1.9000000000000012, -2.0000000000000013, -2.0000000000000013, -2.0000000000000013, -2.3000000000000016, -2.1000000000000014, -1.700000000000001, -1.8000000000000012, -2.600000000000002, -2.600000000000002, -2.0000000000000013, -2.1000000000000014, -1.9000000000000012, -1.5000000000000009, -2.0000000000000013, -2.2000000000000015, -7.499999999999986, -1.700000000000001, -2.3000000000000016, -2.3000000000000016, -2.1000000000000014, -2.3000000000000016, -1.8000000000000012, -1.600000000000001, -2.0000000000000013, -1.5000000000000009, -1.4000000000000008, -1.9000000000000012, -2.3000000000000016, -2.2000000000000015, -1.8000000000000012, -2.2000000000000015, -2.0000000000000013, -2.4000000000000017, -1.700000000000001, -1.9000000000000012, -1.700000000000001, -2.1000000000000014, -1.700000000000001, -1.9000000000000012, -2.1000000000000014, -2.4000000000000017, -1.9000000000000012, -2.600000000000002, -1.9000000000000012], "episode_lengths": [27, 31, 31, 38, 39, 28, 31, 30, 26, 33, 28, 26, 32, 32, 38, 29, 27, 28, 31, 75, 37, 34, 29, 27, 28, 36, 39, 31, 31, 43, 28, 29, 34, 26, 34, 26, 31, 27, 36, 37, 36, 33, 32, 27, 37, 31, 32, 38, 32, 43, 29, 29, 27, 41, 30, 34, 38, 39, 38, 32, 27, 33, 33, 31, 51, 34, 35, 26, 30, 30, 38, 29, 27, 31, 28, 31, 26, 35, 30, 31, 31, 31, 34, 32, 28, 29, 37, 37, 31, 32, 30, 26, 31, 33, 81, 28, 34, 34, 32, 34, 29, 27, 31, 26, 25, 30, 31, 33, 29, 33, 31, 35, 28, 30, 28, 32, 28, 30, 32, 35, 30, 35, 30]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2601109013986153, "mean_inference_ms": 0.6261647767706268, "mean_action_processing_ms": 0.06772915835543288, "mean_env_wait_ms": 6.3906941695087855, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005582289967110486, "StateBufferConnector_ms": 0.0031963596499063134, "ViewRequirementAgentConnector_ms": 0.07545812343194233}}, "episode_reward_max": -1.4000000000000008, "episode_reward_min": -7.8999999999999915, "episode_reward_mean": -2.1869918699187, "episode_len_mean": 32.520325203252035, "episodes_this_iter": 123, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1.600000000000001, -2.0000000000000013, -2.0000000000000013, -2.700000000000002, -2.800000000000002, -1.700000000000001, -2.0000000000000013, -1.9000000000000012, -1.5000000000000009, -2.2000000000000015, -1.700000000000001, -1.5000000000000009, -2.1000000000000014, -2.1000000000000014, -2.700000000000002, -1.8000000000000012, -1.600000000000001, -1.700000000000001, -2.0000000000000013, -7.8999999999999915, -2.600000000000002, -2.3000000000000016, -1.8000000000000012, -1.600000000000001, -1.700000000000001, -2.5000000000000018, -3.5, -2.0000000000000013, -2.0000000000000013, -3.200000000000001, -1.700000000000001, -1.8000000000000012, -2.3000000000000016, -1.5000000000000009, -2.3000000000000016, -1.5000000000000009, -2.0000000000000013, -1.600000000000001, -2.5000000000000018, -2.600000000000002, -2.5000000000000018, -2.2000000000000015, -2.1000000000000014, -1.600000000000001, -2.600000000000002, -2.0000000000000013, -2.1000000000000014, -3.200000000000001, -2.1000000000000014, -3.200000000000001, -1.8000000000000012, -1.8000000000000012, -1.600000000000001, -3.200000000000001, -1.9000000000000012, -2.3000000000000016, -2.700000000000002, -2.800000000000002, -3.1000000000000014, -2.1000000000000014, -1.600000000000001, -2.2000000000000015, -2.2000000000000015, -2.0000000000000013, -3.9999999999999982, -2.3000000000000016, -2.4000000000000017, -1.5000000000000009, -1.9000000000000012, -1.9000000000000012, -2.700000000000002, -1.8000000000000012, -1.600000000000001, -2.0000000000000013, -1.700000000000001, -2.0000000000000013, -1.5000000000000009, -2.4000000000000017, -1.9000000000000012, -2.0000000000000013, -2.0000000000000013, -2.0000000000000013, -2.3000000000000016, -2.1000000000000014, -1.700000000000001, -1.8000000000000012, -2.600000000000002, -2.600000000000002, -2.0000000000000013, -2.1000000000000014, -1.9000000000000012, -1.5000000000000009, -2.0000000000000013, -2.2000000000000015, -7.499999999999986, -1.700000000000001, -2.3000000000000016, -2.3000000000000016, -2.1000000000000014, -2.3000000000000016, -1.8000000000000012, -1.600000000000001, -2.0000000000000013, -1.5000000000000009, -1.4000000000000008, -1.9000000000000012, -2.3000000000000016, -2.2000000000000015, -1.8000000000000012, -2.2000000000000015, -2.0000000000000013, -2.4000000000000017, -1.700000000000001, -1.9000000000000012, -1.700000000000001, -2.1000000000000014, -1.700000000000001, -1.9000000000000012, -2.1000000000000014, -2.4000000000000017, -1.9000000000000012, -2.600000000000002, -1.9000000000000012], "episode_lengths": [27, 31, 31, 38, 39, 28, 31, 30, 26, 33, 28, 26, 32, 32, 38, 29, 27, 28, 31, 75, 37, 34, 29, 27, 28, 36, 39, 31, 31, 43, 28, 29, 34, 26, 34, 26, 31, 27, 36, 37, 36, 33, 32, 27, 37, 31, 32, 38, 32, 43, 29, 29, 27, 41, 30, 34, 38, 39, 38, 32, 27, 33, 33, 31, 51, 34, 35, 26, 30, 30, 38, 29, 27, 31, 28, 31, 26, 35, 30, 31, 31, 31, 34, 32, 28, 29, 37, 37, 31, 32, 30, 26, 31, 33, 81, 28, 34, 34, 32, 34, 29, 27, 31, 26, 25, 30, 31, 33, 29, 33, 31, 35, 28, 30, 28, 32, 28, 30, 32, 35, 30, 35, 30]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2601109013986153, "mean_inference_ms": 0.6261647767706268, "mean_action_processing_ms": 0.06772915835543288, "mean_env_wait_ms": 6.3906941695087855, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005582289967110486, "StateBufferConnector_ms": 0.0031963596499063134, "ViewRequirementAgentConnector_ms": 0.07545812343194233}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 140000, "num_agent_steps_trained": 140000, "num_env_steps_sampled": 140000, "num_env_steps_trained": 140000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 337.141080844273, "num_env_steps_trained_throughput_per_sec": 337.141080844273, "timesteps_total": 140000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 140000, "timers": {"training_iteration_time_ms": 11561.628, "sample_time_ms": 8106.559, "load_time_ms": 2.135, "load_throughput": 1873105.204, "learn_time_ms": 3450.574, "learn_throughput": 1159.227, "synch_weights_time_ms": 1.722}, "counters": {"num_env_steps_sampled": 140000, "num_env_steps_trained": 140000, "num_agent_steps_sampled": 140000, "num_agent_steps_trained": 140000}, "done": false, "episodes_total": 1783, "training_iteration": 35, "trial_id": "83204_00000", "date": "2024-03-07_12-09-13", "timestamp": 1709831353, "time_this_iter_s": 11.867088079452515, "time_total_s": 383.0550847053528, "pid": 102666, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fcd19c36f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 383.0550847053528, "iterations_since_restore": 35, "perf": {"cpu_util_percent": 20.826666666666664, "ram_util_percent": 44.10000000000001, "gpu_util_percent0": 0.06999999999999999, "vram_util_percent0": 0.098876953125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 0.3258655261648919, "policy_loss": -0.01911251580002167, "vf_loss": 0.3436009086017567, "vf_explained_var": 0.8249744932497701, "kl": 0.006885665456721292, "entropy": 0.37102928353894143, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 33015.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_agent_steps_sampled": 144000, "num_agent_steps_trained": 144000}, "sampler_results": {"episode_reward_max": -1.4000000000000008, "episode_reward_min": -8.999999999999982, "episode_reward_mean": -2.133600000000001, "episode_len_mean": 32.056, "episode_media": {}, "episodes_this_iter": 125, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2.3000000000000016, -1.9000000000000012, -1.700000000000001, -2.900000000000002, -1.8000000000000012, -1.4000000000000008, -2.0000000000000013, -2.3000000000000016, -1.700000000000001, -2.5000000000000018, -1.600000000000001, -1.700000000000001, -2.1000000000000014, -1.5000000000000009, -1.600000000000001, -2.700000000000002, -1.8000000000000012, -1.9000000000000012, -1.8000000000000012, -3.5, -2.0000000000000013, -2.3000000000000016, -2.4000000000000017, -1.8000000000000012, -1.600000000000001, -1.8000000000000012, -2.0000000000000013, -1.600000000000001, -1.700000000000001, -1.8000000000000012, -2.600000000000002, -1.700000000000001, -1.5000000000000009, -2.2000000000000015, -1.600000000000001, -2.2000000000000015, -1.5000000000000009, -7.099999999999998, -1.8000000000000012, -2.5000000000000018, -1.9000000000000012, -1.9000000000000012, -1.9000000000000012, -1.8000000000000012, -2.2000000000000015, -2.3000000000000016, -1.700000000000001, -1.8000000000000012, -2.0000000000000013, -2.5000000000000018, -1.9000000000000012, -2.0000000000000013, -3.200000000000002, -1.8000000000000012, -1.8000000000000012, -2.5000000000000018, -1.9000000000000012, -8.999999999999982, -2.0000000000000013, -2.1000000000000014, -2.1000000000000014, -1.700000000000001, -1.700000000000001, -2.1000000000000014, -1.700000000000001, -2.600000000000002, -1.600000000000001, -1.9000000000000012, -1.4000000000000008, -1.700000000000001, -1.600000000000001, -2.600000000000002, -2.4000000000000017, -4.700000000000003, -2.800000000000002, -1.700000000000001, -1.600000000000001, -1.8000000000000012, -1.5000000000000009, -3.4000000000000004, -2.2000000000000015, -1.5000000000000009, -2.2000000000000015, -1.8000000000000012, -2.900000000000002, -2.4000000000000017, -2.0000000000000013, -1.5000000000000009, -3.1000000000000014, -1.8000000000000012, -1.600000000000001, -2.700000000000002, -2.1000000000000014, -2.0000000000000013, -2.1000000000000014, -1.9000000000000012, -1.9000000000000012, -1.4000000000000008, -1.600000000000001, -1.700000000000001, -1.600000000000001, -1.9000000000000012, -2.1000000000000014, -2.5000000000000018, -1.9000000000000012, -1.9000000000000012, -1.5000000000000009, -1.9000000000000012, -1.9000000000000012, -3.0000000000000018, -2.800000000000002, -3.700000000000001, -1.9000000000000012, -2.4000000000000017, -1.600000000000001, -2.2000000000000015, -2.1000000000000014, -1.9000000000000012, -1.5000000000000009, -1.8000000000000012, -2.4000000000000017, -1.5000000000000009, -1.600000000000001, -1.600000000000001, -1.9000000000000012], "episode_lengths": [34, 30, 28, 40, 29, 25, 31, 34, 28, 35, 27, 28, 32, 26, 27, 38, 29, 30, 29, 46, 31, 34, 35, 29, 27, 29, 31, 27, 28, 29, 37, 28, 26, 33, 27, 33, 26, 71, 29, 36, 30, 30, 30, 29, 33, 34, 28, 29, 31, 36, 30, 31, 40, 29, 29, 36, 30, 98, 31, 32, 32, 28, 28, 32, 28, 37, 27, 30, 25, 28, 27, 37, 35, 50, 39, 28, 27, 29, 26, 45, 33, 26, 33, 29, 40, 35, 31, 26, 40, 29, 27, 38, 32, 31, 32, 30, 30, 25, 27, 28, 27, 30, 32, 36, 30, 30, 26, 30, 30, 38, 39, 44, 30, 35, 27, 33, 32, 30, 26, 29, 35, 26, 27, 27, 30]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2634940119982528, "mean_inference_ms": 0.6264058975593131, "mean_action_processing_ms": 0.06778489553624734, "mean_env_wait_ms": 6.416958797110783, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005695533752441406, "StateBufferConnector_ms": 0.003232383728027344, "ViewRequirementAgentConnector_ms": 0.07521896362304688}}, "episode_reward_max": -1.4000000000000008, "episode_reward_min": -8.999999999999982, "episode_reward_mean": -2.133600000000001, "episode_len_mean": 32.056, "episodes_this_iter": 125, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-2.3000000000000016, -1.9000000000000012, -1.700000000000001, -2.900000000000002, -1.8000000000000012, -1.4000000000000008, -2.0000000000000013, -2.3000000000000016, -1.700000000000001, -2.5000000000000018, -1.600000000000001, -1.700000000000001, -2.1000000000000014, -1.5000000000000009, -1.600000000000001, -2.700000000000002, -1.8000000000000012, -1.9000000000000012, -1.8000000000000012, -3.5, -2.0000000000000013, -2.3000000000000016, -2.4000000000000017, -1.8000000000000012, -1.600000000000001, -1.8000000000000012, -2.0000000000000013, -1.600000000000001, -1.700000000000001, -1.8000000000000012, -2.600000000000002, -1.700000000000001, -1.5000000000000009, -2.2000000000000015, -1.600000000000001, -2.2000000000000015, -1.5000000000000009, -7.099999999999998, -1.8000000000000012, -2.5000000000000018, -1.9000000000000012, -1.9000000000000012, -1.9000000000000012, -1.8000000000000012, -2.2000000000000015, -2.3000000000000016, -1.700000000000001, -1.8000000000000012, -2.0000000000000013, -2.5000000000000018, -1.9000000000000012, -2.0000000000000013, -3.200000000000002, -1.8000000000000012, -1.8000000000000012, -2.5000000000000018, -1.9000000000000012, -8.999999999999982, -2.0000000000000013, -2.1000000000000014, -2.1000000000000014, -1.700000000000001, -1.700000000000001, -2.1000000000000014, -1.700000000000001, -2.600000000000002, -1.600000000000001, -1.9000000000000012, -1.4000000000000008, -1.700000000000001, -1.600000000000001, -2.600000000000002, -2.4000000000000017, -4.700000000000003, -2.800000000000002, -1.700000000000001, -1.600000000000001, -1.8000000000000012, -1.5000000000000009, -3.4000000000000004, -2.2000000000000015, -1.5000000000000009, -2.2000000000000015, -1.8000000000000012, -2.900000000000002, -2.4000000000000017, -2.0000000000000013, -1.5000000000000009, -3.1000000000000014, -1.8000000000000012, -1.600000000000001, -2.700000000000002, -2.1000000000000014, -2.0000000000000013, -2.1000000000000014, -1.9000000000000012, -1.9000000000000012, -1.4000000000000008, -1.600000000000001, -1.700000000000001, -1.600000000000001, -1.9000000000000012, -2.1000000000000014, -2.5000000000000018, -1.9000000000000012, -1.9000000000000012, -1.5000000000000009, -1.9000000000000012, -1.9000000000000012, -3.0000000000000018, -2.800000000000002, -3.700000000000001, -1.9000000000000012, -2.4000000000000017, -1.600000000000001, -2.2000000000000015, -2.1000000000000014, -1.9000000000000012, -1.5000000000000009, -1.8000000000000012, -2.4000000000000017, -1.5000000000000009, -1.600000000000001, -1.600000000000001, -1.9000000000000012], "episode_lengths": [34, 30, 28, 40, 29, 25, 31, 34, 28, 35, 27, 28, 32, 26, 27, 38, 29, 30, 29, 46, 31, 34, 35, 29, 27, 29, 31, 27, 28, 29, 37, 28, 26, 33, 27, 33, 26, 71, 29, 36, 30, 30, 30, 29, 33, 34, 28, 29, 31, 36, 30, 31, 40, 29, 29, 36, 30, 98, 31, 32, 32, 28, 28, 32, 28, 37, 27, 30, 25, 28, 27, 37, 35, 50, 39, 28, 27, 29, 26, 45, 33, 26, 33, 29, 40, 35, 31, 26, 40, 29, 27, 38, 32, 31, 32, 30, 30, 25, 27, 28, 27, 30, 32, 36, 30, 30, 26, 30, 30, 38, 39, 44, 30, 35, 27, 33, 32, 30, 26, 29, 35, 26, 27, 27, 30]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2634940119982528, "mean_inference_ms": 0.6264058975593131, "mean_action_processing_ms": 0.06778489553624734, "mean_env_wait_ms": 6.416958797110783, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005695533752441406, "StateBufferConnector_ms": 0.003232383728027344, "ViewRequirementAgentConnector_ms": 0.07521896362304688}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 144000, "num_agent_steps_trained": 144000, "num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 332.0136207541759, "num_env_steps_trained_throughput_per_sec": 332.0136207541759, "timesteps_total": 144000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 144000, "timers": {"training_iteration_time_ms": 11634.413, "sample_time_ms": 8172.689, "load_time_ms": 2.135, "load_throughput": 1873502.624, "learn_time_ms": 3457.241, "learn_throughput": 1156.992, "synch_weights_time_ms": 1.709}, "counters": {"num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_agent_steps_sampled": 144000, "num_agent_steps_trained": 144000}, "done": false, "episodes_total": 1908, "training_iteration": 36, "trial_id": "83204_00000", "date": "2024-03-07_12-09-25", "timestamp": 1709831365, "time_this_iter_s": 12.05024242401123, "time_total_s": 395.105327129364, "pid": 102666, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fcd19c36f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 395.105327129364, "iterations_since_restore": 36, "perf": {"cpu_util_percent": 19.9125, "ram_util_percent": 44.150000000000006, "gpu_util_percent0": 0.079375, "vram_util_percent0": 0.098876953125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 0.3886558291619964, "policy_loss": -0.008032808168440736, "vf_loss": 0.39496312506136394, "vf_explained_var": 0.840654900509824, "kl": 0.008627558974581095, "entropy": 0.3656939818013099, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 33945.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 148000, "num_env_steps_trained": 148000, "num_agent_steps_sampled": 148000, "num_agent_steps_trained": 148000}, "sampler_results": {"episode_reward_max": -1.4000000000000008, "episode_reward_min": -16.399999999999974, "episode_reward_mean": -2.1559055118110244, "episode_len_mean": 31.716535433070867, "episode_media": {}, "episodes_this_iter": 127, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1.9000000000000012, -2.1000000000000014, -1.4000000000000008, -1.5000000000000009, -2.2000000000000015, -1.700000000000001, -2.1000000000000014, -2.0000000000000013, -4.000000000000002, -16.399999999999974, -1.700000000000001, -2.1000000000000014, -2.0000000000000013, -1.600000000000001, -2.5000000000000018, -2.0000000000000013, -1.9000000000000012, -2.2000000000000015, -3.4000000000000004, -2.0000000000000013, -2.1000000000000014, -2.1000000000000014, -1.700000000000001, -2.0000000000000013, -1.9000000000000012, -2.1000000000000014, -1.8000000000000012, -1.9000000000000012, -2.1000000000000014, -2.5000000000000018, -1.600000000000001, -2.700000000000002, -2.3000000000000016, -1.5000000000000009, -1.5000000000000009, -1.600000000000001, -1.600000000000001, -1.4000000000000008, -2.5000000000000018, -2.2000000000000015, -1.8000000000000012, -2.0000000000000013, -3.0000000000000018, -2.1000000000000014, -1.4000000000000008, -2.900000000000002, -1.600000000000001, -2.1000000000000014, -1.9000000000000012, -1.9000000000000012, -1.700000000000001, -1.5000000000000009, -2.0000000000000013, -2.700000000000002, -2.900000000000002, -1.9000000000000012, -2.3000000000000016, -1.4000000000000008, -4.100000000000001, -1.8000000000000012, -1.9000000000000012, -1.700000000000001, -3.4000000000000004, -1.700000000000001, -2.0000000000000013, -1.700000000000001, -1.8000000000000012, -1.700000000000001, -1.700000000000001, -2.1000000000000014, -4.299999999999997, -1.8000000000000012, -1.5000000000000009, -1.8000000000000012, -1.700000000000001, -2.3000000000000016, -2.3000000000000016, -1.8000000000000012, -1.9000000000000012, -1.8000000000000012, -1.600000000000001, -1.700000000000001, -2.1000000000000014, -2.1000000000000014, -1.9000000000000012, -2.2000000000000015, -2.1000000000000014, -1.700000000000001, -1.5000000000000009, -2.5000000000000018, -1.8000000000000012, -1.600000000000001, -1.8000000000000012, -2.0000000000000013, -2.700000000000002, -1.5000000000000009, -1.8000000000000012, -3.1000000000000014, -2.4000000000000017, -2.2000000000000015, -2.2000000000000015, -1.5000000000000009, -1.5000000000000009, -2.2000000000000015, -1.9000000000000012, -1.700000000000001, -1.9000000000000012, -2.3000000000000016, -1.600000000000001, -3.1000000000000014, -1.700000000000001, -1.600000000000001, -1.700000000000001, -3.5000000000000018, -1.9000000000000012, -2.800000000000002, -2.0000000000000013, -2.2000000000000015, -1.8000000000000012, -2.600000000000002, -1.700000000000001, -2.3000000000000016, -1.600000000000001, -1.8000000000000012, -1.5000000000000009, -1.700000000000001, -1.5000000000000009], "episode_lengths": [30, 32, 25, 26, 33, 28, 32, 31, 41, 111, 28, 32, 31, 27, 36, 31, 30, 33, 44, 31, 32, 32, 28, 31, 30, 32, 29, 30, 32, 36, 27, 38, 34, 26, 26, 27, 27, 25, 36, 33, 29, 31, 41, 32, 25, 40, 27, 32, 30, 30, 28, 26, 31, 38, 40, 30, 34, 25, 45, 29, 30, 28, 40, 28, 31, 28, 29, 28, 28, 32, 54, 29, 26, 29, 28, 34, 34, 29, 30, 29, 27, 28, 32, 32, 30, 33, 32, 28, 26, 36, 29, 27, 29, 31, 38, 26, 29, 36, 32, 33, 33, 26, 26, 33, 30, 28, 30, 34, 27, 42, 28, 27, 28, 37, 30, 39, 31, 33, 29, 37, 28, 32, 27, 29, 26, 28, 26]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2667191864723428, "mean_inference_ms": 0.626613109148545, "mean_action_processing_ms": 0.0677396964280132, "mean_env_wait_ms": 6.440807936889992, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0056523976363535, "StateBufferConnector_ms": 0.003219401742529681, "ViewRequirementAgentConnector_ms": 0.07537593991737666}}, "episode_reward_max": -1.4000000000000008, "episode_reward_min": -16.399999999999974, "episode_reward_mean": -2.1559055118110244, "episode_len_mean": 31.716535433070867, "episodes_this_iter": 127, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1.9000000000000012, -2.1000000000000014, -1.4000000000000008, -1.5000000000000009, -2.2000000000000015, -1.700000000000001, -2.1000000000000014, -2.0000000000000013, -4.000000000000002, -16.399999999999974, -1.700000000000001, -2.1000000000000014, -2.0000000000000013, -1.600000000000001, -2.5000000000000018, -2.0000000000000013, -1.9000000000000012, -2.2000000000000015, -3.4000000000000004, -2.0000000000000013, -2.1000000000000014, -2.1000000000000014, -1.700000000000001, -2.0000000000000013, -1.9000000000000012, -2.1000000000000014, -1.8000000000000012, -1.9000000000000012, -2.1000000000000014, -2.5000000000000018, -1.600000000000001, -2.700000000000002, -2.3000000000000016, -1.5000000000000009, -1.5000000000000009, -1.600000000000001, -1.600000000000001, -1.4000000000000008, -2.5000000000000018, -2.2000000000000015, -1.8000000000000012, -2.0000000000000013, -3.0000000000000018, -2.1000000000000014, -1.4000000000000008, -2.900000000000002, -1.600000000000001, -2.1000000000000014, -1.9000000000000012, -1.9000000000000012, -1.700000000000001, -1.5000000000000009, -2.0000000000000013, -2.700000000000002, -2.900000000000002, -1.9000000000000012, -2.3000000000000016, -1.4000000000000008, -4.100000000000001, -1.8000000000000012, -1.9000000000000012, -1.700000000000001, -3.4000000000000004, -1.700000000000001, -2.0000000000000013, -1.700000000000001, -1.8000000000000012, -1.700000000000001, -1.700000000000001, -2.1000000000000014, -4.299999999999997, -1.8000000000000012, -1.5000000000000009, -1.8000000000000012, -1.700000000000001, -2.3000000000000016, -2.3000000000000016, -1.8000000000000012, -1.9000000000000012, -1.8000000000000012, -1.600000000000001, -1.700000000000001, -2.1000000000000014, -2.1000000000000014, -1.9000000000000012, -2.2000000000000015, -2.1000000000000014, -1.700000000000001, -1.5000000000000009, -2.5000000000000018, -1.8000000000000012, -1.600000000000001, -1.8000000000000012, -2.0000000000000013, -2.700000000000002, -1.5000000000000009, -1.8000000000000012, -3.1000000000000014, -2.4000000000000017, -2.2000000000000015, -2.2000000000000015, -1.5000000000000009, -1.5000000000000009, -2.2000000000000015, -1.9000000000000012, -1.700000000000001, -1.9000000000000012, -2.3000000000000016, -1.600000000000001, -3.1000000000000014, -1.700000000000001, -1.600000000000001, -1.700000000000001, -3.5000000000000018, -1.9000000000000012, -2.800000000000002, -2.0000000000000013, -2.2000000000000015, -1.8000000000000012, -2.600000000000002, -1.700000000000001, -2.3000000000000016, -1.600000000000001, -1.8000000000000012, -1.5000000000000009, -1.700000000000001, -1.5000000000000009], "episode_lengths": [30, 32, 25, 26, 33, 28, 32, 31, 41, 111, 28, 32, 31, 27, 36, 31, 30, 33, 44, 31, 32, 32, 28, 31, 30, 32, 29, 30, 32, 36, 27, 38, 34, 26, 26, 27, 27, 25, 36, 33, 29, 31, 41, 32, 25, 40, 27, 32, 30, 30, 28, 26, 31, 38, 40, 30, 34, 25, 45, 29, 30, 28, 40, 28, 31, 28, 29, 28, 28, 32, 54, 29, 26, 29, 28, 34, 34, 29, 30, 29, 27, 28, 32, 32, 30, 33, 32, 28, 26, 36, 29, 27, 29, 31, 38, 26, 29, 36, 32, 33, 33, 26, 26, 33, 30, 28, 30, 34, 27, 42, 28, 27, 28, 37, 30, 39, 31, 33, 29, 37, 28, 32, 27, 29, 26, 28, 26]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2667191864723428, "mean_inference_ms": 0.626613109148545, "mean_action_processing_ms": 0.0677396964280132, "mean_env_wait_ms": 6.440807936889992, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0056523976363535, "StateBufferConnector_ms": 0.003219401742529681, "ViewRequirementAgentConnector_ms": 0.07537593991737666}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 148000, "num_agent_steps_trained": 148000, "num_env_steps_sampled": 148000, "num_env_steps_trained": 148000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 328.72358180534775, "num_env_steps_trained_throughput_per_sec": 328.72358180534775, "timesteps_total": 148000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 148000, "timers": {"training_iteration_time_ms": 11710.896, "sample_time_ms": 8240.87, "load_time_ms": 2.136, "load_throughput": 1872896.103, "learn_time_ms": 3465.554, "learn_throughput": 1154.217, "synch_weights_time_ms": 1.696}, "counters": {"num_env_steps_sampled": 148000, "num_env_steps_trained": 148000, "num_agent_steps_sampled": 148000, "num_agent_steps_trained": 148000}, "done": false, "episodes_total": 2035, "training_iteration": 37, "trial_id": "83204_00000", "date": "2024-03-07_12-09-37", "timestamp": 1709831377, "time_this_iter_s": 12.171218156814575, "time_total_s": 407.2765452861786, "pid": 102666, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fcd19c36f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 407.2765452861786, "iterations_since_restore": 37, "perf": {"cpu_util_percent": 20.0625, "ram_util_percent": 44.1125, "gpu_util_percent0": 0.074375, "vram_util_percent0": 0.098876953125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 0.08089496609235372, "policy_loss": -0.007966632876665361, "vf_loss": 0.08749775122150139, "vf_explained_var": 0.9332123459026378, "kl": 0.006819230242496563, "entropy": 0.33317493046483687, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 34875.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 152000, "num_env_steps_trained": 152000, "num_agent_steps_sampled": 152000, "num_agent_steps_trained": 152000}, "sampler_results": {"episode_reward_max": -1.4000000000000008, "episode_reward_min": -3.799999999999999, "episode_reward_mean": -1.9615384615384628, "episode_len_mean": 30.50769230769231, "episode_media": {}, "episodes_this_iter": 130, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1.700000000000001, -3.4000000000000004, -1.9000000000000012, -2.2000000000000015, -1.8000000000000012, -2.4000000000000017, -1.5000000000000009, -1.9000000000000012, -1.8000000000000012, -2.2000000000000015, -1.700000000000001, -1.8000000000000012, -2.200000000000002, -1.8000000000000012, -1.8000000000000012, -2.1000000000000014, -1.600000000000001, -1.8000000000000012, -2.0000000000000013, -3.0000000000000018, -2.1000000000000014, -2.3000000000000016, -1.8000000000000012, -2.1000000000000014, -1.9000000000000012, -1.9000000000000012, -2.1000000000000014, -1.9000000000000012, -2.5000000000000018, -1.9000000000000012, -1.600000000000001, -1.600000000000001, -1.600000000000001, -1.5000000000000009, -2.1000000000000014, -1.9000000000000012, -1.600000000000001, -1.600000000000001, -1.9000000000000012, -1.8000000000000012, -2.0000000000000013, -1.8000000000000012, -1.8000000000000012, -2.1000000000000014, -2.4000000000000017, -1.4000000000000008, -2.2000000000000015, -1.700000000000001, -2.4000000000000017, -1.9000000000000012, -1.4000000000000008, -1.5000000000000009, -1.600000000000001, -2.3000000000000016, -2.1000000000000014, -2.4000000000000017, -1.4000000000000008, -3.799999999999999, -2.0000000000000013, -1.700000000000001, -1.8000000000000012, -2.3000000000000016, -1.600000000000001, -2.1000000000000014, -2.0000000000000013, -3.799999999999999, -1.4000000000000008, -1.9000000000000012, -1.9000000000000012, -1.600000000000001, -1.700000000000001, -2.0000000000000013, -1.8000000000000012, -2.2000000000000015, -1.5000000000000009, -1.9000000000000012, -1.700000000000001, -1.8000000000000012, -1.700000000000001, -1.600000000000001, -1.8000000000000012, -1.9000000000000012, -2.2000000000000015, -1.600000000000001, -1.8000000000000012, -2.1000000000000014, -2.5000000000000018, -2.1000000000000014, -2.3000000000000016, -1.8000000000000012, -1.5000000000000009, -1.5000000000000009, -1.4000000000000008, -1.700000000000001, -2.4000000000000017, -2.2000000000000015, -1.5000000000000009, -1.700000000000001, -2.0000000000000013, -2.3000000000000016, -2.4000000000000017, -2.1000000000000014, -2.4000000000000017, -1.9000000000000012, -1.8000000000000012, -1.8000000000000012, -2.0000000000000013, -1.700000000000001, -1.5000000000000009, -2.3000000000000016, -2.0000000000000013, -1.9000000000000012, -2.0000000000000013, -1.600000000000001, -2.5000000000000018, -2.4000000000000017, -1.600000000000001, -2.900000000000002, -1.4000000000000008, -3.0000000000000018, -3.200000000000001, -1.8000000000000012, -2.0000000000000013, -1.700000000000001, -2.1000000000000014, -1.5000000000000009, -1.600000000000001, -1.5000000000000009, -1.8000000000000012, -1.8000000000000012], "episode_lengths": [28, 40, 30, 33, 29, 35, 26, 30, 29, 33, 28, 29, 31, 29, 29, 32, 27, 29, 31, 40, 32, 34, 29, 32, 30, 30, 32, 30, 36, 30, 27, 27, 27, 26, 32, 30, 27, 27, 30, 29, 31, 29, 29, 32, 35, 25, 33, 28, 35, 30, 25, 26, 27, 34, 32, 35, 25, 45, 31, 28, 29, 34, 27, 32, 31, 49, 25, 30, 30, 27, 28, 31, 29, 32, 26, 30, 28, 29, 28, 27, 29, 30, 33, 27, 29, 32, 36, 32, 34, 29, 26, 26, 25, 28, 35, 33, 26, 28, 31, 34, 35, 32, 35, 30, 29, 29, 31, 28, 26, 34, 31, 30, 31, 27, 36, 35, 27, 40, 25, 40, 43, 29, 31, 28, 32, 26, 27, 26, 29, 29]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2700012023764579, "mean_inference_ms": 0.6272109633636465, "mean_action_processing_ms": 0.06781734184450168, "mean_env_wait_ms": 6.466208979330357, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005786418914794922, "StateBufferConnector_ms": 0.0032478112440842847, "ViewRequirementAgentConnector_ms": 0.07617436922513522}}, "episode_reward_max": -1.4000000000000008, "episode_reward_min": -3.799999999999999, "episode_reward_mean": -1.9615384615384628, "episode_len_mean": 30.50769230769231, "episodes_this_iter": 130, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1.700000000000001, -3.4000000000000004, -1.9000000000000012, -2.2000000000000015, -1.8000000000000012, -2.4000000000000017, -1.5000000000000009, -1.9000000000000012, -1.8000000000000012, -2.2000000000000015, -1.700000000000001, -1.8000000000000012, -2.200000000000002, -1.8000000000000012, -1.8000000000000012, -2.1000000000000014, -1.600000000000001, -1.8000000000000012, -2.0000000000000013, -3.0000000000000018, -2.1000000000000014, -2.3000000000000016, -1.8000000000000012, -2.1000000000000014, -1.9000000000000012, -1.9000000000000012, -2.1000000000000014, -1.9000000000000012, -2.5000000000000018, -1.9000000000000012, -1.600000000000001, -1.600000000000001, -1.600000000000001, -1.5000000000000009, -2.1000000000000014, -1.9000000000000012, -1.600000000000001, -1.600000000000001, -1.9000000000000012, -1.8000000000000012, -2.0000000000000013, -1.8000000000000012, -1.8000000000000012, -2.1000000000000014, -2.4000000000000017, -1.4000000000000008, -2.2000000000000015, -1.700000000000001, -2.4000000000000017, -1.9000000000000012, -1.4000000000000008, -1.5000000000000009, -1.600000000000001, -2.3000000000000016, -2.1000000000000014, -2.4000000000000017, -1.4000000000000008, -3.799999999999999, -2.0000000000000013, -1.700000000000001, -1.8000000000000012, -2.3000000000000016, -1.600000000000001, -2.1000000000000014, -2.0000000000000013, -3.799999999999999, -1.4000000000000008, -1.9000000000000012, -1.9000000000000012, -1.600000000000001, -1.700000000000001, -2.0000000000000013, -1.8000000000000012, -2.2000000000000015, -1.5000000000000009, -1.9000000000000012, -1.700000000000001, -1.8000000000000012, -1.700000000000001, -1.600000000000001, -1.8000000000000012, -1.9000000000000012, -2.2000000000000015, -1.600000000000001, -1.8000000000000012, -2.1000000000000014, -2.5000000000000018, -2.1000000000000014, -2.3000000000000016, -1.8000000000000012, -1.5000000000000009, -1.5000000000000009, -1.4000000000000008, -1.700000000000001, -2.4000000000000017, -2.2000000000000015, -1.5000000000000009, -1.700000000000001, -2.0000000000000013, -2.3000000000000016, -2.4000000000000017, -2.1000000000000014, -2.4000000000000017, -1.9000000000000012, -1.8000000000000012, -1.8000000000000012, -2.0000000000000013, -1.700000000000001, -1.5000000000000009, -2.3000000000000016, -2.0000000000000013, -1.9000000000000012, -2.0000000000000013, -1.600000000000001, -2.5000000000000018, -2.4000000000000017, -1.600000000000001, -2.900000000000002, -1.4000000000000008, -3.0000000000000018, -3.200000000000001, -1.8000000000000012, -2.0000000000000013, -1.700000000000001, -2.1000000000000014, -1.5000000000000009, -1.600000000000001, -1.5000000000000009, -1.8000000000000012, -1.8000000000000012], "episode_lengths": [28, 40, 30, 33, 29, 35, 26, 30, 29, 33, 28, 29, 31, 29, 29, 32, 27, 29, 31, 40, 32, 34, 29, 32, 30, 30, 32, 30, 36, 30, 27, 27, 27, 26, 32, 30, 27, 27, 30, 29, 31, 29, 29, 32, 35, 25, 33, 28, 35, 30, 25, 26, 27, 34, 32, 35, 25, 45, 31, 28, 29, 34, 27, 32, 31, 49, 25, 30, 30, 27, 28, 31, 29, 32, 26, 30, 28, 29, 28, 27, 29, 30, 33, 27, 29, 32, 36, 32, 34, 29, 26, 26, 25, 28, 35, 33, 26, 28, 31, 34, 35, 32, 35, 30, 29, 29, 31, 28, 26, 34, 31, 30, 31, 27, 36, 35, 27, 40, 25, 40, 43, 29, 31, 28, 32, 26, 27, 26, 29, 29]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2700012023764579, "mean_inference_ms": 0.6272109633636465, "mean_action_processing_ms": 0.06781734184450168, "mean_env_wait_ms": 6.466208979330357, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005786418914794922, "StateBufferConnector_ms": 0.0032478112440842847, "ViewRequirementAgentConnector_ms": 0.07617436922513522}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 152000, "num_agent_steps_trained": 152000, "num_env_steps_sampled": 152000, "num_env_steps_trained": 152000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 332.52465693983623, "num_env_steps_trained_throughput_per_sec": 332.52465693983623, "timesteps_total": 152000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 152000, "timers": {"training_iteration_time_ms": 11785.51, "sample_time_ms": 8312.976, "load_time_ms": 1.023, "load_throughput": 3911958.402, "learn_time_ms": 3469.185, "learn_throughput": 1153.008, "synch_weights_time_ms": 1.687}, "counters": {"num_env_steps_sampled": 152000, "num_env_steps_trained": 152000, "num_agent_steps_sampled": 152000, "num_agent_steps_trained": 152000}, "done": false, "episodes_total": 2165, "training_iteration": 38, "trial_id": "83204_00000", "date": "2024-03-07_12-09-49", "timestamp": 1709831389, "time_this_iter_s": 12.03166151046753, "time_total_s": 419.3082067966461, "pid": 102666, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fcd19c36f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 419.3082067966461, "iterations_since_restore": 38, "perf": {"cpu_util_percent": 21.853333333333335, "ram_util_percent": 44.11333333333334, "gpu_util_percent0": 0.07066666666666666, "vram_util_percent0": 0.098876953125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 0.07674700466725695, "policy_loss": -0.007433428178711604, "vf_loss": 0.08277469382381007, "vf_explained_var": 0.930126069950801, "kl": 0.007028699856465607, "entropy": 0.3297751274881183, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 35805.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 156000, "num_env_steps_trained": 156000, "num_agent_steps_sampled": 156000, "num_agent_steps_trained": 156000}, "sampler_results": {"episode_reward_max": -1.4000000000000008, "episode_reward_min": -4.3000000000000025, "episode_reward_mean": -1.959848484848486, "episode_len_mean": 30.393939393939394, "episode_media": {}, "episodes_this_iter": 132, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2.1000000000000014, -1.5000000000000009, -2.3000000000000016, -1.8000000000000012, -1.9000000000000012, -1.9000000000000012, -2.3000000000000016, -2.1000000000000014, -1.8000000000000012, -2.0000000000000013, -3.8, -1.700000000000001, -1.8000000000000012, -1.4000000000000008, -2.1000000000000014, -1.600000000000001, -1.700000000000001, -1.4000000000000008, -2.3000000000000016, -1.8000000000000012, -2.0000000000000013, -2.3000000000000016, -1.4000000000000008, -1.4000000000000008, -3.5999999999999996, -1.700000000000001, -2.0000000000000013, -1.8000000000000012, -1.700000000000001, -1.9000000000000012, -1.700000000000001, -2.4000000000000017, -2.1000000000000014, -1.5000000000000009, -2.3000000000000016, -1.600000000000001, -1.8000000000000012, -1.700000000000001, -1.700000000000001, -1.9000000000000012, -2.1000000000000014, -2.0000000000000013, -1.600000000000001, -2.1000000000000014, -1.9000000000000012, -1.4000000000000008, -1.8000000000000012, -1.9000000000000012, -1.700000000000001, -2.5000000000000018, -2.600000000000002, -1.700000000000001, -2.2000000000000015, -1.700000000000001, -1.600000000000001, -2.4000000000000017, -1.600000000000001, -1.9000000000000012, -1.700000000000001, -1.700000000000001, -2.3000000000000016, -1.9000000000000012, -2.2000000000000015, -1.700000000000001, -2.1000000000000014, -2.1000000000000014, -1.600000000000001, -1.600000000000001, -1.5000000000000009, -3.3000000000000025, -2.0000000000000013, -1.5000000000000009, -2.0000000000000013, -1.9000000000000012, -2.0000000000000013, -1.8000000000000012, -2.2000000000000015, -2.3000000000000016, -2.600000000000002, -1.9000000000000012, -2.2000000000000015, -2.5000000000000018, -1.4000000000000008, -2.1000000000000014, -2.1000000000000014, -1.8000000000000012, -2.0000000000000013, -2.0000000000000013, -1.9000000000000012, -1.8000000000000012, -2.3000000000000016, -2.1000000000000014, -2.600000000000002, -2.2000000000000015, -2.2000000000000015, -4.3000000000000025, -1.700000000000001, -1.600000000000001, -1.700000000000001, -1.8000000000000012, -1.8000000000000012, -1.9000000000000012, -1.600000000000001, -1.700000000000001, -1.4000000000000008, -2.1000000000000014, -2.0000000000000013, -1.600000000000001, -2.4000000000000017, -1.8000000000000012, -1.8000000000000012, -2.0000000000000013, -2.700000000000002, -2.1000000000000014, -1.700000000000001, -1.9000000000000012, -2.1000000000000014, -2.600000000000002, -1.4000000000000008, -1.600000000000001, -1.4000000000000008, -1.4000000000000008, -1.600000000000001, -1.5000000000000009, -2.4000000000000017, -3.1000000000000014, -1.700000000000001, -1.5000000000000009, -1.9000000000000012, -1.4000000000000008, -2.4000000000000017, -1.5000000000000009], "episode_lengths": [32, 26, 33, 29, 30, 30, 34, 32, 29, 31, 45, 28, 29, 25, 32, 27, 28, 25, 34, 29, 31, 34, 25, 25, 40, 28, 31, 29, 28, 30, 28, 35, 32, 26, 34, 27, 29, 28, 28, 30, 32, 31, 27, 32, 30, 25, 29, 30, 28, 36, 37, 28, 33, 28, 27, 35, 27, 30, 28, 28, 33, 30, 33, 28, 32, 32, 27, 27, 26, 36, 31, 26, 31, 30, 31, 29, 33, 34, 37, 30, 33, 36, 25, 32, 32, 29, 31, 31, 30, 29, 34, 32, 37, 33, 33, 48, 28, 27, 28, 29, 29, 30, 27, 28, 25, 32, 31, 27, 35, 29, 29, 31, 38, 32, 28, 30, 32, 37, 25, 27, 25, 25, 27, 26, 35, 42, 28, 26, 30, 25, 35, 26]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.27315941625729506, "mean_inference_ms": 0.6274474633178379, "mean_action_processing_ms": 0.06783842463330304, "mean_env_wait_ms": 6.489656154510056, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005561113357543945, "StateBufferConnector_ms": 0.003216302756107215, "ViewRequirementAgentConnector_ms": 0.07504622141520183}}, "episode_reward_max": -1.4000000000000008, "episode_reward_min": -4.3000000000000025, "episode_reward_mean": -1.959848484848486, "episode_len_mean": 30.393939393939394, "episodes_this_iter": 132, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-2.1000000000000014, -1.5000000000000009, -2.3000000000000016, -1.8000000000000012, -1.9000000000000012, -1.9000000000000012, -2.3000000000000016, -2.1000000000000014, -1.8000000000000012, -2.0000000000000013, -3.8, -1.700000000000001, -1.8000000000000012, -1.4000000000000008, -2.1000000000000014, -1.600000000000001, -1.700000000000001, -1.4000000000000008, -2.3000000000000016, -1.8000000000000012, -2.0000000000000013, -2.3000000000000016, -1.4000000000000008, -1.4000000000000008, -3.5999999999999996, -1.700000000000001, -2.0000000000000013, -1.8000000000000012, -1.700000000000001, -1.9000000000000012, -1.700000000000001, -2.4000000000000017, -2.1000000000000014, -1.5000000000000009, -2.3000000000000016, -1.600000000000001, -1.8000000000000012, -1.700000000000001, -1.700000000000001, -1.9000000000000012, -2.1000000000000014, -2.0000000000000013, -1.600000000000001, -2.1000000000000014, -1.9000000000000012, -1.4000000000000008, -1.8000000000000012, -1.9000000000000012, -1.700000000000001, -2.5000000000000018, -2.600000000000002, -1.700000000000001, -2.2000000000000015, -1.700000000000001, -1.600000000000001, -2.4000000000000017, -1.600000000000001, -1.9000000000000012, -1.700000000000001, -1.700000000000001, -2.3000000000000016, -1.9000000000000012, -2.2000000000000015, -1.700000000000001, -2.1000000000000014, -2.1000000000000014, -1.600000000000001, -1.600000000000001, -1.5000000000000009, -3.3000000000000025, -2.0000000000000013, -1.5000000000000009, -2.0000000000000013, -1.9000000000000012, -2.0000000000000013, -1.8000000000000012, -2.2000000000000015, -2.3000000000000016, -2.600000000000002, -1.9000000000000012, -2.2000000000000015, -2.5000000000000018, -1.4000000000000008, -2.1000000000000014, -2.1000000000000014, -1.8000000000000012, -2.0000000000000013, -2.0000000000000013, -1.9000000000000012, -1.8000000000000012, -2.3000000000000016, -2.1000000000000014, -2.600000000000002, -2.2000000000000015, -2.2000000000000015, -4.3000000000000025, -1.700000000000001, -1.600000000000001, -1.700000000000001, -1.8000000000000012, -1.8000000000000012, -1.9000000000000012, -1.600000000000001, -1.700000000000001, -1.4000000000000008, -2.1000000000000014, -2.0000000000000013, -1.600000000000001, -2.4000000000000017, -1.8000000000000012, -1.8000000000000012, -2.0000000000000013, -2.700000000000002, -2.1000000000000014, -1.700000000000001, -1.9000000000000012, -2.1000000000000014, -2.600000000000002, -1.4000000000000008, -1.600000000000001, -1.4000000000000008, -1.4000000000000008, -1.600000000000001, -1.5000000000000009, -2.4000000000000017, -3.1000000000000014, -1.700000000000001, -1.5000000000000009, -1.9000000000000012, -1.4000000000000008, -2.4000000000000017, -1.5000000000000009], "episode_lengths": [32, 26, 33, 29, 30, 30, 34, 32, 29, 31, 45, 28, 29, 25, 32, 27, 28, 25, 34, 29, 31, 34, 25, 25, 40, 28, 31, 29, 28, 30, 28, 35, 32, 26, 34, 27, 29, 28, 28, 30, 32, 31, 27, 32, 30, 25, 29, 30, 28, 36, 37, 28, 33, 28, 27, 35, 27, 30, 28, 28, 33, 30, 33, 28, 32, 32, 27, 27, 26, 36, 31, 26, 31, 30, 31, 29, 33, 34, 37, 30, 33, 36, 25, 32, 32, 29, 31, 31, 30, 29, 34, 32, 37, 33, 33, 48, 28, 27, 28, 29, 29, 30, 27, 28, 25, 32, 31, 27, 35, 29, 29, 31, 38, 32, 28, 30, 32, 37, 25, 27, 25, 25, 27, 26, 35, 42, 28, 26, 30, 25, 35, 26]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.27315941625729506, "mean_inference_ms": 0.6274474633178379, "mean_action_processing_ms": 0.06783842463330304, "mean_env_wait_ms": 6.489656154510056, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005561113357543945, "StateBufferConnector_ms": 0.003216302756107215, "ViewRequirementAgentConnector_ms": 0.07504622141520183}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 156000, "num_agent_steps_trained": 156000, "num_env_steps_sampled": 156000, "num_env_steps_trained": 156000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 332.50851723762054, "num_env_steps_trained_throughput_per_sec": 332.50851723762054, "timesteps_total": 156000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 156000, "timers": {"training_iteration_time_ms": 11840.082, "sample_time_ms": 8364.138, "load_time_ms": 1.022, "load_throughput": 3914788.128, "learn_time_ms": 3472.599, "learn_throughput": 1151.875, "synch_weights_time_ms": 1.691}, "counters": {"num_env_steps_sampled": 156000, "num_env_steps_trained": 156000, "num_agent_steps_sampled": 156000, "num_agent_steps_trained": 156000}, "done": false, "episodes_total": 2297, "training_iteration": 39, "trial_id": "83204_00000", "date": "2024-03-07_12-10-01", "timestamp": 1709831401, "time_this_iter_s": 12.032443523406982, "time_total_s": 431.3406503200531, "pid": 102666, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fcd19c36f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 431.3406503200531, "iterations_since_restore": 39, "perf": {"cpu_util_percent": 19.93125, "ram_util_percent": 44.181250000000006, "gpu_util_percent0": 0.07125, "vram_util_percent0": 0.098876953125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 0.059349912879688126, "policy_loss": -0.006152985453285196, "vf_loss": 0.06344811112760136, "vf_explained_var": 0.9479906353258317, "kl": 0.010273938154914942, "entropy": 0.3051758512534121, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 36735.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 160000, "num_env_steps_trained": 160000, "num_agent_steps_sampled": 160000, "num_agent_steps_trained": 160000}, "sampler_results": {"episode_reward_max": -1.4000000000000008, "episode_reward_min": -3.9999999999999982, "episode_reward_mean": -1.9157894736842116, "episode_len_mean": 30.06015037593985, "episode_media": {}, "episodes_this_iter": 133, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1.5000000000000009, -2.3000000000000016, -2.0000000000000013, -1.5000000000000009, -1.9000000000000012, -1.700000000000001, -2.0000000000000013, -2.2000000000000015, -1.700000000000001, -2.2000000000000015, -2.800000000000002, -2.4000000000000017, -1.8000000000000012, -1.600000000000001, -2.600000000000002, -1.600000000000001, -1.8000000000000012, -2.800000000000002, -2.3000000000000016, -2.5000000000000018, -1.8000000000000012, -2.600000000000002, -2.1000000000000014, -1.8000000000000012, -2.2000000000000015, -1.700000000000001, -1.9000000000000012, -2.2000000000000015, -1.5000000000000009, -1.4000000000000008, -1.700000000000001, -2.3000000000000016, -1.600000000000001, -1.4000000000000008, -1.9000000000000012, -2.700000000000002, -1.9000000000000012, -1.8000000000000012, -1.600000000000001, -2.3000000000000016, -2.0000000000000013, -1.9000000000000012, -2.1000000000000014, -1.600000000000001, -1.9000000000000012, -2.700000000000002, -3.200000000000001, -2.1000000000000014, -1.600000000000001, -1.8000000000000012, -2.0000000000000013, -1.4000000000000008, -1.600000000000001, -1.8000000000000012, -2.0000000000000013, -2.1000000000000014, -1.4000000000000008, -2.0000000000000013, -1.600000000000001, -1.8000000000000012, -1.8000000000000012, -1.9000000000000012, -1.700000000000001, -1.5000000000000009, -1.9000000000000012, -2.700000000000002, -2.0000000000000013, -1.5000000000000009, -1.8000000000000012, -1.5000000000000009, -1.5000000000000009, -1.9000000000000012, -2.4000000000000017, -1.5000000000000009, -1.9000000000000012, -1.4000000000000008, -1.600000000000001, -1.8000000000000012, -1.9000000000000012, -1.5000000000000009, -2.2000000000000015, -1.700000000000001, -1.600000000000001, -2.2000000000000015, -1.600000000000001, -1.700000000000001, -1.700000000000001, -3.9999999999999982, -2.1000000000000014, -2.700000000000002, -2.4000000000000017, -1.700000000000001, -1.5000000000000009, -1.600000000000001, -1.600000000000001, -1.8000000000000012, -1.600000000000001, -1.9000000000000012, -1.4000000000000008, -1.700000000000001, -2.0000000000000013, -1.600000000000001, -3.1000000000000014, -1.9000000000000012, -1.9000000000000012, -1.4000000000000008, -1.8000000000000012, -1.5000000000000009, -1.700000000000001, -2.4000000000000017, -1.700000000000001, -1.600000000000001, -2.2000000000000015, -2.300000000000001, -1.700000000000001, -1.5000000000000009, -1.700000000000001, -2.600000000000002, -1.9000000000000012, -1.700000000000001, -2.3000000000000016, -2.2000000000000015, -1.4000000000000008, -2.600000000000002, -1.5000000000000009, -1.8000000000000012, -2.0000000000000013, -2.3000000000000016, -1.5000000000000009, -1.5000000000000009, -1.5000000000000009, -1.8000000000000012, -1.600000000000001], "episode_lengths": [26, 34, 31, 26, 30, 28, 31, 33, 28, 33, 39, 35, 29, 27, 37, 27, 29, 37, 34, 36, 29, 37, 32, 29, 33, 28, 30, 33, 26, 25, 28, 34, 27, 25, 30, 38, 30, 29, 27, 34, 31, 30, 32, 27, 30, 35, 39, 31, 27, 29, 31, 25, 27, 29, 31, 32, 25, 31, 27, 29, 29, 30, 28, 26, 30, 38, 31, 26, 29, 26, 26, 30, 35, 26, 30, 25, 27, 29, 30, 26, 33, 28, 27, 33, 27, 28, 28, 51, 32, 38, 35, 28, 26, 27, 27, 29, 27, 30, 25, 28, 31, 27, 42, 30, 30, 25, 29, 26, 28, 35, 28, 27, 33, 31, 28, 26, 28, 37, 30, 28, 34, 33, 25, 37, 26, 29, 31, 34, 26, 26, 26, 29, 27]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.27619308792451863, "mean_inference_ms": 0.6277041992730172, "mean_action_processing_ms": 0.0678529886699163, "mean_env_wait_ms": 6.51105181176064, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005861691066196987, "StateBufferConnector_ms": 0.0032410585790648497, "ViewRequirementAgentConnector_ms": 0.07566742430952259}}, "episode_reward_max": -1.4000000000000008, "episode_reward_min": -3.9999999999999982, "episode_reward_mean": -1.9157894736842116, "episode_len_mean": 30.06015037593985, "episodes_this_iter": 133, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1.5000000000000009, -2.3000000000000016, -2.0000000000000013, -1.5000000000000009, -1.9000000000000012, -1.700000000000001, -2.0000000000000013, -2.2000000000000015, -1.700000000000001, -2.2000000000000015, -2.800000000000002, -2.4000000000000017, -1.8000000000000012, -1.600000000000001, -2.600000000000002, -1.600000000000001, -1.8000000000000012, -2.800000000000002, -2.3000000000000016, -2.5000000000000018, -1.8000000000000012, -2.600000000000002, -2.1000000000000014, -1.8000000000000012, -2.2000000000000015, -1.700000000000001, -1.9000000000000012, -2.2000000000000015, -1.5000000000000009, -1.4000000000000008, -1.700000000000001, -2.3000000000000016, -1.600000000000001, -1.4000000000000008, -1.9000000000000012, -2.700000000000002, -1.9000000000000012, -1.8000000000000012, -1.600000000000001, -2.3000000000000016, -2.0000000000000013, -1.9000000000000012, -2.1000000000000014, -1.600000000000001, -1.9000000000000012, -2.700000000000002, -3.200000000000001, -2.1000000000000014, -1.600000000000001, -1.8000000000000012, -2.0000000000000013, -1.4000000000000008, -1.600000000000001, -1.8000000000000012, -2.0000000000000013, -2.1000000000000014, -1.4000000000000008, -2.0000000000000013, -1.600000000000001, -1.8000000000000012, -1.8000000000000012, -1.9000000000000012, -1.700000000000001, -1.5000000000000009, -1.9000000000000012, -2.700000000000002, -2.0000000000000013, -1.5000000000000009, -1.8000000000000012, -1.5000000000000009, -1.5000000000000009, -1.9000000000000012, -2.4000000000000017, -1.5000000000000009, -1.9000000000000012, -1.4000000000000008, -1.600000000000001, -1.8000000000000012, -1.9000000000000012, -1.5000000000000009, -2.2000000000000015, -1.700000000000001, -1.600000000000001, -2.2000000000000015, -1.600000000000001, -1.700000000000001, -1.700000000000001, -3.9999999999999982, -2.1000000000000014, -2.700000000000002, -2.4000000000000017, -1.700000000000001, -1.5000000000000009, -1.600000000000001, -1.600000000000001, -1.8000000000000012, -1.600000000000001, -1.9000000000000012, -1.4000000000000008, -1.700000000000001, -2.0000000000000013, -1.600000000000001, -3.1000000000000014, -1.9000000000000012, -1.9000000000000012, -1.4000000000000008, -1.8000000000000012, -1.5000000000000009, -1.700000000000001, -2.4000000000000017, -1.700000000000001, -1.600000000000001, -2.2000000000000015, -2.300000000000001, -1.700000000000001, -1.5000000000000009, -1.700000000000001, -2.600000000000002, -1.9000000000000012, -1.700000000000001, -2.3000000000000016, -2.2000000000000015, -1.4000000000000008, -2.600000000000002, -1.5000000000000009, -1.8000000000000012, -2.0000000000000013, -2.3000000000000016, -1.5000000000000009, -1.5000000000000009, -1.5000000000000009, -1.8000000000000012, -1.600000000000001], "episode_lengths": [26, 34, 31, 26, 30, 28, 31, 33, 28, 33, 39, 35, 29, 27, 37, 27, 29, 37, 34, 36, 29, 37, 32, 29, 33, 28, 30, 33, 26, 25, 28, 34, 27, 25, 30, 38, 30, 29, 27, 34, 31, 30, 32, 27, 30, 35, 39, 31, 27, 29, 31, 25, 27, 29, 31, 32, 25, 31, 27, 29, 29, 30, 28, 26, 30, 38, 31, 26, 29, 26, 26, 30, 35, 26, 30, 25, 27, 29, 30, 26, 33, 28, 27, 33, 27, 28, 28, 51, 32, 38, 35, 28, 26, 27, 27, 29, 27, 30, 25, 28, 31, 27, 42, 30, 30, 25, 29, 26, 28, 35, 28, 27, 33, 31, 28, 26, 28, 37, 30, 28, 34, 33, 25, 37, 26, 29, 31, 34, 26, 26, 26, 29, 27]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.27619308792451863, "mean_inference_ms": 0.6277041992730172, "mean_action_processing_ms": 0.0678529886699163, "mean_env_wait_ms": 6.51105181176064, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005861691066196987, "StateBufferConnector_ms": 0.0032410585790648497, "ViewRequirementAgentConnector_ms": 0.07566742430952259}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 160000, "num_agent_steps_trained": 160000, "num_env_steps_sampled": 160000, "num_env_steps_trained": 160000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 332.5200699153243, "num_env_steps_trained_throughput_per_sec": 332.5200699153243, "timesteps_total": 160000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 160000, "timers": {"training_iteration_time_ms": 11883.838, "sample_time_ms": 8416.78, "load_time_ms": 1.022, "load_throughput": 3914514.104, "learn_time_ms": 3463.709, "learn_throughput": 1154.831, "synch_weights_time_ms": 1.695}, "counters": {"num_env_steps_sampled": 160000, "num_env_steps_trained": 160000, "num_agent_steps_sampled": 160000, "num_agent_steps_trained": 160000}, "done": false, "episodes_total": 2430, "training_iteration": 40, "trial_id": "83204_00000", "date": "2024-03-07_12-10-13", "timestamp": 1709831413, "time_this_iter_s": 12.032412767410278, "time_total_s": 443.3730630874634, "pid": 102666, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fcd19c36f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 443.3730630874634, "iterations_since_restore": 40, "perf": {"cpu_util_percent": 20.1, "ram_util_percent": 44.16250000000001, "gpu_util_percent0": 0.073125, "vram_util_percent0": 0.098876953125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 0.12827395206813008, "policy_loss": -0.011374536195709821, "vf_loss": 0.1373010540521273, "vf_explained_var": 0.9010112689387414, "kl": 0.011737154828585237, "entropy": 0.2972092967840933, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 37665.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 164000, "num_env_steps_trained": 164000, "num_agent_steps_sampled": 164000, "num_agent_steps_trained": 164000}, "sampler_results": {"episode_reward_max": -1.4000000000000008, "episode_reward_min": -5.399999999999993, "episode_reward_mean": -1.9066666666666683, "episode_len_mean": 29.874074074074073, "episode_media": {}, "episodes_this_iter": 135, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1.9000000000000012, -1.5000000000000009, -1.8000000000000012, -2.5000000000000018, -1.4000000000000008, -1.5000000000000009, -3.799999999999999, -2.1000000000000014, -1.4000000000000008, -1.700000000000001, -1.4000000000000008, -1.700000000000001, -1.9000000000000012, -2.1000000000000014, -2.2000000000000015, -2.3000000000000016, -2.1000000000000014, -1.5000000000000009, -1.9000000000000012, -5.399999999999993, -1.8000000000000012, -2.600000000000002, -1.9000000000000012, -2.0000000000000013, -1.8000000000000012, -1.4000000000000008, -2.3000000000000016, -1.600000000000001, -2.0000000000000013, -1.9000000000000012, -1.700000000000001, -1.600000000000001, -2.1000000000000014, -1.5000000000000009, -1.8000000000000012, -2.3000000000000016, -1.5000000000000009, -1.700000000000001, -1.600000000000001, -2.5000000000000018, -1.600000000000001, -2.3000000000000016, -2.0000000000000013, -1.600000000000001, -1.5000000000000009, -1.700000000000001, -1.4000000000000008, -1.9000000000000012, -1.600000000000001, -2.0000000000000013, -2.2000000000000015, -2.2000000000000015, -1.8000000000000012, -2.0000000000000013, -1.5000000000000009, -1.5000000000000009, -1.9000000000000012, -1.5000000000000009, -1.9000000000000012, -2.0000000000000013, -1.600000000000001, -2.1000000000000014, -1.5000000000000009, -2.3000000000000016, -1.600000000000001, -1.9000000000000012, -2.2000000000000015, -2.1000000000000014, -1.600000000000001, -1.700000000000001, -1.5000000000000009, -1.700000000000001, -1.5000000000000009, -1.700000000000001, -1.8000000000000012, -2.4000000000000017, -1.5000000000000009, -1.4000000000000008, -2.0000000000000013, -2.0000000000000013, -1.8000000000000012, -1.8000000000000012, -1.4000000000000008, -1.9000000000000012, -1.9000000000000012, -2.1000000000000014, -2.2000000000000015, -2.0000000000000013, -1.8000000000000012, -1.8000000000000012, -1.9000000000000012, -3.1000000000000014, -1.700000000000001, -1.5000000000000009, -2.9000000000000017, -1.600000000000001, -1.700000000000001, -1.700000000000001, -3.0000000000000018, -2.1000000000000014, -2.3000000000000016, -2.0000000000000013, -2.0000000000000013, -1.600000000000001, -1.700000000000001, -2.0000000000000013, -1.600000000000001, -1.4000000000000008, -2.0000000000000013, -2.1000000000000014, -2.2000000000000015, -1.4000000000000008, -2.0000000000000013, -1.5000000000000009, -2.3000000000000016, -1.4000000000000008, -2.4000000000000017, -2.600000000000002, -1.4000000000000008, -1.5000000000000009, -2.0000000000000013, -1.5000000000000009, -1.9000000000000012, -1.9000000000000012, -3.3000000000000007, -1.5000000000000009, -1.5000000000000009, -2.2000000000000015, -1.9000000000000012, -1.700000000000001, -1.9000000000000012, -1.5000000000000009, -1.8000000000000012, -1.600000000000001, -2.0000000000000013], "episode_lengths": [30, 26, 29, 36, 25, 26, 49, 32, 25, 28, 25, 28, 30, 32, 33, 34, 32, 26, 30, 62, 29, 36, 30, 31, 29, 25, 34, 27, 31, 28, 28, 27, 32, 26, 28, 34, 26, 28, 27, 36, 27, 34, 31, 27, 26, 28, 25, 30, 27, 31, 33, 33, 29, 31, 26, 26, 30, 26, 30, 31, 27, 32, 26, 34, 27, 30, 33, 32, 27, 28, 26, 28, 26, 28, 29, 35, 26, 25, 31, 31, 29, 29, 25, 30, 30, 32, 33, 31, 29, 29, 30, 39, 28, 26, 32, 27, 28, 28, 41, 32, 34, 31, 31, 27, 28, 29, 27, 25, 31, 32, 33, 25, 31, 26, 31, 25, 35, 37, 25, 26, 31, 26, 30, 30, 41, 26, 26, 33, 30, 28, 30, 26, 29, 27, 31]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.27908440432025144, "mean_inference_ms": 0.6278212526677712, "mean_action_processing_ms": 0.0678433887343609, "mean_env_wait_ms": 6.531194052881405, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005662882769549334, "StateBufferConnector_ms": 0.003224655433937355, "ViewRequirementAgentConnector_ms": 0.07496392285382306}}, "episode_reward_max": -1.4000000000000008, "episode_reward_min": -5.399999999999993, "episode_reward_mean": -1.9066666666666683, "episode_len_mean": 29.874074074074073, "episodes_this_iter": 135, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1.9000000000000012, -1.5000000000000009, -1.8000000000000012, -2.5000000000000018, -1.4000000000000008, -1.5000000000000009, -3.799999999999999, -2.1000000000000014, -1.4000000000000008, -1.700000000000001, -1.4000000000000008, -1.700000000000001, -1.9000000000000012, -2.1000000000000014, -2.2000000000000015, -2.3000000000000016, -2.1000000000000014, -1.5000000000000009, -1.9000000000000012, -5.399999999999993, -1.8000000000000012, -2.600000000000002, -1.9000000000000012, -2.0000000000000013, -1.8000000000000012, -1.4000000000000008, -2.3000000000000016, -1.600000000000001, -2.0000000000000013, -1.9000000000000012, -1.700000000000001, -1.600000000000001, -2.1000000000000014, -1.5000000000000009, -1.8000000000000012, -2.3000000000000016, -1.5000000000000009, -1.700000000000001, -1.600000000000001, -2.5000000000000018, -1.600000000000001, -2.3000000000000016, -2.0000000000000013, -1.600000000000001, -1.5000000000000009, -1.700000000000001, -1.4000000000000008, -1.9000000000000012, -1.600000000000001, -2.0000000000000013, -2.2000000000000015, -2.2000000000000015, -1.8000000000000012, -2.0000000000000013, -1.5000000000000009, -1.5000000000000009, -1.9000000000000012, -1.5000000000000009, -1.9000000000000012, -2.0000000000000013, -1.600000000000001, -2.1000000000000014, -1.5000000000000009, -2.3000000000000016, -1.600000000000001, -1.9000000000000012, -2.2000000000000015, -2.1000000000000014, -1.600000000000001, -1.700000000000001, -1.5000000000000009, -1.700000000000001, -1.5000000000000009, -1.700000000000001, -1.8000000000000012, -2.4000000000000017, -1.5000000000000009, -1.4000000000000008, -2.0000000000000013, -2.0000000000000013, -1.8000000000000012, -1.8000000000000012, -1.4000000000000008, -1.9000000000000012, -1.9000000000000012, -2.1000000000000014, -2.2000000000000015, -2.0000000000000013, -1.8000000000000012, -1.8000000000000012, -1.9000000000000012, -3.1000000000000014, -1.700000000000001, -1.5000000000000009, -2.9000000000000017, -1.600000000000001, -1.700000000000001, -1.700000000000001, -3.0000000000000018, -2.1000000000000014, -2.3000000000000016, -2.0000000000000013, -2.0000000000000013, -1.600000000000001, -1.700000000000001, -2.0000000000000013, -1.600000000000001, -1.4000000000000008, -2.0000000000000013, -2.1000000000000014, -2.2000000000000015, -1.4000000000000008, -2.0000000000000013, -1.5000000000000009, -2.3000000000000016, -1.4000000000000008, -2.4000000000000017, -2.600000000000002, -1.4000000000000008, -1.5000000000000009, -2.0000000000000013, -1.5000000000000009, -1.9000000000000012, -1.9000000000000012, -3.3000000000000007, -1.5000000000000009, -1.5000000000000009, -2.2000000000000015, -1.9000000000000012, -1.700000000000001, -1.9000000000000012, -1.5000000000000009, -1.8000000000000012, -1.600000000000001, -2.0000000000000013], "episode_lengths": [30, 26, 29, 36, 25, 26, 49, 32, 25, 28, 25, 28, 30, 32, 33, 34, 32, 26, 30, 62, 29, 36, 30, 31, 29, 25, 34, 27, 31, 28, 28, 27, 32, 26, 28, 34, 26, 28, 27, 36, 27, 34, 31, 27, 26, 28, 25, 30, 27, 31, 33, 33, 29, 31, 26, 26, 30, 26, 30, 31, 27, 32, 26, 34, 27, 30, 33, 32, 27, 28, 26, 28, 26, 28, 29, 35, 26, 25, 31, 31, 29, 29, 25, 30, 30, 32, 33, 31, 29, 29, 30, 39, 28, 26, 32, 27, 28, 28, 41, 32, 34, 31, 31, 27, 28, 29, 27, 25, 31, 32, 33, 25, 31, 26, 31, 25, 35, 37, 25, 26, 31, 26, 30, 30, 41, 26, 26, 33, 30, 28, 30, 26, 29, 27, 31]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.27908440432025144, "mean_inference_ms": 0.6278212526677712, "mean_action_processing_ms": 0.0678433887343609, "mean_env_wait_ms": 6.531194052881405, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005662882769549334, "StateBufferConnector_ms": 0.003224655433937355, "ViewRequirementAgentConnector_ms": 0.07496392285382306}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 164000, "num_agent_steps_trained": 164000, "num_env_steps_sampled": 164000, "num_env_steps_trained": 164000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 330.04256327698283, "num_env_steps_trained_throughput_per_sec": 330.04256327698283, "timesteps_total": 164000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 164000, "timers": {"training_iteration_time_ms": 11948.736, "sample_time_ms": 8476.624, "load_time_ms": 0.986, "load_throughput": 4055602.398, "learn_time_ms": 3468.8, "learn_throughput": 1153.136, "synch_weights_time_ms": 1.7}, "counters": {"num_env_steps_sampled": 164000, "num_env_steps_trained": 164000, "num_agent_steps_sampled": 164000, "num_agent_steps_trained": 164000}, "done": false, "episodes_total": 2565, "training_iteration": 41, "trial_id": "83204_00000", "date": "2024-03-07_12-10-25", "timestamp": 1709831425, "time_this_iter_s": 12.12249207496643, "time_total_s": 455.4955551624298, "pid": 102666, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fcd19c36f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 455.4955551624298, "iterations_since_restore": 41, "perf": {"cpu_util_percent": 20.175, "ram_util_percent": 44.1, "gpu_util_percent0": 0.07875, "vram_util_percent0": 0.098876953125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 0.029999164439066844, "policy_loss": -0.0068609157236673496, "vf_loss": 0.035389094435239354, "vf_explained_var": 0.960202214217955, "kl": 0.007354932554777002, "entropy": 0.2810739178971578, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 38595.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 168000, "num_env_steps_trained": 168000, "num_agent_steps_sampled": 168000, "num_agent_steps_trained": 168000}, "sampler_results": {"episode_reward_max": -1.4000000000000008, "episode_reward_min": -3.0000000000000018, "episode_reward_mean": -1.844117647058825, "episode_len_mean": 29.36764705882353, "episode_media": {}, "episodes_this_iter": 136, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1.700000000000001, -1.600000000000001, -1.5000000000000009, -2.1000000000000014, -1.4000000000000008, -1.9000000000000012, -1.5000000000000009, -1.4000000000000008, -2.1000000000000014, -2.2000000000000015, -1.700000000000001, -1.4000000000000008, -3.0000000000000018, -2.0000000000000013, -1.4000000000000008, -2.2000000000000015, -2.0000000000000013, -2.0000000000000013, -2.0000000000000013, -2.3000000000000016, -1.9000000000000012, -1.4000000000000008, -1.5000000000000009, -2.2000000000000015, -2.4000000000000017, -1.9000000000000012, -2.2000000000000015, -1.700000000000001, -1.9000000000000012, -1.5000000000000009, -1.700000000000001, -2.3000000000000016, -1.5000000000000009, -2.2000000000000015, -2.0000000000000013, -2.0000000000000013, -1.5000000000000009, -1.8000000000000012, -1.600000000000001, -1.8000000000000012, -1.9000000000000012, -1.9000000000000012, -1.700000000000001, -1.5000000000000009, -1.9000000000000012, -2.3000000000000016, -2.3000000000000016, -2.3000000000000016, -1.9000000000000012, -1.8000000000000012, -1.9000000000000012, -1.700000000000001, -1.700000000000001, -1.700000000000001, -1.700000000000001, -1.4000000000000008, -1.600000000000001, -1.600000000000001, -1.8000000000000012, -2.2000000000000015, -1.9000000000000012, -1.5000000000000009, -2.0000000000000013, -1.700000000000001, -2.2000000000000015, -1.9000000000000012, -1.600000000000001, -2.2000000000000015, -1.8000000000000012, -1.8000000000000012, -1.600000000000001, -1.600000000000001, -1.600000000000001, -1.8000000000000012, -1.600000000000001, -2.3000000000000016, -1.600000000000001, -1.700000000000001, -1.700000000000001, -1.600000000000001, -1.700000000000001, -1.600000000000001, -1.8000000000000012, -1.5000000000000009, -1.5000000000000009, -1.9000000000000012, -1.9000000000000012, -2.1000000000000014, -2.700000000000002, -1.8000000000000012, -1.5000000000000009, -1.700000000000001, -1.5000000000000009, -2.2000000000000015, -1.5000000000000009, -2.2000000000000015, -2.600000000000002, -2.3000000000000016, -1.9000000000000012, -1.700000000000001, -2.1000000000000014, -3.0000000000000018, -1.9000000000000012, -2.0000000000000013, -3.0000000000000018, -1.4000000000000008, -1.600000000000001, -1.4000000000000008, -1.600000000000001, -2.3000000000000016, -1.9000000000000012, -1.600000000000001, -1.600000000000001, -1.5000000000000009, -1.4000000000000008, -1.4000000000000008, -2.1000000000000014, -2.2000000000000015, -1.700000000000001, -2.0000000000000013, -1.9000000000000012, -1.5000000000000009, -1.9000000000000012, -2.2000000000000015, -1.9000000000000012, -2.2000000000000015, -1.700000000000001, -1.600000000000001, -1.5000000000000009, -1.9000000000000012, -2.3000000000000016, -1.5000000000000009, -1.5000000000000009, -1.8000000000000012, -1.600000000000001, -1.600000000000001], "episode_lengths": [28, 27, 26, 32, 25, 30, 26, 25, 32, 33, 28, 25, 35, 31, 25, 30, 31, 31, 31, 34, 30, 25, 26, 33, 35, 30, 33, 28, 30, 26, 28, 34, 26, 33, 31, 31, 26, 29, 27, 29, 30, 30, 28, 26, 29, 34, 34, 34, 30, 29, 30, 28, 28, 28, 28, 25, 27, 27, 29, 33, 30, 26, 31, 28, 33, 30, 27, 33, 29, 29, 27, 27, 27, 29, 27, 34, 27, 28, 28, 27, 28, 27, 29, 26, 26, 30, 30, 32, 38, 29, 26, 28, 26, 33, 26, 33, 37, 34, 30, 28, 32, 41, 30, 31, 41, 25, 27, 25, 27, 34, 30, 27, 27, 26, 25, 25, 32, 33, 28, 31, 30, 26, 30, 33, 30, 33, 28, 27, 26, 30, 34, 26, 26, 29, 27, 27]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.28195863184351366, "mean_inference_ms": 0.6281002663801984, "mean_action_processing_ms": 0.06789085550031895, "mean_env_wait_ms": 6.553745312916773, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005601083531099207, "StateBufferConnector_ms": 0.0032452976002412684, "ViewRequirementAgentConnector_ms": 0.07565775338341207}}, "episode_reward_max": -1.4000000000000008, "episode_reward_min": -3.0000000000000018, "episode_reward_mean": -1.844117647058825, "episode_len_mean": 29.36764705882353, "episodes_this_iter": 136, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1.700000000000001, -1.600000000000001, -1.5000000000000009, -2.1000000000000014, -1.4000000000000008, -1.9000000000000012, -1.5000000000000009, -1.4000000000000008, -2.1000000000000014, -2.2000000000000015, -1.700000000000001, -1.4000000000000008, -3.0000000000000018, -2.0000000000000013, -1.4000000000000008, -2.2000000000000015, -2.0000000000000013, -2.0000000000000013, -2.0000000000000013, -2.3000000000000016, -1.9000000000000012, -1.4000000000000008, -1.5000000000000009, -2.2000000000000015, -2.4000000000000017, -1.9000000000000012, -2.2000000000000015, -1.700000000000001, -1.9000000000000012, -1.5000000000000009, -1.700000000000001, -2.3000000000000016, -1.5000000000000009, -2.2000000000000015, -2.0000000000000013, -2.0000000000000013, -1.5000000000000009, -1.8000000000000012, -1.600000000000001, -1.8000000000000012, -1.9000000000000012, -1.9000000000000012, -1.700000000000001, -1.5000000000000009, -1.9000000000000012, -2.3000000000000016, -2.3000000000000016, -2.3000000000000016, -1.9000000000000012, -1.8000000000000012, -1.9000000000000012, -1.700000000000001, -1.700000000000001, -1.700000000000001, -1.700000000000001, -1.4000000000000008, -1.600000000000001, -1.600000000000001, -1.8000000000000012, -2.2000000000000015, -1.9000000000000012, -1.5000000000000009, -2.0000000000000013, -1.700000000000001, -2.2000000000000015, -1.9000000000000012, -1.600000000000001, -2.2000000000000015, -1.8000000000000012, -1.8000000000000012, -1.600000000000001, -1.600000000000001, -1.600000000000001, -1.8000000000000012, -1.600000000000001, -2.3000000000000016, -1.600000000000001, -1.700000000000001, -1.700000000000001, -1.600000000000001, -1.700000000000001, -1.600000000000001, -1.8000000000000012, -1.5000000000000009, -1.5000000000000009, -1.9000000000000012, -1.9000000000000012, -2.1000000000000014, -2.700000000000002, -1.8000000000000012, -1.5000000000000009, -1.700000000000001, -1.5000000000000009, -2.2000000000000015, -1.5000000000000009, -2.2000000000000015, -2.600000000000002, -2.3000000000000016, -1.9000000000000012, -1.700000000000001, -2.1000000000000014, -3.0000000000000018, -1.9000000000000012, -2.0000000000000013, -3.0000000000000018, -1.4000000000000008, -1.600000000000001, -1.4000000000000008, -1.600000000000001, -2.3000000000000016, -1.9000000000000012, -1.600000000000001, -1.600000000000001, -1.5000000000000009, -1.4000000000000008, -1.4000000000000008, -2.1000000000000014, -2.2000000000000015, -1.700000000000001, -2.0000000000000013, -1.9000000000000012, -1.5000000000000009, -1.9000000000000012, -2.2000000000000015, -1.9000000000000012, -2.2000000000000015, -1.700000000000001, -1.600000000000001, -1.5000000000000009, -1.9000000000000012, -2.3000000000000016, -1.5000000000000009, -1.5000000000000009, -1.8000000000000012, -1.600000000000001, -1.600000000000001], "episode_lengths": [28, 27, 26, 32, 25, 30, 26, 25, 32, 33, 28, 25, 35, 31, 25, 30, 31, 31, 31, 34, 30, 25, 26, 33, 35, 30, 33, 28, 30, 26, 28, 34, 26, 33, 31, 31, 26, 29, 27, 29, 30, 30, 28, 26, 29, 34, 34, 34, 30, 29, 30, 28, 28, 28, 28, 25, 27, 27, 29, 33, 30, 26, 31, 28, 33, 30, 27, 33, 29, 29, 27, 27, 27, 29, 27, 34, 27, 28, 28, 27, 28, 27, 29, 26, 26, 30, 30, 32, 38, 29, 26, 28, 26, 33, 26, 33, 37, 34, 30, 28, 32, 41, 30, 31, 41, 25, 27, 25, 27, 34, 30, 27, 27, 26, 25, 25, 32, 33, 28, 31, 30, 26, 30, 33, 30, 33, 28, 27, 26, 30, 34, 26, 26, 29, 27, 27]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.28195863184351366, "mean_inference_ms": 0.6281002663801984, "mean_action_processing_ms": 0.06789085550031895, "mean_env_wait_ms": 6.553745312916773, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005601083531099207, "StateBufferConnector_ms": 0.0032452976002412684, "ViewRequirementAgentConnector_ms": 0.07565775338341207}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 168000, "num_agent_steps_trained": 168000, "num_env_steps_sampled": 168000, "num_env_steps_trained": 168000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 329.4754675513261, "num_env_steps_trained_throughput_per_sec": 329.4754675513261, "timesteps_total": 168000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 168000, "timers": {"training_iteration_time_ms": 12010.322, "sample_time_ms": 8526.177, "load_time_ms": 0.982, "load_throughput": 4074612.265, "learn_time_ms": 3480.84, "learn_throughput": 1149.148, "synch_weights_time_ms": 1.703}, "counters": {"num_env_steps_sampled": 168000, "num_env_steps_trained": 168000, "num_agent_steps_sampled": 168000, "num_agent_steps_trained": 168000}, "done": false, "episodes_total": 2701, "training_iteration": 42, "trial_id": "83204_00000", "date": "2024-03-07_12-10-38", "timestamp": 1709831438, "time_this_iter_s": 12.143200635910034, "time_total_s": 467.63875579833984, "pid": 102666, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fcd19c36f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 467.63875579833984, "iterations_since_restore": 42, "perf": {"cpu_util_percent": 20.92666666666667, "ram_util_percent": 44.10000000000001, "gpu_util_percent0": 0.07133333333333332, "vram_util_percent0": 0.098876953125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 0.02260115412614679, "policy_loss": -0.004737726891393302, "vf_loss": 0.026175529858778402, "vf_explained_var": 0.9748014549414317, "kl": 0.005816758064509369, "entropy": 0.24976777794861024, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 39525.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 172000, "num_env_steps_trained": 172000, "num_agent_steps_sampled": 172000, "num_agent_steps_trained": 172000}, "sampler_results": {"episode_reward_max": -1.4000000000000008, "episode_reward_min": -3.799999999999999, "episode_reward_mean": -1.8308823529411777, "episode_len_mean": 29.308823529411764, "episode_media": {}, "episodes_this_iter": 136, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1.9000000000000012, -1.700000000000001, -1.700000000000001, -2.1000000000000014, -1.600000000000001, -1.600000000000001, -1.8000000000000012, -1.5000000000000009, -1.5000000000000009, -1.700000000000001, -1.4000000000000008, -1.600000000000001, -1.8000000000000012, -1.700000000000001, -1.600000000000001, -1.8000000000000012, -2.0000000000000013, -1.4000000000000008, -1.8000000000000012, -1.8000000000000012, -2.700000000000002, -2.3000000000000016, -1.8000000000000012, -2.2000000000000015, -1.5000000000000009, -2.0000000000000013, -2.2000000000000015, -2.0000000000000013, -1.4000000000000008, -1.700000000000001, -2.3000000000000016, -2.600000000000002, -1.700000000000001, -1.5000000000000009, -2.1000000000000014, -2.1000000000000014, -2.2000000000000015, -2.0000000000000013, -1.9000000000000012, -1.5000000000000009, -1.8000000000000012, -1.600000000000001, -1.600000000000001, -1.9000000000000012, -1.9000000000000012, -2.1000000000000014, -1.600000000000001, -2.700000000000002, -1.5000000000000009, -1.700000000000001, -1.600000000000001, -2.0000000000000013, -2.1000000000000014, -1.8000000000000012, -1.8000000000000012, -1.5000000000000009, -2.1000000000000014, -2.1000000000000014, -2.1000000000000014, -1.600000000000001, -1.700000000000001, -1.5000000000000009, -1.8000000000000012, -1.700000000000001, -1.600000000000001, -2.5000000000000018, -1.9000000000000012, -1.4000000000000008, -2.1000000000000014, -1.600000000000001, -1.700000000000001, -2.5000000000000018, -2.1000000000000014, -1.5000000000000009, -1.5000000000000009, -2.2000000000000015, -1.8000000000000012, -1.600000000000001, -1.9000000000000012, -1.5000000000000009, -2.0000000000000013, -1.8000000000000012, -1.600000000000001, -1.9000000000000012, -1.700000000000001, -2.3000000000000016, -2.3000000000000016, -1.5000000000000009, -1.700000000000001, -2.1000000000000014, -1.700000000000001, -2.0000000000000013, -2.1000000000000014, -1.5000000000000009, -1.5000000000000009, -2.4000000000000017, -1.9000000000000012, -1.9000000000000012, -2.0000000000000013, -1.5000000000000009, -1.9000000000000012, -2.2000000000000015, -1.700000000000001, -2.0000000000000013, -1.5000000000000009, -1.700000000000001, -2.1000000000000014, -1.700000000000001, -1.9000000000000012, -1.9000000000000012, -1.8000000000000012, -1.5000000000000009, -1.700000000000001, -1.4000000000000008, -1.4000000000000008, -1.600000000000001, -1.8000000000000012, -1.9000000000000012, -1.5000000000000009, -1.600000000000001, -1.600000000000001, -1.600000000000001, -1.700000000000001, -2.2000000000000015, -1.700000000000001, -1.4000000000000008, -1.8000000000000012, -1.600000000000001, -1.5000000000000009, -1.9000000000000012, -1.8000000000000012, -1.700000000000001, -3.799999999999999, -2.0000000000000013, -2.2000000000000015, -1.4000000000000008], "episode_lengths": [30, 28, 28, 32, 27, 27, 29, 26, 26, 28, 25, 27, 29, 28, 27, 29, 31, 25, 29, 29, 38, 34, 29, 33, 26, 31, 33, 31, 25, 28, 34, 37, 28, 26, 32, 32, 33, 31, 30, 26, 29, 27, 27, 30, 30, 32, 27, 38, 26, 28, 27, 31, 32, 29, 29, 26, 32, 32, 32, 27, 28, 26, 29, 28, 27, 36, 30, 25, 32, 27, 28, 36, 32, 26, 26, 33, 29, 27, 30, 26, 31, 29, 27, 30, 28, 34, 34, 26, 28, 32, 28, 31, 32, 26, 26, 35, 30, 30, 31, 26, 30, 33, 28, 31, 26, 28, 32, 28, 30, 30, 29, 26, 28, 25, 25, 27, 29, 30, 26, 27, 27, 27, 28, 33, 28, 25, 29, 27, 26, 30, 29, 28, 49, 31, 33, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2847500324561064, "mean_inference_ms": 0.6285508720090636, "mean_action_processing_ms": 0.06792047112005586, "mean_env_wait_ms": 6.574932828145205, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005871758741490981, "StateBufferConnector_ms": 0.0032465247546925266, "ViewRequirementAgentConnector_ms": 0.07729232311248779}}, "episode_reward_max": -1.4000000000000008, "episode_reward_min": -3.799999999999999, "episode_reward_mean": -1.8308823529411777, "episode_len_mean": 29.308823529411764, "episodes_this_iter": 136, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1.9000000000000012, -1.700000000000001, -1.700000000000001, -2.1000000000000014, -1.600000000000001, -1.600000000000001, -1.8000000000000012, -1.5000000000000009, -1.5000000000000009, -1.700000000000001, -1.4000000000000008, -1.600000000000001, -1.8000000000000012, -1.700000000000001, -1.600000000000001, -1.8000000000000012, -2.0000000000000013, -1.4000000000000008, -1.8000000000000012, -1.8000000000000012, -2.700000000000002, -2.3000000000000016, -1.8000000000000012, -2.2000000000000015, -1.5000000000000009, -2.0000000000000013, -2.2000000000000015, -2.0000000000000013, -1.4000000000000008, -1.700000000000001, -2.3000000000000016, -2.600000000000002, -1.700000000000001, -1.5000000000000009, -2.1000000000000014, -2.1000000000000014, -2.2000000000000015, -2.0000000000000013, -1.9000000000000012, -1.5000000000000009, -1.8000000000000012, -1.600000000000001, -1.600000000000001, -1.9000000000000012, -1.9000000000000012, -2.1000000000000014, -1.600000000000001, -2.700000000000002, -1.5000000000000009, -1.700000000000001, -1.600000000000001, -2.0000000000000013, -2.1000000000000014, -1.8000000000000012, -1.8000000000000012, -1.5000000000000009, -2.1000000000000014, -2.1000000000000014, -2.1000000000000014, -1.600000000000001, -1.700000000000001, -1.5000000000000009, -1.8000000000000012, -1.700000000000001, -1.600000000000001, -2.5000000000000018, -1.9000000000000012, -1.4000000000000008, -2.1000000000000014, -1.600000000000001, -1.700000000000001, -2.5000000000000018, -2.1000000000000014, -1.5000000000000009, -1.5000000000000009, -2.2000000000000015, -1.8000000000000012, -1.600000000000001, -1.9000000000000012, -1.5000000000000009, -2.0000000000000013, -1.8000000000000012, -1.600000000000001, -1.9000000000000012, -1.700000000000001, -2.3000000000000016, -2.3000000000000016, -1.5000000000000009, -1.700000000000001, -2.1000000000000014, -1.700000000000001, -2.0000000000000013, -2.1000000000000014, -1.5000000000000009, -1.5000000000000009, -2.4000000000000017, -1.9000000000000012, -1.9000000000000012, -2.0000000000000013, -1.5000000000000009, -1.9000000000000012, -2.2000000000000015, -1.700000000000001, -2.0000000000000013, -1.5000000000000009, -1.700000000000001, -2.1000000000000014, -1.700000000000001, -1.9000000000000012, -1.9000000000000012, -1.8000000000000012, -1.5000000000000009, -1.700000000000001, -1.4000000000000008, -1.4000000000000008, -1.600000000000001, -1.8000000000000012, -1.9000000000000012, -1.5000000000000009, -1.600000000000001, -1.600000000000001, -1.600000000000001, -1.700000000000001, -2.2000000000000015, -1.700000000000001, -1.4000000000000008, -1.8000000000000012, -1.600000000000001, -1.5000000000000009, -1.9000000000000012, -1.8000000000000012, -1.700000000000001, -3.799999999999999, -2.0000000000000013, -2.2000000000000015, -1.4000000000000008], "episode_lengths": [30, 28, 28, 32, 27, 27, 29, 26, 26, 28, 25, 27, 29, 28, 27, 29, 31, 25, 29, 29, 38, 34, 29, 33, 26, 31, 33, 31, 25, 28, 34, 37, 28, 26, 32, 32, 33, 31, 30, 26, 29, 27, 27, 30, 30, 32, 27, 38, 26, 28, 27, 31, 32, 29, 29, 26, 32, 32, 32, 27, 28, 26, 29, 28, 27, 36, 30, 25, 32, 27, 28, 36, 32, 26, 26, 33, 29, 27, 30, 26, 31, 29, 27, 30, 28, 34, 34, 26, 28, 32, 28, 31, 32, 26, 26, 35, 30, 30, 31, 26, 30, 33, 28, 31, 26, 28, 32, 28, 30, 30, 29, 26, 28, 25, 25, 27, 29, 30, 26, 27, 27, 27, 28, 33, 28, 25, 29, 27, 26, 30, 29, 28, 49, 31, 33, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2847500324561064, "mean_inference_ms": 0.6285508720090636, "mean_action_processing_ms": 0.06792047112005586, "mean_env_wait_ms": 6.574932828145205, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005871758741490981, "StateBufferConnector_ms": 0.0032465247546925266, "ViewRequirementAgentConnector_ms": 0.07729232311248779}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 172000, "num_agent_steps_trained": 172000, "num_env_steps_sampled": 172000, "num_env_steps_trained": 172000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 326.9123370435467, "num_env_steps_trained_throughput_per_sec": 326.9123370435467, "timesteps_total": 172000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 172000, "timers": {"training_iteration_time_ms": 12045.559, "sample_time_ms": 8559.909, "load_time_ms": 0.982, "load_throughput": 4071250.455, "learn_time_ms": 3482.373, "learn_throughput": 1148.642, "synch_weights_time_ms": 1.677}, "counters": {"num_env_steps_sampled": 172000, "num_env_steps_trained": 172000, "num_agent_steps_sampled": 172000, "num_agent_steps_trained": 172000}, "done": false, "episodes_total": 2837, "training_iteration": 43, "trial_id": "83204_00000", "date": "2024-03-07_12-10-50", "timestamp": 1709831450, "time_this_iter_s": 12.238327980041504, "time_total_s": 479.87708377838135, "pid": 102666, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fcd19c36f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 479.87708377838135, "iterations_since_restore": 43, "perf": {"cpu_util_percent": 20.96875, "ram_util_percent": 44.13125, "gpu_util_percent0": 0.06999999999999999, "vram_util_percent0": 0.098876953125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 0.10489865987541615, "policy_loss": -0.00538760089585858, "vf_loss": 0.10858272331246045, "vf_explained_var": 0.9267008388555178, "kl": 0.008517680132330674, "entropy": 0.25211687188956045, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 40455.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 176000, "num_env_steps_trained": 176000, "num_agent_steps_sampled": 176000, "num_agent_steps_trained": 176000}, "sampler_results": {"episode_reward_max": -1.4000000000000008, "episode_reward_min": -4.4999999999999964, "episode_reward_mean": -1.814598540145986, "episode_len_mean": 29.116788321167885, "episode_media": {}, "episodes_this_iter": 137, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1.8000000000000012, -2.0000000000000013, -1.8000000000000012, -1.4000000000000008, -1.700000000000001, -1.4000000000000008, -2.0000000000000013, -1.5000000000000009, -1.9000000000000012, -1.8000000000000012, -1.4000000000000008, -1.700000000000001, -2.1000000000000014, -1.4000000000000008, -1.700000000000001, -1.8000000000000012, -1.8000000000000012, -1.700000000000001, -1.5000000000000009, -1.9000000000000012, -1.600000000000001, -1.5000000000000009, -1.9000000000000012, -1.700000000000001, -1.9000000000000012, -1.600000000000001, -2.0000000000000013, -2.3000000000000016, -1.700000000000001, -2.2000000000000015, -2.0000000000000013, -1.8000000000000012, -1.600000000000001, -4.4999999999999964, -1.5000000000000009, -1.5000000000000009, -1.600000000000001, -1.9000000000000012, -1.600000000000001, -1.5000000000000009, -1.8000000000000012, -1.600000000000001, -1.9000000000000012, -1.5000000000000009, -2.2000000000000015, -1.4000000000000008, -2.0000000000000013, -1.5000000000000009, -2.2000000000000015, -1.4000000000000008, -1.700000000000001, -1.5000000000000009, -4.299999999999997, -1.8000000000000012, -1.8000000000000012, -1.5000000000000009, -1.600000000000001, -1.4000000000000008, -1.9000000000000012, -1.700000000000001, -1.8000000000000012, -1.9000000000000012, -1.4000000000000008, -1.600000000000001, -1.700000000000001, -2.1000000000000014, -2.0000000000000013, -1.700000000000001, -1.8000000000000012, -2.3000000000000016, -1.700000000000001, -1.5000000000000009, -2.5000000000000018, -1.5000000000000009, -1.700000000000001, -1.600000000000001, -1.600000000000001, -1.700000000000001, -1.600000000000001, -1.5000000000000009, -2.3000000000000016, -1.5000000000000009, -1.700000000000001, -1.5000000000000009, -1.600000000000001, -1.5000000000000009, -1.5000000000000009, -1.4000000000000008, -2.1000000000000014, -2.3000000000000016, -2.0000000000000013, -4.099999999999998, -1.700000000000001, -1.8000000000000012, -1.600000000000001, -1.600000000000001, -1.600000000000001, -2.600000000000002, -1.5000000000000009, -1.8000000000000012, -1.9000000000000012, -1.4000000000000008, -1.5000000000000009, -1.600000000000001, -2.4000000000000017, -1.5000000000000009, -1.8000000000000012, -1.9000000000000012, -1.8000000000000012, -1.700000000000001, -1.600000000000001, -2.0000000000000013, -2.4000000000000017, -2.1000000000000014, -2.2000000000000015, -2.0000000000000013, -1.5000000000000009, -1.5000000000000009, -2.0000000000000013, -1.600000000000001, -1.600000000000001, -1.700000000000001, -1.600000000000001, -1.600000000000001, -1.9000000000000012, -1.700000000000001, -1.600000000000001, -1.8000000000000012, -2.0000000000000013, -1.700000000000001, -1.8000000000000012, -2.5000000000000018, -1.9000000000000012, -1.5000000000000009, -1.9000000000000012, -1.9000000000000012, -1.700000000000001], "episode_lengths": [29, 31, 29, 25, 28, 25, 31, 26, 30, 29, 25, 28, 32, 25, 28, 29, 29, 28, 26, 30, 27, 26, 30, 28, 30, 27, 31, 34, 28, 33, 31, 29, 27, 56, 26, 26, 27, 30, 27, 26, 29, 27, 30, 26, 33, 25, 31, 26, 33, 25, 28, 26, 50, 29, 29, 26, 27, 25, 30, 28, 29, 30, 25, 27, 28, 32, 31, 28, 29, 34, 28, 26, 36, 26, 28, 27, 27, 28, 27, 26, 34, 26, 28, 26, 27, 26, 26, 25, 32, 34, 31, 52, 28, 29, 27, 27, 27, 37, 26, 29, 30, 25, 26, 27, 35, 26, 29, 30, 29, 28, 27, 31, 35, 32, 33, 31, 26, 26, 31, 27, 27, 28, 27, 27, 30, 28, 27, 29, 31, 28, 29, 36, 30, 26, 30, 30, 28]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2873263318586257, "mean_inference_ms": 0.6287661375404343, "mean_action_processing_ms": 0.06793950622197444, "mean_env_wait_ms": 6.593218286630285, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005840036990868784, "StateBufferConnector_ms": 0.00323779391546319, "ViewRequirementAgentConnector_ms": 0.07613488357432567}}, "episode_reward_max": -1.4000000000000008, "episode_reward_min": -4.4999999999999964, "episode_reward_mean": -1.814598540145986, "episode_len_mean": 29.116788321167885, "episodes_this_iter": 137, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1.8000000000000012, -2.0000000000000013, -1.8000000000000012, -1.4000000000000008, -1.700000000000001, -1.4000000000000008, -2.0000000000000013, -1.5000000000000009, -1.9000000000000012, -1.8000000000000012, -1.4000000000000008, -1.700000000000001, -2.1000000000000014, -1.4000000000000008, -1.700000000000001, -1.8000000000000012, -1.8000000000000012, -1.700000000000001, -1.5000000000000009, -1.9000000000000012, -1.600000000000001, -1.5000000000000009, -1.9000000000000012, -1.700000000000001, -1.9000000000000012, -1.600000000000001, -2.0000000000000013, -2.3000000000000016, -1.700000000000001, -2.2000000000000015, -2.0000000000000013, -1.8000000000000012, -1.600000000000001, -4.4999999999999964, -1.5000000000000009, -1.5000000000000009, -1.600000000000001, -1.9000000000000012, -1.600000000000001, -1.5000000000000009, -1.8000000000000012, -1.600000000000001, -1.9000000000000012, -1.5000000000000009, -2.2000000000000015, -1.4000000000000008, -2.0000000000000013, -1.5000000000000009, -2.2000000000000015, -1.4000000000000008, -1.700000000000001, -1.5000000000000009, -4.299999999999997, -1.8000000000000012, -1.8000000000000012, -1.5000000000000009, -1.600000000000001, -1.4000000000000008, -1.9000000000000012, -1.700000000000001, -1.8000000000000012, -1.9000000000000012, -1.4000000000000008, -1.600000000000001, -1.700000000000001, -2.1000000000000014, -2.0000000000000013, -1.700000000000001, -1.8000000000000012, -2.3000000000000016, -1.700000000000001, -1.5000000000000009, -2.5000000000000018, -1.5000000000000009, -1.700000000000001, -1.600000000000001, -1.600000000000001, -1.700000000000001, -1.600000000000001, -1.5000000000000009, -2.3000000000000016, -1.5000000000000009, -1.700000000000001, -1.5000000000000009, -1.600000000000001, -1.5000000000000009, -1.5000000000000009, -1.4000000000000008, -2.1000000000000014, -2.3000000000000016, -2.0000000000000013, -4.099999999999998, -1.700000000000001, -1.8000000000000012, -1.600000000000001, -1.600000000000001, -1.600000000000001, -2.600000000000002, -1.5000000000000009, -1.8000000000000012, -1.9000000000000012, -1.4000000000000008, -1.5000000000000009, -1.600000000000001, -2.4000000000000017, -1.5000000000000009, -1.8000000000000012, -1.9000000000000012, -1.8000000000000012, -1.700000000000001, -1.600000000000001, -2.0000000000000013, -2.4000000000000017, -2.1000000000000014, -2.2000000000000015, -2.0000000000000013, -1.5000000000000009, -1.5000000000000009, -2.0000000000000013, -1.600000000000001, -1.600000000000001, -1.700000000000001, -1.600000000000001, -1.600000000000001, -1.9000000000000012, -1.700000000000001, -1.600000000000001, -1.8000000000000012, -2.0000000000000013, -1.700000000000001, -1.8000000000000012, -2.5000000000000018, -1.9000000000000012, -1.5000000000000009, -1.9000000000000012, -1.9000000000000012, -1.700000000000001], "episode_lengths": [29, 31, 29, 25, 28, 25, 31, 26, 30, 29, 25, 28, 32, 25, 28, 29, 29, 28, 26, 30, 27, 26, 30, 28, 30, 27, 31, 34, 28, 33, 31, 29, 27, 56, 26, 26, 27, 30, 27, 26, 29, 27, 30, 26, 33, 25, 31, 26, 33, 25, 28, 26, 50, 29, 29, 26, 27, 25, 30, 28, 29, 30, 25, 27, 28, 32, 31, 28, 29, 34, 28, 26, 36, 26, 28, 27, 27, 28, 27, 26, 34, 26, 28, 26, 27, 26, 26, 25, 32, 34, 31, 52, 28, 29, 27, 27, 27, 37, 26, 29, 30, 25, 26, 27, 35, 26, 29, 30, 29, 28, 27, 31, 35, 32, 33, 31, 26, 26, 31, 27, 27, 28, 27, 27, 30, 28, 27, 29, 31, 28, 29, 36, 30, 26, 30, 30, 28]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2873263318586257, "mean_inference_ms": 0.6287661375404343, "mean_action_processing_ms": 0.06793950622197444, "mean_env_wait_ms": 6.593218286630285, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005840036990868784, "StateBufferConnector_ms": 0.00323779391546319, "ViewRequirementAgentConnector_ms": 0.07613488357432567}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 176000, "num_agent_steps_trained": 176000, "num_env_steps_sampled": 176000, "num_env_steps_trained": 176000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 331.0410298339364, "num_env_steps_trained_throughput_per_sec": 331.0410298339364, "timesteps_total": 176000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 176000, "timers": {"training_iteration_time_ms": 12074.733, "sample_time_ms": 8589.492, "load_time_ms": 0.976, "load_throughput": 4099903.717, "learn_time_ms": 3481.982, "learn_throughput": 1148.771, "synch_weights_time_ms": 1.673}, "counters": {"num_env_steps_sampled": 176000, "num_env_steps_trained": 176000, "num_agent_steps_sampled": 176000, "num_agent_steps_trained": 176000}, "done": false, "episodes_total": 2974, "training_iteration": 44, "trial_id": "83204_00000", "date": "2024-03-07_12-11-02", "timestamp": 1709831462, "time_this_iter_s": 12.08572244644165, "time_total_s": 491.962806224823, "pid": 102666, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fcd19c36f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 491.962806224823, "iterations_since_restore": 44, "perf": {"cpu_util_percent": 20.18125, "ram_util_percent": 44.1125, "gpu_util_percent0": 0.07375, "vram_util_percent0": 0.0986328125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 0.05913364525323594, "policy_loss": -0.008910101948566335, "vf_loss": 0.06721825222509803, "vf_explained_var": 0.9554552615329783, "kl": 0.004127478531458829, "entropy": 0.212447649649074, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 41385.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 180000, "num_env_steps_trained": 180000, "num_agent_steps_sampled": 180000, "num_agent_steps_trained": 180000}, "sampler_results": {"episode_reward_max": -1.4000000000000008, "episode_reward_min": -4.4999999999999964, "episode_reward_mean": -1.7507142857142868, "episode_len_mean": 28.47142857142857, "episode_media": {}, "episodes_this_iter": 140, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1.5000000000000009, -1.5000000000000009, -1.4000000000000008, -1.4000000000000008, -1.700000000000001, -1.8000000000000012, -1.4000000000000008, -1.600000000000001, -1.5000000000000009, -1.700000000000001, -1.9000000000000012, -2.1000000000000014, -1.600000000000001, -1.8000000000000012, -1.8000000000000012, -1.600000000000001, -2.1000000000000014, -2.1000000000000014, -1.5000000000000009, -1.8000000000000012, -1.700000000000001, -1.5000000000000009, -1.700000000000001, -1.4000000000000008, -2.0000000000000013, -2.0000000000000013, -1.8000000000000012, -1.4000000000000008, -1.9000000000000012, -1.700000000000001, -1.4000000000000008, -1.5000000000000009, -1.9000000000000012, -1.600000000000001, -1.8000000000000012, -1.9000000000000012, -1.9000000000000012, -1.600000000000001, -1.600000000000001, -1.5000000000000009, -1.5000000000000009, -1.5000000000000009, -1.9000000000000012, -1.4000000000000008, -2.600000000000002, -1.8000000000000012, -1.8000000000000012, -1.8000000000000012, -2.3000000000000016, -1.5000000000000009, -1.4000000000000008, -2.0000000000000013, -1.9000000000000012, -2.5000000000000018, -1.4000000000000008, -1.700000000000001, -2.2000000000000015, -2.3000000000000016, -1.600000000000001, -1.9000000000000012, -1.600000000000001, -4.4999999999999964, -2.1000000000000014, -1.5000000000000009, -1.600000000000001, -1.9000000000000012, -2.0000000000000013, -1.700000000000001, -1.4000000000000008, -1.600000000000001, -2.0000000000000013, -1.4000000000000008, -2.1000000000000014, -1.5000000000000009, -2.0000000000000013, -1.4000000000000008, -1.4000000000000008, -1.600000000000001, -1.8000000000000012, -1.600000000000001, -2.0000000000000013, -2.1000000000000014, -2.0000000000000013, -2.0000000000000013, -1.700000000000001, -1.5000000000000009, -1.5000000000000009, -1.700000000000001, -1.600000000000001, -1.600000000000001, -1.600000000000001, -1.600000000000001, -2.1000000000000014, -1.8000000000000012, -1.700000000000001, -1.5000000000000009, -1.700000000000001, -2.1000000000000014, -1.700000000000001, -1.4000000000000008, -1.8000000000000012, -1.9000000000000012, -1.5000000000000009, -1.5000000000000009, -1.700000000000001, -1.700000000000001, -1.5000000000000009, -1.5000000000000009, -1.4000000000000008, -1.700000000000001, -2.0000000000000013, -1.5000000000000009, -1.4000000000000008, -2.2000000000000015, -1.4000000000000008, -1.9000000000000012, -1.700000000000001, -1.600000000000001, -1.8000000000000012, -2.0000000000000013, -1.5000000000000009, -1.9000000000000012, -1.600000000000001, -2.3000000000000016, -1.700000000000001, -2.2000000000000015, -1.8000000000000012, -1.5000000000000009, -1.4000000000000008, -1.600000000000001, -1.700000000000001, -1.9000000000000012, -2.0000000000000013, -1.8000000000000012, -2.0000000000000013, -1.700000000000001, -1.700000000000001, -1.5000000000000009, -1.700000000000001, -1.700000000000001], "episode_lengths": [26, 26, 25, 25, 28, 29, 25, 27, 26, 28, 30, 32, 27, 29, 29, 27, 32, 32, 26, 29, 28, 26, 28, 25, 31, 31, 29, 25, 30, 28, 25, 26, 30, 27, 29, 30, 30, 27, 27, 26, 26, 26, 30, 25, 37, 29, 29, 29, 34, 26, 25, 31, 30, 36, 25, 28, 33, 34, 27, 30, 27, 51, 32, 26, 27, 30, 31, 28, 25, 27, 31, 25, 32, 26, 31, 25, 25, 27, 29, 27, 31, 32, 31, 31, 28, 26, 26, 28, 27, 27, 27, 27, 32, 29, 28, 26, 28, 32, 28, 25, 29, 30, 26, 26, 28, 28, 26, 26, 25, 28, 31, 26, 25, 33, 25, 30, 28, 27, 29, 31, 26, 30, 27, 34, 28, 33, 29, 26, 25, 27, 28, 30, 31, 29, 31, 28, 28, 26, 28, 28]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2900061833906437, "mean_inference_ms": 0.629079482892854, "mean_action_processing_ms": 0.06797652452751861, "mean_env_wait_ms": 6.613833563592699, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005815880639212472, "StateBufferConnector_ms": 0.0032848971230643137, "ViewRequirementAgentConnector_ms": 0.07699693952287946}}, "episode_reward_max": -1.4000000000000008, "episode_reward_min": -4.4999999999999964, "episode_reward_mean": -1.7507142857142868, "episode_len_mean": 28.47142857142857, "episodes_this_iter": 140, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1.5000000000000009, -1.5000000000000009, -1.4000000000000008, -1.4000000000000008, -1.700000000000001, -1.8000000000000012, -1.4000000000000008, -1.600000000000001, -1.5000000000000009, -1.700000000000001, -1.9000000000000012, -2.1000000000000014, -1.600000000000001, -1.8000000000000012, -1.8000000000000012, -1.600000000000001, -2.1000000000000014, -2.1000000000000014, -1.5000000000000009, -1.8000000000000012, -1.700000000000001, -1.5000000000000009, -1.700000000000001, -1.4000000000000008, -2.0000000000000013, -2.0000000000000013, -1.8000000000000012, -1.4000000000000008, -1.9000000000000012, -1.700000000000001, -1.4000000000000008, -1.5000000000000009, -1.9000000000000012, -1.600000000000001, -1.8000000000000012, -1.9000000000000012, -1.9000000000000012, -1.600000000000001, -1.600000000000001, -1.5000000000000009, -1.5000000000000009, -1.5000000000000009, -1.9000000000000012, -1.4000000000000008, -2.600000000000002, -1.8000000000000012, -1.8000000000000012, -1.8000000000000012, -2.3000000000000016, -1.5000000000000009, -1.4000000000000008, -2.0000000000000013, -1.9000000000000012, -2.5000000000000018, -1.4000000000000008, -1.700000000000001, -2.2000000000000015, -2.3000000000000016, -1.600000000000001, -1.9000000000000012, -1.600000000000001, -4.4999999999999964, -2.1000000000000014, -1.5000000000000009, -1.600000000000001, -1.9000000000000012, -2.0000000000000013, -1.700000000000001, -1.4000000000000008, -1.600000000000001, -2.0000000000000013, -1.4000000000000008, -2.1000000000000014, -1.5000000000000009, -2.0000000000000013, -1.4000000000000008, -1.4000000000000008, -1.600000000000001, -1.8000000000000012, -1.600000000000001, -2.0000000000000013, -2.1000000000000014, -2.0000000000000013, -2.0000000000000013, -1.700000000000001, -1.5000000000000009, -1.5000000000000009, -1.700000000000001, -1.600000000000001, -1.600000000000001, -1.600000000000001, -1.600000000000001, -2.1000000000000014, -1.8000000000000012, -1.700000000000001, -1.5000000000000009, -1.700000000000001, -2.1000000000000014, -1.700000000000001, -1.4000000000000008, -1.8000000000000012, -1.9000000000000012, -1.5000000000000009, -1.5000000000000009, -1.700000000000001, -1.700000000000001, -1.5000000000000009, -1.5000000000000009, -1.4000000000000008, -1.700000000000001, -2.0000000000000013, -1.5000000000000009, -1.4000000000000008, -2.2000000000000015, -1.4000000000000008, -1.9000000000000012, -1.700000000000001, -1.600000000000001, -1.8000000000000012, -2.0000000000000013, -1.5000000000000009, -1.9000000000000012, -1.600000000000001, -2.3000000000000016, -1.700000000000001, -2.2000000000000015, -1.8000000000000012, -1.5000000000000009, -1.4000000000000008, -1.600000000000001, -1.700000000000001, -1.9000000000000012, -2.0000000000000013, -1.8000000000000012, -2.0000000000000013, -1.700000000000001, -1.700000000000001, -1.5000000000000009, -1.700000000000001, -1.700000000000001], "episode_lengths": [26, 26, 25, 25, 28, 29, 25, 27, 26, 28, 30, 32, 27, 29, 29, 27, 32, 32, 26, 29, 28, 26, 28, 25, 31, 31, 29, 25, 30, 28, 25, 26, 30, 27, 29, 30, 30, 27, 27, 26, 26, 26, 30, 25, 37, 29, 29, 29, 34, 26, 25, 31, 30, 36, 25, 28, 33, 34, 27, 30, 27, 51, 32, 26, 27, 30, 31, 28, 25, 27, 31, 25, 32, 26, 31, 25, 25, 27, 29, 27, 31, 32, 31, 31, 28, 26, 26, 28, 27, 27, 27, 27, 32, 29, 28, 26, 28, 32, 28, 25, 29, 30, 26, 26, 28, 28, 26, 26, 25, 28, 31, 26, 25, 33, 25, 30, 28, 27, 29, 31, 26, 30, 27, 34, 28, 33, 29, 26, 25, 27, 28, 30, 31, 29, 31, 28, 28, 26, 28, 28]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2900061833906437, "mean_inference_ms": 0.629079482892854, "mean_action_processing_ms": 0.06797652452751861, "mean_env_wait_ms": 6.613833563592699, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005815880639212472, "StateBufferConnector_ms": 0.0032848971230643137, "ViewRequirementAgentConnector_ms": 0.07699693952287946}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 180000, "num_agent_steps_trained": 180000, "num_env_steps_sampled": 180000, "num_env_steps_trained": 180000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 324.21077375034605, "num_env_steps_trained_throughput_per_sec": 324.21077375034605, "timesteps_total": 180000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 180000, "timers": {"training_iteration_time_ms": 12122.052, "sample_time_ms": 8631.939, "load_time_ms": 1.014, "load_throughput": 3943590.25, "learn_time_ms": 3486.813, "learn_throughput": 1147.179, "synch_weights_time_ms": 1.674}, "counters": {"num_env_steps_sampled": 180000, "num_env_steps_trained": 180000, "num_agent_steps_sampled": 180000, "num_agent_steps_trained": 180000}, "done": false, "episodes_total": 3114, "training_iteration": 45, "trial_id": "83204_00000", "date": "2024-03-07_12-11-14", "timestamp": 1709831474, "time_this_iter_s": 12.340323448181152, "time_total_s": 504.30312967300415, "pid": 102666, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fcd19c36f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 504.30312967300415, "iterations_since_restore": 45, "perf": {"cpu_util_percent": 20.1875, "ram_util_percent": 44.2, "gpu_util_percent0": 0.06937499999999999, "vram_util_percent0": 0.096923828125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.10000000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 0.0925793944602652, "policy_loss": -0.006646965604315522, "vf_loss": 0.09789357777504672, "vf_explained_var": 0.9299371894328825, "kl": 0.013327836940593692, "entropy": 0.22715120918007306, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 42315.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 184000, "num_env_steps_trained": 184000, "num_agent_steps_sampled": 184000, "num_agent_steps_trained": 184000}, "sampler_results": {"episode_reward_max": -1.4000000000000008, "episode_reward_min": -5.0000000000000036, "episode_reward_mean": -1.8294964028776988, "episode_len_mean": 29.071942446043167, "episode_media": {}, "episodes_this_iter": 139, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2.0000000000000013, -1.700000000000001, -1.600000000000001, -1.4000000000000008, -1.5000000000000009, -1.700000000000001, -1.5000000000000009, -1.5000000000000009, -1.700000000000001, -2.2000000000000015, -1.8000000000000012, -1.4000000000000008, -1.9000000000000012, -2.0000000000000013, -1.600000000000001, -1.700000000000001, -1.600000000000001, -1.600000000000001, -1.5000000000000009, -1.4000000000000008, -1.9000000000000012, -1.600000000000001, -1.5000000000000009, -2.0000000000000013, -1.4000000000000008, -1.4000000000000008, -2.0000000000000013, -1.8000000000000012, -1.5000000000000009, -1.8000000000000012, -1.5000000000000009, -2.1000000000000014, -1.4000000000000008, -1.9000000000000012, -1.700000000000001, -3.1000000000000014, -2.0000000000000013, -1.5000000000000009, -1.4000000000000008, -2.1000000000000014, -2.1000000000000014, -1.700000000000001, -1.700000000000001, -2.4000000000000017, -1.8000000000000012, -1.9000000000000012, -1.9000000000000012, -1.9000000000000012, -1.9000000000000012, -2.3000000000000016, -1.700000000000001, -1.5000000000000009, -1.4000000000000008, -1.8000000000000012, -1.5000000000000009, -1.8000000000000012, -1.700000000000001, -1.600000000000001, -1.600000000000001, -1.5000000000000009, -2.0000000000000013, -1.5000000000000009, -1.700000000000001, -1.8000000000000012, -1.600000000000001, -1.8000000000000012, -2.0000000000000013, -1.8000000000000012, -3.3000000000000007, -1.600000000000001, -1.8000000000000012, -2.1000000000000014, -1.9000000000000012, -2.0000000000000013, -1.8000000000000012, -2.4000000000000017, -1.700000000000001, -1.700000000000001, -1.8000000000000012, -1.8000000000000012, -1.8000000000000012, -1.700000000000001, -2.1000000000000014, -5.0000000000000036, -1.8000000000000012, -1.5000000000000009, -2.1000000000000014, -1.8000000000000012, -1.8000000000000012, -1.600000000000001, -2.2000000000000015, -1.600000000000001, -1.4000000000000008, -1.600000000000001, -1.9000000000000012, -1.600000000000001, -1.4000000000000008, -2.0000000000000013, -1.600000000000001, -1.700000000000001, -1.9000000000000012, -1.9000000000000012, -1.8000000000000012, -2.1000000000000014, -2.4000000000000017, -2.4000000000000017, -2.1000000000000014, -1.700000000000001, -1.8000000000000012, -1.9000000000000012, -1.600000000000001, -1.4000000000000008, -1.9000000000000012, -2.3000000000000016, -1.8000000000000012, -1.9000000000000012, -2.4000000000000017, -2.1000000000000014, -1.700000000000001, -1.4000000000000008, -1.700000000000001, -1.700000000000001, -1.700000000000001, -1.4000000000000008, -1.9000000000000012, -1.4000000000000008, -1.600000000000001, -1.700000000000001, -1.8000000000000012, -3.200000000000001, -1.5000000000000009, -2.1000000000000014, -1.8000000000000012, -1.5000000000000009, -1.8000000000000012, -2.5000000000000018, -1.700000000000001, -1.700000000000001, -2.2000000000000015], "episode_lengths": [31, 28, 27, 25, 26, 28, 26, 26, 28, 33, 29, 25, 30, 31, 27, 28, 27, 27, 26, 25, 30, 27, 26, 31, 25, 25, 31, 29, 26, 29, 26, 32, 25, 30, 28, 32, 31, 26, 25, 32, 32, 28, 28, 35, 29, 30, 30, 30, 30, 34, 28, 26, 25, 29, 26, 29, 28, 27, 27, 26, 31, 26, 28, 29, 27, 29, 31, 29, 39, 27, 29, 32, 30, 31, 29, 35, 28, 28, 29, 29, 29, 28, 32, 50, 29, 26, 32, 29, 29, 27, 33, 27, 25, 27, 30, 27, 25, 31, 27, 28, 30, 30, 29, 32, 35, 35, 32, 28, 29, 30, 27, 25, 30, 34, 29, 30, 35, 32, 28, 25, 28, 28, 28, 25, 30, 25, 27, 28, 29, 38, 26, 32, 29, 26, 29, 36, 28, 28, 33]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.29246254413703615, "mean_inference_ms": 0.6293278650175143, "mean_action_processing_ms": 0.06800418079817233, "mean_env_wait_ms": 6.631081524577072, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005811409984561179, "StateBufferConnector_ms": 0.003287260480921903, "ViewRequirementAgentConnector_ms": 0.07616873267743228}}, "episode_reward_max": -1.4000000000000008, "episode_reward_min": -5.0000000000000036, "episode_reward_mean": -1.8294964028776988, "episode_len_mean": 29.071942446043167, "episodes_this_iter": 139, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-2.0000000000000013, -1.700000000000001, -1.600000000000001, -1.4000000000000008, -1.5000000000000009, -1.700000000000001, -1.5000000000000009, -1.5000000000000009, -1.700000000000001, -2.2000000000000015, -1.8000000000000012, -1.4000000000000008, -1.9000000000000012, -2.0000000000000013, -1.600000000000001, -1.700000000000001, -1.600000000000001, -1.600000000000001, -1.5000000000000009, -1.4000000000000008, -1.9000000000000012, -1.600000000000001, -1.5000000000000009, -2.0000000000000013, -1.4000000000000008, -1.4000000000000008, -2.0000000000000013, -1.8000000000000012, -1.5000000000000009, -1.8000000000000012, -1.5000000000000009, -2.1000000000000014, -1.4000000000000008, -1.9000000000000012, -1.700000000000001, -3.1000000000000014, -2.0000000000000013, -1.5000000000000009, -1.4000000000000008, -2.1000000000000014, -2.1000000000000014, -1.700000000000001, -1.700000000000001, -2.4000000000000017, -1.8000000000000012, -1.9000000000000012, -1.9000000000000012, -1.9000000000000012, -1.9000000000000012, -2.3000000000000016, -1.700000000000001, -1.5000000000000009, -1.4000000000000008, -1.8000000000000012, -1.5000000000000009, -1.8000000000000012, -1.700000000000001, -1.600000000000001, -1.600000000000001, -1.5000000000000009, -2.0000000000000013, -1.5000000000000009, -1.700000000000001, -1.8000000000000012, -1.600000000000001, -1.8000000000000012, -2.0000000000000013, -1.8000000000000012, -3.3000000000000007, -1.600000000000001, -1.8000000000000012, -2.1000000000000014, -1.9000000000000012, -2.0000000000000013, -1.8000000000000012, -2.4000000000000017, -1.700000000000001, -1.700000000000001, -1.8000000000000012, -1.8000000000000012, -1.8000000000000012, -1.700000000000001, -2.1000000000000014, -5.0000000000000036, -1.8000000000000012, -1.5000000000000009, -2.1000000000000014, -1.8000000000000012, -1.8000000000000012, -1.600000000000001, -2.2000000000000015, -1.600000000000001, -1.4000000000000008, -1.600000000000001, -1.9000000000000012, -1.600000000000001, -1.4000000000000008, -2.0000000000000013, -1.600000000000001, -1.700000000000001, -1.9000000000000012, -1.9000000000000012, -1.8000000000000012, -2.1000000000000014, -2.4000000000000017, -2.4000000000000017, -2.1000000000000014, -1.700000000000001, -1.8000000000000012, -1.9000000000000012, -1.600000000000001, -1.4000000000000008, -1.9000000000000012, -2.3000000000000016, -1.8000000000000012, -1.9000000000000012, -2.4000000000000017, -2.1000000000000014, -1.700000000000001, -1.4000000000000008, -1.700000000000001, -1.700000000000001, -1.700000000000001, -1.4000000000000008, -1.9000000000000012, -1.4000000000000008, -1.600000000000001, -1.700000000000001, -1.8000000000000012, -3.200000000000001, -1.5000000000000009, -2.1000000000000014, -1.8000000000000012, -1.5000000000000009, -1.8000000000000012, -2.5000000000000018, -1.700000000000001, -1.700000000000001, -2.2000000000000015], "episode_lengths": [31, 28, 27, 25, 26, 28, 26, 26, 28, 33, 29, 25, 30, 31, 27, 28, 27, 27, 26, 25, 30, 27, 26, 31, 25, 25, 31, 29, 26, 29, 26, 32, 25, 30, 28, 32, 31, 26, 25, 32, 32, 28, 28, 35, 29, 30, 30, 30, 30, 34, 28, 26, 25, 29, 26, 29, 28, 27, 27, 26, 31, 26, 28, 29, 27, 29, 31, 29, 39, 27, 29, 32, 30, 31, 29, 35, 28, 28, 29, 29, 29, 28, 32, 50, 29, 26, 32, 29, 29, 27, 33, 27, 25, 27, 30, 27, 25, 31, 27, 28, 30, 30, 29, 32, 35, 35, 32, 28, 29, 30, 27, 25, 30, 34, 29, 30, 35, 32, 28, 25, 28, 28, 28, 25, 30, 25, 27, 28, 29, 38, 26, 32, 29, 26, 29, 36, 28, 28, 33]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.29246254413703615, "mean_inference_ms": 0.6293278650175143, "mean_action_processing_ms": 0.06800418079817233, "mean_env_wait_ms": 6.631081524577072, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005811409984561179, "StateBufferConnector_ms": 0.003287260480921903, "ViewRequirementAgentConnector_ms": 0.07616873267743228}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 184000, "num_agent_steps_trained": 184000, "num_env_steps_sampled": 184000, "num_env_steps_trained": 184000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 328.0443663099156, "num_env_steps_trained_throughput_per_sec": 328.0443663099156, "timesteps_total": 184000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 184000, "timers": {"training_iteration_time_ms": 12136.63, "sample_time_ms": 8657.537, "load_time_ms": 1.048, "load_throughput": 3815778.748, "learn_time_ms": 3475.727, "learn_throughput": 1150.838, "synch_weights_time_ms": 1.689}, "counters": {"num_env_steps_sampled": 184000, "num_env_steps_trained": 184000, "num_agent_steps_sampled": 184000, "num_agent_steps_trained": 184000}, "done": false, "episodes_total": 3253, "training_iteration": 46, "trial_id": "83204_00000", "date": "2024-03-07_12-11-26", "timestamp": 1709831486, "time_this_iter_s": 12.196581840515137, "time_total_s": 516.4997115135193, "pid": 102666, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fcd19c36f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 516.4997115135193, "iterations_since_restore": 46, "perf": {"cpu_util_percent": 20.2125, "ram_util_percent": 44.206250000000004, "gpu_util_percent0": 0.06687499999999999, "vram_util_percent0": 0.096923828125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.10000000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 0.002228465450267928, "policy_loss": -0.01472393148829059, "vf_loss": 0.016238052129585255, "vf_explained_var": 0.979255743501007, "kl": 0.007143436683289046, "entropy": 0.1984438190296773, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 43245.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 188000, "num_env_steps_trained": 188000, "num_agent_steps_sampled": 188000, "num_agent_steps_trained": 188000}, "sampler_results": {"episode_reward_max": -1.4000000000000008, "episode_reward_min": -2.700000000000002, "episode_reward_mean": -1.7392857142857154, "episode_len_mean": 28.392857142857142, "episode_media": {}, "episodes_this_iter": 140, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1.4000000000000008, -2.4000000000000017, -1.8000000000000012, -2.5000000000000018, -2.4000000000000017, -1.600000000000001, -1.600000000000001, -1.600000000000001, -1.4000000000000008, -1.4000000000000008, -2.0000000000000013, -1.4000000000000008, -1.4000000000000008, -1.700000000000001, -2.2000000000000015, -1.8000000000000012, -2.2000000000000015, -1.4000000000000008, -1.9000000000000012, -1.700000000000001, -1.600000000000001, -2.0000000000000013, -2.0000000000000013, -1.4000000000000008, -1.5000000000000009, -1.600000000000001, -1.5000000000000009, -1.700000000000001, -1.700000000000001, -1.5000000000000009, -1.8000000000000012, -1.700000000000001, -2.0000000000000013, -1.5000000000000009, -1.9000000000000012, -2.3000000000000016, -1.4000000000000008, -1.700000000000001, -2.1000000000000014, -1.9000000000000012, -1.8000000000000012, -1.8000000000000012, -1.700000000000001, -1.5000000000000009, -2.0000000000000013, -1.700000000000001, -1.5000000000000009, -1.600000000000001, -1.700000000000001, -1.700000000000001, -1.8000000000000012, -1.8000000000000012, -1.8000000000000012, -2.0000000000000013, -1.8000000000000012, -1.9000000000000012, -1.700000000000001, -1.5000000000000009, -1.5000000000000009, -1.4000000000000008, -1.5000000000000009, -1.8000000000000012, -1.600000000000001, -1.4000000000000008, -1.8000000000000012, -1.4000000000000008, -1.600000000000001, -2.700000000000002, -1.9000000000000012, -1.8000000000000012, -1.700000000000001, -1.600000000000001, -1.8000000000000012, -1.700000000000001, -1.8000000000000012, -1.600000000000001, -1.5000000000000009, -2.2000000000000015, -1.9000000000000012, -1.8000000000000012, -1.700000000000001, -1.5000000000000009, -2.1000000000000014, -1.700000000000001, -1.5000000000000009, -1.8000000000000012, -1.4000000000000008, -1.700000000000001, -1.5000000000000009, -1.4000000000000008, -2.0000000000000013, -1.4000000000000008, -1.9000000000000012, -2.3000000000000016, -1.5000000000000009, -2.0000000000000013, -1.700000000000001, -1.700000000000001, -1.4000000000000008, -1.9000000000000012, -1.8000000000000012, -1.600000000000001, -1.600000000000001, -1.8000000000000012, -2.0000000000000013, -1.5000000000000009, -1.8000000000000012, -1.700000000000001, -2.5000000000000018, -1.4000000000000008, -1.8000000000000012, -1.9000000000000012, -1.5000000000000009, -1.5000000000000009, -1.700000000000001, -1.5000000000000009, -2.0000000000000013, -1.600000000000001, -1.8000000000000012, -1.5000000000000009, -1.5000000000000009, -1.600000000000001, -2.0000000000000013, -1.8000000000000012, -1.4000000000000008, -1.5000000000000009, -1.5000000000000009, -1.5000000000000009, -2.3000000000000016, -1.600000000000001, -2.0000000000000013, -1.700000000000001, -1.8000000000000012, -2.0000000000000013, -1.8000000000000012, -2.0000000000000013, -1.5000000000000009, -1.8000000000000012, -1.8000000000000012, -1.9000000000000012], "episode_lengths": [25, 35, 29, 36, 35, 27, 27, 27, 25, 25, 31, 25, 25, 28, 33, 29, 33, 25, 30, 28, 27, 31, 31, 25, 26, 27, 26, 28, 28, 26, 29, 28, 31, 26, 30, 34, 25, 28, 32, 30, 29, 29, 28, 26, 31, 28, 26, 27, 28, 28, 29, 29, 29, 31, 29, 30, 28, 26, 26, 25, 26, 29, 27, 25, 29, 25, 27, 38, 30, 29, 28, 27, 29, 28, 29, 27, 26, 33, 30, 29, 28, 26, 32, 28, 26, 29, 25, 28, 26, 25, 31, 25, 30, 34, 26, 31, 28, 28, 25, 30, 29, 27, 27, 29, 31, 26, 29, 28, 36, 25, 29, 30, 26, 26, 28, 26, 31, 27, 29, 26, 26, 27, 31, 29, 25, 26, 26, 26, 34, 27, 31, 28, 29, 31, 29, 31, 26, 29, 29, 30]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2948706617903393, "mean_inference_ms": 0.629569502049909, "mean_action_processing_ms": 0.06800006824372558, "mean_env_wait_ms": 6.64915148977173, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005835975919451032, "StateBufferConnector_ms": 0.0032641206468854633, "ViewRequirementAgentConnector_ms": 0.07644925798688616}}, "episode_reward_max": -1.4000000000000008, "episode_reward_min": -2.700000000000002, "episode_reward_mean": -1.7392857142857154, "episode_len_mean": 28.392857142857142, "episodes_this_iter": 140, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1.4000000000000008, -2.4000000000000017, -1.8000000000000012, -2.5000000000000018, -2.4000000000000017, -1.600000000000001, -1.600000000000001, -1.600000000000001, -1.4000000000000008, -1.4000000000000008, -2.0000000000000013, -1.4000000000000008, -1.4000000000000008, -1.700000000000001, -2.2000000000000015, -1.8000000000000012, -2.2000000000000015, -1.4000000000000008, -1.9000000000000012, -1.700000000000001, -1.600000000000001, -2.0000000000000013, -2.0000000000000013, -1.4000000000000008, -1.5000000000000009, -1.600000000000001, -1.5000000000000009, -1.700000000000001, -1.700000000000001, -1.5000000000000009, -1.8000000000000012, -1.700000000000001, -2.0000000000000013, -1.5000000000000009, -1.9000000000000012, -2.3000000000000016, -1.4000000000000008, -1.700000000000001, -2.1000000000000014, -1.9000000000000012, -1.8000000000000012, -1.8000000000000012, -1.700000000000001, -1.5000000000000009, -2.0000000000000013, -1.700000000000001, -1.5000000000000009, -1.600000000000001, -1.700000000000001, -1.700000000000001, -1.8000000000000012, -1.8000000000000012, -1.8000000000000012, -2.0000000000000013, -1.8000000000000012, -1.9000000000000012, -1.700000000000001, -1.5000000000000009, -1.5000000000000009, -1.4000000000000008, -1.5000000000000009, -1.8000000000000012, -1.600000000000001, -1.4000000000000008, -1.8000000000000012, -1.4000000000000008, -1.600000000000001, -2.700000000000002, -1.9000000000000012, -1.8000000000000012, -1.700000000000001, -1.600000000000001, -1.8000000000000012, -1.700000000000001, -1.8000000000000012, -1.600000000000001, -1.5000000000000009, -2.2000000000000015, -1.9000000000000012, -1.8000000000000012, -1.700000000000001, -1.5000000000000009, -2.1000000000000014, -1.700000000000001, -1.5000000000000009, -1.8000000000000012, -1.4000000000000008, -1.700000000000001, -1.5000000000000009, -1.4000000000000008, -2.0000000000000013, -1.4000000000000008, -1.9000000000000012, -2.3000000000000016, -1.5000000000000009, -2.0000000000000013, -1.700000000000001, -1.700000000000001, -1.4000000000000008, -1.9000000000000012, -1.8000000000000012, -1.600000000000001, -1.600000000000001, -1.8000000000000012, -2.0000000000000013, -1.5000000000000009, -1.8000000000000012, -1.700000000000001, -2.5000000000000018, -1.4000000000000008, -1.8000000000000012, -1.9000000000000012, -1.5000000000000009, -1.5000000000000009, -1.700000000000001, -1.5000000000000009, -2.0000000000000013, -1.600000000000001, -1.8000000000000012, -1.5000000000000009, -1.5000000000000009, -1.600000000000001, -2.0000000000000013, -1.8000000000000012, -1.4000000000000008, -1.5000000000000009, -1.5000000000000009, -1.5000000000000009, -2.3000000000000016, -1.600000000000001, -2.0000000000000013, -1.700000000000001, -1.8000000000000012, -2.0000000000000013, -1.8000000000000012, -2.0000000000000013, -1.5000000000000009, -1.8000000000000012, -1.8000000000000012, -1.9000000000000012], "episode_lengths": [25, 35, 29, 36, 35, 27, 27, 27, 25, 25, 31, 25, 25, 28, 33, 29, 33, 25, 30, 28, 27, 31, 31, 25, 26, 27, 26, 28, 28, 26, 29, 28, 31, 26, 30, 34, 25, 28, 32, 30, 29, 29, 28, 26, 31, 28, 26, 27, 28, 28, 29, 29, 29, 31, 29, 30, 28, 26, 26, 25, 26, 29, 27, 25, 29, 25, 27, 38, 30, 29, 28, 27, 29, 28, 29, 27, 26, 33, 30, 29, 28, 26, 32, 28, 26, 29, 25, 28, 26, 25, 31, 25, 30, 34, 26, 31, 28, 28, 25, 30, 29, 27, 27, 29, 31, 26, 29, 28, 36, 25, 29, 30, 26, 26, 28, 26, 31, 27, 29, 26, 26, 27, 31, 29, 25, 26, 26, 26, 34, 27, 31, 28, 29, 31, 29, 31, 26, 29, 29, 30]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2948706617903393, "mean_inference_ms": 0.629569502049909, "mean_action_processing_ms": 0.06800006824372558, "mean_env_wait_ms": 6.64915148977173, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005835975919451032, "StateBufferConnector_ms": 0.0032641206468854633, "ViewRequirementAgentConnector_ms": 0.07644925798688616}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 188000, "num_agent_steps_trained": 188000, "num_env_steps_sampled": 188000, "num_env_steps_trained": 188000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 330.2067003955895, "num_env_steps_trained_throughput_per_sec": 330.2067003955895, "timesteps_total": 188000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 188000, "timers": {"training_iteration_time_ms": 12131.163, "sample_time_ms": 8663.437, "load_time_ms": 1.05, "load_throughput": 3808675.596, "learn_time_ms": 3464.352, "learn_throughput": 1154.617, "synch_weights_time_ms": 1.696}, "counters": {"num_env_steps_sampled": 188000, "num_env_steps_trained": 188000, "num_agent_steps_sampled": 188000, "num_agent_steps_trained": 188000}, "done": false, "episodes_total": 3393, "training_iteration": 47, "trial_id": "83204_00000", "date": "2024-03-07_12-11-39", "timestamp": 1709831499, "time_this_iter_s": 12.116827487945557, "time_total_s": 528.6165390014648, "pid": 102666, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fcd19c36f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 528.6165390014648, "iterations_since_restore": 47, "perf": {"cpu_util_percent": 20.48125, "ram_util_percent": 44.23125, "gpu_util_percent0": 0.076875, "vram_util_percent0": 0.096923828125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.10000000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 0.2651374916516004, "policy_loss": -0.005092115469917815, "vf_loss": 0.2679940978776143, "vf_explained_var": 0.8497595925484934, "kl": 0.022355075656870085, "entropy": 0.24601157655318578, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 44175.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 192000, "num_env_steps_trained": 192000, "num_agent_steps_sampled": 192000, "num_agent_steps_trained": 192000}, "sampler_results": {"episode_reward_max": -1.4000000000000008, "episode_reward_min": -9.499999999999979, "episode_reward_mean": -1.8683823529411774, "episode_len_mean": 29.41176470588235, "episode_media": {}, "episodes_this_iter": 136, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-5.1, -1.700000000000001, -1.700000000000001, -1.700000000000001, -2.0000000000000013, -1.600000000000001, -1.700000000000001, -1.4000000000000008, -1.700000000000001, -1.8000000000000012, -1.600000000000001, -1.5000000000000009, -1.4000000000000008, -2.2000000000000015, -2.5000000000000018, -1.600000000000001, -1.600000000000001, -1.5000000000000009, -1.700000000000001, -1.700000000000001, -2.800000000000002, -1.700000000000001, -1.5000000000000009, -1.700000000000001, -1.600000000000001, -1.700000000000001, -1.600000000000001, -1.9000000000000012, -1.600000000000001, -1.700000000000001, -2.2000000000000015, -1.8000000000000012, -1.4000000000000008, -1.700000000000001, -1.700000000000001, -1.700000000000001, -2.3000000000000016, -1.9000000000000012, -1.700000000000001, -1.5000000000000009, -1.5000000000000009, -1.9000000000000012, -1.4000000000000008, -1.5000000000000009, -1.9000000000000012, -1.8000000000000012, -1.9000000000000012, -1.8000000000000012, -1.9000000000000012, -1.600000000000001, -2.0000000000000013, -1.4000000000000008, -1.700000000000001, -1.700000000000001, -1.5000000000000009, -1.700000000000001, -1.5000000000000009, -2.1000000000000014, -1.600000000000001, -1.5000000000000009, -1.4000000000000008, -1.8000000000000012, -1.9000000000000012, -1.9000000000000012, -1.700000000000001, -1.700000000000001, -2.4000000000000017, -1.5000000000000009, -1.8000000000000012, -1.600000000000001, -1.8000000000000012, -9.499999999999979, -1.9000000000000012, -1.8000000000000012, -2.0000000000000013, -1.5000000000000009, -2.1000000000000014, -1.700000000000001, -1.8000000000000012, -2.1000000000000014, -1.8000000000000012, -1.8000000000000012, -1.700000000000001, -1.4000000000000008, -4.3000000000000025, -1.5000000000000009, -1.700000000000001, -1.700000000000001, -2.2000000000000015, -1.8000000000000012, -1.600000000000001, -1.700000000000001, -2.2000000000000015, -1.8000000000000012, -1.8000000000000012, -1.5000000000000009, -1.600000000000001, -1.700000000000001, -1.5000000000000009, -1.700000000000001, -1.5000000000000009, -2.2000000000000015, -1.9000000000000012, -1.700000000000001, -2.3000000000000016, -1.5000000000000009, -1.700000000000001, -1.600000000000001, -1.9000000000000012, -1.5000000000000009, -1.700000000000001, -2.0000000000000013, -2.0000000000000013, -1.700000000000001, -1.600000000000001, -1.8000000000000012, -1.8000000000000012, -1.700000000000001, -1.600000000000001, -2.1000000000000014, -1.8000000000000012, -3.1000000000000014, -1.600000000000001, -1.5000000000000009, -1.700000000000001, -1.9000000000000012, -2.4000000000000017, -2.2000000000000015, -1.700000000000001, -1.4000000000000008, -1.8000000000000012, -1.8000000000000012, -1.600000000000001, -1.700000000000001, -2.1000000000000014, -1.8000000000000012], "episode_lengths": [49, 28, 28, 28, 31, 27, 28, 25, 28, 29, 27, 26, 25, 33, 36, 27, 27, 26, 28, 28, 35, 28, 26, 28, 27, 28, 27, 30, 27, 28, 33, 29, 25, 28, 28, 28, 34, 30, 28, 26, 26, 30, 25, 26, 30, 29, 30, 29, 30, 27, 31, 25, 28, 28, 26, 28, 26, 32, 27, 26, 25, 29, 30, 30, 28, 28, 35, 26, 29, 27, 29, 106, 30, 29, 31, 26, 32, 28, 29, 32, 29, 29, 28, 25, 41, 26, 28, 28, 33, 29, 27, 28, 33, 29, 29, 26, 27, 28, 26, 28, 26, 33, 30, 28, 34, 26, 28, 27, 30, 26, 28, 31, 31, 28, 27, 29, 29, 28, 27, 32, 29, 39, 27, 26, 28, 30, 31, 33, 28, 25, 29, 29, 27, 28, 32, 29]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2971146403019006, "mean_inference_ms": 0.6299238544420808, "mean_action_processing_ms": 0.06802538028531252, "mean_env_wait_ms": 6.665978426002816, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005798129474415499, "StateBufferConnector_ms": 0.003292981316061581, "ViewRequirementAgentConnector_ms": 0.07725708624895881}}, "episode_reward_max": -1.4000000000000008, "episode_reward_min": -9.499999999999979, "episode_reward_mean": -1.8683823529411774, "episode_len_mean": 29.41176470588235, "episodes_this_iter": 136, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-5.1, -1.700000000000001, -1.700000000000001, -1.700000000000001, -2.0000000000000013, -1.600000000000001, -1.700000000000001, -1.4000000000000008, -1.700000000000001, -1.8000000000000012, -1.600000000000001, -1.5000000000000009, -1.4000000000000008, -2.2000000000000015, -2.5000000000000018, -1.600000000000001, -1.600000000000001, -1.5000000000000009, -1.700000000000001, -1.700000000000001, -2.800000000000002, -1.700000000000001, -1.5000000000000009, -1.700000000000001, -1.600000000000001, -1.700000000000001, -1.600000000000001, -1.9000000000000012, -1.600000000000001, -1.700000000000001, -2.2000000000000015, -1.8000000000000012, -1.4000000000000008, -1.700000000000001, -1.700000000000001, -1.700000000000001, -2.3000000000000016, -1.9000000000000012, -1.700000000000001, -1.5000000000000009, -1.5000000000000009, -1.9000000000000012, -1.4000000000000008, -1.5000000000000009, -1.9000000000000012, -1.8000000000000012, -1.9000000000000012, -1.8000000000000012, -1.9000000000000012, -1.600000000000001, -2.0000000000000013, -1.4000000000000008, -1.700000000000001, -1.700000000000001, -1.5000000000000009, -1.700000000000001, -1.5000000000000009, -2.1000000000000014, -1.600000000000001, -1.5000000000000009, -1.4000000000000008, -1.8000000000000012, -1.9000000000000012, -1.9000000000000012, -1.700000000000001, -1.700000000000001, -2.4000000000000017, -1.5000000000000009, -1.8000000000000012, -1.600000000000001, -1.8000000000000012, -9.499999999999979, -1.9000000000000012, -1.8000000000000012, -2.0000000000000013, -1.5000000000000009, -2.1000000000000014, -1.700000000000001, -1.8000000000000012, -2.1000000000000014, -1.8000000000000012, -1.8000000000000012, -1.700000000000001, -1.4000000000000008, -4.3000000000000025, -1.5000000000000009, -1.700000000000001, -1.700000000000001, -2.2000000000000015, -1.8000000000000012, -1.600000000000001, -1.700000000000001, -2.2000000000000015, -1.8000000000000012, -1.8000000000000012, -1.5000000000000009, -1.600000000000001, -1.700000000000001, -1.5000000000000009, -1.700000000000001, -1.5000000000000009, -2.2000000000000015, -1.9000000000000012, -1.700000000000001, -2.3000000000000016, -1.5000000000000009, -1.700000000000001, -1.600000000000001, -1.9000000000000012, -1.5000000000000009, -1.700000000000001, -2.0000000000000013, -2.0000000000000013, -1.700000000000001, -1.600000000000001, -1.8000000000000012, -1.8000000000000012, -1.700000000000001, -1.600000000000001, -2.1000000000000014, -1.8000000000000012, -3.1000000000000014, -1.600000000000001, -1.5000000000000009, -1.700000000000001, -1.9000000000000012, -2.4000000000000017, -2.2000000000000015, -1.700000000000001, -1.4000000000000008, -1.8000000000000012, -1.8000000000000012, -1.600000000000001, -1.700000000000001, -2.1000000000000014, -1.8000000000000012], "episode_lengths": [49, 28, 28, 28, 31, 27, 28, 25, 28, 29, 27, 26, 25, 33, 36, 27, 27, 26, 28, 28, 35, 28, 26, 28, 27, 28, 27, 30, 27, 28, 33, 29, 25, 28, 28, 28, 34, 30, 28, 26, 26, 30, 25, 26, 30, 29, 30, 29, 30, 27, 31, 25, 28, 28, 26, 28, 26, 32, 27, 26, 25, 29, 30, 30, 28, 28, 35, 26, 29, 27, 29, 106, 30, 29, 31, 26, 32, 28, 29, 32, 29, 29, 28, 25, 41, 26, 28, 28, 33, 29, 27, 28, 33, 29, 29, 26, 27, 28, 26, 28, 26, 33, 30, 28, 34, 26, 28, 27, 30, 26, 28, 31, 31, 28, 27, 29, 29, 28, 27, 32, 29, 39, 27, 26, 28, 30, 31, 33, 28, 25, 29, 29, 27, 28, 32, 29]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2971146403019006, "mean_inference_ms": 0.6299238544420808, "mean_action_processing_ms": 0.06802538028531252, "mean_env_wait_ms": 6.665978426002816, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005798129474415499, "StateBufferConnector_ms": 0.003292981316061581, "ViewRequirementAgentConnector_ms": 0.07725708624895881}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 192000, "num_agent_steps_trained": 192000, "num_env_steps_sampled": 192000, "num_env_steps_trained": 192000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 329.6770638875348, "num_env_steps_trained_throughput_per_sec": 329.6770638875348, "timesteps_total": 192000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 192000, "timers": {"training_iteration_time_ms": 12141.553, "sample_time_ms": 8673.145, "load_time_ms": 1.051, "load_throughput": 3805565.486, "learn_time_ms": 3464.91, "learn_throughput": 1154.431, "synch_weights_time_ms": 1.804}, "counters": {"num_env_steps_sampled": 192000, "num_env_steps_trained": 192000, "num_agent_steps_sampled": 192000, "num_agent_steps_trained": 192000}, "done": false, "episodes_total": 3529, "training_iteration": 48, "trial_id": "83204_00000", "date": "2024-03-07_12-11-51", "timestamp": 1709831511, "time_this_iter_s": 12.136131286621094, "time_total_s": 540.7526702880859, "pid": 102666, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fcd19c36f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 540.7526702880859, "iterations_since_restore": 48, "perf": {"cpu_util_percent": 21.01875, "ram_util_percent": 44.2, "gpu_util_percent0": 0.08, "vram_util_percent0": 0.096923828125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.15, "cur_lr": 0.0010000000000000005, "total_loss": 0.08488339226222247, "policy_loss": -0.018182956393287385, "vf_loss": 0.10136034100927332, "vf_explained_var": 0.9449866143606043, "kl": 0.011373375130438228, "entropy": 0.22004405294534982, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 45105.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 196000, "num_env_steps_trained": 196000, "num_agent_steps_sampled": 196000, "num_agent_steps_trained": 196000}, "sampler_results": {"episode_reward_max": -1.4000000000000008, "episode_reward_min": -5.700000000000003, "episode_reward_mean": -1.8014388489208644, "episode_len_mean": 28.87769784172662, "episode_media": {}, "episodes_this_iter": 139, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1.5000000000000009, -1.700000000000001, -2.1000000000000014, -1.5000000000000009, -1.600000000000001, -2.1000000000000014, -1.8000000000000012, -1.700000000000001, -1.5000000000000009, -1.9000000000000012, -1.5000000000000009, -1.700000000000001, -1.600000000000001, -1.5000000000000009, -2.1000000000000014, -1.9000000000000012, -1.9000000000000012, -1.700000000000001, -1.5000000000000009, -1.700000000000001, -1.700000000000001, -1.600000000000001, -2.0000000000000013, -1.9000000000000012, -1.700000000000001, -1.600000000000001, -1.700000000000001, -2.2000000000000015, -1.700000000000001, -1.600000000000001, -2.2000000000000015, -1.600000000000001, -1.5000000000000009, -1.8000000000000012, -2.1000000000000014, -1.5000000000000009, -1.700000000000001, -1.8000000000000012, -1.700000000000001, -2.600000000000002, -1.700000000000001, -1.600000000000001, -1.9000000000000012, -1.4000000000000008, -1.5000000000000009, -1.600000000000001, -1.5000000000000009, -1.5000000000000009, -1.4000000000000008, -1.700000000000001, -2.0000000000000013, -2.0000000000000013, -2.2000000000000015, -1.700000000000001, -2.2000000000000015, -1.4000000000000008, -1.8000000000000012, -1.700000000000001, -1.9000000000000012, -1.600000000000001, -1.600000000000001, -2.5000000000000018, -1.8000000000000012, -1.700000000000001, -2.2000000000000015, -1.8000000000000012, -1.5000000000000009, -1.8000000000000012, -1.600000000000001, -2.1000000000000014, -1.700000000000001, -1.8000000000000012, -1.5000000000000009, -2.0000000000000013, -1.4000000000000008, -2.1000000000000014, -1.5000000000000009, -1.4000000000000008, -2.0000000000000013, -2.2000000000000015, -1.600000000000001, -1.700000000000001, -1.8000000000000012, -2.600000000000002, -1.5000000000000009, -1.5000000000000009, -1.9000000000000012, -1.9000000000000012, -1.5000000000000009, -1.600000000000001, -1.600000000000001, -2.2000000000000015, -1.8000000000000012, -1.600000000000001, -1.8000000000000012, -1.8000000000000012, -1.5000000000000009, -1.600000000000001, -1.5000000000000009, -1.9000000000000012, -1.9000000000000012, -1.5000000000000009, -2.1000000000000014, -2.2000000000000015, -1.8000000000000012, -1.600000000000001, -1.4000000000000008, -2.0000000000000013, -1.9000000000000012, -1.9000000000000012, -2.1000000000000014, -1.600000000000001, -2.0000000000000013, -5.700000000000003, -1.600000000000001, -1.9000000000000012, -1.600000000000001, -1.5000000000000009, -1.600000000000001, -1.5000000000000009, -1.600000000000001, -1.5000000000000009, -1.600000000000001, -1.8000000000000012, -2.1000000000000014, -1.9000000000000012, -1.600000000000001, -1.8000000000000012, -3.0000000000000018, -1.8000000000000012, -1.8000000000000012, -1.700000000000001, -2.2000000000000015, -1.600000000000001, -1.8000000000000012, -1.9000000000000012, -1.600000000000001, -1.9000000000000012, -1.700000000000001], "episode_lengths": [26, 28, 32, 26, 27, 32, 29, 28, 26, 30, 26, 28, 27, 26, 32, 30, 30, 28, 26, 28, 28, 27, 31, 30, 28, 27, 28, 33, 28, 27, 33, 27, 26, 29, 32, 26, 28, 29, 28, 37, 28, 27, 30, 25, 26, 27, 26, 26, 25, 28, 31, 31, 33, 28, 33, 25, 29, 28, 30, 27, 27, 34, 29, 28, 33, 29, 26, 29, 27, 32, 28, 29, 26, 31, 25, 32, 26, 25, 31, 33, 27, 28, 29, 35, 26, 26, 30, 30, 26, 27, 27, 33, 29, 27, 29, 29, 26, 27, 26, 30, 30, 26, 32, 33, 29, 27, 25, 31, 30, 30, 32, 27, 31, 53, 27, 30, 27, 26, 27, 26, 27, 26, 27, 29, 32, 30, 27, 29, 41, 29, 29, 28, 33, 27, 29, 30, 27, 30, 28]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.299254517293602, "mean_inference_ms": 0.6300697157990242, "mean_action_processing_ms": 0.06805682806475682, "mean_env_wait_ms": 6.681193072696058, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005820157716600157, "StateBufferConnector_ms": 0.003250211262874466, "ViewRequirementAgentConnector_ms": 0.07532397620111918}}, "episode_reward_max": -1.4000000000000008, "episode_reward_min": -5.700000000000003, "episode_reward_mean": -1.8014388489208644, "episode_len_mean": 28.87769784172662, "episodes_this_iter": 139, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1.5000000000000009, -1.700000000000001, -2.1000000000000014, -1.5000000000000009, -1.600000000000001, -2.1000000000000014, -1.8000000000000012, -1.700000000000001, -1.5000000000000009, -1.9000000000000012, -1.5000000000000009, -1.700000000000001, -1.600000000000001, -1.5000000000000009, -2.1000000000000014, -1.9000000000000012, -1.9000000000000012, -1.700000000000001, -1.5000000000000009, -1.700000000000001, -1.700000000000001, -1.600000000000001, -2.0000000000000013, -1.9000000000000012, -1.700000000000001, -1.600000000000001, -1.700000000000001, -2.2000000000000015, -1.700000000000001, -1.600000000000001, -2.2000000000000015, -1.600000000000001, -1.5000000000000009, -1.8000000000000012, -2.1000000000000014, -1.5000000000000009, -1.700000000000001, -1.8000000000000012, -1.700000000000001, -2.600000000000002, -1.700000000000001, -1.600000000000001, -1.9000000000000012, -1.4000000000000008, -1.5000000000000009, -1.600000000000001, -1.5000000000000009, -1.5000000000000009, -1.4000000000000008, -1.700000000000001, -2.0000000000000013, -2.0000000000000013, -2.2000000000000015, -1.700000000000001, -2.2000000000000015, -1.4000000000000008, -1.8000000000000012, -1.700000000000001, -1.9000000000000012, -1.600000000000001, -1.600000000000001, -2.5000000000000018, -1.8000000000000012, -1.700000000000001, -2.2000000000000015, -1.8000000000000012, -1.5000000000000009, -1.8000000000000012, -1.600000000000001, -2.1000000000000014, -1.700000000000001, -1.8000000000000012, -1.5000000000000009, -2.0000000000000013, -1.4000000000000008, -2.1000000000000014, -1.5000000000000009, -1.4000000000000008, -2.0000000000000013, -2.2000000000000015, -1.600000000000001, -1.700000000000001, -1.8000000000000012, -2.600000000000002, -1.5000000000000009, -1.5000000000000009, -1.9000000000000012, -1.9000000000000012, -1.5000000000000009, -1.600000000000001, -1.600000000000001, -2.2000000000000015, -1.8000000000000012, -1.600000000000001, -1.8000000000000012, -1.8000000000000012, -1.5000000000000009, -1.600000000000001, -1.5000000000000009, -1.9000000000000012, -1.9000000000000012, -1.5000000000000009, -2.1000000000000014, -2.2000000000000015, -1.8000000000000012, -1.600000000000001, -1.4000000000000008, -2.0000000000000013, -1.9000000000000012, -1.9000000000000012, -2.1000000000000014, -1.600000000000001, -2.0000000000000013, -5.700000000000003, -1.600000000000001, -1.9000000000000012, -1.600000000000001, -1.5000000000000009, -1.600000000000001, -1.5000000000000009, -1.600000000000001, -1.5000000000000009, -1.600000000000001, -1.8000000000000012, -2.1000000000000014, -1.9000000000000012, -1.600000000000001, -1.8000000000000012, -3.0000000000000018, -1.8000000000000012, -1.8000000000000012, -1.700000000000001, -2.2000000000000015, -1.600000000000001, -1.8000000000000012, -1.9000000000000012, -1.600000000000001, -1.9000000000000012, -1.700000000000001], "episode_lengths": [26, 28, 32, 26, 27, 32, 29, 28, 26, 30, 26, 28, 27, 26, 32, 30, 30, 28, 26, 28, 28, 27, 31, 30, 28, 27, 28, 33, 28, 27, 33, 27, 26, 29, 32, 26, 28, 29, 28, 37, 28, 27, 30, 25, 26, 27, 26, 26, 25, 28, 31, 31, 33, 28, 33, 25, 29, 28, 30, 27, 27, 34, 29, 28, 33, 29, 26, 29, 27, 32, 28, 29, 26, 31, 25, 32, 26, 25, 31, 33, 27, 28, 29, 35, 26, 26, 30, 30, 26, 27, 27, 33, 29, 27, 29, 29, 26, 27, 26, 30, 30, 26, 32, 33, 29, 27, 25, 31, 30, 30, 32, 27, 31, 53, 27, 30, 27, 26, 27, 26, 27, 26, 27, 29, 32, 30, 27, 29, 41, 29, 29, 28, 33, 27, 29, 30, 27, 30, 28]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.299254517293602, "mean_inference_ms": 0.6300697157990242, "mean_action_processing_ms": 0.06805682806475682, "mean_env_wait_ms": 6.681193072696058, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005820157716600157, "StateBufferConnector_ms": 0.003250211262874466, "ViewRequirementAgentConnector_ms": 0.07532397620111918}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 196000, "num_agent_steps_trained": 196000, "num_env_steps_sampled": 196000, "num_env_steps_trained": 196000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 332.1109174817634, "num_env_steps_trained_throughput_per_sec": 332.1109174817634, "timesteps_total": 196000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 196000, "timers": {"training_iteration_time_ms": 12142.994, "sample_time_ms": 8676.188, "load_time_ms": 1.05, "load_throughput": 3808589.135, "learn_time_ms": 3463.323, "learn_throughput": 1154.96, "synch_weights_time_ms": 1.791}, "counters": {"num_env_steps_sampled": 196000, "num_env_steps_trained": 196000, "num_agent_steps_sampled": 196000, "num_agent_steps_trained": 196000}, "done": false, "episodes_total": 3668, "training_iteration": 49, "trial_id": "83204_00000", "date": "2024-03-07_12-12-03", "timestamp": 1709831523, "time_this_iter_s": 12.046907663345337, "time_total_s": 552.7995779514313, "pid": 102666, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fcd19c36f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 552.7995779514313, "iterations_since_restore": 49, "perf": {"cpu_util_percent": 21.006666666666664, "ram_util_percent": 44.20666666666668, "gpu_util_percent0": 0.07133333333333332, "vram_util_percent0": 0.096923828125}}
{"evaluation": {"sampler_results": {"episode_reward_max": -1.4000000000000008, "episode_reward_min": -2.4000000000000017, "episode_reward_mean": -1.775000000000001, "episode_len_mean": 28.75, "episode_media": {}, "episodes_this_iter": 20, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1.600000000000001, -1.700000000000001, -1.600000000000001, -1.700000000000001, -2.2000000000000015, -1.700000000000001, -1.600000000000001, -1.9000000000000012, -2.3000000000000016, -2.4000000000000017, -1.8000000000000012, -1.700000000000001, -1.700000000000001, -1.600000000000001, -1.9000000000000012, -1.8000000000000012, -1.600000000000001, -1.4000000000000008, -1.5000000000000009, -1.8000000000000012], "episode_lengths": [27, 28, 27, 28, 33, 28, 27, 30, 34, 35, 29, 28, 28, 27, 30, 29, 27, 25, 26, 29]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37160433000988424, "mean_inference_ms": 1.1762244005997973, "mean_action_processing_ms": 0.06725183791584441, "mean_env_wait_ms": 7.184393290016385, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037145614624023438, "StateBufferConnector_ms": 0.0025856494903564453, "ViewRequirementAgentConnector_ms": 0.06458163261413574}}, "episode_reward_max": -1.4000000000000008, "episode_reward_min": -2.4000000000000017, "episode_reward_mean": -1.775000000000001, "episode_len_mean": 28.75, "episode_media": {}, "episodes_this_iter": 20, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1.600000000000001, -1.700000000000001, -1.600000000000001, -1.700000000000001, -2.2000000000000015, -1.700000000000001, -1.600000000000001, -1.9000000000000012, -2.3000000000000016, -2.4000000000000017, -1.8000000000000012, -1.700000000000001, -1.700000000000001, -1.600000000000001, -1.9000000000000012, -1.8000000000000012, -1.600000000000001, -1.4000000000000008, -1.5000000000000009, -1.8000000000000012], "episode_lengths": [27, 28, 27, 28, 33, 28, 27, 30, 34, 35, 29, 28, 28, 27, 30, 29, 27, 25, 26, 29]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37160433000988424, "mean_inference_ms": 1.1762244005997973, "mean_action_processing_ms": 0.06725183791584441, "mean_env_wait_ms": 7.184393290016385, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037145614624023438, "StateBufferConnector_ms": 0.0025856494903564453, "ViewRequirementAgentConnector_ms": 0.06458163261413574}, "num_agent_steps_sampled_this_iter": 575, "num_env_steps_sampled_this_iter": 575, "timesteps_this_iter": 575, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.15, "cur_lr": 0.0010000000000000005, "total_loss": -0.0009704148857503809, "policy_loss": -0.01333767341910511, "vf_loss": 0.011611725913951553, "vf_explained_var": 0.9855295744634444, "kl": 0.005036878914148638, "entropy": 0.21348142617492266, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 46035.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 200000, "num_env_steps_trained": 200000, "num_agent_steps_sampled": 200000, "num_agent_steps_trained": 200000}, "sampler_results": {"episode_reward_max": -1.4000000000000008, "episode_reward_min": -2.600000000000002, "episode_reward_mean": -1.7588652482269516, "episode_len_mean": 28.588652482269502, "episode_media": {}, "episodes_this_iter": 141, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1.700000000000001, -1.600000000000001, -1.600000000000001, -2.0000000000000013, -1.700000000000001, -1.5000000000000009, -1.9000000000000012, -1.9000000000000012, -1.8000000000000012, -1.9000000000000012, -1.8000000000000012, -1.5000000000000009, -1.600000000000001, -1.700000000000001, -1.700000000000001, -1.4000000000000008, -1.5000000000000009, -1.4000000000000008, -1.8000000000000012, -1.8000000000000012, -1.8000000000000012, -2.600000000000002, -1.700000000000001, -1.8000000000000012, -1.600000000000001, -2.1000000000000014, -1.600000000000001, -1.700000000000001, -1.8000000000000012, -1.9000000000000012, -1.700000000000001, -1.600000000000001, -1.700000000000001, -1.600000000000001, -1.9000000000000012, -1.600000000000001, -1.8000000000000012, -1.700000000000001, -1.9000000000000012, -1.600000000000001, -1.700000000000001, -1.700000000000001, -1.8000000000000012, -1.700000000000001, -2.0000000000000013, -2.1000000000000014, -1.8000000000000012, -1.8000000000000012, -1.8000000000000012, -1.600000000000001, -1.5000000000000009, -1.600000000000001, -1.700000000000001, -1.8000000000000012, -1.9000000000000012, -2.1000000000000014, -1.600000000000001, -1.600000000000001, -1.5000000000000009, -2.1000000000000014, -1.8000000000000012, -1.700000000000001, -2.0000000000000013, -2.0000000000000013, -1.5000000000000009, -1.4000000000000008, -2.5000000000000018, -1.600000000000001, -1.600000000000001, -1.5000000000000009, -1.600000000000001, -1.700000000000001, -1.600000000000001, -1.8000000000000012, -2.0000000000000013, -1.600000000000001, -1.9000000000000012, -2.1000000000000014, -1.700000000000001, -1.8000000000000012, -1.600000000000001, -1.700000000000001, -1.8000000000000012, -1.600000000000001, -1.600000000000001, -2.3000000000000016, -1.8000000000000012, -2.0000000000000013, -2.0000000000000013, -1.8000000000000012, -1.5000000000000009, -2.0000000000000013, -2.3000000000000016, -1.600000000000001, -2.2000000000000015, -1.9000000000000012, -1.600000000000001, -1.9000000000000012, -1.600000000000001, -1.9000000000000012, -1.4000000000000008, -1.600000000000001, -1.5000000000000009, -2.1000000000000014, -1.9000000000000012, -2.1000000000000014, -1.8000000000000012, -1.9000000000000012, -1.600000000000001, -1.8000000000000012, -1.9000000000000012, -1.9000000000000012, -1.4000000000000008, -1.600000000000001, -1.700000000000001, -1.700000000000001, -1.5000000000000009, -2.1000000000000014, -1.700000000000001, -1.9000000000000012, -1.700000000000001, -2.0000000000000013, -1.700000000000001, -1.9000000000000012, -1.9000000000000012, -1.600000000000001, -1.8000000000000012, -1.5000000000000009, -1.700000000000001, -1.8000000000000012, -1.8000000000000012, -1.5000000000000009, -1.8000000000000012, -1.5000000000000009, -1.5000000000000009, -1.5000000000000009, -1.8000000000000012, -1.5000000000000009, -1.600000000000001, -2.0000000000000013, -1.8000000000000012], "episode_lengths": [28, 27, 27, 31, 28, 26, 30, 30, 29, 30, 29, 26, 27, 28, 28, 25, 26, 25, 29, 29, 29, 37, 28, 29, 27, 32, 27, 28, 29, 30, 28, 27, 28, 27, 30, 27, 29, 28, 30, 27, 28, 28, 29, 28, 31, 32, 29, 29, 29, 27, 26, 27, 28, 29, 30, 32, 27, 27, 26, 32, 29, 28, 31, 31, 26, 25, 36, 27, 27, 26, 27, 28, 27, 29, 31, 27, 30, 32, 28, 29, 27, 28, 29, 27, 27, 34, 29, 31, 31, 29, 26, 31, 34, 27, 33, 30, 27, 30, 27, 30, 25, 27, 26, 32, 30, 32, 29, 30, 27, 29, 30, 30, 25, 27, 28, 28, 26, 32, 28, 30, 28, 31, 28, 30, 30, 27, 29, 26, 28, 29, 29, 26, 29, 26, 26, 26, 29, 26, 27, 31, 29]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.30140260711437766, "mean_inference_ms": 0.6302051101060356, "mean_action_processing_ms": 0.06804348655779933, "mean_env_wait_ms": 6.6969061640711045, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005687720386694509, "StateBufferConnector_ms": 0.0032942345801820145, "ViewRequirementAgentConnector_ms": 0.07601223938854028}}, "episode_reward_max": -1.4000000000000008, "episode_reward_min": -2.600000000000002, "episode_reward_mean": -1.7588652482269516, "episode_len_mean": 28.588652482269502, "episodes_this_iter": 141, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1.700000000000001, -1.600000000000001, -1.600000000000001, -2.0000000000000013, -1.700000000000001, -1.5000000000000009, -1.9000000000000012, -1.9000000000000012, -1.8000000000000012, -1.9000000000000012, -1.8000000000000012, -1.5000000000000009, -1.600000000000001, -1.700000000000001, -1.700000000000001, -1.4000000000000008, -1.5000000000000009, -1.4000000000000008, -1.8000000000000012, -1.8000000000000012, -1.8000000000000012, -2.600000000000002, -1.700000000000001, -1.8000000000000012, -1.600000000000001, -2.1000000000000014, -1.600000000000001, -1.700000000000001, -1.8000000000000012, -1.9000000000000012, -1.700000000000001, -1.600000000000001, -1.700000000000001, -1.600000000000001, -1.9000000000000012, -1.600000000000001, -1.8000000000000012, -1.700000000000001, -1.9000000000000012, -1.600000000000001, -1.700000000000001, -1.700000000000001, -1.8000000000000012, -1.700000000000001, -2.0000000000000013, -2.1000000000000014, -1.8000000000000012, -1.8000000000000012, -1.8000000000000012, -1.600000000000001, -1.5000000000000009, -1.600000000000001, -1.700000000000001, -1.8000000000000012, -1.9000000000000012, -2.1000000000000014, -1.600000000000001, -1.600000000000001, -1.5000000000000009, -2.1000000000000014, -1.8000000000000012, -1.700000000000001, -2.0000000000000013, -2.0000000000000013, -1.5000000000000009, -1.4000000000000008, -2.5000000000000018, -1.600000000000001, -1.600000000000001, -1.5000000000000009, -1.600000000000001, -1.700000000000001, -1.600000000000001, -1.8000000000000012, -2.0000000000000013, -1.600000000000001, -1.9000000000000012, -2.1000000000000014, -1.700000000000001, -1.8000000000000012, -1.600000000000001, -1.700000000000001, -1.8000000000000012, -1.600000000000001, -1.600000000000001, -2.3000000000000016, -1.8000000000000012, -2.0000000000000013, -2.0000000000000013, -1.8000000000000012, -1.5000000000000009, -2.0000000000000013, -2.3000000000000016, -1.600000000000001, -2.2000000000000015, -1.9000000000000012, -1.600000000000001, -1.9000000000000012, -1.600000000000001, -1.9000000000000012, -1.4000000000000008, -1.600000000000001, -1.5000000000000009, -2.1000000000000014, -1.9000000000000012, -2.1000000000000014, -1.8000000000000012, -1.9000000000000012, -1.600000000000001, -1.8000000000000012, -1.9000000000000012, -1.9000000000000012, -1.4000000000000008, -1.600000000000001, -1.700000000000001, -1.700000000000001, -1.5000000000000009, -2.1000000000000014, -1.700000000000001, -1.9000000000000012, -1.700000000000001, -2.0000000000000013, -1.700000000000001, -1.9000000000000012, -1.9000000000000012, -1.600000000000001, -1.8000000000000012, -1.5000000000000009, -1.700000000000001, -1.8000000000000012, -1.8000000000000012, -1.5000000000000009, -1.8000000000000012, -1.5000000000000009, -1.5000000000000009, -1.5000000000000009, -1.8000000000000012, -1.5000000000000009, -1.600000000000001, -2.0000000000000013, -1.8000000000000012], "episode_lengths": [28, 27, 27, 31, 28, 26, 30, 30, 29, 30, 29, 26, 27, 28, 28, 25, 26, 25, 29, 29, 29, 37, 28, 29, 27, 32, 27, 28, 29, 30, 28, 27, 28, 27, 30, 27, 29, 28, 30, 27, 28, 28, 29, 28, 31, 32, 29, 29, 29, 27, 26, 27, 28, 29, 30, 32, 27, 27, 26, 32, 29, 28, 31, 31, 26, 25, 36, 27, 27, 26, 27, 28, 27, 29, 31, 27, 30, 32, 28, 29, 27, 28, 29, 27, 27, 34, 29, 31, 31, 29, 26, 31, 34, 27, 33, 30, 27, 30, 27, 30, 25, 27, 26, 32, 30, 32, 29, 30, 27, 29, 30, 30, 25, 27, 28, 28, 26, 32, 28, 30, 28, 31, 28, 30, 30, 27, 29, 26, 28, 29, 29, 26, 29, 26, 26, 26, 29, 26, 27, 31, 29]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.30140260711437766, "mean_inference_ms": 0.6302051101060356, "mean_action_processing_ms": 0.06804348655779933, "mean_env_wait_ms": 6.6969061640711045, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005687720386694509, "StateBufferConnector_ms": 0.0032942345801820145, "ViewRequirementAgentConnector_ms": 0.07601223938854028}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 200000, "num_agent_steps_trained": 200000, "num_env_steps_sampled": 200000, "num_env_steps_trained": 200000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 328.96917364995744, "num_env_steps_trained_throughput_per_sec": 328.96917364995744, "timesteps_total": 200000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 200000, "timers": {"training_iteration_time_ms": 12155.979, "sample_time_ms": 8687.382, "load_time_ms": 1.055, "load_throughput": 3790262.064, "learn_time_ms": 3465.096, "learn_throughput": 1154.369, "synch_weights_time_ms": 1.799}, "counters": {"num_env_steps_sampled": 200000, "num_env_steps_trained": 200000, "num_agent_steps_sampled": 200000, "num_agent_steps_trained": 200000}, "done": true, "episodes_total": 3809, "training_iteration": 50, "trial_id": "83204_00000", "date": "2024-03-07_12-12-20", "timestamp": 1709831540, "time_this_iter_s": 17.242034435272217, "time_total_s": 570.0416123867035, "pid": 102666, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fcd19c36f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 570.0416123867035, "iterations_since_restore": 50, "perf": {"cpu_util_percent": 16.22173913043478, "ram_util_percent": 44.20000000000002, "gpu_util_percent0": 0.058695652173913045, "vram_util_percent0": 0.096923828125}}
