{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 8.59840937814405, "policy_loss": 0.007950157181469984, "vf_loss": 8.589361380505306, "vf_explained_var": -0.003086344144677603, "kl": 0.005489070933733028, "entropy": 1.0931934527171556, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 465.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000}, "sampler_results": {"episode_reward_max": -8.999999999999991, "episode_reward_min": -67.50000000000037, "episode_reward_mean": -49.0125000000003, "episode_len_mean": 340.625, "episode_media": {}, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-63.500000000000504, -48.100000000000364, -61.00000000000038, -24.80000000000006, -55.100000000000435, -67.50000000000037, -63.10000000000035, -8.999999999999991], "episode_lengths": [400, 400, 400, 236, 400, 400, 400, 89]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.22372678023249626, "mean_inference_ms": 0.7152191975609046, "mean_action_processing_ms": 0.07615634010073742, "mean_env_wait_ms": 6.309126087312916, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008031725883483887, "StateBufferConnector_ms": 0.0038564205169677734, "ViewRequirementAgentConnector_ms": 0.087699294090271}}, "episode_reward_max": -8.999999999999991, "episode_reward_min": -67.50000000000037, "episode_reward_mean": -49.0125000000003, "episode_len_mean": 340.625, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-63.500000000000504, -48.100000000000364, -61.00000000000038, -24.80000000000006, -55.100000000000435, -67.50000000000037, -63.10000000000035, -8.999999999999991], "episode_lengths": [400, 400, 400, 236, 400, 400, 400, 89]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.22372678023249626, "mean_inference_ms": 0.7152191975609046, "mean_action_processing_ms": 0.07615634010073742, "mean_env_wait_ms": 6.309126087312916, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008031725883483887, "StateBufferConnector_ms": 0.0038564205169677734, "ViewRequirementAgentConnector_ms": 0.087699294090271}, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 462.14044988326674, "num_env_steps_trained_throughput_per_sec": 462.14044988326674, "timesteps_total": 4000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 4000, "timers": {"training_iteration_time_ms": 8655.31, "sample_time_ms": 5004.593, "load_time_ms": 0.942, "load_throughput": 4247396.456, "learn_time_ms": 3646.873, "learn_throughput": 1096.83, "synch_weights_time_ms": 2.097}, "counters": {"num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000}, "done": false, "episodes_total": 8, "training_iteration": 1, "trial_id": "ddfb6_00000", "date": "2024-03-07_12-48-28", "timestamp": 1709833708, "time_this_iter_s": 8.65746283531189, "time_total_s": 8.65746283531189, "pid": 112355, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4d85689f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 8.65746283531189, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 24.233333333333334, "ram_util_percent": 50.974999999999994, "gpu_util_percent0": 0.09749999999999999, "vram_util_percent0": 0.12690565321180558}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 6.958380953807343, "policy_loss": -0.0009959178666273754, "vf_loss": 6.958125330587869, "vf_explained_var": -0.2327019900403997, "kl": 0.006257715334933424, "entropy": 1.085983565417669, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 1395.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000}, "sampler_results": {"episode_reward_max": -6.599999999999989, "episode_reward_min": -69.50000000000048, "episode_reward_mean": -48.8047619047622, "episode_len_mean": 345.76190476190476, "episode_media": {}, "episodes_this_iter": 13, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-63.500000000000504, -48.100000000000364, -61.00000000000038, -24.80000000000006, -55.100000000000435, -67.50000000000037, -63.10000000000035, -8.999999999999991, -46.00000000000024, -8.599999999999982, -67.30000000000032, -55.100000000000286, -6.599999999999989, -52.80000000000038, -56.200000000000266, -48.90000000000031, -59.60000000000035, -52.20000000000033, -55.200000000000365, -69.50000000000048, -54.800000000000466], "episode_lengths": [400, 400, 400, 236, 400, 400, 400, 89, 400, 97, 400, 362, 77, 400, 400, 400, 400, 400, 400, 400, 400]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.22510243458844306, "mean_inference_ms": 0.7132816223324118, "mean_action_processing_ms": 0.07576557668703232, "mean_env_wait_ms": 6.3085228863146945, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007878031049455916, "StateBufferConnector_ms": 0.003830591837565104, "ViewRequirementAgentConnector_ms": 0.08735543205624535}}, "episode_reward_max": -6.599999999999989, "episode_reward_min": -69.50000000000048, "episode_reward_mean": -48.8047619047622, "episode_len_mean": 345.76190476190476, "episodes_this_iter": 13, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-63.500000000000504, -48.100000000000364, -61.00000000000038, -24.80000000000006, -55.100000000000435, -67.50000000000037, -63.10000000000035, -8.999999999999991, -46.00000000000024, -8.599999999999982, -67.30000000000032, -55.100000000000286, -6.599999999999989, -52.80000000000038, -56.200000000000266, -48.90000000000031, -59.60000000000035, -52.20000000000033, -55.200000000000365, -69.50000000000048, -54.800000000000466], "episode_lengths": [400, 400, 400, 236, 400, 400, 400, 89, 400, 97, 400, 362, 77, 400, 400, 400, 400, 400, 400, 400, 400]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.22510243458844306, "mean_inference_ms": 0.7132816223324118, "mean_action_processing_ms": 0.07576557668703232, "mean_env_wait_ms": 6.3085228863146945, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007878031049455916, "StateBufferConnector_ms": 0.003830591837565104, "ViewRequirementAgentConnector_ms": 0.08735543205624535}, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 466.23037158446255, "num_env_steps_trained_throughput_per_sec": 466.23037158446255, "timesteps_total": 8000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 8000, "timers": {"training_iteration_time_ms": 8617.36, "sample_time_ms": 4995.004, "load_time_ms": 0.979, "load_throughput": 4085526.848, "learn_time_ms": 3618.577, "learn_throughput": 1105.407, "synch_weights_time_ms": 2.056}, "counters": {"num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000}, "done": false, "episodes_total": 21, "training_iteration": 2, "trial_id": "ddfb6_00000", "date": "2024-03-07_12-48-36", "timestamp": 1709833716, "time_this_iter_s": 8.58188271522522, "time_total_s": 17.23934555053711, "pid": 112355, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4d85689f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 17.23934555053711, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 26.227272727272734, "ram_util_percent": 51.3, "gpu_util_percent0": 0.10272727272727272, "vram_util_percent0": 0.12736002604166669}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 5.952950571394796, "policy_loss": -0.00278792052019027, "vf_loss": 5.954448372333921, "vf_explained_var": -0.23787893261960757, "kl": 0.0064505553274802575, "entropy": 1.0758214764697578, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 2325.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000}, "sampler_results": {"episode_reward_max": -6.599999999999989, "episode_reward_min": -69.50000000000048, "episode_reward_mean": -43.773529411764954, "episode_len_mean": 321.7352941176471, "episode_media": {}, "episodes_this_iter": 13, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-63.500000000000504, -48.100000000000364, -61.00000000000038, -24.80000000000006, -55.100000000000435, -67.50000000000037, -63.10000000000035, -8.999999999999991, -46.00000000000024, -8.599999999999982, -67.30000000000032, -55.100000000000286, -6.599999999999989, -52.80000000000038, -56.200000000000266, -48.90000000000031, -59.60000000000035, -52.20000000000033, -55.200000000000365, -69.50000000000048, -54.800000000000466, -48.30000000000026, -8.89999999999998, -48.700000000000344, -28.800000000000114, -47.200000000000294, -7.699999999999985, -48.40000000000024, -30.500000000000043, -53.200000000000244, -45.40000000000011, -8.099999999999984, -64.30000000000034, -23.899999999999984], "episode_lengths": [400, 400, 400, 236, 400, 400, 400, 89, 400, 97, 400, 362, 77, 400, 400, 400, 400, 400, 400, 400, 400, 400, 100, 400, 262, 400, 88, 400, 247, 400, 295, 92, 400, 194]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.22557699683043547, "mean_inference_ms": 0.7117208136963176, "mean_action_processing_ms": 0.07546980135721197, "mean_env_wait_ms": 6.28578873235255, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007576100966509651, "StateBufferConnector_ms": 0.0038743019104003906, "ViewRequirementAgentConnector_ms": 0.08704311707440544}}, "episode_reward_max": -6.599999999999989, "episode_reward_min": -69.50000000000048, "episode_reward_mean": -43.773529411764954, "episode_len_mean": 321.7352941176471, "episodes_this_iter": 13, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-63.500000000000504, -48.100000000000364, -61.00000000000038, -24.80000000000006, -55.100000000000435, -67.50000000000037, -63.10000000000035, -8.999999999999991, -46.00000000000024, -8.599999999999982, -67.30000000000032, -55.100000000000286, -6.599999999999989, -52.80000000000038, -56.200000000000266, -48.90000000000031, -59.60000000000035, -52.20000000000033, -55.200000000000365, -69.50000000000048, -54.800000000000466, -48.30000000000026, -8.89999999999998, -48.700000000000344, -28.800000000000114, -47.200000000000294, -7.699999999999985, -48.40000000000024, -30.500000000000043, -53.200000000000244, -45.40000000000011, -8.099999999999984, -64.30000000000034, -23.899999999999984], "episode_lengths": [400, 400, 400, 236, 400, 400, 400, 89, 400, 97, 400, 362, 77, 400, 400, 400, 400, 400, 400, 400, 400, 400, 100, 400, 262, 400, 88, 400, 247, 400, 295, 92, 400, 194]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.22557699683043547, "mean_inference_ms": 0.7117208136963176, "mean_action_processing_ms": 0.07546980135721197, "mean_env_wait_ms": 6.28578873235255, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007576100966509651, "StateBufferConnector_ms": 0.0038743019104003906, "ViewRequirementAgentConnector_ms": 0.08704311707440544}, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 469.99522391046736, "num_env_steps_trained_throughput_per_sec": 469.99522391046736, "timesteps_total": 12000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 12000, "timers": {"training_iteration_time_ms": 8581.796, "sample_time_ms": 4954.466, "load_time_ms": 0.978, "load_throughput": 4091338.644, "learn_time_ms": 3623.459, "learn_throughput": 1103.918, "synch_weights_time_ms": 2.17}, "counters": {"num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000}, "done": false, "episodes_total": 34, "training_iteration": 3, "trial_id": "ddfb6_00000", "date": "2024-03-07_12-48-45", "timestamp": 1709833725, "time_this_iter_s": 8.512884855270386, "time_total_s": 25.752230405807495, "pid": 112355, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4d85689f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 25.752230405807495, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 26.881818181818186, "ram_util_percent": 51.381818181818176, "gpu_util_percent0": 0.10363636363636362, "vram_util_percent0": 0.12736002604166669}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 5.110545410648469, "policy_loss": -0.009458575599015721, "vf_loss": 5.118511735720019, "vf_explained_var": -0.4885177228399502, "kl": 0.0074613031582725295, "entropy": 1.070987646554106, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 3255.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000}, "sampler_results": {"episode_reward_max": -6.599999999999989, "episode_reward_min": -69.50000000000048, "episode_reward_mean": -39.629411764706084, "episode_len_mean": 297.0980392156863, "episode_media": {}, "episodes_this_iter": 17, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-63.500000000000504, -48.100000000000364, -61.00000000000038, -24.80000000000006, -55.100000000000435, -67.50000000000037, -63.10000000000035, -8.999999999999991, -46.00000000000024, -8.599999999999982, -67.30000000000032, -55.100000000000286, -6.599999999999989, -52.80000000000038, -56.200000000000266, -48.90000000000031, -59.60000000000035, -52.20000000000033, -55.200000000000365, -69.50000000000048, -54.800000000000466, -48.30000000000026, -8.89999999999998, -48.700000000000344, -28.800000000000114, -47.200000000000294, -7.699999999999985, -48.40000000000024, -30.500000000000043, -53.200000000000244, -45.40000000000011, -8.099999999999984, -64.30000000000034, -23.899999999999984, -48.000000000000405, -22.800000000000086, -43.90000000000031, -23.3, -46.30000000000023, -12.399999999999968, -30.600000000000033, -18.899999999999984, -7.199999999999987, -66.80000000000041, -14.699999999999976, -50.700000000000266, -56.800000000000374, -8.299999999999985, -12.799999999999981, -14.299999999999969, -55.000000000000384], "episode_lengths": [400, 400, 400, 236, 400, 400, 400, 89, 400, 97, 400, 362, 77, 400, 400, 400, 400, 400, 400, 400, 400, 400, 100, 400, 262, 400, 88, 400, 247, 400, 295, 92, 400, 194, 400, 195, 400, 181, 326, 127, 249, 180, 79, 400, 134, 400, 400, 93, 106, 143, 400]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.22725296256084146, "mean_inference_ms": 0.7127145348304957, "mean_action_processing_ms": 0.07540796030381992, "mean_env_wait_ms": 6.2862680238541975, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007426972482718674, "StateBufferConnector_ms": 0.0038787430407954196, "ViewRequirementAgentConnector_ms": 0.0879353167963963}}, "episode_reward_max": -6.599999999999989, "episode_reward_min": -69.50000000000048, "episode_reward_mean": -39.629411764706084, "episode_len_mean": 297.0980392156863, "episodes_this_iter": 17, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-63.500000000000504, -48.100000000000364, -61.00000000000038, -24.80000000000006, -55.100000000000435, -67.50000000000037, -63.10000000000035, -8.999999999999991, -46.00000000000024, -8.599999999999982, -67.30000000000032, -55.100000000000286, -6.599999999999989, -52.80000000000038, -56.200000000000266, -48.90000000000031, -59.60000000000035, -52.20000000000033, -55.200000000000365, -69.50000000000048, -54.800000000000466, -48.30000000000026, -8.89999999999998, -48.700000000000344, -28.800000000000114, -47.200000000000294, -7.699999999999985, -48.40000000000024, -30.500000000000043, -53.200000000000244, -45.40000000000011, -8.099999999999984, -64.30000000000034, -23.899999999999984, -48.000000000000405, -22.800000000000086, -43.90000000000031, -23.3, -46.30000000000023, -12.399999999999968, -30.600000000000033, -18.899999999999984, -7.199999999999987, -66.80000000000041, -14.699999999999976, -50.700000000000266, -56.800000000000374, -8.299999999999985, -12.799999999999981, -14.299999999999969, -55.000000000000384], "episode_lengths": [400, 400, 400, 236, 400, 400, 400, 89, 400, 97, 400, 362, 77, 400, 400, 400, 400, 400, 400, 400, 400, 400, 100, 400, 262, 400, 88, 400, 247, 400, 295, 92, 400, 194, 400, 195, 400, 181, 326, 127, 249, 180, 79, 400, 134, 400, 400, 93, 106, 143, 400]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.22725296256084146, "mean_inference_ms": 0.7127145348304957, "mean_action_processing_ms": 0.07540796030381992, "mean_env_wait_ms": 6.2862680238541975, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007426972482718674, "StateBufferConnector_ms": 0.0038787430407954196, "ViewRequirementAgentConnector_ms": 0.0879353167963963}, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 451.5239186851875, "num_env_steps_trained_throughput_per_sec": 451.5239186851875, "timesteps_total": 16000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 16000, "timers": {"training_iteration_time_ms": 8651.061, "sample_time_ms": 4995.844, "load_time_ms": 0.978, "load_throughput": 4090756.721, "learn_time_ms": 3651.332, "learn_throughput": 1095.491, "synch_weights_time_ms": 2.213}, "counters": {"num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000}, "done": false, "episodes_total": 51, "training_iteration": 4, "trial_id": "ddfb6_00000", "date": "2024-03-07_12-48-54", "timestamp": 1709833734, "time_this_iter_s": 8.860888242721558, "time_total_s": 34.61311864852905, "pid": 112355, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4d85689f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 34.61311864852905, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 28.518181818181816, "ram_util_percent": 51.318181818181806, "gpu_util_percent0": 0.12272727272727274, "vram_util_percent0": 0.12739701704545456}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 5.109872198072813, "policy_loss": -0.012261862992759673, "vf_loss": 5.120916368780277, "vf_explained_var": -0.15638727552147322, "kl": 0.0060884951660022165, "entropy": 1.0631284979081923, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 4185.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 20000}, "sampler_results": {"episode_reward_max": -6.599999999999989, "episode_reward_min": -69.50000000000048, "episode_reward_mean": -36.504411764706056, "episode_len_mean": 278.94117647058823, "episode_media": {}, "episodes_this_iter": 17, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-63.500000000000504, -48.100000000000364, -61.00000000000038, -24.80000000000006, -55.100000000000435, -67.50000000000037, -63.10000000000035, -8.999999999999991, -46.00000000000024, -8.599999999999982, -67.30000000000032, -55.100000000000286, -6.599999999999989, -52.80000000000038, -56.200000000000266, -48.90000000000031, -59.60000000000035, -52.20000000000033, -55.200000000000365, -69.50000000000048, -54.800000000000466, -48.30000000000026, -8.89999999999998, -48.700000000000344, -28.800000000000114, -47.200000000000294, -7.699999999999985, -48.40000000000024, -30.500000000000043, -53.200000000000244, -45.40000000000011, -8.099999999999984, -64.30000000000034, -23.899999999999984, -48.000000000000405, -22.800000000000086, -43.90000000000031, -23.3, -46.30000000000023, -12.399999999999968, -30.600000000000033, -18.899999999999984, -7.199999999999987, -66.80000000000041, -14.699999999999976, -50.700000000000266, -56.800000000000374, -8.299999999999985, -12.799999999999981, -14.299999999999969, -55.000000000000384, -55.30000000000035, -46.50000000000027, -14.89999999999996, -28.90000000000011, -28.800000000000036, -18.699999999999967, -23.999999999999975, -7.999999999999984, -27.30000000000009, -65.70000000000036, -22.100000000000055, -7.699999999999987, -31.600000000000087, -12.399999999999968, -8.399999999999983, -49.8000000000004, -11.099999999999977], "episode_lengths": [400, 400, 400, 236, 400, 400, 400, 89, 400, 97, 400, 362, 77, 400, 400, 400, 400, 400, 400, 400, 400, 400, 100, 400, 262, 400, 88, 400, 247, 400, 295, 92, 400, 194, 400, 195, 400, 181, 326, 127, 249, 180, 79, 400, 134, 400, 400, 93, 106, 143, 400, 400, 400, 143, 261, 219, 146, 192, 91, 243, 400, 227, 86, 284, 122, 95, 400, 107]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.22913981145089957, "mean_inference_ms": 0.7144939932955864, "mean_action_processing_ms": 0.07545790307463662, "mean_env_wait_ms": 6.29019328277887, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007374847636503332, "StateBufferConnector_ms": 0.0038851709926829617, "ViewRequirementAgentConnector_ms": 0.08852376657373764}}, "episode_reward_max": -6.599999999999989, "episode_reward_min": -69.50000000000048, "episode_reward_mean": -36.504411764706056, "episode_len_mean": 278.94117647058823, "episodes_this_iter": 17, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-63.500000000000504, -48.100000000000364, -61.00000000000038, -24.80000000000006, -55.100000000000435, -67.50000000000037, -63.10000000000035, -8.999999999999991, -46.00000000000024, -8.599999999999982, -67.30000000000032, -55.100000000000286, -6.599999999999989, -52.80000000000038, -56.200000000000266, -48.90000000000031, -59.60000000000035, -52.20000000000033, -55.200000000000365, -69.50000000000048, -54.800000000000466, -48.30000000000026, -8.89999999999998, -48.700000000000344, -28.800000000000114, -47.200000000000294, -7.699999999999985, -48.40000000000024, -30.500000000000043, -53.200000000000244, -45.40000000000011, -8.099999999999984, -64.30000000000034, -23.899999999999984, -48.000000000000405, -22.800000000000086, -43.90000000000031, -23.3, -46.30000000000023, -12.399999999999968, -30.600000000000033, -18.899999999999984, -7.199999999999987, -66.80000000000041, -14.699999999999976, -50.700000000000266, -56.800000000000374, -8.299999999999985, -12.799999999999981, -14.299999999999969, -55.000000000000384, -55.30000000000035, -46.50000000000027, -14.89999999999996, -28.90000000000011, -28.800000000000036, -18.699999999999967, -23.999999999999975, -7.999999999999984, -27.30000000000009, -65.70000000000036, -22.100000000000055, -7.699999999999987, -31.600000000000087, -12.399999999999968, -8.399999999999983, -49.8000000000004, -11.099999999999977], "episode_lengths": [400, 400, 400, 236, 400, 400, 400, 89, 400, 97, 400, 362, 77, 400, 400, 400, 400, 400, 400, 400, 400, 400, 100, 400, 262, 400, 88, 400, 247, 400, 295, 92, 400, 194, 400, 195, 400, 181, 326, 127, 249, 180, 79, 400, 134, 400, 400, 93, 106, 143, 400, 400, 400, 143, 261, 219, 146, 192, 91, 243, 400, 227, 86, 284, 122, 95, 400, 107]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.22913981145089957, "mean_inference_ms": 0.7144939932955864, "mean_action_processing_ms": 0.07545790307463662, "mean_env_wait_ms": 6.29019328277887, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007374847636503332, "StateBufferConnector_ms": 0.0038851709926829617, "ViewRequirementAgentConnector_ms": 0.08852376657373764}, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 20000, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 424.9633591921783, "num_env_steps_trained_throughput_per_sec": 424.9633591921783, "timesteps_total": 20000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 20000, "timers": {"training_iteration_time_ms": 8803.356, "sample_time_ms": 5013.675, "load_time_ms": 0.997, "load_throughput": 4013880.09, "learn_time_ms": 3785.672, "learn_throughput": 1056.616, "synch_weights_time_ms": 2.305}, "counters": {"num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 20000}, "done": false, "episodes_total": 68, "training_iteration": 5, "trial_id": "ddfb6_00000", "date": "2024-03-07_12-49-03", "timestamp": 1709833743, "time_this_iter_s": 9.415033102035522, "time_total_s": 44.028151750564575, "pid": 112355, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4d85689f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 44.028151750564575, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 30.299999999999997, "ram_util_percent": 51.45000000000001, "gpu_util_percent0": 0.14166666666666666, "vram_util_percent0": 0.12735324435763887}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 5.9728010949909045, "policy_loss": -0.01773727515371897, "vf_loss": 5.98925758367905, "vf_explained_var": 0.005906633151474819, "kl": 0.006403959340222175, "entropy": 1.051161467131748, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 5115.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000}, "sampler_results": {"episode_reward_max": -6.599999999999989, "episode_reward_min": -69.70000000000041, "episode_reward_mean": -32.963043478261014, "episode_len_mean": 257.20652173913044, "episode_media": {}, "episodes_this_iter": 24, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-63.500000000000504, -48.100000000000364, -61.00000000000038, -24.80000000000006, -55.100000000000435, -67.50000000000037, -63.10000000000035, -8.999999999999991, -46.00000000000024, -8.599999999999982, -67.30000000000032, -55.100000000000286, -6.599999999999989, -52.80000000000038, -56.200000000000266, -48.90000000000031, -59.60000000000035, -52.20000000000033, -55.200000000000365, -69.50000000000048, -54.800000000000466, -48.30000000000026, -8.89999999999998, -48.700000000000344, -28.800000000000114, -47.200000000000294, -7.699999999999985, -48.40000000000024, -30.500000000000043, -53.200000000000244, -45.40000000000011, -8.099999999999984, -64.30000000000034, -23.899999999999984, -48.000000000000405, -22.800000000000086, -43.90000000000031, -23.3, -46.30000000000023, -12.399999999999968, -30.600000000000033, -18.899999999999984, -7.199999999999987, -66.80000000000041, -14.699999999999976, -50.700000000000266, -56.800000000000374, -8.299999999999985, -12.799999999999981, -14.299999999999969, -55.000000000000384, -55.30000000000035, -46.50000000000027, -14.89999999999996, -28.90000000000011, -28.800000000000036, -18.699999999999967, -23.999999999999975, -7.999999999999984, -27.30000000000009, -65.70000000000036, -22.100000000000055, -7.699999999999987, -31.600000000000087, -12.399999999999968, -8.399999999999983, -49.8000000000004, -11.099999999999977, -69.70000000000041, -43.100000000000264, -18.799999999999986, -22.500000000000036, -20.20000000000001, -9.599999999999978, -9.19999999999998, -19.099999999999987, -34.800000000000026, -12.699999999999973, -15.599999999999977, -47.80000000000041, -8.199999999999983, -34.600000000000016, -10.799999999999974, -10.299999999999976, -13.299999999999965, -15.799999999999972, -9.29999999999998, -20.300000000000033, -45.30000000000029, -34.60000000000006, -6.899999999999993, -17.800000000000004], "episode_lengths": [400, 400, 400, 236, 400, 400, 400, 89, 400, 97, 400, 362, 77, 400, 400, 400, 400, 400, 400, 400, 400, 400, 100, 400, 262, 400, 88, 400, 247, 400, 295, 92, 400, 194, 400, 195, 400, 181, 326, 127, 249, 180, 79, 400, 134, 400, 400, 93, 106, 143, 400, 400, 400, 143, 261, 219, 146, 192, 91, 243, 400, 227, 86, 284, 122, 95, 400, 107, 400, 400, 173, 202, 189, 107, 103, 184, 224, 116, 140, 400, 93, 251, 119, 114, 144, 159, 104, 181, 400, 286, 73, 133]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.231963453683143, "mean_inference_ms": 0.7190488428596397, "mean_action_processing_ms": 0.07578341246201507, "mean_env_wait_ms": 6.311011048411222, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007385792939559273, "StateBufferConnector_ms": 0.003977443860924762, "ViewRequirementAgentConnector_ms": 0.09033809537472932}}, "episode_reward_max": -6.599999999999989, "episode_reward_min": -69.70000000000041, "episode_reward_mean": -32.963043478261014, "episode_len_mean": 257.20652173913044, "episodes_this_iter": 24, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-63.500000000000504, -48.100000000000364, -61.00000000000038, -24.80000000000006, -55.100000000000435, -67.50000000000037, -63.10000000000035, -8.999999999999991, -46.00000000000024, -8.599999999999982, -67.30000000000032, -55.100000000000286, -6.599999999999989, -52.80000000000038, -56.200000000000266, -48.90000000000031, -59.60000000000035, -52.20000000000033, -55.200000000000365, -69.50000000000048, -54.800000000000466, -48.30000000000026, -8.89999999999998, -48.700000000000344, -28.800000000000114, -47.200000000000294, -7.699999999999985, -48.40000000000024, -30.500000000000043, -53.200000000000244, -45.40000000000011, -8.099999999999984, -64.30000000000034, -23.899999999999984, -48.000000000000405, -22.800000000000086, -43.90000000000031, -23.3, -46.30000000000023, -12.399999999999968, -30.600000000000033, -18.899999999999984, -7.199999999999987, -66.80000000000041, -14.699999999999976, -50.700000000000266, -56.800000000000374, -8.299999999999985, -12.799999999999981, -14.299999999999969, -55.000000000000384, -55.30000000000035, -46.50000000000027, -14.89999999999996, -28.90000000000011, -28.800000000000036, -18.699999999999967, -23.999999999999975, -7.999999999999984, -27.30000000000009, -65.70000000000036, -22.100000000000055, -7.699999999999987, -31.600000000000087, -12.399999999999968, -8.399999999999983, -49.8000000000004, -11.099999999999977, -69.70000000000041, -43.100000000000264, -18.799999999999986, -22.500000000000036, -20.20000000000001, -9.599999999999978, -9.19999999999998, -19.099999999999987, -34.800000000000026, -12.699999999999973, -15.599999999999977, -47.80000000000041, -8.199999999999983, -34.600000000000016, -10.799999999999974, -10.299999999999976, -13.299999999999965, -15.799999999999972, -9.29999999999998, -20.300000000000033, -45.30000000000029, -34.60000000000006, -6.899999999999993, -17.800000000000004], "episode_lengths": [400, 400, 400, 236, 400, 400, 400, 89, 400, 97, 400, 362, 77, 400, 400, 400, 400, 400, 400, 400, 400, 400, 100, 400, 262, 400, 88, 400, 247, 400, 295, 92, 400, 194, 400, 195, 400, 181, 326, 127, 249, 180, 79, 400, 134, 400, 400, 93, 106, 143, 400, 400, 400, 143, 261, 219, 146, 192, 91, 243, 400, 227, 86, 284, 122, 95, 400, 107, 400, 400, 173, 202, 189, 107, 103, 184, 224, 116, 140, 400, 93, 251, 119, 114, 144, 159, 104, 181, 400, 286, 73, 133]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.231963453683143, "mean_inference_ms": 0.7190488428596397, "mean_action_processing_ms": 0.07578341246201507, "mean_env_wait_ms": 6.311011048411222, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007385792939559273, "StateBufferConnector_ms": 0.003977443860924762, "ViewRequirementAgentConnector_ms": 0.09033809537472932}, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 431.5129569761632, "num_env_steps_trained_throughput_per_sec": 431.5129569761632, "timesteps_total": 24000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 24000, "timers": {"training_iteration_time_ms": 8881.074, "sample_time_ms": 5089.246, "load_time_ms": 0.999, "load_throughput": 4005702.189, "learn_time_ms": 3787.807, "learn_throughput": 1056.02, "synch_weights_time_ms": 2.314}, "counters": {"num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000}, "done": false, "episodes_total": 92, "training_iteration": 6, "trial_id": "ddfb6_00000", "date": "2024-03-07_12-49-12", "timestamp": 1709833752, "time_this_iter_s": 9.272073745727539, "time_total_s": 53.300225496292114, "pid": 112355, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4d85689f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 53.300225496292114, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 32.36666666666667, "ram_util_percent": 52.46666666666666, "gpu_util_percent0": 0.13, "vram_util_percent0": 0.12907579210069445}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 5.396624568649518, "policy_loss": -0.010680482224110634, "vf_loss": 5.405638011745228, "vf_explained_var": -0.09315965951129955, "kl": 0.00833524623994499, "entropy": 1.032855781432121, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 6045.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 28000}, "sampler_results": {"episode_reward_max": -6.599999999999989, "episode_reward_min": -69.70000000000041, "episode_reward_mean": -30.35800000000012, "episode_len_mean": 242.39, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-63.10000000000035, -8.999999999999991, -46.00000000000024, -8.599999999999982, -67.30000000000032, -55.100000000000286, -6.599999999999989, -52.80000000000038, -56.200000000000266, -48.90000000000031, -59.60000000000035, -52.20000000000033, -55.200000000000365, -69.50000000000048, -54.800000000000466, -48.30000000000026, -8.89999999999998, -48.700000000000344, -28.800000000000114, -47.200000000000294, -7.699999999999985, -48.40000000000024, -30.500000000000043, -53.200000000000244, -45.40000000000011, -8.099999999999984, -64.30000000000034, -23.899999999999984, -48.000000000000405, -22.800000000000086, -43.90000000000031, -23.3, -46.30000000000023, -12.399999999999968, -30.600000000000033, -18.899999999999984, -7.199999999999987, -66.80000000000041, -14.699999999999976, -50.700000000000266, -56.800000000000374, -8.299999999999985, -12.799999999999981, -14.299999999999969, -55.000000000000384, -55.30000000000035, -46.50000000000027, -14.89999999999996, -28.90000000000011, -28.800000000000036, -18.699999999999967, -23.999999999999975, -7.999999999999984, -27.30000000000009, -65.70000000000036, -22.100000000000055, -7.699999999999987, -31.600000000000087, -12.399999999999968, -8.399999999999983, -49.8000000000004, -11.099999999999977, -69.70000000000041, -43.100000000000264, -18.799999999999986, -22.500000000000036, -20.20000000000001, -9.599999999999978, -9.19999999999998, -19.099999999999987, -34.800000000000026, -12.699999999999973, -15.599999999999977, -47.80000000000041, -8.199999999999983, -34.600000000000016, -10.799999999999974, -10.299999999999976, -13.299999999999965, -15.799999999999972, -9.29999999999998, -20.300000000000033, -45.30000000000029, -34.60000000000006, -6.899999999999993, -17.800000000000004, -9.599999999999978, -26.400000000000038, -6.999999999999988, -33.60000000000011, -12.499999999999968, -9.999999999999993, -56.400000000000304, -15.799999999999972, -11.399999999999972, -26.400000000000027, -50.80000000000022, -9.49999999999998, -8.999999999999982, -44.800000000000246], "episode_lengths": [400, 89, 400, 97, 400, 362, 77, 400, 400, 400, 400, 400, 400, 400, 400, 400, 100, 400, 262, 400, 88, 400, 247, 400, 295, 92, 400, 194, 400, 195, 400, 181, 326, 127, 249, 180, 79, 400, 134, 400, 400, 93, 106, 143, 400, 400, 400, 143, 261, 219, 146, 192, 91, 243, 400, 227, 86, 284, 122, 95, 400, 107, 400, 400, 173, 202, 189, 107, 103, 184, 224, 116, 140, 400, 93, 251, 119, 114, 144, 159, 104, 181, 400, 286, 73, 133, 107, 223, 81, 308, 127, 92, 400, 158, 125, 228, 400, 100, 90, 373]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23354880226407065, "mean_inference_ms": 0.7210476019622852, "mean_action_processing_ms": 0.07587276178994935, "mean_env_wait_ms": 6.316718663921093, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0072476863861083984, "StateBufferConnector_ms": 0.003966331481933594, "ViewRequirementAgentConnector_ms": 0.0905003547668457}}, "episode_reward_max": -6.599999999999989, "episode_reward_min": -69.70000000000041, "episode_reward_mean": -30.35800000000012, "episode_len_mean": 242.39, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-63.10000000000035, -8.999999999999991, -46.00000000000024, -8.599999999999982, -67.30000000000032, -55.100000000000286, -6.599999999999989, -52.80000000000038, -56.200000000000266, -48.90000000000031, -59.60000000000035, -52.20000000000033, -55.200000000000365, -69.50000000000048, -54.800000000000466, -48.30000000000026, -8.89999999999998, -48.700000000000344, -28.800000000000114, -47.200000000000294, -7.699999999999985, -48.40000000000024, -30.500000000000043, -53.200000000000244, -45.40000000000011, -8.099999999999984, -64.30000000000034, -23.899999999999984, -48.000000000000405, -22.800000000000086, -43.90000000000031, -23.3, -46.30000000000023, -12.399999999999968, -30.600000000000033, -18.899999999999984, -7.199999999999987, -66.80000000000041, -14.699999999999976, -50.700000000000266, -56.800000000000374, -8.299999999999985, -12.799999999999981, -14.299999999999969, -55.000000000000384, -55.30000000000035, -46.50000000000027, -14.89999999999996, -28.90000000000011, -28.800000000000036, -18.699999999999967, -23.999999999999975, -7.999999999999984, -27.30000000000009, -65.70000000000036, -22.100000000000055, -7.699999999999987, -31.600000000000087, -12.399999999999968, -8.399999999999983, -49.8000000000004, -11.099999999999977, -69.70000000000041, -43.100000000000264, -18.799999999999986, -22.500000000000036, -20.20000000000001, -9.599999999999978, -9.19999999999998, -19.099999999999987, -34.800000000000026, -12.699999999999973, -15.599999999999977, -47.80000000000041, -8.199999999999983, -34.600000000000016, -10.799999999999974, -10.299999999999976, -13.299999999999965, -15.799999999999972, -9.29999999999998, -20.300000000000033, -45.30000000000029, -34.60000000000006, -6.899999999999993, -17.800000000000004, -9.599999999999978, -26.400000000000038, -6.999999999999988, -33.60000000000011, -12.499999999999968, -9.999999999999993, -56.400000000000304, -15.799999999999972, -11.399999999999972, -26.400000000000027, -50.80000000000022, -9.49999999999998, -8.999999999999982, -44.800000000000246], "episode_lengths": [400, 89, 400, 97, 400, 362, 77, 400, 400, 400, 400, 400, 400, 400, 400, 400, 100, 400, 262, 400, 88, 400, 247, 400, 295, 92, 400, 194, 400, 195, 400, 181, 326, 127, 249, 180, 79, 400, 134, 400, 400, 93, 106, 143, 400, 400, 400, 143, 261, 219, 146, 192, 91, 243, 400, 227, 86, 284, 122, 95, 400, 107, 400, 400, 173, 202, 189, 107, 103, 184, 224, 116, 140, 400, 93, 251, 119, 114, 144, 159, 104, 181, 400, 286, 73, 133, 107, 223, 81, 308, 127, 92, 400, 158, 125, 228, 400, 100, 90, 373]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23354880226407065, "mean_inference_ms": 0.7210476019622852, "mean_action_processing_ms": 0.07587276178994935, "mean_env_wait_ms": 6.316718663921093, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0072476863861083984, "StateBufferConnector_ms": 0.003966331481933594, "ViewRequirementAgentConnector_ms": 0.0905003547668457}, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 28000, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 460.40390763917617, "num_env_steps_trained_throughput_per_sec": 460.40390763917617, "timesteps_total": 28000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 28000, "timers": {"training_iteration_time_ms": 8853.491, "sample_time_ms": 5074.915, "load_time_ms": 0.992, "load_throughput": 4033261.625, "learn_time_ms": 3774.63, "learn_throughput": 1059.706, "synch_weights_time_ms": 2.261}, "counters": {"num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 28000}, "done": false, "episodes_total": 106, "training_iteration": 7, "trial_id": "ddfb6_00000", "date": "2024-03-07_12-49-21", "timestamp": 1709833761, "time_this_iter_s": 8.690312147140503, "time_total_s": 61.99053764343262, "pid": 112355, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4d85689f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 61.99053764343262, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 26.909090909090903, "ram_util_percent": 52.22727272727273, "gpu_util_percent0": 0.08727272727272727, "vram_util_percent0": 0.12642785274621213}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 4.601938177757366, "policy_loss": -0.01779723422782075, "vf_loss": 4.618116381091456, "vf_explained_var": -0.039497283581764464, "kl": 0.00809521640293337, "entropy": 1.0147909547052076, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 6975.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000}, "sampler_results": {"episode_reward_max": -6.899999999999993, "episode_reward_min": -69.70000000000041, "episode_reward_mean": -26.318000000000087, "episode_len_mean": 219.95, "episode_media": {}, "episodes_this_iter": 22, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-30.500000000000043, -53.200000000000244, -45.40000000000011, -8.099999999999984, -64.30000000000034, -23.899999999999984, -48.000000000000405, -22.800000000000086, -43.90000000000031, -23.3, -46.30000000000023, -12.399999999999968, -30.600000000000033, -18.899999999999984, -7.199999999999987, -66.80000000000041, -14.699999999999976, -50.700000000000266, -56.800000000000374, -8.299999999999985, -12.799999999999981, -14.299999999999969, -55.000000000000384, -55.30000000000035, -46.50000000000027, -14.89999999999996, -28.90000000000011, -28.800000000000036, -18.699999999999967, -23.999999999999975, -7.999999999999984, -27.30000000000009, -65.70000000000036, -22.100000000000055, -7.699999999999987, -31.600000000000087, -12.399999999999968, -8.399999999999983, -49.8000000000004, -11.099999999999977, -69.70000000000041, -43.100000000000264, -18.799999999999986, -22.500000000000036, -20.20000000000001, -9.599999999999978, -9.19999999999998, -19.099999999999987, -34.800000000000026, -12.699999999999973, -15.599999999999977, -47.80000000000041, -8.199999999999983, -34.600000000000016, -10.799999999999974, -10.299999999999976, -13.299999999999965, -15.799999999999972, -9.29999999999998, -20.300000000000033, -45.30000000000029, -34.60000000000006, -6.899999999999993, -17.800000000000004, -9.599999999999978, -26.400000000000038, -6.999999999999988, -33.60000000000011, -12.499999999999968, -9.999999999999993, -56.400000000000304, -15.799999999999972, -11.399999999999972, -26.400000000000027, -50.80000000000022, -9.49999999999998, -8.999999999999982, -44.800000000000246, -47.90000000000023, -13.499999999999964, -13.39999999999997, -16.999999999999993, -12.699999999999967, -42.30000000000028, -9.099999999999982, -10.899999999999979, -42.60000000000019, -26.20000000000003, -10.999999999999973, -37.400000000000205, -7.5999999999999925, -11.89999999999997, -39.500000000000185, -53.70000000000044, -39.00000000000008, -18.899999999999956, -44.00000000000025, -15.299999999999965, -10.399999999999975, -14.599999999999962], "episode_lengths": [247, 400, 295, 92, 400, 194, 400, 195, 400, 181, 326, 127, 249, 180, 79, 400, 134, 400, 400, 93, 106, 143, 400, 400, 400, 143, 261, 219, 146, 192, 91, 243, 400, 227, 86, 284, 122, 95, 400, 107, 400, 400, 173, 202, 189, 107, 103, 184, 224, 116, 140, 400, 93, 251, 119, 114, 144, 159, 104, 181, 400, 286, 73, 133, 107, 223, 81, 308, 127, 92, 400, 158, 125, 228, 400, 100, 90, 373, 400, 146, 121, 166, 138, 400, 93, 113, 339, 235, 121, 344, 77, 127, 358, 400, 322, 172, 350, 163, 115, 131]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.236919224084346, "mean_inference_ms": 0.725962327371513, "mean_action_processing_ms": 0.07613459721908115, "mean_env_wait_ms": 6.329290265316172, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007227659225463867, "StateBufferConnector_ms": 0.00405120849609375, "ViewRequirementAgentConnector_ms": 0.09209227561950684}}, "episode_reward_max": -6.899999999999993, "episode_reward_min": -69.70000000000041, "episode_reward_mean": -26.318000000000087, "episode_len_mean": 219.95, "episodes_this_iter": 22, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-30.500000000000043, -53.200000000000244, -45.40000000000011, -8.099999999999984, -64.30000000000034, -23.899999999999984, -48.000000000000405, -22.800000000000086, -43.90000000000031, -23.3, -46.30000000000023, -12.399999999999968, -30.600000000000033, -18.899999999999984, -7.199999999999987, -66.80000000000041, -14.699999999999976, -50.700000000000266, -56.800000000000374, -8.299999999999985, -12.799999999999981, -14.299999999999969, -55.000000000000384, -55.30000000000035, -46.50000000000027, -14.89999999999996, -28.90000000000011, -28.800000000000036, -18.699999999999967, -23.999999999999975, -7.999999999999984, -27.30000000000009, -65.70000000000036, -22.100000000000055, -7.699999999999987, -31.600000000000087, -12.399999999999968, -8.399999999999983, -49.8000000000004, -11.099999999999977, -69.70000000000041, -43.100000000000264, -18.799999999999986, -22.500000000000036, -20.20000000000001, -9.599999999999978, -9.19999999999998, -19.099999999999987, -34.800000000000026, -12.699999999999973, -15.599999999999977, -47.80000000000041, -8.199999999999983, -34.600000000000016, -10.799999999999974, -10.299999999999976, -13.299999999999965, -15.799999999999972, -9.29999999999998, -20.300000000000033, -45.30000000000029, -34.60000000000006, -6.899999999999993, -17.800000000000004, -9.599999999999978, -26.400000000000038, -6.999999999999988, -33.60000000000011, -12.499999999999968, -9.999999999999993, -56.400000000000304, -15.799999999999972, -11.399999999999972, -26.400000000000027, -50.80000000000022, -9.49999999999998, -8.999999999999982, -44.800000000000246, -47.90000000000023, -13.499999999999964, -13.39999999999997, -16.999999999999993, -12.699999999999967, -42.30000000000028, -9.099999999999982, -10.899999999999979, -42.60000000000019, -26.20000000000003, -10.999999999999973, -37.400000000000205, -7.5999999999999925, -11.89999999999997, -39.500000000000185, -53.70000000000044, -39.00000000000008, -18.899999999999956, -44.00000000000025, -15.299999999999965, -10.399999999999975, -14.599999999999962], "episode_lengths": [247, 400, 295, 92, 400, 194, 400, 195, 400, 181, 326, 127, 249, 180, 79, 400, 134, 400, 400, 93, 106, 143, 400, 400, 400, 143, 261, 219, 146, 192, 91, 243, 400, 227, 86, 284, 122, 95, 400, 107, 400, 400, 173, 202, 189, 107, 103, 184, 224, 116, 140, 400, 93, 251, 119, 114, 144, 159, 104, 181, 400, 286, 73, 133, 107, 223, 81, 308, 127, 92, 400, 158, 125, 228, 400, 100, 90, 373, 400, 146, 121, 166, 138, 400, 93, 113, 339, 235, 121, 344, 77, 127, 358, 400, 322, 172, 350, 163, 115, 131]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.236919224084346, "mean_inference_ms": 0.725962327371513, "mean_action_processing_ms": 0.07613459721908115, "mean_env_wait_ms": 6.329290265316172, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007227659225463867, "StateBufferConnector_ms": 0.00405120849609375, "ViewRequirementAgentConnector_ms": 0.09209227561950684}, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 444.77196074042587, "num_env_steps_trained_throughput_per_sec": 444.77196074042587, "timesteps_total": 32000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 32000, "timers": {"training_iteration_time_ms": 8870.972, "sample_time_ms": 5074.019, "load_time_ms": 1.018, "load_throughput": 3929205.422, "learn_time_ms": 3793.009, "learn_throughput": 1054.572, "synch_weights_time_ms": 2.241}, "counters": {"num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000}, "done": false, "episodes_total": 128, "training_iteration": 8, "trial_id": "ddfb6_00000", "date": "2024-03-07_12-49-30", "timestamp": 1709833770, "time_this_iter_s": 8.995688438415527, "time_total_s": 70.98622608184814, "pid": 112355, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4d85689f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 70.98622608184814, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 28.874999999999996, "ram_util_percent": 52.25833333333333, "gpu_util_percent0": 0.13166666666666665, "vram_util_percent0": 0.12843831380208337}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 4.898794942229025, "policy_loss": -0.008395655022593596, "vf_loss": 4.9058234477235425, "vf_explained_var": -0.043284356529994676, "kl": 0.006835730466477119, "entropy": 1.0154542462800138, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 7905.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000}, "sampler_results": {"episode_reward_max": -5.399999999999993, "episode_reward_min": -69.70000000000041, "episode_reward_mean": -24.35400000000007, "episode_len_mean": 209.2, "episode_media": {}, "episodes_this_iter": 20, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-12.799999999999981, -14.299999999999969, -55.000000000000384, -55.30000000000035, -46.50000000000027, -14.89999999999996, -28.90000000000011, -28.800000000000036, -18.699999999999967, -23.999999999999975, -7.999999999999984, -27.30000000000009, -65.70000000000036, -22.100000000000055, -7.699999999999987, -31.600000000000087, -12.399999999999968, -8.399999999999983, -49.8000000000004, -11.099999999999977, -69.70000000000041, -43.100000000000264, -18.799999999999986, -22.500000000000036, -20.20000000000001, -9.599999999999978, -9.19999999999998, -19.099999999999987, -34.800000000000026, -12.699999999999973, -15.599999999999977, -47.80000000000041, -8.199999999999983, -34.600000000000016, -10.799999999999974, -10.299999999999976, -13.299999999999965, -15.799999999999972, -9.29999999999998, -20.300000000000033, -45.30000000000029, -34.60000000000006, -6.899999999999993, -17.800000000000004, -9.599999999999978, -26.400000000000038, -6.999999999999988, -33.60000000000011, -12.499999999999968, -9.999999999999993, -56.400000000000304, -15.799999999999972, -11.399999999999972, -26.400000000000027, -50.80000000000022, -9.49999999999998, -8.999999999999982, -44.800000000000246, -47.90000000000023, -13.499999999999964, -13.39999999999997, -16.999999999999993, -12.699999999999967, -42.30000000000028, -9.099999999999982, -10.899999999999979, -42.60000000000019, -26.20000000000003, -10.999999999999973, -37.400000000000205, -7.5999999999999925, -11.89999999999997, -39.500000000000185, -53.70000000000044, -39.00000000000008, -18.899999999999956, -44.00000000000025, -15.299999999999965, -10.399999999999975, -14.599999999999962, -31.100000000000037, -22.400000000000077, -16.699999999999967, -14.899999999999975, -20.999999999999975, -40.1000000000003, -31.800000000000082, -7.0999999999999925, -12.599999999999984, -15.09999999999997, -5.399999999999993, -10.899999999999979, -18.0, -49.00000000000034, -16.899999999999995, -56.00000000000039, -9.999999999999977, -16.299999999999965, -60.90000000000047, -23.500000000000078], "episode_lengths": [106, 143, 400, 400, 400, 143, 261, 219, 146, 192, 91, 243, 400, 227, 86, 284, 122, 95, 400, 107, 400, 400, 173, 202, 189, 107, 103, 184, 224, 116, 140, 400, 93, 251, 119, 114, 144, 159, 104, 181, 400, 286, 73, 133, 107, 223, 81, 308, 127, 92, 400, 158, 125, 228, 400, 100, 90, 373, 400, 146, 121, 166, 138, 400, 93, 113, 339, 235, 121, 344, 77, 127, 358, 400, 322, 172, 350, 163, 115, 131, 271, 210, 128, 128, 190, 400, 289, 76, 101, 135, 65, 105, 185, 393, 168, 400, 111, 129, 400, 233]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2393943706386343, "mean_inference_ms": 0.7299399519648929, "mean_action_processing_ms": 0.07642720310904381, "mean_env_wait_ms": 6.342925762921014, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007168292999267578, "StateBufferConnector_ms": 0.004014015197753906, "ViewRequirementAgentConnector_ms": 0.0921475887298584}}, "episode_reward_max": -5.399999999999993, "episode_reward_min": -69.70000000000041, "episode_reward_mean": -24.35400000000007, "episode_len_mean": 209.2, "episodes_this_iter": 20, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-12.799999999999981, -14.299999999999969, -55.000000000000384, -55.30000000000035, -46.50000000000027, -14.89999999999996, -28.90000000000011, -28.800000000000036, -18.699999999999967, -23.999999999999975, -7.999999999999984, -27.30000000000009, -65.70000000000036, -22.100000000000055, -7.699999999999987, -31.600000000000087, -12.399999999999968, -8.399999999999983, -49.8000000000004, -11.099999999999977, -69.70000000000041, -43.100000000000264, -18.799999999999986, -22.500000000000036, -20.20000000000001, -9.599999999999978, -9.19999999999998, -19.099999999999987, -34.800000000000026, -12.699999999999973, -15.599999999999977, -47.80000000000041, -8.199999999999983, -34.600000000000016, -10.799999999999974, -10.299999999999976, -13.299999999999965, -15.799999999999972, -9.29999999999998, -20.300000000000033, -45.30000000000029, -34.60000000000006, -6.899999999999993, -17.800000000000004, -9.599999999999978, -26.400000000000038, -6.999999999999988, -33.60000000000011, -12.499999999999968, -9.999999999999993, -56.400000000000304, -15.799999999999972, -11.399999999999972, -26.400000000000027, -50.80000000000022, -9.49999999999998, -8.999999999999982, -44.800000000000246, -47.90000000000023, -13.499999999999964, -13.39999999999997, -16.999999999999993, -12.699999999999967, -42.30000000000028, -9.099999999999982, -10.899999999999979, -42.60000000000019, -26.20000000000003, -10.999999999999973, -37.400000000000205, -7.5999999999999925, -11.89999999999997, -39.500000000000185, -53.70000000000044, -39.00000000000008, -18.899999999999956, -44.00000000000025, -15.299999999999965, -10.399999999999975, -14.599999999999962, -31.100000000000037, -22.400000000000077, -16.699999999999967, -14.899999999999975, -20.999999999999975, -40.1000000000003, -31.800000000000082, -7.0999999999999925, -12.599999999999984, -15.09999999999997, -5.399999999999993, -10.899999999999979, -18.0, -49.00000000000034, -16.899999999999995, -56.00000000000039, -9.999999999999977, -16.299999999999965, -60.90000000000047, -23.500000000000078], "episode_lengths": [106, 143, 400, 400, 400, 143, 261, 219, 146, 192, 91, 243, 400, 227, 86, 284, 122, 95, 400, 107, 400, 400, 173, 202, 189, 107, 103, 184, 224, 116, 140, 400, 93, 251, 119, 114, 144, 159, 104, 181, 400, 286, 73, 133, 107, 223, 81, 308, 127, 92, 400, 158, 125, 228, 400, 100, 90, 373, 400, 146, 121, 166, 138, 400, 93, 113, 339, 235, 121, 344, 77, 127, 358, 400, 322, 172, 350, 163, 115, 131, 271, 210, 128, 128, 190, 400, 289, 76, 101, 135, 65, 105, 185, 393, 168, 400, 111, 129, 400, 233]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2393943706386343, "mean_inference_ms": 0.7299399519648929, "mean_action_processing_ms": 0.07642720310904381, "mean_env_wait_ms": 6.342925762921014, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007168292999267578, "StateBufferConnector_ms": 0.004014015197753906, "ViewRequirementAgentConnector_ms": 0.0921475887298584}, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 466.06255714068124, "num_env_steps_trained_throughput_per_sec": 466.06255714068124, "timesteps_total": 36000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 36000, "timers": {"training_iteration_time_ms": 8838.92, "sample_time_ms": 5067.682, "load_time_ms": 1.011, "load_throughput": 3955853.917, "learn_time_ms": 3767.335, "learn_throughput": 1061.759, "synch_weights_time_ms": 2.218}, "counters": {"num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000}, "done": false, "episodes_total": 148, "training_iteration": 9, "trial_id": "ddfb6_00000", "date": "2024-03-07_12-49-39", "timestamp": 1709833779, "time_this_iter_s": 8.58470869064331, "time_total_s": 79.57093477249146, "pid": 112355, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4d85689f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 79.57093477249146, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 27.11818181818182, "ram_util_percent": 52.445454545454545, "gpu_util_percent0": 0.10090909090909089, "vram_util_percent0": 0.1296312736742424}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 5.742995225191517, "policy_loss": -0.01458425421908658, "vf_loss": 5.756088835481674, "vf_explained_var": 0.14915744470011805, "kl": 0.007453257171970678, "entropy": 1.01757592193542, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 8835.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000}, "sampler_results": {"episode_reward_max": -3.799999999999999, "episode_reward_min": -60.90000000000047, "episode_reward_mean": -21.343000000000053, "episode_len_mean": 190.57, "episode_media": {}, "episodes_this_iter": 23, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-22.500000000000036, -20.20000000000001, -9.599999999999978, -9.19999999999998, -19.099999999999987, -34.800000000000026, -12.699999999999973, -15.599999999999977, -47.80000000000041, -8.199999999999983, -34.600000000000016, -10.799999999999974, -10.299999999999976, -13.299999999999965, -15.799999999999972, -9.29999999999998, -20.300000000000033, -45.30000000000029, -34.60000000000006, -6.899999999999993, -17.800000000000004, -9.599999999999978, -26.400000000000038, -6.999999999999988, -33.60000000000011, -12.499999999999968, -9.999999999999993, -56.400000000000304, -15.799999999999972, -11.399999999999972, -26.400000000000027, -50.80000000000022, -9.49999999999998, -8.999999999999982, -44.800000000000246, -47.90000000000023, -13.499999999999964, -13.39999999999997, -16.999999999999993, -12.699999999999967, -42.30000000000028, -9.099999999999982, -10.899999999999979, -42.60000000000019, -26.20000000000003, -10.999999999999973, -37.400000000000205, -7.5999999999999925, -11.89999999999997, -39.500000000000185, -53.70000000000044, -39.00000000000008, -18.899999999999956, -44.00000000000025, -15.299999999999965, -10.399999999999975, -14.599999999999962, -31.100000000000037, -22.400000000000077, -16.699999999999967, -14.899999999999975, -20.999999999999975, -40.1000000000003, -31.800000000000082, -7.0999999999999925, -12.599999999999984, -15.09999999999997, -5.399999999999993, -10.899999999999979, -18.0, -49.00000000000034, -16.899999999999995, -56.00000000000039, -9.999999999999977, -16.299999999999965, -60.90000000000047, -23.500000000000078, -10.399999999999975, -29.000000000000135, -7.199999999999987, -11.399999999999972, -3.799999999999999, -43.2000000000003, -14.899999999999968, -23.400000000000066, -13.299999999999965, -8.299999999999983, -17.999999999999975, -10.799999999999974, -10.699999999999974, -25.80000000000003, -9.599999999999978, -18.8, -8.699999999999987, -17.1, -7.89999999999999, -17.8, -8.199999999999985, -13.399999999999972, -42.1000000000002], "episode_lengths": [202, 189, 107, 103, 184, 224, 116, 140, 400, 93, 251, 119, 114, 144, 159, 104, 181, 400, 286, 73, 133, 107, 223, 81, 308, 127, 92, 400, 158, 125, 228, 400, 100, 90, 373, 400, 146, 121, 166, 138, 400, 93, 113, 339, 235, 121, 344, 77, 127, 358, 400, 322, 172, 350, 163, 115, 131, 271, 210, 128, 128, 190, 400, 289, 76, 101, 135, 65, 105, 185, 393, 168, 400, 111, 129, 400, 233, 114, 281, 83, 125, 49, 368, 125, 235, 144, 94, 165, 115, 107, 227, 107, 171, 88, 160, 80, 172, 92, 126, 347]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24145014407343876, "mean_inference_ms": 0.7321425223772492, "mean_action_processing_ms": 0.07657148416298744, "mean_env_wait_ms": 6.342009024849136, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006990671157836914, "StateBufferConnector_ms": 0.003960132598876953, "ViewRequirementAgentConnector_ms": 0.09113621711730957}}, "episode_reward_max": -3.799999999999999, "episode_reward_min": -60.90000000000047, "episode_reward_mean": -21.343000000000053, "episode_len_mean": 190.57, "episodes_this_iter": 23, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-22.500000000000036, -20.20000000000001, -9.599999999999978, -9.19999999999998, -19.099999999999987, -34.800000000000026, -12.699999999999973, -15.599999999999977, -47.80000000000041, -8.199999999999983, -34.600000000000016, -10.799999999999974, -10.299999999999976, -13.299999999999965, -15.799999999999972, -9.29999999999998, -20.300000000000033, -45.30000000000029, -34.60000000000006, -6.899999999999993, -17.800000000000004, -9.599999999999978, -26.400000000000038, -6.999999999999988, -33.60000000000011, -12.499999999999968, -9.999999999999993, -56.400000000000304, -15.799999999999972, -11.399999999999972, -26.400000000000027, -50.80000000000022, -9.49999999999998, -8.999999999999982, -44.800000000000246, -47.90000000000023, -13.499999999999964, -13.39999999999997, -16.999999999999993, -12.699999999999967, -42.30000000000028, -9.099999999999982, -10.899999999999979, -42.60000000000019, -26.20000000000003, -10.999999999999973, -37.400000000000205, -7.5999999999999925, -11.89999999999997, -39.500000000000185, -53.70000000000044, -39.00000000000008, -18.899999999999956, -44.00000000000025, -15.299999999999965, -10.399999999999975, -14.599999999999962, -31.100000000000037, -22.400000000000077, -16.699999999999967, -14.899999999999975, -20.999999999999975, -40.1000000000003, -31.800000000000082, -7.0999999999999925, -12.599999999999984, -15.09999999999997, -5.399999999999993, -10.899999999999979, -18.0, -49.00000000000034, -16.899999999999995, -56.00000000000039, -9.999999999999977, -16.299999999999965, -60.90000000000047, -23.500000000000078, -10.399999999999975, -29.000000000000135, -7.199999999999987, -11.399999999999972, -3.799999999999999, -43.2000000000003, -14.899999999999968, -23.400000000000066, -13.299999999999965, -8.299999999999983, -17.999999999999975, -10.799999999999974, -10.699999999999974, -25.80000000000003, -9.599999999999978, -18.8, -8.699999999999987, -17.1, -7.89999999999999, -17.8, -8.199999999999985, -13.399999999999972, -42.1000000000002], "episode_lengths": [202, 189, 107, 103, 184, 224, 116, 140, 400, 93, 251, 119, 114, 144, 159, 104, 181, 400, 286, 73, 133, 107, 223, 81, 308, 127, 92, 400, 158, 125, 228, 400, 100, 90, 373, 400, 146, 121, 166, 138, 400, 93, 113, 339, 235, 121, 344, 77, 127, 358, 400, 322, 172, 350, 163, 115, 131, 271, 210, 128, 128, 190, 400, 289, 76, 101, 135, 65, 105, 185, 393, 168, 400, 111, 129, 400, 233, 114, 281, 83, 125, 49, 368, 125, 235, 144, 94, 165, 115, 107, 227, 107, 171, 88, 160, 80, 172, 92, 126, 347]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24145014407343876, "mean_inference_ms": 0.7321425223772492, "mean_action_processing_ms": 0.07657148416298744, "mean_env_wait_ms": 6.342009024849136, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006990671157836914, "StateBufferConnector_ms": 0.003960132598876953, "ViewRequirementAgentConnector_ms": 0.09113621711730957}, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 462.6748355839112, "num_env_steps_trained_throughput_per_sec": 462.6748355839112, "timesteps_total": 40000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 40000, "timers": {"training_iteration_time_ms": 8819.561, "sample_time_ms": 5054.465, "load_time_ms": 1.037, "load_throughput": 3855944.84, "learn_time_ms": 3761.13, "learn_throughput": 1063.51, "synch_weights_time_ms": 2.233}, "counters": {"num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000}, "done": false, "episodes_total": 171, "training_iteration": 10, "trial_id": "ddfb6_00000", "date": "2024-03-07_12-49-47", "timestamp": 1709833787, "time_this_iter_s": 8.648093938827515, "time_total_s": 88.21902871131897, "pid": 112355, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4d85689f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 88.21902871131897, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 26.900000000000002, "ram_util_percent": 52.381818181818176, "gpu_util_percent0": 0.0818181818181818, "vram_util_percent0": 0.12906161221590906}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 4.949570225875184, "policy_loss": -0.004419053568234367, "vf_loss": 4.952690134157416, "vf_explained_var": 0.13095356341331235, "kl": 0.006495682616443026, "entropy": 1.001113753164968, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 9765.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_agent_steps_sampled": 44000, "num_agent_steps_trained": 44000}, "sampler_results": {"episode_reward_max": -3.799999999999999, "episode_reward_min": -60.90000000000047, "episode_reward_mean": -21.34200000000005, "episode_len_mean": 189.99, "episode_media": {}, "episodes_this_iter": 26, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-9.999999999999993, -56.400000000000304, -15.799999999999972, -11.399999999999972, -26.400000000000027, -50.80000000000022, -9.49999999999998, -8.999999999999982, -44.800000000000246, -47.90000000000023, -13.499999999999964, -13.39999999999997, -16.999999999999993, -12.699999999999967, -42.30000000000028, -9.099999999999982, -10.899999999999979, -42.60000000000019, -26.20000000000003, -10.999999999999973, -37.400000000000205, -7.5999999999999925, -11.89999999999997, -39.500000000000185, -53.70000000000044, -39.00000000000008, -18.899999999999956, -44.00000000000025, -15.299999999999965, -10.399999999999975, -14.599999999999962, -31.100000000000037, -22.400000000000077, -16.699999999999967, -14.899999999999975, -20.999999999999975, -40.1000000000003, -31.800000000000082, -7.0999999999999925, -12.599999999999984, -15.09999999999997, -5.399999999999993, -10.899999999999979, -18.0, -49.00000000000034, -16.899999999999995, -56.00000000000039, -9.999999999999977, -16.299999999999965, -60.90000000000047, -23.500000000000078, -10.399999999999975, -29.000000000000135, -7.199999999999987, -11.399999999999972, -3.799999999999999, -43.2000000000003, -14.899999999999968, -23.400000000000066, -13.299999999999965, -8.299999999999983, -17.999999999999975, -10.799999999999974, -10.699999999999974, -25.80000000000003, -9.599999999999978, -18.8, -8.699999999999987, -17.1, -7.89999999999999, -17.8, -8.199999999999985, -13.399999999999972, -42.1000000000002, -15.599999999999977, -9.899999999999983, -26.799999999999994, -33.70000000000015, -12.199999999999969, -43.50000000000016, -11.499999999999979, -8.89999999999998, -15.099999999999959, -11.59999999999998, -20.500000000000004, -28.500000000000078, -48.200000000000294, -11.39999999999998, -12.399999999999968, -4.899999999999995, -7.399999999999986, -13.299999999999965, -9.099999999999982, -4.1999999999999975, -59.200000000000394, -41.30000000000024, -13.49999999999997, -7.799999999999985, -8.699999999999983, -28.50000000000008], "episode_lengths": [92, 400, 158, 125, 228, 400, 100, 90, 373, 400, 146, 121, 166, 138, 400, 93, 113, 339, 235, 121, 344, 77, 127, 358, 400, 322, 172, 350, 163, 115, 131, 271, 210, 128, 128, 190, 400, 289, 76, 101, 135, 65, 105, 185, 393, 168, 400, 111, 129, 400, 233, 114, 281, 83, 125, 49, 368, 125, 235, 144, 94, 165, 115, 107, 227, 107, 171, 88, 160, 80, 172, 92, 126, 347, 148, 95, 222, 305, 126, 353, 113, 88, 151, 109, 192, 251, 400, 98, 127, 60, 85, 129, 96, 47, 400, 358, 112, 89, 86, 270]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2421868245700327, "mean_inference_ms": 0.7317408735667921, "mean_action_processing_ms": 0.07646746377157361, "mean_env_wait_ms": 6.327130729791529, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006805896759033203, "StateBufferConnector_ms": 0.0038585662841796875, "ViewRequirementAgentConnector_ms": 0.0895683765411377}}, "episode_reward_max": -3.799999999999999, "episode_reward_min": -60.90000000000047, "episode_reward_mean": -21.34200000000005, "episode_len_mean": 189.99, "episodes_this_iter": 26, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-9.999999999999993, -56.400000000000304, -15.799999999999972, -11.399999999999972, -26.400000000000027, -50.80000000000022, -9.49999999999998, -8.999999999999982, -44.800000000000246, -47.90000000000023, -13.499999999999964, -13.39999999999997, -16.999999999999993, -12.699999999999967, -42.30000000000028, -9.099999999999982, -10.899999999999979, -42.60000000000019, -26.20000000000003, -10.999999999999973, -37.400000000000205, -7.5999999999999925, -11.89999999999997, -39.500000000000185, -53.70000000000044, -39.00000000000008, -18.899999999999956, -44.00000000000025, -15.299999999999965, -10.399999999999975, -14.599999999999962, -31.100000000000037, -22.400000000000077, -16.699999999999967, -14.899999999999975, -20.999999999999975, -40.1000000000003, -31.800000000000082, -7.0999999999999925, -12.599999999999984, -15.09999999999997, -5.399999999999993, -10.899999999999979, -18.0, -49.00000000000034, -16.899999999999995, -56.00000000000039, -9.999999999999977, -16.299999999999965, -60.90000000000047, -23.500000000000078, -10.399999999999975, -29.000000000000135, -7.199999999999987, -11.399999999999972, -3.799999999999999, -43.2000000000003, -14.899999999999968, -23.400000000000066, -13.299999999999965, -8.299999999999983, -17.999999999999975, -10.799999999999974, -10.699999999999974, -25.80000000000003, -9.599999999999978, -18.8, -8.699999999999987, -17.1, -7.89999999999999, -17.8, -8.199999999999985, -13.399999999999972, -42.1000000000002, -15.599999999999977, -9.899999999999983, -26.799999999999994, -33.70000000000015, -12.199999999999969, -43.50000000000016, -11.499999999999979, -8.89999999999998, -15.099999999999959, -11.59999999999998, -20.500000000000004, -28.500000000000078, -48.200000000000294, -11.39999999999998, -12.399999999999968, -4.899999999999995, -7.399999999999986, -13.299999999999965, -9.099999999999982, -4.1999999999999975, -59.200000000000394, -41.30000000000024, -13.49999999999997, -7.799999999999985, -8.699999999999983, -28.50000000000008], "episode_lengths": [92, 400, 158, 125, 228, 400, 100, 90, 373, 400, 146, 121, 166, 138, 400, 93, 113, 339, 235, 121, 344, 77, 127, 358, 400, 322, 172, 350, 163, 115, 131, 271, 210, 128, 128, 190, 400, 289, 76, 101, 135, 65, 105, 185, 393, 168, 400, 111, 129, 400, 233, 114, 281, 83, 125, 49, 368, 125, 235, 144, 94, 165, 115, 107, 227, 107, 171, 88, 160, 80, 172, 92, 126, 347, 148, 95, 222, 305, 126, 353, 113, 88, 151, 109, 192, 251, 400, 98, 127, 60, 85, 129, 96, 47, 400, 358, 112, 89, 86, 270]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2421868245700327, "mean_inference_ms": 0.7317408735667921, "mean_action_processing_ms": 0.07646746377157361, "mean_env_wait_ms": 6.327130729791529, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006805896759033203, "StateBufferConnector_ms": 0.0038585662841796875, "ViewRequirementAgentConnector_ms": 0.0895683765411377}, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 44000, "num_agent_steps_trained": 44000, "num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 456.8632008196582, "num_env_steps_trained_throughput_per_sec": 456.8632008196582, "timesteps_total": 44000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 44000, "timers": {"training_iteration_time_ms": 8829.562, "sample_time_ms": 5063.327, "load_time_ms": 1.038, "load_throughput": 3852137.855, "learn_time_ms": 3762.28, "learn_throughput": 1063.185, "synch_weights_time_ms": 2.237}, "counters": {"num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_agent_steps_sampled": 44000, "num_agent_steps_trained": 44000}, "done": false, "episodes_total": 197, "training_iteration": 11, "trial_id": "ddfb6_00000", "date": "2024-03-07_12-49-56", "timestamp": 1709833796, "time_this_iter_s": 8.757811546325684, "time_total_s": 96.97684025764465, "pid": 112355, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4d85689f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 96.97684025764465, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 25.483333333333334, "ram_util_percent": 52.29999999999999, "gpu_util_percent0": 0.10583333333333333, "vram_util_percent0": 0.1290825737847222}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 3.791200778240799, "policy_loss": -0.007067661207690034, "vf_loss": 3.7969863784569564, "vf_explained_var": 0.22630623764889216, "kl": 0.006410256749004604, "entropy": 0.9679764163109564, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 10695.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000}, "sampler_results": {"episode_reward_max": -3.3000000000000007, "episode_reward_min": -60.90000000000047, "episode_reward_mean": -17.87900000000003, "episode_len_mean": 161.86, "episode_media": {}, "episodes_this_iter": 29, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10.399999999999975, -14.599999999999962, -31.100000000000037, -22.400000000000077, -16.699999999999967, -14.899999999999975, -20.999999999999975, -40.1000000000003, -31.800000000000082, -7.0999999999999925, -12.599999999999984, -15.09999999999997, -5.399999999999993, -10.899999999999979, -18.0, -49.00000000000034, -16.899999999999995, -56.00000000000039, -9.999999999999977, -16.299999999999965, -60.90000000000047, -23.500000000000078, -10.399999999999975, -29.000000000000135, -7.199999999999987, -11.399999999999972, -3.799999999999999, -43.2000000000003, -14.899999999999968, -23.400000000000066, -13.299999999999965, -8.299999999999983, -17.999999999999975, -10.799999999999974, -10.699999999999974, -25.80000000000003, -9.599999999999978, -18.8, -8.699999999999987, -17.1, -7.89999999999999, -17.8, -8.199999999999985, -13.399999999999972, -42.1000000000002, -15.599999999999977, -9.899999999999983, -26.799999999999994, -33.70000000000015, -12.199999999999969, -43.50000000000016, -11.499999999999979, -8.89999999999998, -15.099999999999959, -11.59999999999998, -20.500000000000004, -28.500000000000078, -48.200000000000294, -11.39999999999998, -12.399999999999968, -4.899999999999995, -7.399999999999986, -13.299999999999965, -9.099999999999982, -4.1999999999999975, -59.200000000000394, -41.30000000000024, -13.49999999999997, -7.799999999999985, -8.699999999999983, -28.50000000000008, -14.499999999999961, -6.0999999999999925, -8.299999999999988, -13.699999999999969, -9.299999999999981, -26.299999999999997, -9.499999999999979, -16.099999999999977, -20.29999999999997, -10.199999999999978, -47.50000000000021, -6.099999999999994, -10.599999999999975, -6.399999999999994, -39.400000000000205, -9.799999999999986, -6.099999999999991, -6.499999999999989, -13.19999999999997, -11.599999999999971, -22.000000000000025, -3.3000000000000007, -8.999999999999988, -6.799999999999994, -11.399999999999977, -12.299999999999976, -6.599999999999989, -16.799999999999983, -21.99999999999999], "episode_lengths": [115, 131, 271, 210, 128, 128, 190, 400, 289, 76, 101, 135, 65, 105, 185, 393, 168, 400, 111, 129, 400, 233, 114, 281, 83, 125, 49, 368, 125, 235, 144, 94, 165, 115, 107, 227, 107, 171, 88, 160, 80, 172, 92, 126, 347, 148, 95, 222, 305, 126, 353, 113, 88, 151, 109, 192, 251, 400, 98, 127, 60, 85, 129, 96, 47, 400, 358, 112, 89, 86, 270, 152, 63, 73, 119, 94, 209, 105, 157, 149, 110, 375, 68, 104, 69, 356, 87, 72, 76, 109, 127, 216, 44, 88, 70, 109, 104, 77, 174, 182]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24324218761587552, "mean_inference_ms": 0.7308160685283586, "mean_action_processing_ms": 0.0763409717817123, "mean_env_wait_ms": 6.319316939903259, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006571054458618164, "StateBufferConnector_ms": 0.003790616989135742, "ViewRequirementAgentConnector_ms": 0.08830809593200684}}, "episode_reward_max": -3.3000000000000007, "episode_reward_min": -60.90000000000047, "episode_reward_mean": -17.87900000000003, "episode_len_mean": 161.86, "episodes_this_iter": 29, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10.399999999999975, -14.599999999999962, -31.100000000000037, -22.400000000000077, -16.699999999999967, -14.899999999999975, -20.999999999999975, -40.1000000000003, -31.800000000000082, -7.0999999999999925, -12.599999999999984, -15.09999999999997, -5.399999999999993, -10.899999999999979, -18.0, -49.00000000000034, -16.899999999999995, -56.00000000000039, -9.999999999999977, -16.299999999999965, -60.90000000000047, -23.500000000000078, -10.399999999999975, -29.000000000000135, -7.199999999999987, -11.399999999999972, -3.799999999999999, -43.2000000000003, -14.899999999999968, -23.400000000000066, -13.299999999999965, -8.299999999999983, -17.999999999999975, -10.799999999999974, -10.699999999999974, -25.80000000000003, -9.599999999999978, -18.8, -8.699999999999987, -17.1, -7.89999999999999, -17.8, -8.199999999999985, -13.399999999999972, -42.1000000000002, -15.599999999999977, -9.899999999999983, -26.799999999999994, -33.70000000000015, -12.199999999999969, -43.50000000000016, -11.499999999999979, -8.89999999999998, -15.099999999999959, -11.59999999999998, -20.500000000000004, -28.500000000000078, -48.200000000000294, -11.39999999999998, -12.399999999999968, -4.899999999999995, -7.399999999999986, -13.299999999999965, -9.099999999999982, -4.1999999999999975, -59.200000000000394, -41.30000000000024, -13.49999999999997, -7.799999999999985, -8.699999999999983, -28.50000000000008, -14.499999999999961, -6.0999999999999925, -8.299999999999988, -13.699999999999969, -9.299999999999981, -26.299999999999997, -9.499999999999979, -16.099999999999977, -20.29999999999997, -10.199999999999978, -47.50000000000021, -6.099999999999994, -10.599999999999975, -6.399999999999994, -39.400000000000205, -9.799999999999986, -6.099999999999991, -6.499999999999989, -13.19999999999997, -11.599999999999971, -22.000000000000025, -3.3000000000000007, -8.999999999999988, -6.799999999999994, -11.399999999999977, -12.299999999999976, -6.599999999999989, -16.799999999999983, -21.99999999999999], "episode_lengths": [115, 131, 271, 210, 128, 128, 190, 400, 289, 76, 101, 135, 65, 105, 185, 393, 168, 400, 111, 129, 400, 233, 114, 281, 83, 125, 49, 368, 125, 235, 144, 94, 165, 115, 107, 227, 107, 171, 88, 160, 80, 172, 92, 126, 347, 148, 95, 222, 305, 126, 353, 113, 88, 151, 109, 192, 251, 400, 98, 127, 60, 85, 129, 96, 47, 400, 358, 112, 89, 86, 270, 152, 63, 73, 119, 94, 209, 105, 157, 149, 110, 375, 68, 104, 69, 356, 87, 72, 76, 109, 127, 216, 44, 88, 70, 109, 104, 77, 174, 182]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24324218761587552, "mean_inference_ms": 0.7308160685283586, "mean_action_processing_ms": 0.0763409717817123, "mean_env_wait_ms": 6.319316939903259, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006571054458618164, "StateBufferConnector_ms": 0.003790616989135742, "ViewRequirementAgentConnector_ms": 0.08830809593200684}, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000, "num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 445.1447897238652, "num_env_steps_trained_throughput_per_sec": 445.1447897238652, "timesteps_total": 48000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 48000, "timers": {"training_iteration_time_ms": 8870.201, "sample_time_ms": 5078.258, "load_time_ms": 1.036, "load_throughput": 3860114.58, "learn_time_ms": 3787.951, "learn_throughput": 1055.98, "synch_weights_time_ms": 2.278}, "counters": {"num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000}, "done": false, "episodes_total": 226, "training_iteration": 12, "trial_id": "ddfb6_00000", "date": "2024-03-07_12-50-05", "timestamp": 1709833805, "time_this_iter_s": 8.988098382949829, "time_total_s": 105.96493864059448, "pid": 112355, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4d85689f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 105.96493864059448, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 27.799999999999997, "ram_util_percent": 52.29090909090908, "gpu_util_percent0": 0.13272727272727275, "vram_util_percent0": 0.12928355823863638}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 4.781268952640715, "policy_loss": -0.014045578129188989, "vf_loss": 4.793895012588911, "vf_explained_var": -0.14979913843575343, "kl": 0.007097628853640174, "entropy": 0.9836628369746669, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 11625.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_agent_steps_sampled": 52000, "num_agent_steps_trained": 52000}, "sampler_results": {"episode_reward_max": -3.3000000000000007, "episode_reward_min": -59.200000000000394, "episode_reward_mean": -15.754000000000017, "episode_len_mean": 146.03, "episode_media": {}, "episodes_this_iter": 29, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-23.400000000000066, -13.299999999999965, -8.299999999999983, -17.999999999999975, -10.799999999999974, -10.699999999999974, -25.80000000000003, -9.599999999999978, -18.8, -8.699999999999987, -17.1, -7.89999999999999, -17.8, -8.199999999999985, -13.399999999999972, -42.1000000000002, -15.599999999999977, -9.899999999999983, -26.799999999999994, -33.70000000000015, -12.199999999999969, -43.50000000000016, -11.499999999999979, -8.89999999999998, -15.099999999999959, -11.59999999999998, -20.500000000000004, -28.500000000000078, -48.200000000000294, -11.39999999999998, -12.399999999999968, -4.899999999999995, -7.399999999999986, -13.299999999999965, -9.099999999999982, -4.1999999999999975, -59.200000000000394, -41.30000000000024, -13.49999999999997, -7.799999999999985, -8.699999999999983, -28.50000000000008, -14.499999999999961, -6.0999999999999925, -8.299999999999988, -13.699999999999969, -9.299999999999981, -26.299999999999997, -9.499999999999979, -16.099999999999977, -20.29999999999997, -10.199999999999978, -47.50000000000021, -6.099999999999994, -10.599999999999975, -6.399999999999994, -39.400000000000205, -9.799999999999986, -6.099999999999991, -6.499999999999989, -13.19999999999997, -11.599999999999971, -22.000000000000025, -3.3000000000000007, -8.999999999999988, -6.799999999999994, -11.399999999999977, -12.299999999999976, -6.599999999999989, -16.799999999999983, -21.99999999999999, -30.10000000000008, -15.09999999999997, -5.699999999999992, -10.599999999999977, -25.400000000000105, -19.100000000000005, -6.49999999999999, -10.099999999999977, -12.999999999999977, -46.90000000000019, -5.299999999999994, -6.599999999999989, -11.999999999999973, -15.399999999999963, -8.599999999999982, -5.699999999999992, -6.39999999999999, -9.299999999999981, -50.40000000000034, -23.900000000000052, -5.8999999999999915, -10.899999999999974, -10.099999999999982, -17.699999999999978, -11.999999999999977, -9.999999999999977, -7.299999999999994, -7.89999999999999, -4.1999999999999975], "episode_lengths": [235, 144, 94, 165, 115, 107, 227, 107, 171, 88, 160, 80, 172, 92, 126, 347, 148, 95, 222, 305, 126, 353, 113, 88, 151, 109, 192, 251, 400, 98, 127, 60, 85, 129, 96, 47, 400, 358, 112, 89, 86, 270, 152, 63, 73, 119, 94, 209, 105, 157, 149, 110, 375, 68, 104, 69, 356, 87, 72, 76, 109, 127, 216, 44, 88, 70, 109, 104, 77, 174, 182, 285, 149, 68, 107, 251, 165, 75, 105, 117, 342, 64, 77, 112, 153, 92, 68, 75, 101, 400, 221, 70, 120, 93, 179, 124, 104, 76, 80, 52]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24469801554212423, "mean_inference_ms": 0.7300920522907387, "mean_action_processing_ms": 0.076256157737765, "mean_env_wait_ms": 6.320112450730466, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00659489631652832, "StateBufferConnector_ms": 0.003835439682006836, "ViewRequirementAgentConnector_ms": 0.08878231048583984}}, "episode_reward_max": -3.3000000000000007, "episode_reward_min": -59.200000000000394, "episode_reward_mean": -15.754000000000017, "episode_len_mean": 146.03, "episodes_this_iter": 29, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-23.400000000000066, -13.299999999999965, -8.299999999999983, -17.999999999999975, -10.799999999999974, -10.699999999999974, -25.80000000000003, -9.599999999999978, -18.8, -8.699999999999987, -17.1, -7.89999999999999, -17.8, -8.199999999999985, -13.399999999999972, -42.1000000000002, -15.599999999999977, -9.899999999999983, -26.799999999999994, -33.70000000000015, -12.199999999999969, -43.50000000000016, -11.499999999999979, -8.89999999999998, -15.099999999999959, -11.59999999999998, -20.500000000000004, -28.500000000000078, -48.200000000000294, -11.39999999999998, -12.399999999999968, -4.899999999999995, -7.399999999999986, -13.299999999999965, -9.099999999999982, -4.1999999999999975, -59.200000000000394, -41.30000000000024, -13.49999999999997, -7.799999999999985, -8.699999999999983, -28.50000000000008, -14.499999999999961, -6.0999999999999925, -8.299999999999988, -13.699999999999969, -9.299999999999981, -26.299999999999997, -9.499999999999979, -16.099999999999977, -20.29999999999997, -10.199999999999978, -47.50000000000021, -6.099999999999994, -10.599999999999975, -6.399999999999994, -39.400000000000205, -9.799999999999986, -6.099999999999991, -6.499999999999989, -13.19999999999997, -11.599999999999971, -22.000000000000025, -3.3000000000000007, -8.999999999999988, -6.799999999999994, -11.399999999999977, -12.299999999999976, -6.599999999999989, -16.799999999999983, -21.99999999999999, -30.10000000000008, -15.09999999999997, -5.699999999999992, -10.599999999999977, -25.400000000000105, -19.100000000000005, -6.49999999999999, -10.099999999999977, -12.999999999999977, -46.90000000000019, -5.299999999999994, -6.599999999999989, -11.999999999999973, -15.399999999999963, -8.599999999999982, -5.699999999999992, -6.39999999999999, -9.299999999999981, -50.40000000000034, -23.900000000000052, -5.8999999999999915, -10.899999999999974, -10.099999999999982, -17.699999999999978, -11.999999999999977, -9.999999999999977, -7.299999999999994, -7.89999999999999, -4.1999999999999975], "episode_lengths": [235, 144, 94, 165, 115, 107, 227, 107, 171, 88, 160, 80, 172, 92, 126, 347, 148, 95, 222, 305, 126, 353, 113, 88, 151, 109, 192, 251, 400, 98, 127, 60, 85, 129, 96, 47, 400, 358, 112, 89, 86, 270, 152, 63, 73, 119, 94, 209, 105, 157, 149, 110, 375, 68, 104, 69, 356, 87, 72, 76, 109, 127, 216, 44, 88, 70, 109, 104, 77, 174, 182, 285, 149, 68, 107, 251, 165, 75, 105, 117, 342, 64, 77, 112, 153, 92, 68, 75, 101, 400, 221, 70, 120, 93, 179, 124, 104, 76, 80, 52]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24469801554212423, "mean_inference_ms": 0.7300920522907387, "mean_action_processing_ms": 0.076256157737765, "mean_env_wait_ms": 6.320112450730466, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00659489631652832, "StateBufferConnector_ms": 0.003835439682006836, "ViewRequirementAgentConnector_ms": 0.08878231048583984}, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 52000, "num_agent_steps_trained": 52000, "num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 433.1370545773803, "num_env_steps_trained_throughput_per_sec": 433.1370545773803, "timesteps_total": 52000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 52000, "timers": {"training_iteration_time_ms": 8942.626, "sample_time_ms": 5109.468, "load_time_ms": 1.107, "load_throughput": 3613598.69, "learn_time_ms": 3829.144, "learn_throughput": 1044.62, "synch_weights_time_ms": 2.235}, "counters": {"num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_agent_steps_sampled": 52000, "num_agent_steps_trained": 52000}, "done": false, "episodes_total": 255, "training_iteration": 13, "trial_id": "ddfb6_00000", "date": "2024-03-07_12-50-14", "timestamp": 1709833814, "time_this_iter_s": 9.237337589263916, "time_total_s": 115.2022762298584, "pid": 112355, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4d85689f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 115.2022762298584, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 29.241666666666664, "ram_util_percent": 52.1, "gpu_util_percent0": 0.13333333333333333, "vram_util_percent0": 0.12927924262152776}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 3.8848690380011837, "policy_loss": -0.008713013867056498, "vf_loss": 3.892198648151531, "vf_explained_var": 0.27699598541823767, "kl": 0.0069169936633853854, "entropy": 0.9667067294479699, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 12555.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 56000}, "sampler_results": {"episode_reward_max": -3.3000000000000007, "episode_reward_min": -59.200000000000394, "episode_reward_mean": -15.112000000000013, "episode_len_mean": 140.08, "episode_media": {}, "episodes_this_iter": 30, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-12.399999999999968, -4.899999999999995, -7.399999999999986, -13.299999999999965, -9.099999999999982, -4.1999999999999975, -59.200000000000394, -41.30000000000024, -13.49999999999997, -7.799999999999985, -8.699999999999983, -28.50000000000008, -14.499999999999961, -6.0999999999999925, -8.299999999999988, -13.699999999999969, -9.299999999999981, -26.299999999999997, -9.499999999999979, -16.099999999999977, -20.29999999999997, -10.199999999999978, -47.50000000000021, -6.099999999999994, -10.599999999999975, -6.399999999999994, -39.400000000000205, -9.799999999999986, -6.099999999999991, -6.499999999999989, -13.19999999999997, -11.599999999999971, -22.000000000000025, -3.3000000000000007, -8.999999999999988, -6.799999999999994, -11.399999999999977, -12.299999999999976, -6.599999999999989, -16.799999999999983, -21.99999999999999, -30.10000000000008, -15.09999999999997, -5.699999999999992, -10.599999999999977, -25.400000000000105, -19.100000000000005, -6.49999999999999, -10.099999999999977, -12.999999999999977, -46.90000000000019, -5.299999999999994, -6.599999999999989, -11.999999999999973, -15.399999999999963, -8.599999999999982, -5.699999999999992, -6.39999999999999, -9.299999999999981, -50.40000000000034, -23.900000000000052, -5.8999999999999915, -10.899999999999974, -10.099999999999982, -17.699999999999978, -11.999999999999977, -9.999999999999977, -7.299999999999994, -7.89999999999999, -4.1999999999999975, -49.40000000000028, -38.200000000000195, -12.699999999999967, -5.699999999999992, -7.899999999999986, -20.1, -6.899999999999988, -16.19999999999998, -12.099999999999977, -27.00000000000008, -13.699999999999964, -34.80000000000006, -6.599999999999992, -19.59999999999998, -16.399999999999984, -18.700000000000006, -7.2999999999999865, -9.899999999999977, -8.299999999999986, -38.60000000000005, -10.099999999999985, -11.899999999999974, -12.999999999999968, -8.299999999999985, -8.799999999999981, -10.699999999999974, -27.500000000000036, -10.09999999999999, -6.39999999999999, -10.199999999999983], "episode_lengths": [127, 60, 85, 129, 96, 47, 400, 358, 112, 89, 86, 270, 152, 63, 73, 119, 94, 209, 105, 157, 149, 110, 375, 68, 104, 69, 356, 87, 72, 76, 109, 127, 216, 44, 88, 70, 109, 104, 77, 174, 182, 285, 149, 68, 107, 251, 165, 75, 105, 117, 342, 64, 77, 112, 153, 92, 68, 75, 101, 400, 221, 70, 120, 93, 179, 124, 104, 76, 80, 52, 400, 339, 137, 68, 87, 178, 80, 146, 102, 257, 142, 264, 74, 186, 151, 182, 84, 110, 86, 269, 92, 111, 126, 93, 99, 106, 249, 95, 75, 98]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24591946160340541, "mean_inference_ms": 0.7303201731018126, "mean_action_processing_ms": 0.07622793765499664, "mean_env_wait_ms": 6.324925669583032, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006696462631225586, "StateBufferConnector_ms": 0.003941535949707031, "ViewRequirementAgentConnector_ms": 0.09001731872558594}}, "episode_reward_max": -3.3000000000000007, "episode_reward_min": -59.200000000000394, "episode_reward_mean": -15.112000000000013, "episode_len_mean": 140.08, "episodes_this_iter": 30, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-12.399999999999968, -4.899999999999995, -7.399999999999986, -13.299999999999965, -9.099999999999982, -4.1999999999999975, -59.200000000000394, -41.30000000000024, -13.49999999999997, -7.799999999999985, -8.699999999999983, -28.50000000000008, -14.499999999999961, -6.0999999999999925, -8.299999999999988, -13.699999999999969, -9.299999999999981, -26.299999999999997, -9.499999999999979, -16.099999999999977, -20.29999999999997, -10.199999999999978, -47.50000000000021, -6.099999999999994, -10.599999999999975, -6.399999999999994, -39.400000000000205, -9.799999999999986, -6.099999999999991, -6.499999999999989, -13.19999999999997, -11.599999999999971, -22.000000000000025, -3.3000000000000007, -8.999999999999988, -6.799999999999994, -11.399999999999977, -12.299999999999976, -6.599999999999989, -16.799999999999983, -21.99999999999999, -30.10000000000008, -15.09999999999997, -5.699999999999992, -10.599999999999977, -25.400000000000105, -19.100000000000005, -6.49999999999999, -10.099999999999977, -12.999999999999977, -46.90000000000019, -5.299999999999994, -6.599999999999989, -11.999999999999973, -15.399999999999963, -8.599999999999982, -5.699999999999992, -6.39999999999999, -9.299999999999981, -50.40000000000034, -23.900000000000052, -5.8999999999999915, -10.899999999999974, -10.099999999999982, -17.699999999999978, -11.999999999999977, -9.999999999999977, -7.299999999999994, -7.89999999999999, -4.1999999999999975, -49.40000000000028, -38.200000000000195, -12.699999999999967, -5.699999999999992, -7.899999999999986, -20.1, -6.899999999999988, -16.19999999999998, -12.099999999999977, -27.00000000000008, -13.699999999999964, -34.80000000000006, -6.599999999999992, -19.59999999999998, -16.399999999999984, -18.700000000000006, -7.2999999999999865, -9.899999999999977, -8.299999999999986, -38.60000000000005, -10.099999999999985, -11.899999999999974, -12.999999999999968, -8.299999999999985, -8.799999999999981, -10.699999999999974, -27.500000000000036, -10.09999999999999, -6.39999999999999, -10.199999999999983], "episode_lengths": [127, 60, 85, 129, 96, 47, 400, 358, 112, 89, 86, 270, 152, 63, 73, 119, 94, 209, 105, 157, 149, 110, 375, 68, 104, 69, 356, 87, 72, 76, 109, 127, 216, 44, 88, 70, 109, 104, 77, 174, 182, 285, 149, 68, 107, 251, 165, 75, 105, 117, 342, 64, 77, 112, 153, 92, 68, 75, 101, 400, 221, 70, 120, 93, 179, 124, 104, 76, 80, 52, 400, 339, 137, 68, 87, 178, 80, 146, 102, 257, 142, 264, 74, 186, 151, 182, 84, 110, 86, 269, 92, 111, 126, 93, 99, 106, 249, 95, 75, 98]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24591946160340541, "mean_inference_ms": 0.7303201731018126, "mean_action_processing_ms": 0.07622793765499664, "mean_env_wait_ms": 6.324925669583032, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006696462631225586, "StateBufferConnector_ms": 0.003941535949707031, "ViewRequirementAgentConnector_ms": 0.09001731872558594}, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 56000, "num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 455.29144179529226, "num_env_steps_trained_throughput_per_sec": 455.29144179529226, "timesteps_total": 56000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 56000, "timers": {"training_iteration_time_ms": 8935.296, "sample_time_ms": 5113.334, "load_time_ms": 1.108, "load_throughput": 3609944.271, "learn_time_ms": 3817.977, "learn_throughput": 1047.675, "synch_weights_time_ms": 2.203}, "counters": {"num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 56000}, "done": false, "episodes_total": 285, "training_iteration": 14, "trial_id": "ddfb6_00000", "date": "2024-03-07_12-50-23", "timestamp": 1709833823, "time_this_iter_s": 8.787830829620361, "time_total_s": 123.99010705947876, "pid": 112355, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4d85689f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 123.99010705947876, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 27.445454545454538, "ram_util_percent": 51.963636363636354, "gpu_util_percent0": 0.09545454545454544, "vram_util_percent0": 0.13102213541666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 4.607289418393886, "policy_loss": -0.0074579999391590395, "vf_loss": 4.613617950613781, "vf_explained_var": 0.29795914080835156, "kl": 0.0056473452796991855, "entropy": 0.9674176108452581, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 13485.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000}, "sampler_results": {"episode_reward_max": -3.3000000000000007, "episode_reward_min": -50.40000000000034, "episode_reward_mean": -14.165000000000003, "episode_len_mean": 133.25, "episode_media": {}, "episodes_this_iter": 30, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-13.19999999999997, -11.599999999999971, -22.000000000000025, -3.3000000000000007, -8.999999999999988, -6.799999999999994, -11.399999999999977, -12.299999999999976, -6.599999999999989, -16.799999999999983, -21.99999999999999, -30.10000000000008, -15.09999999999997, -5.699999999999992, -10.599999999999977, -25.400000000000105, -19.100000000000005, -6.49999999999999, -10.099999999999977, -12.999999999999977, -46.90000000000019, -5.299999999999994, -6.599999999999989, -11.999999999999973, -15.399999999999963, -8.599999999999982, -5.699999999999992, -6.39999999999999, -9.299999999999981, -50.40000000000034, -23.900000000000052, -5.8999999999999915, -10.899999999999974, -10.099999999999982, -17.699999999999978, -11.999999999999977, -9.999999999999977, -7.299999999999994, -7.89999999999999, -4.1999999999999975, -49.40000000000028, -38.200000000000195, -12.699999999999967, -5.699999999999992, -7.899999999999986, -20.1, -6.899999999999988, -16.19999999999998, -12.099999999999977, -27.00000000000008, -13.699999999999964, -34.80000000000006, -6.599999999999992, -19.59999999999998, -16.399999999999984, -18.700000000000006, -7.2999999999999865, -9.899999999999977, -8.299999999999986, -38.60000000000005, -10.099999999999985, -11.899999999999974, -12.999999999999968, -8.299999999999985, -8.799999999999981, -10.699999999999974, -27.500000000000036, -10.09999999999999, -6.39999999999999, -10.199999999999983, -16.699999999999985, -11.999999999999982, -16.39999999999998, -14.299999999999962, -11.199999999999985, -8.399999999999986, -5.8999999999999915, -8.79999999999999, -10.899999999999977, -38.800000000000125, -7.899999999999986, -13.899999999999967, -7.29999999999999, -6.499999999999989, -6.799999999999989, -11.199999999999974, -11.799999999999974, -9.799999999999981, -8.599999999999987, -11.59999999999998, -16.299999999999983, -16.09999999999996, -13.099999999999973, -4.9999999999999964, -14.79999999999997, -10.499999999999984, -8.099999999999987, -43.300000000000175, -3.9999999999999982, -12.299999999999969], "episode_lengths": [109, 127, 216, 44, 88, 70, 109, 104, 77, 174, 182, 285, 149, 68, 107, 251, 165, 75, 105, 117, 342, 64, 77, 112, 153, 92, 68, 75, 101, 400, 221, 70, 120, 93, 179, 124, 104, 76, 80, 52, 400, 339, 137, 68, 87, 178, 80, 146, 102, 257, 142, 264, 74, 186, 151, 182, 84, 110, 86, 269, 92, 111, 126, 93, 99, 106, 249, 95, 75, 98, 166, 114, 147, 154, 107, 92, 67, 89, 98, 343, 85, 114, 80, 76, 78, 111, 106, 106, 91, 108, 136, 157, 119, 54, 128, 103, 83, 317, 51, 134]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24735050830225816, "mean_inference_ms": 0.7302681673917273, "mean_action_processing_ms": 0.07619772147753953, "mean_env_wait_ms": 6.330833219822159, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0068035125732421875, "StateBufferConnector_ms": 0.003933906555175781, "ViewRequirementAgentConnector_ms": 0.09006309509277344}}, "episode_reward_max": -3.3000000000000007, "episode_reward_min": -50.40000000000034, "episode_reward_mean": -14.165000000000003, "episode_len_mean": 133.25, "episodes_this_iter": 30, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-13.19999999999997, -11.599999999999971, -22.000000000000025, -3.3000000000000007, -8.999999999999988, -6.799999999999994, -11.399999999999977, -12.299999999999976, -6.599999999999989, -16.799999999999983, -21.99999999999999, -30.10000000000008, -15.09999999999997, -5.699999999999992, -10.599999999999977, -25.400000000000105, -19.100000000000005, -6.49999999999999, -10.099999999999977, -12.999999999999977, -46.90000000000019, -5.299999999999994, -6.599999999999989, -11.999999999999973, -15.399999999999963, -8.599999999999982, -5.699999999999992, -6.39999999999999, -9.299999999999981, -50.40000000000034, -23.900000000000052, -5.8999999999999915, -10.899999999999974, -10.099999999999982, -17.699999999999978, -11.999999999999977, -9.999999999999977, -7.299999999999994, -7.89999999999999, -4.1999999999999975, -49.40000000000028, -38.200000000000195, -12.699999999999967, -5.699999999999992, -7.899999999999986, -20.1, -6.899999999999988, -16.19999999999998, -12.099999999999977, -27.00000000000008, -13.699999999999964, -34.80000000000006, -6.599999999999992, -19.59999999999998, -16.399999999999984, -18.700000000000006, -7.2999999999999865, -9.899999999999977, -8.299999999999986, -38.60000000000005, -10.099999999999985, -11.899999999999974, -12.999999999999968, -8.299999999999985, -8.799999999999981, -10.699999999999974, -27.500000000000036, -10.09999999999999, -6.39999999999999, -10.199999999999983, -16.699999999999985, -11.999999999999982, -16.39999999999998, -14.299999999999962, -11.199999999999985, -8.399999999999986, -5.8999999999999915, -8.79999999999999, -10.899999999999977, -38.800000000000125, -7.899999999999986, -13.899999999999967, -7.29999999999999, -6.499999999999989, -6.799999999999989, -11.199999999999974, -11.799999999999974, -9.799999999999981, -8.599999999999987, -11.59999999999998, -16.299999999999983, -16.09999999999996, -13.099999999999973, -4.9999999999999964, -14.79999999999997, -10.499999999999984, -8.099999999999987, -43.300000000000175, -3.9999999999999982, -12.299999999999969], "episode_lengths": [109, 127, 216, 44, 88, 70, 109, 104, 77, 174, 182, 285, 149, 68, 107, 251, 165, 75, 105, 117, 342, 64, 77, 112, 153, 92, 68, 75, 101, 400, 221, 70, 120, 93, 179, 124, 104, 76, 80, 52, 400, 339, 137, 68, 87, 178, 80, 146, 102, 257, 142, 264, 74, 186, 151, 182, 84, 110, 86, 269, 92, 111, 126, 93, 99, 106, 249, 95, 75, 98, 166, 114, 147, 154, 107, 92, 67, 89, 98, 343, 85, 114, 80, 76, 78, 111, 106, 106, 91, 108, 136, 157, 119, 54, 128, 103, 83, 317, 51, 134]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24735050830225816, "mean_inference_ms": 0.7302681673917273, "mean_action_processing_ms": 0.07619772147753953, "mean_env_wait_ms": 6.330833219822159, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0068035125732421875, "StateBufferConnector_ms": 0.003933906555175781, "ViewRequirementAgentConnector_ms": 0.09006309509277344}, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000, "num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 451.0241573730102, "num_env_steps_trained_throughput_per_sec": 451.0241573730102, "timesteps_total": 60000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 60000, "timers": {"training_iteration_time_ms": 8880.91, "sample_time_ms": 5112.216, "load_time_ms": 1.101, "load_throughput": 3634578.856, "learn_time_ms": 3764.789, "learn_throughput": 1062.476, "synch_weights_time_ms": 2.146}, "counters": {"num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000}, "done": false, "episodes_total": 315, "training_iteration": 15, "trial_id": "ddfb6_00000", "date": "2024-03-07_12-50-32", "timestamp": 1709833832, "time_this_iter_s": 8.871025562286377, "time_total_s": 132.86113262176514, "pid": 112355, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4d85689f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 132.86113262176514, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 25.316666666666666, "ram_util_percent": 51.73333333333334, "gpu_util_percent0": 0.10749999999999998, "vram_util_percent0": 0.130859375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 3.9939323281751626, "policy_loss": -0.012938562031554919, "vf_loss": 4.005181858712627, "vf_explained_var": 0.49409301627066826, "kl": 0.008445141200883686, "entropy": 0.950064589323536, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 14415.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000}, "sampler_results": {"episode_reward_max": -3.5999999999999996, "episode_reward_min": -53.70000000000039, "episode_reward_mean": -13.613000000000005, "episode_len_mean": 128.11, "episode_media": {}, "episodes_this_iter": 31, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-5.8999999999999915, -10.899999999999974, -10.099999999999982, -17.699999999999978, -11.999999999999977, -9.999999999999977, -7.299999999999994, -7.89999999999999, -4.1999999999999975, -49.40000000000028, -38.200000000000195, -12.699999999999967, -5.699999999999992, -7.899999999999986, -20.1, -6.899999999999988, -16.19999999999998, -12.099999999999977, -27.00000000000008, -13.699999999999964, -34.80000000000006, -6.599999999999992, -19.59999999999998, -16.399999999999984, -18.700000000000006, -7.2999999999999865, -9.899999999999977, -8.299999999999986, -38.60000000000005, -10.099999999999985, -11.899999999999974, -12.999999999999968, -8.299999999999985, -8.799999999999981, -10.699999999999974, -27.500000000000036, -10.09999999999999, -6.39999999999999, -10.199999999999983, -16.699999999999985, -11.999999999999982, -16.39999999999998, -14.299999999999962, -11.199999999999985, -8.399999999999986, -5.8999999999999915, -8.79999999999999, -10.899999999999977, -38.800000000000125, -7.899999999999986, -13.899999999999967, -7.29999999999999, -6.499999999999989, -6.799999999999989, -11.199999999999974, -11.799999999999974, -9.799999999999981, -8.599999999999987, -11.59999999999998, -16.299999999999983, -16.09999999999996, -13.099999999999973, -4.9999999999999964, -14.79999999999997, -10.499999999999984, -8.099999999999987, -43.300000000000175, -3.9999999999999982, -12.299999999999969, -19.600000000000005, -7.899999999999984, -12.499999999999972, -10.199999999999987, -53.70000000000039, -7.399999999999986, -9.29999999999998, -3.5999999999999996, -9.29999999999998, -7.499999999999986, -18.600000000000012, -4.999999999999995, -13.499999999999964, -10.29999999999998, -8.499999999999986, -49.10000000000027, -9.299999999999981, -13.999999999999968, -10.499999999999975, -8.099999999999984, -14.399999999999977, -4.4999999999999964, -9.599999999999993, -5.699999999999992, -10.699999999999982, -7.899999999999986, -3.799999999999999, -36.20000000000025, -7.099999999999989, -8.299999999999985, -9.799999999999978], "episode_lengths": [70, 120, 93, 179, 124, 104, 76, 80, 52, 400, 339, 137, 68, 87, 178, 80, 146, 102, 257, 142, 264, 74, 186, 151, 182, 84, 110, 86, 269, 92, 111, 126, 93, 99, 106, 249, 95, 75, 98, 166, 114, 147, 154, 107, 92, 67, 89, 98, 343, 85, 114, 80, 76, 78, 111, 106, 106, 91, 108, 136, 157, 119, 54, 128, 103, 83, 317, 51, 134, 164, 90, 115, 88, 400, 85, 83, 47, 101, 86, 184, 61, 146, 96, 89, 400, 99, 127, 116, 91, 122, 56, 85, 68, 99, 89, 49, 304, 79, 85, 109]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24847504289914837, "mean_inference_ms": 0.729584753638575, "mean_action_processing_ms": 0.07612487290666105, "mean_env_wait_ms": 6.334483876518906, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0066928863525390625, "StateBufferConnector_ms": 0.003890514373779297, "ViewRequirementAgentConnector_ms": 0.08898115158081055}}, "episode_reward_max": -3.5999999999999996, "episode_reward_min": -53.70000000000039, "episode_reward_mean": -13.613000000000005, "episode_len_mean": 128.11, "episodes_this_iter": 31, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-5.8999999999999915, -10.899999999999974, -10.099999999999982, -17.699999999999978, -11.999999999999977, -9.999999999999977, -7.299999999999994, -7.89999999999999, -4.1999999999999975, -49.40000000000028, -38.200000000000195, -12.699999999999967, -5.699999999999992, -7.899999999999986, -20.1, -6.899999999999988, -16.19999999999998, -12.099999999999977, -27.00000000000008, -13.699999999999964, -34.80000000000006, -6.599999999999992, -19.59999999999998, -16.399999999999984, -18.700000000000006, -7.2999999999999865, -9.899999999999977, -8.299999999999986, -38.60000000000005, -10.099999999999985, -11.899999999999974, -12.999999999999968, -8.299999999999985, -8.799999999999981, -10.699999999999974, -27.500000000000036, -10.09999999999999, -6.39999999999999, -10.199999999999983, -16.699999999999985, -11.999999999999982, -16.39999999999998, -14.299999999999962, -11.199999999999985, -8.399999999999986, -5.8999999999999915, -8.79999999999999, -10.899999999999977, -38.800000000000125, -7.899999999999986, -13.899999999999967, -7.29999999999999, -6.499999999999989, -6.799999999999989, -11.199999999999974, -11.799999999999974, -9.799999999999981, -8.599999999999987, -11.59999999999998, -16.299999999999983, -16.09999999999996, -13.099999999999973, -4.9999999999999964, -14.79999999999997, -10.499999999999984, -8.099999999999987, -43.300000000000175, -3.9999999999999982, -12.299999999999969, -19.600000000000005, -7.899999999999984, -12.499999999999972, -10.199999999999987, -53.70000000000039, -7.399999999999986, -9.29999999999998, -3.5999999999999996, -9.29999999999998, -7.499999999999986, -18.600000000000012, -4.999999999999995, -13.499999999999964, -10.29999999999998, -8.499999999999986, -49.10000000000027, -9.299999999999981, -13.999999999999968, -10.499999999999975, -8.099999999999984, -14.399999999999977, -4.4999999999999964, -9.599999999999993, -5.699999999999992, -10.699999999999982, -7.899999999999986, -3.799999999999999, -36.20000000000025, -7.099999999999989, -8.299999999999985, -9.799999999999978], "episode_lengths": [70, 120, 93, 179, 124, 104, 76, 80, 52, 400, 339, 137, 68, 87, 178, 80, 146, 102, 257, 142, 264, 74, 186, 151, 182, 84, 110, 86, 269, 92, 111, 126, 93, 99, 106, 249, 95, 75, 98, 166, 114, 147, 154, 107, 92, 67, 89, 98, 343, 85, 114, 80, 76, 78, 111, 106, 106, 91, 108, 136, 157, 119, 54, 128, 103, 83, 317, 51, 134, 164, 90, 115, 88, 400, 85, 83, 47, 101, 86, 184, 61, 146, 96, 89, 400, 99, 127, 116, 91, 122, 56, 85, 68, 99, 89, 49, 304, 79, 85, 109]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24847504289914837, "mean_inference_ms": 0.729584753638575, "mean_action_processing_ms": 0.07612487290666105, "mean_env_wait_ms": 6.334483876518906, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0066928863525390625, "StateBufferConnector_ms": 0.003890514373779297, "ViewRequirementAgentConnector_ms": 0.08898115158081055}, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000, "num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 453.18564989110797, "num_env_steps_trained_throughput_per_sec": 453.18564989110797, "timesteps_total": 64000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 64000, "timers": {"training_iteration_time_ms": 8836.58, "sample_time_ms": 5074.629, "load_time_ms": 1.1, "load_throughput": 3637021.397, "learn_time_ms": 3758.074, "learn_throughput": 1064.375, "synch_weights_time_ms": 2.127}, "counters": {"num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000}, "done": false, "episodes_total": 346, "training_iteration": 16, "trial_id": "ddfb6_00000", "date": "2024-03-07_12-50-41", "timestamp": 1709833841, "time_this_iter_s": 8.828989028930664, "time_total_s": 141.6901216506958, "pid": 112355, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4d85689f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 141.6901216506958, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 26.86363636363637, "ram_util_percent": 51.681818181818194, "gpu_util_percent0": 0.08454545454545453, "vram_util_percent0": 0.130859375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 3.9218400015660952, "policy_loss": 0.0011050557978050683, "vf_loss": 3.919760061912639, "vf_explained_var": 0.11727650492422043, "kl": 0.004874472466310904, "entropy": 0.9431446517026553, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 15345.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_agent_steps_sampled": 68000, "num_agent_steps_trained": 68000}, "sampler_results": {"episode_reward_max": -3.200000000000001, "episode_reward_min": -68.00000000000036, "episode_reward_mean": -13.909000000000015, "episode_len_mean": 128.33, "episode_media": {}, "episodes_this_iter": 29, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10.099999999999985, -11.899999999999974, -12.999999999999968, -8.299999999999985, -8.799999999999981, -10.699999999999974, -27.500000000000036, -10.09999999999999, -6.39999999999999, -10.199999999999983, -16.699999999999985, -11.999999999999982, -16.39999999999998, -14.299999999999962, -11.199999999999985, -8.399999999999986, -5.8999999999999915, -8.79999999999999, -10.899999999999977, -38.800000000000125, -7.899999999999986, -13.899999999999967, -7.29999999999999, -6.499999999999989, -6.799999999999989, -11.199999999999974, -11.799999999999974, -9.799999999999981, -8.599999999999987, -11.59999999999998, -16.299999999999983, -16.09999999999996, -13.099999999999973, -4.9999999999999964, -14.79999999999997, -10.499999999999984, -8.099999999999987, -43.300000000000175, -3.9999999999999982, -12.299999999999969, -19.600000000000005, -7.899999999999984, -12.499999999999972, -10.199999999999987, -53.70000000000039, -7.399999999999986, -9.29999999999998, -3.5999999999999996, -9.29999999999998, -7.499999999999986, -18.600000000000012, -4.999999999999995, -13.499999999999964, -10.29999999999998, -8.499999999999986, -49.10000000000027, -9.299999999999981, -13.999999999999968, -10.499999999999975, -8.099999999999984, -14.399999999999977, -4.4999999999999964, -9.599999999999993, -5.699999999999992, -10.699999999999982, -7.899999999999986, -3.799999999999999, -36.20000000000025, -7.099999999999989, -8.299999999999985, -9.799999999999978, -41.20000000000006, -19.80000000000002, -10.899999999999974, -6.999999999999988, -5.699999999999994, -12.499999999999968, -10.599999999999975, -8.299999999999983, -11.499999999999972, -7.3999999999999915, -7.099999999999987, -11.499999999999982, -12.299999999999969, -10.399999999999975, -12.199999999999969, -5.999999999999991, -10.999999999999973, -6.99999999999999, -12.199999999999985, -7.899999999999984, -45.90000000000034, -3.200000000000001, -53.10000000000033, -13.099999999999984, -5.199999999999994, -4.299999999999998, -68.00000000000036, -7.699999999999987, -52.70000000000027], "episode_lengths": [92, 111, 126, 93, 99, 106, 249, 95, 75, 98, 166, 114, 147, 154, 107, 92, 67, 89, 98, 343, 85, 114, 80, 76, 78, 111, 106, 106, 91, 108, 136, 157, 119, 54, 128, 103, 83, 317, 51, 134, 164, 90, 115, 88, 400, 85, 83, 47, 101, 86, 184, 61, 146, 96, 89, 400, 99, 127, 116, 91, 122, 56, 85, 68, 99, 89, 49, 304, 79, 85, 109, 308, 205, 112, 81, 62, 136, 113, 94, 126, 79, 77, 109, 134, 115, 128, 71, 121, 77, 100, 90, 400, 43, 388, 91, 63, 53, 400, 86, 400]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24906135203238766, "mean_inference_ms": 0.7286331500646328, "mean_action_processing_ms": 0.07602529630469132, "mean_env_wait_ms": 6.334767144088626, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00664520263671875, "StateBufferConnector_ms": 0.0038306713104248047, "ViewRequirementAgentConnector_ms": 0.08800864219665527}}, "episode_reward_max": -3.200000000000001, "episode_reward_min": -68.00000000000036, "episode_reward_mean": -13.909000000000015, "episode_len_mean": 128.33, "episodes_this_iter": 29, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10.099999999999985, -11.899999999999974, -12.999999999999968, -8.299999999999985, -8.799999999999981, -10.699999999999974, -27.500000000000036, -10.09999999999999, -6.39999999999999, -10.199999999999983, -16.699999999999985, -11.999999999999982, -16.39999999999998, -14.299999999999962, -11.199999999999985, -8.399999999999986, -5.8999999999999915, -8.79999999999999, -10.899999999999977, -38.800000000000125, -7.899999999999986, -13.899999999999967, -7.29999999999999, -6.499999999999989, -6.799999999999989, -11.199999999999974, -11.799999999999974, -9.799999999999981, -8.599999999999987, -11.59999999999998, -16.299999999999983, -16.09999999999996, -13.099999999999973, -4.9999999999999964, -14.79999999999997, -10.499999999999984, -8.099999999999987, -43.300000000000175, -3.9999999999999982, -12.299999999999969, -19.600000000000005, -7.899999999999984, -12.499999999999972, -10.199999999999987, -53.70000000000039, -7.399999999999986, -9.29999999999998, -3.5999999999999996, -9.29999999999998, -7.499999999999986, -18.600000000000012, -4.999999999999995, -13.499999999999964, -10.29999999999998, -8.499999999999986, -49.10000000000027, -9.299999999999981, -13.999999999999968, -10.499999999999975, -8.099999999999984, -14.399999999999977, -4.4999999999999964, -9.599999999999993, -5.699999999999992, -10.699999999999982, -7.899999999999986, -3.799999999999999, -36.20000000000025, -7.099999999999989, -8.299999999999985, -9.799999999999978, -41.20000000000006, -19.80000000000002, -10.899999999999974, -6.999999999999988, -5.699999999999994, -12.499999999999968, -10.599999999999975, -8.299999999999983, -11.499999999999972, -7.3999999999999915, -7.099999999999987, -11.499999999999982, -12.299999999999969, -10.399999999999975, -12.199999999999969, -5.999999999999991, -10.999999999999973, -6.99999999999999, -12.199999999999985, -7.899999999999984, -45.90000000000034, -3.200000000000001, -53.10000000000033, -13.099999999999984, -5.199999999999994, -4.299999999999998, -68.00000000000036, -7.699999999999987, -52.70000000000027], "episode_lengths": [92, 111, 126, 93, 99, 106, 249, 95, 75, 98, 166, 114, 147, 154, 107, 92, 67, 89, 98, 343, 85, 114, 80, 76, 78, 111, 106, 106, 91, 108, 136, 157, 119, 54, 128, 103, 83, 317, 51, 134, 164, 90, 115, 88, 400, 85, 83, 47, 101, 86, 184, 61, 146, 96, 89, 400, 99, 127, 116, 91, 122, 56, 85, 68, 99, 89, 49, 304, 79, 85, 109, 308, 205, 112, 81, 62, 136, 113, 94, 126, 79, 77, 109, 134, 115, 128, 71, 121, 77, 100, 90, 400, 43, 388, 91, 63, 53, 400, 86, 400]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24906135203238766, "mean_inference_ms": 0.7286331500646328, "mean_action_processing_ms": 0.07602529630469132, "mean_env_wait_ms": 6.334767144088626, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00664520263671875, "StateBufferConnector_ms": 0.0038306713104248047, "ViewRequirementAgentConnector_ms": 0.08800864219665527}, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 68000, "num_agent_steps_trained": 68000, "num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 456.6137722379298, "num_env_steps_trained_throughput_per_sec": 456.6137722379298, "timesteps_total": 68000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 68000, "timers": {"training_iteration_time_ms": 8843.79, "sample_time_ms": 5089.269, "load_time_ms": 1.106, "load_throughput": 3615623.465, "learn_time_ms": 3750.621, "learn_throughput": 1066.49, "synch_weights_time_ms": 2.138}, "counters": {"num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_agent_steps_sampled": 68000, "num_agent_steps_trained": 68000}, "done": false, "episodes_total": 375, "training_iteration": 17, "trial_id": "ddfb6_00000", "date": "2024-03-07_12-50-50", "timestamp": 1709833850, "time_this_iter_s": 8.762352466583252, "time_total_s": 150.45247411727905, "pid": 112355, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4d85689f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 150.45247411727905, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 25.891666666666666, "ram_util_percent": 51.67500000000001, "gpu_util_percent0": 0.10083333333333333, "vram_util_percent0": 0.130859375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.10000000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 3.8488731325705414, "policy_loss": -0.006228396132267932, "vf_loss": 3.854481789325514, "vf_explained_var": 0.15460768732973323, "kl": 0.006197462740989725, "entropy": 0.9380175303387386, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 16275.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000}, "sampler_results": {"episode_reward_max": -3.200000000000001, "episode_reward_min": -68.00000000000036, "episode_reward_mean": -13.726000000000015, "episode_len_mean": 127.28, "episode_media": {}, "episodes_this_iter": 33, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4.9999999999999964, -14.79999999999997, -10.499999999999984, -8.099999999999987, -43.300000000000175, -3.9999999999999982, -12.299999999999969, -19.600000000000005, -7.899999999999984, -12.499999999999972, -10.199999999999987, -53.70000000000039, -7.399999999999986, -9.29999999999998, -3.5999999999999996, -9.29999999999998, -7.499999999999986, -18.600000000000012, -4.999999999999995, -13.499999999999964, -10.29999999999998, -8.499999999999986, -49.10000000000027, -9.299999999999981, -13.999999999999968, -10.499999999999975, -8.099999999999984, -14.399999999999977, -4.4999999999999964, -9.599999999999993, -5.699999999999992, -10.699999999999982, -7.899999999999986, -3.799999999999999, -36.20000000000025, -7.099999999999989, -8.299999999999985, -9.799999999999978, -41.20000000000006, -19.80000000000002, -10.899999999999974, -6.999999999999988, -5.699999999999994, -12.499999999999968, -10.599999999999975, -8.299999999999983, -11.499999999999972, -7.3999999999999915, -7.099999999999987, -11.499999999999982, -12.299999999999969, -10.399999999999975, -12.199999999999969, -5.999999999999991, -10.999999999999973, -6.99999999999999, -12.199999999999985, -7.899999999999984, -45.90000000000034, -3.200000000000001, -53.10000000000033, -13.099999999999984, -5.199999999999994, -4.299999999999998, -68.00000000000036, -7.699999999999987, -52.70000000000027, -4.699999999999996, -8.699999999999985, -12.79999999999998, -5.699999999999992, -20.299999999999983, -20.20000000000004, -35.70000000000012, -5.499999999999993, -10.299999999999994, -7.4999999999999964, -16.899999999999977, -6.29999999999999, -7.499999999999986, -13.899999999999963, -9.999999999999977, -14.199999999999962, -4.899999999999995, -4.799999999999998, -9.699999999999978, -11.69999999999997, -49.800000000000374, -9.999999999999977, -7.599999999999985, -5.499999999999993, -6.299999999999994, -9.599999999999984, -9.099999999999985, -7.2999999999999865, -15.89999999999997, -8.799999999999992, -9.799999999999992, -5.699999999999992, -6.2999999999999945], "episode_lengths": [54, 128, 103, 83, 317, 51, 134, 164, 90, 115, 88, 400, 85, 83, 47, 101, 86, 184, 61, 146, 96, 89, 400, 99, 127, 116, 91, 122, 56, 85, 68, 99, 89, 49, 304, 79, 85, 109, 308, 205, 112, 81, 62, 136, 113, 94, 126, 79, 77, 109, 134, 115, 128, 71, 121, 77, 100, 90, 400, 43, 388, 91, 63, 53, 400, 86, 400, 50, 79, 124, 68, 200, 198, 313, 66, 90, 68, 150, 74, 86, 134, 111, 148, 60, 52, 108, 128, 400, 111, 86, 66, 67, 96, 94, 76, 170, 85, 88, 68, 69]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24975146463724424, "mean_inference_ms": 0.7279162610965545, "mean_action_processing_ms": 0.07594329793051453, "mean_env_wait_ms": 6.335928840724403, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0066928863525390625, "StateBufferConnector_ms": 0.003888368606567383, "ViewRequirementAgentConnector_ms": 0.08880090713500977}}, "episode_reward_max": -3.200000000000001, "episode_reward_min": -68.00000000000036, "episode_reward_mean": -13.726000000000015, "episode_len_mean": 127.28, "episodes_this_iter": 33, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-4.9999999999999964, -14.79999999999997, -10.499999999999984, -8.099999999999987, -43.300000000000175, -3.9999999999999982, -12.299999999999969, -19.600000000000005, -7.899999999999984, -12.499999999999972, -10.199999999999987, -53.70000000000039, -7.399999999999986, -9.29999999999998, -3.5999999999999996, -9.29999999999998, -7.499999999999986, -18.600000000000012, -4.999999999999995, -13.499999999999964, -10.29999999999998, -8.499999999999986, -49.10000000000027, -9.299999999999981, -13.999999999999968, -10.499999999999975, -8.099999999999984, -14.399999999999977, -4.4999999999999964, -9.599999999999993, -5.699999999999992, -10.699999999999982, -7.899999999999986, -3.799999999999999, -36.20000000000025, -7.099999999999989, -8.299999999999985, -9.799999999999978, -41.20000000000006, -19.80000000000002, -10.899999999999974, -6.999999999999988, -5.699999999999994, -12.499999999999968, -10.599999999999975, -8.299999999999983, -11.499999999999972, -7.3999999999999915, -7.099999999999987, -11.499999999999982, -12.299999999999969, -10.399999999999975, -12.199999999999969, -5.999999999999991, -10.999999999999973, -6.99999999999999, -12.199999999999985, -7.899999999999984, -45.90000000000034, -3.200000000000001, -53.10000000000033, -13.099999999999984, -5.199999999999994, -4.299999999999998, -68.00000000000036, -7.699999999999987, -52.70000000000027, -4.699999999999996, -8.699999999999985, -12.79999999999998, -5.699999999999992, -20.299999999999983, -20.20000000000004, -35.70000000000012, -5.499999999999993, -10.299999999999994, -7.4999999999999964, -16.899999999999977, -6.29999999999999, -7.499999999999986, -13.899999999999963, -9.999999999999977, -14.199999999999962, -4.899999999999995, -4.799999999999998, -9.699999999999978, -11.69999999999997, -49.800000000000374, -9.999999999999977, -7.599999999999985, -5.499999999999993, -6.299999999999994, -9.599999999999984, -9.099999999999985, -7.2999999999999865, -15.89999999999997, -8.799999999999992, -9.799999999999992, -5.699999999999992, -6.2999999999999945], "episode_lengths": [54, 128, 103, 83, 317, 51, 134, 164, 90, 115, 88, 400, 85, 83, 47, 101, 86, 184, 61, 146, 96, 89, 400, 99, 127, 116, 91, 122, 56, 85, 68, 99, 89, 49, 304, 79, 85, 109, 308, 205, 112, 81, 62, 136, 113, 94, 126, 79, 77, 109, 134, 115, 128, 71, 121, 77, 100, 90, 400, 43, 388, 91, 63, 53, 400, 86, 400, 50, 79, 124, 68, 200, 198, 313, 66, 90, 68, 150, 74, 86, 134, 111, 148, 60, 52, 108, 128, 400, 111, 86, 66, 67, 96, 94, 76, 170, 85, 88, 68, 69]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24975146463724424, "mean_inference_ms": 0.7279162610965545, "mean_action_processing_ms": 0.07594329793051453, "mean_env_wait_ms": 6.335928840724403, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0066928863525390625, "StateBufferConnector_ms": 0.003888368606567383, "ViewRequirementAgentConnector_ms": 0.08880090713500977}, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000, "num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 458.33152916164767, "num_env_steps_trained_throughput_per_sec": 458.33152916164767, "timesteps_total": 72000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 72000, "timers": {"training_iteration_time_ms": 8817.184, "sample_time_ms": 5088.167, "load_time_ms": 1.085, "load_throughput": 3687462.306, "learn_time_ms": 3725.131, "learn_throughput": 1073.788, "synch_weights_time_ms": 2.149}, "counters": {"num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000}, "done": false, "episodes_total": 408, "training_iteration": 18, "trial_id": "ddfb6_00000", "date": "2024-03-07_12-50-58", "timestamp": 1709833858, "time_this_iter_s": 8.729534149169922, "time_total_s": 159.18200826644897, "pid": 112355, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4d85689f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 159.18200826644897, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 27.44545454545454, "ram_util_percent": 51.67272727272728, "gpu_util_percent0": 0.09818181818181819, "vram_util_percent0": 0.13026751893939392}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.10000000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 2.479879124888209, "policy_loss": -0.014440517409914925, "vf_loss": 2.493422582296915, "vf_explained_var": 0.33388007731847863, "kl": 0.008970586459055178, "entropy": 0.9011706973916741, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 17205.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_agent_steps_sampled": 76000, "num_agent_steps_trained": 76000}, "sampler_results": {"episode_reward_max": -3.200000000000001, "episode_reward_min": -68.00000000000036, "episode_reward_mean": -13.488000000000017, "episode_len_mean": 127.86, "episode_media": {}, "episodes_this_iter": 36, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8.299999999999985, -9.799999999999978, -41.20000000000006, -19.80000000000002, -10.899999999999974, -6.999999999999988, -5.699999999999994, -12.499999999999968, -10.599999999999975, -8.299999999999983, -11.499999999999972, -7.3999999999999915, -7.099999999999987, -11.499999999999982, -12.299999999999969, -10.399999999999975, -12.199999999999969, -5.999999999999991, -10.999999999999973, -6.99999999999999, -12.199999999999985, -7.899999999999984, -45.90000000000034, -3.200000000000001, -53.10000000000033, -13.099999999999984, -5.199999999999994, -4.299999999999998, -68.00000000000036, -7.699999999999987, -52.70000000000027, -4.699999999999996, -8.699999999999985, -12.79999999999998, -5.699999999999992, -20.299999999999983, -20.20000000000004, -35.70000000000012, -5.499999999999993, -10.299999999999994, -7.4999999999999964, -16.899999999999977, -6.29999999999999, -7.499999999999986, -13.899999999999963, -9.999999999999977, -14.199999999999962, -4.899999999999995, -4.799999999999998, -9.699999999999978, -11.69999999999997, -49.800000000000374, -9.999999999999977, -7.599999999999985, -5.499999999999993, -6.299999999999994, -9.599999999999984, -9.099999999999985, -7.2999999999999865, -15.89999999999997, -8.799999999999992, -9.799999999999992, -5.699999999999992, -6.2999999999999945, -42.400000000000304, -41.500000000000135, -17.499999999999968, -4.699999999999998, -4.399999999999997, -8.599999999999984, -6.0999999999999925, -7.699999999999985, -5.8999999999999915, -9.599999999999978, -52.40000000000024, -8.89999999999998, -15.499999999999961, -12.59999999999998, -6.899999999999992, -7.199999999999987, -23.200000000000045, -6.599999999999989, -8.299999999999983, -14.499999999999961, -6.199999999999992, -4.799999999999995, -8.699999999999985, -7.199999999999987, -7.2999999999999865, -8.19999999999999, -5.599999999999993, -5.299999999999994, -11.49999999999998, -8.89999999999998, -44.60000000000035, -7.099999999999989, -7.499999999999986, -6.099999999999994, -8.39999999999999, -10.099999999999985], "episode_lengths": [85, 109, 308, 205, 112, 81, 62, 136, 113, 94, 126, 79, 77, 109, 134, 115, 128, 71, 121, 77, 100, 90, 400, 43, 388, 91, 63, 53, 400, 86, 400, 50, 79, 124, 68, 200, 198, 313, 66, 90, 68, 150, 74, 86, 134, 111, 148, 60, 52, 108, 128, 400, 111, 86, 66, 67, 96, 94, 76, 170, 85, 88, 68, 69, 400, 357, 179, 55, 55, 93, 70, 88, 70, 107, 400, 100, 150, 114, 72, 83, 232, 77, 94, 156, 71, 56, 84, 83, 84, 86, 57, 62, 106, 98, 400, 73, 86, 68, 82, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.250945517620414, "mean_inference_ms": 0.7276973747198131, "mean_action_processing_ms": 0.0759157281063284, "mean_env_wait_ms": 6.342480936067809, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006868124008178711, "StateBufferConnector_ms": 0.00398564338684082, "ViewRequirementAgentConnector_ms": 0.09044647216796875}}, "episode_reward_max": -3.200000000000001, "episode_reward_min": -68.00000000000036, "episode_reward_mean": -13.488000000000017, "episode_len_mean": 127.86, "episodes_this_iter": 36, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-8.299999999999985, -9.799999999999978, -41.20000000000006, -19.80000000000002, -10.899999999999974, -6.999999999999988, -5.699999999999994, -12.499999999999968, -10.599999999999975, -8.299999999999983, -11.499999999999972, -7.3999999999999915, -7.099999999999987, -11.499999999999982, -12.299999999999969, -10.399999999999975, -12.199999999999969, -5.999999999999991, -10.999999999999973, -6.99999999999999, -12.199999999999985, -7.899999999999984, -45.90000000000034, -3.200000000000001, -53.10000000000033, -13.099999999999984, -5.199999999999994, -4.299999999999998, -68.00000000000036, -7.699999999999987, -52.70000000000027, -4.699999999999996, -8.699999999999985, -12.79999999999998, -5.699999999999992, -20.299999999999983, -20.20000000000004, -35.70000000000012, -5.499999999999993, -10.299999999999994, -7.4999999999999964, -16.899999999999977, -6.29999999999999, -7.499999999999986, -13.899999999999963, -9.999999999999977, -14.199999999999962, -4.899999999999995, -4.799999999999998, -9.699999999999978, -11.69999999999997, -49.800000000000374, -9.999999999999977, -7.599999999999985, -5.499999999999993, -6.299999999999994, -9.599999999999984, -9.099999999999985, -7.2999999999999865, -15.89999999999997, -8.799999999999992, -9.799999999999992, -5.699999999999992, -6.2999999999999945, -42.400000000000304, -41.500000000000135, -17.499999999999968, -4.699999999999998, -4.399999999999997, -8.599999999999984, -6.0999999999999925, -7.699999999999985, -5.8999999999999915, -9.599999999999978, -52.40000000000024, -8.89999999999998, -15.499999999999961, -12.59999999999998, -6.899999999999992, -7.199999999999987, -23.200000000000045, -6.599999999999989, -8.299999999999983, -14.499999999999961, -6.199999999999992, -4.799999999999995, -8.699999999999985, -7.199999999999987, -7.2999999999999865, -8.19999999999999, -5.599999999999993, -5.299999999999994, -11.49999999999998, -8.89999999999998, -44.60000000000035, -7.099999999999989, -7.499999999999986, -6.099999999999994, -8.39999999999999, -10.099999999999985], "episode_lengths": [85, 109, 308, 205, 112, 81, 62, 136, 113, 94, 126, 79, 77, 109, 134, 115, 128, 71, 121, 77, 100, 90, 400, 43, 388, 91, 63, 53, 400, 86, 400, 50, 79, 124, 68, 200, 198, 313, 66, 90, 68, 150, 74, 86, 134, 111, 148, 60, 52, 108, 128, 400, 111, 86, 66, 67, 96, 94, 76, 170, 85, 88, 68, 69, 400, 357, 179, 55, 55, 93, 70, 88, 70, 107, 400, 100, 150, 114, 72, 83, 232, 77, 94, 156, 71, 56, 84, 83, 84, 86, 57, 62, 106, 98, 400, 73, 86, 68, 82, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.250945517620414, "mean_inference_ms": 0.7276973747198131, "mean_action_processing_ms": 0.0759157281063284, "mean_env_wait_ms": 6.342480936067809, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006868124008178711, "StateBufferConnector_ms": 0.00398564338684082, "ViewRequirementAgentConnector_ms": 0.09044647216796875}, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 76000, "num_agent_steps_trained": 76000, "num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 446.393802068019, "num_env_steps_trained_throughput_per_sec": 446.393802068019, "timesteps_total": 76000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 76000, "timers": {"training_iteration_time_ms": 8854.999, "sample_time_ms": 5098.905, "load_time_ms": 1.089, "load_throughput": 3671886.367, "learn_time_ms": 3752.138, "learn_throughput": 1066.059, "synch_weights_time_ms": 2.199}, "counters": {"num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_agent_steps_sampled": 76000, "num_agent_steps_trained": 76000}, "done": false, "episodes_total": 444, "training_iteration": 19, "trial_id": "ddfb6_00000", "date": "2024-03-07_12-51-07", "timestamp": 1709833867, "time_this_iter_s": 8.963372707366943, "time_total_s": 168.14538097381592, "pid": 112355, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4d85689f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 168.14538097381592, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 26.36666666666667, "ram_util_percent": 51.70000000000001, "gpu_util_percent0": 0.11249999999999999, "vram_util_percent0": 0.12977430555555555}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.10000000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 3.2421667564649046, "policy_loss": -0.004849883605555822, "vf_loss": 3.246411434617094, "vf_explained_var": 0.31170325503554397, "kl": 0.00605194629156896, "entropy": 0.9042390724023183, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 18135.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000}, "sampler_results": {"episode_reward_max": -4.399999999999997, "episode_reward_min": -54.00000000000045, "episode_reward_mean": -12.441000000000015, "episode_len_mean": 119.44, "episode_media": {}, "episodes_this_iter": 36, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-20.20000000000004, -35.70000000000012, -5.499999999999993, -10.299999999999994, -7.4999999999999964, -16.899999999999977, -6.29999999999999, -7.499999999999986, -13.899999999999963, -9.999999999999977, -14.199999999999962, -4.899999999999995, -4.799999999999998, -9.699999999999978, -11.69999999999997, -49.800000000000374, -9.999999999999977, -7.599999999999985, -5.499999999999993, -6.299999999999994, -9.599999999999984, -9.099999999999985, -7.2999999999999865, -15.89999999999997, -8.799999999999992, -9.799999999999992, -5.699999999999992, -6.2999999999999945, -42.400000000000304, -41.500000000000135, -17.499999999999968, -4.699999999999998, -4.399999999999997, -8.599999999999984, -6.0999999999999925, -7.699999999999985, -5.8999999999999915, -9.599999999999978, -52.40000000000024, -8.89999999999998, -15.499999999999961, -12.59999999999998, -6.899999999999992, -7.199999999999987, -23.200000000000045, -6.599999999999989, -8.299999999999983, -14.499999999999961, -6.199999999999992, -4.799999999999995, -8.699999999999985, -7.199999999999987, -7.2999999999999865, -8.19999999999999, -5.599999999999993, -5.299999999999994, -11.49999999999998, -8.89999999999998, -44.60000000000035, -7.099999999999989, -7.499999999999986, -6.099999999999994, -8.39999999999999, -10.099999999999985, -6.4, -12.099999999999977, -53.600000000000236, -6.399999999999991, -9.899999999999979, -6.899999999999988, -54.00000000000045, -7.499999999999989, -6.099999999999991, -8.89999999999998, -9.799999999999981, -50.100000000000236, -8.599999999999989, -8.099999999999994, -7.0999999999999925, -6.499999999999989, -13.29999999999998, -9.499999999999982, -8.999999999999988, -9.099999999999987, -7.099999999999987, -6.39999999999999, -10.39999999999998, -7.799999999999985, -7.799999999999985, -7.899999999999984, -28.50000000000003, -11.799999999999974, -7.599999999999985, -5.599999999999993, -14.099999999999962, -5.199999999999994, -8.399999999999986, -6.19999999999999, -7.599999999999989, -5.999999999999993], "episode_lengths": [198, 313, 66, 90, 68, 150, 74, 86, 134, 111, 148, 60, 52, 108, 128, 400, 111, 86, 66, 67, 96, 94, 76, 170, 85, 88, 68, 69, 400, 357, 179, 55, 55, 93, 70, 88, 70, 107, 400, 100, 150, 114, 72, 83, 232, 77, 94, 156, 71, 56, 84, 83, 84, 86, 57, 62, 106, 98, 400, 73, 86, 68, 82, 99, 63, 114, 400, 74, 106, 75, 400, 76, 72, 100, 84, 400, 84, 77, 77, 76, 103, 93, 77, 82, 82, 75, 90, 89, 89, 90, 209, 120, 87, 66, 140, 57, 86, 73, 80, 69]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.25279105404602864, "mean_inference_ms": 0.7286340765455676, "mean_action_processing_ms": 0.07601015214360217, "mean_env_wait_ms": 6.358302741136751, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007078886032104492, "StateBufferConnector_ms": 0.004082202911376953, "ViewRequirementAgentConnector_ms": 0.09221172332763672}}, "episode_reward_max": -4.399999999999997, "episode_reward_min": -54.00000000000045, "episode_reward_mean": -12.441000000000015, "episode_len_mean": 119.44, "episodes_this_iter": 36, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-20.20000000000004, -35.70000000000012, -5.499999999999993, -10.299999999999994, -7.4999999999999964, -16.899999999999977, -6.29999999999999, -7.499999999999986, -13.899999999999963, -9.999999999999977, -14.199999999999962, -4.899999999999995, -4.799999999999998, -9.699999999999978, -11.69999999999997, -49.800000000000374, -9.999999999999977, -7.599999999999985, -5.499999999999993, -6.299999999999994, -9.599999999999984, -9.099999999999985, -7.2999999999999865, -15.89999999999997, -8.799999999999992, -9.799999999999992, -5.699999999999992, -6.2999999999999945, -42.400000000000304, -41.500000000000135, -17.499999999999968, -4.699999999999998, -4.399999999999997, -8.599999999999984, -6.0999999999999925, -7.699999999999985, -5.8999999999999915, -9.599999999999978, -52.40000000000024, -8.89999999999998, -15.499999999999961, -12.59999999999998, -6.899999999999992, -7.199999999999987, -23.200000000000045, -6.599999999999989, -8.299999999999983, -14.499999999999961, -6.199999999999992, -4.799999999999995, -8.699999999999985, -7.199999999999987, -7.2999999999999865, -8.19999999999999, -5.599999999999993, -5.299999999999994, -11.49999999999998, -8.89999999999998, -44.60000000000035, -7.099999999999989, -7.499999999999986, -6.099999999999994, -8.39999999999999, -10.099999999999985, -6.4, -12.099999999999977, -53.600000000000236, -6.399999999999991, -9.899999999999979, -6.899999999999988, -54.00000000000045, -7.499999999999989, -6.099999999999991, -8.89999999999998, -9.799999999999981, -50.100000000000236, -8.599999999999989, -8.099999999999994, -7.0999999999999925, -6.499999999999989, -13.29999999999998, -9.499999999999982, -8.999999999999988, -9.099999999999987, -7.099999999999987, -6.39999999999999, -10.39999999999998, -7.799999999999985, -7.799999999999985, -7.899999999999984, -28.50000000000003, -11.799999999999974, -7.599999999999985, -5.599999999999993, -14.099999999999962, -5.199999999999994, -8.399999999999986, -6.19999999999999, -7.599999999999989, -5.999999999999993], "episode_lengths": [198, 313, 66, 90, 68, 150, 74, 86, 134, 111, 148, 60, 52, 108, 128, 400, 111, 86, 66, 67, 96, 94, 76, 170, 85, 88, 68, 69, 400, 357, 179, 55, 55, 93, 70, 88, 70, 107, 400, 100, 150, 114, 72, 83, 232, 77, 94, 156, 71, 56, 84, 83, 84, 86, 57, 62, 106, 98, 400, 73, 86, 68, 82, 99, 63, 114, 400, 74, 106, 75, 400, 76, 72, 100, 84, 400, 84, 77, 77, 76, 103, 93, 77, 82, 82, 75, 90, 89, 89, 90, 209, 120, 87, 66, 140, 57, 86, 73, 80, 69]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.25279105404602864, "mean_inference_ms": 0.7286340765455676, "mean_action_processing_ms": 0.07601015214360217, "mean_env_wait_ms": 6.358302741136751, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007078886032104492, "StateBufferConnector_ms": 0.004082202911376953, "ViewRequirementAgentConnector_ms": 0.09221172332763672}, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000, "num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 425.5795348622951, "num_env_steps_trained_throughput_per_sec": 425.5795348622951, "timesteps_total": 80000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 80000, "timers": {"training_iteration_time_ms": 8930.357, "sample_time_ms": 5154.308, "load_time_ms": 1.065, "load_throughput": 3754804.172, "learn_time_ms": 3772.179, "learn_throughput": 1060.395, "synch_weights_time_ms": 2.162}, "counters": {"num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000}, "done": false, "episodes_total": 480, "training_iteration": 20, "trial_id": "ddfb6_00000", "date": "2024-03-07_12-51-17", "timestamp": 1709833877, "time_this_iter_s": 9.401333808898926, "time_total_s": 177.54671478271484, "pid": 112355, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4d85689f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 177.54671478271484, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 30.425, "ram_util_percent": 52.14166666666667, "gpu_util_percent0": 0.11583333333333333, "vram_util_percent0": 0.12908935546874997}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.10000000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 2.760985467026651, "policy_loss": -0.009734858244016606, "vf_loss": 2.7694217841471396, "vf_explained_var": 0.5451326044656897, "kl": 0.012985425425639165, "entropy": 0.8888356064596484, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 19065.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 84000}, "sampler_results": {"episode_reward_max": -3.200000000000001, "episode_reward_min": -54.00000000000045, "episode_reward_mean": -10.792000000000007, "episode_len_mean": 102.52, "episode_media": {}, "episodes_this_iter": 44, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-23.200000000000045, -6.599999999999989, -8.299999999999983, -14.499999999999961, -6.199999999999992, -4.799999999999995, -8.699999999999985, -7.199999999999987, -7.2999999999999865, -8.19999999999999, -5.599999999999993, -5.299999999999994, -11.49999999999998, -8.89999999999998, -44.60000000000035, -7.099999999999989, -7.499999999999986, -6.099999999999994, -8.39999999999999, -10.099999999999985, -6.4, -12.099999999999977, -53.600000000000236, -6.399999999999991, -9.899999999999979, -6.899999999999988, -54.00000000000045, -7.499999999999989, -6.099999999999991, -8.89999999999998, -9.799999999999981, -50.100000000000236, -8.599999999999989, -8.099999999999994, -7.0999999999999925, -6.499999999999989, -13.29999999999998, -9.499999999999982, -8.999999999999988, -9.099999999999987, -7.099999999999987, -6.39999999999999, -10.39999999999998, -7.799999999999985, -7.799999999999985, -7.899999999999984, -28.50000000000003, -11.799999999999974, -7.599999999999985, -5.599999999999993, -14.099999999999962, -5.199999999999994, -8.399999999999986, -6.19999999999999, -7.599999999999989, -5.999999999999993, -9.49999999999998, -8.599999999999989, -6.999999999999991, -6.399999999999991, -3.200000000000001, -4.4999999999999964, -10.799999999999983, -6.699999999999998, -6.899999999999998, -8.499999999999984, -41.200000000000045, -6.999999999999992, -16.499999999999986, -4.299999999999997, -5.899999999999997, -5.799999999999992, -11.999999999999973, -6.399999999999998, -5.699999999999993, -5.399999999999993, -9.099999999999989, -5.799999999999994, -9.199999999999985, -53.500000000000334, -5.199999999999994, -9.19999999999998, -7.399999999999986, -5.299999999999994, -9.299999999999994, -7.799999999999985, -3.3000000000000007, -4.4999999999999964, -8.299999999999983, -5.999999999999991, -6.499999999999993, -6.399999999999993, -5.899999999999996, -10.39999999999998, -3.8999999999999986, -4.799999999999999, -11.299999999999972, -10.39999999999999, -17.599999999999962, -14.399999999999977], "episode_lengths": [232, 77, 94, 156, 71, 56, 84, 83, 84, 86, 57, 62, 106, 98, 400, 73, 86, 68, 82, 99, 63, 114, 400, 74, 106, 75, 400, 76, 72, 100, 84, 400, 84, 77, 77, 76, 103, 93, 77, 82, 82, 75, 90, 89, 89, 90, 209, 120, 87, 66, 140, 57, 86, 73, 80, 69, 95, 87, 77, 74, 43, 50, 101, 62, 68, 86, 278, 76, 136, 54, 64, 69, 116, 66, 67, 65, 81, 65, 82, 400, 63, 103, 85, 64, 83, 77, 44, 56, 94, 71, 72, 61, 65, 94, 50, 55, 124, 89, 141, 110]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2539436254333127, "mean_inference_ms": 0.728945099243499, "mean_action_processing_ms": 0.07597095989392073, "mean_env_wait_ms": 6.364483215259741, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007078647613525391, "StateBufferConnector_ms": 0.004042863845825195, "ViewRequirementAgentConnector_ms": 0.09103107452392578}}, "episode_reward_max": -3.200000000000001, "episode_reward_min": -54.00000000000045, "episode_reward_mean": -10.792000000000007, "episode_len_mean": 102.52, "episodes_this_iter": 44, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-23.200000000000045, -6.599999999999989, -8.299999999999983, -14.499999999999961, -6.199999999999992, -4.799999999999995, -8.699999999999985, -7.199999999999987, -7.2999999999999865, -8.19999999999999, -5.599999999999993, -5.299999999999994, -11.49999999999998, -8.89999999999998, -44.60000000000035, -7.099999999999989, -7.499999999999986, -6.099999999999994, -8.39999999999999, -10.099999999999985, -6.4, -12.099999999999977, -53.600000000000236, -6.399999999999991, -9.899999999999979, -6.899999999999988, -54.00000000000045, -7.499999999999989, -6.099999999999991, -8.89999999999998, -9.799999999999981, -50.100000000000236, -8.599999999999989, -8.099999999999994, -7.0999999999999925, -6.499999999999989, -13.29999999999998, -9.499999999999982, -8.999999999999988, -9.099999999999987, -7.099999999999987, -6.39999999999999, -10.39999999999998, -7.799999999999985, -7.799999999999985, -7.899999999999984, -28.50000000000003, -11.799999999999974, -7.599999999999985, -5.599999999999993, -14.099999999999962, -5.199999999999994, -8.399999999999986, -6.19999999999999, -7.599999999999989, -5.999999999999993, -9.49999999999998, -8.599999999999989, -6.999999999999991, -6.399999999999991, -3.200000000000001, -4.4999999999999964, -10.799999999999983, -6.699999999999998, -6.899999999999998, -8.499999999999984, -41.200000000000045, -6.999999999999992, -16.499999999999986, -4.299999999999997, -5.899999999999997, -5.799999999999992, -11.999999999999973, -6.399999999999998, -5.699999999999993, -5.399999999999993, -9.099999999999989, -5.799999999999994, -9.199999999999985, -53.500000000000334, -5.199999999999994, -9.19999999999998, -7.399999999999986, -5.299999999999994, -9.299999999999994, -7.799999999999985, -3.3000000000000007, -4.4999999999999964, -8.299999999999983, -5.999999999999991, -6.499999999999993, -6.399999999999993, -5.899999999999996, -10.39999999999998, -3.8999999999999986, -4.799999999999999, -11.299999999999972, -10.39999999999999, -17.599999999999962, -14.399999999999977], "episode_lengths": [232, 77, 94, 156, 71, 56, 84, 83, 84, 86, 57, 62, 106, 98, 400, 73, 86, 68, 82, 99, 63, 114, 400, 74, 106, 75, 400, 76, 72, 100, 84, 400, 84, 77, 77, 76, 103, 93, 77, 82, 82, 75, 90, 89, 89, 90, 209, 120, 87, 66, 140, 57, 86, 73, 80, 69, 95, 87, 77, 74, 43, 50, 101, 62, 68, 86, 278, 76, 136, 54, 64, 69, 116, 66, 67, 65, 81, 65, 82, 400, 63, 103, 85, 64, 83, 77, 44, 56, 94, 71, 72, 61, 65, 94, 50, 55, 124, 89, 141, 110]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2539436254333127, "mean_inference_ms": 0.728945099243499, "mean_action_processing_ms": 0.07597095989392073, "mean_env_wait_ms": 6.364483215259741, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007078647613525391, "StateBufferConnector_ms": 0.004042863845825195, "ViewRequirementAgentConnector_ms": 0.09103107452392578}, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 84000, "num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 446.903621361766, "num_env_steps_trained_throughput_per_sec": 446.903621361766, "timesteps_total": 84000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 84000, "timers": {"training_iteration_time_ms": 8949.87, "sample_time_ms": 5178.119, "load_time_ms": 1.07, "load_throughput": 3737406.104, "learn_time_ms": 3767.88, "learn_throughput": 1061.605, "synch_weights_time_ms": 2.159}, "counters": {"num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 84000}, "done": false, "episodes_total": 524, "training_iteration": 21, "trial_id": "ddfb6_00000", "date": "2024-03-07_12-51-26", "timestamp": 1709833886, "time_this_iter_s": 8.953014373779297, "time_total_s": 186.49972915649414, "pid": 112355, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4d85689f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 186.49972915649414, "iterations_since_restore": 21, "perf": {"cpu_util_percent": 27.245454545454546, "ram_util_percent": 52.03636363636363, "gpu_util_percent0": 0.08818181818181818, "vram_util_percent0": 0.12857333096590906}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.10000000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 2.1624530219191294, "policy_loss": -0.008143974478126214, "vf_loss": 2.169661765938164, "vf_explained_var": 0.583570872647788, "kl": 0.009352329942750304, "entropy": 0.8584571753778766, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 19995.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_agent_steps_sampled": 88000, "num_agent_steps_trained": 88000}, "sampler_results": {"episode_reward_max": -2.5000000000000018, "episode_reward_min": -53.500000000000334, "episode_reward_mean": -8.576999999999998, "episode_len_mean": 84.87, "episode_media": {}, "episodes_this_iter": 50, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-14.099999999999962, -5.199999999999994, -8.399999999999986, -6.19999999999999, -7.599999999999989, -5.999999999999993, -9.49999999999998, -8.599999999999989, -6.999999999999991, -6.399999999999991, -3.200000000000001, -4.4999999999999964, -10.799999999999983, -6.699999999999998, -6.899999999999998, -8.499999999999984, -41.200000000000045, -6.999999999999992, -16.499999999999986, -4.299999999999997, -5.899999999999997, -5.799999999999992, -11.999999999999973, -6.399999999999998, -5.699999999999993, -5.399999999999993, -9.099999999999989, -5.799999999999994, -9.199999999999985, -53.500000000000334, -5.199999999999994, -9.19999999999998, -7.399999999999986, -5.299999999999994, -9.299999999999994, -7.799999999999985, -3.3000000000000007, -4.4999999999999964, -8.299999999999983, -5.999999999999991, -6.499999999999993, -6.399999999999993, -5.899999999999996, -10.39999999999998, -3.8999999999999986, -4.799999999999999, -11.299999999999972, -10.39999999999999, -17.599999999999962, -14.399999999999977, -9.399999999999983, -3.8999999999999995, -4.099999999999998, -4.699999999999996, -5.099999999999995, -47.80000000000029, -6.0999999999999925, -7.5999999999999925, -5.999999999999995, -6.499999999999989, -8.09999999999999, -5.099999999999994, -8.099999999999987, -10.399999999999975, -8.499999999999982, -5.299999999999994, -3.6999999999999993, -5.999999999999992, -7.399999999999986, -8.099999999999989, -6.699999999999991, -3.5999999999999996, -3.9999999999999982, -4.699999999999996, -10.199999999999987, -8.299999999999986, -7.799999999999999, -3.799999999999999, -2.5000000000000018, -7.399999999999993, -8.399999999999995, -11.499999999999988, -5.799999999999992, -2.900000000000002, -5.799999999999994, -6.999999999999988, -10.899999999999988, -5.199999999999994, -3.8999999999999986, -5.6999999999999975, -10.999999999999991, -10.29999999999998, -5.799999999999995, -8.699999999999983, -5.999999999999994, -16.49999999999996, -4.599999999999996, -7.400000000000002, -8.399999999999988, -15.699999999999967], "episode_lengths": [140, 57, 86, 73, 80, 69, 95, 87, 77, 74, 43, 50, 101, 62, 68, 86, 278, 76, 136, 54, 64, 69, 116, 66, 67, 65, 81, 65, 82, 400, 63, 103, 85, 64, 83, 77, 44, 56, 94, 71, 72, 61, 65, 94, 50, 55, 124, 89, 141, 110, 99, 48, 52, 54, 51, 381, 69, 77, 67, 76, 79, 62, 84, 115, 96, 64, 48, 70, 85, 84, 75, 47, 50, 57, 98, 85, 71, 45, 36, 78, 73, 102, 69, 40, 67, 81, 93, 63, 50, 62, 91, 96, 65, 87, 65, 161, 53, 66, 84, 148]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2557048730203484, "mean_inference_ms": 0.7288486987527609, "mean_action_processing_ms": 0.07597752358524577, "mean_env_wait_ms": 6.381355090445762, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006987810134887695, "StateBufferConnector_ms": 0.003989696502685547, "ViewRequirementAgentConnector_ms": 0.08965611457824707}}, "episode_reward_max": -2.5000000000000018, "episode_reward_min": -53.500000000000334, "episode_reward_mean": -8.576999999999998, "episode_len_mean": 84.87, "episodes_this_iter": 50, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-14.099999999999962, -5.199999999999994, -8.399999999999986, -6.19999999999999, -7.599999999999989, -5.999999999999993, -9.49999999999998, -8.599999999999989, -6.999999999999991, -6.399999999999991, -3.200000000000001, -4.4999999999999964, -10.799999999999983, -6.699999999999998, -6.899999999999998, -8.499999999999984, -41.200000000000045, -6.999999999999992, -16.499999999999986, -4.299999999999997, -5.899999999999997, -5.799999999999992, -11.999999999999973, -6.399999999999998, -5.699999999999993, -5.399999999999993, -9.099999999999989, -5.799999999999994, -9.199999999999985, -53.500000000000334, -5.199999999999994, -9.19999999999998, -7.399999999999986, -5.299999999999994, -9.299999999999994, -7.799999999999985, -3.3000000000000007, -4.4999999999999964, -8.299999999999983, -5.999999999999991, -6.499999999999993, -6.399999999999993, -5.899999999999996, -10.39999999999998, -3.8999999999999986, -4.799999999999999, -11.299999999999972, -10.39999999999999, -17.599999999999962, -14.399999999999977, -9.399999999999983, -3.8999999999999995, -4.099999999999998, -4.699999999999996, -5.099999999999995, -47.80000000000029, -6.0999999999999925, -7.5999999999999925, -5.999999999999995, -6.499999999999989, -8.09999999999999, -5.099999999999994, -8.099999999999987, -10.399999999999975, -8.499999999999982, -5.299999999999994, -3.6999999999999993, -5.999999999999992, -7.399999999999986, -8.099999999999989, -6.699999999999991, -3.5999999999999996, -3.9999999999999982, -4.699999999999996, -10.199999999999987, -8.299999999999986, -7.799999999999999, -3.799999999999999, -2.5000000000000018, -7.399999999999993, -8.399999999999995, -11.499999999999988, -5.799999999999992, -2.900000000000002, -5.799999999999994, -6.999999999999988, -10.899999999999988, -5.199999999999994, -3.8999999999999986, -5.6999999999999975, -10.999999999999991, -10.29999999999998, -5.799999999999995, -8.699999999999983, -5.999999999999994, -16.49999999999996, -4.599999999999996, -7.400000000000002, -8.399999999999988, -15.699999999999967], "episode_lengths": [140, 57, 86, 73, 80, 69, 95, 87, 77, 74, 43, 50, 101, 62, 68, 86, 278, 76, 136, 54, 64, 69, 116, 66, 67, 65, 81, 65, 82, 400, 63, 103, 85, 64, 83, 77, 44, 56, 94, 71, 72, 61, 65, 94, 50, 55, 124, 89, 141, 110, 99, 48, 52, 54, 51, 381, 69, 77, 67, 76, 79, 62, 84, 115, 96, 64, 48, 70, 85, 84, 75, 47, 50, 57, 98, 85, 71, 45, 36, 78, 73, 102, 69, 40, 67, 81, 93, 63, 50, 62, 91, 96, 65, 87, 65, 161, 53, 66, 84, 148]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2557048730203484, "mean_inference_ms": 0.7288486987527609, "mean_action_processing_ms": 0.07597752358524577, "mean_env_wait_ms": 6.381355090445762, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006987810134887695, "StateBufferConnector_ms": 0.003989696502685547, "ViewRequirementAgentConnector_ms": 0.08965611457824707}, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 88000, "num_agent_steps_trained": 88000, "num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 427.24359589780124, "num_env_steps_trained_throughput_per_sec": 427.24359589780124, "timesteps_total": 88000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 88000, "timers": {"training_iteration_time_ms": 8987.52, "sample_time_ms": 5201.33, "load_time_ms": 1.069, "load_throughput": 3743076.168, "learn_time_ms": 3782.365, "learn_throughput": 1057.54, "synch_weights_time_ms": 2.115}, "counters": {"num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_agent_steps_sampled": 88000, "num_agent_steps_trained": 88000}, "done": false, "episodes_total": 574, "training_iteration": 22, "trial_id": "ddfb6_00000", "date": "2024-03-07_12-51-35", "timestamp": 1709833895, "time_this_iter_s": 9.364847421646118, "time_total_s": 195.86457657814026, "pid": 112355, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4d85689f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 195.86457657814026, "iterations_since_restore": 22, "perf": {"cpu_util_percent": 27.141666666666666, "ram_util_percent": 51.96666666666667, "gpu_util_percent0": 0.12083333333333333, "vram_util_percent0": 0.12910970052083334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.10000000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 2.6520885814527695, "policy_loss": -0.005271734946197079, "vf_loss": 2.6565046138100086, "vf_explained_var": 0.4497472781007008, "kl": 0.008556914186626654, "entropy": 0.8281688710053762, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 20925.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_agent_steps_sampled": 92000, "num_agent_steps_trained": 92000}, "sampler_results": {"episode_reward_max": -2.5000000000000018, "episode_reward_min": -65.90000000000032, "episode_reward_mean": -8.497999999999998, "episode_len_mean": 83.38, "episode_media": {}, "episodes_this_iter": 43, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10.39999999999998, -3.8999999999999986, -4.799999999999999, -11.299999999999972, -10.39999999999999, -17.599999999999962, -14.399999999999977, -9.399999999999983, -3.8999999999999995, -4.099999999999998, -4.699999999999996, -5.099999999999995, -47.80000000000029, -6.0999999999999925, -7.5999999999999925, -5.999999999999995, -6.499999999999989, -8.09999999999999, -5.099999999999994, -8.099999999999987, -10.399999999999975, -8.499999999999982, -5.299999999999994, -3.6999999999999993, -5.999999999999992, -7.399999999999986, -8.099999999999989, -6.699999999999991, -3.5999999999999996, -3.9999999999999982, -4.699999999999996, -10.199999999999987, -8.299999999999986, -7.799999999999999, -3.799999999999999, -2.5000000000000018, -7.399999999999993, -8.399999999999995, -11.499999999999988, -5.799999999999992, -2.900000000000002, -5.799999999999994, -6.999999999999988, -10.899999999999988, -5.199999999999994, -3.8999999999999986, -5.6999999999999975, -10.999999999999991, -10.29999999999998, -5.799999999999995, -8.699999999999983, -5.999999999999994, -16.49999999999996, -4.599999999999996, -7.400000000000002, -8.399999999999988, -15.699999999999967, -9.999999999999984, -12.799999999999976, -22.200000000000035, -6.599999999999989, -7.299999999999988, -10.699999999999974, -9.19999999999998, -7.999999999999989, -7.2999999999999865, -7.699999999999985, -5.699999999999994, -7.0000000000000036, -2.900000000000002, -2.5000000000000018, -6.999999999999995, -4.999999999999997, -10.999999999999973, -4.399999999999997, -7.299999999999999, -5.099999999999994, -5.599999999999994, -18.2, -8.899999999999984, -6.799999999999991, -9.499999999999982, -6.499999999999994, -8.099999999999996, -5.299999999999999, -5.4999999999999964, -65.90000000000032, -10.29999999999998, -8.599999999999993, -6.1999999999999975, -6.799999999999988, -6.499999999999992, -7.899999999999995, -4.799999999999995, -5.899999999999996, -6.299999999999998, -5.199999999999999, -6.299999999999993, -4.699999999999996, -5.099999999999994], "episode_lengths": [94, 50, 55, 124, 89, 141, 110, 99, 48, 52, 54, 51, 381, 69, 77, 67, 76, 79, 62, 84, 115, 96, 64, 48, 70, 85, 84, 75, 47, 50, 57, 98, 85, 71, 45, 36, 78, 73, 102, 69, 40, 67, 81, 93, 63, 50, 62, 91, 96, 65, 87, 65, 161, 53, 66, 84, 148, 89, 107, 214, 77, 79, 101, 94, 82, 84, 88, 66, 64, 39, 36, 71, 54, 120, 55, 70, 58, 63, 138, 86, 76, 93, 71, 71, 58, 62, 400, 99, 83, 65, 76, 67, 76, 59, 59, 65, 57, 68, 54, 62]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.25742572065651276, "mean_inference_ms": 0.729882688431249, "mean_action_processing_ms": 0.07608298395117251, "mean_env_wait_ms": 6.404861373946678, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0071599483489990234, "StateBufferConnector_ms": 0.004113674163818359, "ViewRequirementAgentConnector_ms": 0.09344148635864258}}, "episode_reward_max": -2.5000000000000018, "episode_reward_min": -65.90000000000032, "episode_reward_mean": -8.497999999999998, "episode_len_mean": 83.38, "episodes_this_iter": 43, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10.39999999999998, -3.8999999999999986, -4.799999999999999, -11.299999999999972, -10.39999999999999, -17.599999999999962, -14.399999999999977, -9.399999999999983, -3.8999999999999995, -4.099999999999998, -4.699999999999996, -5.099999999999995, -47.80000000000029, -6.0999999999999925, -7.5999999999999925, -5.999999999999995, -6.499999999999989, -8.09999999999999, -5.099999999999994, -8.099999999999987, -10.399999999999975, -8.499999999999982, -5.299999999999994, -3.6999999999999993, -5.999999999999992, -7.399999999999986, -8.099999999999989, -6.699999999999991, -3.5999999999999996, -3.9999999999999982, -4.699999999999996, -10.199999999999987, -8.299999999999986, -7.799999999999999, -3.799999999999999, -2.5000000000000018, -7.399999999999993, -8.399999999999995, -11.499999999999988, -5.799999999999992, -2.900000000000002, -5.799999999999994, -6.999999999999988, -10.899999999999988, -5.199999999999994, -3.8999999999999986, -5.6999999999999975, -10.999999999999991, -10.29999999999998, -5.799999999999995, -8.699999999999983, -5.999999999999994, -16.49999999999996, -4.599999999999996, -7.400000000000002, -8.399999999999988, -15.699999999999967, -9.999999999999984, -12.799999999999976, -22.200000000000035, -6.599999999999989, -7.299999999999988, -10.699999999999974, -9.19999999999998, -7.999999999999989, -7.2999999999999865, -7.699999999999985, -5.699999999999994, -7.0000000000000036, -2.900000000000002, -2.5000000000000018, -6.999999999999995, -4.999999999999997, -10.999999999999973, -4.399999999999997, -7.299999999999999, -5.099999999999994, -5.599999999999994, -18.2, -8.899999999999984, -6.799999999999991, -9.499999999999982, -6.499999999999994, -8.099999999999996, -5.299999999999999, -5.4999999999999964, -65.90000000000032, -10.29999999999998, -8.599999999999993, -6.1999999999999975, -6.799999999999988, -6.499999999999992, -7.899999999999995, -4.799999999999995, -5.899999999999996, -6.299999999999998, -5.199999999999999, -6.299999999999993, -4.699999999999996, -5.099999999999994], "episode_lengths": [94, 50, 55, 124, 89, 141, 110, 99, 48, 52, 54, 51, 381, 69, 77, 67, 76, 79, 62, 84, 115, 96, 64, 48, 70, 85, 84, 75, 47, 50, 57, 98, 85, 71, 45, 36, 78, 73, 102, 69, 40, 67, 81, 93, 63, 50, 62, 91, 96, 65, 87, 65, 161, 53, 66, 84, 148, 89, 107, 214, 77, 79, 101, 94, 82, 84, 88, 66, 64, 39, 36, 71, 54, 120, 55, 70, 58, 63, 138, 86, 76, 93, 71, 71, 58, 62, 400, 99, 83, 65, 76, 67, 76, 59, 59, 65, 57, 68, 54, 62]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.25742572065651276, "mean_inference_ms": 0.729882688431249, "mean_action_processing_ms": 0.07608298395117251, "mean_env_wait_ms": 6.404861373946678, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0071599483489990234, "StateBufferConnector_ms": 0.004113674163818359, "ViewRequirementAgentConnector_ms": 0.09344148635864258}, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 92000, "num_agent_steps_trained": 92000, "num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 417.0695361834798, "num_env_steps_trained_throughput_per_sec": 417.0695361834798, "timesteps_total": 92000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 92000, "timers": {"training_iteration_time_ms": 9023.097, "sample_time_ms": 5245.482, "load_time_ms": 0.999, "load_throughput": 4005638.43, "learn_time_ms": 3773.829, "learn_throughput": 1059.932, "synch_weights_time_ms": 2.147}, "counters": {"num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_agent_steps_sampled": 92000, "num_agent_steps_trained": 92000}, "done": false, "episodes_total": 617, "training_iteration": 23, "trial_id": "ddfb6_00000", "date": "2024-03-07_12-51-45", "timestamp": 1709833905, "time_this_iter_s": 9.593358039855957, "time_total_s": 205.45793461799622, "pid": 112355, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4d85689f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 205.45793461799622, "iterations_since_restore": 23, "perf": {"cpu_util_percent": 29.84615384615385, "ram_util_percent": 52.115384615384606, "gpu_util_percent0": 0.11461538461538462, "vram_util_percent0": 0.12955729166666669}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.10000000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 1.6455526240027298, "policy_loss": -0.004586787830277156, "vf_loss": 1.6493393787293025, "vf_explained_var": 0.6201677944070549, "kl": 0.008000303225921818, "entropy": 0.7931188355210007, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 21855.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000}, "sampler_results": {"episode_reward_max": -2.2000000000000015, "episode_reward_min": -65.90000000000032, "episode_reward_mean": -8.011000000000003, "episode_len_mean": 77.73, "episode_media": {}, "episodes_this_iter": 59, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-22.200000000000035, -6.599999999999989, -7.299999999999988, -10.699999999999974, -9.19999999999998, -7.999999999999989, -7.2999999999999865, -7.699999999999985, -5.699999999999994, -7.0000000000000036, -2.900000000000002, -2.5000000000000018, -6.999999999999995, -4.999999999999997, -10.999999999999973, -4.399999999999997, -7.299999999999999, -5.099999999999994, -5.599999999999994, -18.2, -8.899999999999984, -6.799999999999991, -9.499999999999982, -6.499999999999994, -8.099999999999996, -5.299999999999999, -5.4999999999999964, -65.90000000000032, -10.29999999999998, -8.599999999999993, -6.1999999999999975, -6.799999999999988, -6.499999999999992, -7.899999999999995, -4.799999999999995, -5.899999999999996, -6.299999999999998, -5.199999999999999, -6.299999999999993, -4.699999999999996, -5.099999999999994, -8.799999999999986, -8.799999999999986, -5.699999999999993, -3.8999999999999986, -4.899999999999997, -4.699999999999997, -4.899999999999995, -4.200000000000002, -4.899999999999995, -5.499999999999994, -2.600000000000002, -2.900000000000002, -4.799999999999998, -2.2000000000000015, -60.400000000000325, -8.899999999999984, -6.899999999999992, -8.499999999999993, -4.399999999999997, -7.0999999999999925, -3.8999999999999986, -5.599999999999997, -6.9999999999999885, -5.199999999999995, -3.9999999999999982, -7.3999999999999915, -3.4000000000000004, -6.3000000000000025, -57.90000000000035, -6.499999999999995, -4.499999999999998, -4.899999999999995, -11.499999999999988, -7.899999999999993, -7.89999999999999, -4.199999999999999, -4.299999999999998, -8.399999999999993, -5.999999999999996, -6.099999999999995, -6.899999999999999, -4.699999999999996, -4.599999999999996, -5.399999999999993, -4.500000000000002, -4.099999999999998, -5.999999999999994, -5.299999999999997, -4.1999999999999975, -10.099999999999993, -4.099999999999998, -5.799999999999992, -4.399999999999997, -4.599999999999999, -5.099999999999994, -6.099999999999991, -7.199999999999987, -4.499999999999999, -3.799999999999999], "episode_lengths": [214, 77, 79, 101, 94, 82, 84, 88, 66, 64, 39, 36, 71, 54, 120, 55, 70, 58, 63, 138, 86, 76, 93, 71, 71, 58, 62, 400, 99, 83, 65, 76, 67, 76, 59, 59, 65, 57, 68, 54, 62, 78, 90, 66, 50, 58, 49, 60, 48, 60, 65, 37, 40, 56, 33, 400, 96, 74, 77, 55, 62, 50, 62, 80, 62, 49, 78, 45, 59, 400, 64, 51, 60, 92, 78, 78, 51, 53, 78, 65, 56, 68, 53, 57, 63, 50, 52, 68, 60, 53, 80, 52, 69, 55, 54, 57, 72, 83, 53, 49]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.25985675075926784, "mean_inference_ms": 0.7308497120396302, "mean_action_processing_ms": 0.07614688950025571, "mean_env_wait_ms": 6.42623762014594, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007239580154418945, "StateBufferConnector_ms": 0.004274606704711914, "ViewRequirementAgentConnector_ms": 0.09360098838806152}}, "episode_reward_max": -2.2000000000000015, "episode_reward_min": -65.90000000000032, "episode_reward_mean": -8.011000000000003, "episode_len_mean": 77.73, "episodes_this_iter": 59, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-22.200000000000035, -6.599999999999989, -7.299999999999988, -10.699999999999974, -9.19999999999998, -7.999999999999989, -7.2999999999999865, -7.699999999999985, -5.699999999999994, -7.0000000000000036, -2.900000000000002, -2.5000000000000018, -6.999999999999995, -4.999999999999997, -10.999999999999973, -4.399999999999997, -7.299999999999999, -5.099999999999994, -5.599999999999994, -18.2, -8.899999999999984, -6.799999999999991, -9.499999999999982, -6.499999999999994, -8.099999999999996, -5.299999999999999, -5.4999999999999964, -65.90000000000032, -10.29999999999998, -8.599999999999993, -6.1999999999999975, -6.799999999999988, -6.499999999999992, -7.899999999999995, -4.799999999999995, -5.899999999999996, -6.299999999999998, -5.199999999999999, -6.299999999999993, -4.699999999999996, -5.099999999999994, -8.799999999999986, -8.799999999999986, -5.699999999999993, -3.8999999999999986, -4.899999999999997, -4.699999999999997, -4.899999999999995, -4.200000000000002, -4.899999999999995, -5.499999999999994, -2.600000000000002, -2.900000000000002, -4.799999999999998, -2.2000000000000015, -60.400000000000325, -8.899999999999984, -6.899999999999992, -8.499999999999993, -4.399999999999997, -7.0999999999999925, -3.8999999999999986, -5.599999999999997, -6.9999999999999885, -5.199999999999995, -3.9999999999999982, -7.3999999999999915, -3.4000000000000004, -6.3000000000000025, -57.90000000000035, -6.499999999999995, -4.499999999999998, -4.899999999999995, -11.499999999999988, -7.899999999999993, -7.89999999999999, -4.199999999999999, -4.299999999999998, -8.399999999999993, -5.999999999999996, -6.099999999999995, -6.899999999999999, -4.699999999999996, -4.599999999999996, -5.399999999999993, -4.500000000000002, -4.099999999999998, -5.999999999999994, -5.299999999999997, -4.1999999999999975, -10.099999999999993, -4.099999999999998, -5.799999999999992, -4.399999999999997, -4.599999999999999, -5.099999999999994, -6.099999999999991, -7.199999999999987, -4.499999999999999, -3.799999999999999], "episode_lengths": [214, 77, 79, 101, 94, 82, 84, 88, 66, 64, 39, 36, 71, 54, 120, 55, 70, 58, 63, 138, 86, 76, 93, 71, 71, 58, 62, 400, 99, 83, 65, 76, 67, 76, 59, 59, 65, 57, 68, 54, 62, 78, 90, 66, 50, 58, 49, 60, 48, 60, 65, 37, 40, 56, 33, 400, 96, 74, 77, 55, 62, 50, 62, 80, 62, 49, 78, 45, 59, 400, 64, 51, 60, 92, 78, 78, 51, 53, 78, 65, 56, 68, 53, 57, 63, 50, 52, 68, 60, 53, 80, 52, 69, 55, 54, 57, 72, 83, 53, 49]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.25985675075926784, "mean_inference_ms": 0.7308497120396302, "mean_action_processing_ms": 0.07614688950025571, "mean_env_wait_ms": 6.42623762014594, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007239580154418945, "StateBufferConnector_ms": 0.004274606704711914, "ViewRequirementAgentConnector_ms": 0.09360098838806152}, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000, "num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 420.71685748890815, "num_env_steps_trained_throughput_per_sec": 420.71685748890815, "timesteps_total": 96000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 96000, "timers": {"training_iteration_time_ms": 9095.295, "sample_time_ms": 5271.603, "load_time_ms": 0.996, "load_throughput": 4016955.418, "learn_time_ms": 3819.869, "learn_throughput": 1047.156, "synch_weights_time_ms": 2.176}, "counters": {"num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000}, "done": false, "episodes_total": 676, "training_iteration": 24, "trial_id": "ddfb6_00000", "date": "2024-03-07_12-51-54", "timestamp": 1709833914, "time_this_iter_s": 9.510117769241333, "time_total_s": 214.96805238723755, "pid": 112355, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4d85689f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 214.96805238723755, "iterations_since_restore": 24, "perf": {"cpu_util_percent": 28.849999999999998, "ram_util_percent": 52.23333333333334, "gpu_util_percent0": 0.12083333333333335, "vram_util_percent0": 0.12835693359374997}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.10000000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 1.3234647319930035, "policy_loss": -0.011823383306143104, "vf_loss": 1.3343453606129974, "vf_explained_var": 0.7462561925252279, "kl": 0.009427554753264022, "entropy": 0.7971372225592214, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 22785.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_agent_steps_sampled": 100000, "num_agent_steps_trained": 100000}, "sampler_results": {"episode_reward_max": -2.600000000000002, "episode_reward_min": -57.90000000000035, "episode_reward_mean": -6.511999999999998, "episode_len_mean": 67.72, "episode_media": {}, "episodes_this_iter": 60, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-7.0999999999999925, -3.8999999999999986, -5.599999999999997, -6.9999999999999885, -5.199999999999995, -3.9999999999999982, -7.3999999999999915, -3.4000000000000004, -6.3000000000000025, -57.90000000000035, -6.499999999999995, -4.499999999999998, -4.899999999999995, -11.499999999999988, -7.899999999999993, -7.89999999999999, -4.199999999999999, -4.299999999999998, -8.399999999999993, -5.999999999999996, -6.099999999999995, -6.899999999999999, -4.699999999999996, -4.599999999999996, -5.399999999999993, -4.500000000000002, -4.099999999999998, -5.999999999999994, -5.299999999999997, -4.1999999999999975, -10.099999999999993, -4.099999999999998, -5.799999999999992, -4.399999999999997, -4.599999999999999, -5.099999999999994, -6.099999999999991, -7.199999999999987, -4.499999999999999, -3.799999999999999, -3.6000000000000005, -8.899999999999993, -5.399999999999996, -4.499999999999997, -6.59999999999999, -9.79999999999999, -2.800000000000002, -4.899999999999997, -9.899999999999993, -3.5, -6.099999999999991, -4.399999999999997, -3.1000000000000014, -5.299999999999994, -10.399999999999986, -4.599999999999996, -19.699999999999996, -3.4000000000000004, -4.099999999999998, -7.199999999999987, -7.299999999999994, -6.699999999999989, -7.7999999999999865, -6.39999999999999, -4.299999999999997, -13.099999999999977, -5.399999999999995, -8.699999999999994, -5.499999999999993, -7.3999999999999915, -2.800000000000002, -8.59999999999999, -4.1999999999999975, -18.099999999999966, -9.49999999999998, -7.39999999999999, -3.3000000000000007, -5.399999999999993, -7.599999999999994, -4.899999999999996, -4.799999999999995, -4.899999999999995, -7.0999999999999925, -3.9999999999999982, -3.0000000000000018, -4.1999999999999975, -4.799999999999995, -5.5999999999999925, -8.499999999999984, -3.9999999999999982, -7.299999999999994, -5.3, -5.499999999999995, -4.099999999999998, -4.799999999999996, -3.5999999999999996, -2.600000000000002, -3.3000000000000007, -3.700000000000002, -6.099999999999991], "episode_lengths": [62, 50, 62, 80, 62, 49, 78, 45, 59, 400, 64, 51, 60, 92, 78, 78, 51, 53, 78, 65, 56, 68, 53, 57, 63, 50, 52, 68, 60, 53, 80, 52, 69, 55, 54, 57, 72, 83, 53, 49, 46, 74, 62, 49, 73, 90, 39, 58, 80, 43, 72, 55, 42, 64, 79, 57, 149, 45, 52, 79, 76, 78, 83, 75, 54, 116, 63, 80, 66, 79, 39, 80, 53, 141, 98, 82, 44, 65, 68, 59, 59, 60, 74, 51, 41, 49, 56, 65, 94, 51, 73, 57, 64, 47, 58, 47, 37, 44, 45, 72]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2626699280153478, "mean_inference_ms": 0.7308197530434193, "mean_action_processing_ms": 0.0761569528138954, "mean_env_wait_ms": 6.448062858508021, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007116079330444336, "StateBufferConnector_ms": 0.004114627838134766, "ViewRequirementAgentConnector_ms": 0.08998942375183105}}, "episode_reward_max": -2.600000000000002, "episode_reward_min": -57.90000000000035, "episode_reward_mean": -6.511999999999998, "episode_len_mean": 67.72, "episodes_this_iter": 60, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-7.0999999999999925, -3.8999999999999986, -5.599999999999997, -6.9999999999999885, -5.199999999999995, -3.9999999999999982, -7.3999999999999915, -3.4000000000000004, -6.3000000000000025, -57.90000000000035, -6.499999999999995, -4.499999999999998, -4.899999999999995, -11.499999999999988, -7.899999999999993, -7.89999999999999, -4.199999999999999, -4.299999999999998, -8.399999999999993, -5.999999999999996, -6.099999999999995, -6.899999999999999, -4.699999999999996, -4.599999999999996, -5.399999999999993, -4.500000000000002, -4.099999999999998, -5.999999999999994, -5.299999999999997, -4.1999999999999975, -10.099999999999993, -4.099999999999998, -5.799999999999992, -4.399999999999997, -4.599999999999999, -5.099999999999994, -6.099999999999991, -7.199999999999987, -4.499999999999999, -3.799999999999999, -3.6000000000000005, -8.899999999999993, -5.399999999999996, -4.499999999999997, -6.59999999999999, -9.79999999999999, -2.800000000000002, -4.899999999999997, -9.899999999999993, -3.5, -6.099999999999991, -4.399999999999997, -3.1000000000000014, -5.299999999999994, -10.399999999999986, -4.599999999999996, -19.699999999999996, -3.4000000000000004, -4.099999999999998, -7.199999999999987, -7.299999999999994, -6.699999999999989, -7.7999999999999865, -6.39999999999999, -4.299999999999997, -13.099999999999977, -5.399999999999995, -8.699999999999994, -5.499999999999993, -7.3999999999999915, -2.800000000000002, -8.59999999999999, -4.1999999999999975, -18.099999999999966, -9.49999999999998, -7.39999999999999, -3.3000000000000007, -5.399999999999993, -7.599999999999994, -4.899999999999996, -4.799999999999995, -4.899999999999995, -7.0999999999999925, -3.9999999999999982, -3.0000000000000018, -4.1999999999999975, -4.799999999999995, -5.5999999999999925, -8.499999999999984, -3.9999999999999982, -7.299999999999994, -5.3, -5.499999999999995, -4.099999999999998, -4.799999999999996, -3.5999999999999996, -2.600000000000002, -3.3000000000000007, -3.700000000000002, -6.099999999999991], "episode_lengths": [62, 50, 62, 80, 62, 49, 78, 45, 59, 400, 64, 51, 60, 92, 78, 78, 51, 53, 78, 65, 56, 68, 53, 57, 63, 50, 52, 68, 60, 53, 80, 52, 69, 55, 54, 57, 72, 83, 53, 49, 46, 74, 62, 49, 73, 90, 39, 58, 80, 43, 72, 55, 42, 64, 79, 57, 149, 45, 52, 79, 76, 78, 83, 75, 54, 116, 63, 80, 66, 79, 39, 80, 53, 141, 98, 82, 44, 65, 68, 59, 59, 60, 74, 51, 41, 49, 56, 65, 94, 51, 73, 57, 64, 47, 58, 47, 37, 44, 45, 72]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2626699280153478, "mean_inference_ms": 0.7308197530434193, "mean_action_processing_ms": 0.0761569528138954, "mean_env_wait_ms": 6.448062858508021, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007116079330444336, "StateBufferConnector_ms": 0.004114627838134766, "ViewRequirementAgentConnector_ms": 0.08998942375183105}, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 100000, "num_agent_steps_trained": 100000, "num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 430.6716514786079, "num_env_steps_trained_throughput_per_sec": 430.6716514786079, "timesteps_total": 100000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 100000, "timers": {"training_iteration_time_ms": 9137.206, "sample_time_ms": 5303.962, "load_time_ms": 1.003, "load_throughput": 3988876.843, "learn_time_ms": 3829.346, "learn_throughput": 1044.565, "synch_weights_time_ms": 2.238}, "counters": {"num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_agent_steps_sampled": 100000, "num_agent_steps_trained": 100000}, "done": false, "episodes_total": 736, "training_iteration": 25, "trial_id": "ddfb6_00000", "date": "2024-03-07_12-52-03", "timestamp": 1709833923, "time_this_iter_s": 9.290355205535889, "time_total_s": 224.25840759277344, "pid": 112355, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4d85689f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 224.25840759277344, "iterations_since_restore": 25, "perf": {"cpu_util_percent": 27.458333333333332, "ram_util_percent": 52.10833333333334, "gpu_util_percent0": 0.10999999999999999, "vram_util_percent0": 0.12827555338541663}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.10000000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 1.126929925056675, "policy_loss": -0.010043916401142876, "vf_loss": 1.136083255652138, "vf_explained_var": 0.6685460454674177, "kl": 0.008905842799872988, "entropy": 0.7599962453047434, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 23715.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 104000, "num_env_steps_trained": 104000, "num_agent_steps_sampled": 104000, "num_agent_steps_trained": 104000}, "sampler_results": {"episode_reward_max": -1.9000000000000012, "episode_reward_min": -49.10000000000034, "episode_reward_mean": -5.819, "episode_len_mean": 64.26, "episode_media": {}, "episodes_this_iter": 65, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-13.099999999999977, -5.399999999999995, -8.699999999999994, -5.499999999999993, -7.3999999999999915, -2.800000000000002, -8.59999999999999, -4.1999999999999975, -18.099999999999966, -9.49999999999998, -7.39999999999999, -3.3000000000000007, -5.399999999999993, -7.599999999999994, -4.899999999999996, -4.799999999999995, -4.899999999999995, -7.0999999999999925, -3.9999999999999982, -3.0000000000000018, -4.1999999999999975, -4.799999999999995, -5.5999999999999925, -8.499999999999984, -3.9999999999999982, -7.299999999999994, -5.3, -5.499999999999995, -4.099999999999998, -4.799999999999996, -3.5999999999999996, -2.600000000000002, -3.3000000000000007, -3.700000000000002, -6.099999999999991, -11.499999999999972, -7.29999999999999, -3.799999999999999, -3.9000000000000004, -3.5, -5.099999999999994, -2.900000000000002, -4.3999999999999995, -5.099999999999994, -3.8999999999999986, -5.399999999999993, -8.899999999999991, -9.799999999999981, -5.299999999999994, -6.799999999999988, -7.899999999999997, -6.399999999999991, -2.600000000000002, -3.5, -5.8999999999999915, -5.199999999999997, -1.9000000000000012, -6.799999999999995, -3.3000000000000007, -6.399999999999995, -5.899999999999995, -6.099999999999992, -6.29999999999999, -5.699999999999996, -5.200000000000002, -4.799999999999995, -2.600000000000002, -8.19999999999999, -4.599999999999996, -3.700000000000001, -6.8000000000000025, -5.099999999999996, -4.299999999999997, -10.199999999999982, -3.9999999999999982, -3.5999999999999996, -4.799999999999995, -4.1999999999999975, -5.399999999999994, -3.8000000000000016, -2.900000000000002, -3.5999999999999996, -3.4000000000000004, -4.999999999999995, -6.599999999999995, -5.5999999999999925, -4.099999999999998, -3.6999999999999993, -4.599999999999996, -5.799999999999992, -5.099999999999994, -4.099999999999998, -4.099999999999998, -2.700000000000002, -2.4000000000000017, -4.299999999999997, -49.10000000000034, -3.799999999999999, -4.1999999999999975, -4.899999999999995], "episode_lengths": [116, 63, 80, 66, 79, 39, 80, 53, 141, 98, 82, 44, 65, 68, 59, 59, 60, 74, 51, 41, 49, 56, 65, 94, 51, 73, 57, 64, 47, 58, 47, 37, 44, 45, 72, 121, 77, 49, 48, 46, 62, 40, 51, 59, 50, 65, 77, 100, 61, 79, 72, 73, 37, 46, 69, 60, 30, 71, 44, 65, 66, 64, 74, 62, 54, 59, 37, 81, 57, 46, 63, 60, 54, 102, 51, 45, 59, 53, 64, 46, 40, 47, 45, 61, 67, 67, 52, 48, 57, 67, 62, 52, 52, 38, 35, 54, 400, 43, 53, 60]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2651121151914965, "mean_inference_ms": 0.7312931725157916, "mean_action_processing_ms": 0.07616345226630472, "mean_env_wait_ms": 6.463998949397975, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007302284240722656, "StateBufferConnector_ms": 0.004025936126708984, "ViewRequirementAgentConnector_ms": 0.09221816062927246}}, "episode_reward_max": -1.9000000000000012, "episode_reward_min": -49.10000000000034, "episode_reward_mean": -5.819, "episode_len_mean": 64.26, "episodes_this_iter": 65, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-13.099999999999977, -5.399999999999995, -8.699999999999994, -5.499999999999993, -7.3999999999999915, -2.800000000000002, -8.59999999999999, -4.1999999999999975, -18.099999999999966, -9.49999999999998, -7.39999999999999, -3.3000000000000007, -5.399999999999993, -7.599999999999994, -4.899999999999996, -4.799999999999995, -4.899999999999995, -7.0999999999999925, -3.9999999999999982, -3.0000000000000018, -4.1999999999999975, -4.799999999999995, -5.5999999999999925, -8.499999999999984, -3.9999999999999982, -7.299999999999994, -5.3, -5.499999999999995, -4.099999999999998, -4.799999999999996, -3.5999999999999996, -2.600000000000002, -3.3000000000000007, -3.700000000000002, -6.099999999999991, -11.499999999999972, -7.29999999999999, -3.799999999999999, -3.9000000000000004, -3.5, -5.099999999999994, -2.900000000000002, -4.3999999999999995, -5.099999999999994, -3.8999999999999986, -5.399999999999993, -8.899999999999991, -9.799999999999981, -5.299999999999994, -6.799999999999988, -7.899999999999997, -6.399999999999991, -2.600000000000002, -3.5, -5.8999999999999915, -5.199999999999997, -1.9000000000000012, -6.799999999999995, -3.3000000000000007, -6.399999999999995, -5.899999999999995, -6.099999999999992, -6.29999999999999, -5.699999999999996, -5.200000000000002, -4.799999999999995, -2.600000000000002, -8.19999999999999, -4.599999999999996, -3.700000000000001, -6.8000000000000025, -5.099999999999996, -4.299999999999997, -10.199999999999982, -3.9999999999999982, -3.5999999999999996, -4.799999999999995, -4.1999999999999975, -5.399999999999994, -3.8000000000000016, -2.900000000000002, -3.5999999999999996, -3.4000000000000004, -4.999999999999995, -6.599999999999995, -5.5999999999999925, -4.099999999999998, -3.6999999999999993, -4.599999999999996, -5.799999999999992, -5.099999999999994, -4.099999999999998, -4.099999999999998, -2.700000000000002, -2.4000000000000017, -4.299999999999997, -49.10000000000034, -3.799999999999999, -4.1999999999999975, -4.899999999999995], "episode_lengths": [116, 63, 80, 66, 79, 39, 80, 53, 141, 98, 82, 44, 65, 68, 59, 59, 60, 74, 51, 41, 49, 56, 65, 94, 51, 73, 57, 64, 47, 58, 47, 37, 44, 45, 72, 121, 77, 49, 48, 46, 62, 40, 51, 59, 50, 65, 77, 100, 61, 79, 72, 73, 37, 46, 69, 60, 30, 71, 44, 65, 66, 64, 74, 62, 54, 59, 37, 81, 57, 46, 63, 60, 54, 102, 51, 45, 59, 53, 64, 46, 40, 47, 45, 61, 67, 67, 52, 48, 57, 67, 62, 52, 52, 38, 35, 54, 400, 43, 53, 60]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2651121151914965, "mean_inference_ms": 0.7312931725157916, "mean_action_processing_ms": 0.07616345226630472, "mean_env_wait_ms": 6.463998949397975, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007302284240722656, "StateBufferConnector_ms": 0.004025936126708984, "ViewRequirementAgentConnector_ms": 0.09221816062927246}, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 104000, "num_agent_steps_trained": 104000, "num_env_steps_sampled": 104000, "num_env_steps_trained": 104000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 412.00557542430295, "num_env_steps_trained_throughput_per_sec": 412.00557542430295, "timesteps_total": 104000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 104000, "timers": {"training_iteration_time_ms": 9225.426, "sample_time_ms": 5358.017, "load_time_ms": 1.02, "load_throughput": 3922109.594, "learn_time_ms": 3863.474, "learn_throughput": 1035.338, "synch_weights_time_ms": 2.255}, "counters": {"num_env_steps_sampled": 104000, "num_env_steps_trained": 104000, "num_agent_steps_sampled": 104000, "num_agent_steps_trained": 104000}, "done": false, "episodes_total": 801, "training_iteration": 26, "trial_id": "ddfb6_00000", "date": "2024-03-07_12-52-13", "timestamp": 1709833933, "time_this_iter_s": 9.711234331130981, "time_total_s": 233.96964192390442, "pid": 112355, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4d85689f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 233.96964192390442, "iterations_since_restore": 26, "perf": {"cpu_util_percent": 30.615384615384617, "ram_util_percent": 52.307692307692314, "gpu_util_percent0": 0.14076923076923076, "vram_util_percent0": 0.12667142427884615}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.10000000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 0.8490462386759714, "policy_loss": -0.006454745645043991, "vf_loss": 0.85434824055241, "vf_explained_var": 0.7195146274182105, "kl": 0.011527451404601556, "entropy": 0.6975274557708412, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 24645.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_agent_steps_sampled": 108000, "num_agent_steps_trained": 108000}, "sampler_results": {"episode_reward_max": -1.9000000000000012, "episode_reward_min": -49.10000000000034, "episode_reward_mean": -5.248000000000002, "episode_len_mean": 59.34, "episode_media": {}, "episodes_this_iter": 70, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-6.8000000000000025, -5.099999999999996, -4.299999999999997, -10.199999999999982, -3.9999999999999982, -3.5999999999999996, -4.799999999999995, -4.1999999999999975, -5.399999999999994, -3.8000000000000016, -2.900000000000002, -3.5999999999999996, -3.4000000000000004, -4.999999999999995, -6.599999999999995, -5.5999999999999925, -4.099999999999998, -3.6999999999999993, -4.599999999999996, -5.799999999999992, -5.099999999999994, -4.099999999999998, -4.099999999999998, -2.700000000000002, -2.4000000000000017, -4.299999999999997, -49.10000000000034, -3.799999999999999, -4.1999999999999975, -4.899999999999995, -6.099999999999992, -2.600000000000002, -3.4000000000000004, -5.499999999999999, -5.299999999999995, -3.1000000000000014, -5.299999999999998, -4.999999999999995, -5.199999999999997, -4.799999999999995, -4.899999999999995, -3.8999999999999986, -3.6999999999999993, -3.200000000000001, -4.299999999999997, -3.5999999999999996, -5.799999999999998, -1.9000000000000012, -3.9999999999999982, -8.299999999999994, -4.099999999999999, -3.200000000000001, -3.6000000000000005, -5.799999999999998, -3.4000000000000012, -3.9999999999999982, -3.5, -3.6999999999999993, -6.399999999999995, -2.800000000000002, -4.4999999999999964, -4.499999999999999, -4.899999999999995, -3.3000000000000007, -5.6000000000000005, -3.4000000000000004, -7.499999999999993, -33.00000000000017, -2.700000000000002, -4.899999999999995, -3.8999999999999986, -7.999999999999989, -7.199999999999994, -2.600000000000002, -3.5999999999999996, -5.199999999999995, -3.200000000000001, -11.99999999999998, -5.1999999999999975, -2.600000000000002, -3.0000000000000018, -3.4000000000000004, -2.0000000000000013, -4.4999999999999964, -5.999999999999995, -4.599999999999996, -3.9999999999999982, -3.3000000000000007, -4.699999999999996, -5.699999999999997, -4.899999999999995, -3.5999999999999996, -2.700000000000002, -4.699999999999997, -4.399999999999997, -4.699999999999996, -4.1999999999999975, -6.4999999999999964, -3.0000000000000018, -4.4999999999999964], "episode_lengths": [63, 60, 54, 102, 51, 45, 59, 53, 64, 46, 40, 47, 45, 61, 67, 67, 52, 48, 57, 67, 62, 52, 52, 38, 35, 54, 400, 43, 53, 60, 68, 37, 45, 59, 62, 42, 59, 61, 60, 56, 60, 50, 48, 43, 54, 47, 62, 30, 51, 83, 51, 43, 44, 62, 44, 51, 46, 42, 69, 36, 56, 53, 60, 43, 58, 45, 77, 282, 38, 60, 50, 75, 69, 37, 43, 59, 43, 105, 59, 37, 41, 45, 31, 56, 61, 57, 51, 44, 58, 59, 57, 47, 38, 57, 55, 58, 53, 63, 41, 51]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2680300146869772, "mean_inference_ms": 0.7322436165525741, "mean_action_processing_ms": 0.07621861532254315, "mean_env_wait_ms": 6.487298403232926, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007279872894287109, "StateBufferConnector_ms": 0.0040814876556396484, "ViewRequirementAgentConnector_ms": 0.09319543838500977}}, "episode_reward_max": -1.9000000000000012, "episode_reward_min": -49.10000000000034, "episode_reward_mean": -5.248000000000002, "episode_len_mean": 59.34, "episodes_this_iter": 70, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-6.8000000000000025, -5.099999999999996, -4.299999999999997, -10.199999999999982, -3.9999999999999982, -3.5999999999999996, -4.799999999999995, -4.1999999999999975, -5.399999999999994, -3.8000000000000016, -2.900000000000002, -3.5999999999999996, -3.4000000000000004, -4.999999999999995, -6.599999999999995, -5.5999999999999925, -4.099999999999998, -3.6999999999999993, -4.599999999999996, -5.799999999999992, -5.099999999999994, -4.099999999999998, -4.099999999999998, -2.700000000000002, -2.4000000000000017, -4.299999999999997, -49.10000000000034, -3.799999999999999, -4.1999999999999975, -4.899999999999995, -6.099999999999992, -2.600000000000002, -3.4000000000000004, -5.499999999999999, -5.299999999999995, -3.1000000000000014, -5.299999999999998, -4.999999999999995, -5.199999999999997, -4.799999999999995, -4.899999999999995, -3.8999999999999986, -3.6999999999999993, -3.200000000000001, -4.299999999999997, -3.5999999999999996, -5.799999999999998, -1.9000000000000012, -3.9999999999999982, -8.299999999999994, -4.099999999999999, -3.200000000000001, -3.6000000000000005, -5.799999999999998, -3.4000000000000012, -3.9999999999999982, -3.5, -3.6999999999999993, -6.399999999999995, -2.800000000000002, -4.4999999999999964, -4.499999999999999, -4.899999999999995, -3.3000000000000007, -5.6000000000000005, -3.4000000000000004, -7.499999999999993, -33.00000000000017, -2.700000000000002, -4.899999999999995, -3.8999999999999986, -7.999999999999989, -7.199999999999994, -2.600000000000002, -3.5999999999999996, -5.199999999999995, -3.200000000000001, -11.99999999999998, -5.1999999999999975, -2.600000000000002, -3.0000000000000018, -3.4000000000000004, -2.0000000000000013, -4.4999999999999964, -5.999999999999995, -4.599999999999996, -3.9999999999999982, -3.3000000000000007, -4.699999999999996, -5.699999999999997, -4.899999999999995, -3.5999999999999996, -2.700000000000002, -4.699999999999997, -4.399999999999997, -4.699999999999996, -4.1999999999999975, -6.4999999999999964, -3.0000000000000018, -4.4999999999999964], "episode_lengths": [63, 60, 54, 102, 51, 45, 59, 53, 64, 46, 40, 47, 45, 61, 67, 67, 52, 48, 57, 67, 62, 52, 52, 38, 35, 54, 400, 43, 53, 60, 68, 37, 45, 59, 62, 42, 59, 61, 60, 56, 60, 50, 48, 43, 54, 47, 62, 30, 51, 83, 51, 43, 44, 62, 44, 51, 46, 42, 69, 36, 56, 53, 60, 43, 58, 45, 77, 282, 38, 60, 50, 75, 69, 37, 43, 59, 43, 105, 59, 37, 41, 45, 31, 56, 61, 57, 51, 44, 58, 59, 57, 47, 38, 57, 55, 58, 53, 63, 41, 51]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2680300146869772, "mean_inference_ms": 0.7322436165525741, "mean_action_processing_ms": 0.07621861532254315, "mean_env_wait_ms": 6.487298403232926, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007279872894287109, "StateBufferConnector_ms": 0.0040814876556396484, "ViewRequirementAgentConnector_ms": 0.09319543838500977}, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 108000, "num_agent_steps_trained": 108000, "num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 412.70088898666125, "num_env_steps_trained_throughput_per_sec": 412.70088898666125, "timesteps_total": 108000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 108000, "timers": {"training_iteration_time_ms": 9318.637, "sample_time_ms": 5421.612, "load_time_ms": 1.023, "load_throughput": 3908859.533, "learn_time_ms": 3893.07, "learn_throughput": 1027.467, "synch_weights_time_ms": 2.262}, "counters": {"num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_agent_steps_sampled": 108000, "num_agent_steps_trained": 108000}, "done": false, "episodes_total": 871, "training_iteration": 27, "trial_id": "ddfb6_00000", "date": "2024-03-07_12-52-23", "timestamp": 1709833943, "time_this_iter_s": 9.694921970367432, "time_total_s": 243.66456389427185, "pid": 112355, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4d85689f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 243.66456389427185, "iterations_since_restore": 27, "perf": {"cpu_util_percent": 30.575000000000003, "ram_util_percent": 52.60833333333334, "gpu_util_percent0": 0.11583333333333333, "vram_util_percent0": 0.12632921006944445}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.10000000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 0.754515175133573, "policy_loss": -0.008173474252864878, "vf_loss": 0.7618900191719814, "vf_explained_var": 0.79612316636629, "kl": 0.007986283654223216, "entropy": 0.6698662707882542, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 25575.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_agent_steps_sampled": 112000, "num_agent_steps_trained": 112000}, "sampler_results": {"episode_reward_max": -1.9000000000000012, "episode_reward_min": -15.29999999999998, "episode_reward_mean": -4.549999999999998, "episode_len_mean": 53.97, "episode_media": {}, "episodes_this_iter": 70, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.8999999999999986, -7.999999999999989, -7.199999999999994, -2.600000000000002, -3.5999999999999996, -5.199999999999995, -3.200000000000001, -11.99999999999998, -5.1999999999999975, -2.600000000000002, -3.0000000000000018, -3.4000000000000004, -2.0000000000000013, -4.4999999999999964, -5.999999999999995, -4.599999999999996, -3.9999999999999982, -3.3000000000000007, -4.699999999999996, -5.699999999999997, -4.899999999999995, -3.5999999999999996, -2.700000000000002, -4.699999999999997, -4.399999999999997, -4.699999999999996, -4.1999999999999975, -6.4999999999999964, -3.0000000000000018, -4.4999999999999964, -5.399999999999994, -4.799999999999999, -3.9999999999999982, -2.1000000000000014, -3.9999999999999982, -1.9000000000000012, -4.299999999999997, -3.9999999999999982, -7.599999999999998, -3.4000000000000012, -15.29999999999998, -3.3000000000000007, -3.200000000000001, -4.099999999999998, -3.0000000000000018, -6.39999999999999, -2.600000000000002, -3.4000000000000004, -4.6, -2.900000000000002, -5.399999999999998, -4.399999999999997, -3.5999999999999996, -4.299999999999999, -3.3000000000000007, -3.3000000000000007, -4.599999999999996, -5.2, -3.6999999999999993, -5.499999999999998, -4.299999999999997, -4.299999999999997, -4.699999999999997, -4.899999999999995, -2.5000000000000018, -8.599999999999982, -3.9999999999999982, -5.5999999999999925, -5.399999999999998, -2.2000000000000015, -6.299999999999993, -4.399999999999997, -3.6999999999999993, -5.299999999999994, -3.0000000000000018, -3.1000000000000014, -3.1000000000000014, -4.899999999999995, -5.8999999999999915, -5.399999999999998, -4.699999999999997, -7.89999999999999, -3.200000000000001, -5.499999999999996, -4.399999999999997, -4.4999999999999964, -4.099999999999998, -5.699999999999992, -4.899999999999995, -3.0000000000000018, -5.299999999999994, -3.1000000000000014, -4.899999999999995, -5.299999999999994, -3.9999999999999982, -4.099999999999999, -5.199999999999994, -6.199999999999997, -2.3000000000000016, -3.5999999999999996], "episode_lengths": [50, 75, 69, 37, 43, 59, 43, 105, 59, 37, 41, 45, 31, 56, 61, 57, 51, 44, 58, 59, 57, 47, 38, 57, 55, 58, 53, 63, 41, 51, 63, 55, 51, 32, 51, 30, 54, 51, 73, 44, 125, 44, 43, 52, 41, 75, 37, 45, 53, 40, 60, 51, 47, 51, 44, 44, 57, 56, 48, 60, 54, 54, 57, 60, 36, 93, 46, 62, 60, 33, 70, 55, 48, 64, 41, 42, 42, 60, 66, 60, 57, 81, 43, 63, 55, 56, 52, 68, 60, 41, 63, 42, 60, 64, 51, 51, 63, 66, 34, 47]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.270607651380303, "mean_inference_ms": 0.7330600348545979, "mean_action_processing_ms": 0.0762673975224858, "mean_env_wait_ms": 6.51103558663384, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007318735122680664, "StateBufferConnector_ms": 0.0041124820709228516, "ViewRequirementAgentConnector_ms": 0.09320330619812012}}, "episode_reward_max": -1.9000000000000012, "episode_reward_min": -15.29999999999998, "episode_reward_mean": -4.549999999999998, "episode_len_mean": 53.97, "episodes_this_iter": 70, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3.8999999999999986, -7.999999999999989, -7.199999999999994, -2.600000000000002, -3.5999999999999996, -5.199999999999995, -3.200000000000001, -11.99999999999998, -5.1999999999999975, -2.600000000000002, -3.0000000000000018, -3.4000000000000004, -2.0000000000000013, -4.4999999999999964, -5.999999999999995, -4.599999999999996, -3.9999999999999982, -3.3000000000000007, -4.699999999999996, -5.699999999999997, -4.899999999999995, -3.5999999999999996, -2.700000000000002, -4.699999999999997, -4.399999999999997, -4.699999999999996, -4.1999999999999975, -6.4999999999999964, -3.0000000000000018, -4.4999999999999964, -5.399999999999994, -4.799999999999999, -3.9999999999999982, -2.1000000000000014, -3.9999999999999982, -1.9000000000000012, -4.299999999999997, -3.9999999999999982, -7.599999999999998, -3.4000000000000012, -15.29999999999998, -3.3000000000000007, -3.200000000000001, -4.099999999999998, -3.0000000000000018, -6.39999999999999, -2.600000000000002, -3.4000000000000004, -4.6, -2.900000000000002, -5.399999999999998, -4.399999999999997, -3.5999999999999996, -4.299999999999999, -3.3000000000000007, -3.3000000000000007, -4.599999999999996, -5.2, -3.6999999999999993, -5.499999999999998, -4.299999999999997, -4.299999999999997, -4.699999999999997, -4.899999999999995, -2.5000000000000018, -8.599999999999982, -3.9999999999999982, -5.5999999999999925, -5.399999999999998, -2.2000000000000015, -6.299999999999993, -4.399999999999997, -3.6999999999999993, -5.299999999999994, -3.0000000000000018, -3.1000000000000014, -3.1000000000000014, -4.899999999999995, -5.8999999999999915, -5.399999999999998, -4.699999999999997, -7.89999999999999, -3.200000000000001, -5.499999999999996, -4.399999999999997, -4.4999999999999964, -4.099999999999998, -5.699999999999992, -4.899999999999995, -3.0000000000000018, -5.299999999999994, -3.1000000000000014, -4.899999999999995, -5.299999999999994, -3.9999999999999982, -4.099999999999999, -5.199999999999994, -6.199999999999997, -2.3000000000000016, -3.5999999999999996], "episode_lengths": [50, 75, 69, 37, 43, 59, 43, 105, 59, 37, 41, 45, 31, 56, 61, 57, 51, 44, 58, 59, 57, 47, 38, 57, 55, 58, 53, 63, 41, 51, 63, 55, 51, 32, 51, 30, 54, 51, 73, 44, 125, 44, 43, 52, 41, 75, 37, 45, 53, 40, 60, 51, 47, 51, 44, 44, 57, 56, 48, 60, 54, 54, 57, 60, 36, 93, 46, 62, 60, 33, 70, 55, 48, 64, 41, 42, 42, 60, 66, 60, 57, 81, 43, 63, 55, 56, 52, 68, 60, 41, 63, 42, 60, 64, 51, 51, 63, 66, 34, 47]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.270607651380303, "mean_inference_ms": 0.7330600348545979, "mean_action_processing_ms": 0.0762673975224858, "mean_env_wait_ms": 6.51103558663384, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007318735122680664, "StateBufferConnector_ms": 0.0041124820709228516, "ViewRequirementAgentConnector_ms": 0.09320330619812012}, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 112000, "num_agent_steps_trained": 112000, "num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 423.1691416836896, "num_env_steps_trained_throughput_per_sec": 423.1691416836896, "timesteps_total": 112000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 112000, "timers": {"training_iteration_time_ms": 9391.154, "sample_time_ms": 5478.216, "load_time_ms": 1.036, "load_throughput": 3861002.923, "learn_time_ms": 3908.969, "learn_throughput": 1023.288, "synch_weights_time_ms": 2.256}, "counters": {"num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_agent_steps_sampled": 112000, "num_agent_steps_trained": 112000}, "done": false, "episodes_total": 941, "training_iteration": 28, "trial_id": "ddfb6_00000", "date": "2024-03-07_12-52-32", "timestamp": 1709833952, "time_this_iter_s": 9.455098152160645, "time_total_s": 253.1196620464325, "pid": 112355, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4d85689f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 253.1196620464325, "iterations_since_restore": 28, "perf": {"cpu_util_percent": 30.78333333333333, "ram_util_percent": 52.43333333333333, "gpu_util_percent0": 0.10916666666666668, "vram_util_percent0": 0.1254204644097222}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.10000000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 1.2396258402382643, "policy_loss": -0.004670920597529539, "vf_loss": 1.243432793073276, "vf_explained_var": 0.7052306623228135, "kl": 0.008639682880708675, "entropy": 0.655989277651233, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 26505.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 116000, "num_env_steps_trained": 116000, "num_agent_steps_sampled": 116000, "num_agent_steps_trained": 116000}, "sampler_results": {"episode_reward_max": -2.0000000000000013, "episode_reward_min": -62.300000000000374, "episode_reward_mean": -5.510000000000006, "episode_len_mean": 59.83, "episode_media": {}, "episodes_this_iter": 68, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-5.399999999999998, -2.2000000000000015, -6.299999999999993, -4.399999999999997, -3.6999999999999993, -5.299999999999994, -3.0000000000000018, -3.1000000000000014, -3.1000000000000014, -4.899999999999995, -5.8999999999999915, -5.399999999999998, -4.699999999999997, -7.89999999999999, -3.200000000000001, -5.499999999999996, -4.399999999999997, -4.4999999999999964, -4.099999999999998, -5.699999999999992, -4.899999999999995, -3.0000000000000018, -5.299999999999994, -3.1000000000000014, -4.899999999999995, -5.299999999999994, -3.9999999999999982, -4.099999999999999, -5.199999999999994, -6.199999999999997, -2.3000000000000016, -3.5999999999999996, -4.899999999999995, -2.800000000000002, -2.800000000000002, -3.3000000000000007, -3.3000000000000007, -4.399999999999997, -4.999999999999999, -4.099999999999998, -4.3999999999999995, -3.8999999999999986, -3.7, -4.199999999999998, -3.0000000000000018, -11.599999999999984, -3.8999999999999995, -4.699999999999997, -5.599999999999998, -5.999999999999994, -3.8999999999999986, -3.5, -3.5999999999999996, -3.1000000000000014, -4.699999999999996, -3.4000000000000004, -2.700000000000002, -7.199999999999996, -3.5999999999999996, -3.5999999999999996, -4.1999999999999975, -4.399999999999998, -4.699999999999996, -4.699999999999996, -4.299999999999997, -4.3000000000000025, -2.900000000000002, -4.699999999999996, -4.899999999999995, -3.8999999999999986, -4.599999999999997, -61.900000000000496, -4.099999999999998, -3.200000000000001, -3.3000000000000007, -4.1999999999999975, -5.999999999999993, -2.600000000000002, -3.799999999999999, -5.999999999999994, -2.1000000000000014, -4.1999999999999975, -5.499999999999993, -3.9000000000000004, -4.1999999999999975, -4.6999999999999975, -2.0000000000000013, -4.399999999999998, -5.399999999999993, -5.299999999999994, -3.799999999999999, -3.5999999999999996, -5.099999999999997, -5.999999999999993, -2.900000000000002, -3.9999999999999982, -6.000000000000003, -2.5000000000000018, -4.899999999999997, -62.300000000000374], "episode_lengths": [60, 33, 70, 55, 48, 64, 41, 42, 42, 60, 66, 60, 57, 81, 43, 63, 55, 56, 52, 68, 60, 41, 63, 42, 60, 64, 51, 51, 63, 66, 34, 47, 60, 39, 39, 44, 44, 55, 56, 52, 51, 50, 47, 52, 41, 92, 49, 57, 61, 68, 50, 46, 44, 42, 58, 45, 38, 73, 47, 47, 53, 54, 58, 58, 54, 48, 40, 58, 60, 50, 54, 400, 52, 43, 40, 53, 69, 37, 49, 65, 32, 53, 66, 48, 53, 56, 31, 52, 65, 64, 49, 47, 59, 65, 40, 51, 58, 36, 58, 400]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2728076817946693, "mean_inference_ms": 0.7336291725211334, "mean_action_processing_ms": 0.07633984722893428, "mean_env_wait_ms": 6.524249275503696, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007243633270263672, "StateBufferConnector_ms": 0.004075765609741211, "ViewRequirementAgentConnector_ms": 0.09291768074035645}}, "episode_reward_max": -2.0000000000000013, "episode_reward_min": -62.300000000000374, "episode_reward_mean": -5.510000000000006, "episode_len_mean": 59.83, "episodes_this_iter": 68, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-5.399999999999998, -2.2000000000000015, -6.299999999999993, -4.399999999999997, -3.6999999999999993, -5.299999999999994, -3.0000000000000018, -3.1000000000000014, -3.1000000000000014, -4.899999999999995, -5.8999999999999915, -5.399999999999998, -4.699999999999997, -7.89999999999999, -3.200000000000001, -5.499999999999996, -4.399999999999997, -4.4999999999999964, -4.099999999999998, -5.699999999999992, -4.899999999999995, -3.0000000000000018, -5.299999999999994, -3.1000000000000014, -4.899999999999995, -5.299999999999994, -3.9999999999999982, -4.099999999999999, -5.199999999999994, -6.199999999999997, -2.3000000000000016, -3.5999999999999996, -4.899999999999995, -2.800000000000002, -2.800000000000002, -3.3000000000000007, -3.3000000000000007, -4.399999999999997, -4.999999999999999, -4.099999999999998, -4.3999999999999995, -3.8999999999999986, -3.7, -4.199999999999998, -3.0000000000000018, -11.599999999999984, -3.8999999999999995, -4.699999999999997, -5.599999999999998, -5.999999999999994, -3.8999999999999986, -3.5, -3.5999999999999996, -3.1000000000000014, -4.699999999999996, -3.4000000000000004, -2.700000000000002, -7.199999999999996, -3.5999999999999996, -3.5999999999999996, -4.1999999999999975, -4.399999999999998, -4.699999999999996, -4.699999999999996, -4.299999999999997, -4.3000000000000025, -2.900000000000002, -4.699999999999996, -4.899999999999995, -3.8999999999999986, -4.599999999999997, -61.900000000000496, -4.099999999999998, -3.200000000000001, -3.3000000000000007, -4.1999999999999975, -5.999999999999993, -2.600000000000002, -3.799999999999999, -5.999999999999994, -2.1000000000000014, -4.1999999999999975, -5.499999999999993, -3.9000000000000004, -4.1999999999999975, -4.6999999999999975, -2.0000000000000013, -4.399999999999998, -5.399999999999993, -5.299999999999994, -3.799999999999999, -3.5999999999999996, -5.099999999999997, -5.999999999999993, -2.900000000000002, -3.9999999999999982, -6.000000000000003, -2.5000000000000018, -4.899999999999997, -62.300000000000374], "episode_lengths": [60, 33, 70, 55, 48, 64, 41, 42, 42, 60, 66, 60, 57, 81, 43, 63, 55, 56, 52, 68, 60, 41, 63, 42, 60, 64, 51, 51, 63, 66, 34, 47, 60, 39, 39, 44, 44, 55, 56, 52, 51, 50, 47, 52, 41, 92, 49, 57, 61, 68, 50, 46, 44, 42, 58, 45, 38, 73, 47, 47, 53, 54, 58, 58, 54, 48, 40, 58, 60, 50, 54, 400, 52, 43, 40, 53, 69, 37, 49, 65, 32, 53, 66, 48, 53, 56, 31, 52, 65, 64, 49, 47, 59, 65, 40, 51, 58, 36, 58, 400]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2728076817946693, "mean_inference_ms": 0.7336291725211334, "mean_action_processing_ms": 0.07633984722893428, "mean_env_wait_ms": 6.524249275503696, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007243633270263672, "StateBufferConnector_ms": 0.004075765609741211, "ViewRequirementAgentConnector_ms": 0.09291768074035645}, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 116000, "num_agent_steps_trained": 116000, "num_env_steps_sampled": 116000, "num_env_steps_trained": 116000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 432.43597686975437, "num_env_steps_trained_throughput_per_sec": 432.43597686975437, "timesteps_total": 116000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 116000, "timers": {"training_iteration_time_ms": 9420.078, "sample_time_ms": 5524.248, "load_time_ms": 1.049, "load_throughput": 3813697.036, "learn_time_ms": 3891.905, "learn_throughput": 1027.774, "synch_weights_time_ms": 2.201}, "counters": {"num_env_steps_sampled": 116000, "num_env_steps_trained": 116000, "num_agent_steps_sampled": 116000, "num_agent_steps_trained": 116000}, "done": false, "episodes_total": 1009, "training_iteration": 29, "trial_id": "ddfb6_00000", "date": "2024-03-07_12-52-42", "timestamp": 1709833962, "time_this_iter_s": 9.2522714138031, "time_total_s": 262.3719334602356, "pid": 112355, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4d85689f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 262.3719334602356, "iterations_since_restore": 29, "perf": {"cpu_util_percent": 28.983333333333324, "ram_util_percent": 51.974999999999994, "gpu_util_percent0": 0.10166666666666664, "vram_util_percent0": 0.1259765625}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.10000000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 1.7356433435368868, "policy_loss": -0.002546989933777881, "vf_loss": 1.7374070861266666, "vf_explained_var": 0.5641222778187003, "kl": 0.007832466016682197, "entropy": 0.6602179193368523, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 27435.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 120000, "num_env_steps_trained": 120000, "num_agent_steps_sampled": 120000, "num_agent_steps_trained": 120000}, "sampler_results": {"episode_reward_max": -2.0000000000000013, "episode_reward_min": -62.300000000000374, "episode_reward_mean": -5.8400000000000105, "episode_len_mean": 61.74, "episode_media": {}, "episodes_this_iter": 65, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4.3000000000000025, -2.900000000000002, -4.699999999999996, -4.899999999999995, -3.8999999999999986, -4.599999999999997, -61.900000000000496, -4.099999999999998, -3.200000000000001, -3.3000000000000007, -4.1999999999999975, -5.999999999999993, -2.600000000000002, -3.799999999999999, -5.999999999999994, -2.1000000000000014, -4.1999999999999975, -5.499999999999993, -3.9000000000000004, -4.1999999999999975, -4.6999999999999975, -2.0000000000000013, -4.399999999999998, -5.399999999999993, -5.299999999999994, -3.799999999999999, -3.5999999999999996, -5.099999999999997, -5.999999999999993, -2.900000000000002, -3.9999999999999982, -6.000000000000003, -2.5000000000000018, -4.899999999999997, -62.300000000000374, -6.699999999999998, -4.399999999999997, -6.899999999999989, -2.5000000000000018, -2.600000000000002, -2.5000000000000018, -3.3000000000000007, -3.0000000000000018, -5.199999999999999, -4.899999999999995, -2.900000000000002, -3.5, -3.8999999999999995, -3.4000000000000004, -3.200000000000001, -2.1000000000000014, -3.0000000000000018, -3.5, -3.3000000000000007, -3.6999999999999993, -3.799999999999999, -3.6999999999999993, -6.0, -4.799999999999995, -11.799999999999972, -2.800000000000002, -4.4999999999999964, -4.899999999999998, -3.4000000000000004, -2.700000000000002, -4.8999999999999995, -3.8999999999999986, -3.8999999999999986, -3.5999999999999996, -2.5000000000000018, -3.8999999999999986, -3.3000000000000007, -4.199999999999998, -3.8999999999999986, -3.5999999999999996, -3.3000000000000007, -4.199999999999999, -5.399999999999994, -2.2000000000000015, -4.100000000000001, -4.100000000000001, -3.8999999999999986, -5.099999999999994, -4.4999999999999964, -4.399999999999997, -4.899999999999995, -4.299999999999997, -52.50000000000027, -7.899999999999993, -3.5, -5.299999999999994, -3.4000000000000004, -3.999999999999999, -5.499999999999998, -4.099999999999998, -4.399999999999997, -2.700000000000002, -5.799999999999998, -4.6000000000000005, -6.099999999999995], "episode_lengths": [48, 40, 58, 60, 50, 54, 400, 52, 43, 40, 53, 69, 37, 49, 65, 32, 53, 66, 48, 53, 56, 31, 52, 65, 64, 49, 47, 59, 65, 40, 51, 58, 36, 58, 400, 63, 55, 68, 36, 36, 36, 44, 41, 57, 60, 40, 46, 49, 45, 43, 32, 41, 46, 44, 46, 49, 48, 61, 59, 126, 39, 56, 55, 45, 38, 55, 49, 50, 47, 36, 50, 44, 52, 50, 47, 44, 51, 64, 33, 48, 46, 50, 62, 56, 55, 60, 54, 400, 81, 45, 64, 45, 50, 60, 52, 55, 38, 58, 51, 67]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.274235278985383, "mean_inference_ms": 0.7336919731921874, "mean_action_processing_ms": 0.07640830684832817, "mean_env_wait_ms": 6.5306659354860725, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006792783737182617, "StateBufferConnector_ms": 0.003925800323486328, "ViewRequirementAgentConnector_ms": 0.09033608436584473}}, "episode_reward_max": -2.0000000000000013, "episode_reward_min": -62.300000000000374, "episode_reward_mean": -5.8400000000000105, "episode_len_mean": 61.74, "episodes_this_iter": 65, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-4.3000000000000025, -2.900000000000002, -4.699999999999996, -4.899999999999995, -3.8999999999999986, -4.599999999999997, -61.900000000000496, -4.099999999999998, -3.200000000000001, -3.3000000000000007, -4.1999999999999975, -5.999999999999993, -2.600000000000002, -3.799999999999999, -5.999999999999994, -2.1000000000000014, -4.1999999999999975, -5.499999999999993, -3.9000000000000004, -4.1999999999999975, -4.6999999999999975, -2.0000000000000013, -4.399999999999998, -5.399999999999993, -5.299999999999994, -3.799999999999999, -3.5999999999999996, -5.099999999999997, -5.999999999999993, -2.900000000000002, -3.9999999999999982, -6.000000000000003, -2.5000000000000018, -4.899999999999997, -62.300000000000374, -6.699999999999998, -4.399999999999997, -6.899999999999989, -2.5000000000000018, -2.600000000000002, -2.5000000000000018, -3.3000000000000007, -3.0000000000000018, -5.199999999999999, -4.899999999999995, -2.900000000000002, -3.5, -3.8999999999999995, -3.4000000000000004, -3.200000000000001, -2.1000000000000014, -3.0000000000000018, -3.5, -3.3000000000000007, -3.6999999999999993, -3.799999999999999, -3.6999999999999993, -6.0, -4.799999999999995, -11.799999999999972, -2.800000000000002, -4.4999999999999964, -4.899999999999998, -3.4000000000000004, -2.700000000000002, -4.8999999999999995, -3.8999999999999986, -3.8999999999999986, -3.5999999999999996, -2.5000000000000018, -3.8999999999999986, -3.3000000000000007, -4.199999999999998, -3.8999999999999986, -3.5999999999999996, -3.3000000000000007, -4.199999999999999, -5.399999999999994, -2.2000000000000015, -4.100000000000001, -4.100000000000001, -3.8999999999999986, -5.099999999999994, -4.4999999999999964, -4.399999999999997, -4.899999999999995, -4.299999999999997, -52.50000000000027, -7.899999999999993, -3.5, -5.299999999999994, -3.4000000000000004, -3.999999999999999, -5.499999999999998, -4.099999999999998, -4.399999999999997, -2.700000000000002, -5.799999999999998, -4.6000000000000005, -6.099999999999995], "episode_lengths": [48, 40, 58, 60, 50, 54, 400, 52, 43, 40, 53, 69, 37, 49, 65, 32, 53, 66, 48, 53, 56, 31, 52, 65, 64, 49, 47, 59, 65, 40, 51, 58, 36, 58, 400, 63, 55, 68, 36, 36, 36, 44, 41, 57, 60, 40, 46, 49, 45, 43, 32, 41, 46, 44, 46, 49, 48, 61, 59, 126, 39, 56, 55, 45, 38, 55, 49, 50, 47, 36, 50, 44, 52, 50, 47, 44, 51, 64, 33, 48, 46, 50, 62, 56, 55, 60, 54, 400, 81, 45, 64, 45, 50, 60, 52, 55, 38, 58, 51, 67]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.274235278985383, "mean_inference_ms": 0.7336919731921874, "mean_action_processing_ms": 0.07640830684832817, "mean_env_wait_ms": 6.5306659354860725, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006792783737182617, "StateBufferConnector_ms": 0.003925800323486328, "ViewRequirementAgentConnector_ms": 0.09033608436584473}, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 120000, "num_agent_steps_trained": 120000, "num_env_steps_sampled": 120000, "num_env_steps_trained": 120000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 439.5362149652072, "num_env_steps_trained_throughput_per_sec": 439.5362149652072, "timesteps_total": 120000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 120000, "timers": {"training_iteration_time_ms": 9390.234, "sample_time_ms": 5523.775, "load_time_ms": 1.042, "load_throughput": 3840234.389, "learn_time_ms": 3862.546, "learn_throughput": 1035.587, "synch_weights_time_ms": 2.199}, "counters": {"num_env_steps_sampled": 120000, "num_env_steps_trained": 120000, "num_agent_steps_sampled": 120000, "num_agent_steps_trained": 120000}, "done": false, "episodes_total": 1074, "training_iteration": 30, "trial_id": "ddfb6_00000", "date": "2024-03-07_12-52-51", "timestamp": 1709833971, "time_this_iter_s": 9.103186845779419, "time_total_s": 271.475120306015, "pid": 112355, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4d85689f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 271.475120306015, "iterations_since_restore": 30, "perf": {"cpu_util_percent": 27.408333333333335, "ram_util_percent": 51.800000000000004, "gpu_util_percent0": 0.1025, "vram_util_percent0": 0.12599012586805555}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.10000000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 1.6545891429502917, "policy_loss": -0.006815772555688376, "vf_loss": 1.6607248867551485, "vf_explained_var": 0.5279580027185461, "kl": 0.006800277607424539, "entropy": 0.6204237421353658, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 28365.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 124000, "num_env_steps_trained": 124000, "num_agent_steps_sampled": 124000, "num_agent_steps_trained": 124000}, "sampler_results": {"episode_reward_max": -1.8000000000000012, "episode_reward_min": -66.40000000000045, "episode_reward_mean": -5.849000000000011, "episode_len_mean": 61.7, "episode_media": {}, "episodes_this_iter": 72, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4.199999999999998, -3.8999999999999986, -3.5999999999999996, -3.3000000000000007, -4.199999999999999, -5.399999999999994, -2.2000000000000015, -4.100000000000001, -4.100000000000001, -3.8999999999999986, -5.099999999999994, -4.4999999999999964, -4.399999999999997, -4.899999999999995, -4.299999999999997, -52.50000000000027, -7.899999999999993, -3.5, -5.299999999999994, -3.4000000000000004, -3.999999999999999, -5.499999999999998, -4.099999999999998, -4.399999999999997, -2.700000000000002, -5.799999999999998, -4.6000000000000005, -6.099999999999995, -4.399999999999997, -3.5, -2.700000000000002, -2.600000000000002, -2.4000000000000017, -2.900000000000002, -5.199999999999999, -13.699999999999967, -3.4000000000000004, -2.900000000000002, -2.0000000000000013, -2.4000000000000017, -4.599999999999996, -3.5999999999999996, -66.40000000000045, -3.7, -3.799999999999999, -4.999999999999997, -3.5999999999999996, -1.8000000000000012, -4.799999999999995, -3.200000000000001, -5.699999999999992, -2.1000000000000014, -3.200000000000001, -3.1000000000000014, -3.5999999999999996, -3.5, -3.799999999999999, -2.4000000000000017, -2.600000000000002, -3.9999999999999982, -4.399999999999997, -5.600000000000002, -6.399999999999995, -2.600000000000002, -1.9000000000000012, -2.4000000000000017, -3.1000000000000014, -3.200000000000001, -4.399999999999997, -3.200000000000001, -31.400000000000013, -3.4000000000000004, -3.500000000000001, -3.5999999999999996, -2.3000000000000016, -8.49999999999999, -2.700000000000002, -2.800000000000002, -3.700000000000001, -4.1999999999999975, -55.10000000000031, -2.900000000000002, -3.5999999999999996, -4.099999999999999, -4.4999999999999964, -3.1000000000000014, -3.5, -2.600000000000002, -3.6999999999999993, -4.399999999999997, -6.399999999999996, -3.8999999999999995, -3.9999999999999982, -3.5000000000000018, -4.399999999999998, -3.8999999999999986, -3.5999999999999996, -3.200000000000001, -4.1999999999999975, -2.5000000000000018], "episode_lengths": [52, 50, 47, 44, 51, 64, 33, 48, 46, 50, 62, 56, 55, 60, 54, 400, 81, 45, 64, 45, 50, 60, 52, 55, 38, 58, 51, 67, 55, 46, 38, 37, 35, 40, 57, 126, 45, 40, 31, 35, 57, 47, 400, 47, 49, 58, 47, 29, 59, 43, 62, 32, 43, 41, 47, 46, 49, 35, 37, 51, 55, 56, 69, 37, 30, 35, 42, 43, 55, 43, 268, 39, 45, 47, 34, 81, 38, 39, 45, 53, 400, 40, 47, 51, 56, 42, 46, 37, 48, 55, 66, 49, 51, 44, 53, 50, 47, 43, 53, 36]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2757801444979787, "mean_inference_ms": 0.7332796525940054, "mean_action_processing_ms": 0.07631750092862852, "mean_env_wait_ms": 6.547178786737254, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0066852569580078125, "StateBufferConnector_ms": 0.0039327144622802734, "ViewRequirementAgentConnector_ms": 0.08845067024230957}}, "episode_reward_max": -1.8000000000000012, "episode_reward_min": -66.40000000000045, "episode_reward_mean": -5.849000000000011, "episode_len_mean": 61.7, "episodes_this_iter": 72, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-4.199999999999998, -3.8999999999999986, -3.5999999999999996, -3.3000000000000007, -4.199999999999999, -5.399999999999994, -2.2000000000000015, -4.100000000000001, -4.100000000000001, -3.8999999999999986, -5.099999999999994, -4.4999999999999964, -4.399999999999997, -4.899999999999995, -4.299999999999997, -52.50000000000027, -7.899999999999993, -3.5, -5.299999999999994, -3.4000000000000004, -3.999999999999999, -5.499999999999998, -4.099999999999998, -4.399999999999997, -2.700000000000002, -5.799999999999998, -4.6000000000000005, -6.099999999999995, -4.399999999999997, -3.5, -2.700000000000002, -2.600000000000002, -2.4000000000000017, -2.900000000000002, -5.199999999999999, -13.699999999999967, -3.4000000000000004, -2.900000000000002, -2.0000000000000013, -2.4000000000000017, -4.599999999999996, -3.5999999999999996, -66.40000000000045, -3.7, -3.799999999999999, -4.999999999999997, -3.5999999999999996, -1.8000000000000012, -4.799999999999995, -3.200000000000001, -5.699999999999992, -2.1000000000000014, -3.200000000000001, -3.1000000000000014, -3.5999999999999996, -3.5, -3.799999999999999, -2.4000000000000017, -2.600000000000002, -3.9999999999999982, -4.399999999999997, -5.600000000000002, -6.399999999999995, -2.600000000000002, -1.9000000000000012, -2.4000000000000017, -3.1000000000000014, -3.200000000000001, -4.399999999999997, -3.200000000000001, -31.400000000000013, -3.4000000000000004, -3.500000000000001, -3.5999999999999996, -2.3000000000000016, -8.49999999999999, -2.700000000000002, -2.800000000000002, -3.700000000000001, -4.1999999999999975, -55.10000000000031, -2.900000000000002, -3.5999999999999996, -4.099999999999999, -4.4999999999999964, -3.1000000000000014, -3.5, -2.600000000000002, -3.6999999999999993, -4.399999999999997, -6.399999999999996, -3.8999999999999995, -3.9999999999999982, -3.5000000000000018, -4.399999999999998, -3.8999999999999986, -3.5999999999999996, -3.200000000000001, -4.1999999999999975, -2.5000000000000018], "episode_lengths": [52, 50, 47, 44, 51, 64, 33, 48, 46, 50, 62, 56, 55, 60, 54, 400, 81, 45, 64, 45, 50, 60, 52, 55, 38, 58, 51, 67, 55, 46, 38, 37, 35, 40, 57, 126, 45, 40, 31, 35, 57, 47, 400, 47, 49, 58, 47, 29, 59, 43, 62, 32, 43, 41, 47, 46, 49, 35, 37, 51, 55, 56, 69, 37, 30, 35, 42, 43, 55, 43, 268, 39, 45, 47, 34, 81, 38, 39, 45, 53, 400, 40, 47, 51, 56, 42, 46, 37, 48, 55, 66, 49, 51, 44, 53, 50, 47, 43, 53, 36]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2757801444979787, "mean_inference_ms": 0.7332796525940054, "mean_action_processing_ms": 0.07631750092862852, "mean_env_wait_ms": 6.547178786737254, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0066852569580078125, "StateBufferConnector_ms": 0.0039327144622802734, "ViewRequirementAgentConnector_ms": 0.08845067024230957}, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 124000, "num_agent_steps_trained": 124000, "num_env_steps_sampled": 124000, "num_env_steps_trained": 124000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 432.1154404317977, "num_env_steps_trained_throughput_per_sec": 432.1154404317977, "timesteps_total": 124000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 124000, "timers": {"training_iteration_time_ms": 9420.865, "sample_time_ms": 5546.099, "load_time_ms": 1.046, "load_throughput": 3825174.647, "learn_time_ms": 3870.857, "learn_throughput": 1033.363, "synch_weights_time_ms": 2.185}, "counters": {"num_env_steps_sampled": 124000, "num_env_steps_trained": 124000, "num_agent_steps_sampled": 124000, "num_agent_steps_trained": 124000}, "done": false, "episodes_total": 1146, "training_iteration": 31, "trial_id": "ddfb6_00000", "date": "2024-03-07_12-53-00", "timestamp": 1709833980, "time_this_iter_s": 9.259370565414429, "time_total_s": 280.73449087142944, "pid": 112355, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4d85689f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 280.73449087142944, "iterations_since_restore": 31, "perf": {"cpu_util_percent": 26.366666666666664, "ram_util_percent": 51.79999999999999, "gpu_util_percent0": 0.09333333333333332, "vram_util_percent0": 0.12602403428819445}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.10000000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 1.5041651911239304, "policy_loss": -0.026210657939795524, "vf_loss": 1.5295659615708295, "vf_explained_var": 0.5907751092346766, "kl": 0.008098900034493399, "entropy": 0.5950061864429904, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 29295.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 128000, "num_env_steps_trained": 128000, "num_agent_steps_sampled": 128000, "num_agent_steps_trained": 128000}, "sampler_results": {"episode_reward_max": -1.5000000000000009, "episode_reward_min": -55.10000000000031, "episode_reward_mean": -4.679000000000003, "episode_len_mean": 53.45, "episode_media": {}, "episodes_this_iter": 73, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.5999999999999996, -2.3000000000000016, -8.49999999999999, -2.700000000000002, -2.800000000000002, -3.700000000000001, -4.1999999999999975, -55.10000000000031, -2.900000000000002, -3.5999999999999996, -4.099999999999999, -4.4999999999999964, -3.1000000000000014, -3.5, -2.600000000000002, -3.6999999999999993, -4.399999999999997, -6.399999999999996, -3.8999999999999995, -3.9999999999999982, -3.5000000000000018, -4.399999999999998, -3.8999999999999986, -3.5999999999999996, -3.200000000000001, -4.1999999999999975, -2.5000000000000018, -4.399999999999998, -3.4000000000000012, -3.5999999999999996, -3.3000000000000007, -1.5000000000000009, -2.700000000000002, -1.9000000000000012, -3.200000000000001, -2.800000000000002, -4.399999999999998, -3.0000000000000018, -4.699999999999997, -2.800000000000002, -4.099999999999998, -2.900000000000002, -3.0000000000000018, -2.800000000000002, -2.1000000000000014, -3.5, -4.699999999999996, -3.0000000000000018, -2.5000000000000018, -3.3000000000000007, -2.900000000000002, -33.800000000000054, -2.900000000000002, -4.099999999999998, -3.7, -3.3000000000000007, -2.2000000000000015, -3.4000000000000004, -3.0000000000000018, -3.6999999999999993, -2.900000000000002, -3.9999999999999982, -30.499999999999975, -2.4000000000000017, -2.600000000000002, -1.700000000000001, -3.4000000000000004, -3.3000000000000007, -5.199999999999994, -2.700000000000002, -2.2000000000000015, -3.8999999999999986, -4.6999999999999975, -2.900000000000002, -3.3000000000000007, -1.9000000000000012, -3.8, -3.1000000000000014, -15.899999999999977, -4.4999999999999964, -2.1000000000000014, -1.9000000000000012, -4.100000000000001, -8.899999999999991, -2.700000000000002, -2.800000000000002, -3.5999999999999996, -4.299999999999997, -3.3000000000000007, -3.1000000000000014, -3.5, -2.2000000000000015, -3.4000000000000004, -4.1999999999999975, -2.600000000000002, -2.600000000000002, -3.1000000000000014, -7.299999999999994, -2.900000000000002, -2.900000000000002], "episode_lengths": [47, 34, 81, 38, 39, 45, 53, 400, 40, 47, 51, 56, 42, 46, 37, 48, 55, 66, 49, 51, 44, 53, 50, 47, 43, 53, 36, 51, 43, 47, 41, 26, 38, 30, 43, 39, 50, 41, 57, 39, 52, 40, 41, 39, 32, 46, 58, 41, 36, 44, 40, 258, 40, 52, 47, 44, 33, 45, 41, 48, 40, 51, 231, 35, 37, 28, 45, 44, 63, 37, 33, 50, 56, 40, 44, 30, 45, 42, 159, 56, 32, 30, 47, 85, 37, 39, 47, 54, 44, 42, 46, 33, 45, 53, 37, 37, 42, 76, 40, 40]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2775656045694066, "mean_inference_ms": 0.7327783069054996, "mean_action_processing_ms": 0.07625441524348765, "mean_env_wait_ms": 6.560352855553429, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0068721771240234375, "StateBufferConnector_ms": 0.003909111022949219, "ViewRequirementAgentConnector_ms": 0.08813214302062988}}, "episode_reward_max": -1.5000000000000009, "episode_reward_min": -55.10000000000031, "episode_reward_mean": -4.679000000000003, "episode_len_mean": 53.45, "episodes_this_iter": 73, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3.5999999999999996, -2.3000000000000016, -8.49999999999999, -2.700000000000002, -2.800000000000002, -3.700000000000001, -4.1999999999999975, -55.10000000000031, -2.900000000000002, -3.5999999999999996, -4.099999999999999, -4.4999999999999964, -3.1000000000000014, -3.5, -2.600000000000002, -3.6999999999999993, -4.399999999999997, -6.399999999999996, -3.8999999999999995, -3.9999999999999982, -3.5000000000000018, -4.399999999999998, -3.8999999999999986, -3.5999999999999996, -3.200000000000001, -4.1999999999999975, -2.5000000000000018, -4.399999999999998, -3.4000000000000012, -3.5999999999999996, -3.3000000000000007, -1.5000000000000009, -2.700000000000002, -1.9000000000000012, -3.200000000000001, -2.800000000000002, -4.399999999999998, -3.0000000000000018, -4.699999999999997, -2.800000000000002, -4.099999999999998, -2.900000000000002, -3.0000000000000018, -2.800000000000002, -2.1000000000000014, -3.5, -4.699999999999996, -3.0000000000000018, -2.5000000000000018, -3.3000000000000007, -2.900000000000002, -33.800000000000054, -2.900000000000002, -4.099999999999998, -3.7, -3.3000000000000007, -2.2000000000000015, -3.4000000000000004, -3.0000000000000018, -3.6999999999999993, -2.900000000000002, -3.9999999999999982, -30.499999999999975, -2.4000000000000017, -2.600000000000002, -1.700000000000001, -3.4000000000000004, -3.3000000000000007, -5.199999999999994, -2.700000000000002, -2.2000000000000015, -3.8999999999999986, -4.6999999999999975, -2.900000000000002, -3.3000000000000007, -1.9000000000000012, -3.8, -3.1000000000000014, -15.899999999999977, -4.4999999999999964, -2.1000000000000014, -1.9000000000000012, -4.100000000000001, -8.899999999999991, -2.700000000000002, -2.800000000000002, -3.5999999999999996, -4.299999999999997, -3.3000000000000007, -3.1000000000000014, -3.5, -2.2000000000000015, -3.4000000000000004, -4.1999999999999975, -2.600000000000002, -2.600000000000002, -3.1000000000000014, -7.299999999999994, -2.900000000000002, -2.900000000000002], "episode_lengths": [47, 34, 81, 38, 39, 45, 53, 400, 40, 47, 51, 56, 42, 46, 37, 48, 55, 66, 49, 51, 44, 53, 50, 47, 43, 53, 36, 51, 43, 47, 41, 26, 38, 30, 43, 39, 50, 41, 57, 39, 52, 40, 41, 39, 32, 46, 58, 41, 36, 44, 40, 258, 40, 52, 47, 44, 33, 45, 41, 48, 40, 51, 231, 35, 37, 28, 45, 44, 63, 37, 33, 50, 56, 40, 44, 30, 45, 42, 159, 56, 32, 30, 47, 85, 37, 39, 47, 54, 44, 42, 46, 33, 45, 53, 37, 37, 42, 76, 40, 40]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2775656045694066, "mean_inference_ms": 0.7327783069054996, "mean_action_processing_ms": 0.07625441524348765, "mean_env_wait_ms": 6.560352855553429, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0068721771240234375, "StateBufferConnector_ms": 0.003909111022949219, "ViewRequirementAgentConnector_ms": 0.08813214302062988}, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 128000, "num_agent_steps_trained": 128000, "num_env_steps_sampled": 128000, "num_env_steps_trained": 128000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 441.98967453544986, "num_env_steps_trained_throughput_per_sec": 441.98967453544986, "timesteps_total": 128000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 128000, "timers": {"training_iteration_time_ms": 9389.629, "sample_time_ms": 5555.217, "load_time_ms": 1.046, "load_throughput": 3824215.541, "learn_time_ms": 3830.5, "learn_throughput": 1044.25, "synch_weights_time_ms": 2.188}, "counters": {"num_env_steps_sampled": 128000, "num_env_steps_trained": 128000, "num_agent_steps_sampled": 128000, "num_agent_steps_trained": 128000}, "done": false, "episodes_total": 1219, "training_iteration": 32, "trial_id": "ddfb6_00000", "date": "2024-03-07_12-53-09", "timestamp": 1709833989, "time_this_iter_s": 9.052589654922485, "time_total_s": 289.78708052635193, "pid": 112355, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4d85689f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 289.78708052635193, "iterations_since_restore": 32, "perf": {"cpu_util_percent": 26.483333333333338, "ram_util_percent": 51.70000000000001, "gpu_util_percent0": 0.09166666666666666, "vram_util_percent0": 0.1259765625}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.10000000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 0.19326673292195654, "policy_loss": -0.011551099862422674, "vf_loss": 0.203896543966426, "vf_explained_var": 0.9083879998294256, "kl": 0.009212872548738506, "entropy": 0.508929203306475, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 30225.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 132000, "num_env_steps_trained": 132000, "num_agent_steps_sampled": 132000, "num_agent_steps_trained": 132000}, "sampler_results": {"episode_reward_max": -1.5000000000000009, "episode_reward_min": -53.40000000000027, "episode_reward_mean": -4.1540000000000035, "episode_len_mean": 49.42, "episode_media": {}, "episodes_this_iter": 87, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4.299999999999997, -3.3000000000000007, -3.1000000000000014, -3.5, -2.2000000000000015, -3.4000000000000004, -4.1999999999999975, -2.600000000000002, -2.600000000000002, -3.1000000000000014, -7.299999999999994, -2.900000000000002, -2.900000000000002, -53.40000000000027, -3.4000000000000004, -3.9999999999999982, -5.199999999999999, -4.899999999999998, -3.799999999999999, -2.900000000000002, -2.800000000000002, -3.200000000000001, -2.3000000000000016, -3.400000000000002, -2.4000000000000017, -2.4000000000000017, -3.3000000000000007, -3.700000000000002, -3.5999999999999996, -1.600000000000001, -2.600000000000002, -3.799999999999999, -2.3000000000000016, -2.800000000000002, -3.5999999999999996, -3.4000000000000004, -2.900000000000002, -3.6999999999999993, -3.6999999999999993, -3.5, -3.200000000000001, -3.5999999999999996, -3.5999999999999996, -2.700000000000002, -4.500000000000002, -3.0000000000000018, -3.799999999999999, -3.5999999999999996, -3.1000000000000014, -3.3000000000000007, -4.299999999999997, -2.700000000000002, -2.900000000000002, -2.600000000000002, -4.299999999999998, -2.800000000000002, -3.0000000000000018, -2.600000000000002, -3.0000000000000018, -2.2000000000000015, -3.200000000000001, -3.200000000000001, -3.1000000000000014, -3.3000000000000007, -4.1000000000000005, -4.399999999999997, -3.4000000000000004, -3.0000000000000018, -3.6999999999999993, -4.599999999999996, -5.199999999999994, -4.1999999999999975, -2.1000000000000014, -4.4999999999999964, -2.800000000000002, -3.5999999999999996, -2.600000000000002, -3.3000000000000007, -3.8999999999999986, -3.8000000000000007, -2.900000000000002, -3.500000000000001, -2.5000000000000018, -2.3000000000000016, -2.700000000000002, -5.499999999999999, -3.6999999999999993, -3.0000000000000018, -35.50000000000008, -3.8999999999999986, -2.2000000000000015, -1.5000000000000009, -3.200000000000001, -3.3000000000000007, -2.1000000000000014, -3.6999999999999993, -3.8999999999999986, -2.800000000000002, -3.700000000000001, -2.700000000000002], "episode_lengths": [54, 44, 42, 46, 33, 45, 53, 37, 37, 42, 76, 40, 40, 391, 45, 51, 57, 57, 49, 40, 39, 43, 34, 42, 35, 35, 44, 45, 47, 27, 37, 49, 34, 39, 47, 45, 40, 48, 48, 46, 43, 47, 47, 38, 50, 41, 49, 47, 42, 44, 54, 37, 40, 37, 53, 39, 41, 37, 39, 33, 43, 41, 40, 43, 48, 55, 45, 41, 48, 57, 63, 53, 32, 56, 39, 47, 37, 44, 50, 47, 40, 45, 36, 34, 38, 59, 48, 41, 262, 50, 33, 26, 43, 44, 32, 48, 50, 39, 46, 38]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.28002899680899385, "mean_inference_ms": 0.7320308561682256, "mean_action_processing_ms": 0.07618120953191317, "mean_env_wait_ms": 6.57377693278246, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006642818450927734, "StateBufferConnector_ms": 0.0038127899169921875, "ViewRequirementAgentConnector_ms": 0.08735132217407227}}, "episode_reward_max": -1.5000000000000009, "episode_reward_min": -53.40000000000027, "episode_reward_mean": -4.1540000000000035, "episode_len_mean": 49.42, "episodes_this_iter": 87, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-4.299999999999997, -3.3000000000000007, -3.1000000000000014, -3.5, -2.2000000000000015, -3.4000000000000004, -4.1999999999999975, -2.600000000000002, -2.600000000000002, -3.1000000000000014, -7.299999999999994, -2.900000000000002, -2.900000000000002, -53.40000000000027, -3.4000000000000004, -3.9999999999999982, -5.199999999999999, -4.899999999999998, -3.799999999999999, -2.900000000000002, -2.800000000000002, -3.200000000000001, -2.3000000000000016, -3.400000000000002, -2.4000000000000017, -2.4000000000000017, -3.3000000000000007, -3.700000000000002, -3.5999999999999996, -1.600000000000001, -2.600000000000002, -3.799999999999999, -2.3000000000000016, -2.800000000000002, -3.5999999999999996, -3.4000000000000004, -2.900000000000002, -3.6999999999999993, -3.6999999999999993, -3.5, -3.200000000000001, -3.5999999999999996, -3.5999999999999996, -2.700000000000002, -4.500000000000002, -3.0000000000000018, -3.799999999999999, -3.5999999999999996, -3.1000000000000014, -3.3000000000000007, -4.299999999999997, -2.700000000000002, -2.900000000000002, -2.600000000000002, -4.299999999999998, -2.800000000000002, -3.0000000000000018, -2.600000000000002, -3.0000000000000018, -2.2000000000000015, -3.200000000000001, -3.200000000000001, -3.1000000000000014, -3.3000000000000007, -4.1000000000000005, -4.399999999999997, -3.4000000000000004, -3.0000000000000018, -3.6999999999999993, -4.599999999999996, -5.199999999999994, -4.1999999999999975, -2.1000000000000014, -4.4999999999999964, -2.800000000000002, -3.5999999999999996, -2.600000000000002, -3.3000000000000007, -3.8999999999999986, -3.8000000000000007, -2.900000000000002, -3.500000000000001, -2.5000000000000018, -2.3000000000000016, -2.700000000000002, -5.499999999999999, -3.6999999999999993, -3.0000000000000018, -35.50000000000008, -3.8999999999999986, -2.2000000000000015, -1.5000000000000009, -3.200000000000001, -3.3000000000000007, -2.1000000000000014, -3.6999999999999993, -3.8999999999999986, -2.800000000000002, -3.700000000000001, -2.700000000000002], "episode_lengths": [54, 44, 42, 46, 33, 45, 53, 37, 37, 42, 76, 40, 40, 391, 45, 51, 57, 57, 49, 40, 39, 43, 34, 42, 35, 35, 44, 45, 47, 27, 37, 49, 34, 39, 47, 45, 40, 48, 48, 46, 43, 47, 47, 38, 50, 41, 49, 47, 42, 44, 54, 37, 40, 37, 53, 39, 41, 37, 39, 33, 43, 41, 40, 43, 48, 55, 45, 41, 48, 57, 63, 53, 32, 56, 39, 47, 37, 44, 50, 47, 40, 45, 36, 34, 38, 59, 48, 41, 262, 50, 33, 26, 43, 44, 32, 48, 50, 39, 46, 38]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.28002899680899385, "mean_inference_ms": 0.7320308561682256, "mean_action_processing_ms": 0.07618120953191317, "mean_env_wait_ms": 6.57377693278246, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006642818450927734, "StateBufferConnector_ms": 0.0038127899169921875, "ViewRequirementAgentConnector_ms": 0.08735132217407227}, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 132000, "num_agent_steps_trained": 132000, "num_env_steps_sampled": 132000, "num_env_steps_trained": 132000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 431.0778763491758, "num_env_steps_trained_throughput_per_sec": 431.0778763491758, "timesteps_total": 132000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 132000, "timers": {"training_iteration_time_ms": 9358.463, "sample_time_ms": 5556.682, "load_time_ms": 1.044, "load_throughput": 3830414.612, "learn_time_ms": 3797.871, "learn_throughput": 1053.222, "synch_weights_time_ms": 2.181}, "counters": {"num_env_steps_sampled": 132000, "num_env_steps_trained": 132000, "num_agent_steps_sampled": 132000, "num_agent_steps_trained": 132000}, "done": false, "episodes_total": 1306, "training_iteration": 33, "trial_id": "ddfb6_00000", "date": "2024-03-07_12-53-18", "timestamp": 1709833998, "time_this_iter_s": 9.281826734542847, "time_total_s": 299.0689072608948, "pid": 112355, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4d85689f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 299.0689072608948, "iterations_since_restore": 33, "perf": {"cpu_util_percent": 26.766666666666666, "ram_util_percent": 51.73333333333333, "gpu_util_percent0": 0.09166666666666666, "vram_util_percent0": 0.1260104709201389}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.10000000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 2.7433677547526174, "policy_loss": -0.008070891735053832, "vf_loss": 2.7501437107541706, "vf_explained_var": 0.3002783999007235, "kl": 0.01294933920795309, "entropy": 0.5928333269332045, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 31155.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 136000, "num_env_steps_trained": 136000, "num_agent_steps_sampled": 136000, "num_agent_steps_trained": 136000}, "sampler_results": {"episode_reward_max": -1.5000000000000009, "episode_reward_min": -59.00000000000039, "episode_reward_mean": -4.55400000000001, "episode_len_mean": 51.49, "episode_media": {}, "episodes_this_iter": 69, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4.599999999999996, -5.199999999999994, -4.1999999999999975, -2.1000000000000014, -4.4999999999999964, -2.800000000000002, -3.5999999999999996, -2.600000000000002, -3.3000000000000007, -3.8999999999999986, -3.8000000000000007, -2.900000000000002, -3.500000000000001, -2.5000000000000018, -2.3000000000000016, -2.700000000000002, -5.499999999999999, -3.6999999999999993, -3.0000000000000018, -35.50000000000008, -3.8999999999999986, -2.2000000000000015, -1.5000000000000009, -3.200000000000001, -3.3000000000000007, -2.1000000000000014, -3.6999999999999993, -3.8999999999999986, -2.800000000000002, -3.700000000000001, -2.700000000000002, -3.1000000000000014, -2.5000000000000018, -59.00000000000039, -2.0000000000000013, -2.3000000000000016, -2.800000000000002, -2.5000000000000018, -3.0000000000000018, -2.600000000000002, -2.0000000000000013, -2.900000000000002, -3.3000000000000007, -3.3000000000000007, -5.100000000000001, -3.200000000000001, -3.6999999999999993, -3.200000000000001, -7.2999999999999865, -2.800000000000002, -3.799999999999999, -2.1000000000000014, -3.0000000000000018, -4.099999999999998, -2.600000000000002, -3.799999999999999, -3.3000000000000007, -2.2000000000000015, -3.6999999999999993, -2.2000000000000015, -3.799999999999999, -3.6000000000000005, -3.0000000000000018, -2.700000000000002, -6.000000000000003, -3.5999999999999996, -2.4000000000000017, -2.600000000000002, -2.700000000000002, -3.799999999999999, -2.600000000000002, -1.5000000000000009, -2.5000000000000018, -2.2000000000000015, -3.0000000000000018, -2.700000000000002, -3.6999999999999993, -3.3000000000000007, -2.900000000000002, -2.800000000000002, -2.2000000000000015, -3.0000000000000018, -2.1000000000000014, -3.4000000000000004, -2.4000000000000017, -3.200000000000001, -3.8999999999999986, -3.5999999999999996, -2.700000000000002, -1.9000000000000012, -1.9000000000000012, -3.4000000000000004, -2.600000000000002, -2.900000000000002, -3.9999999999999982, -4.199999999999999, -54.600000000000406, -3.3000000000000007, -2.1000000000000014, -3.9999999999999982], "episode_lengths": [57, 63, 53, 32, 56, 39, 47, 37, 44, 50, 47, 40, 45, 36, 34, 38, 59, 48, 41, 262, 50, 33, 26, 43, 44, 32, 48, 50, 39, 46, 38, 42, 36, 398, 31, 34, 39, 36, 41, 37, 31, 40, 44, 44, 53, 43, 48, 43, 84, 39, 49, 32, 41, 52, 37, 49, 44, 33, 48, 33, 49, 46, 41, 38, 56, 47, 35, 37, 37, 49, 36, 26, 36, 33, 41, 38, 48, 44, 40, 39, 33, 41, 32, 45, 35, 43, 50, 47, 38, 30, 30, 45, 37, 40, 51, 51, 400, 44, 32, 51]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2814457614166653, "mean_inference_ms": 0.7315511703897779, "mean_action_processing_ms": 0.07615376070758867, "mean_env_wait_ms": 6.582548467960358, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006848335266113281, "StateBufferConnector_ms": 0.003837108612060547, "ViewRequirementAgentConnector_ms": 0.08801674842834473}}, "episode_reward_max": -1.5000000000000009, "episode_reward_min": -59.00000000000039, "episode_reward_mean": -4.55400000000001, "episode_len_mean": 51.49, "episodes_this_iter": 69, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-4.599999999999996, -5.199999999999994, -4.1999999999999975, -2.1000000000000014, -4.4999999999999964, -2.800000000000002, -3.5999999999999996, -2.600000000000002, -3.3000000000000007, -3.8999999999999986, -3.8000000000000007, -2.900000000000002, -3.500000000000001, -2.5000000000000018, -2.3000000000000016, -2.700000000000002, -5.499999999999999, -3.6999999999999993, -3.0000000000000018, -35.50000000000008, -3.8999999999999986, -2.2000000000000015, -1.5000000000000009, -3.200000000000001, -3.3000000000000007, -2.1000000000000014, -3.6999999999999993, -3.8999999999999986, -2.800000000000002, -3.700000000000001, -2.700000000000002, -3.1000000000000014, -2.5000000000000018, -59.00000000000039, -2.0000000000000013, -2.3000000000000016, -2.800000000000002, -2.5000000000000018, -3.0000000000000018, -2.600000000000002, -2.0000000000000013, -2.900000000000002, -3.3000000000000007, -3.3000000000000007, -5.100000000000001, -3.200000000000001, -3.6999999999999993, -3.200000000000001, -7.2999999999999865, -2.800000000000002, -3.799999999999999, -2.1000000000000014, -3.0000000000000018, -4.099999999999998, -2.600000000000002, -3.799999999999999, -3.3000000000000007, -2.2000000000000015, -3.6999999999999993, -2.2000000000000015, -3.799999999999999, -3.6000000000000005, -3.0000000000000018, -2.700000000000002, -6.000000000000003, -3.5999999999999996, -2.4000000000000017, -2.600000000000002, -2.700000000000002, -3.799999999999999, -2.600000000000002, -1.5000000000000009, -2.5000000000000018, -2.2000000000000015, -3.0000000000000018, -2.700000000000002, -3.6999999999999993, -3.3000000000000007, -2.900000000000002, -2.800000000000002, -2.2000000000000015, -3.0000000000000018, -2.1000000000000014, -3.4000000000000004, -2.4000000000000017, -3.200000000000001, -3.8999999999999986, -3.5999999999999996, -2.700000000000002, -1.9000000000000012, -1.9000000000000012, -3.4000000000000004, -2.600000000000002, -2.900000000000002, -3.9999999999999982, -4.199999999999999, -54.600000000000406, -3.3000000000000007, -2.1000000000000014, -3.9999999999999982], "episode_lengths": [57, 63, 53, 32, 56, 39, 47, 37, 44, 50, 47, 40, 45, 36, 34, 38, 59, 48, 41, 262, 50, 33, 26, 43, 44, 32, 48, 50, 39, 46, 38, 42, 36, 398, 31, 34, 39, 36, 41, 37, 31, 40, 44, 44, 53, 43, 48, 43, 84, 39, 49, 32, 41, 52, 37, 49, 44, 33, 48, 33, 49, 46, 41, 38, 56, 47, 35, 37, 37, 49, 36, 26, 36, 33, 41, 38, 48, 44, 40, 39, 33, 41, 32, 45, 35, 43, 50, 47, 38, 30, 30, 45, 37, 40, 51, 51, 400, 44, 32, 51]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2814457614166653, "mean_inference_ms": 0.7315511703897779, "mean_action_processing_ms": 0.07615376070758867, "mean_env_wait_ms": 6.582548467960358, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006848335266113281, "StateBufferConnector_ms": 0.003837108612060547, "ViewRequirementAgentConnector_ms": 0.08801674842834473}, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 136000, "num_agent_steps_trained": 136000, "num_env_steps_sampled": 136000, "num_env_steps_trained": 136000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 432.32423245463156, "num_env_steps_trained_throughput_per_sec": 432.32423245463156, "timesteps_total": 136000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 136000, "timers": {"training_iteration_time_ms": 9332.936, "sample_time_ms": 5580.821, "load_time_ms": 1.047, "load_throughput": 3820296.931, "learn_time_ms": 3748.217, "learn_throughput": 1067.174, "synch_weights_time_ms": 2.172}, "counters": {"num_env_steps_sampled": 136000, "num_env_steps_trained": 136000, "num_agent_steps_sampled": 136000, "num_agent_steps_trained": 136000}, "done": false, "episodes_total": 1375, "training_iteration": 34, "trial_id": "ddfb6_00000", "date": "2024-03-07_12-53-28", "timestamp": 1709834008, "time_this_iter_s": 9.255030393600464, "time_total_s": 308.32393765449524, "pid": 112355, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4d85689f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 308.32393765449524, "iterations_since_restore": 34, "perf": {"cpu_util_percent": 26.525000000000002, "ram_util_percent": 51.79999999999999, "gpu_util_percent0": 0.09833333333333333, "vram_util_percent0": 0.12599690755208334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.10000000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 1.27160103135756, "policy_loss": -0.008376490396838035, "vf_loss": 1.2791231424677916, "vf_explained_var": 0.5816990010840919, "kl": 0.00854379804963483, "entropy": 0.5720655880628094, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 32085.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 140000, "num_env_steps_trained": 140000, "num_agent_steps_sampled": 140000, "num_agent_steps_trained": 140000}, "sampler_results": {"episode_reward_max": -1.8000000000000012, "episode_reward_min": -58.10000000000035, "episode_reward_mean": -4.865000000000007, "episode_len_mean": 53.53, "episode_media": {}, "episodes_this_iter": 84, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2.4000000000000017, -3.200000000000001, -3.8999999999999986, -3.5999999999999996, -2.700000000000002, -1.9000000000000012, -1.9000000000000012, -3.4000000000000004, -2.600000000000002, -2.900000000000002, -3.9999999999999982, -4.199999999999999, -54.600000000000406, -3.3000000000000007, -2.1000000000000014, -3.9999999999999982, -24.79999999999996, -4.099999999999998, -3.3000000000000007, -2.3000000000000016, -3.0000000000000018, -5.599999999999998, -2.2000000000000015, -2.3000000000000016, -3.200000000000001, -2.900000000000002, -2.900000000000002, -3.3000000000000007, -3.5, -2.2000000000000015, -4.199999999999998, -2.1000000000000014, -2.4000000000000017, -7.700000000000003, -5.900000000000001, -2.0000000000000013, -11.999999999999986, -5.299999999999994, -4.400000000000001, -3.4000000000000004, -3.3000000000000007, -4.1999999999999975, -23.10000000000001, -3.5, -3.6999999999999993, -2.5000000000000018, -2.600000000000002, -2.3000000000000016, -2.4000000000000017, -2.1000000000000014, -3.0000000000000018, -1.8000000000000012, -2.800000000000002, -2.900000000000002, -3.5999999999999996, -2.900000000000002, -2.700000000000002, -4.4999999999999964, -2.600000000000002, -3.200000000000001, -2.900000000000002, -2.1000000000000014, -3.3000000000000016, -4.099999999999998, -2.700000000000002, -2.3000000000000016, -3.799999999999999, -2.4000000000000017, -3.8999999999999986, -2.700000000000002, -15.599999999999973, -4.399999999999997, -2.600000000000002, -58.10000000000035, -4.299999999999997, -2.3000000000000016, -2.2000000000000015, -3.5, -2.3000000000000016, -3.799999999999999, -2.700000000000002, -2.800000000000002, -2.2000000000000015, -3.8999999999999986, -1.8000000000000012, -2.700000000000002, -2.3000000000000016, -1.9000000000000012, -2.4000000000000017, -4.099999999999998, -3.4000000000000004, -2.900000000000002, -3.3000000000000007, -4.299999999999999, -4.399999999999998, -3.6999999999999993, -3.6000000000000014, -2.600000000000002, -3.6999999999999993, -3.1000000000000014], "episode_lengths": [35, 43, 50, 47, 38, 30, 30, 45, 37, 40, 51, 51, 400, 44, 32, 51, 190, 52, 44, 34, 41, 61, 33, 34, 43, 40, 40, 44, 46, 33, 52, 32, 35, 64, 59, 31, 100, 64, 50, 45, 44, 52, 180, 46, 48, 36, 37, 34, 35, 32, 41, 29, 39, 39, 47, 40, 38, 56, 37, 43, 40, 32, 42, 52, 38, 34, 49, 35, 50, 38, 144, 55, 37, 382, 54, 34, 33, 46, 34, 49, 38, 39, 33, 50, 29, 38, 34, 30, 35, 52, 45, 40, 44, 52, 54, 48, 43, 37, 48, 42]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.283308600891565, "mean_inference_ms": 0.7311235881837402, "mean_action_processing_ms": 0.0761166612681402, "mean_env_wait_ms": 6.599282466187728, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006766080856323242, "StateBufferConnector_ms": 0.003847837448120117, "ViewRequirementAgentConnector_ms": 0.0879526138305664}}, "episode_reward_max": -1.8000000000000012, "episode_reward_min": -58.10000000000035, "episode_reward_mean": -4.865000000000007, "episode_len_mean": 53.53, "episodes_this_iter": 84, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-2.4000000000000017, -3.200000000000001, -3.8999999999999986, -3.5999999999999996, -2.700000000000002, -1.9000000000000012, -1.9000000000000012, -3.4000000000000004, -2.600000000000002, -2.900000000000002, -3.9999999999999982, -4.199999999999999, -54.600000000000406, -3.3000000000000007, -2.1000000000000014, -3.9999999999999982, -24.79999999999996, -4.099999999999998, -3.3000000000000007, -2.3000000000000016, -3.0000000000000018, -5.599999999999998, -2.2000000000000015, -2.3000000000000016, -3.200000000000001, -2.900000000000002, -2.900000000000002, -3.3000000000000007, -3.5, -2.2000000000000015, -4.199999999999998, -2.1000000000000014, -2.4000000000000017, -7.700000000000003, -5.900000000000001, -2.0000000000000013, -11.999999999999986, -5.299999999999994, -4.400000000000001, -3.4000000000000004, -3.3000000000000007, -4.1999999999999975, -23.10000000000001, -3.5, -3.6999999999999993, -2.5000000000000018, -2.600000000000002, -2.3000000000000016, -2.4000000000000017, -2.1000000000000014, -3.0000000000000018, -1.8000000000000012, -2.800000000000002, -2.900000000000002, -3.5999999999999996, -2.900000000000002, -2.700000000000002, -4.4999999999999964, -2.600000000000002, -3.200000000000001, -2.900000000000002, -2.1000000000000014, -3.3000000000000016, -4.099999999999998, -2.700000000000002, -2.3000000000000016, -3.799999999999999, -2.4000000000000017, -3.8999999999999986, -2.700000000000002, -15.599999999999973, -4.399999999999997, -2.600000000000002, -58.10000000000035, -4.299999999999997, -2.3000000000000016, -2.2000000000000015, -3.5, -2.3000000000000016, -3.799999999999999, -2.700000000000002, -2.800000000000002, -2.2000000000000015, -3.8999999999999986, -1.8000000000000012, -2.700000000000002, -2.3000000000000016, -1.9000000000000012, -2.4000000000000017, -4.099999999999998, -3.4000000000000004, -2.900000000000002, -3.3000000000000007, -4.299999999999999, -4.399999999999998, -3.6999999999999993, -3.6000000000000014, -2.600000000000002, -3.6999999999999993, -3.1000000000000014], "episode_lengths": [35, 43, 50, 47, 38, 30, 30, 45, 37, 40, 51, 51, 400, 44, 32, 51, 190, 52, 44, 34, 41, 61, 33, 34, 43, 40, 40, 44, 46, 33, 52, 32, 35, 64, 59, 31, 100, 64, 50, 45, 44, 52, 180, 46, 48, 36, 37, 34, 35, 32, 41, 29, 39, 39, 47, 40, 38, 56, 37, 43, 40, 32, 42, 52, 38, 34, 49, 35, 50, 38, 144, 55, 37, 382, 54, 34, 33, 46, 34, 49, 38, 39, 33, 50, 29, 38, 34, 30, 35, 52, 45, 40, 44, 52, 54, 48, 43, 37, 48, 42]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.283308600891565, "mean_inference_ms": 0.7311235881837402, "mean_action_processing_ms": 0.0761166612681402, "mean_env_wait_ms": 6.599282466187728, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006766080856323242, "StateBufferConnector_ms": 0.003847837448120117, "ViewRequirementAgentConnector_ms": 0.0879526138305664}, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 140000, "num_agent_steps_trained": 140000, "num_env_steps_sampled": 140000, "num_env_steps_trained": 140000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 427.0791201168426, "num_env_steps_trained_throughput_per_sec": 427.0791201168426, "timesteps_total": 140000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 140000, "timers": {"training_iteration_time_ms": 9340.748, "sample_time_ms": 5608.624, "load_time_ms": 1.038, "load_throughput": 3854970.244, "learn_time_ms": 3728.292, "learn_throughput": 1072.877, "synch_weights_time_ms": 2.115}, "counters": {"num_env_steps_sampled": 140000, "num_env_steps_trained": 140000, "num_agent_steps_sampled": 140000, "num_agent_steps_trained": 140000}, "done": false, "episodes_total": 1459, "training_iteration": 35, "trial_id": "ddfb6_00000", "date": "2024-03-07_12-53-37", "timestamp": 1709834017, "time_this_iter_s": 9.36873173713684, "time_total_s": 317.6926693916321, "pid": 112355, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4d85689f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 317.6926693916321, "iterations_since_restore": 35, "perf": {"cpu_util_percent": 27.141666666666666, "ram_util_percent": 51.75833333333333, "gpu_util_percent0": 0.08750000000000001, "vram_util_percent0": 0.1259765625}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.10000000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 0.939927751431492, "policy_loss": -0.005975208439493692, "vf_loss": 0.9452757906268842, "vf_explained_var": 0.6902598895693338, "kl": 0.006271715304303867, "entropy": 0.5762718362833864, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 33015.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_agent_steps_sampled": 144000, "num_agent_steps_trained": 144000}, "sampler_results": {"episode_reward_max": -1.8000000000000012, "episode_reward_min": -48.10000000000023, "episode_reward_mean": -3.8880000000000026, "episode_len_mean": 47.2, "episode_media": {}, "episodes_this_iter": 81, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2.800000000000002, -2.2000000000000015, -3.8999999999999986, -1.8000000000000012, -2.700000000000002, -2.3000000000000016, -1.9000000000000012, -2.4000000000000017, -4.099999999999998, -3.4000000000000004, -2.900000000000002, -3.3000000000000007, -4.299999999999999, -4.399999999999998, -3.6999999999999993, -3.6000000000000014, -2.600000000000002, -3.6999999999999993, -3.1000000000000014, -2.3000000000000016, -3.5, -2.700000000000002, -4.099999999999998, -3.6999999999999993, -3.5999999999999996, -5.099999999999996, -6.499999999999998, -3.0000000000000018, -3.1000000000000014, -3.0000000000000018, -2.900000000000002, -2.4000000000000017, -3.6999999999999993, -3.4000000000000004, -3.1000000000000014, -2.900000000000002, -2.5000000000000018, -2.800000000000002, -2.4000000000000017, -3.5, -3.200000000000001, -24.999999999999975, -4.499999999999998, -2.900000000000002, -3.200000000000001, -3.6999999999999993, -2.4000000000000017, -3.999999999999999, -4.1999999999999975, -3.1000000000000014, -2.5000000000000018, -3.8, -3.8999999999999986, -2.600000000000002, -4.400000000000001, -3.200000000000001, -4.299999999999997, -3.799999999999999, -3.0000000000000018, -2.1000000000000014, -2.800000000000002, -2.3000000000000016, -4.199999999999998, -3.6999999999999993, -3.6000000000000014, -3.1000000000000014, -3.6999999999999993, -3.0000000000000018, -3.1000000000000023, -2.5000000000000018, -2.700000000000002, -3.200000000000001, -3.0000000000000018, -3.4000000000000004, -3.9999999999999982, -48.10000000000023, -2.4000000000000017, -5.399999999999993, -1.8000000000000012, -3.5, -2.800000000000002, -3.9999999999999982, -2.700000000000002, -2.3000000000000016, -3.799999999999999, -3.5, -4.9, -2.1000000000000014, -4.799999999999996, -2.900000000000002, -3.5999999999999996, -2.1000000000000014, -2.600000000000002, -2.5000000000000018, -2.0000000000000013, -2.600000000000002, -2.3000000000000016, -2.900000000000002, -3.1000000000000014, -2.700000000000002], "episode_lengths": [39, 33, 50, 29, 38, 34, 30, 35, 52, 45, 40, 44, 52, 54, 48, 43, 37, 48, 42, 34, 46, 38, 52, 48, 47, 60, 66, 41, 42, 41, 40, 35, 48, 45, 42, 40, 36, 39, 35, 46, 43, 205, 54, 40, 43, 48, 35, 50, 53, 42, 36, 48, 50, 37, 48, 43, 54, 49, 41, 32, 39, 34, 52, 48, 44, 42, 48, 41, 41, 36, 38, 43, 40, 45, 51, 325, 35, 65, 29, 46, 39, 51, 38, 34, 49, 46, 53, 32, 58, 40, 47, 32, 37, 36, 31, 37, 34, 40, 41, 38]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.28453089533049253, "mean_inference_ms": 0.7309034999324521, "mean_action_processing_ms": 0.07606414530790129, "mean_env_wait_ms": 6.607281580310887, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006711721420288086, "StateBufferConnector_ms": 0.0038471221923828125, "ViewRequirementAgentConnector_ms": 0.08806514739990234}}, "episode_reward_max": -1.8000000000000012, "episode_reward_min": -48.10000000000023, "episode_reward_mean": -3.8880000000000026, "episode_len_mean": 47.2, "episodes_this_iter": 81, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-2.800000000000002, -2.2000000000000015, -3.8999999999999986, -1.8000000000000012, -2.700000000000002, -2.3000000000000016, -1.9000000000000012, -2.4000000000000017, -4.099999999999998, -3.4000000000000004, -2.900000000000002, -3.3000000000000007, -4.299999999999999, -4.399999999999998, -3.6999999999999993, -3.6000000000000014, -2.600000000000002, -3.6999999999999993, -3.1000000000000014, -2.3000000000000016, -3.5, -2.700000000000002, -4.099999999999998, -3.6999999999999993, -3.5999999999999996, -5.099999999999996, -6.499999999999998, -3.0000000000000018, -3.1000000000000014, -3.0000000000000018, -2.900000000000002, -2.4000000000000017, -3.6999999999999993, -3.4000000000000004, -3.1000000000000014, -2.900000000000002, -2.5000000000000018, -2.800000000000002, -2.4000000000000017, -3.5, -3.200000000000001, -24.999999999999975, -4.499999999999998, -2.900000000000002, -3.200000000000001, -3.6999999999999993, -2.4000000000000017, -3.999999999999999, -4.1999999999999975, -3.1000000000000014, -2.5000000000000018, -3.8, -3.8999999999999986, -2.600000000000002, -4.400000000000001, -3.200000000000001, -4.299999999999997, -3.799999999999999, -3.0000000000000018, -2.1000000000000014, -2.800000000000002, -2.3000000000000016, -4.199999999999998, -3.6999999999999993, -3.6000000000000014, -3.1000000000000014, -3.6999999999999993, -3.0000000000000018, -3.1000000000000023, -2.5000000000000018, -2.700000000000002, -3.200000000000001, -3.0000000000000018, -3.4000000000000004, -3.9999999999999982, -48.10000000000023, -2.4000000000000017, -5.399999999999993, -1.8000000000000012, -3.5, -2.800000000000002, -3.9999999999999982, -2.700000000000002, -2.3000000000000016, -3.799999999999999, -3.5, -4.9, -2.1000000000000014, -4.799999999999996, -2.900000000000002, -3.5999999999999996, -2.1000000000000014, -2.600000000000002, -2.5000000000000018, -2.0000000000000013, -2.600000000000002, -2.3000000000000016, -2.900000000000002, -3.1000000000000014, -2.700000000000002], "episode_lengths": [39, 33, 50, 29, 38, 34, 30, 35, 52, 45, 40, 44, 52, 54, 48, 43, 37, 48, 42, 34, 46, 38, 52, 48, 47, 60, 66, 41, 42, 41, 40, 35, 48, 45, 42, 40, 36, 39, 35, 46, 43, 205, 54, 40, 43, 48, 35, 50, 53, 42, 36, 48, 50, 37, 48, 43, 54, 49, 41, 32, 39, 34, 52, 48, 44, 42, 48, 41, 41, 36, 38, 43, 40, 45, 51, 325, 35, 65, 29, 46, 39, 51, 38, 34, 49, 46, 53, 32, 58, 40, 47, 32, 37, 36, 31, 37, 34, 40, 41, 38]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.28453089533049253, "mean_inference_ms": 0.7309034999324521, "mean_action_processing_ms": 0.07606414530790129, "mean_env_wait_ms": 6.607281580310887, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006711721420288086, "StateBufferConnector_ms": 0.0038471221923828125, "ViewRequirementAgentConnector_ms": 0.08806514739990234}, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 144000, "num_agent_steps_trained": 144000, "num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 435.5699094204352, "num_env_steps_trained_throughput_per_sec": 435.5699094204352, "timesteps_total": 144000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 144000, "timers": {"training_iteration_time_ms": 9288.225, "sample_time_ms": 5595.922, "load_time_ms": 1.02, "load_throughput": 3922751.526, "learn_time_ms": 3688.493, "learn_throughput": 1084.454, "synch_weights_time_ms": 2.113}, "counters": {"num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_agent_steps_sampled": 144000, "num_agent_steps_trained": 144000}, "done": false, "episodes_total": 1540, "training_iteration": 36, "trial_id": "ddfb6_00000", "date": "2024-03-07_12-53-46", "timestamp": 1709834026, "time_this_iter_s": 9.185983657836914, "time_total_s": 326.878653049469, "pid": 112355, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4d85689f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 326.878653049469, "iterations_since_restore": 36, "perf": {"cpu_util_percent": 27.34166666666667, "ram_util_percent": 51.775, "gpu_util_percent0": 0.09499999999999999, "vram_util_percent0": 0.1259765625}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.10000000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 0.3957202226721546, "policy_loss": -0.009158519324496068, "vf_loss": 0.40402735812208984, "vf_explained_var": 0.7435303955949762, "kl": 0.008513855382220634, "entropy": 0.48625130358562674, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 33945.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 148000, "num_env_steps_trained": 148000, "num_agent_steps_sampled": 148000, "num_agent_steps_trained": 148000}, "sampler_results": {"episode_reward_max": -1.700000000000001, "episode_reward_min": -25.400000000000063, "episode_reward_mean": -3.3760000000000012, "episode_len_mean": 43.72, "episode_media": {}, "episodes_this_iter": 96, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2.3000000000000016, -2.900000000000002, -3.1000000000000014, -2.700000000000002, -4.399999999999997, -3.8999999999999986, -3.6999999999999993, -3.5999999999999996, -2.900000000000002, -2.3000000000000016, -3.799999999999999, -2.1000000000000014, -3.3000000000000007, -4.699999999999996, -2.5000000000000018, -3.0000000000000018, -3.5, -3.5999999999999996, -3.3000000000000007, -2.600000000000002, -4.599999999999996, -1.700000000000001, -2.700000000000002, -2.5000000000000018, -4.099999999999998, -2.800000000000002, -2.3000000000000016, -2.1000000000000014, -2.5000000000000018, -3.200000000000001, -3.1000000000000014, -2.900000000000002, -3.0000000000000018, -4.1999999999999975, -2.600000000000002, -3.4000000000000004, -2.700000000000002, -3.1000000000000014, -3.0000000000000018, -4.1999999999999975, -3.200000000000002, -2.0000000000000013, -3.200000000000001, -5.800000000000002, -3.1000000000000014, -3.3000000000000016, -2.2000000000000015, -2.5000000000000018, -2.3000000000000016, -2.5000000000000018, -2.600000000000002, -2.800000000000002, -2.700000000000002, -7.1999999999999975, -2.900000000000002, -2.0000000000000013, -3.6999999999999993, -3.799999999999999, -2.4000000000000017, -3.3000000000000007, -3.4000000000000004, -1.9000000000000012, -3.200000000000001, -2.800000000000002, -3.3000000000000007, -3.799999999999999, -2.4000000000000017, -2.3000000000000016, -2.1000000000000014, -25.400000000000063, -3.1000000000000014, -9.599999999999985, -4.699999999999998, -3.200000000000001, -3.4000000000000004, -3.0000000000000018, -2.2000000000000015, -2.800000000000002, -3.9000000000000012, -2.600000000000002, -2.2000000000000015, -2.600000000000002, -2.800000000000002, -2.5000000000000018, -3.8999999999999986, -2.3000000000000016, -2.3000000000000016, -3.4000000000000004, -2.600000000000002, -3.6999999999999993, -2.900000000000002, -4.099999999999998, -3.1000000000000014, -2.800000000000002, -3.200000000000001, -3.5999999999999996, -3.200000000000001, -2.800000000000002, -3.3000000000000007, -2.800000000000002], "episode_lengths": [34, 40, 41, 38, 55, 50, 48, 47, 40, 34, 49, 32, 44, 58, 36, 41, 46, 47, 44, 37, 57, 28, 38, 36, 52, 39, 34, 32, 36, 43, 42, 40, 41, 53, 37, 45, 38, 42, 40, 53, 41, 31, 43, 58, 42, 41, 33, 36, 34, 36, 37, 39, 38, 71, 40, 31, 48, 49, 35, 44, 45, 30, 43, 39, 44, 49, 35, 34, 32, 211, 41, 95, 55, 43, 45, 41, 33, 39, 47, 37, 33, 37, 39, 36, 50, 34, 34, 45, 37, 48, 40, 52, 42, 39, 43, 47, 42, 39, 44, 39]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.28727944464510247, "mean_inference_ms": 0.7302335218427097, "mean_action_processing_ms": 0.07602306672337805, "mean_env_wait_ms": 6.619973623033295, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006748199462890625, "StateBufferConnector_ms": 0.003876209259033203, "ViewRequirementAgentConnector_ms": 0.08834624290466309}}, "episode_reward_max": -1.700000000000001, "episode_reward_min": -25.400000000000063, "episode_reward_mean": -3.3760000000000012, "episode_len_mean": 43.72, "episodes_this_iter": 96, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-2.3000000000000016, -2.900000000000002, -3.1000000000000014, -2.700000000000002, -4.399999999999997, -3.8999999999999986, -3.6999999999999993, -3.5999999999999996, -2.900000000000002, -2.3000000000000016, -3.799999999999999, -2.1000000000000014, -3.3000000000000007, -4.699999999999996, -2.5000000000000018, -3.0000000000000018, -3.5, -3.5999999999999996, -3.3000000000000007, -2.600000000000002, -4.599999999999996, -1.700000000000001, -2.700000000000002, -2.5000000000000018, -4.099999999999998, -2.800000000000002, -2.3000000000000016, -2.1000000000000014, -2.5000000000000018, -3.200000000000001, -3.1000000000000014, -2.900000000000002, -3.0000000000000018, -4.1999999999999975, -2.600000000000002, -3.4000000000000004, -2.700000000000002, -3.1000000000000014, -3.0000000000000018, -4.1999999999999975, -3.200000000000002, -2.0000000000000013, -3.200000000000001, -5.800000000000002, -3.1000000000000014, -3.3000000000000016, -2.2000000000000015, -2.5000000000000018, -2.3000000000000016, -2.5000000000000018, -2.600000000000002, -2.800000000000002, -2.700000000000002, -7.1999999999999975, -2.900000000000002, -2.0000000000000013, -3.6999999999999993, -3.799999999999999, -2.4000000000000017, -3.3000000000000007, -3.4000000000000004, -1.9000000000000012, -3.200000000000001, -2.800000000000002, -3.3000000000000007, -3.799999999999999, -2.4000000000000017, -2.3000000000000016, -2.1000000000000014, -25.400000000000063, -3.1000000000000014, -9.599999999999985, -4.699999999999998, -3.200000000000001, -3.4000000000000004, -3.0000000000000018, -2.2000000000000015, -2.800000000000002, -3.9000000000000012, -2.600000000000002, -2.2000000000000015, -2.600000000000002, -2.800000000000002, -2.5000000000000018, -3.8999999999999986, -2.3000000000000016, -2.3000000000000016, -3.4000000000000004, -2.600000000000002, -3.6999999999999993, -2.900000000000002, -4.099999999999998, -3.1000000000000014, -2.800000000000002, -3.200000000000001, -3.5999999999999996, -3.200000000000001, -2.800000000000002, -3.3000000000000007, -2.800000000000002], "episode_lengths": [34, 40, 41, 38, 55, 50, 48, 47, 40, 34, 49, 32, 44, 58, 36, 41, 46, 47, 44, 37, 57, 28, 38, 36, 52, 39, 34, 32, 36, 43, 42, 40, 41, 53, 37, 45, 38, 42, 40, 53, 41, 31, 43, 58, 42, 41, 33, 36, 34, 36, 37, 39, 38, 71, 40, 31, 48, 49, 35, 44, 45, 30, 43, 39, 44, 49, 35, 34, 32, 211, 41, 95, 55, 43, 45, 41, 33, 39, 47, 37, 33, 37, 39, 36, 50, 34, 34, 45, 37, 48, 40, 52, 42, 39, 43, 47, 42, 39, 44, 39]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.28727944464510247, "mean_inference_ms": 0.7302335218427097, "mean_action_processing_ms": 0.07602306672337805, "mean_env_wait_ms": 6.619973623033295, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006748199462890625, "StateBufferConnector_ms": 0.003876209259033203, "ViewRequirementAgentConnector_ms": 0.08834624290466309}, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 148000, "num_agent_steps_trained": 148000, "num_env_steps_sampled": 148000, "num_env_steps_trained": 148000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 427.27529185924095, "num_env_steps_trained_throughput_per_sec": 427.27529185924095, "timesteps_total": 148000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 148000, "timers": {"training_iteration_time_ms": 9255.165, "sample_time_ms": 5591.306, "load_time_ms": 1.017, "load_throughput": 3934895.982, "learn_time_ms": 3660.036, "learn_throughput": 1092.886, "synch_weights_time_ms": 2.138}, "counters": {"num_env_steps_sampled": 148000, "num_env_steps_trained": 148000, "num_agent_steps_sampled": 148000, "num_agent_steps_trained": 148000}, "done": false, "episodes_total": 1636, "training_iteration": 37, "trial_id": "ddfb6_00000", "date": "2024-03-07_12-53-56", "timestamp": 1709834036, "time_this_iter_s": 9.364191770553589, "time_total_s": 336.2428448200226, "pid": 112355, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4d85689f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 336.2428448200226, "iterations_since_restore": 37, "perf": {"cpu_util_percent": 26.78333333333333, "ram_util_percent": 51.79999999999999, "gpu_util_percent0": 0.09000000000000001, "vram_util_percent0": 0.12603081597222218}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.10000000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 0.8155494811799457, "policy_loss": -0.010649003859569309, "vf_loss": 0.8251785356972006, "vf_explained_var": 0.7508259052871376, "kl": 0.010199508255548984, "entropy": 0.5284324135190697, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 34875.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 152000, "num_env_steps_trained": 152000, "num_agent_steps_sampled": 152000, "num_agent_steps_trained": 152000}, "sampler_results": {"episode_reward_max": -1.5000000000000009, "episode_reward_min": -22.1, "episode_reward_mean": -3.241000000000001, "episode_len_mean": 42.64, "episode_media": {}, "episodes_this_iter": 88, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2.600000000000002, -3.6999999999999993, -2.900000000000002, -4.099999999999998, -3.1000000000000014, -2.800000000000002, -3.200000000000001, -3.5999999999999996, -3.200000000000001, -2.800000000000002, -3.3000000000000007, -2.800000000000002, -3.0000000000000018, -2.600000000000002, -2.600000000000002, -3.5, -2.800000000000002, -3.0000000000000018, -2.2000000000000015, -2.600000000000002, -2.5000000000000018, -2.3000000000000016, -3.1000000000000014, -2.1000000000000014, -3.200000000000001, -4.099999999999998, -3.5, -1.8000000000000012, -2.4000000000000017, -3.799999999999999, -3.0000000000000018, -7.4999999999999964, -2.4000000000000017, -3.0000000000000018, -3.1000000000000014, -3.5, -3.5, -2.900000000000002, -1.5000000000000009, -3.200000000000001, -3.8, -2.600000000000002, -1.9000000000000012, -4.399999999999997, -2.700000000000002, -3.5999999999999996, -2.5000000000000018, -3.5, -3.6999999999999993, -4.599999999999996, -2.5000000000000018, -2.2000000000000015, -2.3000000000000016, -1.9000000000000012, -3.8999999999999986, -2.900000000000002, -3.0000000000000018, -3.799999999999999, -2.3000000000000016, -3.799999999999999, -2.5000000000000018, -3.5, -3.1000000000000014, -3.5999999999999996, -3.1000000000000014, -2.5000000000000018, -3.3000000000000007, -2.800000000000002, -3.0000000000000018, -2.4000000000000017, -22.1, -3.200000000000001, -3.200000000000001, -2.600000000000002, -2.700000000000002, -4.099999999999998, -3.4000000000000004, -3.5999999999999996, -2.4000000000000017, -2.600000000000002, -2.800000000000002, -2.4000000000000017, -3.1000000000000014, -2.600000000000002, -4.499999999999999, -2.700000000000002, -2.5000000000000018, -3.200000000000001, -2.2000000000000015, -3.3000000000000007, -1.9000000000000012, -4.5, -3.200000000000001, -2.600000000000002, -2.3000000000000016, -2.700000000000002, -2.800000000000002, -3.6999999999999993, -3.4000000000000004, -3.3000000000000007], "episode_lengths": [37, 48, 40, 52, 42, 39, 43, 47, 42, 39, 44, 39, 41, 37, 37, 46, 39, 40, 33, 37, 36, 34, 42, 32, 43, 52, 46, 29, 35, 49, 41, 75, 35, 41, 42, 46, 46, 40, 26, 43, 48, 37, 30, 55, 38, 47, 36, 46, 48, 57, 36, 33, 32, 30, 50, 40, 41, 49, 34, 49, 36, 46, 42, 47, 42, 36, 43, 39, 41, 35, 179, 43, 43, 37, 38, 52, 45, 47, 35, 37, 39, 35, 42, 37, 53, 38, 36, 43, 33, 44, 30, 52, 43, 37, 34, 38, 39, 48, 45, 44]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.28887230188911756, "mean_inference_ms": 0.7300582837732534, "mean_action_processing_ms": 0.07597548687695356, "mean_env_wait_ms": 6.630467330187736, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0070040225982666016, "StateBufferConnector_ms": 0.003969669342041016, "ViewRequirementAgentConnector_ms": 0.08940267562866211}}, "episode_reward_max": -1.5000000000000009, "episode_reward_min": -22.1, "episode_reward_mean": -3.241000000000001, "episode_len_mean": 42.64, "episodes_this_iter": 88, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-2.600000000000002, -3.6999999999999993, -2.900000000000002, -4.099999999999998, -3.1000000000000014, -2.800000000000002, -3.200000000000001, -3.5999999999999996, -3.200000000000001, -2.800000000000002, -3.3000000000000007, -2.800000000000002, -3.0000000000000018, -2.600000000000002, -2.600000000000002, -3.5, -2.800000000000002, -3.0000000000000018, -2.2000000000000015, -2.600000000000002, -2.5000000000000018, -2.3000000000000016, -3.1000000000000014, -2.1000000000000014, -3.200000000000001, -4.099999999999998, -3.5, -1.8000000000000012, -2.4000000000000017, -3.799999999999999, -3.0000000000000018, -7.4999999999999964, -2.4000000000000017, -3.0000000000000018, -3.1000000000000014, -3.5, -3.5, -2.900000000000002, -1.5000000000000009, -3.200000000000001, -3.8, -2.600000000000002, -1.9000000000000012, -4.399999999999997, -2.700000000000002, -3.5999999999999996, -2.5000000000000018, -3.5, -3.6999999999999993, -4.599999999999996, -2.5000000000000018, -2.2000000000000015, -2.3000000000000016, -1.9000000000000012, -3.8999999999999986, -2.900000000000002, -3.0000000000000018, -3.799999999999999, -2.3000000000000016, -3.799999999999999, -2.5000000000000018, -3.5, -3.1000000000000014, -3.5999999999999996, -3.1000000000000014, -2.5000000000000018, -3.3000000000000007, -2.800000000000002, -3.0000000000000018, -2.4000000000000017, -22.1, -3.200000000000001, -3.200000000000001, -2.600000000000002, -2.700000000000002, -4.099999999999998, -3.4000000000000004, -3.5999999999999996, -2.4000000000000017, -2.600000000000002, -2.800000000000002, -2.4000000000000017, -3.1000000000000014, -2.600000000000002, -4.499999999999999, -2.700000000000002, -2.5000000000000018, -3.200000000000001, -2.2000000000000015, -3.3000000000000007, -1.9000000000000012, -4.5, -3.200000000000001, -2.600000000000002, -2.3000000000000016, -2.700000000000002, -2.800000000000002, -3.6999999999999993, -3.4000000000000004, -3.3000000000000007], "episode_lengths": [37, 48, 40, 52, 42, 39, 43, 47, 42, 39, 44, 39, 41, 37, 37, 46, 39, 40, 33, 37, 36, 34, 42, 32, 43, 52, 46, 29, 35, 49, 41, 75, 35, 41, 42, 46, 46, 40, 26, 43, 48, 37, 30, 55, 38, 47, 36, 46, 48, 57, 36, 33, 32, 30, 50, 40, 41, 49, 34, 49, 36, 46, 42, 47, 42, 36, 43, 39, 41, 35, 179, 43, 43, 37, 38, 52, 45, 47, 35, 37, 39, 35, 42, 37, 53, 38, 36, 43, 33, 44, 30, 52, 43, 37, 34, 38, 39, 48, 45, 44]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.28887230188911756, "mean_inference_ms": 0.7300582837732534, "mean_action_processing_ms": 0.07597548687695356, "mean_env_wait_ms": 6.630467330187736, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0070040225982666016, "StateBufferConnector_ms": 0.003969669342041016, "ViewRequirementAgentConnector_ms": 0.08940267562866211}, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 152000, "num_agent_steps_trained": 152000, "num_env_steps_sampled": 152000, "num_env_steps_trained": 152000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 423.323344978928, "num_env_steps_trained_throughput_per_sec": 423.323344978928, "timesteps_total": 152000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 152000, "timers": {"training_iteration_time_ms": 9254.821, "sample_time_ms": 5601.796, "load_time_ms": 1.007, "load_throughput": 3972725.249, "learn_time_ms": 3649.216, "learn_throughput": 1096.126, "synch_weights_time_ms": 2.137}, "counters": {"num_env_steps_sampled": 152000, "num_env_steps_trained": 152000, "num_agent_steps_sampled": 152000, "num_agent_steps_trained": 152000}, "done": false, "episodes_total": 1724, "training_iteration": 38, "trial_id": "ddfb6_00000", "date": "2024-03-07_12-54-05", "timestamp": 1709834045, "time_this_iter_s": 9.45139217376709, "time_total_s": 345.6942369937897, "pid": 112355, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4d85689f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 345.6942369937897, "iterations_since_restore": 38, "perf": {"cpu_util_percent": 27.47500000000001, "ram_util_percent": 51.79999999999999, "gpu_util_percent0": 0.08916666666666667, "vram_util_percent0": 0.1259765625}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.10000000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 0.1551286771603089, "policy_loss": -0.00991248359443039, "vf_loss": 0.16447925180677445, "vf_explained_var": 0.9223950370665519, "kl": 0.005619098896171258, "entropy": 0.4569277459575284, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 35805.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 156000, "num_env_steps_trained": 156000, "num_agent_steps_sampled": 156000, "num_agent_steps_trained": 156000}, "sampler_results": {"episode_reward_max": -1.700000000000001, "episode_reward_min": -33.30000000000009, "episode_reward_mean": -3.290000000000002, "episode_len_mean": 42.65, "episode_media": {}, "episodes_this_iter": 97, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.6999999999999993, -3.4000000000000004, -3.3000000000000007, -3.1000000000000014, -3.5999999999999996, -2.800000000000002, -3.5, -3.5999999999999996, -1.9000000000000012, -2.3000000000000016, -2.600000000000002, -2.5000000000000018, -3.0000000000000018, -3.3000000000000007, -3.0000000000000018, -2.800000000000002, -2.800000000000002, -2.5000000000000018, -2.700000000000002, -2.4000000000000017, -1.9000000000000012, -3.0000000000000018, -3.4000000000000004, -2.600000000000002, -2.4000000000000017, -3.0000000000000018, -1.9000000000000012, -2.1000000000000014, -2.600000000000002, -2.600000000000002, -4.299999999999997, -3.5, -3.0000000000000018, -2.2000000000000015, -2.3000000000000016, -5.099999999999999, -3.1000000000000014, -4.099999999999998, -2.700000000000002, -3.8999999999999986, -2.3000000000000016, -2.3000000000000016, -2.600000000000002, -2.1000000000000014, -2.3000000000000016, -2.800000000000002, -2.900000000000002, -3.5, -2.900000000000002, -2.900000000000002, -4.300000000000001, -3.0000000000000018, -3.8999999999999986, -3.4000000000000004, -3.0000000000000018, -1.9000000000000012, -2.600000000000002, -4.1999999999999975, -3.0000000000000018, -3.500000000000001, -4.800000000000002, -2.0000000000000013, -3.5, -2.600000000000002, -2.700000000000002, -3.4000000000000004, -5.5999999999999925, -2.700000000000002, -3.6999999999999993, -2.4000000000000017, -3.0000000000000018, -3.6000000000000005, -4.1999999999999975, -2.600000000000002, -1.700000000000001, -3.799999999999999, -2.600000000000002, -2.900000000000002, -3.4000000000000004, -2.800000000000002, -3.0000000000000018, -3.8999999999999986, -3.8999999999999986, -33.30000000000009, -3.200000000000001, -3.1000000000000014, -2.4000000000000017, -2.4000000000000017, -3.3000000000000007, -1.8000000000000012, -1.9000000000000012, -1.700000000000001, -3.3000000000000007, -3.5, -3.3000000000000007, -2.800000000000002, -2.700000000000002, -3.0000000000000018, -2.3000000000000016, -2.3000000000000016], "episode_lengths": [48, 45, 44, 42, 47, 39, 46, 47, 30, 34, 37, 36, 41, 44, 41, 39, 39, 36, 38, 35, 30, 41, 45, 37, 35, 41, 30, 32, 37, 37, 54, 46, 41, 33, 34, 55, 42, 52, 38, 50, 34, 34, 37, 32, 34, 39, 40, 46, 40, 40, 50, 41, 50, 43, 41, 30, 37, 53, 41, 45, 52, 31, 46, 37, 38, 45, 67, 38, 48, 35, 41, 45, 53, 37, 28, 49, 37, 40, 45, 39, 41, 50, 50, 243, 43, 42, 35, 35, 44, 29, 30, 28, 44, 46, 44, 38, 38, 41, 34, 34]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.29118605050522317, "mean_inference_ms": 0.7298196011481801, "mean_action_processing_ms": 0.07596531321955587, "mean_env_wait_ms": 6.645129166848261, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00679779052734375, "StateBufferConnector_ms": 0.0039348602294921875, "ViewRequirementAgentConnector_ms": 0.08837652206420898}}, "episode_reward_max": -1.700000000000001, "episode_reward_min": -33.30000000000009, "episode_reward_mean": -3.290000000000002, "episode_len_mean": 42.65, "episodes_this_iter": 97, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3.6999999999999993, -3.4000000000000004, -3.3000000000000007, -3.1000000000000014, -3.5999999999999996, -2.800000000000002, -3.5, -3.5999999999999996, -1.9000000000000012, -2.3000000000000016, -2.600000000000002, -2.5000000000000018, -3.0000000000000018, -3.3000000000000007, -3.0000000000000018, -2.800000000000002, -2.800000000000002, -2.5000000000000018, -2.700000000000002, -2.4000000000000017, -1.9000000000000012, -3.0000000000000018, -3.4000000000000004, -2.600000000000002, -2.4000000000000017, -3.0000000000000018, -1.9000000000000012, -2.1000000000000014, -2.600000000000002, -2.600000000000002, -4.299999999999997, -3.5, -3.0000000000000018, -2.2000000000000015, -2.3000000000000016, -5.099999999999999, -3.1000000000000014, -4.099999999999998, -2.700000000000002, -3.8999999999999986, -2.3000000000000016, -2.3000000000000016, -2.600000000000002, -2.1000000000000014, -2.3000000000000016, -2.800000000000002, -2.900000000000002, -3.5, -2.900000000000002, -2.900000000000002, -4.300000000000001, -3.0000000000000018, -3.8999999999999986, -3.4000000000000004, -3.0000000000000018, -1.9000000000000012, -2.600000000000002, -4.1999999999999975, -3.0000000000000018, -3.500000000000001, -4.800000000000002, -2.0000000000000013, -3.5, -2.600000000000002, -2.700000000000002, -3.4000000000000004, -5.5999999999999925, -2.700000000000002, -3.6999999999999993, -2.4000000000000017, -3.0000000000000018, -3.6000000000000005, -4.1999999999999975, -2.600000000000002, -1.700000000000001, -3.799999999999999, -2.600000000000002, -2.900000000000002, -3.4000000000000004, -2.800000000000002, -3.0000000000000018, -3.8999999999999986, -3.8999999999999986, -33.30000000000009, -3.200000000000001, -3.1000000000000014, -2.4000000000000017, -2.4000000000000017, -3.3000000000000007, -1.8000000000000012, -1.9000000000000012, -1.700000000000001, -3.3000000000000007, -3.5, -3.3000000000000007, -2.800000000000002, -2.700000000000002, -3.0000000000000018, -2.3000000000000016, -2.3000000000000016], "episode_lengths": [48, 45, 44, 42, 47, 39, 46, 47, 30, 34, 37, 36, 41, 44, 41, 39, 39, 36, 38, 35, 30, 41, 45, 37, 35, 41, 30, 32, 37, 37, 54, 46, 41, 33, 34, 55, 42, 52, 38, 50, 34, 34, 37, 32, 34, 39, 40, 46, 40, 40, 50, 41, 50, 43, 41, 30, 37, 53, 41, 45, 52, 31, 46, 37, 38, 45, 67, 38, 48, 35, 41, 45, 53, 37, 28, 49, 37, 40, 45, 39, 41, 50, 50, 243, 43, 42, 35, 35, 44, 29, 30, 28, 44, 46, 44, 38, 38, 41, 34, 34]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.29118605050522317, "mean_inference_ms": 0.7298196011481801, "mean_action_processing_ms": 0.07596531321955587, "mean_env_wait_ms": 6.645129166848261, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00679779052734375, "StateBufferConnector_ms": 0.0039348602294921875, "ViewRequirementAgentConnector_ms": 0.08837652206420898}, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 156000, "num_agent_steps_trained": 156000, "num_env_steps_sampled": 156000, "num_env_steps_trained": 156000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 435.06457606009224, "num_env_steps_trained_throughput_per_sec": 435.06457606009224, "timesteps_total": 156000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 156000, "timers": {"training_iteration_time_ms": 9249.232, "sample_time_ms": 5604.657, "load_time_ms": 0.992, "load_throughput": 4032984.615, "learn_time_ms": 3640.776, "learn_throughput": 1098.667, "synch_weights_time_ms": 2.153}, "counters": {"num_env_steps_sampled": 156000, "num_env_steps_trained": 156000, "num_agent_steps_sampled": 156000, "num_agent_steps_trained": 156000}, "done": false, "episodes_total": 1821, "training_iteration": 39, "trial_id": "ddfb6_00000", "date": "2024-03-07_12-54-14", "timestamp": 1709834054, "time_this_iter_s": 9.196571350097656, "time_total_s": 354.89080834388733, "pid": 112355, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4d85689f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 354.89080834388733, "iterations_since_restore": 39, "perf": {"cpu_util_percent": 26.850000000000005, "ram_util_percent": 51.87499999999999, "gpu_util_percent0": 0.09416666666666666, "vram_util_percent0": 0.12697347005208334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.10000000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 0.11906344999136123, "policy_loss": -0.014897842993659358, "vf_loss": 0.13318509725373118, "vf_explained_var": 0.9387682719256288, "kl": 0.007761959386721978, "entropy": 0.42754394139653895, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 36735.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 160000, "num_env_steps_trained": 160000, "num_agent_steps_sampled": 160000, "num_agent_steps_trained": 160000}, "sampler_results": {"episode_reward_max": -1.5000000000000009, "episode_reward_min": -6.99999999999999, "episode_reward_mean": -3.0170000000000017, "episode_len_mean": 40.91, "episode_media": {}, "episodes_this_iter": 100, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-6.99999999999999, -3.3000000000000007, -2.600000000000002, -2.2000000000000015, -3.3000000000000007, -3.9999999999999982, -2.5000000000000018, -2.600000000000002, -3.4000000000000004, -1.8000000000000012, -2.700000000000002, -3.5, -3.0000000000000018, -3.0000000000000018, -3.1000000000000014, -2.3000000000000016, -3.200000000000001, -3.6000000000000005, -3.200000000000001, -1.9000000000000012, -2.800000000000002, -2.5000000000000018, -4.299999999999997, -3.6999999999999993, -2.5000000000000018, -2.0000000000000013, -3.6999999999999993, -3.0000000000000018, -2.900000000000002, -2.800000000000002, -2.900000000000002, -3.4000000000000004, -2.5000000000000018, -3.1000000000000014, -2.4000000000000017, -4.099999999999998, -2.4000000000000017, -2.0000000000000013, -1.9000000000000012, -2.800000000000002, -2.900000000000002, -3.1000000000000014, -3.5, -2.4000000000000017, -1.8000000000000012, -4.099999999999998, -3.3000000000000007, -2.900000000000002, -3.799999999999999, -3.0000000000000018, -2.600000000000002, -3.4000000000000004, -2.800000000000002, -3.200000000000001, -3.3000000000000007, -3.8999999999999986, -2.5000000000000018, -2.800000000000002, -3.799999999999999, -2.0000000000000013, -1.600000000000001, -2.700000000000002, -2.4000000000000017, -2.5000000000000018, -6.000000000000004, -3.3000000000000007, -3.5, -3.200000000000001, -3.8999999999999986, -2.800000000000002, -1.600000000000001, -2.4000000000000017, -2.1000000000000014, -2.4000000000000017, -2.700000000000002, -1.8000000000000012, -3.6999999999999993, -3.1000000000000014, -3.5999999999999996, -1.5000000000000009, -4.4999999999999964, -4.099999999999998, -3.1000000000000014, -2.5000000000000018, -3.5, -3.0000000000000018, -3.4000000000000004, -3.5, -3.3000000000000007, -2.700000000000002, -3.0000000000000018, -2.700000000000002, -3.200000000000001, -3.5999999999999996, -2.3000000000000016, -2.2000000000000015, -3.1000000000000014, -3.5999999999999996, -2.800000000000002, -3.8000000000000007], "episode_lengths": [78, 44, 37, 33, 44, 51, 36, 37, 45, 29, 38, 46, 41, 41, 41, 34, 41, 46, 43, 30, 39, 36, 54, 48, 36, 31, 48, 41, 40, 39, 40, 45, 36, 42, 35, 52, 35, 31, 30, 39, 40, 42, 46, 35, 29, 52, 44, 40, 49, 41, 37, 45, 39, 43, 44, 50, 36, 39, 49, 31, 27, 38, 35, 36, 55, 44, 46, 43, 50, 39, 27, 35, 32, 35, 38, 29, 48, 42, 47, 26, 56, 52, 42, 36, 46, 41, 45, 46, 44, 38, 41, 38, 43, 47, 34, 33, 42, 47, 38, 47]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.29342619878020604, "mean_inference_ms": 0.7294415774835159, "mean_action_processing_ms": 0.07594777101456186, "mean_env_wait_ms": 6.657037115968414, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006900787353515625, "StateBufferConnector_ms": 0.0039081573486328125, "ViewRequirementAgentConnector_ms": 0.08794879913330078}}, "episode_reward_max": -1.5000000000000009, "episode_reward_min": -6.99999999999999, "episode_reward_mean": -3.0170000000000017, "episode_len_mean": 40.91, "episodes_this_iter": 100, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-6.99999999999999, -3.3000000000000007, -2.600000000000002, -2.2000000000000015, -3.3000000000000007, -3.9999999999999982, -2.5000000000000018, -2.600000000000002, -3.4000000000000004, -1.8000000000000012, -2.700000000000002, -3.5, -3.0000000000000018, -3.0000000000000018, -3.1000000000000014, -2.3000000000000016, -3.200000000000001, -3.6000000000000005, -3.200000000000001, -1.9000000000000012, -2.800000000000002, -2.5000000000000018, -4.299999999999997, -3.6999999999999993, -2.5000000000000018, -2.0000000000000013, -3.6999999999999993, -3.0000000000000018, -2.900000000000002, -2.800000000000002, -2.900000000000002, -3.4000000000000004, -2.5000000000000018, -3.1000000000000014, -2.4000000000000017, -4.099999999999998, -2.4000000000000017, -2.0000000000000013, -1.9000000000000012, -2.800000000000002, -2.900000000000002, -3.1000000000000014, -3.5, -2.4000000000000017, -1.8000000000000012, -4.099999999999998, -3.3000000000000007, -2.900000000000002, -3.799999999999999, -3.0000000000000018, -2.600000000000002, -3.4000000000000004, -2.800000000000002, -3.200000000000001, -3.3000000000000007, -3.8999999999999986, -2.5000000000000018, -2.800000000000002, -3.799999999999999, -2.0000000000000013, -1.600000000000001, -2.700000000000002, -2.4000000000000017, -2.5000000000000018, -6.000000000000004, -3.3000000000000007, -3.5, -3.200000000000001, -3.8999999999999986, -2.800000000000002, -1.600000000000001, -2.4000000000000017, -2.1000000000000014, -2.4000000000000017, -2.700000000000002, -1.8000000000000012, -3.6999999999999993, -3.1000000000000014, -3.5999999999999996, -1.5000000000000009, -4.4999999999999964, -4.099999999999998, -3.1000000000000014, -2.5000000000000018, -3.5, -3.0000000000000018, -3.4000000000000004, -3.5, -3.3000000000000007, -2.700000000000002, -3.0000000000000018, -2.700000000000002, -3.200000000000001, -3.5999999999999996, -2.3000000000000016, -2.2000000000000015, -3.1000000000000014, -3.5999999999999996, -2.800000000000002, -3.8000000000000007], "episode_lengths": [78, 44, 37, 33, 44, 51, 36, 37, 45, 29, 38, 46, 41, 41, 41, 34, 41, 46, 43, 30, 39, 36, 54, 48, 36, 31, 48, 41, 40, 39, 40, 45, 36, 42, 35, 52, 35, 31, 30, 39, 40, 42, 46, 35, 29, 52, 44, 40, 49, 41, 37, 45, 39, 43, 44, 50, 36, 39, 49, 31, 27, 38, 35, 36, 55, 44, 46, 43, 50, 39, 27, 35, 32, 35, 38, 29, 48, 42, 47, 26, 56, 52, 42, 36, 46, 41, 45, 46, 44, 38, 41, 38, 43, 47, 34, 33, 42, 47, 38, 47]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.29342619878020604, "mean_inference_ms": 0.7294415774835159, "mean_action_processing_ms": 0.07594777101456186, "mean_env_wait_ms": 6.657037115968414, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006900787353515625, "StateBufferConnector_ms": 0.0039081573486328125, "ViewRequirementAgentConnector_ms": 0.08794879913330078}, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 160000, "num_agent_steps_trained": 160000, "num_env_steps_sampled": 160000, "num_env_steps_trained": 160000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 428.2340571587729, "num_env_steps_trained_throughput_per_sec": 428.2340571587729, "timesteps_total": 160000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 160000, "timers": {"training_iteration_time_ms": 9273.251, "sample_time_ms": 5631.033, "load_time_ms": 0.998, "load_throughput": 4009850.86, "learn_time_ms": 3638.395, "learn_throughput": 1099.386, "synch_weights_time_ms": 2.167}, "counters": {"num_env_steps_sampled": 160000, "num_env_steps_trained": 160000, "num_agent_steps_sampled": 160000, "num_agent_steps_trained": 160000}, "done": false, "episodes_total": 1921, "training_iteration": 40, "trial_id": "ddfb6_00000", "date": "2024-03-07_12-54-24", "timestamp": 1709834064, "time_this_iter_s": 9.343118906021118, "time_total_s": 364.23392724990845, "pid": 112355, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4d85689f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 364.23392724990845, "iterations_since_restore": 40, "perf": {"cpu_util_percent": 26.95, "ram_util_percent": 51.9, "gpu_util_percent0": 0.085, "vram_util_percent0": 0.12623426649305558}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.10000000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 1.2376519580321608, "policy_loss": -0.005382985549588357, "vf_loss": 1.2423613615854774, "vf_explained_var": 0.6436869021384947, "kl": 0.006735819780942043, "entropy": 0.4662277973787759, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 37665.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 164000, "num_env_steps_trained": 164000, "num_agent_steps_sampled": 164000, "num_agent_steps_trained": 164000}, "sampler_results": {"episode_reward_max": -1.600000000000001, "episode_reward_min": -46.90000000000018, "episode_reward_mean": -3.276000000000002, "episode_len_mean": 42.25, "episode_media": {}, "episodes_this_iter": 89, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2.700000000000002, -3.0000000000000018, -2.700000000000002, -3.200000000000001, -3.5999999999999996, -2.3000000000000016, -2.2000000000000015, -3.1000000000000014, -3.5999999999999996, -2.800000000000002, -3.8000000000000007, -3.4000000000000004, -1.9000000000000012, -3.3000000000000007, -2.800000000000002, -2.600000000000002, -3.200000000000001, -2.700000000000002, -3.8999999999999986, -2.600000000000002, -2.3000000000000016, -2.2000000000000015, -1.9000000000000012, -3.0000000000000018, -1.9000000000000012, -3.4000000000000004, -2.4000000000000017, -1.8000000000000012, -1.8000000000000012, -3.200000000000001, -3.1000000000000014, -3.9999999999999982, -2.0000000000000013, -2.5000000000000018, -3.0000000000000018, -1.8000000000000012, -3.3000000000000007, -2.800000000000002, -3.0000000000000018, -2.5000000000000018, -2.600000000000002, -3.4000000000000004, -3.200000000000001, -2.900000000000002, -2.2000000000000015, -2.900000000000002, -2.0000000000000013, -2.4000000000000017, -3.1000000000000014, -2.800000000000002, -2.800000000000002, -2.3000000000000016, -3.5999999999999996, -2.3000000000000016, -2.800000000000002, -2.600000000000002, -1.700000000000001, -2.2000000000000015, -2.2000000000000015, -2.600000000000002, -1.600000000000001, -2.700000000000002, -2.700000000000002, -46.90000000000018, -2.900000000000002, -3.1000000000000014, -3.0000000000000018, -2.800000000000002, -2.0000000000000013, -3.4000000000000004, -3.1000000000000014, -1.9000000000000012, -2.600000000000002, -12.099999999999977, -2.700000000000002, -2.3000000000000016, -2.900000000000002, -2.900000000000002, -1.9000000000000012, -2.1000000000000014, -4.399999999999997, -2.600000000000002, -3.0000000000000018, -3.5999999999999996, -4.299999999999997, -2.800000000000002, -2.2000000000000015, -3.6999999999999993, -3.1000000000000014, -3.8999999999999986, -1.8000000000000012, -3.0000000000000018, -2.5000000000000018, -2.0000000000000013, -2.2000000000000015, -2.0000000000000013, -2.0000000000000013, -2.4000000000000017, -3.4000000000000004, -3.200000000000001], "episode_lengths": [38, 41, 38, 43, 47, 34, 33, 42, 47, 38, 47, 45, 30, 44, 39, 37, 43, 38, 50, 37, 34, 33, 30, 41, 30, 45, 35, 29, 29, 43, 42, 51, 31, 36, 41, 29, 44, 39, 41, 36, 37, 45, 43, 40, 33, 40, 31, 35, 42, 39, 39, 34, 47, 34, 39, 37, 28, 33, 33, 37, 27, 38, 38, 355, 40, 42, 41, 39, 31, 45, 42, 30, 37, 110, 38, 34, 40, 40, 30, 32, 55, 37, 41, 47, 54, 39, 33, 48, 41, 50, 29, 41, 36, 31, 33, 31, 31, 35, 45, 43]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2945252972708783, "mean_inference_ms": 0.7291585336296231, "mean_action_processing_ms": 0.075873018663566, "mean_env_wait_ms": 6.665370110630991, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006742000579833984, "StateBufferConnector_ms": 0.003885984420776367, "ViewRequirementAgentConnector_ms": 0.08828020095825195}}, "episode_reward_max": -1.600000000000001, "episode_reward_min": -46.90000000000018, "episode_reward_mean": -3.276000000000002, "episode_len_mean": 42.25, "episodes_this_iter": 89, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-2.700000000000002, -3.0000000000000018, -2.700000000000002, -3.200000000000001, -3.5999999999999996, -2.3000000000000016, -2.2000000000000015, -3.1000000000000014, -3.5999999999999996, -2.800000000000002, -3.8000000000000007, -3.4000000000000004, -1.9000000000000012, -3.3000000000000007, -2.800000000000002, -2.600000000000002, -3.200000000000001, -2.700000000000002, -3.8999999999999986, -2.600000000000002, -2.3000000000000016, -2.2000000000000015, -1.9000000000000012, -3.0000000000000018, -1.9000000000000012, -3.4000000000000004, -2.4000000000000017, -1.8000000000000012, -1.8000000000000012, -3.200000000000001, -3.1000000000000014, -3.9999999999999982, -2.0000000000000013, -2.5000000000000018, -3.0000000000000018, -1.8000000000000012, -3.3000000000000007, -2.800000000000002, -3.0000000000000018, -2.5000000000000018, -2.600000000000002, -3.4000000000000004, -3.200000000000001, -2.900000000000002, -2.2000000000000015, -2.900000000000002, -2.0000000000000013, -2.4000000000000017, -3.1000000000000014, -2.800000000000002, -2.800000000000002, -2.3000000000000016, -3.5999999999999996, -2.3000000000000016, -2.800000000000002, -2.600000000000002, -1.700000000000001, -2.2000000000000015, -2.2000000000000015, -2.600000000000002, -1.600000000000001, -2.700000000000002, -2.700000000000002, -46.90000000000018, -2.900000000000002, -3.1000000000000014, -3.0000000000000018, -2.800000000000002, -2.0000000000000013, -3.4000000000000004, -3.1000000000000014, -1.9000000000000012, -2.600000000000002, -12.099999999999977, -2.700000000000002, -2.3000000000000016, -2.900000000000002, -2.900000000000002, -1.9000000000000012, -2.1000000000000014, -4.399999999999997, -2.600000000000002, -3.0000000000000018, -3.5999999999999996, -4.299999999999997, -2.800000000000002, -2.2000000000000015, -3.6999999999999993, -3.1000000000000014, -3.8999999999999986, -1.8000000000000012, -3.0000000000000018, -2.5000000000000018, -2.0000000000000013, -2.2000000000000015, -2.0000000000000013, -2.0000000000000013, -2.4000000000000017, -3.4000000000000004, -3.200000000000001], "episode_lengths": [38, 41, 38, 43, 47, 34, 33, 42, 47, 38, 47, 45, 30, 44, 39, 37, 43, 38, 50, 37, 34, 33, 30, 41, 30, 45, 35, 29, 29, 43, 42, 51, 31, 36, 41, 29, 44, 39, 41, 36, 37, 45, 43, 40, 33, 40, 31, 35, 42, 39, 39, 34, 47, 34, 39, 37, 28, 33, 33, 37, 27, 38, 38, 355, 40, 42, 41, 39, 31, 45, 42, 30, 37, 110, 38, 34, 40, 40, 30, 32, 55, 37, 41, 47, 54, 39, 33, 48, 41, 50, 29, 41, 36, 31, 33, 31, 31, 35, 45, 43]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2945252972708783, "mean_inference_ms": 0.7291585336296231, "mean_action_processing_ms": 0.075873018663566, "mean_env_wait_ms": 6.665370110630991, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006742000579833984, "StateBufferConnector_ms": 0.003885984420776367, "ViewRequirementAgentConnector_ms": 0.08828020095825195}, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 164000, "num_agent_steps_trained": 164000, "num_env_steps_sampled": 164000, "num_env_steps_trained": 164000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 427.95174301044324, "num_env_steps_trained_throughput_per_sec": 427.95174301044324, "timesteps_total": 164000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 164000, "timers": {"training_iteration_time_ms": 9282.256, "sample_time_ms": 5637.1, "load_time_ms": 0.995, "load_throughput": 4020806.212, "learn_time_ms": 3641.314, "learn_throughput": 1098.505, "synch_weights_time_ms": 2.193}, "counters": {"num_env_steps_sampled": 164000, "num_env_steps_trained": 164000, "num_agent_steps_sampled": 164000, "num_agent_steps_trained": 164000}, "done": false, "episodes_total": 2010, "training_iteration": 41, "trial_id": "ddfb6_00000", "date": "2024-03-07_12-54-33", "timestamp": 1709834073, "time_this_iter_s": 9.349673509597778, "time_total_s": 373.5836007595062, "pid": 112355, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4d85689f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 373.5836007595062, "iterations_since_restore": 41, "perf": {"cpu_util_percent": 26.691666666666666, "ram_util_percent": 51.9, "gpu_util_percent0": 0.09833333333333333, "vram_util_percent0": 0.12613932291666669}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.10000000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 2.1975390319847654, "policy_loss": -0.0041617517069142355, "vf_loss": 2.200925144205691, "vf_explained_var": 0.38087591503256113, "kl": 0.007756325551594677, "entropy": 0.5057482853051155, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 38595.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 168000, "num_env_steps_trained": 168000, "num_agent_steps_sampled": 168000, "num_agent_steps_trained": 168000}, "sampler_results": {"episode_reward_max": -1.700000000000001, "episode_reward_min": -73.5000000000005, "episode_reward_mean": -4.38200000000001, "episode_len_mean": 47.82, "episode_media": {}, "episodes_this_iter": 76, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2.900000000000002, -2.900000000000002, -1.9000000000000012, -2.1000000000000014, -4.399999999999997, -2.600000000000002, -3.0000000000000018, -3.5999999999999996, -4.299999999999997, -2.800000000000002, -2.2000000000000015, -3.6999999999999993, -3.1000000000000014, -3.8999999999999986, -1.8000000000000012, -3.0000000000000018, -2.5000000000000018, -2.0000000000000013, -2.2000000000000015, -2.0000000000000013, -2.0000000000000013, -2.4000000000000017, -3.4000000000000004, -3.200000000000001, -2.700000000000002, -2.4000000000000017, -3.0000000000000018, -22.600000000000026, -3.200000000000002, -2.4000000000000017, -2.900000000000002, -2.600000000000002, -2.4000000000000017, -2.4000000000000017, -2.1000000000000014, -2.5000000000000018, -2.2000000000000015, -3.3000000000000007, -69.20000000000049, -1.700000000000001, -2.3000000000000016, -2.0000000000000013, -2.5000000000000018, -2.700000000000002, -2.900000000000002, -2.600000000000002, -3.1000000000000014, -3.200000000000001, -2.600000000000002, -2.4000000000000017, -6.499999999999995, -2.1000000000000014, -3.3000000000000007, -2.800000000000002, -2.0000000000000013, -2.700000000000002, -3.5, -2.600000000000002, -2.2000000000000015, -2.0000000000000013, -2.0000000000000013, -2.600000000000002, -2.800000000000002, -2.700000000000002, -2.700000000000002, -73.5000000000005, -2.700000000000002, -2.800000000000002, -2.900000000000002, -3.3000000000000007, -6.099999999999998, -2.900000000000002, -3.0000000000000018, -2.800000000000002, -3.1000000000000014, -3.5, -2.1000000000000014, -3.200000000000001, -2.800000000000002, -3.1000000000000014, -2.5000000000000018, -3.0000000000000018, -2.1000000000000014, -1.9000000000000012, -3.0000000000000018, -2.700000000000002, -1.8000000000000012, -3.9000000000000004, -2.700000000000002, -2.5000000000000018, -3.4000000000000004, -3.9999999999999982, -3.6999999999999993, -3.0000000000000018, -3.1000000000000014, -2.600000000000002, -3.4000000000000004, -1.8000000000000012, -2.800000000000002, -2.2000000000000015], "episode_lengths": [40, 40, 30, 32, 55, 37, 41, 47, 54, 39, 33, 48, 41, 50, 29, 41, 36, 31, 33, 31, 31, 35, 45, 43, 38, 35, 41, 208, 42, 35, 40, 37, 35, 35, 32, 36, 33, 44, 400, 28, 34, 31, 36, 38, 38, 37, 42, 43, 37, 35, 70, 32, 44, 39, 31, 38, 46, 37, 33, 31, 31, 37, 39, 38, 38, 400, 38, 39, 40, 44, 64, 40, 41, 39, 42, 46, 32, 43, 39, 42, 36, 41, 32, 30, 39, 38, 29, 48, 38, 36, 45, 51, 48, 41, 42, 37, 45, 29, 39, 33]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2953340879480624, "mean_inference_ms": 0.7290451065240109, "mean_action_processing_ms": 0.07580540729495246, "mean_env_wait_ms": 6.675804856190379, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0069048404693603516, "StateBufferConnector_ms": 0.0040395259857177734, "ViewRequirementAgentConnector_ms": 0.08902359008789062}}, "episode_reward_max": -1.700000000000001, "episode_reward_min": -73.5000000000005, "episode_reward_mean": -4.38200000000001, "episode_len_mean": 47.82, "episodes_this_iter": 76, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-2.900000000000002, -2.900000000000002, -1.9000000000000012, -2.1000000000000014, -4.399999999999997, -2.600000000000002, -3.0000000000000018, -3.5999999999999996, -4.299999999999997, -2.800000000000002, -2.2000000000000015, -3.6999999999999993, -3.1000000000000014, -3.8999999999999986, -1.8000000000000012, -3.0000000000000018, -2.5000000000000018, -2.0000000000000013, -2.2000000000000015, -2.0000000000000013, -2.0000000000000013, -2.4000000000000017, -3.4000000000000004, -3.200000000000001, -2.700000000000002, -2.4000000000000017, -3.0000000000000018, -22.600000000000026, -3.200000000000002, -2.4000000000000017, -2.900000000000002, -2.600000000000002, -2.4000000000000017, -2.4000000000000017, -2.1000000000000014, -2.5000000000000018, -2.2000000000000015, -3.3000000000000007, -69.20000000000049, -1.700000000000001, -2.3000000000000016, -2.0000000000000013, -2.5000000000000018, -2.700000000000002, -2.900000000000002, -2.600000000000002, -3.1000000000000014, -3.200000000000001, -2.600000000000002, -2.4000000000000017, -6.499999999999995, -2.1000000000000014, -3.3000000000000007, -2.800000000000002, -2.0000000000000013, -2.700000000000002, -3.5, -2.600000000000002, -2.2000000000000015, -2.0000000000000013, -2.0000000000000013, -2.600000000000002, -2.800000000000002, -2.700000000000002, -2.700000000000002, -73.5000000000005, -2.700000000000002, -2.800000000000002, -2.900000000000002, -3.3000000000000007, -6.099999999999998, -2.900000000000002, -3.0000000000000018, -2.800000000000002, -3.1000000000000014, -3.5, -2.1000000000000014, -3.200000000000001, -2.800000000000002, -3.1000000000000014, -2.5000000000000018, -3.0000000000000018, -2.1000000000000014, -1.9000000000000012, -3.0000000000000018, -2.700000000000002, -1.8000000000000012, -3.9000000000000004, -2.700000000000002, -2.5000000000000018, -3.4000000000000004, -3.9999999999999982, -3.6999999999999993, -3.0000000000000018, -3.1000000000000014, -2.600000000000002, -3.4000000000000004, -1.8000000000000012, -2.800000000000002, -2.2000000000000015], "episode_lengths": [40, 40, 30, 32, 55, 37, 41, 47, 54, 39, 33, 48, 41, 50, 29, 41, 36, 31, 33, 31, 31, 35, 45, 43, 38, 35, 41, 208, 42, 35, 40, 37, 35, 35, 32, 36, 33, 44, 400, 28, 34, 31, 36, 38, 38, 37, 42, 43, 37, 35, 70, 32, 44, 39, 31, 38, 46, 37, 33, 31, 31, 37, 39, 38, 38, 400, 38, 39, 40, 44, 64, 40, 41, 39, 42, 46, 32, 43, 39, 42, 36, 41, 32, 30, 39, 38, 29, 48, 38, 36, 45, 51, 48, 41, 42, 37, 45, 29, 39, 33]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2953340879480624, "mean_inference_ms": 0.7290451065240109, "mean_action_processing_ms": 0.07580540729495246, "mean_env_wait_ms": 6.675804856190379, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0069048404693603516, "StateBufferConnector_ms": 0.0040395259857177734, "ViewRequirementAgentConnector_ms": 0.08902359008789062}, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 168000, "num_agent_steps_trained": 168000, "num_env_steps_sampled": 168000, "num_env_steps_trained": 168000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 418.9017773745866, "num_env_steps_trained_throughput_per_sec": 418.9017773745866, "timesteps_total": 168000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 168000, "timers": {"training_iteration_time_ms": 9332.134, "sample_time_ms": 5687.716, "load_time_ms": 1.001, "load_throughput": 3994575.238, "learn_time_ms": 3640.533, "learn_throughput": 1098.74, "synch_weights_time_ms": 2.229}, "counters": {"num_env_steps_sampled": 168000, "num_env_steps_trained": 168000, "num_agent_steps_sampled": 168000, "num_agent_steps_trained": 168000}, "done": false, "episodes_total": 2086, "training_iteration": 42, "trial_id": "ddfb6_00000", "date": "2024-03-07_12-54-42", "timestamp": 1709834082, "time_this_iter_s": 9.551265716552734, "time_total_s": 383.13486647605896, "pid": 112355, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4d85689f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 383.13486647605896, "iterations_since_restore": 42, "perf": {"cpu_util_percent": 28.616666666666664, "ram_util_percent": 51.98333333333333, "gpu_util_percent0": 0.08750000000000001, "vram_util_percent0": 0.12424045138888891}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.10000000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 0.7739632672357989, "policy_loss": -0.005314739078523651, "vf_loss": 0.7786290734485593, "vf_explained_var": 0.755513047659269, "kl": 0.006489351585437351, "entropy": 0.4424690915051327, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 39525.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 172000, "num_env_steps_trained": 172000, "num_agent_steps_sampled": 172000, "num_agent_steps_trained": 172000}, "sampler_results": {"episode_reward_max": -1.600000000000001, "episode_reward_min": -72.70000000000054, "episode_reward_mean": -3.9750000000000107, "episode_len_mean": 44.64, "episode_media": {}, "episodes_this_iter": 94, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.1000000000000014, -2.600000000000002, -3.4000000000000004, -1.8000000000000012, -2.800000000000002, -2.2000000000000015, -2.600000000000002, -2.2000000000000015, -2.600000000000002, -2.3000000000000016, -2.1000000000000014, -2.600000000000002, -2.900000000000002, -2.4000000000000017, -2.3000000000000016, -2.800000000000002, -2.600000000000002, -2.600000000000002, -2.800000000000002, -2.900000000000002, -2.800000000000002, -2.900000000000002, -3.200000000000001, -1.9000000000000012, -2.1000000000000014, -2.900000000000002, -2.600000000000002, -1.8000000000000012, -2.700000000000002, -3.4000000000000004, -1.8000000000000012, -2.2000000000000015, -2.0000000000000013, -2.800000000000002, -2.2000000000000015, -2.3000000000000016, -3.0000000000000018, -2.900000000000002, -2.600000000000002, -2.5000000000000018, -2.700000000000002, -3.200000000000001, -72.70000000000054, -1.600000000000001, -3.1000000000000014, -2.3000000000000016, -2.3000000000000016, -1.8000000000000012, -2.1000000000000014, -3.1000000000000014, -3.200000000000001, -2.5000000000000018, -2.600000000000002, -2.1000000000000014, -3.200000000000001, -2.0000000000000013, -2.4000000000000017, -3.5, -2.800000000000002, -2.600000000000002, -3.4000000000000004, -3.6999999999999993, -3.0000000000000018, -3.5, -2.5000000000000018, -2.4000000000000017, -2.800000000000002, -3.1000000000000014, -2.4000000000000017, -3.4000000000000004, -2.2000000000000015, -3.200000000000001, -2.4000000000000017, -2.2000000000000015, -3.0000000000000018, -3.8999999999999986, -2.700000000000002, -1.700000000000001, -2.900000000000002, -2.4000000000000017, -2.600000000000002, -2.3000000000000016, -2.3000000000000016, -2.3000000000000016, -3.3000000000000007, -2.3000000000000016, -2.900000000000002, -2.5000000000000018, -2.600000000000002, -2.5000000000000018, -3.1000000000000014, -2.4000000000000017, -65.20000000000043, -3.1000000000000023, -2.700000000000002, -3.200000000000001, -3.3000000000000007, -2.900000000000002, -3.3000000000000007, -1.9000000000000012], "episode_lengths": [42, 37, 45, 29, 39, 33, 37, 33, 37, 34, 32, 37, 40, 35, 33, 39, 37, 37, 39, 40, 39, 40, 43, 30, 32, 40, 37, 29, 38, 45, 29, 33, 31, 39, 33, 34, 41, 40, 37, 36, 38, 43, 400, 27, 42, 34, 34, 29, 32, 42, 43, 36, 37, 32, 43, 31, 35, 46, 39, 37, 45, 48, 41, 46, 36, 35, 39, 42, 35, 45, 33, 43, 35, 33, 41, 50, 38, 28, 40, 31, 37, 34, 34, 34, 44, 34, 40, 36, 37, 36, 42, 35, 400, 40, 38, 43, 41, 40, 44, 30]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2977555429022643, "mean_inference_ms": 0.7292010125547042, "mean_action_processing_ms": 0.07589323778357279, "mean_env_wait_ms": 6.69096912522416, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007016181945800781, "StateBufferConnector_ms": 0.004008293151855469, "ViewRequirementAgentConnector_ms": 0.0900719165802002}}, "episode_reward_max": -1.600000000000001, "episode_reward_min": -72.70000000000054, "episode_reward_mean": -3.9750000000000107, "episode_len_mean": 44.64, "episodes_this_iter": 94, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3.1000000000000014, -2.600000000000002, -3.4000000000000004, -1.8000000000000012, -2.800000000000002, -2.2000000000000015, -2.600000000000002, -2.2000000000000015, -2.600000000000002, -2.3000000000000016, -2.1000000000000014, -2.600000000000002, -2.900000000000002, -2.4000000000000017, -2.3000000000000016, -2.800000000000002, -2.600000000000002, -2.600000000000002, -2.800000000000002, -2.900000000000002, -2.800000000000002, -2.900000000000002, -3.200000000000001, -1.9000000000000012, -2.1000000000000014, -2.900000000000002, -2.600000000000002, -1.8000000000000012, -2.700000000000002, -3.4000000000000004, -1.8000000000000012, -2.2000000000000015, -2.0000000000000013, -2.800000000000002, -2.2000000000000015, -2.3000000000000016, -3.0000000000000018, -2.900000000000002, -2.600000000000002, -2.5000000000000018, -2.700000000000002, -3.200000000000001, -72.70000000000054, -1.600000000000001, -3.1000000000000014, -2.3000000000000016, -2.3000000000000016, -1.8000000000000012, -2.1000000000000014, -3.1000000000000014, -3.200000000000001, -2.5000000000000018, -2.600000000000002, -2.1000000000000014, -3.200000000000001, -2.0000000000000013, -2.4000000000000017, -3.5, -2.800000000000002, -2.600000000000002, -3.4000000000000004, -3.6999999999999993, -3.0000000000000018, -3.5, -2.5000000000000018, -2.4000000000000017, -2.800000000000002, -3.1000000000000014, -2.4000000000000017, -3.4000000000000004, -2.2000000000000015, -3.200000000000001, -2.4000000000000017, -2.2000000000000015, -3.0000000000000018, -3.8999999999999986, -2.700000000000002, -1.700000000000001, -2.900000000000002, -2.4000000000000017, -2.600000000000002, -2.3000000000000016, -2.3000000000000016, -2.3000000000000016, -3.3000000000000007, -2.3000000000000016, -2.900000000000002, -2.5000000000000018, -2.600000000000002, -2.5000000000000018, -3.1000000000000014, -2.4000000000000017, -65.20000000000043, -3.1000000000000023, -2.700000000000002, -3.200000000000001, -3.3000000000000007, -2.900000000000002, -3.3000000000000007, -1.9000000000000012], "episode_lengths": [42, 37, 45, 29, 39, 33, 37, 33, 37, 34, 32, 37, 40, 35, 33, 39, 37, 37, 39, 40, 39, 40, 43, 30, 32, 40, 37, 29, 38, 45, 29, 33, 31, 39, 33, 34, 41, 40, 37, 36, 38, 43, 400, 27, 42, 34, 34, 29, 32, 42, 43, 36, 37, 32, 43, 31, 35, 46, 39, 37, 45, 48, 41, 46, 36, 35, 39, 42, 35, 45, 33, 43, 35, 33, 41, 50, 38, 28, 40, 31, 37, 34, 34, 34, 44, 34, 40, 36, 37, 36, 42, 35, 400, 40, 38, 43, 41, 40, 44, 30]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2977555429022643, "mean_inference_ms": 0.7292010125547042, "mean_action_processing_ms": 0.07589323778357279, "mean_env_wait_ms": 6.69096912522416, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007016181945800781, "StateBufferConnector_ms": 0.004008293151855469, "ViewRequirementAgentConnector_ms": 0.0900719165802002}, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 172000, "num_agent_steps_trained": 172000, "num_env_steps_sampled": 172000, "num_env_steps_trained": 172000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 429.1041453070085, "num_env_steps_trained_throughput_per_sec": 429.1041453070085, "timesteps_total": 172000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 172000, "timers": {"training_iteration_time_ms": 9336.403, "sample_time_ms": 5703.173, "load_time_ms": 1.004, "load_throughput": 3984708.341, "learn_time_ms": 3629.315, "learn_throughput": 1102.136, "synch_weights_time_ms": 2.261}, "counters": {"num_env_steps_sampled": 172000, "num_env_steps_trained": 172000, "num_agent_steps_sampled": 172000, "num_agent_steps_trained": 172000}, "done": false, "episodes_total": 2180, "training_iteration": 43, "trial_id": "ddfb6_00000", "date": "2024-03-07_12-54-52", "timestamp": 1709834092, "time_this_iter_s": 9.324495315551758, "time_total_s": 392.4593617916107, "pid": 112355, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4d85689f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 392.4593617916107, "iterations_since_restore": 43, "perf": {"cpu_util_percent": 29.05, "ram_util_percent": 51.98333333333333, "gpu_util_percent0": 0.09083333333333334, "vram_util_percent0": 0.12394205729166667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.10000000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 0.4855684909288601, "policy_loss": -0.01666690673809298, "vf_loss": 0.5009411216903759, "vf_explained_var": 0.814098842682377, "kl": 0.012942751463023263, "entropy": 0.45747370316136265, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 40455.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 176000, "num_env_steps_trained": 176000, "num_agent_steps_sampled": 176000, "num_agent_steps_trained": 176000}, "sampler_results": {"episode_reward_max": -1.600000000000001, "episode_reward_min": -72.40000000000045, "episode_reward_mean": -3.6420000000000057, "episode_len_mean": 43.47, "episode_media": {}, "episodes_this_iter": 93, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.1000000000000023, -2.700000000000002, -3.200000000000001, -3.3000000000000007, -2.900000000000002, -3.3000000000000007, -1.9000000000000012, -2.800000000000002, -2.800000000000002, -2.4000000000000017, -2.2000000000000015, -2.4000000000000017, -3.1000000000000014, -3.200000000000001, -2.900000000000002, -2.5000000000000018, -2.900000000000002, -1.600000000000001, -3.6999999999999993, -2.5000000000000018, -2.4000000000000017, -2.600000000000002, -2.3000000000000016, -3.200000000000001, -3.0000000000000018, -3.5, -2.1000000000000014, -4.099999999999998, -3.0000000000000018, -3.3000000000000007, -2.600000000000002, -2.0000000000000013, -3.5, -2.600000000000002, -3.1000000000000014, -2.5000000000000018, -2.5000000000000018, -3.5999999999999996, -2.800000000000002, -2.2000000000000015, -2.900000000000002, -3.1000000000000014, -3.1000000000000014, -2.600000000000002, -3.5, -2.1000000000000014, -3.799999999999999, -2.600000000000002, -2.4000000000000017, -3.200000000000001, -2.700000000000002, -2.800000000000002, -3.5, -3.3000000000000007, -2.2000000000000015, -2.3000000000000016, -3.1000000000000014, -2.4000000000000017, -3.799999999999999, -2.700000000000002, -2.800000000000002, -2.900000000000002, -2.700000000000002, -3.0000000000000018, -2.900000000000002, -2.4000000000000017, -2.3000000000000016, -2.0000000000000013, -3.3000000000000007, -6.699999999999995, -2.3000000000000016, -2.1000000000000014, -2.900000000000002, -2.2000000000000015, -2.0000000000000013, -16.79999999999997, -2.900000000000002, -2.600000000000002, -2.5000000000000018, -2.5000000000000018, -2.4000000000000017, -3.3000000000000007, -2.700000000000002, -2.4000000000000017, -3.200000000000001, -3.4000000000000004, -2.900000000000002, -2.5000000000000018, -72.40000000000045, -2.1000000000000014, -2.800000000000002, -2.800000000000002, -2.5000000000000018, -2.1000000000000014, -2.3000000000000016, -3.6999999999999993, -2.700000000000002, -2.900000000000002, -2.800000000000002, -2.1000000000000014], "episode_lengths": [40, 38, 43, 41, 40, 44, 30, 39, 39, 35, 33, 35, 42, 43, 40, 36, 40, 27, 48, 36, 35, 37, 34, 43, 41, 46, 32, 52, 41, 44, 37, 31, 46, 37, 42, 36, 36, 47, 39, 33, 40, 42, 42, 37, 46, 32, 49, 37, 35, 43, 38, 39, 46, 44, 33, 34, 42, 35, 49, 38, 39, 40, 38, 41, 40, 35, 34, 31, 44, 71, 34, 32, 40, 33, 31, 131, 40, 37, 36, 36, 35, 44, 38, 35, 43, 45, 40, 36, 400, 32, 39, 39, 36, 32, 34, 48, 38, 40, 39, 32]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.29900455828987654, "mean_inference_ms": 0.7292477218144774, "mean_action_processing_ms": 0.07589324983490607, "mean_env_wait_ms": 6.700609487269478, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0069277286529541016, "StateBufferConnector_ms": 0.003900289535522461, "ViewRequirementAgentConnector_ms": 0.08894824981689453}}, "episode_reward_max": -1.600000000000001, "episode_reward_min": -72.40000000000045, "episode_reward_mean": -3.6420000000000057, "episode_len_mean": 43.47, "episodes_this_iter": 93, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3.1000000000000023, -2.700000000000002, -3.200000000000001, -3.3000000000000007, -2.900000000000002, -3.3000000000000007, -1.9000000000000012, -2.800000000000002, -2.800000000000002, -2.4000000000000017, -2.2000000000000015, -2.4000000000000017, -3.1000000000000014, -3.200000000000001, -2.900000000000002, -2.5000000000000018, -2.900000000000002, -1.600000000000001, -3.6999999999999993, -2.5000000000000018, -2.4000000000000017, -2.600000000000002, -2.3000000000000016, -3.200000000000001, -3.0000000000000018, -3.5, -2.1000000000000014, -4.099999999999998, -3.0000000000000018, -3.3000000000000007, -2.600000000000002, -2.0000000000000013, -3.5, -2.600000000000002, -3.1000000000000014, -2.5000000000000018, -2.5000000000000018, -3.5999999999999996, -2.800000000000002, -2.2000000000000015, -2.900000000000002, -3.1000000000000014, -3.1000000000000014, -2.600000000000002, -3.5, -2.1000000000000014, -3.799999999999999, -2.600000000000002, -2.4000000000000017, -3.200000000000001, -2.700000000000002, -2.800000000000002, -3.5, -3.3000000000000007, -2.2000000000000015, -2.3000000000000016, -3.1000000000000014, -2.4000000000000017, -3.799999999999999, -2.700000000000002, -2.800000000000002, -2.900000000000002, -2.700000000000002, -3.0000000000000018, -2.900000000000002, -2.4000000000000017, -2.3000000000000016, -2.0000000000000013, -3.3000000000000007, -6.699999999999995, -2.3000000000000016, -2.1000000000000014, -2.900000000000002, -2.2000000000000015, -2.0000000000000013, -16.79999999999997, -2.900000000000002, -2.600000000000002, -2.5000000000000018, -2.5000000000000018, -2.4000000000000017, -3.3000000000000007, -2.700000000000002, -2.4000000000000017, -3.200000000000001, -3.4000000000000004, -2.900000000000002, -2.5000000000000018, -72.40000000000045, -2.1000000000000014, -2.800000000000002, -2.800000000000002, -2.5000000000000018, -2.1000000000000014, -2.3000000000000016, -3.6999999999999993, -2.700000000000002, -2.900000000000002, -2.800000000000002, -2.1000000000000014], "episode_lengths": [40, 38, 43, 41, 40, 44, 30, 39, 39, 35, 33, 35, 42, 43, 40, 36, 40, 27, 48, 36, 35, 37, 34, 43, 41, 46, 32, 52, 41, 44, 37, 31, 46, 37, 42, 36, 36, 47, 39, 33, 40, 42, 42, 37, 46, 32, 49, 37, 35, 43, 38, 39, 46, 44, 33, 34, 42, 35, 49, 38, 39, 40, 38, 41, 40, 35, 34, 31, 44, 71, 34, 32, 40, 33, 31, 131, 40, 37, 36, 36, 35, 44, 38, 35, 43, 45, 40, 36, 400, 32, 39, 39, 36, 32, 34, 48, 38, 40, 39, 32]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.29900455828987654, "mean_inference_ms": 0.7292477218144774, "mean_action_processing_ms": 0.07589324983490607, "mean_env_wait_ms": 6.700609487269478, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0069277286529541016, "StateBufferConnector_ms": 0.003900289535522461, "ViewRequirementAgentConnector_ms": 0.08894824981689453}, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 176000, "num_agent_steps_trained": 176000, "num_env_steps_sampled": 176000, "num_env_steps_trained": 176000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 433.4808584117871, "num_env_steps_trained_throughput_per_sec": 433.4808584117871, "timesteps_total": 176000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 176000, "timers": {"training_iteration_time_ms": 9333.935, "sample_time_ms": 5703.508, "load_time_ms": 1.005, "load_throughput": 3980076.388, "learn_time_ms": 3626.53, "learn_throughput": 1102.983, "synch_weights_time_ms": 2.247}, "counters": {"num_env_steps_sampled": 176000, "num_env_steps_trained": 176000, "num_agent_steps_sampled": 176000, "num_agent_steps_trained": 176000}, "done": false, "episodes_total": 2273, "training_iteration": 44, "trial_id": "ddfb6_00000", "date": "2024-03-07_12-55-01", "timestamp": 1709834101, "time_this_iter_s": 9.230273008346558, "time_total_s": 401.6896347999573, "pid": 112355, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4d85689f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 401.6896347999573, "iterations_since_restore": 44, "perf": {"cpu_util_percent": 27.108333333333334, "ram_util_percent": 51.79999999999999, "gpu_util_percent0": 0.10333333333333333, "vram_util_percent0": 0.1234063042534722}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.10000000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 0.7518004884931161, "policy_loss": -0.00822600733078215, "vf_loss": 0.7590915174874407, "vf_explained_var": 0.6787400016861577, "kl": 0.009349813374928719, "entropy": 0.4750157279352988, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 41385.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 180000, "num_env_steps_trained": 180000, "num_agent_steps_sampled": 180000, "num_agent_steps_trained": 180000}, "sampler_results": {"episode_reward_max": -1.8000000000000012, "episode_reward_min": -58.100000000000406, "episode_reward_mean": -3.307000000000005, "episode_len_mean": 41.99, "episode_media": {}, "episodes_this_iter": 96, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2.700000000000002, -2.900000000000002, -2.800000000000002, -2.1000000000000014, -3.200000000000001, -2.2000000000000015, -2.600000000000002, -1.8000000000000012, -2.4000000000000017, -3.1000000000000014, -2.2000000000000015, -2.600000000000002, -3.4000000000000004, -1.9000000000000012, -3.200000000000001, -2.0000000000000013, -2.700000000000002, -2.5000000000000018, -1.9000000000000012, -3.5999999999999996, -2.700000000000002, -2.2000000000000015, -1.9000000000000012, -3.3000000000000007, -4.999999999999995, -2.0000000000000013, -2.0000000000000013, -1.8000000000000012, -2.3000000000000016, -3.4000000000000004, -58.100000000000406, -3.3000000000000007, -2.900000000000002, -2.3000000000000016, -2.900000000000002, -2.2000000000000015, -2.800000000000002, -2.800000000000002, -2.600000000000002, -3.1000000000000014, -2.700000000000002, -2.700000000000002, -3.5, -2.800000000000002, -3.1000000000000014, -2.900000000000002, -1.9000000000000012, -3.200000000000001, -3.0000000000000018, -2.2000000000000015, -3.4000000000000004, -2.700000000000002, -2.5000000000000018, -2.3000000000000016, -2.1000000000000014, -2.1000000000000014, -2.600000000000002, -2.600000000000002, -2.1000000000000014, -2.600000000000002, -2.800000000000002, -2.3000000000000016, -2.600000000000002, -2.900000000000002, -2.5000000000000018, -3.0000000000000018, -2.800000000000002, -1.8000000000000012, -2.600000000000002, -2.800000000000002, -3.1000000000000014, -3.9999999999999982, -2.900000000000002, -2.700000000000002, -2.800000000000002, -2.600000000000002, -2.900000000000002, -4.299999999999997, -2.1000000000000014, -2.2000000000000015, -2.4000000000000017, -2.2000000000000015, -2.1000000000000014, -2.3000000000000016, -2.4000000000000017, -2.4000000000000017, -2.600000000000002, -3.1000000000000014, -2.4000000000000017, -3.3000000000000007, -3.1000000000000014, -3.1000000000000014, -3.5, -3.1000000000000014, -2.5000000000000018, -3.9999999999999982, -2.900000000000002, -7.9999999999999964, -2.900000000000002, -2.3000000000000016], "episode_lengths": [38, 40, 39, 32, 41, 33, 37, 29, 35, 42, 33, 37, 45, 30, 43, 31, 38, 36, 30, 47, 38, 33, 30, 44, 61, 31, 31, 29, 34, 45, 400, 44, 40, 34, 40, 33, 39, 39, 37, 42, 38, 38, 46, 39, 42, 40, 30, 43, 41, 33, 45, 38, 36, 34, 32, 32, 37, 37, 32, 37, 39, 34, 37, 40, 36, 41, 39, 29, 37, 39, 42, 51, 40, 38, 39, 37, 40, 54, 32, 33, 35, 33, 32, 34, 35, 35, 37, 42, 35, 44, 42, 42, 46, 42, 36, 51, 40, 77, 40, 34]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.30067683984406374, "mean_inference_ms": 0.7296438979533106, "mean_action_processing_ms": 0.07592092668883227, "mean_env_wait_ms": 6.705192497591583, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007072925567626953, "StateBufferConnector_ms": 0.004059553146362305, "ViewRequirementAgentConnector_ms": 0.0921790599822998}}, "episode_reward_max": -1.8000000000000012, "episode_reward_min": -58.100000000000406, "episode_reward_mean": -3.307000000000005, "episode_len_mean": 41.99, "episodes_this_iter": 96, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-2.700000000000002, -2.900000000000002, -2.800000000000002, -2.1000000000000014, -3.200000000000001, -2.2000000000000015, -2.600000000000002, -1.8000000000000012, -2.4000000000000017, -3.1000000000000014, -2.2000000000000015, -2.600000000000002, -3.4000000000000004, -1.9000000000000012, -3.200000000000001, -2.0000000000000013, -2.700000000000002, -2.5000000000000018, -1.9000000000000012, -3.5999999999999996, -2.700000000000002, -2.2000000000000015, -1.9000000000000012, -3.3000000000000007, -4.999999999999995, -2.0000000000000013, -2.0000000000000013, -1.8000000000000012, -2.3000000000000016, -3.4000000000000004, -58.100000000000406, -3.3000000000000007, -2.900000000000002, -2.3000000000000016, -2.900000000000002, -2.2000000000000015, -2.800000000000002, -2.800000000000002, -2.600000000000002, -3.1000000000000014, -2.700000000000002, -2.700000000000002, -3.5, -2.800000000000002, -3.1000000000000014, -2.900000000000002, -1.9000000000000012, -3.200000000000001, -3.0000000000000018, -2.2000000000000015, -3.4000000000000004, -2.700000000000002, -2.5000000000000018, -2.3000000000000016, -2.1000000000000014, -2.1000000000000014, -2.600000000000002, -2.600000000000002, -2.1000000000000014, -2.600000000000002, -2.800000000000002, -2.3000000000000016, -2.600000000000002, -2.900000000000002, -2.5000000000000018, -3.0000000000000018, -2.800000000000002, -1.8000000000000012, -2.600000000000002, -2.800000000000002, -3.1000000000000014, -3.9999999999999982, -2.900000000000002, -2.700000000000002, -2.800000000000002, -2.600000000000002, -2.900000000000002, -4.299999999999997, -2.1000000000000014, -2.2000000000000015, -2.4000000000000017, -2.2000000000000015, -2.1000000000000014, -2.3000000000000016, -2.4000000000000017, -2.4000000000000017, -2.600000000000002, -3.1000000000000014, -2.4000000000000017, -3.3000000000000007, -3.1000000000000014, -3.1000000000000014, -3.5, -3.1000000000000014, -2.5000000000000018, -3.9999999999999982, -2.900000000000002, -7.9999999999999964, -2.900000000000002, -2.3000000000000016], "episode_lengths": [38, 40, 39, 32, 41, 33, 37, 29, 35, 42, 33, 37, 45, 30, 43, 31, 38, 36, 30, 47, 38, 33, 30, 44, 61, 31, 31, 29, 34, 45, 400, 44, 40, 34, 40, 33, 39, 39, 37, 42, 38, 38, 46, 39, 42, 40, 30, 43, 41, 33, 45, 38, 36, 34, 32, 32, 37, 37, 32, 37, 39, 34, 37, 40, 36, 41, 39, 29, 37, 39, 42, 51, 40, 38, 39, 37, 40, 54, 32, 33, 35, 33, 32, 34, 35, 35, 37, 42, 35, 44, 42, 42, 46, 42, 36, 51, 40, 77, 40, 34]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.30067683984406374, "mean_inference_ms": 0.7296438979533106, "mean_action_processing_ms": 0.07592092668883227, "mean_env_wait_ms": 6.705192497591583, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007072925567626953, "StateBufferConnector_ms": 0.004059553146362305, "ViewRequirementAgentConnector_ms": 0.0921790599822998}, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 180000, "num_agent_steps_trained": 180000, "num_env_steps_sampled": 180000, "num_env_steps_trained": 180000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 407.6879871349451, "num_env_steps_trained_throughput_per_sec": 407.6879871349451, "timesteps_total": 180000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 180000, "timers": {"training_iteration_time_ms": 9378.483, "sample_time_ms": 5718.866, "load_time_ms": 1.008, "load_throughput": 3968590.42, "learn_time_ms": 3655.724, "learn_throughput": 1094.175, "synch_weights_time_ms": 2.242}, "counters": {"num_env_steps_sampled": 180000, "num_env_steps_trained": 180000, "num_agent_steps_sampled": 180000, "num_agent_steps_trained": 180000}, "done": false, "episodes_total": 2369, "training_iteration": 45, "trial_id": "ddfb6_00000", "date": "2024-03-07_12-55-11", "timestamp": 1709834111, "time_this_iter_s": 9.81413984298706, "time_total_s": 411.50377464294434, "pid": 112355, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4d85689f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 411.50377464294434, "iterations_since_restore": 45, "perf": {"cpu_util_percent": 28.976923076923086, "ram_util_percent": 51.976923076923086, "gpu_util_percent0": 0.12923076923076923, "vram_util_percent0": 0.12404847756410257}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.10000000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 0.7830257463642591, "policy_loss": -0.013272263654457625, "vf_loss": 0.7950650015825866, "vf_explained_var": 0.7666492023775654, "kl": 0.012330078444602087, "entropy": 0.45297039606237927, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 42315.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 184000, "num_env_steps_trained": 184000, "num_agent_steps_sampled": 184000, "num_agent_steps_trained": 184000}, "sampler_results": {"episode_reward_max": -1.5000000000000009, "episode_reward_min": -40.50000000000005, "episode_reward_mean": -3.1180000000000017, "episode_len_mean": 40.15, "episode_media": {}, "episodes_this_iter": 99, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2.3000000000000016, -3.3000000000000007, -2.900000000000002, -3.0000000000000018, -3.0000000000000018, -6.299999999999997, -3.7, -2.0000000000000013, -2.600000000000002, -3.4000000000000004, -3.5, -2.800000000000002, -3.0000000000000018, -2.4000000000000017, -2.1000000000000014, -3.3000000000000007, -2.3000000000000016, -3.1000000000000014, -2.0000000000000013, -2.2000000000000015, -2.3000000000000016, -2.4000000000000017, -2.2000000000000015, -2.700000000000002, -40.50000000000005, -2.4000000000000017, -2.4000000000000017, -2.2000000000000015, -2.2000000000000015, -2.0000000000000013, -3.5999999999999996, -2.3000000000000016, -2.2000000000000015, -3.200000000000001, -2.0000000000000013, -3.1000000000000014, -2.4000000000000017, -1.600000000000001, -2.600000000000002, -3.3000000000000007, -3.0000000000000018, -3.1000000000000014, -2.600000000000002, -3.200000000000001, -3.5, -1.600000000000001, -3.4000000000000004, -2.600000000000002, -2.800000000000002, -9.699999999999996, -1.8000000000000012, -1.700000000000001, -2.600000000000002, -2.4000000000000017, -2.4000000000000017, -3.1000000000000014, -3.5, -2.900000000000002, -3.5999999999999996, -3.1000000000000014, -2.4000000000000017, -3.200000000000001, -2.4000000000000017, -2.600000000000002, -2.4000000000000017, -3.200000000000001, -2.3000000000000016, -2.900000000000002, -2.700000000000002, -2.2000000000000015, -2.4000000000000017, -2.800000000000002, -3.0000000000000018, -2.5000000000000018, -2.1000000000000014, -3.1000000000000014, -2.800000000000002, -2.2000000000000015, -2.900000000000002, -2.800000000000002, -2.4000000000000017, -2.4000000000000017, -3.200000000000001, -2.900000000000002, -2.4000000000000017, -2.2000000000000015, -2.700000000000002, -2.600000000000002, -2.1000000000000014, -2.4000000000000017, -2.2000000000000015, -2.5000000000000018, -2.2000000000000015, -1.8000000000000012, -3.0000000000000018, -2.600000000000002, -2.600000000000002, -2.900000000000002, -1.5000000000000009, -2.900000000000002], "episode_lengths": [34, 44, 40, 41, 41, 64, 46, 31, 37, 45, 46, 39, 41, 35, 32, 44, 34, 42, 31, 33, 34, 35, 33, 37, 276, 35, 35, 33, 33, 31, 47, 34, 33, 43, 31, 42, 35, 27, 37, 44, 41, 42, 37, 43, 46, 27, 45, 37, 39, 67, 29, 28, 37, 35, 35, 42, 46, 40, 47, 42, 35, 35, 35, 37, 35, 43, 34, 40, 38, 33, 34, 39, 41, 36, 32, 42, 39, 33, 40, 39, 35, 35, 43, 40, 35, 33, 38, 37, 32, 35, 33, 36, 33, 29, 41, 37, 37, 40, 26, 40]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3031074559717563, "mean_inference_ms": 0.7305192931355612, "mean_action_processing_ms": 0.0760077751515999, "mean_env_wait_ms": 6.728480849112718, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00733494758605957, "StateBufferConnector_ms": 0.004148244857788086, "ViewRequirementAgentConnector_ms": 0.09466338157653809}}, "episode_reward_max": -1.5000000000000009, "episode_reward_min": -40.50000000000005, "episode_reward_mean": -3.1180000000000017, "episode_len_mean": 40.15, "episodes_this_iter": 99, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-2.3000000000000016, -3.3000000000000007, -2.900000000000002, -3.0000000000000018, -3.0000000000000018, -6.299999999999997, -3.7, -2.0000000000000013, -2.600000000000002, -3.4000000000000004, -3.5, -2.800000000000002, -3.0000000000000018, -2.4000000000000017, -2.1000000000000014, -3.3000000000000007, -2.3000000000000016, -3.1000000000000014, -2.0000000000000013, -2.2000000000000015, -2.3000000000000016, -2.4000000000000017, -2.2000000000000015, -2.700000000000002, -40.50000000000005, -2.4000000000000017, -2.4000000000000017, -2.2000000000000015, -2.2000000000000015, -2.0000000000000013, -3.5999999999999996, -2.3000000000000016, -2.2000000000000015, -3.200000000000001, -2.0000000000000013, -3.1000000000000014, -2.4000000000000017, -1.600000000000001, -2.600000000000002, -3.3000000000000007, -3.0000000000000018, -3.1000000000000014, -2.600000000000002, -3.200000000000001, -3.5, -1.600000000000001, -3.4000000000000004, -2.600000000000002, -2.800000000000002, -9.699999999999996, -1.8000000000000012, -1.700000000000001, -2.600000000000002, -2.4000000000000017, -2.4000000000000017, -3.1000000000000014, -3.5, -2.900000000000002, -3.5999999999999996, -3.1000000000000014, -2.4000000000000017, -3.200000000000001, -2.4000000000000017, -2.600000000000002, -2.4000000000000017, -3.200000000000001, -2.3000000000000016, -2.900000000000002, -2.700000000000002, -2.2000000000000015, -2.4000000000000017, -2.800000000000002, -3.0000000000000018, -2.5000000000000018, -2.1000000000000014, -3.1000000000000014, -2.800000000000002, -2.2000000000000015, -2.900000000000002, -2.800000000000002, -2.4000000000000017, -2.4000000000000017, -3.200000000000001, -2.900000000000002, -2.4000000000000017, -2.2000000000000015, -2.700000000000002, -2.600000000000002, -2.1000000000000014, -2.4000000000000017, -2.2000000000000015, -2.5000000000000018, -2.2000000000000015, -1.8000000000000012, -3.0000000000000018, -2.600000000000002, -2.600000000000002, -2.900000000000002, -1.5000000000000009, -2.900000000000002], "episode_lengths": [34, 44, 40, 41, 41, 64, 46, 31, 37, 45, 46, 39, 41, 35, 32, 44, 34, 42, 31, 33, 34, 35, 33, 37, 276, 35, 35, 33, 33, 31, 47, 34, 33, 43, 31, 42, 35, 27, 37, 44, 41, 42, 37, 43, 46, 27, 45, 37, 39, 67, 29, 28, 37, 35, 35, 42, 46, 40, 47, 42, 35, 35, 35, 37, 35, 43, 34, 40, 38, 33, 34, 39, 41, 36, 32, 42, 39, 33, 40, 39, 35, 35, 43, 40, 35, 33, 38, 37, 32, 35, 33, 36, 33, 29, 41, 37, 37, 40, 26, 40]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3031074559717563, "mean_inference_ms": 0.7305192931355612, "mean_action_processing_ms": 0.0760077751515999, "mean_env_wait_ms": 6.728480849112718, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00733494758605957, "StateBufferConnector_ms": 0.004148244857788086, "ViewRequirementAgentConnector_ms": 0.09466338157653809}, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 184000, "num_agent_steps_trained": 184000, "num_env_steps_sampled": 184000, "num_env_steps_trained": 184000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 406.51390837797976, "num_env_steps_trained_throughput_per_sec": 406.51390837797976, "timesteps_total": 184000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 184000, "timers": {"training_iteration_time_ms": 9444.124, "sample_time_ms": 5760.454, "load_time_ms": 1.008, "load_throughput": 3970092.998, "learn_time_ms": 3679.816, "learn_throughput": 1087.011, "synch_weights_time_ms": 2.206}, "counters": {"num_env_steps_sampled": 184000, "num_env_steps_trained": 184000, "num_agent_steps_sampled": 184000, "num_agent_steps_trained": 184000}, "done": false, "episodes_total": 2468, "training_iteration": 46, "trial_id": "ddfb6_00000", "date": "2024-03-07_12-55-21", "timestamp": 1709834121, "time_this_iter_s": 9.842482566833496, "time_total_s": 421.34625720977783, "pid": 112355, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4d85689f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 421.34625720977783, "iterations_since_restore": 46, "perf": {"cpu_util_percent": 29.315384615384616, "ram_util_percent": 52.47692307692308, "gpu_util_percent0": 0.1246153846153846, "vram_util_percent0": 0.1245868389423077}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.10000000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 0.08019634886226687, "policy_loss": -0.014923581573110755, "vf_loss": 0.09421438698967298, "vf_explained_var": 0.9368091445456269, "kl": 0.009055431503793931, "entropy": 0.399919496364491, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 43245.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 188000, "num_env_steps_trained": 188000, "num_agent_steps_sampled": 188000, "num_agent_steps_trained": 188000}, "sampler_results": {"episode_reward_max": -1.600000000000001, "episode_reward_min": -4.299999999999997, "episode_reward_mean": -2.5872727272727287, "episode_len_mean": 36.78181818181818, "episode_media": {}, "episodes_this_iter": 110, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2.700000000000002, -3.200000000000002, -2.600000000000002, -2.4000000000000017, -2.600000000000002, -2.800000000000002, -2.700000000000002, -2.900000000000002, -2.0000000000000013, -2.0000000000000013, -1.8000000000000012, -2.5000000000000018, -3.5999999999999996, -3.4000000000000004, -2.600000000000002, -3.0000000000000018, -4.299999999999997, -2.2000000000000015, -2.600000000000002, -2.2000000000000015, -2.700000000000002, -3.6999999999999993, -2.800000000000002, -2.4000000000000017, -1.700000000000001, -2.600000000000002, -2.0000000000000013, -2.3000000000000016, -3.0000000000000018, -2.900000000000002, -2.3000000000000016, -2.0000000000000013, -2.2000000000000015, -2.4000000000000017, -2.2000000000000015, -1.700000000000001, -3.4000000000000004, -1.700000000000001, -2.5000000000000018, -2.700000000000002, -2.2000000000000015, -1.600000000000001, -2.700000000000002, -2.700000000000002, -2.3000000000000016, -3.1000000000000014, -2.1000000000000014, -2.3000000000000016, -2.600000000000002, -2.600000000000002, -3.9999999999999982, -2.1000000000000014, -1.9000000000000012, -2.3000000000000016, -3.1000000000000014, -2.700000000000002, -3.799999999999999, -2.600000000000002, -2.4000000000000017, -3.200000000000001, -3.3000000000000007, -2.4000000000000017, -2.900000000000002, -2.5000000000000018, -2.1000000000000014, -3.200000000000001, -2.900000000000002, -2.2000000000000015, -2.2000000000000015, -3.5, -3.5, -2.5000000000000018, -3.200000000000001, -2.3000000000000016, -2.3000000000000016, -3.0000000000000018, -2.700000000000002, -2.2000000000000015, -2.2000000000000015, -2.0000000000000013, -2.700000000000002, -2.900000000000002, -2.700000000000002, -3.4000000000000004, -2.5000000000000018, -2.800000000000002, -2.0000000000000013, -1.700000000000001, -2.5000000000000018, -2.700000000000002, -3.0000000000000018, -2.700000000000002, -2.3000000000000016, -2.5000000000000018, -2.5000000000000018, -2.2000000000000015, -2.600000000000002, -2.1000000000000014, -2.2000000000000015, -2.700000000000002, -2.700000000000002, -3.5999999999999996, -2.5000000000000018, -2.700000000000002, -1.700000000000001, -2.3000000000000016, -2.600000000000002, -2.3000000000000016, -2.4000000000000017, -2.4000000000000017], "episode_lengths": [38, 41, 37, 35, 37, 39, 38, 40, 31, 31, 29, 36, 47, 45, 37, 41, 54, 33, 37, 33, 38, 48, 39, 35, 28, 37, 31, 34, 41, 40, 34, 31, 33, 35, 33, 28, 45, 28, 36, 38, 33, 27, 33, 38, 34, 42, 32, 34, 37, 37, 51, 32, 30, 34, 42, 38, 49, 37, 35, 43, 44, 35, 40, 36, 32, 43, 40, 33, 33, 46, 44, 36, 43, 34, 34, 41, 38, 33, 33, 31, 38, 40, 38, 45, 36, 39, 31, 28, 36, 38, 40, 38, 34, 36, 36, 33, 37, 32, 33, 38, 38, 47, 36, 38, 28, 34, 37, 34, 35, 35]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3049605151799561, "mean_inference_ms": 0.730093315412145, "mean_action_processing_ms": 0.07595066767158438, "mean_env_wait_ms": 6.73955905331238, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006861903450705789, "StateBufferConnector_ms": 0.003851110284978693, "ViewRequirementAgentConnector_ms": 0.08802522312511098}}, "episode_reward_max": -1.600000000000001, "episode_reward_min": -4.299999999999997, "episode_reward_mean": -2.5872727272727287, "episode_len_mean": 36.78181818181818, "episodes_this_iter": 110, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-2.700000000000002, -3.200000000000002, -2.600000000000002, -2.4000000000000017, -2.600000000000002, -2.800000000000002, -2.700000000000002, -2.900000000000002, -2.0000000000000013, -2.0000000000000013, -1.8000000000000012, -2.5000000000000018, -3.5999999999999996, -3.4000000000000004, -2.600000000000002, -3.0000000000000018, -4.299999999999997, -2.2000000000000015, -2.600000000000002, -2.2000000000000015, -2.700000000000002, -3.6999999999999993, -2.800000000000002, -2.4000000000000017, -1.700000000000001, -2.600000000000002, -2.0000000000000013, -2.3000000000000016, -3.0000000000000018, -2.900000000000002, -2.3000000000000016, -2.0000000000000013, -2.2000000000000015, -2.4000000000000017, -2.2000000000000015, -1.700000000000001, -3.4000000000000004, -1.700000000000001, -2.5000000000000018, -2.700000000000002, -2.2000000000000015, -1.600000000000001, -2.700000000000002, -2.700000000000002, -2.3000000000000016, -3.1000000000000014, -2.1000000000000014, -2.3000000000000016, -2.600000000000002, -2.600000000000002, -3.9999999999999982, -2.1000000000000014, -1.9000000000000012, -2.3000000000000016, -3.1000000000000014, -2.700000000000002, -3.799999999999999, -2.600000000000002, -2.4000000000000017, -3.200000000000001, -3.3000000000000007, -2.4000000000000017, -2.900000000000002, -2.5000000000000018, -2.1000000000000014, -3.200000000000001, -2.900000000000002, -2.2000000000000015, -2.2000000000000015, -3.5, -3.5, -2.5000000000000018, -3.200000000000001, -2.3000000000000016, -2.3000000000000016, -3.0000000000000018, -2.700000000000002, -2.2000000000000015, -2.2000000000000015, -2.0000000000000013, -2.700000000000002, -2.900000000000002, -2.700000000000002, -3.4000000000000004, -2.5000000000000018, -2.800000000000002, -2.0000000000000013, -1.700000000000001, -2.5000000000000018, -2.700000000000002, -3.0000000000000018, -2.700000000000002, -2.3000000000000016, -2.5000000000000018, -2.5000000000000018, -2.2000000000000015, -2.600000000000002, -2.1000000000000014, -2.2000000000000015, -2.700000000000002, -2.700000000000002, -3.5999999999999996, -2.5000000000000018, -2.700000000000002, -1.700000000000001, -2.3000000000000016, -2.600000000000002, -2.3000000000000016, -2.4000000000000017, -2.4000000000000017], "episode_lengths": [38, 41, 37, 35, 37, 39, 38, 40, 31, 31, 29, 36, 47, 45, 37, 41, 54, 33, 37, 33, 38, 48, 39, 35, 28, 37, 31, 34, 41, 40, 34, 31, 33, 35, 33, 28, 45, 28, 36, 38, 33, 27, 33, 38, 34, 42, 32, 34, 37, 37, 51, 32, 30, 34, 42, 38, 49, 37, 35, 43, 44, 35, 40, 36, 32, 43, 40, 33, 33, 46, 44, 36, 43, 34, 34, 41, 38, 33, 33, 31, 38, 40, 38, 45, 36, 39, 31, 28, 36, 38, 40, 38, 34, 36, 36, 33, 37, 32, 33, 38, 38, 47, 36, 38, 28, 34, 37, 34, 35, 35]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3049605151799561, "mean_inference_ms": 0.730093315412145, "mean_action_processing_ms": 0.07595066767158438, "mean_env_wait_ms": 6.73955905331238, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006861903450705789, "StateBufferConnector_ms": 0.003851110284978693, "ViewRequirementAgentConnector_ms": 0.08802522312511098}, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 188000, "num_agent_steps_trained": 188000, "num_env_steps_sampled": 188000, "num_env_steps_trained": 188000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 426.85403189571434, "num_env_steps_trained_throughput_per_sec": 426.85403189571434, "timesteps_total": 188000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 188000, "timers": {"training_iteration_time_ms": 9445.048, "sample_time_ms": 5759.946, "load_time_ms": 1.01, "load_throughput": 3961936.428, "learn_time_ms": 3681.274, "learn_throughput": 1086.58, "synch_weights_time_ms": 2.183}, "counters": {"num_env_steps_sampled": 188000, "num_env_steps_trained": 188000, "num_agent_steps_sampled": 188000, "num_agent_steps_trained": 188000}, "done": false, "episodes_total": 2578, "training_iteration": 47, "trial_id": "ddfb6_00000", "date": "2024-03-07_12-55-30", "timestamp": 1709834130, "time_this_iter_s": 9.37373685836792, "time_total_s": 430.71999406814575, "pid": 112355, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4d85689f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 430.71999406814575, "iterations_since_restore": 47, "perf": {"cpu_util_percent": 27.175000000000008, "ram_util_percent": 52.41666666666666, "gpu_util_percent0": 0.09583333333333333, "vram_util_percent0": 0.12451171875}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.10000000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 0.17786719056587386, "policy_loss": -0.008831812613593634, "vf_loss": 0.18559262593406983, "vf_explained_var": 0.8908768359691867, "kl": 0.011063785538648297, "entropy": 0.3630036465102626, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 44175.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 192000, "num_env_steps_trained": 192000, "num_agent_steps_sampled": 192000, "num_agent_steps_trained": 192000}, "sampler_results": {"episode_reward_max": -1.4000000000000008, "episode_reward_min": -12.799999999999976, "episode_reward_mean": -2.486725663716815, "episode_len_mean": 35.6283185840708, "episode_media": {}, "episodes_this_iter": 113, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.4000000000000004, -3.3000000000000007, -2.1000000000000014, -1.8000000000000012, -1.8000000000000012, -2.4000000000000017, -1.9000000000000012, -3.4000000000000004, -2.3000000000000016, -2.0000000000000013, -2.0000000000000013, -2.2000000000000015, -2.800000000000002, -2.5000000000000018, -2.0000000000000013, -2.1000000000000014, -2.600000000000002, -2.4000000000000017, -2.1000000000000014, -1.8000000000000012, -2.0000000000000013, -3.5000000000000018, -2.1000000000000014, -1.8000000000000012, -2.600000000000002, -2.600000000000002, -2.1000000000000014, -2.1000000000000014, -3.200000000000001, -2.2000000000000015, -2.1000000000000014, -3.3000000000000007, -2.800000000000002, -2.4000000000000017, -2.3000000000000016, -2.2000000000000015, -2.1000000000000014, -1.9000000000000012, -3.1000000000000014, -1.5000000000000009, -2.700000000000002, -2.600000000000002, -3.200000000000001, -2.2000000000000015, -2.0000000000000013, -2.3000000000000016, -2.700000000000002, -1.4000000000000008, -2.5000000000000018, -2.3000000000000016, -2.1000000000000014, -2.600000000000002, -2.5000000000000018, -2.3000000000000016, -3.5, -2.700000000000002, -2.700000000000002, -3.200000000000001, -2.3000000000000016, -2.600000000000002, -2.2000000000000015, -2.4000000000000017, -2.0000000000000013, -1.700000000000001, -2.3000000000000016, -2.3000000000000016, -2.3000000000000016, -1.9000000000000012, -2.2000000000000015, -2.600000000000002, -1.9000000000000012, -3.0000000000000018, -2.700000000000002, -2.600000000000002, -3.1000000000000014, -2.1000000000000014, -2.3000000000000016, -2.4000000000000017, -2.5000000000000018, -2.700000000000002, -2.3000000000000016, -2.1000000000000014, -2.0000000000000013, -1.600000000000001, -2.800000000000002, -2.2000000000000015, -2.2000000000000015, -2.1000000000000014, -2.900000000000002, -12.799999999999976, -2.3000000000000016, -1.8000000000000012, -2.700000000000002, -2.800000000000002, -2.600000000000002, -2.0000000000000013, -2.2000000000000015, -2.1000000000000014, -3.0000000000000018, -2.1000000000000014, -1.8000000000000012, -2.700000000000002, -2.5000000000000018, -2.700000000000002, -2.5000000000000018, -2.0000000000000013, -1.9000000000000012, -2.800000000000002, -2.700000000000002, -2.5000000000000018, -2.2000000000000015, -2.5000000000000018, -3.200000000000001], "episode_lengths": [45, 44, 32, 29, 29, 35, 30, 45, 34, 31, 31, 33, 39, 36, 31, 32, 37, 35, 32, 29, 31, 44, 32, 29, 37, 37, 32, 32, 43, 33, 32, 44, 39, 35, 34, 33, 32, 30, 42, 26, 38, 37, 43, 33, 31, 34, 38, 25, 36, 34, 32, 37, 36, 34, 46, 38, 38, 43, 34, 37, 33, 35, 31, 28, 34, 34, 34, 30, 33, 37, 30, 41, 38, 37, 42, 32, 34, 35, 36, 38, 34, 32, 31, 27, 39, 33, 33, 32, 40, 114, 34, 29, 38, 39, 37, 31, 33, 32, 41, 32, 29, 38, 36, 38, 36, 31, 30, 39, 38, 36, 33, 36, 43]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.30707204165358826, "mean_inference_ms": 0.7304215471613408, "mean_action_processing_ms": 0.07598182534661659, "mean_env_wait_ms": 6.7535386325604625, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0070208996798084905, "StateBufferConnector_ms": 0.00405121693568947, "ViewRequirementAgentConnector_ms": 0.09096027475542727}}, "episode_reward_max": -1.4000000000000008, "episode_reward_min": -12.799999999999976, "episode_reward_mean": -2.486725663716815, "episode_len_mean": 35.6283185840708, "episodes_this_iter": 113, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3.4000000000000004, -3.3000000000000007, -2.1000000000000014, -1.8000000000000012, -1.8000000000000012, -2.4000000000000017, -1.9000000000000012, -3.4000000000000004, -2.3000000000000016, -2.0000000000000013, -2.0000000000000013, -2.2000000000000015, -2.800000000000002, -2.5000000000000018, -2.0000000000000013, -2.1000000000000014, -2.600000000000002, -2.4000000000000017, -2.1000000000000014, -1.8000000000000012, -2.0000000000000013, -3.5000000000000018, -2.1000000000000014, -1.8000000000000012, -2.600000000000002, -2.600000000000002, -2.1000000000000014, -2.1000000000000014, -3.200000000000001, -2.2000000000000015, -2.1000000000000014, -3.3000000000000007, -2.800000000000002, -2.4000000000000017, -2.3000000000000016, -2.2000000000000015, -2.1000000000000014, -1.9000000000000012, -3.1000000000000014, -1.5000000000000009, -2.700000000000002, -2.600000000000002, -3.200000000000001, -2.2000000000000015, -2.0000000000000013, -2.3000000000000016, -2.700000000000002, -1.4000000000000008, -2.5000000000000018, -2.3000000000000016, -2.1000000000000014, -2.600000000000002, -2.5000000000000018, -2.3000000000000016, -3.5, -2.700000000000002, -2.700000000000002, -3.200000000000001, -2.3000000000000016, -2.600000000000002, -2.2000000000000015, -2.4000000000000017, -2.0000000000000013, -1.700000000000001, -2.3000000000000016, -2.3000000000000016, -2.3000000000000016, -1.9000000000000012, -2.2000000000000015, -2.600000000000002, -1.9000000000000012, -3.0000000000000018, -2.700000000000002, -2.600000000000002, -3.1000000000000014, -2.1000000000000014, -2.3000000000000016, -2.4000000000000017, -2.5000000000000018, -2.700000000000002, -2.3000000000000016, -2.1000000000000014, -2.0000000000000013, -1.600000000000001, -2.800000000000002, -2.2000000000000015, -2.2000000000000015, -2.1000000000000014, -2.900000000000002, -12.799999999999976, -2.3000000000000016, -1.8000000000000012, -2.700000000000002, -2.800000000000002, -2.600000000000002, -2.0000000000000013, -2.2000000000000015, -2.1000000000000014, -3.0000000000000018, -2.1000000000000014, -1.8000000000000012, -2.700000000000002, -2.5000000000000018, -2.700000000000002, -2.5000000000000018, -2.0000000000000013, -1.9000000000000012, -2.800000000000002, -2.700000000000002, -2.5000000000000018, -2.2000000000000015, -2.5000000000000018, -3.200000000000001], "episode_lengths": [45, 44, 32, 29, 29, 35, 30, 45, 34, 31, 31, 33, 39, 36, 31, 32, 37, 35, 32, 29, 31, 44, 32, 29, 37, 37, 32, 32, 43, 33, 32, 44, 39, 35, 34, 33, 32, 30, 42, 26, 38, 37, 43, 33, 31, 34, 38, 25, 36, 34, 32, 37, 36, 34, 46, 38, 38, 43, 34, 37, 33, 35, 31, 28, 34, 34, 34, 30, 33, 37, 30, 41, 38, 37, 42, 32, 34, 35, 36, 38, 34, 32, 31, 27, 39, 33, 33, 32, 40, 114, 34, 29, 38, 39, 37, 31, 33, 32, 41, 32, 29, 38, 36, 38, 36, 31, 30, 39, 38, 36, 33, 36, 43]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.30707204165358826, "mean_inference_ms": 0.7304215471613408, "mean_action_processing_ms": 0.07598182534661659, "mean_env_wait_ms": 6.7535386325604625, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0070208996798084905, "StateBufferConnector_ms": 0.00405121693568947, "ViewRequirementAgentConnector_ms": 0.09096027475542727}, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 192000, "num_agent_steps_trained": 192000, "num_env_steps_sampled": 192000, "num_env_steps_trained": 192000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 414.83228487556096, "num_env_steps_trained_throughput_per_sec": 414.83228487556096, "timesteps_total": 192000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 192000, "timers": {"training_iteration_time_ms": 9464.388, "sample_time_ms": 5780.075, "load_time_ms": 1.007, "load_throughput": 3971972.821, "learn_time_ms": 3680.487, "learn_throughput": 1086.813, "synch_weights_time_ms": 2.178}, "counters": {"num_env_steps_sampled": 192000, "num_env_steps_trained": 192000, "num_agent_steps_sampled": 192000, "num_agent_steps_trained": 192000}, "done": false, "episodes_total": 2691, "training_iteration": 48, "trial_id": "ddfb6_00000", "date": "2024-03-07_12-55-40", "timestamp": 1709834140, "time_this_iter_s": 9.645290613174438, "time_total_s": 440.3652846813202, "pid": 112355, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4d85689f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 440.3652846813202, "iterations_since_restore": 48, "perf": {"cpu_util_percent": 29.358333333333338, "ram_util_percent": 52.30000000000001, "gpu_util_percent0": 0.09416666666666666, "vram_util_percent0": 0.12624782986111113}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.10000000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 0.03839706972802198, "policy_loss": -0.018887025197987916, "vf_loss": 0.056149232597841374, "vf_explained_var": 0.9563417146923722, "kl": 0.011348635112657334, "entropy": 0.3283542425722204, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 45105.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 196000, "num_env_steps_trained": 196000, "num_agent_steps_sampled": 196000, "num_agent_steps_trained": 196000}, "sampler_results": {"episode_reward_max": -1.5000000000000009, "episode_reward_min": -3.4000000000000012, "episode_reward_mean": -2.361206896551726, "episode_len_mean": 34.543103448275865, "episode_media": {}, "episodes_this_iter": 116, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2.0000000000000013, -2.0000000000000013, -2.900000000000002, -2.0000000000000013, -2.4000000000000017, -2.1000000000000014, -2.5000000000000018, -3.0000000000000018, -3.0000000000000018, -2.4000000000000017, -3.3000000000000007, -1.700000000000001, -1.700000000000001, -2.4000000000000017, -2.900000000000002, -3.4000000000000012, -1.9000000000000012, -2.600000000000002, -2.0000000000000013, -2.1000000000000014, -2.2000000000000015, -2.2000000000000015, -2.2000000000000015, -2.600000000000002, -2.0000000000000013, -1.8000000000000012, -2.5000000000000018, -2.1000000000000014, -2.700000000000002, -2.3000000000000016, -1.8000000000000012, -1.5000000000000009, -2.3000000000000016, -1.700000000000001, -2.4000000000000017, -2.5000000000000018, -2.2000000000000015, -1.8000000000000012, -3.1000000000000014, -2.900000000000002, -2.2000000000000015, -2.5000000000000018, -2.3000000000000016, -2.3000000000000016, -2.2000000000000015, -2.3000000000000016, -2.3000000000000016, -2.0000000000000013, -3.1000000000000014, -2.5000000000000018, -1.8000000000000012, -2.0000000000000013, -2.1000000000000014, -1.8000000000000012, -2.900000000000002, -2.700000000000002, -2.800000000000002, -1.8000000000000012, -2.700000000000002, -2.2000000000000015, -2.1000000000000014, -2.5000000000000018, -2.1000000000000014, -1.9000000000000012, -3.1000000000000014, -3.0000000000000018, -2.1000000000000014, -2.4000000000000017, -2.4000000000000017, -2.1000000000000014, -2.900000000000002, -2.600000000000002, -2.4000000000000017, -2.0000000000000013, -2.600000000000002, -2.2000000000000015, -2.4000000000000017, -2.700000000000002, -2.2000000000000015, -2.800000000000002, -2.4000000000000017, -2.600000000000002, -2.2000000000000015, -2.600000000000002, -2.5000000000000018, -2.1000000000000014, -2.600000000000002, -2.0000000000000013, -3.0000000000000018, -3.200000000000001, -2.5000000000000018, -2.2000000000000015, -2.800000000000002, -2.700000000000002, -2.1000000000000014, -1.700000000000001, -2.600000000000002, -2.800000000000002, -2.5000000000000018, -1.5000000000000009, -2.5000000000000018, -3.200000000000001, -3.0000000000000018, -3.200000000000001, -2.5000000000000018, -1.8000000000000012, -2.5000000000000018, -2.2000000000000015, -1.700000000000001, -1.9000000000000012, -2.3000000000000016, -2.5000000000000018, -1.600000000000001, -2.3000000000000016, -2.0000000000000013, -2.0000000000000013], "episode_lengths": [31, 31, 40, 31, 35, 32, 36, 41, 41, 35, 44, 28, 28, 35, 40, 44, 30, 37, 31, 32, 33, 33, 33, 37, 31, 29, 36, 32, 38, 34, 29, 26, 34, 28, 35, 36, 33, 29, 41, 40, 33, 36, 34, 34, 33, 34, 34, 30, 42, 36, 29, 31, 32, 29, 40, 36, 39, 29, 38, 33, 32, 36, 32, 30, 42, 41, 32, 35, 35, 32, 39, 37, 35, 31, 37, 33, 35, 38, 33, 39, 35, 37, 33, 37, 36, 32, 37, 31, 41, 43, 36, 33, 39, 38, 32, 28, 37, 39, 36, 26, 36, 43, 41, 43, 36, 29, 36, 33, 28, 30, 32, 36, 27, 34, 31, 31]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.30927105407371375, "mean_inference_ms": 0.7304314149968408, "mean_action_processing_ms": 0.07598183636359886, "mean_env_wait_ms": 6.76811417879862, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006827198225876381, "StateBufferConnector_ms": 0.003938633820106243, "ViewRequirementAgentConnector_ms": 0.09073923374044485}}, "episode_reward_max": -1.5000000000000009, "episode_reward_min": -3.4000000000000012, "episode_reward_mean": -2.361206896551726, "episode_len_mean": 34.543103448275865, "episodes_this_iter": 116, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-2.0000000000000013, -2.0000000000000013, -2.900000000000002, -2.0000000000000013, -2.4000000000000017, -2.1000000000000014, -2.5000000000000018, -3.0000000000000018, -3.0000000000000018, -2.4000000000000017, -3.3000000000000007, -1.700000000000001, -1.700000000000001, -2.4000000000000017, -2.900000000000002, -3.4000000000000012, -1.9000000000000012, -2.600000000000002, -2.0000000000000013, -2.1000000000000014, -2.2000000000000015, -2.2000000000000015, -2.2000000000000015, -2.600000000000002, -2.0000000000000013, -1.8000000000000012, -2.5000000000000018, -2.1000000000000014, -2.700000000000002, -2.3000000000000016, -1.8000000000000012, -1.5000000000000009, -2.3000000000000016, -1.700000000000001, -2.4000000000000017, -2.5000000000000018, -2.2000000000000015, -1.8000000000000012, -3.1000000000000014, -2.900000000000002, -2.2000000000000015, -2.5000000000000018, -2.3000000000000016, -2.3000000000000016, -2.2000000000000015, -2.3000000000000016, -2.3000000000000016, -2.0000000000000013, -3.1000000000000014, -2.5000000000000018, -1.8000000000000012, -2.0000000000000013, -2.1000000000000014, -1.8000000000000012, -2.900000000000002, -2.700000000000002, -2.800000000000002, -1.8000000000000012, -2.700000000000002, -2.2000000000000015, -2.1000000000000014, -2.5000000000000018, -2.1000000000000014, -1.9000000000000012, -3.1000000000000014, -3.0000000000000018, -2.1000000000000014, -2.4000000000000017, -2.4000000000000017, -2.1000000000000014, -2.900000000000002, -2.600000000000002, -2.4000000000000017, -2.0000000000000013, -2.600000000000002, -2.2000000000000015, -2.4000000000000017, -2.700000000000002, -2.2000000000000015, -2.800000000000002, -2.4000000000000017, -2.600000000000002, -2.2000000000000015, -2.600000000000002, -2.5000000000000018, -2.1000000000000014, -2.600000000000002, -2.0000000000000013, -3.0000000000000018, -3.200000000000001, -2.5000000000000018, -2.2000000000000015, -2.800000000000002, -2.700000000000002, -2.1000000000000014, -1.700000000000001, -2.600000000000002, -2.800000000000002, -2.5000000000000018, -1.5000000000000009, -2.5000000000000018, -3.200000000000001, -3.0000000000000018, -3.200000000000001, -2.5000000000000018, -1.8000000000000012, -2.5000000000000018, -2.2000000000000015, -1.700000000000001, -1.9000000000000012, -2.3000000000000016, -2.5000000000000018, -1.600000000000001, -2.3000000000000016, -2.0000000000000013, -2.0000000000000013], "episode_lengths": [31, 31, 40, 31, 35, 32, 36, 41, 41, 35, 44, 28, 28, 35, 40, 44, 30, 37, 31, 32, 33, 33, 33, 37, 31, 29, 36, 32, 38, 34, 29, 26, 34, 28, 35, 36, 33, 29, 41, 40, 33, 36, 34, 34, 33, 34, 34, 30, 42, 36, 29, 31, 32, 29, 40, 36, 39, 29, 38, 33, 32, 36, 32, 30, 42, 41, 32, 35, 35, 32, 39, 37, 35, 31, 37, 33, 35, 38, 33, 39, 35, 37, 33, 37, 36, 32, 37, 31, 41, 43, 36, 33, 39, 38, 32, 28, 37, 39, 36, 26, 36, 43, 41, 43, 36, 29, 36, 33, 28, 30, 32, 36, 27, 34, 31, 31]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.30927105407371375, "mean_inference_ms": 0.7304314149968408, "mean_action_processing_ms": 0.07598183636359886, "mean_env_wait_ms": 6.76811417879862, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006827198225876381, "StateBufferConnector_ms": 0.003938633820106243, "ViewRequirementAgentConnector_ms": 0.09073923374044485}, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 196000, "num_agent_steps_trained": 196000, "num_env_steps_sampled": 196000, "num_env_steps_trained": 196000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 419.6396743055762, "num_env_steps_trained_throughput_per_sec": 419.6396743055762, "timesteps_total": 196000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 196000, "timers": {"training_iteration_time_ms": 9498.183, "sample_time_ms": 5808.27, "load_time_ms": 1.011, "load_throughput": 3955677.74, "learn_time_ms": 3686.053, "learn_throughput": 1085.171, "synch_weights_time_ms": 2.2}, "counters": {"num_env_steps_sampled": 196000, "num_env_steps_trained": 196000, "num_agent_steps_sampled": 196000, "num_agent_steps_trained": 196000}, "done": false, "episodes_total": 2807, "training_iteration": 49, "trial_id": "ddfb6_00000", "date": "2024-03-07_12-55-49", "timestamp": 1709834149, "time_this_iter_s": 9.534694194793701, "time_total_s": 449.8999788761139, "pid": 112355, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4d85689f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 449.8999788761139, "iterations_since_restore": 49, "perf": {"cpu_util_percent": 28.03076923076923, "ram_util_percent": 52.21538461538463, "gpu_util_percent0": 0.11, "vram_util_percent0": 0.12508764022435895}}
{"evaluation": {"sampler_results": {"episode_reward_max": -1.4000000000000008, "episode_reward_min": -20.59999999999997, "episode_reward_mean": -3.1399999999999997, "episode_len_mean": 37.85, "episode_media": {}, "episodes_this_iter": 20, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2.5000000000000018, -2.1000000000000014, -2.600000000000002, -1.8000000000000012, -2.5000000000000018, -1.9000000000000012, -2.0000000000000013, -3.200000000000001, -2.0000000000000013, -2.700000000000002, -1.9000000000000012, -20.59999999999997, -2.0000000000000013, -2.900000000000002, -3.1000000000000014, -1.600000000000001, -1.600000000000001, -1.4000000000000008, -2.2000000000000015, -2.2000000000000015], "episode_lengths": [36, 32, 37, 29, 36, 30, 31, 43, 31, 38, 30, 126, 31, 40, 42, 27, 27, 25, 33, 33]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.33880789864975414, "mean_inference_ms": 1.2629843638880587, "mean_action_processing_ms": 0.07140825165922221, "mean_env_wait_ms": 6.928626025257765, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0055849552154541016, "StateBufferConnector_ms": 0.003107786178588867, "ViewRequirementAgentConnector_ms": 0.07170677185058594}}, "episode_reward_max": -1.4000000000000008, "episode_reward_min": -20.59999999999997, "episode_reward_mean": -3.1399999999999997, "episode_len_mean": 37.85, "episode_media": {}, "episodes_this_iter": 20, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2.5000000000000018, -2.1000000000000014, -2.600000000000002, -1.8000000000000012, -2.5000000000000018, -1.9000000000000012, -2.0000000000000013, -3.200000000000001, -2.0000000000000013, -2.700000000000002, -1.9000000000000012, -20.59999999999997, -2.0000000000000013, -2.900000000000002, -3.1000000000000014, -1.600000000000001, -1.600000000000001, -1.4000000000000008, -2.2000000000000015, -2.2000000000000015], "episode_lengths": [36, 32, 37, 29, 36, 30, 31, 43, 31, 38, 30, 126, 31, 40, 42, 27, 27, 25, 33, 33]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.33880789864975414, "mean_inference_ms": 1.2629843638880587, "mean_action_processing_ms": 0.07140825165922221, "mean_env_wait_ms": 6.928626025257765, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0055849552154541016, "StateBufferConnector_ms": 0.003107786178588867, "ViewRequirementAgentConnector_ms": 0.07170677185058594}, "num_agent_steps_sampled_this_iter": 757, "num_env_steps_sampled_this_iter": 757, "timesteps_this_iter": 757, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.10000000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 0.9831903047452841, "policy_loss": 0.003984314283376099, "vf_loss": 0.9782457162676159, "vf_explained_var": 0.7846688926860851, "kl": 0.00960267213343874, "entropy": 0.3707317819197973, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 46035.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 200000, "num_env_steps_trained": 200000, "num_agent_steps_sampled": 200000, "num_agent_steps_trained": 200000}, "sampler_results": {"episode_reward_max": -1.4000000000000008, "episode_reward_min": -3.8000000000000007, "episode_reward_mean": -2.154954954954956, "episode_len_mean": 32.3963963963964, "episode_media": {}, "episodes_this_iter": 111, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2.700000000000002, -2.2000000000000015, -1.4000000000000008, -2.1000000000000014, -2.0000000000000013, -2.2000000000000015, -2.1000000000000014, -1.700000000000001, -2.800000000000002, -2.2000000000000015, -1.700000000000001, -2.3000000000000016, -2.1000000000000014, -2.0000000000000013, -3.8000000000000007, -1.600000000000001, -2.2000000000000015, -2.1000000000000014, -1.700000000000001, -2.0000000000000013, -1.700000000000001, -1.8000000000000012, -2.1000000000000014, -2.700000000000002, -2.800000000000002, -1.8000000000000012, -2.0000000000000013, -1.9000000000000012, -2.4000000000000017, -2.1000000000000014, -1.4000000000000008, -2.1000000000000014, -1.700000000000001, -2.2000000000000015, -1.9000000000000012, -1.600000000000001, -2.1000000000000014, -1.9000000000000012, -1.9000000000000012, -3.3000000000000007, -1.700000000000001, -2.5000000000000018, -1.8000000000000012, -2.3000000000000016, -2.5000000000000018, -2.600000000000002, -1.700000000000001, -1.4000000000000008, -1.9000000000000012, -1.5000000000000009, -2.2000000000000015, -1.5000000000000009, -1.600000000000001, -2.5000000000000018, -3.0000000000000018, -2.5000000000000018, -2.3000000000000016, -2.0000000000000013, -2.4000000000000017, -1.9000000000000012, -2.3000000000000016, -2.3000000000000016, -2.5000000000000018, -2.600000000000002, -2.0000000000000013, -2.5000000000000018, -1.700000000000001, -1.8000000000000012, -2.1000000000000014, -2.800000000000002, -2.4000000000000017, -2.2000000000000015, -2.0000000000000013, -2.0000000000000013, -3.200000000000001, -1.5000000000000009, -2.5000000000000018, -2.700000000000002, -2.2000000000000015, -2.4000000000000017, -1.600000000000001, -1.9000000000000012, -2.2000000000000015, -2.600000000000002, -2.0000000000000013, -2.4000000000000017, -2.5000000000000018, -2.0000000000000013, -1.4000000000000008, -1.8000000000000012, -2.900000000000002, -1.5000000000000009, -2.3000000000000016, -1.8000000000000012, -2.600000000000002, -1.700000000000001, -2.1000000000000014, -2.700000000000002, -2.2000000000000015, -2.600000000000002, -2.4000000000000017, -2.3000000000000016, -1.5000000000000009, -2.0000000000000013, -1.700000000000001, -1.9000000000000012, -2.700000000000002, -1.600000000000001, -2.700000000000002, -2.1000000000000014, -3.700000000000003], "episode_lengths": [38, 33, 25, 32, 31, 33, 32, 28, 39, 33, 28, 34, 32, 31, 45, 27, 33, 32, 28, 31, 28, 29, 32, 38, 38, 29, 31, 30, 35, 32, 25, 32, 28, 33, 28, 27, 32, 30, 30, 44, 28, 36, 29, 34, 36, 37, 28, 25, 30, 26, 33, 26, 27, 36, 41, 36, 34, 31, 35, 30, 34, 34, 36, 37, 31, 36, 28, 29, 32, 39, 35, 33, 31, 31, 43, 26, 36, 38, 33, 35, 27, 30, 33, 37, 31, 35, 36, 31, 25, 29, 40, 26, 34, 29, 37, 28, 32, 38, 33, 37, 35, 34, 26, 31, 28, 30, 38, 27, 38, 32, 38]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3111471591287059, "mean_inference_ms": 0.7305502859955275, "mean_action_processing_ms": 0.07599323366601726, "mean_env_wait_ms": 6.776405156769508, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007018957052144919, "StateBufferConnector_ms": 0.00395474133190808, "ViewRequirementAgentConnector_ms": 0.09069335353267086}}, "episode_reward_max": -1.4000000000000008, "episode_reward_min": -3.8000000000000007, "episode_reward_mean": -2.154954954954956, "episode_len_mean": 32.3963963963964, "episodes_this_iter": 111, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-2.700000000000002, -2.2000000000000015, -1.4000000000000008, -2.1000000000000014, -2.0000000000000013, -2.2000000000000015, -2.1000000000000014, -1.700000000000001, -2.800000000000002, -2.2000000000000015, -1.700000000000001, -2.3000000000000016, -2.1000000000000014, -2.0000000000000013, -3.8000000000000007, -1.600000000000001, -2.2000000000000015, -2.1000000000000014, -1.700000000000001, -2.0000000000000013, -1.700000000000001, -1.8000000000000012, -2.1000000000000014, -2.700000000000002, -2.800000000000002, -1.8000000000000012, -2.0000000000000013, -1.9000000000000012, -2.4000000000000017, -2.1000000000000014, -1.4000000000000008, -2.1000000000000014, -1.700000000000001, -2.2000000000000015, -1.9000000000000012, -1.600000000000001, -2.1000000000000014, -1.9000000000000012, -1.9000000000000012, -3.3000000000000007, -1.700000000000001, -2.5000000000000018, -1.8000000000000012, -2.3000000000000016, -2.5000000000000018, -2.600000000000002, -1.700000000000001, -1.4000000000000008, -1.9000000000000012, -1.5000000000000009, -2.2000000000000015, -1.5000000000000009, -1.600000000000001, -2.5000000000000018, -3.0000000000000018, -2.5000000000000018, -2.3000000000000016, -2.0000000000000013, -2.4000000000000017, -1.9000000000000012, -2.3000000000000016, -2.3000000000000016, -2.5000000000000018, -2.600000000000002, -2.0000000000000013, -2.5000000000000018, -1.700000000000001, -1.8000000000000012, -2.1000000000000014, -2.800000000000002, -2.4000000000000017, -2.2000000000000015, -2.0000000000000013, -2.0000000000000013, -3.200000000000001, -1.5000000000000009, -2.5000000000000018, -2.700000000000002, -2.2000000000000015, -2.4000000000000017, -1.600000000000001, -1.9000000000000012, -2.2000000000000015, -2.600000000000002, -2.0000000000000013, -2.4000000000000017, -2.5000000000000018, -2.0000000000000013, -1.4000000000000008, -1.8000000000000012, -2.900000000000002, -1.5000000000000009, -2.3000000000000016, -1.8000000000000012, -2.600000000000002, -1.700000000000001, -2.1000000000000014, -2.700000000000002, -2.2000000000000015, -2.600000000000002, -2.4000000000000017, -2.3000000000000016, -1.5000000000000009, -2.0000000000000013, -1.700000000000001, -1.9000000000000012, -2.700000000000002, -1.600000000000001, -2.700000000000002, -2.1000000000000014, -3.700000000000003], "episode_lengths": [38, 33, 25, 32, 31, 33, 32, 28, 39, 33, 28, 34, 32, 31, 45, 27, 33, 32, 28, 31, 28, 29, 32, 38, 38, 29, 31, 30, 35, 32, 25, 32, 28, 33, 28, 27, 32, 30, 30, 44, 28, 36, 29, 34, 36, 37, 28, 25, 30, 26, 33, 26, 27, 36, 41, 36, 34, 31, 35, 30, 34, 34, 36, 37, 31, 36, 28, 29, 32, 39, 35, 33, 31, 31, 43, 26, 36, 38, 33, 35, 27, 30, 33, 37, 31, 35, 36, 31, 25, 29, 40, 26, 34, 29, 37, 28, 32, 38, 33, 37, 35, 34, 26, 31, 28, 30, 38, 27, 38, 32, 38]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3111471591287059, "mean_inference_ms": 0.7305502859955275, "mean_action_processing_ms": 0.07599323366601726, "mean_env_wait_ms": 6.776405156769508, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007018957052144919, "StateBufferConnector_ms": 0.00395474133190808, "ViewRequirementAgentConnector_ms": 0.09069335353267086}, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 200000, "num_agent_steps_trained": 200000, "num_env_steps_sampled": 200000, "num_env_steps_trained": 200000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 419.0344124802062, "num_env_steps_trained_throughput_per_sec": 419.0344124802062, "timesteps_total": 200000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 200000, "timers": {"training_iteration_time_ms": 9518.69, "sample_time_ms": 5823.737, "load_time_ms": 1.012, "load_throughput": 3951112.995, "learn_time_ms": 3691.105, "learn_throughput": 1083.686, "synch_weights_time_ms": 2.193}, "counters": {"num_env_steps_sampled": 200000, "num_env_steps_trained": 200000, "num_agent_steps_sampled": 200000, "num_agent_steps_trained": 200000}, "done": false, "episodes_total": 2918, "training_iteration": 50, "trial_id": "ddfb6_00000", "date": "2024-03-07_12-56-05", "timestamp": 1709834165, "time_this_iter_s": 16.08314347267151, "time_total_s": 465.9831223487854, "pid": 112355, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4d85689f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 465.9831223487854, "iterations_since_restore": 50, "perf": {"cpu_util_percent": 20.345, "ram_util_percent": 52.084999999999994, "gpu_util_percent0": 0.08700000000000001, "vram_util_percent0": 0.1239420572916667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.10000000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 0.41560245806680524, "policy_loss": -0.011610697682506294, "vf_loss": 0.4263049867735194, "vf_explained_var": 0.8294801395426514, "kl": 0.009081720956872907, "entropy": 0.35644576257915905, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 46965.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 204000, "num_env_steps_trained": 204000, "num_agent_steps_sampled": 204000, "num_agent_steps_trained": 204000}, "sampler_results": {"episode_reward_max": -1.5000000000000009, "episode_reward_min": -75.50000000000053, "episode_reward_mean": -3.1570175438596553, "episode_len_mean": 37.8421052631579, "episode_media": {}, "episodes_this_iter": 114, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2.2000000000000015, -2.3000000000000016, -1.8000000000000012, -2.0000000000000013, -2.900000000000002, -2.0000000000000013, -1.8000000000000012, -2.5000000000000018, -2.1000000000000014, -1.5000000000000009, -2.5000000000000018, -2.0000000000000013, -2.0000000000000013, -2.5000000000000018, -2.0000000000000013, -3.1000000000000014, -2.0000000000000013, -1.600000000000001, -2.800000000000002, -2.1000000000000014, -2.2000000000000015, -75.50000000000053, -2.1000000000000014, -2.0000000000000013, -3.200000000000001, -1.700000000000001, -2.4000000000000017, -2.4000000000000017, -2.5000000000000018, -3.0000000000000018, -2.600000000000002, -1.8000000000000012, -2.0000000000000013, -1.700000000000001, -2.0000000000000013, -2.2000000000000015, -2.4000000000000017, -2.700000000000002, -1.8000000000000012, -2.1000000000000014, -2.0000000000000013, -2.600000000000002, -2.0000000000000013, -1.600000000000001, -2.1000000000000014, -2.700000000000002, -2.4000000000000017, -2.3000000000000016, -2.700000000000002, -2.2000000000000015, -3.200000000000001, -2.700000000000002, -2.5000000000000018, -2.1000000000000014, -2.600000000000002, -2.600000000000002, -1.5000000000000009, -2.1000000000000014, -2.1000000000000014, -1.600000000000001, -2.3000000000000016, -2.600000000000002, -1.9000000000000012, -2.1000000000000014, -1.8000000000000012, -1.700000000000001, -2.900000000000002, -2.4000000000000017, -2.700000000000002, -1.700000000000001, -2.4000000000000017, -2.1000000000000014, -2.3000000000000016, -2.3000000000000016, -2.600000000000002, -2.1000000000000014, -1.9000000000000012, -2.5000000000000018, -3.0000000000000018, -1.600000000000001, -2.800000000000002, -2.0000000000000013, -1.8000000000000012, -1.700000000000001, -2.2000000000000015, -2.4000000000000017, -1.9000000000000012, -2.0000000000000013, -1.9000000000000012, -2.1000000000000014, -1.8000000000000012, -2.600000000000002, -1.600000000000001, -2.5000000000000018, -1.600000000000001, -2.4000000000000017, -2.700000000000002, -2.1000000000000014, -2.4000000000000017, -2.3000000000000016, -1.5000000000000009, -1.9000000000000012, -2.2000000000000015, -2.0000000000000013, -2.5000000000000018, -2.0000000000000013, -2.800000000000002, -2.2000000000000015, -2.700000000000002, -1.700000000000001, -37.00000000000002, -2.0000000000000013, -2.2000000000000015, -1.9000000000000012], "episode_lengths": [33, 34, 29, 31, 40, 31, 29, 36, 32, 26, 36, 31, 31, 36, 31, 37, 31, 27, 39, 32, 33, 400, 32, 31, 43, 28, 35, 35, 36, 41, 37, 29, 31, 28, 31, 33, 35, 38, 29, 32, 31, 37, 31, 27, 32, 38, 35, 34, 38, 33, 42, 38, 36, 32, 37, 34, 26, 32, 32, 27, 34, 37, 30, 32, 29, 28, 40, 35, 38, 28, 35, 32, 34, 34, 37, 32, 30, 36, 41, 27, 39, 31, 29, 28, 33, 35, 30, 31, 30, 30, 29, 37, 27, 35, 27, 35, 38, 32, 35, 34, 26, 30, 33, 31, 36, 31, 39, 33, 38, 28, 220, 31, 33, 30]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.31296405807752226, "mean_inference_ms": 0.7302959191033213, "mean_action_processing_ms": 0.07595367394349765, "mean_env_wait_ms": 6.790398995037815, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007044641595137746, "StateBufferConnector_ms": 0.0039489645706979855, "ViewRequirementAgentConnector_ms": 0.0906707947714287}}, "episode_reward_max": -1.5000000000000009, "episode_reward_min": -75.50000000000053, "episode_reward_mean": -3.1570175438596553, "episode_len_mean": 37.8421052631579, "episodes_this_iter": 114, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-2.2000000000000015, -2.3000000000000016, -1.8000000000000012, -2.0000000000000013, -2.900000000000002, -2.0000000000000013, -1.8000000000000012, -2.5000000000000018, -2.1000000000000014, -1.5000000000000009, -2.5000000000000018, -2.0000000000000013, -2.0000000000000013, -2.5000000000000018, -2.0000000000000013, -3.1000000000000014, -2.0000000000000013, -1.600000000000001, -2.800000000000002, -2.1000000000000014, -2.2000000000000015, -75.50000000000053, -2.1000000000000014, -2.0000000000000013, -3.200000000000001, -1.700000000000001, -2.4000000000000017, -2.4000000000000017, -2.5000000000000018, -3.0000000000000018, -2.600000000000002, -1.8000000000000012, -2.0000000000000013, -1.700000000000001, -2.0000000000000013, -2.2000000000000015, -2.4000000000000017, -2.700000000000002, -1.8000000000000012, -2.1000000000000014, -2.0000000000000013, -2.600000000000002, -2.0000000000000013, -1.600000000000001, -2.1000000000000014, -2.700000000000002, -2.4000000000000017, -2.3000000000000016, -2.700000000000002, -2.2000000000000015, -3.200000000000001, -2.700000000000002, -2.5000000000000018, -2.1000000000000014, -2.600000000000002, -2.600000000000002, -1.5000000000000009, -2.1000000000000014, -2.1000000000000014, -1.600000000000001, -2.3000000000000016, -2.600000000000002, -1.9000000000000012, -2.1000000000000014, -1.8000000000000012, -1.700000000000001, -2.900000000000002, -2.4000000000000017, -2.700000000000002, -1.700000000000001, -2.4000000000000017, -2.1000000000000014, -2.3000000000000016, -2.3000000000000016, -2.600000000000002, -2.1000000000000014, -1.9000000000000012, -2.5000000000000018, -3.0000000000000018, -1.600000000000001, -2.800000000000002, -2.0000000000000013, -1.8000000000000012, -1.700000000000001, -2.2000000000000015, -2.4000000000000017, -1.9000000000000012, -2.0000000000000013, -1.9000000000000012, -2.1000000000000014, -1.8000000000000012, -2.600000000000002, -1.600000000000001, -2.5000000000000018, -1.600000000000001, -2.4000000000000017, -2.700000000000002, -2.1000000000000014, -2.4000000000000017, -2.3000000000000016, -1.5000000000000009, -1.9000000000000012, -2.2000000000000015, -2.0000000000000013, -2.5000000000000018, -2.0000000000000013, -2.800000000000002, -2.2000000000000015, -2.700000000000002, -1.700000000000001, -37.00000000000002, -2.0000000000000013, -2.2000000000000015, -1.9000000000000012], "episode_lengths": [33, 34, 29, 31, 40, 31, 29, 36, 32, 26, 36, 31, 31, 36, 31, 37, 31, 27, 39, 32, 33, 400, 32, 31, 43, 28, 35, 35, 36, 41, 37, 29, 31, 28, 31, 33, 35, 38, 29, 32, 31, 37, 31, 27, 32, 38, 35, 34, 38, 33, 42, 38, 36, 32, 37, 34, 26, 32, 32, 27, 34, 37, 30, 32, 29, 28, 40, 35, 38, 28, 35, 32, 34, 34, 37, 32, 30, 36, 41, 27, 39, 31, 29, 28, 33, 35, 30, 31, 30, 30, 29, 37, 27, 35, 27, 35, 38, 32, 35, 34, 26, 30, 33, 31, 36, 31, 39, 33, 38, 28, 220, 31, 33, 30]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.31296405807752226, "mean_inference_ms": 0.7302959191033213, "mean_action_processing_ms": 0.07595367394349765, "mean_env_wait_ms": 6.790398995037815, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007044641595137746, "StateBufferConnector_ms": 0.0039489645706979855, "ViewRequirementAgentConnector_ms": 0.0906707947714287}, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 204000, "num_agent_steps_trained": 204000, "num_env_steps_sampled": 204000, "num_env_steps_trained": 204000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 414.81595619212214, "num_env_steps_trained_throughput_per_sec": 414.81595619212214, "timesteps_total": 204000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 204000, "timers": {"training_iteration_time_ms": 9548.289, "sample_time_ms": 5853.86, "load_time_ms": 1.01, "load_throughput": 3958477.692, "learn_time_ms": 3690.596, "learn_throughput": 1083.836, "synch_weights_time_ms": 2.178}, "counters": {"num_env_steps_sampled": 204000, "num_env_steps_trained": 204000, "num_agent_steps_sampled": 204000, "num_agent_steps_trained": 204000}, "done": false, "episodes_total": 3032, "training_iteration": 51, "trial_id": "ddfb6_00000", "date": "2024-03-07_12-56-15", "timestamp": 1709834175, "time_this_iter_s": 9.645851373672485, "time_total_s": 475.6289737224579, "pid": 112355, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4d85689f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 475.6289737224579, "iterations_since_restore": 51, "perf": {"cpu_util_percent": 27.37692307692308, "ram_util_percent": 51.92307692307691, "gpu_util_percent0": 0.11999999999999998, "vram_util_percent0": 0.12225185296474361}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.10000000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 1.5388068200680503, "policy_loss": -0.009559697113049928, "vf_loss": 1.546441726549779, "vf_explained_var": 0.5961446243588643, "kl": 0.01924791820120638, "entropy": 0.43578129942699145, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 47895.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 208000, "num_env_steps_trained": 208000, "num_agent_steps_sampled": 208000, "num_agent_steps_trained": 208000}, "sampler_results": {"episode_reward_max": -1.5000000000000009, "episode_reward_min": -70.50000000000045, "episode_reward_mean": -3.621000000000004, "episode_len_mean": 41.22, "episode_media": {}, "episodes_this_iter": 97, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2.0000000000000013, -2.2000000000000015, -1.9000000000000012, -2.2000000000000015, -2.0000000000000013, -2.4000000000000017, -2.0000000000000013, -1.8000000000000012, -2.5000000000000018, -2.0000000000000013, -2.0000000000000013, -2.0000000000000013, -2.5000000000000018, -1.8000000000000012, -2.4000000000000017, -2.4000000000000017, -3.0000000000000018, -3.1000000000000014, -2.1000000000000014, -1.9000000000000012, -1.8000000000000012, -2.5000000000000018, -1.5000000000000009, -1.9000000000000012, -2.700000000000002, -1.5000000000000009, -2.4000000000000017, -2.1000000000000014, -29.399999999999935, -1.9000000000000012, -2.700000000000002, -1.9000000000000012, -2.5000000000000018, -1.600000000000001, -3.0000000000000018, -2.3000000000000016, -2.700000000000002, -2.0000000000000013, -2.5000000000000018, -70.50000000000045, -24.599999999999945, -3.200000000000001, -2.4000000000000017, -1.600000000000001, -2.5000000000000018, -2.800000000000002, -2.0000000000000013, -2.4000000000000017, -1.8000000000000012, -2.700000000000002, -1.600000000000001, -2.5000000000000018, -1.8000000000000012, -1.700000000000001, -2.3000000000000016, -2.5000000000000018, -3.0000000000000018, -2.2000000000000015, -2.3000000000000016, -1.600000000000001, -2.1000000000000014, -2.600000000000002, -2.3000000000000016, -2.5000000000000018, -2.3000000000000016, -2.4000000000000017, -2.3000000000000016, -2.2000000000000015, -2.800000000000002, -2.600000000000002, -2.4000000000000017, -1.9000000000000012, -2.3000000000000016, -2.5000000000000018, -2.700000000000002, -2.4000000000000017, -2.600000000000002, -2.600000000000002, -3.1000000000000014, -2.5000000000000018, -2.2000000000000015, -2.600000000000002, -2.700000000000002, -2.800000000000002, -3.0000000000000018, -1.9000000000000012, -2.1000000000000014, -1.8000000000000012, -2.4000000000000017, -1.5000000000000009, -1.8000000000000012, -1.700000000000001, -2.600000000000002, -2.0000000000000013, -2.5000000000000018, -18.7, -2.900000000000002, -2.2000000000000015, -2.4000000000000017, -2.1000000000000014], "episode_lengths": [31, 33, 30, 33, 31, 35, 31, 29, 36, 31, 31, 31, 36, 29, 35, 35, 41, 42, 32, 30, 29, 36, 26, 30, 38, 26, 35, 32, 174, 30, 38, 30, 36, 27, 41, 34, 38, 31, 36, 400, 149, 43, 35, 27, 36, 39, 31, 35, 29, 38, 27, 36, 29, 28, 34, 36, 41, 33, 34, 27, 32, 37, 34, 36, 34, 35, 34, 33, 39, 37, 35, 30, 34, 36, 38, 35, 37, 37, 42, 36, 33, 37, 38, 39, 41, 30, 32, 29, 35, 26, 29, 28, 37, 31, 36, 154, 40, 33, 35, 32]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.31351273446821176, "mean_inference_ms": 0.7305316123221879, "mean_action_processing_ms": 0.07587428939589966, "mean_env_wait_ms": 6.792629593615953, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00706028938293457, "StateBufferConnector_ms": 0.0041103363037109375, "ViewRequirementAgentConnector_ms": 0.09316849708557129}}, "episode_reward_max": -1.5000000000000009, "episode_reward_min": -70.50000000000045, "episode_reward_mean": -3.621000000000004, "episode_len_mean": 41.22, "episodes_this_iter": 97, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-2.0000000000000013, -2.2000000000000015, -1.9000000000000012, -2.2000000000000015, -2.0000000000000013, -2.4000000000000017, -2.0000000000000013, -1.8000000000000012, -2.5000000000000018, -2.0000000000000013, -2.0000000000000013, -2.0000000000000013, -2.5000000000000018, -1.8000000000000012, -2.4000000000000017, -2.4000000000000017, -3.0000000000000018, -3.1000000000000014, -2.1000000000000014, -1.9000000000000012, -1.8000000000000012, -2.5000000000000018, -1.5000000000000009, -1.9000000000000012, -2.700000000000002, -1.5000000000000009, -2.4000000000000017, -2.1000000000000014, -29.399999999999935, -1.9000000000000012, -2.700000000000002, -1.9000000000000012, -2.5000000000000018, -1.600000000000001, -3.0000000000000018, -2.3000000000000016, -2.700000000000002, -2.0000000000000013, -2.5000000000000018, -70.50000000000045, -24.599999999999945, -3.200000000000001, -2.4000000000000017, -1.600000000000001, -2.5000000000000018, -2.800000000000002, -2.0000000000000013, -2.4000000000000017, -1.8000000000000012, -2.700000000000002, -1.600000000000001, -2.5000000000000018, -1.8000000000000012, -1.700000000000001, -2.3000000000000016, -2.5000000000000018, -3.0000000000000018, -2.2000000000000015, -2.3000000000000016, -1.600000000000001, -2.1000000000000014, -2.600000000000002, -2.3000000000000016, -2.5000000000000018, -2.3000000000000016, -2.4000000000000017, -2.3000000000000016, -2.2000000000000015, -2.800000000000002, -2.600000000000002, -2.4000000000000017, -1.9000000000000012, -2.3000000000000016, -2.5000000000000018, -2.700000000000002, -2.4000000000000017, -2.600000000000002, -2.600000000000002, -3.1000000000000014, -2.5000000000000018, -2.2000000000000015, -2.600000000000002, -2.700000000000002, -2.800000000000002, -3.0000000000000018, -1.9000000000000012, -2.1000000000000014, -1.8000000000000012, -2.4000000000000017, -1.5000000000000009, -1.8000000000000012, -1.700000000000001, -2.600000000000002, -2.0000000000000013, -2.5000000000000018, -18.7, -2.900000000000002, -2.2000000000000015, -2.4000000000000017, -2.1000000000000014], "episode_lengths": [31, 33, 30, 33, 31, 35, 31, 29, 36, 31, 31, 31, 36, 29, 35, 35, 41, 42, 32, 30, 29, 36, 26, 30, 38, 26, 35, 32, 174, 30, 38, 30, 36, 27, 41, 34, 38, 31, 36, 400, 149, 43, 35, 27, 36, 39, 31, 35, 29, 38, 27, 36, 29, 28, 34, 36, 41, 33, 34, 27, 32, 37, 34, 36, 34, 35, 34, 33, 39, 37, 35, 30, 34, 36, 38, 35, 37, 37, 42, 36, 33, 37, 38, 39, 41, 30, 32, 29, 35, 26, 29, 28, 37, 31, 36, 154, 40, 33, 35, 32]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.31351273446821176, "mean_inference_ms": 0.7305316123221879, "mean_action_processing_ms": 0.07587428939589966, "mean_env_wait_ms": 6.792629593615953, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00706028938293457, "StateBufferConnector_ms": 0.0041103363037109375, "ViewRequirementAgentConnector_ms": 0.09316849708557129}, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 208000, "num_agent_steps_trained": 208000, "num_env_steps_sampled": 208000, "num_env_steps_trained": 208000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 407.29887076221445, "num_env_steps_trained_throughput_per_sec": 407.29887076221445, "timesteps_total": 208000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 208000, "timers": {"training_iteration_time_ms": 9575.489, "sample_time_ms": 5852.341, "load_time_ms": 1.009, "load_throughput": 3964370.51, "learn_time_ms": 3719.312, "learn_throughput": 1075.468, "synch_weights_time_ms": 2.181}, "counters": {"num_env_steps_sampled": 208000, "num_env_steps_trained": 208000, "num_agent_steps_sampled": 208000, "num_agent_steps_trained": 208000}, "done": false, "episodes_total": 3129, "training_iteration": 52, "trial_id": "ddfb6_00000", "date": "2024-03-07_12-56-25", "timestamp": 1709834185, "time_this_iter_s": 9.823574304580688, "time_total_s": 485.4525480270386, "pid": 112355, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4d85689f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 485.4525480270386, "iterations_since_restore": 52, "perf": {"cpu_util_percent": 30.699999999999992, "ram_util_percent": 52.08333333333332, "gpu_util_percent0": 0.11166666666666668, "vram_util_percent0": 0.12284342447916669}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.10000000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 0.11347656762008355, "policy_loss": -0.007904870032022396, "vf_loss": 0.12064993434876044, "vf_explained_var": 0.8170812488884054, "kl": 0.007315039965564093, "entropy": 0.37741612359400717, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 48825.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 212000, "num_env_steps_trained": 212000, "num_agent_steps_sampled": 212000, "num_agent_steps_trained": 212000}, "sampler_results": {"episode_reward_max": -1.5000000000000009, "episode_reward_min": -4.200000000000003, "episode_reward_mean": -2.5026548672566387, "episode_len_mean": 35.78761061946903, "episode_media": {}, "episodes_this_iter": 113, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.200000000000001, -2.3000000000000016, -2.0000000000000013, -3.5999999999999996, -2.700000000000002, -2.800000000000002, -2.4000000000000017, -2.600000000000002, -2.5000000000000018, -1.700000000000001, -2.1000000000000014, -2.4000000000000017, -3.0000000000000018, -3.5, -3.1000000000000014, -2.1000000000000014, -1.5000000000000009, -2.4000000000000017, -1.700000000000001, -2.5000000000000018, -2.2000000000000015, -2.4000000000000017, -3.6000000000000014, -2.800000000000002, -2.700000000000002, -2.4000000000000017, -2.5000000000000018, -2.800000000000002, -3.1000000000000014, -1.700000000000001, -2.2000000000000015, -2.600000000000002, -3.0000000000000018, -2.1000000000000014, -2.2000000000000015, -3.0000000000000018, -2.3000000000000016, -1.8000000000000012, -1.8000000000000012, -2.4000000000000017, -2.3000000000000016, -2.4000000000000017, -2.600000000000002, -2.4000000000000017, -1.8000000000000012, -3.0000000000000018, -2.2000000000000015, -2.1000000000000014, -1.700000000000001, -2.0000000000000013, -2.800000000000002, -2.600000000000002, -2.2000000000000015, -2.4000000000000017, -2.5000000000000018, -2.2000000000000015, -2.5000000000000018, -2.700000000000002, -2.800000000000002, -3.4000000000000004, -2.900000000000002, -3.1000000000000014, -3.4000000000000004, -2.4000000000000017, -2.3000000000000016, -1.9000000000000012, -2.5000000000000018, -2.5000000000000018, -1.9000000000000012, -2.800000000000002, -2.5000000000000018, -2.3000000000000016, -1.5000000000000009, -2.800000000000002, -1.700000000000001, -2.3000000000000016, -2.5000000000000018, -2.1000000000000014, -2.2000000000000015, -4.1999999999999975, -2.5000000000000018, -3.1000000000000014, -2.2000000000000015, -4.200000000000003, -1.600000000000001, -3.5, -2.5000000000000018, -3.0000000000000018, -2.5000000000000018, -2.3000000000000016, -2.4000000000000017, -2.900000000000002, -2.4000000000000017, -2.4000000000000017, -1.9000000000000012, -2.600000000000002, -2.3000000000000016, -3.0000000000000018, -2.900000000000002, -2.600000000000002, -2.2000000000000015, -2.700000000000002, -2.0000000000000013, -2.0000000000000013, -3.200000000000001, -2.3000000000000016, -2.2000000000000015, -2.5000000000000018, -2.5000000000000018, -3.0000000000000018, -2.3000000000000016, -2.2000000000000015, -2.800000000000002], "episode_lengths": [43, 34, 31, 47, 38, 39, 35, 34, 36, 28, 32, 35, 39, 46, 42, 32, 26, 35, 28, 36, 33, 35, 44, 36, 38, 35, 36, 39, 42, 28, 33, 37, 41, 32, 33, 41, 34, 29, 29, 35, 34, 35, 37, 35, 29, 38, 33, 32, 28, 31, 39, 37, 33, 35, 36, 33, 36, 38, 39, 45, 40, 42, 45, 35, 34, 30, 36, 36, 30, 39, 36, 34, 26, 39, 28, 34, 36, 32, 33, 53, 36, 42, 33, 43, 27, 46, 36, 41, 36, 34, 35, 40, 35, 35, 30, 37, 34, 41, 40, 37, 33, 38, 31, 31, 43, 34, 33, 33, 36, 41, 34, 33, 39]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.31590753500588026, "mean_inference_ms": 0.7308470422447808, "mean_action_processing_ms": 0.07599987162543911, "mean_env_wait_ms": 6.813848844236002, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007102130788617429, "StateBufferConnector_ms": 0.003956271483834866, "ViewRequirementAgentConnector_ms": 0.0905484224842713}}, "episode_reward_max": -1.5000000000000009, "episode_reward_min": -4.200000000000003, "episode_reward_mean": -2.5026548672566387, "episode_len_mean": 35.78761061946903, "episodes_this_iter": 113, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3.200000000000001, -2.3000000000000016, -2.0000000000000013, -3.5999999999999996, -2.700000000000002, -2.800000000000002, -2.4000000000000017, -2.600000000000002, -2.5000000000000018, -1.700000000000001, -2.1000000000000014, -2.4000000000000017, -3.0000000000000018, -3.5, -3.1000000000000014, -2.1000000000000014, -1.5000000000000009, -2.4000000000000017, -1.700000000000001, -2.5000000000000018, -2.2000000000000015, -2.4000000000000017, -3.6000000000000014, -2.800000000000002, -2.700000000000002, -2.4000000000000017, -2.5000000000000018, -2.800000000000002, -3.1000000000000014, -1.700000000000001, -2.2000000000000015, -2.600000000000002, -3.0000000000000018, -2.1000000000000014, -2.2000000000000015, -3.0000000000000018, -2.3000000000000016, -1.8000000000000012, -1.8000000000000012, -2.4000000000000017, -2.3000000000000016, -2.4000000000000017, -2.600000000000002, -2.4000000000000017, -1.8000000000000012, -3.0000000000000018, -2.2000000000000015, -2.1000000000000014, -1.700000000000001, -2.0000000000000013, -2.800000000000002, -2.600000000000002, -2.2000000000000015, -2.4000000000000017, -2.5000000000000018, -2.2000000000000015, -2.5000000000000018, -2.700000000000002, -2.800000000000002, -3.4000000000000004, -2.900000000000002, -3.1000000000000014, -3.4000000000000004, -2.4000000000000017, -2.3000000000000016, -1.9000000000000012, -2.5000000000000018, -2.5000000000000018, -1.9000000000000012, -2.800000000000002, -2.5000000000000018, -2.3000000000000016, -1.5000000000000009, -2.800000000000002, -1.700000000000001, -2.3000000000000016, -2.5000000000000018, -2.1000000000000014, -2.2000000000000015, -4.1999999999999975, -2.5000000000000018, -3.1000000000000014, -2.2000000000000015, -4.200000000000003, -1.600000000000001, -3.5, -2.5000000000000018, -3.0000000000000018, -2.5000000000000018, -2.3000000000000016, -2.4000000000000017, -2.900000000000002, -2.4000000000000017, -2.4000000000000017, -1.9000000000000012, -2.600000000000002, -2.3000000000000016, -3.0000000000000018, -2.900000000000002, -2.600000000000002, -2.2000000000000015, -2.700000000000002, -2.0000000000000013, -2.0000000000000013, -3.200000000000001, -2.3000000000000016, -2.2000000000000015, -2.5000000000000018, -2.5000000000000018, -3.0000000000000018, -2.3000000000000016, -2.2000000000000015, -2.800000000000002], "episode_lengths": [43, 34, 31, 47, 38, 39, 35, 34, 36, 28, 32, 35, 39, 46, 42, 32, 26, 35, 28, 36, 33, 35, 44, 36, 38, 35, 36, 39, 42, 28, 33, 37, 41, 32, 33, 41, 34, 29, 29, 35, 34, 35, 37, 35, 29, 38, 33, 32, 28, 31, 39, 37, 33, 35, 36, 33, 36, 38, 39, 45, 40, 42, 45, 35, 34, 30, 36, 36, 30, 39, 36, 34, 26, 39, 28, 34, 36, 32, 33, 53, 36, 42, 33, 43, 27, 46, 36, 41, 36, 34, 35, 40, 35, 35, 30, 37, 34, 41, 40, 37, 33, 38, 31, 31, 43, 34, 33, 33, 36, 41, 34, 33, 39]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.31590753500588026, "mean_inference_ms": 0.7308470422447808, "mean_action_processing_ms": 0.07599987162543911, "mean_env_wait_ms": 6.813848844236002, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007102130788617429, "StateBufferConnector_ms": 0.003956271483834866, "ViewRequirementAgentConnector_ms": 0.0905484224842713}, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 212000, "num_agent_steps_trained": 212000, "num_env_steps_sampled": 212000, "num_env_steps_trained": 212000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 418.032166011126, "num_env_steps_trained_throughput_per_sec": 418.032166011126, "timesteps_total": 212000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 212000, "timers": {"training_iteration_time_ms": 9600.177, "sample_time_ms": 5859.63, "load_time_ms": 1.011, "load_throughput": 3957824.015, "learn_time_ms": 3736.765, "learn_throughput": 1070.445, "synch_weights_time_ms": 2.129}, "counters": {"num_env_steps_sampled": 212000, "num_env_steps_trained": 212000, "num_agent_steps_sampled": 212000, "num_agent_steps_trained": 212000}, "done": false, "episodes_total": 3242, "training_iteration": 53, "trial_id": "ddfb6_00000", "date": "2024-03-07_12-56-34", "timestamp": 1709834194, "time_this_iter_s": 9.571695804595947, "time_total_s": 495.0242438316345, "pid": 112355, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4d85689f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 495.0242438316345, "iterations_since_restore": 53, "perf": {"cpu_util_percent": 27.261538461538464, "ram_util_percent": 52.29999999999999, "gpu_util_percent0": 0.10461538461538461, "vram_util_percent0": 0.122715094150641}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.10000000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 0.11499732866719295, "policy_loss": -0.01138364229030827, "vf_loss": 0.1253946350689637, "vf_explained_var": 0.9396792749563853, "kl": 0.009863340832675677, "entropy": 0.3604953354725274, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 49755.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 216000, "num_env_steps_trained": 216000, "num_agent_steps_sampled": 216000, "num_agent_steps_trained": 216000}, "sampler_results": {"episode_reward_max": -1.600000000000001, "episode_reward_min": -6.800000000000005, "episode_reward_mean": -2.443362831858409, "episode_len_mean": 35.08849557522124, "episode_media": {}, "episodes_this_iter": 113, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.1000000000000014, -1.8000000000000012, -3.0000000000000018, -2.900000000000002, -2.1000000000000014, -2.3000000000000016, -2.4000000000000017, -2.5000000000000018, -2.0000000000000013, -2.600000000000002, -1.8000000000000012, -6.800000000000005, -2.2000000000000015, -2.1000000000000014, -1.9000000000000012, -2.4000000000000017, -3.3000000000000007, -2.5000000000000018, -2.0000000000000013, -2.800000000000002, -2.600000000000002, -2.800000000000002, -2.900000000000002, -3.1000000000000014, -2.700000000000002, -2.4000000000000017, -3.3000000000000016, -2.0000000000000013, -3.5, -3.1000000000000014, -2.0000000000000013, -2.600000000000002, -2.800000000000002, -2.4000000000000017, -3.1000000000000014, -2.1000000000000014, -2.800000000000002, -2.4000000000000017, -2.3000000000000016, -2.800000000000002, -2.4000000000000017, -2.0000000000000013, -3.1000000000000014, -2.2000000000000015, -2.2000000000000015, -2.2000000000000015, -2.1000000000000014, -2.1000000000000014, -2.4000000000000017, -1.9000000000000012, -1.9000000000000012, -2.0000000000000013, -2.0000000000000013, -2.3000000000000016, -1.700000000000001, -2.2000000000000015, -3.0000000000000018, -2.0000000000000013, -2.4000000000000017, -2.2000000000000015, -2.4000000000000017, -1.9000000000000012, -1.9000000000000012, -1.700000000000001, -2.2000000000000015, -2.600000000000002, -2.4000000000000017, -2.4000000000000017, -2.600000000000002, -2.3000000000000016, -1.8000000000000012, -2.600000000000002, -2.5000000000000018, -2.800000000000002, -2.3000000000000016, -2.4000000000000017, -2.3000000000000016, -2.5000000000000018, -2.5000000000000018, -2.900000000000002, -3.1000000000000014, -2.700000000000002, -1.8000000000000012, -2.600000000000002, -1.9000000000000012, -2.1000000000000014, -2.2000000000000015, -2.2000000000000015, -2.4000000000000017, -2.900000000000002, -2.600000000000002, -2.600000000000002, -2.4000000000000017, -2.0000000000000013, -1.8000000000000012, -2.5000000000000018, -1.9000000000000012, -3.4000000000000004, -3.1000000000000014, -2.1000000000000014, -2.1000000000000014, -1.8000000000000012, -2.700000000000002, -3.0000000000000018, -2.600000000000002, -2.2000000000000015, -2.3000000000000016, -2.3000000000000016, -2.2000000000000015, -2.700000000000002, -2.600000000000002, -1.600000000000001, -2.2000000000000015], "episode_lengths": [37, 29, 41, 40, 32, 34, 35, 36, 31, 37, 29, 48, 33, 32, 30, 35, 44, 36, 31, 39, 37, 39, 40, 42, 38, 35, 43, 31, 46, 42, 31, 37, 39, 35, 42, 32, 39, 35, 34, 39, 35, 31, 42, 33, 33, 33, 32, 32, 34, 30, 30, 31, 31, 34, 28, 33, 41, 31, 35, 33, 35, 30, 30, 28, 33, 37, 35, 35, 37, 34, 29, 37, 36, 39, 34, 35, 34, 36, 36, 40, 42, 38, 29, 37, 30, 32, 32, 33, 35, 40, 37, 37, 35, 31, 29, 36, 30, 45, 42, 32, 32, 29, 38, 41, 37, 33, 34, 34, 33, 38, 37, 27, 33]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3178721728166241, "mean_inference_ms": 0.7316233243367907, "mean_action_processing_ms": 0.07605815681890897, "mean_env_wait_ms": 6.827787746970015, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00743844867807574, "StateBufferConnector_ms": 0.004151226144976321, "ViewRequirementAgentConnector_ms": 0.09567231203602479}}, "episode_reward_max": -1.600000000000001, "episode_reward_min": -6.800000000000005, "episode_reward_mean": -2.443362831858409, "episode_len_mean": 35.08849557522124, "episodes_this_iter": 113, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3.1000000000000014, -1.8000000000000012, -3.0000000000000018, -2.900000000000002, -2.1000000000000014, -2.3000000000000016, -2.4000000000000017, -2.5000000000000018, -2.0000000000000013, -2.600000000000002, -1.8000000000000012, -6.800000000000005, -2.2000000000000015, -2.1000000000000014, -1.9000000000000012, -2.4000000000000017, -3.3000000000000007, -2.5000000000000018, -2.0000000000000013, -2.800000000000002, -2.600000000000002, -2.800000000000002, -2.900000000000002, -3.1000000000000014, -2.700000000000002, -2.4000000000000017, -3.3000000000000016, -2.0000000000000013, -3.5, -3.1000000000000014, -2.0000000000000013, -2.600000000000002, -2.800000000000002, -2.4000000000000017, -3.1000000000000014, -2.1000000000000014, -2.800000000000002, -2.4000000000000017, -2.3000000000000016, -2.800000000000002, -2.4000000000000017, -2.0000000000000013, -3.1000000000000014, -2.2000000000000015, -2.2000000000000015, -2.2000000000000015, -2.1000000000000014, -2.1000000000000014, -2.4000000000000017, -1.9000000000000012, -1.9000000000000012, -2.0000000000000013, -2.0000000000000013, -2.3000000000000016, -1.700000000000001, -2.2000000000000015, -3.0000000000000018, -2.0000000000000013, -2.4000000000000017, -2.2000000000000015, -2.4000000000000017, -1.9000000000000012, -1.9000000000000012, -1.700000000000001, -2.2000000000000015, -2.600000000000002, -2.4000000000000017, -2.4000000000000017, -2.600000000000002, -2.3000000000000016, -1.8000000000000012, -2.600000000000002, -2.5000000000000018, -2.800000000000002, -2.3000000000000016, -2.4000000000000017, -2.3000000000000016, -2.5000000000000018, -2.5000000000000018, -2.900000000000002, -3.1000000000000014, -2.700000000000002, -1.8000000000000012, -2.600000000000002, -1.9000000000000012, -2.1000000000000014, -2.2000000000000015, -2.2000000000000015, -2.4000000000000017, -2.900000000000002, -2.600000000000002, -2.600000000000002, -2.4000000000000017, -2.0000000000000013, -1.8000000000000012, -2.5000000000000018, -1.9000000000000012, -3.4000000000000004, -3.1000000000000014, -2.1000000000000014, -2.1000000000000014, -1.8000000000000012, -2.700000000000002, -3.0000000000000018, -2.600000000000002, -2.2000000000000015, -2.3000000000000016, -2.3000000000000016, -2.2000000000000015, -2.700000000000002, -2.600000000000002, -1.600000000000001, -2.2000000000000015], "episode_lengths": [37, 29, 41, 40, 32, 34, 35, 36, 31, 37, 29, 48, 33, 32, 30, 35, 44, 36, 31, 39, 37, 39, 40, 42, 38, 35, 43, 31, 46, 42, 31, 37, 39, 35, 42, 32, 39, 35, 34, 39, 35, 31, 42, 33, 33, 33, 32, 32, 34, 30, 30, 31, 31, 34, 28, 33, 41, 31, 35, 33, 35, 30, 30, 28, 33, 37, 35, 35, 37, 34, 29, 37, 36, 39, 34, 35, 34, 36, 36, 40, 42, 38, 29, 37, 30, 32, 32, 33, 35, 40, 37, 37, 35, 31, 29, 36, 30, 45, 42, 32, 32, 29, 38, 41, 37, 33, 34, 34, 33, 38, 37, 27, 33]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3178721728166241, "mean_inference_ms": 0.7316233243367907, "mean_action_processing_ms": 0.07605815681890897, "mean_env_wait_ms": 6.827787746970015, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00743844867807574, "StateBufferConnector_ms": 0.004151226144976321, "ViewRequirementAgentConnector_ms": 0.09567231203602479}, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 216000, "num_agent_steps_trained": 216000, "num_env_steps_sampled": 216000, "num_env_steps_trained": 216000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 370.5216120506026, "num_env_steps_trained_throughput_per_sec": 370.5216120506026, "timesteps_total": 216000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 216000, "timers": {"training_iteration_time_ms": 9756.973, "sample_time_ms": 5896.247, "load_time_ms": 1.012, "load_throughput": 3952881.747, "learn_time_ms": 3856.902, "learn_throughput": 1037.102, "synch_weights_time_ms": 2.16}, "counters": {"num_env_steps_sampled": 216000, "num_env_steps_trained": 216000, "num_agent_steps_sampled": 216000, "num_agent_steps_trained": 216000}, "done": false, "episodes_total": 3355, "training_iteration": 54, "trial_id": "ddfb6_00000", "date": "2024-03-07_12-56-45", "timestamp": 1709834205, "time_this_iter_s": 10.798487901687622, "time_total_s": 505.82273173332214, "pid": 112355, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4d85689f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 505.82273173332214, "iterations_since_restore": 54, "perf": {"cpu_util_percent": 36.06428571428571, "ram_util_percent": 52.57857142857143, "gpu_util_percent0": 0.16357142857142856, "vram_util_percent0": 0.1235932849702381}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.10000000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 0.05991837108108435, "policy_loss": -0.005801141554469704, "vf_loss": 0.06475219019758766, "vf_explained_var": 0.9477029735683113, "kl": 0.009673217102595003, "entropy": 0.37575974541325724, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 50685.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 220000, "num_env_steps_trained": 220000, "num_agent_steps_sampled": 220000, "num_agent_steps_trained": 220000}, "sampler_results": {"episode_reward_max": -1.5000000000000009, "episode_reward_min": -3.8000000000000007, "episode_reward_mean": -2.336752136752138, "episode_len_mean": 34.27350427350427, "episode_media": {}, "episodes_this_iter": 117, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2.600000000000002, -2.700000000000002, -1.700000000000001, -2.2000000000000015, -1.9000000000000012, -3.700000000000001, -2.900000000000002, -1.9000000000000012, -2.800000000000002, -2.600000000000002, -1.9000000000000012, -2.5000000000000018, -2.3000000000000016, -2.4000000000000017, -2.3000000000000016, -2.700000000000002, -3.0000000000000018, -2.1000000000000014, -1.9000000000000012, -2.1000000000000014, -2.4000000000000017, -2.3000000000000016, -2.4000000000000017, -2.0000000000000013, -2.1000000000000014, -2.1000000000000014, -2.0000000000000013, -2.5000000000000018, -1.8000000000000012, -2.1000000000000014, -2.4000000000000017, -2.3000000000000016, -3.1000000000000014, -2.2000000000000015, -2.800000000000002, -2.0000000000000013, -2.1000000000000014, -3.5999999999999996, -1.8000000000000012, -2.1000000000000014, -2.900000000000002, -1.9000000000000012, -3.3000000000000007, -3.4000000000000004, -2.0000000000000013, -2.1000000000000014, -2.5000000000000018, -2.0000000000000013, -2.4000000000000017, -2.5000000000000018, -2.5000000000000018, -1.9000000000000012, -1.9000000000000012, -2.0000000000000013, -2.1000000000000014, -2.0000000000000013, -2.5000000000000018, -2.0000000000000013, -2.700000000000002, -2.1000000000000014, -2.0000000000000013, -1.9000000000000012, -2.4000000000000017, -2.600000000000002, -2.3000000000000016, -2.1000000000000014, -1.700000000000001, -2.900000000000002, -2.0000000000000013, -1.8000000000000012, -2.4000000000000017, -2.4000000000000017, -1.9000000000000012, -2.900000000000002, -2.3000000000000016, -2.2000000000000015, -2.2000000000000015, -1.9000000000000012, -2.4000000000000017, -2.4000000000000017, -2.2000000000000015, -2.900000000000002, -2.3000000000000016, -2.5000000000000018, -2.600000000000002, -2.1000000000000014, -2.800000000000002, -2.600000000000002, -2.600000000000002, -2.800000000000002, -1.9000000000000012, -2.1000000000000014, -1.9000000000000012, -2.5000000000000018, -1.9000000000000012, -1.9000000000000012, -1.5000000000000009, -2.2000000000000015, -2.5000000000000018, -2.3000000000000016, -3.0000000000000018, -3.8000000000000007, -2.800000000000002, -2.2000000000000015, -2.4000000000000017, -2.2000000000000015, -2.700000000000002, -2.5000000000000018, -2.0000000000000013, -1.9000000000000012, -2.1000000000000014, -2.4000000000000017, -2.4000000000000017, -2.2000000000000015, -2.3000000000000016, -2.3000000000000016, -2.4000000000000017], "episode_lengths": [37, 38, 28, 33, 30, 44, 40, 30, 39, 37, 30, 36, 34, 35, 34, 38, 41, 32, 30, 32, 35, 34, 35, 31, 32, 32, 31, 36, 29, 32, 35, 34, 42, 33, 39, 31, 32, 47, 29, 32, 40, 30, 42, 43, 31, 32, 36, 31, 35, 36, 36, 30, 30, 31, 32, 31, 36, 31, 38, 32, 31, 30, 35, 37, 34, 32, 28, 40, 31, 29, 35, 35, 30, 40, 34, 33, 33, 30, 35, 35, 33, 40, 34, 36, 37, 32, 39, 37, 37, 39, 30, 32, 30, 36, 30, 30, 26, 33, 36, 34, 41, 46, 39, 33, 35, 33, 38, 36, 31, 30, 32, 35, 35, 33, 34, 34, 35]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.31971804992501907, "mean_inference_ms": 0.7322211579771839, "mean_action_processing_ms": 0.07609968418656499, "mean_env_wait_ms": 6.841401650468759, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00722652826553736, "StateBufferConnector_ms": 0.004175993112417368, "ViewRequirementAgentConnector_ms": 0.09472757323175414}}, "episode_reward_max": -1.5000000000000009, "episode_reward_min": -3.8000000000000007, "episode_reward_mean": -2.336752136752138, "episode_len_mean": 34.27350427350427, "episodes_this_iter": 117, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-2.600000000000002, -2.700000000000002, -1.700000000000001, -2.2000000000000015, -1.9000000000000012, -3.700000000000001, -2.900000000000002, -1.9000000000000012, -2.800000000000002, -2.600000000000002, -1.9000000000000012, -2.5000000000000018, -2.3000000000000016, -2.4000000000000017, -2.3000000000000016, -2.700000000000002, -3.0000000000000018, -2.1000000000000014, -1.9000000000000012, -2.1000000000000014, -2.4000000000000017, -2.3000000000000016, -2.4000000000000017, -2.0000000000000013, -2.1000000000000014, -2.1000000000000014, -2.0000000000000013, -2.5000000000000018, -1.8000000000000012, -2.1000000000000014, -2.4000000000000017, -2.3000000000000016, -3.1000000000000014, -2.2000000000000015, -2.800000000000002, -2.0000000000000013, -2.1000000000000014, -3.5999999999999996, -1.8000000000000012, -2.1000000000000014, -2.900000000000002, -1.9000000000000012, -3.3000000000000007, -3.4000000000000004, -2.0000000000000013, -2.1000000000000014, -2.5000000000000018, -2.0000000000000013, -2.4000000000000017, -2.5000000000000018, -2.5000000000000018, -1.9000000000000012, -1.9000000000000012, -2.0000000000000013, -2.1000000000000014, -2.0000000000000013, -2.5000000000000018, -2.0000000000000013, -2.700000000000002, -2.1000000000000014, -2.0000000000000013, -1.9000000000000012, -2.4000000000000017, -2.600000000000002, -2.3000000000000016, -2.1000000000000014, -1.700000000000001, -2.900000000000002, -2.0000000000000013, -1.8000000000000012, -2.4000000000000017, -2.4000000000000017, -1.9000000000000012, -2.900000000000002, -2.3000000000000016, -2.2000000000000015, -2.2000000000000015, -1.9000000000000012, -2.4000000000000017, -2.4000000000000017, -2.2000000000000015, -2.900000000000002, -2.3000000000000016, -2.5000000000000018, -2.600000000000002, -2.1000000000000014, -2.800000000000002, -2.600000000000002, -2.600000000000002, -2.800000000000002, -1.9000000000000012, -2.1000000000000014, -1.9000000000000012, -2.5000000000000018, -1.9000000000000012, -1.9000000000000012, -1.5000000000000009, -2.2000000000000015, -2.5000000000000018, -2.3000000000000016, -3.0000000000000018, -3.8000000000000007, -2.800000000000002, -2.2000000000000015, -2.4000000000000017, -2.2000000000000015, -2.700000000000002, -2.5000000000000018, -2.0000000000000013, -1.9000000000000012, -2.1000000000000014, -2.4000000000000017, -2.4000000000000017, -2.2000000000000015, -2.3000000000000016, -2.3000000000000016, -2.4000000000000017], "episode_lengths": [37, 38, 28, 33, 30, 44, 40, 30, 39, 37, 30, 36, 34, 35, 34, 38, 41, 32, 30, 32, 35, 34, 35, 31, 32, 32, 31, 36, 29, 32, 35, 34, 42, 33, 39, 31, 32, 47, 29, 32, 40, 30, 42, 43, 31, 32, 36, 31, 35, 36, 36, 30, 30, 31, 32, 31, 36, 31, 38, 32, 31, 30, 35, 37, 34, 32, 28, 40, 31, 29, 35, 35, 30, 40, 34, 33, 33, 30, 35, 35, 33, 40, 34, 36, 37, 32, 39, 37, 37, 39, 30, 32, 30, 36, 30, 30, 26, 33, 36, 34, 41, 46, 39, 33, 35, 33, 38, 36, 31, 30, 32, 35, 35, 33, 34, 34, 35]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.31971804992501907, "mean_inference_ms": 0.7322211579771839, "mean_action_processing_ms": 0.07609968418656499, "mean_env_wait_ms": 6.841401650468759, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00722652826553736, "StateBufferConnector_ms": 0.004175993112417368, "ViewRequirementAgentConnector_ms": 0.09472757323175414}, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 220000, "num_agent_steps_trained": 220000, "num_env_steps_sampled": 220000, "num_env_steps_trained": 220000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 391.7703551466851, "num_env_steps_trained_throughput_per_sec": 391.7703551466851, "timesteps_total": 220000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 220000, "timers": {"training_iteration_time_ms": 9796.836, "sample_time_ms": 5915.456, "load_time_ms": 2.376, "load_throughput": 1683343.969, "learn_time_ms": 3876.129, "learn_throughput": 1031.957, "synch_weights_time_ms": 2.206}, "counters": {"num_env_steps_sampled": 220000, "num_env_steps_trained": 220000, "num_agent_steps_sampled": 220000, "num_agent_steps_trained": 220000}, "done": false, "episodes_total": 3472, "training_iteration": 55, "trial_id": "ddfb6_00000", "date": "2024-03-07_12-56-56", "timestamp": 1709834216, "time_this_iter_s": 10.213910341262817, "time_total_s": 516.036642074585, "pid": 112355, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4d85689f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 516.036642074585, "iterations_since_restore": 55, "perf": {"cpu_util_percent": 32.70769230769231, "ram_util_percent": 53.23076923076922, "gpu_util_percent0": 0.12000000000000001, "vram_util_percent0": 0.12301557491987178}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.10000000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 0.13536570565458964, "policy_loss": -0.006996443046016558, "vf_loss": 0.14093644133999303, "vf_explained_var": 0.9369982955276325, "kl": 0.014257060819989576, "entropy": 0.33755648554332796, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 51615.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 224000, "num_env_steps_trained": 224000, "num_agent_steps_sampled": 224000, "num_agent_steps_trained": 224000}, "sampler_results": {"episode_reward_max": -1.5000000000000009, "episode_reward_min": -11.899999999999988, "episode_reward_mean": -2.2725000000000013, "episode_len_mean": 33.416666666666664, "episode_media": {}, "episodes_this_iter": 120, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1.8000000000000012, -2.4000000000000017, -2.2000000000000015, -2.3000000000000016, -2.4000000000000017, -1.700000000000001, -2.1000000000000014, -2.700000000000002, -2.3000000000000016, -2.2000000000000015, -2.1000000000000014, -2.1000000000000014, -1.9000000000000012, -2.2000000000000015, -2.2000000000000015, -1.8000000000000012, -2.1000000000000014, -2.3000000000000016, -2.800000000000002, -1.9000000000000012, -1.8000000000000012, -2.1000000000000014, -3.1000000000000014, -1.8000000000000012, -2.2000000000000015, -1.8000000000000012, -2.1000000000000014, -1.600000000000001, -2.0000000000000013, -2.1000000000000014, -2.4000000000000017, -2.4000000000000017, -1.9000000000000012, -2.3000000000000016, -2.3000000000000016, -2.3000000000000016, -2.2000000000000015, -2.2000000000000015, -2.1000000000000014, -2.2000000000000015, -2.800000000000002, -2.4000000000000017, -1.9000000000000012, -1.600000000000001, -2.1000000000000014, -2.700000000000002, -1.8000000000000012, -3.0000000000000018, -2.2000000000000015, -2.1000000000000014, -2.5000000000000018, -2.3000000000000016, -2.4000000000000017, -2.4000000000000017, -2.800000000000002, -2.5000000000000018, -2.3000000000000016, -2.1000000000000014, -2.0000000000000013, -2.2000000000000015, -2.2000000000000015, -1.8000000000000012, -2.5000000000000018, -2.800000000000002, -2.1000000000000014, -2.0000000000000013, -2.0000000000000013, -2.700000000000002, -2.0000000000000013, -2.700000000000002, -2.5000000000000018, -2.5000000000000018, -2.1000000000000014, -1.9000000000000012, -2.1000000000000014, -2.2000000000000015, -2.600000000000002, -1.5000000000000009, -1.9000000000000012, -2.1000000000000014, -2.0000000000000013, -3.3000000000000007, -2.0000000000000013, -1.9000000000000012, -1.8000000000000012, -2.0000000000000013, -2.2000000000000015, -2.0000000000000013, -2.3000000000000016, -2.0000000000000013, -2.0000000000000013, -2.3000000000000016, -2.0000000000000013, -2.0000000000000013, -3.0000000000000018, -2.5000000000000018, -11.899999999999988, -2.3000000000000016, -1.600000000000001, -2.1000000000000014, -2.700000000000002, -2.2000000000000015, -2.1000000000000014, -2.1000000000000014, -2.4000000000000017, -1.700000000000001, -2.1000000000000014, -1.5000000000000009, -2.0000000000000013, -2.1000000000000014, -2.1000000000000014, -2.2000000000000015, -2.1000000000000014, -3.4000000000000004, -1.9000000000000012, -2.0000000000000013, -1.9000000000000012, -2.1000000000000014, -2.2000000000000015, -2.0000000000000013], "episode_lengths": [29, 35, 33, 34, 35, 28, 32, 38, 34, 33, 32, 32, 30, 33, 33, 29, 32, 34, 39, 30, 29, 32, 42, 29, 33, 29, 32, 27, 31, 32, 35, 35, 30, 34, 34, 34, 33, 33, 32, 33, 39, 35, 30, 27, 32, 38, 29, 41, 33, 32, 36, 34, 35, 35, 39, 36, 34, 32, 31, 33, 33, 29, 36, 39, 32, 31, 31, 38, 31, 38, 36, 36, 32, 30, 32, 33, 37, 26, 30, 32, 31, 44, 31, 30, 29, 31, 33, 31, 34, 31, 31, 34, 31, 31, 41, 36, 93, 34, 27, 32, 38, 33, 32, 32, 35, 28, 32, 26, 31, 32, 32, 33, 32, 45, 30, 31, 30, 32, 33, 31]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3218792666658302, "mean_inference_ms": 0.7332461011458785, "mean_action_processing_ms": 0.07620364974740453, "mean_env_wait_ms": 6.859495798129933, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007516741752624512, "StateBufferConnector_ms": 0.004235108693440755, "ViewRequirementAgentConnector_ms": 0.09739478429158528}}, "episode_reward_max": -1.5000000000000009, "episode_reward_min": -11.899999999999988, "episode_reward_mean": -2.2725000000000013, "episode_len_mean": 33.416666666666664, "episodes_this_iter": 120, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1.8000000000000012, -2.4000000000000017, -2.2000000000000015, -2.3000000000000016, -2.4000000000000017, -1.700000000000001, -2.1000000000000014, -2.700000000000002, -2.3000000000000016, -2.2000000000000015, -2.1000000000000014, -2.1000000000000014, -1.9000000000000012, -2.2000000000000015, -2.2000000000000015, -1.8000000000000012, -2.1000000000000014, -2.3000000000000016, -2.800000000000002, -1.9000000000000012, -1.8000000000000012, -2.1000000000000014, -3.1000000000000014, -1.8000000000000012, -2.2000000000000015, -1.8000000000000012, -2.1000000000000014, -1.600000000000001, -2.0000000000000013, -2.1000000000000014, -2.4000000000000017, -2.4000000000000017, -1.9000000000000012, -2.3000000000000016, -2.3000000000000016, -2.3000000000000016, -2.2000000000000015, -2.2000000000000015, -2.1000000000000014, -2.2000000000000015, -2.800000000000002, -2.4000000000000017, -1.9000000000000012, -1.600000000000001, -2.1000000000000014, -2.700000000000002, -1.8000000000000012, -3.0000000000000018, -2.2000000000000015, -2.1000000000000014, -2.5000000000000018, -2.3000000000000016, -2.4000000000000017, -2.4000000000000017, -2.800000000000002, -2.5000000000000018, -2.3000000000000016, -2.1000000000000014, -2.0000000000000013, -2.2000000000000015, -2.2000000000000015, -1.8000000000000012, -2.5000000000000018, -2.800000000000002, -2.1000000000000014, -2.0000000000000013, -2.0000000000000013, -2.700000000000002, -2.0000000000000013, -2.700000000000002, -2.5000000000000018, -2.5000000000000018, -2.1000000000000014, -1.9000000000000012, -2.1000000000000014, -2.2000000000000015, -2.600000000000002, -1.5000000000000009, -1.9000000000000012, -2.1000000000000014, -2.0000000000000013, -3.3000000000000007, -2.0000000000000013, -1.9000000000000012, -1.8000000000000012, -2.0000000000000013, -2.2000000000000015, -2.0000000000000013, -2.3000000000000016, -2.0000000000000013, -2.0000000000000013, -2.3000000000000016, -2.0000000000000013, -2.0000000000000013, -3.0000000000000018, -2.5000000000000018, -11.899999999999988, -2.3000000000000016, -1.600000000000001, -2.1000000000000014, -2.700000000000002, -2.2000000000000015, -2.1000000000000014, -2.1000000000000014, -2.4000000000000017, -1.700000000000001, -2.1000000000000014, -1.5000000000000009, -2.0000000000000013, -2.1000000000000014, -2.1000000000000014, -2.2000000000000015, -2.1000000000000014, -3.4000000000000004, -1.9000000000000012, -2.0000000000000013, -1.9000000000000012, -2.1000000000000014, -2.2000000000000015, -2.0000000000000013], "episode_lengths": [29, 35, 33, 34, 35, 28, 32, 38, 34, 33, 32, 32, 30, 33, 33, 29, 32, 34, 39, 30, 29, 32, 42, 29, 33, 29, 32, 27, 31, 32, 35, 35, 30, 34, 34, 34, 33, 33, 32, 33, 39, 35, 30, 27, 32, 38, 29, 41, 33, 32, 36, 34, 35, 35, 39, 36, 34, 32, 31, 33, 33, 29, 36, 39, 32, 31, 31, 38, 31, 38, 36, 36, 32, 30, 32, 33, 37, 26, 30, 32, 31, 44, 31, 30, 29, 31, 33, 31, 34, 31, 31, 34, 31, 31, 41, 36, 93, 34, 27, 32, 38, 33, 32, 32, 35, 28, 32, 26, 31, 32, 32, 33, 32, 45, 30, 31, 30, 32, 33, 31]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3218792666658302, "mean_inference_ms": 0.7332461011458785, "mean_action_processing_ms": 0.07620364974740453, "mean_env_wait_ms": 6.859495798129933, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007516741752624512, "StateBufferConnector_ms": 0.004235108693440755, "ViewRequirementAgentConnector_ms": 0.09739478429158528}, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 224000, "num_agent_steps_trained": 224000, "num_env_steps_sampled": 224000, "num_env_steps_trained": 224000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 406.1995661804779, "num_env_steps_trained_throughput_per_sec": 406.1995661804779, "timesteps_total": 224000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 224000, "timers": {"training_iteration_time_ms": 9797.596, "sample_time_ms": 5940.823, "load_time_ms": 2.379, "load_throughput": 1681521.839, "learn_time_ms": 3851.487, "learn_throughput": 1038.56, "synch_weights_time_ms": 2.228}, "counters": {"num_env_steps_sampled": 224000, "num_env_steps_trained": 224000, "num_agent_steps_sampled": 224000, "num_agent_steps_trained": 224000}, "done": false, "episodes_total": 3592, "training_iteration": 56, "trial_id": "ddfb6_00000", "date": "2024-03-07_12-57-05", "timestamp": 1709834225, "time_this_iter_s": 9.850341558456421, "time_total_s": 525.8869836330414, "pid": 112355, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4d85689f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 525.8869836330414, "iterations_since_restore": 56, "perf": {"cpu_util_percent": 34.61666666666667, "ram_util_percent": 53.449999999999996, "gpu_util_percent0": 0.10333333333333333, "vram_util_percent0": 0.12632921006944445}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.10000000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 0.46284633864878966, "policy_loss": -0.002818282974022691, "vf_loss": 0.46479046388719514, "vf_explained_var": 0.8956423738951325, "kl": 0.008741638588762429, "entropy": 0.36576394627812087, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 52545.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 228000, "num_env_steps_trained": 228000, "num_agent_steps_sampled": 228000, "num_agent_steps_trained": 228000}, "sampler_results": {"episode_reward_max": -1.5000000000000009, "episode_reward_min": -3.5999999999999996, "episode_reward_mean": -2.2159292035398246, "episode_len_mean": 33.08849557522124, "episode_media": {}, "episodes_this_iter": 113, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2.1000000000000014, -2.4000000000000017, -3.0000000000000018, -2.4000000000000017, -1.9000000000000012, -2.2000000000000015, -2.900000000000002, -1.600000000000001, -2.1000000000000014, -3.3000000000000007, -1.9000000000000012, -2.3000000000000016, -1.9000000000000012, -2.1000000000000014, -2.2000000000000015, -2.600000000000002, -2.1000000000000014, -2.800000000000002, -2.3000000000000016, -2.0000000000000013, -1.8000000000000012, -2.2000000000000015, -1.8000000000000012, -1.9000000000000012, -1.700000000000001, -2.1000000000000014, -1.5000000000000009, -2.2000000000000015, -1.9000000000000012, -2.5000000000000018, -1.9000000000000012, -2.2000000000000015, -2.4000000000000017, -2.0000000000000013, -2.3000000000000016, -2.700000000000002, -2.4000000000000017, -2.2000000000000015, -2.4000000000000017, -2.600000000000002, -2.5000000000000018, -1.9000000000000012, -2.0000000000000013, -1.8000000000000012, -2.5000000000000018, -1.9000000000000012, -2.2000000000000015, -2.4000000000000017, -2.0000000000000013, -2.2000000000000015, -1.600000000000001, -2.0000000000000013, -2.2000000000000015, -2.3000000000000016, -2.4000000000000017, -1.600000000000001, -2.0000000000000013, -2.2000000000000015, -2.3000000000000016, -2.4000000000000017, -1.8000000000000012, -2.2000000000000015, -2.3000000000000016, -2.900000000000002, -2.1000000000000014, -2.3000000000000016, -2.0000000000000013, -2.800000000000002, -2.4000000000000017, -1.8000000000000012, -2.5000000000000018, -2.4000000000000017, -2.1000000000000014, -2.2000000000000015, -1.9000000000000012, -2.2000000000000015, -2.700000000000002, -2.3000000000000016, -2.2000000000000015, -1.9000000000000012, -2.3000000000000016, -1.9000000000000012, -1.9000000000000012, -1.8000000000000012, -1.5000000000000009, -2.2000000000000015, -2.5000000000000018, -2.4000000000000017, -2.5000000000000018, -2.800000000000002, -1.9000000000000012, -2.3000000000000016, -1.9000000000000012, -2.1000000000000014, -2.2000000000000015, -2.3000000000000016, -2.5000000000000018, -2.2000000000000015, -2.1000000000000014, -2.5000000000000018, -1.9000000000000012, -2.1000000000000014, -3.200000000000001, -2.1000000000000014, -2.2000000000000015, -2.3000000000000016, -3.5999999999999996, -1.700000000000001, -2.3000000000000016, -2.3000000000000016, -2.600000000000002, -1.700000000000001, -2.4000000000000017], "episode_lengths": [32, 35, 41, 35, 30, 33, 40, 27, 32, 44, 30, 34, 30, 32, 33, 37, 32, 39, 34, 31, 29, 33, 29, 30, 28, 32, 26, 33, 30, 36, 30, 33, 35, 31, 34, 38, 35, 33, 35, 37, 36, 30, 31, 29, 36, 30, 33, 35, 31, 33, 27, 31, 33, 34, 35, 27, 31, 33, 34, 35, 29, 33, 34, 40, 32, 34, 31, 39, 35, 29, 36, 35, 32, 33, 30, 33, 38, 34, 33, 30, 34, 30, 30, 29, 26, 33, 36, 35, 36, 39, 30, 34, 30, 32, 33, 34, 36, 33, 32, 36, 30, 32, 43, 32, 33, 34, 39, 28, 34, 34, 37, 28, 35]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3233632815591543, "mean_inference_ms": 0.7330624253168844, "mean_action_processing_ms": 0.07618467147732662, "mean_env_wait_ms": 6.866217445785732, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0070487503456858405, "StateBufferConnector_ms": 0.003867022759091538, "ViewRequirementAgentConnector_ms": 0.08890206834911245}}, "episode_reward_max": -1.5000000000000009, "episode_reward_min": -3.5999999999999996, "episode_reward_mean": -2.2159292035398246, "episode_len_mean": 33.08849557522124, "episodes_this_iter": 113, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-2.1000000000000014, -2.4000000000000017, -3.0000000000000018, -2.4000000000000017, -1.9000000000000012, -2.2000000000000015, -2.900000000000002, -1.600000000000001, -2.1000000000000014, -3.3000000000000007, -1.9000000000000012, -2.3000000000000016, -1.9000000000000012, -2.1000000000000014, -2.2000000000000015, -2.600000000000002, -2.1000000000000014, -2.800000000000002, -2.3000000000000016, -2.0000000000000013, -1.8000000000000012, -2.2000000000000015, -1.8000000000000012, -1.9000000000000012, -1.700000000000001, -2.1000000000000014, -1.5000000000000009, -2.2000000000000015, -1.9000000000000012, -2.5000000000000018, -1.9000000000000012, -2.2000000000000015, -2.4000000000000017, -2.0000000000000013, -2.3000000000000016, -2.700000000000002, -2.4000000000000017, -2.2000000000000015, -2.4000000000000017, -2.600000000000002, -2.5000000000000018, -1.9000000000000012, -2.0000000000000013, -1.8000000000000012, -2.5000000000000018, -1.9000000000000012, -2.2000000000000015, -2.4000000000000017, -2.0000000000000013, -2.2000000000000015, -1.600000000000001, -2.0000000000000013, -2.2000000000000015, -2.3000000000000016, -2.4000000000000017, -1.600000000000001, -2.0000000000000013, -2.2000000000000015, -2.3000000000000016, -2.4000000000000017, -1.8000000000000012, -2.2000000000000015, -2.3000000000000016, -2.900000000000002, -2.1000000000000014, -2.3000000000000016, -2.0000000000000013, -2.800000000000002, -2.4000000000000017, -1.8000000000000012, -2.5000000000000018, -2.4000000000000017, -2.1000000000000014, -2.2000000000000015, -1.9000000000000012, -2.2000000000000015, -2.700000000000002, -2.3000000000000016, -2.2000000000000015, -1.9000000000000012, -2.3000000000000016, -1.9000000000000012, -1.9000000000000012, -1.8000000000000012, -1.5000000000000009, -2.2000000000000015, -2.5000000000000018, -2.4000000000000017, -2.5000000000000018, -2.800000000000002, -1.9000000000000012, -2.3000000000000016, -1.9000000000000012, -2.1000000000000014, -2.2000000000000015, -2.3000000000000016, -2.5000000000000018, -2.2000000000000015, -2.1000000000000014, -2.5000000000000018, -1.9000000000000012, -2.1000000000000014, -3.200000000000001, -2.1000000000000014, -2.2000000000000015, -2.3000000000000016, -3.5999999999999996, -1.700000000000001, -2.3000000000000016, -2.3000000000000016, -2.600000000000002, -1.700000000000001, -2.4000000000000017], "episode_lengths": [32, 35, 41, 35, 30, 33, 40, 27, 32, 44, 30, 34, 30, 32, 33, 37, 32, 39, 34, 31, 29, 33, 29, 30, 28, 32, 26, 33, 30, 36, 30, 33, 35, 31, 34, 38, 35, 33, 35, 37, 36, 30, 31, 29, 36, 30, 33, 35, 31, 33, 27, 31, 33, 34, 35, 27, 31, 33, 34, 35, 29, 33, 34, 40, 32, 34, 31, 39, 35, 29, 36, 35, 32, 33, 30, 33, 38, 34, 33, 30, 34, 30, 30, 29, 26, 33, 36, 35, 36, 39, 30, 34, 30, 32, 33, 34, 36, 33, 32, 36, 30, 32, 43, 32, 33, 34, 39, 28, 34, 34, 37, 28, 35]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3233632815591543, "mean_inference_ms": 0.7330624253168844, "mean_action_processing_ms": 0.07618467147732662, "mean_env_wait_ms": 6.866217445785732, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0070487503456858405, "StateBufferConnector_ms": 0.003867022759091538, "ViewRequirementAgentConnector_ms": 0.08890206834911245}, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 228000, "num_agent_steps_trained": 228000, "num_env_steps_sampled": 228000, "num_env_steps_trained": 228000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 403.87329167612626, "num_env_steps_trained_throughput_per_sec": 403.87329167612626, "timesteps_total": 228000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 228000, "timers": {"training_iteration_time_ms": 9850.914, "sample_time_ms": 5951.896, "load_time_ms": 2.376, "load_throughput": 1683597.355, "learn_time_ms": 3893.737, "learn_throughput": 1027.291, "synch_weights_time_ms": 2.218}, "counters": {"num_env_steps_sampled": 228000, "num_env_steps_trained": 228000, "num_agent_steps_sampled": 228000, "num_agent_steps_trained": 228000}, "done": false, "episodes_total": 3705, "training_iteration": 57, "trial_id": "ddfb6_00000", "date": "2024-03-07_12-57-15", "timestamp": 1709834235, "time_this_iter_s": 9.906817197799683, "time_total_s": 535.7938008308411, "pid": 112355, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4d85689f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 535.7938008308411, "iterations_since_restore": 57, "perf": {"cpu_util_percent": 28.353846153846153, "ram_util_percent": 52.73076923076924, "gpu_util_percent0": 0.11461538461538462, "vram_util_percent0": 0.12473081931089744}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.10000000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 0.2634690516898709, "policy_loss": -0.0019300218511332748, "vf_loss": 0.26498305290156315, "vf_explained_var": 0.899282225357589, "kl": 0.004160210783579372, "entropy": 0.3498371301799692, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 53475.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 232000, "num_env_steps_trained": 232000, "num_agent_steps_sampled": 232000, "num_agent_steps_trained": 232000}, "sampler_results": {"episode_reward_max": -1.5000000000000009, "episode_reward_min": -77.30000000000055, "episode_reward_mean": -2.7974789915966443, "episode_len_mean": 35.66386554621849, "episode_media": {}, "episodes_this_iter": 119, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2.4000000000000017, -2.4000000000000017, -1.9000000000000012, -1.9000000000000012, -2.3000000000000016, -1.8000000000000012, -2.1000000000000014, -2.3000000000000016, -2.0000000000000013, -2.800000000000002, -2.2000000000000015, -2.1000000000000014, -1.9000000000000012, -1.9000000000000012, -2.600000000000002, -2.0000000000000013, -2.2000000000000015, -2.0000000000000013, -2.700000000000001, -2.1000000000000014, -1.8000000000000012, -77.30000000000055, -2.3000000000000016, -2.0000000000000013, -2.2000000000000015, -2.3000000000000016, -1.9000000000000012, -2.4000000000000017, -2.2000000000000015, -3.1000000000000014, -2.4000000000000017, -2.3000000000000016, -1.600000000000001, -1.8000000000000012, -2.5000000000000018, -2.0000000000000013, -2.1000000000000014, -1.700000000000001, -2.2000000000000015, -1.9000000000000012, -2.0000000000000013, -2.2000000000000015, -2.3000000000000016, -1.600000000000001, -2.2000000000000015, -2.0000000000000013, -3.0000000000000018, -1.9000000000000012, -2.4000000000000017, -2.1000000000000014, -1.8000000000000012, -2.1000000000000014, -2.4000000000000017, -2.0000000000000013, -2.4000000000000017, -2.800000000000002, -2.600000000000002, -2.3000000000000016, -2.800000000000002, -2.4000000000000017, -2.3000000000000016, -1.700000000000001, -2.0000000000000013, -2.1000000000000014, -2.0000000000000013, -2.4000000000000017, -2.1000000000000014, -1.5000000000000009, -2.0000000000000013, -2.2000000000000015, -2.2000000000000015, -2.2000000000000015, -2.0000000000000013, -1.9000000000000012, -2.1000000000000014, -2.1000000000000014, -2.3000000000000016, -3.0000000000000018, -1.700000000000001, -1.8000000000000012, -2.2000000000000015, -2.700000000000002, -1.9000000000000012, -2.4000000000000017, -1.700000000000001, -2.5000000000000018, -2.700000000000002, -2.1000000000000014, -2.3000000000000016, -2.2000000000000015, -2.5000000000000018, -2.0000000000000013, -2.1000000000000014, -1.9000000000000012, -1.8000000000000012, -1.600000000000001, -2.3000000000000016, -2.1000000000000014, -2.2000000000000015, -1.9000000000000012, -1.9000000000000012, -2.5000000000000018, -2.1000000000000014, -2.2000000000000015, -2.3000000000000016, -2.900000000000002, -2.1000000000000014, -2.2000000000000015, -2.3000000000000016, -1.600000000000001, -2.0000000000000013, -2.3000000000000016, -2.700000000000002, -2.5000000000000018, -2.5000000000000018, -1.9000000000000012, -1.600000000000001, -1.8000000000000012, -1.9000000000000012], "episode_lengths": [35, 35, 30, 30, 34, 29, 32, 34, 31, 39, 33, 32, 30, 30, 37, 31, 33, 31, 30, 32, 29, 400, 34, 31, 33, 34, 30, 35, 33, 42, 35, 33, 27, 29, 36, 31, 32, 28, 33, 30, 31, 33, 34, 27, 33, 31, 41, 30, 35, 32, 29, 32, 35, 31, 35, 39, 37, 34, 39, 35, 34, 28, 31, 32, 31, 35, 32, 26, 31, 33, 33, 33, 31, 30, 32, 32, 34, 40, 28, 29, 33, 38, 30, 35, 28, 36, 38, 32, 34, 33, 36, 31, 32, 30, 29, 27, 34, 32, 33, 30, 30, 36, 32, 33, 34, 40, 32, 33, 34, 27, 31, 34, 38, 36, 36, 30, 27, 29, 30]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3252523796416919, "mean_inference_ms": 0.733943035930574, "mean_action_processing_ms": 0.07624993647180506, "mean_env_wait_ms": 6.88152683237818, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007314641936486508, "StateBufferConnector_ms": 0.004252666184882156, "ViewRequirementAgentConnector_ms": 0.09718983113264837}}, "episode_reward_max": -1.5000000000000009, "episode_reward_min": -77.30000000000055, "episode_reward_mean": -2.7974789915966443, "episode_len_mean": 35.66386554621849, "episodes_this_iter": 119, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-2.4000000000000017, -2.4000000000000017, -1.9000000000000012, -1.9000000000000012, -2.3000000000000016, -1.8000000000000012, -2.1000000000000014, -2.3000000000000016, -2.0000000000000013, -2.800000000000002, -2.2000000000000015, -2.1000000000000014, -1.9000000000000012, -1.9000000000000012, -2.600000000000002, -2.0000000000000013, -2.2000000000000015, -2.0000000000000013, -2.700000000000001, -2.1000000000000014, -1.8000000000000012, -77.30000000000055, -2.3000000000000016, -2.0000000000000013, -2.2000000000000015, -2.3000000000000016, -1.9000000000000012, -2.4000000000000017, -2.2000000000000015, -3.1000000000000014, -2.4000000000000017, -2.3000000000000016, -1.600000000000001, -1.8000000000000012, -2.5000000000000018, -2.0000000000000013, -2.1000000000000014, -1.700000000000001, -2.2000000000000015, -1.9000000000000012, -2.0000000000000013, -2.2000000000000015, -2.3000000000000016, -1.600000000000001, -2.2000000000000015, -2.0000000000000013, -3.0000000000000018, -1.9000000000000012, -2.4000000000000017, -2.1000000000000014, -1.8000000000000012, -2.1000000000000014, -2.4000000000000017, -2.0000000000000013, -2.4000000000000017, -2.800000000000002, -2.600000000000002, -2.3000000000000016, -2.800000000000002, -2.4000000000000017, -2.3000000000000016, -1.700000000000001, -2.0000000000000013, -2.1000000000000014, -2.0000000000000013, -2.4000000000000017, -2.1000000000000014, -1.5000000000000009, -2.0000000000000013, -2.2000000000000015, -2.2000000000000015, -2.2000000000000015, -2.0000000000000013, -1.9000000000000012, -2.1000000000000014, -2.1000000000000014, -2.3000000000000016, -3.0000000000000018, -1.700000000000001, -1.8000000000000012, -2.2000000000000015, -2.700000000000002, -1.9000000000000012, -2.4000000000000017, -1.700000000000001, -2.5000000000000018, -2.700000000000002, -2.1000000000000014, -2.3000000000000016, -2.2000000000000015, -2.5000000000000018, -2.0000000000000013, -2.1000000000000014, -1.9000000000000012, -1.8000000000000012, -1.600000000000001, -2.3000000000000016, -2.1000000000000014, -2.2000000000000015, -1.9000000000000012, -1.9000000000000012, -2.5000000000000018, -2.1000000000000014, -2.2000000000000015, -2.3000000000000016, -2.900000000000002, -2.1000000000000014, -2.2000000000000015, -2.3000000000000016, -1.600000000000001, -2.0000000000000013, -2.3000000000000016, -2.700000000000002, -2.5000000000000018, -2.5000000000000018, -1.9000000000000012, -1.600000000000001, -1.8000000000000012, -1.9000000000000012], "episode_lengths": [35, 35, 30, 30, 34, 29, 32, 34, 31, 39, 33, 32, 30, 30, 37, 31, 33, 31, 30, 32, 29, 400, 34, 31, 33, 34, 30, 35, 33, 42, 35, 33, 27, 29, 36, 31, 32, 28, 33, 30, 31, 33, 34, 27, 33, 31, 41, 30, 35, 32, 29, 32, 35, 31, 35, 39, 37, 34, 39, 35, 34, 28, 31, 32, 31, 35, 32, 26, 31, 33, 33, 33, 31, 30, 32, 32, 34, 40, 28, 29, 33, 38, 30, 35, 28, 36, 38, 32, 34, 33, 36, 31, 32, 30, 29, 27, 34, 32, 33, 30, 30, 36, 32, 33, 34, 40, 32, 33, 34, 27, 31, 34, 38, 36, 36, 30, 27, 29, 30]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3252523796416919, "mean_inference_ms": 0.733943035930574, "mean_action_processing_ms": 0.07624993647180506, "mean_env_wait_ms": 6.88152683237818, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007314641936486508, "StateBufferConnector_ms": 0.004252666184882156, "ViewRequirementAgentConnector_ms": 0.09718983113264837}, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 232000, "num_agent_steps_trained": 232000, "num_env_steps_sampled": 232000, "num_env_steps_trained": 232000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 403.0296039774044, "num_env_steps_trained_throughput_per_sec": 403.0296039774044, "timesteps_total": 232000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 232000, "timers": {"training_iteration_time_ms": 9879.153, "sample_time_ms": 5978.425, "load_time_ms": 2.375, "load_throughput": 1684357.97, "learn_time_ms": 3895.454, "learn_throughput": 1026.838, "synch_weights_time_ms": 2.217}, "counters": {"num_env_steps_sampled": 232000, "num_env_steps_trained": 232000, "num_agent_steps_sampled": 232000, "num_agent_steps_trained": 232000}, "done": false, "episodes_total": 3824, "training_iteration": 58, "trial_id": "ddfb6_00000", "date": "2024-03-07_12-57-25", "timestamp": 1709834245, "time_this_iter_s": 9.92791485786438, "time_total_s": 545.7217156887054, "pid": 112355, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4d85689f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 545.7217156887054, "iterations_since_restore": 58, "perf": {"cpu_util_percent": 31.4, "ram_util_percent": 52.95384615384616, "gpu_util_percent0": 0.13923076923076924, "vram_util_percent0": 0.12372921674679485}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.05000000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 0.14540014654173897, "policy_loss": -0.003247084540705527, "vf_loss": 0.14797796116370748, "vf_explained_var": 0.9395556917754553, "kl": 0.01338537440925971, "entropy": 0.3612401811986841, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 54405.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 236000, "num_env_steps_trained": 236000, "num_agent_steps_sampled": 236000, "num_agent_steps_trained": 236000}, "sampler_results": {"episode_reward_max": -1.4000000000000008, "episode_reward_min": -3.3000000000000016, "episode_reward_mean": -2.137288135593222, "episode_len_mean": 32.33898305084746, "episode_media": {}, "episodes_this_iter": 118, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2.1000000000000014, -2.1000000000000014, -2.1000000000000014, -2.1000000000000014, -2.1000000000000014, -1.8000000000000012, -2.3000000000000016, -2.4000000000000017, -1.9000000000000012, -2.3000000000000016, -2.0000000000000013, -1.600000000000001, -2.3000000000000016, -2.1000000000000014, -1.9000000000000012, -2.0000000000000013, -2.3000000000000016, -2.5000000000000018, -2.600000000000002, -1.5000000000000009, -2.1000000000000014, -2.1000000000000014, -1.9000000000000012, -2.1000000000000014, -2.600000000000002, -2.5000000000000018, -2.3000000000000016, -2.1000000000000014, -2.700000000000002, -2.0000000000000013, -2.2000000000000015, -2.2000000000000015, -2.800000000000002, -2.0000000000000013, -3.1000000000000014, -2.1000000000000014, -1.8000000000000012, -2.0000000000000013, -2.0000000000000013, -2.5000000000000018, -1.8000000000000012, -1.9000000000000012, -2.0000000000000013, -2.3000000000000016, -1.8000000000000012, -2.4000000000000017, -2.1000000000000014, -3.3000000000000016, -2.0000000000000013, -1.5000000000000009, -2.4000000000000017, -2.2000000000000015, -1.8000000000000012, -1.8000000000000012, -2.0000000000000013, -2.3000000000000016, -1.9000000000000012, -2.2000000000000015, -2.1000000000000014, -1.8000000000000012, -2.2000000000000015, -1.9000000000000012, -2.3000000000000016, -2.4000000000000017, -2.3000000000000016, -2.2000000000000015, -2.700000000000002, -2.2000000000000015, -2.2000000000000015, -2.3000000000000016, -1.9000000000000012, -2.1000000000000014, -2.5000000000000018, -2.0000000000000013, -2.0000000000000013, -2.0000000000000013, -2.0000000000000013, -2.1000000000000014, -2.2000000000000015, -2.2000000000000015, -2.1000000000000014, -2.5000000000000018, -1.8000000000000012, -2.0000000000000013, -1.700000000000001, -2.0000000000000013, -1.8000000000000012, -1.9000000000000012, -2.1000000000000014, -1.9000000000000012, -2.2000000000000015, -2.4000000000000017, -2.1000000000000014, -1.9000000000000012, -2.3000000000000016, -2.4000000000000017, -1.9000000000000012, -1.9000000000000012, -2.0000000000000013, -2.3000000000000016, -2.5000000000000018, -2.2000000000000015, -2.1000000000000014, -2.2000000000000015, -2.0000000000000013, -2.600000000000002, -2.5000000000000018, -2.4000000000000017, -2.0000000000000013, -2.0000000000000013, -2.2000000000000015, -1.4000000000000008, -1.8000000000000012, -2.1000000000000014, -2.700000000000002, -2.2000000000000015, -1.9000000000000012, -1.8000000000000012], "episode_lengths": [32, 32, 32, 32, 32, 29, 34, 35, 30, 34, 31, 27, 34, 32, 30, 31, 34, 36, 37, 26, 32, 32, 30, 32, 37, 36, 34, 32, 38, 31, 33, 33, 39, 31, 42, 32, 29, 31, 31, 36, 29, 30, 31, 34, 29, 35, 32, 40, 31, 26, 35, 33, 29, 29, 31, 34, 30, 33, 32, 29, 33, 30, 34, 35, 34, 33, 38, 33, 33, 34, 30, 32, 36, 31, 31, 31, 31, 32, 33, 33, 32, 36, 29, 31, 28, 31, 29, 30, 32, 30, 33, 35, 32, 30, 34, 35, 30, 30, 31, 34, 36, 33, 32, 33, 31, 37, 36, 35, 31, 31, 33, 25, 29, 32, 38, 33, 30, 29]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3268261135377802, "mean_inference_ms": 0.733964475656083, "mean_action_processing_ms": 0.0762717264822969, "mean_env_wait_ms": 6.896224518151034, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007108510550806078, "StateBufferConnector_ms": 0.003895315073304257, "ViewRequirementAgentConnector_ms": 0.09007150843992072}}, "episode_reward_max": -1.4000000000000008, "episode_reward_min": -3.3000000000000016, "episode_reward_mean": -2.137288135593222, "episode_len_mean": 32.33898305084746, "episodes_this_iter": 118, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-2.1000000000000014, -2.1000000000000014, -2.1000000000000014, -2.1000000000000014, -2.1000000000000014, -1.8000000000000012, -2.3000000000000016, -2.4000000000000017, -1.9000000000000012, -2.3000000000000016, -2.0000000000000013, -1.600000000000001, -2.3000000000000016, -2.1000000000000014, -1.9000000000000012, -2.0000000000000013, -2.3000000000000016, -2.5000000000000018, -2.600000000000002, -1.5000000000000009, -2.1000000000000014, -2.1000000000000014, -1.9000000000000012, -2.1000000000000014, -2.600000000000002, -2.5000000000000018, -2.3000000000000016, -2.1000000000000014, -2.700000000000002, -2.0000000000000013, -2.2000000000000015, -2.2000000000000015, -2.800000000000002, -2.0000000000000013, -3.1000000000000014, -2.1000000000000014, -1.8000000000000012, -2.0000000000000013, -2.0000000000000013, -2.5000000000000018, -1.8000000000000012, -1.9000000000000012, -2.0000000000000013, -2.3000000000000016, -1.8000000000000012, -2.4000000000000017, -2.1000000000000014, -3.3000000000000016, -2.0000000000000013, -1.5000000000000009, -2.4000000000000017, -2.2000000000000015, -1.8000000000000012, -1.8000000000000012, -2.0000000000000013, -2.3000000000000016, -1.9000000000000012, -2.2000000000000015, -2.1000000000000014, -1.8000000000000012, -2.2000000000000015, -1.9000000000000012, -2.3000000000000016, -2.4000000000000017, -2.3000000000000016, -2.2000000000000015, -2.700000000000002, -2.2000000000000015, -2.2000000000000015, -2.3000000000000016, -1.9000000000000012, -2.1000000000000014, -2.5000000000000018, -2.0000000000000013, -2.0000000000000013, -2.0000000000000013, -2.0000000000000013, -2.1000000000000014, -2.2000000000000015, -2.2000000000000015, -2.1000000000000014, -2.5000000000000018, -1.8000000000000012, -2.0000000000000013, -1.700000000000001, -2.0000000000000013, -1.8000000000000012, -1.9000000000000012, -2.1000000000000014, -1.9000000000000012, -2.2000000000000015, -2.4000000000000017, -2.1000000000000014, -1.9000000000000012, -2.3000000000000016, -2.4000000000000017, -1.9000000000000012, -1.9000000000000012, -2.0000000000000013, -2.3000000000000016, -2.5000000000000018, -2.2000000000000015, -2.1000000000000014, -2.2000000000000015, -2.0000000000000013, -2.600000000000002, -2.5000000000000018, -2.4000000000000017, -2.0000000000000013, -2.0000000000000013, -2.2000000000000015, -1.4000000000000008, -1.8000000000000012, -2.1000000000000014, -2.700000000000002, -2.2000000000000015, -1.9000000000000012, -1.8000000000000012], "episode_lengths": [32, 32, 32, 32, 32, 29, 34, 35, 30, 34, 31, 27, 34, 32, 30, 31, 34, 36, 37, 26, 32, 32, 30, 32, 37, 36, 34, 32, 38, 31, 33, 33, 39, 31, 42, 32, 29, 31, 31, 36, 29, 30, 31, 34, 29, 35, 32, 40, 31, 26, 35, 33, 29, 29, 31, 34, 30, 33, 32, 29, 33, 30, 34, 35, 34, 33, 38, 33, 33, 34, 30, 32, 36, 31, 31, 31, 31, 32, 33, 33, 32, 36, 29, 31, 28, 31, 29, 30, 32, 30, 33, 35, 32, 30, 34, 35, 30, 30, 31, 34, 36, 33, 32, 33, 31, 37, 36, 35, 31, 31, 33, 25, 29, 32, 38, 33, 30, 29]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3268261135377802, "mean_inference_ms": 0.733964475656083, "mean_action_processing_ms": 0.0762717264822969, "mean_env_wait_ms": 6.896224518151034, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007108510550806078, "StateBufferConnector_ms": 0.003895315073304257, "ViewRequirementAgentConnector_ms": 0.09007150843992072}, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 236000, "num_agent_steps_trained": 236000, "num_env_steps_sampled": 236000, "num_env_steps_trained": 236000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 423.47504188567825, "num_env_steps_trained_throughput_per_sec": 423.47504188567825, "timesteps_total": 236000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 236000, "timers": {"training_iteration_time_ms": 9870.52, "sample_time_ms": 5976.499, "load_time_ms": 2.393, "load_throughput": 1671720.125, "learn_time_ms": 3888.767, "learn_throughput": 1028.604, "synch_weights_time_ms": 2.183}, "counters": {"num_env_steps_sampled": 236000, "num_env_steps_trained": 236000, "num_agent_steps_sampled": 236000, "num_agent_steps_trained": 236000}, "done": false, "episodes_total": 3942, "training_iteration": 59, "trial_id": "ddfb6_00000", "date": "2024-03-07_12-57-35", "timestamp": 1709834255, "time_this_iter_s": 9.448310375213623, "time_total_s": 555.1700260639191, "pid": 112355, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4d85689f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 555.1700260639191, "iterations_since_restore": 59, "perf": {"cpu_util_percent": 28.725000000000005, "ram_util_percent": 52.61666666666667, "gpu_util_percent0": 0.08333333333333333, "vram_util_percent0": 0.12216525607638888}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.05000000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 0.28903590232854887, "policy_loss": -0.00925270096669274, "vf_loss": 0.29777724949783213, "vf_explained_var": 0.8558911323547364, "kl": 0.010227086290925742, "entropy": 0.40176497787557625, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 55335.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 240000, "num_env_steps_trained": 240000, "num_agent_steps_sampled": 240000, "num_agent_steps_trained": 240000}, "sampler_results": {"episode_reward_max": -1.5000000000000009, "episode_reward_min": -63.10000000000035, "episode_reward_mean": -2.755172413793108, "episode_len_mean": 36.206896551724135, "episode_media": {}, "episodes_this_iter": 116, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-63.10000000000035, -1.9000000000000012, -1.700000000000001, -2.2000000000000015, -2.1000000000000014, -2.3000000000000016, -2.5000000000000018, -2.1000000000000014, -2.0000000000000013, -2.1000000000000014, -2.1000000000000014, -1.9000000000000012, -2.0000000000000013, -2.2000000000000015, -1.700000000000001, -2.5000000000000018, -2.5000000000000018, -1.9000000000000012, -2.1000000000000014, -2.800000000000002, -2.1000000000000014, -2.1000000000000014, -2.0000000000000013, -2.4000000000000017, -2.2000000000000015, -2.1000000000000014, -2.5000000000000018, -2.0000000000000013, -2.2000000000000015, -2.1000000000000014, -1.9000000000000012, -2.800000000000002, -2.700000000000002, -3.4000000000000004, -2.0000000000000013, -2.600000000000002, -2.3000000000000016, -2.0000000000000013, -2.1000000000000014, -1.9000000000000012, -1.9000000000000012, -2.0000000000000013, -1.9000000000000012, -1.8000000000000012, -2.0000000000000013, -2.4000000000000017, -2.0000000000000013, -1.600000000000001, -1.9000000000000012, -2.1000000000000014, -2.3000000000000016, -1.5000000000000009, -2.1000000000000014, -1.8000000000000012, -2.800000000000002, -2.3000000000000016, -1.9000000000000012, -2.5000000000000018, -1.8000000000000012, -2.0000000000000013, -2.4000000000000017, -2.800000000000002, -1.8000000000000012, -2.3000000000000016, -1.9000000000000012, -2.5000000000000018, -2.0000000000000013, -2.800000000000002, -1.9000000000000012, -2.2000000000000015, -3.3000000000000007, -2.4000000000000017, -2.5000000000000018, -2.2000000000000015, -2.700000000000002, -1.700000000000001, -2.2000000000000015, -2.5000000000000018, -4.400000000000002, -1.8000000000000012, -2.1000000000000014, -2.4000000000000017, -2.4000000000000017, -1.8000000000000012, -2.700000000000002, -2.0000000000000013, -2.0000000000000013, -2.0000000000000013, -2.4000000000000017, -2.1000000000000014, -2.1000000000000014, -2.2000000000000015, -1.8000000000000012, -2.1000000000000014, -1.5000000000000009, -2.3000000000000016, -1.700000000000001, -2.3000000000000016, -2.700000000000002, -2.2000000000000015, -2.2000000000000015, -2.2000000000000015, -1.9000000000000012, -1.9000000000000012, -2.0000000000000013, -3.1000000000000014, -2.700000000000002, -1.700000000000001, -2.2000000000000015, -1.700000000000001, -1.9000000000000012, -2.0000000000000013, -2.900000000000002, -6.1999999999999975, -2.1000000000000014, -2.1000000000000014], "episode_lengths": [400, 30, 28, 33, 32, 34, 36, 32, 31, 32, 32, 30, 31, 33, 28, 36, 36, 30, 32, 39, 32, 32, 31, 35, 33, 32, 36, 31, 33, 32, 30, 39, 38, 45, 31, 37, 34, 31, 32, 30, 30, 31, 30, 29, 31, 35, 31, 27, 30, 32, 34, 26, 32, 29, 39, 34, 30, 36, 29, 31, 35, 39, 29, 34, 30, 36, 31, 39, 30, 33, 38, 35, 36, 33, 38, 28, 33, 36, 49, 29, 32, 35, 35, 29, 38, 31, 31, 31, 35, 32, 32, 33, 29, 32, 26, 34, 28, 34, 38, 33, 33, 33, 30, 30, 31, 42, 38, 28, 33, 28, 30, 31, 40, 55, 32, 32]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3282823242922609, "mean_inference_ms": 0.7341859999227061, "mean_action_processing_ms": 0.07628382117848832, "mean_env_wait_ms": 6.906474698725911, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007083909264926253, "StateBufferConnector_ms": 0.003999882730944404, "ViewRequirementAgentConnector_ms": 0.09180800668124495}}, "episode_reward_max": -1.5000000000000009, "episode_reward_min": -63.10000000000035, "episode_reward_mean": -2.755172413793108, "episode_len_mean": 36.206896551724135, "episodes_this_iter": 116, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-63.10000000000035, -1.9000000000000012, -1.700000000000001, -2.2000000000000015, -2.1000000000000014, -2.3000000000000016, -2.5000000000000018, -2.1000000000000014, -2.0000000000000013, -2.1000000000000014, -2.1000000000000014, -1.9000000000000012, -2.0000000000000013, -2.2000000000000015, -1.700000000000001, -2.5000000000000018, -2.5000000000000018, -1.9000000000000012, -2.1000000000000014, -2.800000000000002, -2.1000000000000014, -2.1000000000000014, -2.0000000000000013, -2.4000000000000017, -2.2000000000000015, -2.1000000000000014, -2.5000000000000018, -2.0000000000000013, -2.2000000000000015, -2.1000000000000014, -1.9000000000000012, -2.800000000000002, -2.700000000000002, -3.4000000000000004, -2.0000000000000013, -2.600000000000002, -2.3000000000000016, -2.0000000000000013, -2.1000000000000014, -1.9000000000000012, -1.9000000000000012, -2.0000000000000013, -1.9000000000000012, -1.8000000000000012, -2.0000000000000013, -2.4000000000000017, -2.0000000000000013, -1.600000000000001, -1.9000000000000012, -2.1000000000000014, -2.3000000000000016, -1.5000000000000009, -2.1000000000000014, -1.8000000000000012, -2.800000000000002, -2.3000000000000016, -1.9000000000000012, -2.5000000000000018, -1.8000000000000012, -2.0000000000000013, -2.4000000000000017, -2.800000000000002, -1.8000000000000012, -2.3000000000000016, -1.9000000000000012, -2.5000000000000018, -2.0000000000000013, -2.800000000000002, -1.9000000000000012, -2.2000000000000015, -3.3000000000000007, -2.4000000000000017, -2.5000000000000018, -2.2000000000000015, -2.700000000000002, -1.700000000000001, -2.2000000000000015, -2.5000000000000018, -4.400000000000002, -1.8000000000000012, -2.1000000000000014, -2.4000000000000017, -2.4000000000000017, -1.8000000000000012, -2.700000000000002, -2.0000000000000013, -2.0000000000000013, -2.0000000000000013, -2.4000000000000017, -2.1000000000000014, -2.1000000000000014, -2.2000000000000015, -1.8000000000000012, -2.1000000000000014, -1.5000000000000009, -2.3000000000000016, -1.700000000000001, -2.3000000000000016, -2.700000000000002, -2.2000000000000015, -2.2000000000000015, -2.2000000000000015, -1.9000000000000012, -1.9000000000000012, -2.0000000000000013, -3.1000000000000014, -2.700000000000002, -1.700000000000001, -2.2000000000000015, -1.700000000000001, -1.9000000000000012, -2.0000000000000013, -2.900000000000002, -6.1999999999999975, -2.1000000000000014, -2.1000000000000014], "episode_lengths": [400, 30, 28, 33, 32, 34, 36, 32, 31, 32, 32, 30, 31, 33, 28, 36, 36, 30, 32, 39, 32, 32, 31, 35, 33, 32, 36, 31, 33, 32, 30, 39, 38, 45, 31, 37, 34, 31, 32, 30, 30, 31, 30, 29, 31, 35, 31, 27, 30, 32, 34, 26, 32, 29, 39, 34, 30, 36, 29, 31, 35, 39, 29, 34, 30, 36, 31, 39, 30, 33, 38, 35, 36, 33, 38, 28, 33, 36, 49, 29, 32, 35, 35, 29, 38, 31, 31, 31, 35, 32, 32, 33, 29, 32, 26, 34, 28, 34, 38, 33, 33, 33, 30, 30, 31, 42, 38, 28, 33, 28, 30, 31, 40, 55, 32, 32]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3282823242922609, "mean_inference_ms": 0.7341859999227061, "mean_action_processing_ms": 0.07628382117848832, "mean_env_wait_ms": 6.906474698725911, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007083909264926253, "StateBufferConnector_ms": 0.003999882730944404, "ViewRequirementAgentConnector_ms": 0.09180800668124495}, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 240000, "num_agent_steps_trained": 240000, "num_env_steps_sampled": 240000, "num_env_steps_trained": 240000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 399.9953747330488, "num_env_steps_trained_throughput_per_sec": 399.9953747330488, "timesteps_total": 240000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 240000, "timers": {"training_iteration_time_ms": 9915.954, "sample_time_ms": 5989.159, "load_time_ms": 2.39, "load_throughput": 1673821.596, "learn_time_ms": 3921.519, "learn_throughput": 1020.013, "synch_weights_time_ms": 2.198}, "counters": {"num_env_steps_sampled": 240000, "num_env_steps_trained": 240000, "num_agent_steps_sampled": 240000, "num_agent_steps_trained": 240000}, "done": false, "episodes_total": 4058, "training_iteration": 60, "trial_id": "ddfb6_00000", "date": "2024-03-07_12-57-45", "timestamp": 1709834265, "time_this_iter_s": 10.003089666366577, "time_total_s": 565.1731157302856, "pid": 112355, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4d85689f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 565.1731157302856, "iterations_since_restore": 60, "perf": {"cpu_util_percent": 29.330769230769228, "ram_util_percent": 52.300000000000004, "gpu_util_percent0": 0.11307692307692307, "vram_util_percent0": 0.1225147736378205}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.05000000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 0.044789834457239316, "policy_loss": -0.007702882852285139, "vf_loss": 0.05184035363547023, "vf_explained_var": 0.9580005058678248, "kl": 0.013047268826330114, "entropy": 0.3299191536922609, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 56265.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 244000, "num_env_steps_trained": 244000, "num_agent_steps_sampled": 244000, "num_agent_steps_trained": 244000}, "sampler_results": {"episode_reward_max": -1.4000000000000008, "episode_reward_min": -4.000000000000002, "episode_reward_mean": -2.1336000000000013, "episode_len_mean": 32.272, "episode_media": {}, "episodes_this_iter": 125, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2.5000000000000018, -2.0000000000000013, -2.0000000000000013, -2.600000000000002, -2.2000000000000015, -1.8000000000000012, -2.1000000000000014, -2.4000000000000017, -2.600000000000002, -2.5000000000000018, -1.8000000000000012, -2.600000000000002, -2.1000000000000014, -2.1000000000000014, -2.0000000000000013, -2.3000000000000016, -1.700000000000001, -1.8000000000000012, -2.1000000000000014, -2.4000000000000017, -2.700000000000002, -2.4000000000000017, -2.0000000000000013, -2.2000000000000015, -1.600000000000001, -2.1000000000000014, -2.4000000000000017, -1.4000000000000008, -2.3000000000000016, -1.8000000000000012, -2.1000000000000014, -2.0000000000000013, -2.800000000000002, -2.3000000000000016, -1.9000000000000012, -1.9000000000000012, -2.1000000000000014, -2.700000000000002, -2.5000000000000018, -1.8000000000000012, -1.8000000000000012, -1.700000000000001, -2.0000000000000013, -1.700000000000001, -2.1000000000000014, -2.2000000000000015, -1.9000000000000012, -2.900000000000002, -2.2000000000000015, -2.2000000000000015, -2.0000000000000013, -1.600000000000001, -2.1000000000000014, -1.9000000000000012, -2.1000000000000014, -2.0000000000000013, -1.700000000000001, -2.1000000000000014, -2.5000000000000018, -2.0000000000000013, -2.2000000000000015, -2.0000000000000013, -2.1000000000000014, -2.2000000000000015, -2.4000000000000017, -2.1000000000000014, -2.800000000000002, -1.600000000000001, -3.5999999999999996, -3.0000000000000018, -1.9000000000000012, -2.1000000000000014, -1.8000000000000012, -1.8000000000000012, -2.800000000000002, -2.0000000000000013, -2.5000000000000018, -1.9000000000000012, -2.0000000000000013, -2.2000000000000015, -2.1000000000000014, -1.9000000000000012, -1.700000000000001, -2.2000000000000015, -1.700000000000001, -2.0000000000000013, -2.4000000000000017, -1.8000000000000012, -1.700000000000001, -2.3000000000000016, -1.700000000000001, -2.1000000000000014, -2.3000000000000016, -1.5000000000000009, -1.600000000000001, -2.600000000000002, -2.700000000000002, -1.8000000000000012, -2.3000000000000016, -2.2000000000000015, -2.4000000000000017, -1.4000000000000008, -2.0000000000000013, -1.700000000000001, -1.9000000000000012, -2.2000000000000015, -1.600000000000001, -2.0000000000000013, -1.4000000000000008, -2.5000000000000018, -1.600000000000001, -2.600000000000002, -4.000000000000002, -3.0000000000000018, -1.9000000000000012, -2.0000000000000013, -1.600000000000001, -1.4000000000000008, -2.0000000000000013, -2.0000000000000013, -2.5000000000000018, -2.600000000000002, -2.800000000000002, -2.2000000000000015, -2.5000000000000018], "episode_lengths": [36, 31, 31, 37, 33, 29, 32, 35, 37, 36, 29, 37, 32, 32, 31, 34, 28, 29, 32, 35, 38, 35, 31, 33, 27, 32, 35, 25, 34, 29, 32, 31, 39, 34, 30, 30, 32, 38, 36, 29, 29, 28, 31, 28, 32, 33, 30, 40, 33, 33, 31, 27, 32, 30, 32, 31, 28, 32, 36, 31, 33, 31, 32, 33, 35, 32, 39, 27, 47, 41, 30, 32, 29, 29, 39, 31, 36, 30, 31, 33, 32, 30, 28, 33, 28, 31, 35, 29, 28, 34, 28, 32, 34, 26, 27, 37, 38, 29, 34, 33, 35, 25, 31, 28, 30, 33, 27, 31, 25, 36, 27, 37, 45, 41, 28, 31, 27, 25, 31, 31, 36, 37, 39, 33, 36]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3305701254992558, "mean_inference_ms": 0.7357901359082007, "mean_action_processing_ms": 0.07640436363321983, "mean_env_wait_ms": 6.922912496235552, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007832717895507813, "StateBufferConnector_ms": 0.004516029357910156, "ViewRequirementAgentConnector_ms": 0.10399665832519531}}, "episode_reward_max": -1.4000000000000008, "episode_reward_min": -4.000000000000002, "episode_reward_mean": -2.1336000000000013, "episode_len_mean": 32.272, "episodes_this_iter": 125, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-2.5000000000000018, -2.0000000000000013, -2.0000000000000013, -2.600000000000002, -2.2000000000000015, -1.8000000000000012, -2.1000000000000014, -2.4000000000000017, -2.600000000000002, -2.5000000000000018, -1.8000000000000012, -2.600000000000002, -2.1000000000000014, -2.1000000000000014, -2.0000000000000013, -2.3000000000000016, -1.700000000000001, -1.8000000000000012, -2.1000000000000014, -2.4000000000000017, -2.700000000000002, -2.4000000000000017, -2.0000000000000013, -2.2000000000000015, -1.600000000000001, -2.1000000000000014, -2.4000000000000017, -1.4000000000000008, -2.3000000000000016, -1.8000000000000012, -2.1000000000000014, -2.0000000000000013, -2.800000000000002, -2.3000000000000016, -1.9000000000000012, -1.9000000000000012, -2.1000000000000014, -2.700000000000002, -2.5000000000000018, -1.8000000000000012, -1.8000000000000012, -1.700000000000001, -2.0000000000000013, -1.700000000000001, -2.1000000000000014, -2.2000000000000015, -1.9000000000000012, -2.900000000000002, -2.2000000000000015, -2.2000000000000015, -2.0000000000000013, -1.600000000000001, -2.1000000000000014, -1.9000000000000012, -2.1000000000000014, -2.0000000000000013, -1.700000000000001, -2.1000000000000014, -2.5000000000000018, -2.0000000000000013, -2.2000000000000015, -2.0000000000000013, -2.1000000000000014, -2.2000000000000015, -2.4000000000000017, -2.1000000000000014, -2.800000000000002, -1.600000000000001, -3.5999999999999996, -3.0000000000000018, -1.9000000000000012, -2.1000000000000014, -1.8000000000000012, -1.8000000000000012, -2.800000000000002, -2.0000000000000013, -2.5000000000000018, -1.9000000000000012, -2.0000000000000013, -2.2000000000000015, -2.1000000000000014, -1.9000000000000012, -1.700000000000001, -2.2000000000000015, -1.700000000000001, -2.0000000000000013, -2.4000000000000017, -1.8000000000000012, -1.700000000000001, -2.3000000000000016, -1.700000000000001, -2.1000000000000014, -2.3000000000000016, -1.5000000000000009, -1.600000000000001, -2.600000000000002, -2.700000000000002, -1.8000000000000012, -2.3000000000000016, -2.2000000000000015, -2.4000000000000017, -1.4000000000000008, -2.0000000000000013, -1.700000000000001, -1.9000000000000012, -2.2000000000000015, -1.600000000000001, -2.0000000000000013, -1.4000000000000008, -2.5000000000000018, -1.600000000000001, -2.600000000000002, -4.000000000000002, -3.0000000000000018, -1.9000000000000012, -2.0000000000000013, -1.600000000000001, -1.4000000000000008, -2.0000000000000013, -2.0000000000000013, -2.5000000000000018, -2.600000000000002, -2.800000000000002, -2.2000000000000015, -2.5000000000000018], "episode_lengths": [36, 31, 31, 37, 33, 29, 32, 35, 37, 36, 29, 37, 32, 32, 31, 34, 28, 29, 32, 35, 38, 35, 31, 33, 27, 32, 35, 25, 34, 29, 32, 31, 39, 34, 30, 30, 32, 38, 36, 29, 29, 28, 31, 28, 32, 33, 30, 40, 33, 33, 31, 27, 32, 30, 32, 31, 28, 32, 36, 31, 33, 31, 32, 33, 35, 32, 39, 27, 47, 41, 30, 32, 29, 29, 39, 31, 36, 30, 31, 33, 32, 30, 28, 33, 28, 31, 35, 29, 28, 34, 28, 32, 34, 26, 27, 37, 38, 29, 34, 33, 35, 25, 31, 28, 30, 33, 27, 31, 25, 36, 27, 37, 45, 41, 28, 31, 27, 25, 31, 31, 36, 37, 39, 33, 36]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3305701254992558, "mean_inference_ms": 0.7357901359082007, "mean_action_processing_ms": 0.07640436363321983, "mean_env_wait_ms": 6.922912496235552, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007832717895507813, "StateBufferConnector_ms": 0.004516029357910156, "ViewRequirementAgentConnector_ms": 0.10399665832519531}, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 244000, "num_agent_steps_trained": 244000, "num_env_steps_sampled": 244000, "num_env_steps_trained": 244000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 366.63703217557475, "num_env_steps_trained_throughput_per_sec": 366.63703217557475, "timesteps_total": 244000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 244000, "timers": {"training_iteration_time_ms": 10042.668, "sample_time_ms": 6055.315, "load_time_ms": 2.41, "load_throughput": 1659877.912, "learn_time_ms": 3982.04, "learn_throughput": 1004.51, "synch_weights_time_ms": 2.217}, "counters": {"num_env_steps_sampled": 244000, "num_env_steps_trained": 244000, "num_agent_steps_sampled": 244000, "num_agent_steps_trained": 244000}, "done": false, "episodes_total": 4183, "training_iteration": 61, "trial_id": "ddfb6_00000", "date": "2024-03-07_12-57-56", "timestamp": 1709834276, "time_this_iter_s": 10.912886619567871, "time_total_s": 576.0860023498535, "pid": 112355, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4d85689f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 576.0860023498535, "iterations_since_restore": 61, "perf": {"cpu_util_percent": 37.40714285714285, "ram_util_percent": 53.107142857142854, "gpu_util_percent0": 0.12357142857142857, "vram_util_percent0": 0.12279110863095237}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.05000000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 0.027283026705438432, "policy_loss": -0.01426112582927109, "vf_loss": 0.040787913950700916, "vf_explained_var": 0.9645397434952439, "kl": 0.01512477947297441, "entropy": 0.32508973186054535, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 57195.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 248000, "num_env_steps_trained": 248000, "num_agent_steps_sampled": 248000, "num_agent_steps_trained": 248000}, "sampler_results": {"episode_reward_max": -1.4000000000000008, "episode_reward_min": -3.4000000000000004, "episode_reward_mean": -2.1414634146341474, "episode_len_mean": 32.36585365853659, "episode_media": {}, "episodes_this_iter": 123, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1.700000000000001, -2.1000000000000014, -2.4000000000000017, -1.700000000000001, -2.4000000000000017, -1.9000000000000012, -1.9000000000000012, -1.700000000000001, -1.5000000000000009, -2.2000000000000015, -2.2000000000000015, -2.700000000000002, -2.0000000000000013, -1.600000000000001, -2.900000000000002, -2.800000000000002, -2.1000000000000014, -2.0000000000000013, -2.4000000000000017, -2.0000000000000013, -2.0000000000000013, -2.700000000000002, -2.0000000000000013, -2.800000000000002, -2.3000000000000016, -1.4000000000000008, -2.2000000000000015, -2.5000000000000018, -2.5000000000000018, -2.5000000000000018, -2.2000000000000015, -2.4000000000000017, -2.5000000000000018, -1.9000000000000012, -1.9000000000000012, -2.0000000000000013, -2.1000000000000014, -1.600000000000001, -2.4000000000000017, -2.600000000000002, -2.4000000000000017, -2.0000000000000013, -1.600000000000001, -2.1000000000000014, -2.3000000000000016, -1.9000000000000012, -2.900000000000002, -1.9000000000000012, -2.4000000000000017, -2.4000000000000017, -2.4000000000000017, -2.3000000000000016, -1.8000000000000012, -2.4000000000000017, -2.2000000000000015, -2.1000000000000014, -1.9000000000000012, -1.9000000000000012, -2.1000000000000014, -2.1000000000000014, -1.700000000000001, -2.2000000000000015, -2.800000000000002, -1.9000000000000012, -1.8000000000000012, -2.4000000000000017, -1.9000000000000012, -1.700000000000001, -2.3000000000000016, -1.600000000000001, -2.900000000000002, -2.0000000000000013, -2.2000000000000015, -1.600000000000001, -1.700000000000001, -2.2000000000000015, -1.700000000000001, -2.4000000000000017, -1.9000000000000012, -2.3000000000000016, -2.3000000000000016, -1.600000000000001, -1.9000000000000012, -2.5000000000000018, -1.600000000000001, -1.8000000000000012, -2.0000000000000013, -1.9000000000000012, -2.1000000000000014, -1.700000000000001, -2.1000000000000014, -1.600000000000001, -3.0000000000000018, -2.2000000000000015, -2.2000000000000015, -2.1000000000000014, -2.0000000000000013, -2.1000000000000014, -1.8000000000000012, -1.700000000000001, -2.0000000000000013, -2.0000000000000013, -1.9000000000000012, -2.4000000000000017, -3.0000000000000018, -2.600000000000002, -1.9000000000000012, -2.2000000000000015, -3.4000000000000004, -1.8000000000000012, -1.700000000000001, -2.0000000000000013, -2.4000000000000017, -2.0000000000000013, -3.0000000000000018, -2.0000000000000013, -2.0000000000000013, -2.1000000000000014, -2.900000000000002, -2.1000000000000014, -2.3000000000000016, -2.2000000000000015, -2.3000000000000016], "episode_lengths": [28, 32, 35, 28, 35, 30, 30, 28, 26, 33, 33, 38, 31, 27, 36, 39, 32, 31, 35, 31, 31, 38, 31, 39, 34, 25, 33, 36, 36, 36, 33, 35, 36, 30, 30, 31, 32, 27, 35, 36, 35, 31, 27, 32, 34, 30, 40, 30, 35, 35, 35, 34, 29, 35, 33, 32, 30, 30, 32, 32, 28, 33, 39, 30, 29, 35, 30, 28, 34, 27, 40, 31, 33, 27, 28, 33, 28, 35, 30, 34, 34, 27, 30, 36, 27, 29, 31, 30, 32, 28, 32, 27, 41, 33, 33, 32, 31, 32, 29, 28, 31, 31, 30, 35, 41, 37, 30, 33, 45, 29, 28, 31, 34, 31, 41, 31, 31, 32, 40, 32, 34, 33, 34]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.33244198400582003, "mean_inference_ms": 0.7366371940085483, "mean_action_processing_ms": 0.07647996538120358, "mean_env_wait_ms": 6.936888394911693, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007554961413871951, "StateBufferConnector_ms": 0.004261877478622809, "ViewRequirementAgentConnector_ms": 0.09740096766774248}}, "episode_reward_max": -1.4000000000000008, "episode_reward_min": -3.4000000000000004, "episode_reward_mean": -2.1414634146341474, "episode_len_mean": 32.36585365853659, "episodes_this_iter": 123, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1.700000000000001, -2.1000000000000014, -2.4000000000000017, -1.700000000000001, -2.4000000000000017, -1.9000000000000012, -1.9000000000000012, -1.700000000000001, -1.5000000000000009, -2.2000000000000015, -2.2000000000000015, -2.700000000000002, -2.0000000000000013, -1.600000000000001, -2.900000000000002, -2.800000000000002, -2.1000000000000014, -2.0000000000000013, -2.4000000000000017, -2.0000000000000013, -2.0000000000000013, -2.700000000000002, -2.0000000000000013, -2.800000000000002, -2.3000000000000016, -1.4000000000000008, -2.2000000000000015, -2.5000000000000018, -2.5000000000000018, -2.5000000000000018, -2.2000000000000015, -2.4000000000000017, -2.5000000000000018, -1.9000000000000012, -1.9000000000000012, -2.0000000000000013, -2.1000000000000014, -1.600000000000001, -2.4000000000000017, -2.600000000000002, -2.4000000000000017, -2.0000000000000013, -1.600000000000001, -2.1000000000000014, -2.3000000000000016, -1.9000000000000012, -2.900000000000002, -1.9000000000000012, -2.4000000000000017, -2.4000000000000017, -2.4000000000000017, -2.3000000000000016, -1.8000000000000012, -2.4000000000000017, -2.2000000000000015, -2.1000000000000014, -1.9000000000000012, -1.9000000000000012, -2.1000000000000014, -2.1000000000000014, -1.700000000000001, -2.2000000000000015, -2.800000000000002, -1.9000000000000012, -1.8000000000000012, -2.4000000000000017, -1.9000000000000012, -1.700000000000001, -2.3000000000000016, -1.600000000000001, -2.900000000000002, -2.0000000000000013, -2.2000000000000015, -1.600000000000001, -1.700000000000001, -2.2000000000000015, -1.700000000000001, -2.4000000000000017, -1.9000000000000012, -2.3000000000000016, -2.3000000000000016, -1.600000000000001, -1.9000000000000012, -2.5000000000000018, -1.600000000000001, -1.8000000000000012, -2.0000000000000013, -1.9000000000000012, -2.1000000000000014, -1.700000000000001, -2.1000000000000014, -1.600000000000001, -3.0000000000000018, -2.2000000000000015, -2.2000000000000015, -2.1000000000000014, -2.0000000000000013, -2.1000000000000014, -1.8000000000000012, -1.700000000000001, -2.0000000000000013, -2.0000000000000013, -1.9000000000000012, -2.4000000000000017, -3.0000000000000018, -2.600000000000002, -1.9000000000000012, -2.2000000000000015, -3.4000000000000004, -1.8000000000000012, -1.700000000000001, -2.0000000000000013, -2.4000000000000017, -2.0000000000000013, -3.0000000000000018, -2.0000000000000013, -2.0000000000000013, -2.1000000000000014, -2.900000000000002, -2.1000000000000014, -2.3000000000000016, -2.2000000000000015, -2.3000000000000016], "episode_lengths": [28, 32, 35, 28, 35, 30, 30, 28, 26, 33, 33, 38, 31, 27, 36, 39, 32, 31, 35, 31, 31, 38, 31, 39, 34, 25, 33, 36, 36, 36, 33, 35, 36, 30, 30, 31, 32, 27, 35, 36, 35, 31, 27, 32, 34, 30, 40, 30, 35, 35, 35, 34, 29, 35, 33, 32, 30, 30, 32, 32, 28, 33, 39, 30, 29, 35, 30, 28, 34, 27, 40, 31, 33, 27, 28, 33, 28, 35, 30, 34, 34, 27, 30, 36, 27, 29, 31, 30, 32, 28, 32, 27, 41, 33, 33, 32, 31, 32, 29, 28, 31, 31, 30, 35, 41, 37, 30, 33, 45, 29, 28, 31, 34, 31, 41, 31, 31, 32, 40, 32, 34, 33, 34]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.33244198400582003, "mean_inference_ms": 0.7366371940085483, "mean_action_processing_ms": 0.07647996538120358, "mean_env_wait_ms": 6.936888394911693, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007554961413871951, "StateBufferConnector_ms": 0.004261877478622809, "ViewRequirementAgentConnector_ms": 0.09740096766774248}, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 248000, "num_agent_steps_trained": 248000, "num_env_steps_sampled": 248000, "num_env_steps_trained": 248000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 386.5061357203072, "num_env_steps_trained_throughput_per_sec": 386.5061357203072, "timesteps_total": 248000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 248000, "timers": {"training_iteration_time_ms": 10095.502, "sample_time_ms": 6077.762, "load_time_ms": 2.409, "load_throughput": 1660387.158, "learn_time_ms": 4012.428, "learn_throughput": 996.903, "synch_weights_time_ms": 2.204}, "counters": {"num_env_steps_sampled": 248000, "num_env_steps_trained": 248000, "num_agent_steps_sampled": 248000, "num_agent_steps_trained": 248000}, "done": false, "episodes_total": 4306, "training_iteration": 62, "trial_id": "ddfb6_00000", "date": "2024-03-07_12-58-06", "timestamp": 1709834286, "time_this_iter_s": 10.35218334197998, "time_total_s": 586.4381856918335, "pid": 112355, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4d85689f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 586.4381856918335, "iterations_since_restore": 62, "perf": {"cpu_util_percent": 32.91538461538461, "ram_util_percent": 53.30769230769231, "gpu_util_percent0": 0.13307692307692306, "vram_util_percent0": 0.12274013421474358}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.05000000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 0.3119158993739577, "policy_loss": -0.021676064330723978, "vf_loss": 0.33187672510738137, "vf_explained_var": 0.8423260602899777, "kl": 0.03430477298651426, "entropy": 0.3069172698163217, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 58125.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 252000, "num_env_steps_trained": 252000, "num_agent_steps_sampled": 252000, "num_agent_steps_trained": 252000}, "sampler_results": {"episode_reward_max": -1.4000000000000008, "episode_reward_min": -2.900000000000002, "episode_reward_mean": -1.9455284552845542, "episode_len_mean": 30.4390243902439, "episode_media": {}, "episodes_this_iter": 123, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1.9000000000000012, -1.700000000000001, -2.3000000000000016, -2.4000000000000017, -1.9000000000000012, -2.600000000000002, -2.2000000000000015, -2.1000000000000014, -2.2000000000000015, -1.5000000000000009, -1.600000000000001, -2.700000000000002, -2.4000000000000017, -1.8000000000000012, -2.0000000000000013, -1.600000000000001, -1.9000000000000012, -1.8000000000000012, -1.9000000000000012, -1.8000000000000012, -2.2000000000000015, -1.9000000000000012, -2.0000000000000013, -1.700000000000001, -1.4000000000000008, -1.8000000000000012, -1.9000000000000012, -2.4000000000000017, -2.900000000000002, -1.600000000000001, -1.8000000000000012, -2.2000000000000015, -2.0000000000000013, -1.9000000000000012, -1.8000000000000012, -2.0000000000000013, -2.1000000000000014, -1.8000000000000012, -1.700000000000001, -2.0000000000000013, -1.700000000000001, -1.600000000000001, -1.5000000000000009, -1.8000000000000012, -1.8000000000000012, -1.5000000000000009, -1.600000000000001, -1.8000000000000012, -1.9000000000000012, -2.0000000000000013, -1.9000000000000012, -2.1000000000000014, -1.600000000000001, -1.8000000000000012, -2.3000000000000016, -2.0000000000000013, -1.9000000000000012, -2.1000000000000014, -1.8000000000000012, -2.600000000000002, -1.8000000000000012, -1.8000000000000012, -1.700000000000001, -2.0000000000000013, -2.0000000000000013, -1.4000000000000008, -1.9000000000000012, -1.8000000000000012, -2.2000000000000015, -1.700000000000001, -2.0000000000000013, -1.4000000000000008, -1.8000000000000012, -1.8000000000000012, -1.9000000000000012, -1.9000000000000012, -1.700000000000001, -1.9000000000000012, -2.0000000000000013, -1.5000000000000009, -1.8000000000000012, -2.5000000000000018, -2.0000000000000013, -2.0000000000000013, -2.1000000000000014, -2.1000000000000014, -2.1000000000000014, -1.700000000000001, -1.700000000000001, -1.9000000000000012, -2.4000000000000017, -2.600000000000002, -2.0000000000000013, -2.0000000000000013, -2.0000000000000013, -1.700000000000001, -1.9000000000000012, -1.8000000000000012, -1.700000000000001, -2.1000000000000014, -1.8000000000000012, -2.4000000000000017, -2.600000000000002, -2.4000000000000017, -1.700000000000001, -1.9000000000000012, -1.700000000000001, -2.2000000000000015, -1.700000000000001, -1.8000000000000012, -2.2000000000000015, -2.5000000000000018, -1.4000000000000008, -2.700000000000002, -1.700000000000001, -2.3000000000000016, -1.8000000000000012, -1.600000000000001, -2.0000000000000013, -1.8000000000000012, -2.4000000000000017, -1.700000000000001, -2.0000000000000013], "episode_lengths": [30, 28, 34, 35, 30, 37, 33, 32, 33, 26, 27, 38, 35, 29, 31, 27, 30, 29, 30, 29, 33, 30, 31, 28, 25, 29, 30, 35, 38, 27, 29, 33, 31, 30, 29, 31, 32, 29, 28, 31, 28, 27, 26, 29, 29, 26, 27, 29, 30, 31, 30, 32, 27, 29, 34, 31, 30, 32, 29, 37, 29, 29, 28, 31, 31, 25, 30, 29, 33, 28, 31, 25, 29, 29, 30, 30, 28, 30, 31, 26, 29, 36, 31, 31, 32, 32, 32, 28, 28, 30, 35, 37, 31, 31, 31, 28, 30, 29, 28, 32, 29, 35, 37, 35, 28, 30, 28, 33, 28, 29, 33, 36, 25, 38, 28, 34, 29, 27, 31, 29, 35, 28, 31]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3340139417241071, "mean_inference_ms": 0.7373194259242867, "mean_action_processing_ms": 0.07655224834011119, "mean_env_wait_ms": 6.9542532932408525, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007236100793854008, "StateBufferConnector_ms": 0.004139566809181276, "ViewRequirementAgentConnector_ms": 0.094943705613051}}, "episode_reward_max": -1.4000000000000008, "episode_reward_min": -2.900000000000002, "episode_reward_mean": -1.9455284552845542, "episode_len_mean": 30.4390243902439, "episodes_this_iter": 123, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1.9000000000000012, -1.700000000000001, -2.3000000000000016, -2.4000000000000017, -1.9000000000000012, -2.600000000000002, -2.2000000000000015, -2.1000000000000014, -2.2000000000000015, -1.5000000000000009, -1.600000000000001, -2.700000000000002, -2.4000000000000017, -1.8000000000000012, -2.0000000000000013, -1.600000000000001, -1.9000000000000012, -1.8000000000000012, -1.9000000000000012, -1.8000000000000012, -2.2000000000000015, -1.9000000000000012, -2.0000000000000013, -1.700000000000001, -1.4000000000000008, -1.8000000000000012, -1.9000000000000012, -2.4000000000000017, -2.900000000000002, -1.600000000000001, -1.8000000000000012, -2.2000000000000015, -2.0000000000000013, -1.9000000000000012, -1.8000000000000012, -2.0000000000000013, -2.1000000000000014, -1.8000000000000012, -1.700000000000001, -2.0000000000000013, -1.700000000000001, -1.600000000000001, -1.5000000000000009, -1.8000000000000012, -1.8000000000000012, -1.5000000000000009, -1.600000000000001, -1.8000000000000012, -1.9000000000000012, -2.0000000000000013, -1.9000000000000012, -2.1000000000000014, -1.600000000000001, -1.8000000000000012, -2.3000000000000016, -2.0000000000000013, -1.9000000000000012, -2.1000000000000014, -1.8000000000000012, -2.600000000000002, -1.8000000000000012, -1.8000000000000012, -1.700000000000001, -2.0000000000000013, -2.0000000000000013, -1.4000000000000008, -1.9000000000000012, -1.8000000000000012, -2.2000000000000015, -1.700000000000001, -2.0000000000000013, -1.4000000000000008, -1.8000000000000012, -1.8000000000000012, -1.9000000000000012, -1.9000000000000012, -1.700000000000001, -1.9000000000000012, -2.0000000000000013, -1.5000000000000009, -1.8000000000000012, -2.5000000000000018, -2.0000000000000013, -2.0000000000000013, -2.1000000000000014, -2.1000000000000014, -2.1000000000000014, -1.700000000000001, -1.700000000000001, -1.9000000000000012, -2.4000000000000017, -2.600000000000002, -2.0000000000000013, -2.0000000000000013, -2.0000000000000013, -1.700000000000001, -1.9000000000000012, -1.8000000000000012, -1.700000000000001, -2.1000000000000014, -1.8000000000000012, -2.4000000000000017, -2.600000000000002, -2.4000000000000017, -1.700000000000001, -1.9000000000000012, -1.700000000000001, -2.2000000000000015, -1.700000000000001, -1.8000000000000012, -2.2000000000000015, -2.5000000000000018, -1.4000000000000008, -2.700000000000002, -1.700000000000001, -2.3000000000000016, -1.8000000000000012, -1.600000000000001, -2.0000000000000013, -1.8000000000000012, -2.4000000000000017, -1.700000000000001, -2.0000000000000013], "episode_lengths": [30, 28, 34, 35, 30, 37, 33, 32, 33, 26, 27, 38, 35, 29, 31, 27, 30, 29, 30, 29, 33, 30, 31, 28, 25, 29, 30, 35, 38, 27, 29, 33, 31, 30, 29, 31, 32, 29, 28, 31, 28, 27, 26, 29, 29, 26, 27, 29, 30, 31, 30, 32, 27, 29, 34, 31, 30, 32, 29, 37, 29, 29, 28, 31, 31, 25, 30, 29, 33, 28, 31, 25, 29, 29, 30, 30, 28, 30, 31, 26, 29, 36, 31, 31, 32, 32, 32, 28, 28, 30, 35, 37, 31, 31, 31, 28, 30, 29, 28, 32, 29, 35, 37, 35, 28, 30, 28, 33, 28, 29, 33, 36, 25, 38, 28, 34, 29, 27, 31, 29, 35, 28, 31]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3340139417241071, "mean_inference_ms": 0.7373194259242867, "mean_action_processing_ms": 0.07655224834011119, "mean_env_wait_ms": 6.9542532932408525, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007236100793854008, "StateBufferConnector_ms": 0.004139566809181276, "ViewRequirementAgentConnector_ms": 0.094943705613051}, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 252000, "num_agent_steps_trained": 252000, "num_env_steps_sampled": 252000, "num_env_steps_trained": 252000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 393.859560367585, "num_env_steps_trained_throughput_per_sec": 393.859560367585, "timesteps_total": 252000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 252000, "timers": {"training_iteration_time_ms": 10154.227, "sample_time_ms": 6120.193, "load_time_ms": 2.408, "load_throughput": 1660814.508, "learn_time_ms": 4027.331, "learn_throughput": 993.214, "synch_weights_time_ms": 3.569}, "counters": {"num_env_steps_sampled": 252000, "num_env_steps_trained": 252000, "num_agent_steps_sampled": 252000, "num_agent_steps_trained": 252000}, "done": false, "episodes_total": 4429, "training_iteration": 63, "trial_id": "ddfb6_00000", "date": "2024-03-07_12-58-16", "timestamp": 1709834296, "time_this_iter_s": 10.159772396087646, "time_total_s": 596.5979580879211, "pid": 112355, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4d85689f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 596.5979580879211, "iterations_since_restore": 63, "perf": {"cpu_util_percent": 29.300000000000008, "ram_util_percent": 53.642857142857146, "gpu_util_percent0": 0.09928571428571428, "vram_util_percent0": 0.1236630394345238}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.075, "cur_lr": 0.0010000000000000005, "total_loss": 1.3152601590042092, "policy_loss": -0.007676812587806615, "vf_loss": 1.3211491961347601, "vf_explained_var": 0.4966813746319022, "kl": 0.023837050416362388, "entropy": 0.45153426068123953, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 59055.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 256000, "num_env_steps_trained": 256000, "num_agent_steps_sampled": 256000, "num_agent_steps_trained": 256000}, "sampler_results": {"episode_reward_max": -1.4000000000000008, "episode_reward_min": -74.30000000000045, "episode_reward_mean": -3.3067961165048647, "episode_len_mean": 37.689320388349515, "episode_media": {}, "episodes_this_iter": 103, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1.8000000000000012, -1.9000000000000012, -1.4000000000000008, -1.8000000000000012, -1.9000000000000012, -2.0000000000000013, -1.8000000000000012, -2.1000000000000014, -1.600000000000001, -1.700000000000001, -2.3000000000000016, -2.5000000000000018, -2.1000000000000014, -2.2000000000000015, -1.700000000000001, -1.700000000000001, -2.2000000000000015, -1.600000000000001, -1.700000000000001, -1.600000000000001, -1.9000000000000012, -1.9000000000000012, -3.3000000000000016, -1.700000000000001, -1.9000000000000012, -1.600000000000001, -2.2000000000000015, -2.0000000000000013, -1.600000000000001, -2.0000000000000013, -1.4000000000000008, -2.0000000000000013, -1.700000000000001, -2.4000000000000017, -3.200000000000001, -2.4000000000000017, -1.8000000000000012, -1.700000000000001, -2.800000000000002, -2.2000000000000015, -1.600000000000001, -1.700000000000001, -1.600000000000001, -1.9000000000000012, -1.4000000000000008, -1.8000000000000012, -2.3000000000000016, -1.600000000000001, -1.9000000000000012, -1.8000000000000012, -1.700000000000001, -1.8000000000000012, -2.5000000000000018, -2.2000000000000015, -2.900000000000002, -2.1000000000000014, -1.700000000000001, -69.00000000000048, -2.5000000000000018, -1.8000000000000012, -2.0000000000000013, -1.700000000000001, -74.30000000000045, -1.700000000000001, -1.600000000000001, -1.600000000000001, -1.9000000000000012, -1.9000000000000012, -2.800000000000002, -1.5000000000000009, -2.1000000000000014, -2.1000000000000014, -1.5000000000000009, -2.2000000000000015, -2.0000000000000013, -1.700000000000001, -1.600000000000001, -2.0000000000000013, -2.2000000000000015, -1.8000000000000012, -2.0000000000000013, -1.9000000000000012, -1.9000000000000012, -1.9000000000000012, -2.3000000000000016, -1.8000000000000012, -1.8000000000000012, -2.900000000000002, -1.600000000000001, -2.0000000000000013, -1.8000000000000012, -1.700000000000001, -1.4000000000000008, -2.5000000000000018, -1.8000000000000012, -1.700000000000001, -2.600000000000002, -1.600000000000001, -2.2000000000000015, -2.0000000000000013, -1.8000000000000012, -2.1000000000000014, -2.0000000000000013], "episode_lengths": [29, 30, 25, 29, 30, 31, 29, 32, 27, 28, 34, 36, 32, 33, 28, 28, 33, 27, 28, 27, 30, 30, 43, 28, 30, 27, 33, 31, 27, 31, 25, 31, 28, 35, 43, 35, 29, 28, 39, 33, 27, 28, 27, 30, 25, 29, 34, 27, 30, 29, 28, 29, 36, 33, 40, 32, 28, 400, 36, 29, 31, 28, 400, 28, 27, 27, 30, 30, 39, 26, 32, 32, 26, 33, 31, 28, 27, 31, 33, 29, 31, 29, 30, 30, 34, 29, 29, 40, 27, 31, 29, 28, 25, 36, 29, 28, 37, 27, 33, 31, 29, 32, 31]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.33537462743850194, "mean_inference_ms": 0.7373518753994343, "mean_action_processing_ms": 0.07654936465872714, "mean_env_wait_ms": 6.973654628964024, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007258109676027761, "StateBufferConnector_ms": 0.004079503920471784, "ViewRequirementAgentConnector_ms": 0.09271589297692752}}, "episode_reward_max": -1.4000000000000008, "episode_reward_min": -74.30000000000045, "episode_reward_mean": -3.3067961165048647, "episode_len_mean": 37.689320388349515, "episodes_this_iter": 103, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1.8000000000000012, -1.9000000000000012, -1.4000000000000008, -1.8000000000000012, -1.9000000000000012, -2.0000000000000013, -1.8000000000000012, -2.1000000000000014, -1.600000000000001, -1.700000000000001, -2.3000000000000016, -2.5000000000000018, -2.1000000000000014, -2.2000000000000015, -1.700000000000001, -1.700000000000001, -2.2000000000000015, -1.600000000000001, -1.700000000000001, -1.600000000000001, -1.9000000000000012, -1.9000000000000012, -3.3000000000000016, -1.700000000000001, -1.9000000000000012, -1.600000000000001, -2.2000000000000015, -2.0000000000000013, -1.600000000000001, -2.0000000000000013, -1.4000000000000008, -2.0000000000000013, -1.700000000000001, -2.4000000000000017, -3.200000000000001, -2.4000000000000017, -1.8000000000000012, -1.700000000000001, -2.800000000000002, -2.2000000000000015, -1.600000000000001, -1.700000000000001, -1.600000000000001, -1.9000000000000012, -1.4000000000000008, -1.8000000000000012, -2.3000000000000016, -1.600000000000001, -1.9000000000000012, -1.8000000000000012, -1.700000000000001, -1.8000000000000012, -2.5000000000000018, -2.2000000000000015, -2.900000000000002, -2.1000000000000014, -1.700000000000001, -69.00000000000048, -2.5000000000000018, -1.8000000000000012, -2.0000000000000013, -1.700000000000001, -74.30000000000045, -1.700000000000001, -1.600000000000001, -1.600000000000001, -1.9000000000000012, -1.9000000000000012, -2.800000000000002, -1.5000000000000009, -2.1000000000000014, -2.1000000000000014, -1.5000000000000009, -2.2000000000000015, -2.0000000000000013, -1.700000000000001, -1.600000000000001, -2.0000000000000013, -2.2000000000000015, -1.8000000000000012, -2.0000000000000013, -1.9000000000000012, -1.9000000000000012, -1.9000000000000012, -2.3000000000000016, -1.8000000000000012, -1.8000000000000012, -2.900000000000002, -1.600000000000001, -2.0000000000000013, -1.8000000000000012, -1.700000000000001, -1.4000000000000008, -2.5000000000000018, -1.8000000000000012, -1.700000000000001, -2.600000000000002, -1.600000000000001, -2.2000000000000015, -2.0000000000000013, -1.8000000000000012, -2.1000000000000014, -2.0000000000000013], "episode_lengths": [29, 30, 25, 29, 30, 31, 29, 32, 27, 28, 34, 36, 32, 33, 28, 28, 33, 27, 28, 27, 30, 30, 43, 28, 30, 27, 33, 31, 27, 31, 25, 31, 28, 35, 43, 35, 29, 28, 39, 33, 27, 28, 27, 30, 25, 29, 34, 27, 30, 29, 28, 29, 36, 33, 40, 32, 28, 400, 36, 29, 31, 28, 400, 28, 27, 27, 30, 30, 39, 26, 32, 32, 26, 33, 31, 28, 27, 31, 33, 29, 31, 29, 30, 30, 34, 29, 29, 40, 27, 31, 29, 28, 25, 36, 29, 28, 37, 27, 33, 31, 29, 32, 31]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.33537462743850194, "mean_inference_ms": 0.7373518753994343, "mean_action_processing_ms": 0.07654936465872714, "mean_env_wait_ms": 6.973654628964024, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007258109676027761, "StateBufferConnector_ms": 0.004079503920471784, "ViewRequirementAgentConnector_ms": 0.09271589297692752}, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 256000, "num_agent_steps_trained": 256000, "num_env_steps_sampled": 256000, "num_env_steps_trained": 256000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 412.80544029081284, "num_env_steps_trained_throughput_per_sec": 412.80544029081284, "timesteps_total": 256000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 256000, "timers": {"training_iteration_time_ms": 10043.648, "sample_time_ms": 6120.846, "load_time_ms": 2.408, "load_throughput": 1661258.528, "learn_time_ms": 3916.124, "learn_throughput": 1021.418, "synch_weights_time_ms": 3.544}, "counters": {"num_env_steps_sampled": 256000, "num_env_steps_trained": 256000, "num_agent_steps_sampled": 256000, "num_agent_steps_trained": 256000}, "done": false, "episodes_total": 4532, "training_iteration": 64, "trial_id": "ddfb6_00000", "date": "2024-03-07_12-58-26", "timestamp": 1709834306, "time_this_iter_s": 9.692591905593872, "time_total_s": 606.290549993515, "pid": 112355, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4d85689f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 606.290549993515, "iterations_since_restore": 64, "perf": {"cpu_util_percent": 29.541666666666668, "ram_util_percent": 53.300000000000004, "gpu_util_percent0": 0.08999999999999998, "vram_util_percent0": 0.12296549479166664}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.11250000000000003, "cur_lr": 0.0010000000000000005, "total_loss": 0.1244115194843416, "policy_loss": -0.013460017023708231, "vf_loss": 0.13682220813928433, "vf_explained_var": 0.8767041924179241, "kl": 0.009327369993495399, "entropy": 0.3321203212584219, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 59985.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 260000, "num_env_steps_trained": 260000, "num_agent_steps_sampled": 260000, "num_agent_steps_trained": 260000}, "sampler_results": {"episode_reward_max": -1.4000000000000008, "episode_reward_min": -73.3000000000005, "episode_reward_mean": -2.7144000000000053, "episode_len_mean": 34.936, "episode_media": {}, "episodes_this_iter": 125, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-73.3000000000005, -1.8000000000000012, -1.700000000000001, -1.8000000000000012, -2.0000000000000013, -1.700000000000001, -1.700000000000001, -1.9000000000000012, -1.700000000000001, -2.2000000000000015, -1.700000000000001, -2.1000000000000014, -2.2000000000000015, -2.1000000000000014, -2.4000000000000017, -2.1000000000000014, -1.9000000000000012, -2.3000000000000016, -1.5000000000000009, -1.9000000000000012, -2.0000000000000013, -1.8000000000000012, -2.700000000000002, -2.0000000000000013, -2.0000000000000013, -2.3000000000000016, -1.700000000000001, -2.0000000000000013, -2.5000000000000018, -2.0000000000000013, -1.4000000000000008, -2.1000000000000014, -2.0000000000000013, -2.0000000000000013, -1.8000000000000012, -1.700000000000001, -3.4000000000000004, -4.0, -2.1000000000000014, -1.5000000000000009, -2.700000000000002, -2.1000000000000014, -2.0000000000000013, -2.2000000000000015, -2.1000000000000014, -2.2000000000000015, -1.8000000000000012, -1.8000000000000012, -2.5000000000000018, -1.9000000000000012, -2.5000000000000018, -7.499999999999998, -1.8000000000000012, -2.0000000000000013, -1.8000000000000012, -2.0000000000000013, -1.8000000000000012, -1.600000000000001, -1.9000000000000012, -1.700000000000001, -2.4000000000000017, -2.3000000000000016, -2.0000000000000013, -3.4000000000000004, -2.2000000000000015, -2.2000000000000015, -1.9000000000000012, -2.2000000000000015, -1.9000000000000012, -2.2000000000000015, -1.9000000000000012, -2.0000000000000013, -2.3000000000000016, -1.5000000000000009, -3.3000000000000007, -1.9000000000000012, -2.3000000000000016, -1.9000000000000012, -2.2000000000000015, -2.800000000000002, -3.0000000000000018, -2.1000000000000014, -2.0000000000000013, -1.8000000000000012, -1.700000000000001, -2.0000000000000013, -2.0000000000000013, -2.0000000000000013, -6.299999999999996, -2.1000000000000014, -1.5000000000000009, -2.2000000000000015, -2.0000000000000013, -2.1000000000000014, -2.1000000000000014, -2.3000000000000016, -2.2000000000000015, -2.1000000000000014, -1.700000000000001, -1.9000000000000012, -2.0000000000000013, -1.9000000000000012, -1.9000000000000012, -1.8000000000000012, -1.9000000000000012, -2.4000000000000017, -1.8000000000000012, -2.4000000000000017, -2.0000000000000013, -1.8000000000000012, -1.4000000000000008, -1.9000000000000012, -1.600000000000001, -1.600000000000001, -2.1000000000000014, -3.3000000000000007, -1.9000000000000012, -2.1000000000000014, -2.600000000000002, -1.9000000000000012, -2.3000000000000016, -2.4000000000000017, -1.4000000000000008, -2.0000000000000013, -2.1000000000000014], "episode_lengths": [400, 29, 28, 29, 31, 28, 28, 30, 28, 33, 28, 32, 33, 32, 35, 32, 30, 34, 26, 30, 31, 29, 38, 31, 31, 34, 28, 31, 36, 31, 25, 32, 31, 31, 29, 28, 45, 46, 32, 26, 38, 32, 31, 33, 32, 33, 29, 29, 36, 30, 36, 62, 29, 31, 29, 31, 29, 27, 30, 28, 35, 34, 31, 45, 33, 33, 30, 33, 30, 33, 30, 31, 34, 26, 39, 30, 34, 30, 33, 37, 41, 32, 31, 29, 28, 31, 31, 31, 53, 32, 26, 33, 31, 32, 32, 34, 33, 32, 28, 30, 31, 30, 30, 29, 30, 35, 29, 35, 31, 29, 25, 30, 27, 27, 32, 44, 30, 32, 37, 30, 34, 35, 25, 31, 32]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3361876102792599, "mean_inference_ms": 0.7371010131363372, "mean_action_processing_ms": 0.07650131215251581, "mean_env_wait_ms": 6.966387500620365, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006978797912597656, "StateBufferConnector_ms": 0.003909873962402344, "ViewRequirementAgentConnector_ms": 0.08945598602294921}}, "episode_reward_max": -1.4000000000000008, "episode_reward_min": -73.3000000000005, "episode_reward_mean": -2.7144000000000053, "episode_len_mean": 34.936, "episodes_this_iter": 125, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-73.3000000000005, -1.8000000000000012, -1.700000000000001, -1.8000000000000012, -2.0000000000000013, -1.700000000000001, -1.700000000000001, -1.9000000000000012, -1.700000000000001, -2.2000000000000015, -1.700000000000001, -2.1000000000000014, -2.2000000000000015, -2.1000000000000014, -2.4000000000000017, -2.1000000000000014, -1.9000000000000012, -2.3000000000000016, -1.5000000000000009, -1.9000000000000012, -2.0000000000000013, -1.8000000000000012, -2.700000000000002, -2.0000000000000013, -2.0000000000000013, -2.3000000000000016, -1.700000000000001, -2.0000000000000013, -2.5000000000000018, -2.0000000000000013, -1.4000000000000008, -2.1000000000000014, -2.0000000000000013, -2.0000000000000013, -1.8000000000000012, -1.700000000000001, -3.4000000000000004, -4.0, -2.1000000000000014, -1.5000000000000009, -2.700000000000002, -2.1000000000000014, -2.0000000000000013, -2.2000000000000015, -2.1000000000000014, -2.2000000000000015, -1.8000000000000012, -1.8000000000000012, -2.5000000000000018, -1.9000000000000012, -2.5000000000000018, -7.499999999999998, -1.8000000000000012, -2.0000000000000013, -1.8000000000000012, -2.0000000000000013, -1.8000000000000012, -1.600000000000001, -1.9000000000000012, -1.700000000000001, -2.4000000000000017, -2.3000000000000016, -2.0000000000000013, -3.4000000000000004, -2.2000000000000015, -2.2000000000000015, -1.9000000000000012, -2.2000000000000015, -1.9000000000000012, -2.2000000000000015, -1.9000000000000012, -2.0000000000000013, -2.3000000000000016, -1.5000000000000009, -3.3000000000000007, -1.9000000000000012, -2.3000000000000016, -1.9000000000000012, -2.2000000000000015, -2.800000000000002, -3.0000000000000018, -2.1000000000000014, -2.0000000000000013, -1.8000000000000012, -1.700000000000001, -2.0000000000000013, -2.0000000000000013, -2.0000000000000013, -6.299999999999996, -2.1000000000000014, -1.5000000000000009, -2.2000000000000015, -2.0000000000000013, -2.1000000000000014, -2.1000000000000014, -2.3000000000000016, -2.2000000000000015, -2.1000000000000014, -1.700000000000001, -1.9000000000000012, -2.0000000000000013, -1.9000000000000012, -1.9000000000000012, -1.8000000000000012, -1.9000000000000012, -2.4000000000000017, -1.8000000000000012, -2.4000000000000017, -2.0000000000000013, -1.8000000000000012, -1.4000000000000008, -1.9000000000000012, -1.600000000000001, -1.600000000000001, -2.1000000000000014, -3.3000000000000007, -1.9000000000000012, -2.1000000000000014, -2.600000000000002, -1.9000000000000012, -2.3000000000000016, -2.4000000000000017, -1.4000000000000008, -2.0000000000000013, -2.1000000000000014], "episode_lengths": [400, 29, 28, 29, 31, 28, 28, 30, 28, 33, 28, 32, 33, 32, 35, 32, 30, 34, 26, 30, 31, 29, 38, 31, 31, 34, 28, 31, 36, 31, 25, 32, 31, 31, 29, 28, 45, 46, 32, 26, 38, 32, 31, 33, 32, 33, 29, 29, 36, 30, 36, 62, 29, 31, 29, 31, 29, 27, 30, 28, 35, 34, 31, 45, 33, 33, 30, 33, 30, 33, 30, 31, 34, 26, 39, 30, 34, 30, 33, 37, 41, 32, 31, 29, 28, 31, 31, 31, 53, 32, 26, 33, 31, 32, 32, 34, 33, 32, 28, 30, 31, 30, 30, 29, 30, 35, 29, 35, 31, 29, 25, 30, 27, 27, 32, 44, 30, 32, 37, 30, 34, 35, 25, 31, 32]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3361876102792599, "mean_inference_ms": 0.7371010131363372, "mean_action_processing_ms": 0.07650131215251581, "mean_env_wait_ms": 6.966387500620365, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006978797912597656, "StateBufferConnector_ms": 0.003909873962402344, "ViewRequirementAgentConnector_ms": 0.08945598602294921}, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 260000, "num_agent_steps_trained": 260000, "num_env_steps_sampled": 260000, "num_env_steps_trained": 260000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 422.064610751855, "num_env_steps_trained_throughput_per_sec": 422.064610751855, "timesteps_total": 260000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 260000, "timers": {"training_iteration_time_ms": 9970.364, "sample_time_ms": 6106.437, "load_time_ms": 1.042, "load_throughput": 3837160.305, "learn_time_ms": 3858.684, "learn_throughput": 1036.623, "synch_weights_time_ms": 3.494}, "counters": {"num_env_steps_sampled": 260000, "num_env_steps_trained": 260000, "num_agent_steps_sampled": 260000, "num_agent_steps_trained": 260000}, "done": false, "episodes_total": 4657, "training_iteration": 65, "trial_id": "ddfb6_00000", "date": "2024-03-07_12-58-35", "timestamp": 1709834315, "time_this_iter_s": 9.480169534683228, "time_total_s": 615.7707195281982, "pid": 112355, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4d85689f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 615.7707195281982, "iterations_since_restore": 65, "perf": {"cpu_util_percent": 28.158333333333335, "ram_util_percent": 53.18333333333334, "gpu_util_percent0": 0.08416666666666667, "vram_util_percent0": 0.12288411458333331}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.11250000000000003, "cur_lr": 0.0010000000000000005, "total_loss": 1.2858213647158556, "policy_loss": -0.010516820917086256, "vf_loss": 1.294492576942749, "vf_explained_var": 0.536495780239823, "kl": 0.016405468429979534, "entropy": 0.37261488966403467, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 60915.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 264000, "num_env_steps_trained": 264000, "num_agent_steps_sampled": 264000, "num_agent_steps_trained": 264000}, "sampler_results": {"episode_reward_max": -1.4000000000000008, "episode_reward_min": -76.50000000000055, "episode_reward_mean": -3.280188679245289, "episode_len_mean": 37.83018867924528, "episode_media": {}, "episodes_this_iter": 106, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2.3000000000000016, -1.9000000000000012, -2.0000000000000013, -2.3000000000000016, -1.600000000000001, -2.4000000000000017, -2.900000000000002, -1.700000000000001, -1.8000000000000012, -21.299999999999965, -1.700000000000001, -31.10000000000003, -13.399999999999983, -1.9000000000000012, -3.0000000000000018, -1.700000000000001, -1.700000000000001, -1.600000000000001, -1.600000000000001, -1.8000000000000012, -2.1000000000000014, -1.8000000000000012, -1.5000000000000009, -2.0000000000000013, -2.1000000000000014, -1.600000000000001, -1.8000000000000012, -1.4000000000000008, -2.0000000000000013, -2.0000000000000013, -1.9000000000000012, -3.0000000000000018, -2.4000000000000017, -2.0000000000000013, -1.9000000000000012, -2.3000000000000016, -76.50000000000055, -2.0000000000000013, -2.0000000000000013, -1.700000000000001, -3.200000000000001, -1.9000000000000012, -1.9000000000000012, -2.1000000000000014, -1.9000000000000012, -1.9000000000000012, -1.5000000000000009, -1.600000000000001, -1.5000000000000009, -1.9000000000000012, -2.700000000000002, -3.3000000000000007, -1.600000000000001, -1.700000000000001, -1.700000000000001, -1.8000000000000012, -2.700000000000002, -1.5000000000000009, -1.700000000000001, -2.2000000000000015, -2.0000000000000013, -1.9000000000000012, -3.3000000000000016, -2.700000000000002, -2.3000000000000016, -2.2000000000000015, -2.800000000000002, -1.9000000000000012, -2.1000000000000014, -1.700000000000001, -1.9000000000000012, -2.4000000000000017, -1.9000000000000012, -1.8000000000000012, -1.8000000000000012, -2.5000000000000018, -1.8000000000000012, -1.600000000000001, -2.3000000000000016, -1.700000000000001, -2.0000000000000013, -1.8000000000000012, -1.5000000000000009, -2.5000000000000018, -1.5000000000000009, -2.1000000000000014, -1.700000000000001, -1.8000000000000012, -1.8000000000000012, -2.900000000000002, -1.600000000000001, -1.700000000000001, -2.0000000000000013, -1.9000000000000012, -2.1000000000000014, -2.3000000000000016, -1.700000000000001, -1.9000000000000012, -2.0000000000000013, -2.4000000000000017, -1.600000000000001, -1.9000000000000012, -2.600000000000002, -1.8000000000000012, -1.8000000000000012, -2.2000000000000015], "episode_lengths": [34, 30, 31, 34, 27, 35, 40, 28, 29, 134, 28, 227, 87, 30, 41, 28, 28, 27, 27, 29, 32, 29, 26, 31, 32, 27, 29, 25, 31, 31, 30, 41, 35, 31, 30, 34, 400, 31, 31, 28, 40, 30, 30, 32, 30, 30, 26, 27, 26, 30, 38, 40, 27, 28, 28, 29, 38, 26, 28, 33, 31, 30, 41, 38, 34, 33, 39, 30, 32, 28, 30, 35, 30, 29, 29, 36, 29, 27, 34, 28, 31, 29, 26, 36, 26, 32, 28, 29, 29, 40, 27, 28, 31, 30, 32, 34, 28, 30, 31, 35, 27, 30, 33, 29, 29, 33]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.33687907083299856, "mean_inference_ms": 0.7369103654694996, "mean_action_processing_ms": 0.0764464190665902, "mean_env_wait_ms": 6.9772138697286765, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006915263409884471, "StateBufferConnector_ms": 0.00391613762333708, "ViewRequirementAgentConnector_ms": 0.08895284724685382}}, "episode_reward_max": -1.4000000000000008, "episode_reward_min": -76.50000000000055, "episode_reward_mean": -3.280188679245289, "episode_len_mean": 37.83018867924528, "episodes_this_iter": 106, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-2.3000000000000016, -1.9000000000000012, -2.0000000000000013, -2.3000000000000016, -1.600000000000001, -2.4000000000000017, -2.900000000000002, -1.700000000000001, -1.8000000000000012, -21.299999999999965, -1.700000000000001, -31.10000000000003, -13.399999999999983, -1.9000000000000012, -3.0000000000000018, -1.700000000000001, -1.700000000000001, -1.600000000000001, -1.600000000000001, -1.8000000000000012, -2.1000000000000014, -1.8000000000000012, -1.5000000000000009, -2.0000000000000013, -2.1000000000000014, -1.600000000000001, -1.8000000000000012, -1.4000000000000008, -2.0000000000000013, -2.0000000000000013, -1.9000000000000012, -3.0000000000000018, -2.4000000000000017, -2.0000000000000013, -1.9000000000000012, -2.3000000000000016, -76.50000000000055, -2.0000000000000013, -2.0000000000000013, -1.700000000000001, -3.200000000000001, -1.9000000000000012, -1.9000000000000012, -2.1000000000000014, -1.9000000000000012, -1.9000000000000012, -1.5000000000000009, -1.600000000000001, -1.5000000000000009, -1.9000000000000012, -2.700000000000002, -3.3000000000000007, -1.600000000000001, -1.700000000000001, -1.700000000000001, -1.8000000000000012, -2.700000000000002, -1.5000000000000009, -1.700000000000001, -2.2000000000000015, -2.0000000000000013, -1.9000000000000012, -3.3000000000000016, -2.700000000000002, -2.3000000000000016, -2.2000000000000015, -2.800000000000002, -1.9000000000000012, -2.1000000000000014, -1.700000000000001, -1.9000000000000012, -2.4000000000000017, -1.9000000000000012, -1.8000000000000012, -1.8000000000000012, -2.5000000000000018, -1.8000000000000012, -1.600000000000001, -2.3000000000000016, -1.700000000000001, -2.0000000000000013, -1.8000000000000012, -1.5000000000000009, -2.5000000000000018, -1.5000000000000009, -2.1000000000000014, -1.700000000000001, -1.8000000000000012, -1.8000000000000012, -2.900000000000002, -1.600000000000001, -1.700000000000001, -2.0000000000000013, -1.9000000000000012, -2.1000000000000014, -2.3000000000000016, -1.700000000000001, -1.9000000000000012, -2.0000000000000013, -2.4000000000000017, -1.600000000000001, -1.9000000000000012, -2.600000000000002, -1.8000000000000012, -1.8000000000000012, -2.2000000000000015], "episode_lengths": [34, 30, 31, 34, 27, 35, 40, 28, 29, 134, 28, 227, 87, 30, 41, 28, 28, 27, 27, 29, 32, 29, 26, 31, 32, 27, 29, 25, 31, 31, 30, 41, 35, 31, 30, 34, 400, 31, 31, 28, 40, 30, 30, 32, 30, 30, 26, 27, 26, 30, 38, 40, 27, 28, 28, 29, 38, 26, 28, 33, 31, 30, 41, 38, 34, 33, 39, 30, 32, 28, 30, 35, 30, 29, 29, 36, 29, 27, 34, 28, 31, 29, 26, 36, 26, 32, 28, 29, 29, 40, 27, 28, 31, 30, 32, 34, 28, 30, 31, 35, 27, 30, 33, 29, 29, 33]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.33687907083299856, "mean_inference_ms": 0.7369103654694996, "mean_action_processing_ms": 0.0764464190665902, "mean_env_wait_ms": 6.9772138697286765, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006915263409884471, "StateBufferConnector_ms": 0.00391613762333708, "ViewRequirementAgentConnector_ms": 0.08895284724685382}, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 264000, "num_agent_steps_trained": 264000, "num_env_steps_sampled": 264000, "num_env_steps_trained": 264000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 419.6737688185379, "num_env_steps_trained_throughput_per_sec": 419.6737688185379, "timesteps_total": 264000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 264000, "timers": {"training_iteration_time_ms": 9938.748, "sample_time_ms": 6078.063, "load_time_ms": 1.041, "load_throughput": 3841465.403, "learn_time_ms": 3855.42, "learn_throughput": 1037.5, "synch_weights_time_ms": 3.514}, "counters": {"num_env_steps_sampled": 264000, "num_env_steps_trained": 264000, "num_agent_steps_sampled": 264000, "num_agent_steps_trained": 264000}, "done": false, "episodes_total": 4763, "training_iteration": 66, "trial_id": "ddfb6_00000", "date": "2024-03-07_12-58-45", "timestamp": 1709834325, "time_this_iter_s": 9.534064769744873, "time_total_s": 625.3047842979431, "pid": 112355, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4d85689f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 625.3047842979431, "iterations_since_restore": 66, "perf": {"cpu_util_percent": 26.930769230769233, "ram_util_percent": 53.215384615384615, "gpu_util_percent0": 0.09307692307692307, "vram_util_percent0": 0.12301557491987178}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.11250000000000003, "cur_lr": 0.0010000000000000005, "total_loss": 0.29908703615218, "policy_loss": -0.023543559606637687, "vf_loss": 0.3193426928347758, "vf_explained_var": 0.900068349094801, "kl": 0.029225771629842686, "entropy": 0.30991442764318117, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 61845.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 268000, "num_env_steps_trained": 268000, "num_agent_steps_sampled": 268000, "num_agent_steps_trained": 268000}, "sampler_results": {"episode_reward_max": -1.5000000000000009, "episode_reward_min": -19.599999999999962, "episode_reward_mean": -2.1393700787401584, "episode_len_mean": 31.53543307086614, "episode_media": {}, "episodes_this_iter": 127, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2.4000000000000017, -1.9000000000000012, -1.8000000000000012, -3.200000000000001, -1.700000000000001, -1.9000000000000012, -1.700000000000001, -1.600000000000001, -1.700000000000001, -1.600000000000001, -2.1000000000000014, -2.0000000000000013, -2.600000000000002, -1.600000000000001, -1.700000000000001, -1.5000000000000009, -1.700000000000001, -1.8000000000000012, -2.2000000000000015, -1.600000000000001, -2.2000000000000015, -1.700000000000001, -4.399999999999998, -2.0000000000000013, -2.0000000000000013, -2.2000000000000015, -1.8000000000000012, -2.0000000000000013, -1.8000000000000012, -19.599999999999962, -2.2000000000000015, -2.4000000000000017, -2.2000000000000015, -1.8000000000000012, -1.700000000000001, -1.9000000000000012, -2.1000000000000014, -2.0000000000000013, -2.1000000000000014, -1.8000000000000012, -1.9000000000000012, -1.700000000000001, -1.8000000000000012, -2.5000000000000018, -1.9000000000000012, -2.700000000000002, -2.1000000000000014, -2.600000000000002, -1.600000000000001, -1.5000000000000009, -1.700000000000001, -1.600000000000001, -1.8000000000000012, -1.8000000000000012, -2.1000000000000014, -2.0000000000000013, -1.9000000000000012, -2.1000000000000014, -2.4000000000000017, -1.9000000000000012, -2.0000000000000013, -1.8000000000000012, -2.2000000000000015, -1.9000000000000012, -1.8000000000000012, -1.8000000000000012, -2.0000000000000013, -2.4000000000000017, -1.9000000000000012, -1.8000000000000012, -1.5000000000000009, -1.9000000000000012, -1.5000000000000009, -2.1000000000000014, -2.0000000000000013, -1.600000000000001, -1.8000000000000012, -1.9000000000000012, -2.0000000000000013, -2.0000000000000013, -1.8000000000000012, -1.9000000000000012, -1.9000000000000012, -2.3000000000000016, -2.0000000000000013, -1.8000000000000012, -1.8000000000000012, -1.8000000000000012, -1.8000000000000012, -1.600000000000001, -2.1000000000000014, -2.2000000000000015, -2.2000000000000015, -2.4000000000000017, -2.0000000000000013, -1.9000000000000012, -2.2000000000000015, -2.2000000000000015, -1.9000000000000012, -1.8000000000000012, -2.0000000000000013, -2.5000000000000018, -1.700000000000001, -1.9000000000000012, -1.700000000000001, -1.8000000000000012, -5.799999999999999, -1.700000000000001, -1.600000000000001, -1.8000000000000012, -1.600000000000001, -1.700000000000001, -2.3000000000000016, -2.1000000000000014, -1.8000000000000012, -1.8000000000000012, -2.0000000000000013, -1.5000000000000009, -2.1000000000000014, -2.0000000000000013, -1.8000000000000012, -2.1000000000000014, -1.9000000000000012, -1.9000000000000012, -2.0000000000000013, -1.600000000000001, -3.6999999999999993], "episode_lengths": [35, 30, 29, 43, 28, 30, 28, 27, 28, 27, 32, 31, 37, 27, 28, 26, 28, 29, 33, 27, 33, 28, 48, 31, 31, 33, 29, 31, 29, 124, 33, 35, 33, 29, 28, 30, 32, 31, 32, 29, 30, 28, 29, 36, 30, 38, 32, 37, 27, 26, 28, 27, 29, 29, 32, 31, 30, 32, 35, 30, 31, 29, 33, 30, 29, 29, 31, 35, 30, 29, 26, 30, 26, 32, 31, 27, 29, 30, 31, 31, 29, 30, 30, 34, 31, 29, 29, 29, 29, 27, 32, 33, 33, 35, 31, 30, 33, 33, 30, 29, 31, 36, 28, 30, 28, 29, 52, 28, 27, 29, 27, 28, 34, 32, 29, 29, 31, 26, 32, 31, 29, 32, 30, 30, 31, 27, 46]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3382555340985099, "mean_inference_ms": 0.7366978867866993, "mean_action_processing_ms": 0.07647253266074054, "mean_env_wait_ms": 6.980536028559434, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006846555574672428, "StateBufferConnector_ms": 0.003942917651078832, "ViewRequirementAgentConnector_ms": 0.08921041263370064}}, "episode_reward_max": -1.5000000000000009, "episode_reward_min": -19.599999999999962, "episode_reward_mean": -2.1393700787401584, "episode_len_mean": 31.53543307086614, "episodes_this_iter": 127, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-2.4000000000000017, -1.9000000000000012, -1.8000000000000012, -3.200000000000001, -1.700000000000001, -1.9000000000000012, -1.700000000000001, -1.600000000000001, -1.700000000000001, -1.600000000000001, -2.1000000000000014, -2.0000000000000013, -2.600000000000002, -1.600000000000001, -1.700000000000001, -1.5000000000000009, -1.700000000000001, -1.8000000000000012, -2.2000000000000015, -1.600000000000001, -2.2000000000000015, -1.700000000000001, -4.399999999999998, -2.0000000000000013, -2.0000000000000013, -2.2000000000000015, -1.8000000000000012, -2.0000000000000013, -1.8000000000000012, -19.599999999999962, -2.2000000000000015, -2.4000000000000017, -2.2000000000000015, -1.8000000000000012, -1.700000000000001, -1.9000000000000012, -2.1000000000000014, -2.0000000000000013, -2.1000000000000014, -1.8000000000000012, -1.9000000000000012, -1.700000000000001, -1.8000000000000012, -2.5000000000000018, -1.9000000000000012, -2.700000000000002, -2.1000000000000014, -2.600000000000002, -1.600000000000001, -1.5000000000000009, -1.700000000000001, -1.600000000000001, -1.8000000000000012, -1.8000000000000012, -2.1000000000000014, -2.0000000000000013, -1.9000000000000012, -2.1000000000000014, -2.4000000000000017, -1.9000000000000012, -2.0000000000000013, -1.8000000000000012, -2.2000000000000015, -1.9000000000000012, -1.8000000000000012, -1.8000000000000012, -2.0000000000000013, -2.4000000000000017, -1.9000000000000012, -1.8000000000000012, -1.5000000000000009, -1.9000000000000012, -1.5000000000000009, -2.1000000000000014, -2.0000000000000013, -1.600000000000001, -1.8000000000000012, -1.9000000000000012, -2.0000000000000013, -2.0000000000000013, -1.8000000000000012, -1.9000000000000012, -1.9000000000000012, -2.3000000000000016, -2.0000000000000013, -1.8000000000000012, -1.8000000000000012, -1.8000000000000012, -1.8000000000000012, -1.600000000000001, -2.1000000000000014, -2.2000000000000015, -2.2000000000000015, -2.4000000000000017, -2.0000000000000013, -1.9000000000000012, -2.2000000000000015, -2.2000000000000015, -1.9000000000000012, -1.8000000000000012, -2.0000000000000013, -2.5000000000000018, -1.700000000000001, -1.9000000000000012, -1.700000000000001, -1.8000000000000012, -5.799999999999999, -1.700000000000001, -1.600000000000001, -1.8000000000000012, -1.600000000000001, -1.700000000000001, -2.3000000000000016, -2.1000000000000014, -1.8000000000000012, -1.8000000000000012, -2.0000000000000013, -1.5000000000000009, -2.1000000000000014, -2.0000000000000013, -1.8000000000000012, -2.1000000000000014, -1.9000000000000012, -1.9000000000000012, -2.0000000000000013, -1.600000000000001, -3.6999999999999993], "episode_lengths": [35, 30, 29, 43, 28, 30, 28, 27, 28, 27, 32, 31, 37, 27, 28, 26, 28, 29, 33, 27, 33, 28, 48, 31, 31, 33, 29, 31, 29, 124, 33, 35, 33, 29, 28, 30, 32, 31, 32, 29, 30, 28, 29, 36, 30, 38, 32, 37, 27, 26, 28, 27, 29, 29, 32, 31, 30, 32, 35, 30, 31, 29, 33, 30, 29, 29, 31, 35, 30, 29, 26, 30, 26, 32, 31, 27, 29, 30, 31, 31, 29, 30, 30, 34, 31, 29, 29, 29, 29, 27, 32, 33, 33, 35, 31, 30, 33, 33, 30, 29, 31, 36, 28, 30, 28, 29, 52, 28, 27, 29, 27, 28, 34, 32, 29, 29, 31, 26, 32, 31, 29, 32, 30, 30, 31, 27, 46]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3382555340985099, "mean_inference_ms": 0.7366978867866993, "mean_action_processing_ms": 0.07647253266074054, "mean_env_wait_ms": 6.980536028559434, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006846555574672428, "StateBufferConnector_ms": 0.003942917651078832, "ViewRequirementAgentConnector_ms": 0.08921041263370064}, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 268000, "num_agent_steps_trained": 268000, "num_env_steps_sampled": 268000, "num_env_steps_trained": 268000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 419.7498926307759, "num_env_steps_trained_throughput_per_sec": 419.7498926307759, "timesteps_total": 268000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 268000, "timers": {"training_iteration_time_ms": 9901.289, "sample_time_ms": 6082.164, "load_time_ms": 1.043, "load_throughput": 3834441.651, "learn_time_ms": 3813.845, "learn_throughput": 1048.81, "synch_weights_time_ms": 3.533}, "counters": {"num_env_steps_sampled": 268000, "num_env_steps_trained": 268000, "num_agent_steps_sampled": 268000, "num_agent_steps_trained": 268000}, "done": false, "episodes_total": 4890, "training_iteration": 67, "trial_id": "ddfb6_00000", "date": "2024-03-07_12-58-55", "timestamp": 1709834335, "time_this_iter_s": 9.532558679580688, "time_total_s": 634.8373429775238, "pid": 112355, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4d85689f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 634.8373429775238, "iterations_since_restore": 67, "perf": {"cpu_util_percent": 28.75833333333333, "ram_util_percent": 53.19166666666667, "gpu_util_percent0": 0.08666666666666667, "vram_util_percent0": 0.12296549479166667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.16875000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 0.15808161283763106, "policy_loss": -0.019914378402053668, "vf_loss": 0.17562606506630457, "vf_explained_var": 0.9074787816693706, "kl": 0.014044000526699227, "entropy": 0.29929968584929745, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 62775.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 272000, "num_env_steps_trained": 272000, "num_agent_steps_sampled": 272000, "num_agent_steps_trained": 272000}, "sampler_results": {"episode_reward_max": -1.4000000000000008, "episode_reward_min": -5.399999999999995, "episode_reward_mean": -1.9084615384615395, "episode_len_mean": 30.053846153846155, "episode_media": {}, "episodes_this_iter": 130, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1.700000000000001, -2.1000000000000014, -1.8000000000000012, -1.8000000000000012, -2.1000000000000014, -2.1000000000000014, -1.600000000000001, -1.600000000000001, -2.1000000000000014, -2.0000000000000013, -2.5000000000000018, -1.5000000000000009, -1.700000000000001, -2.1000000000000014, -2.4000000000000017, -2.0000000000000013, -2.2000000000000015, -1.5000000000000009, -2.4000000000000017, -1.600000000000001, -1.600000000000001, -1.700000000000001, -2.900000000000002, -1.600000000000001, -2.0000000000000013, -1.600000000000001, -1.8000000000000012, -2.0000000000000013, -1.8000000000000012, -2.4000000000000017, -1.9000000000000012, -2.0000000000000013, -1.8000000000000012, -2.3000000000000016, -1.600000000000001, -2.0000000000000013, -1.700000000000001, -1.8000000000000012, -1.8000000000000012, -1.9000000000000012, -2.0000000000000013, -1.600000000000001, -1.9000000000000012, -2.2000000000000015, -1.9000000000000012, -1.8000000000000012, -1.4000000000000008, -1.8000000000000012, -1.600000000000001, -1.600000000000001, -2.2000000000000015, -3.6999999999999993, -2.0000000000000013, -1.9000000000000012, -1.700000000000001, -2.1000000000000014, -1.4000000000000008, -5.399999999999995, -2.2000000000000015, -1.8000000000000012, -2.1000000000000014, -1.700000000000001, -1.8000000000000012, -1.9000000000000012, -1.9000000000000012, -1.4000000000000008, -2.4000000000000017, -1.8000000000000012, -1.600000000000001, -1.600000000000001, -2.1000000000000014, -1.700000000000001, -2.3000000000000016, -2.900000000000002, -1.8000000000000012, -2.2000000000000015, -1.700000000000001, -1.9000000000000012, -2.5000000000000018, -2.1000000000000014, -1.700000000000001, -2.0000000000000013, -2.3000000000000016, -1.5000000000000009, -2.3000000000000016, -1.9000000000000012, -1.9000000000000012, -1.700000000000001, -1.8000000000000012, -1.700000000000001, -1.4000000000000008, -2.0000000000000013, -2.0000000000000013, -1.700000000000001, -1.9000000000000012, -1.9000000000000012, -2.0000000000000013, -1.8000000000000012, -1.700000000000001, -1.5000000000000009, -1.700000000000001, -1.9000000000000012, -1.8000000000000012, -1.700000000000001, -1.8000000000000012, -1.600000000000001, -1.700000000000001, -1.9000000000000012, -2.1000000000000014, -1.700000000000001, -1.9000000000000012, -1.600000000000001, -1.8000000000000012, -1.5000000000000009, -2.0000000000000013, -1.700000000000001, -1.9000000000000012, -1.700000000000001, -1.8000000000000012, -2.1000000000000014, -1.700000000000001, -2.0000000000000013, -1.5000000000000009, -1.9000000000000012, -1.9000000000000012, -1.8000000000000012, -1.5000000000000009, -1.4000000000000008, -1.600000000000001, -1.600000000000001], "episode_lengths": [28, 32, 29, 29, 32, 32, 27, 27, 32, 31, 36, 26, 28, 32, 35, 31, 33, 26, 35, 27, 27, 28, 40, 27, 31, 27, 29, 31, 29, 35, 30, 31, 29, 34, 27, 31, 28, 29, 29, 30, 31, 27, 30, 33, 30, 29, 25, 29, 27, 27, 33, 48, 31, 30, 28, 32, 25, 63, 33, 29, 32, 28, 29, 30, 30, 25, 33, 29, 27, 27, 32, 28, 34, 40, 29, 33, 28, 30, 36, 32, 28, 31, 34, 26, 34, 30, 30, 28, 29, 28, 25, 31, 31, 28, 30, 30, 31, 29, 28, 26, 28, 30, 29, 28, 29, 27, 28, 30, 32, 28, 30, 27, 29, 26, 31, 28, 30, 28, 29, 32, 28, 31, 26, 30, 30, 29, 26, 25, 27, 27]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3396191280065169, "mean_inference_ms": 0.7366548134312195, "mean_action_processing_ms": 0.07645668738093792, "mean_env_wait_ms": 6.992149058506512, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00704343502338116, "StateBufferConnector_ms": 0.003997912773719201, "ViewRequirementAgentConnector_ms": 0.09151000242966872}}, "episode_reward_max": -1.4000000000000008, "episode_reward_min": -5.399999999999995, "episode_reward_mean": -1.9084615384615395, "episode_len_mean": 30.053846153846155, "episodes_this_iter": 130, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1.700000000000001, -2.1000000000000014, -1.8000000000000012, -1.8000000000000012, -2.1000000000000014, -2.1000000000000014, -1.600000000000001, -1.600000000000001, -2.1000000000000014, -2.0000000000000013, -2.5000000000000018, -1.5000000000000009, -1.700000000000001, -2.1000000000000014, -2.4000000000000017, -2.0000000000000013, -2.2000000000000015, -1.5000000000000009, -2.4000000000000017, -1.600000000000001, -1.600000000000001, -1.700000000000001, -2.900000000000002, -1.600000000000001, -2.0000000000000013, -1.600000000000001, -1.8000000000000012, -2.0000000000000013, -1.8000000000000012, -2.4000000000000017, -1.9000000000000012, -2.0000000000000013, -1.8000000000000012, -2.3000000000000016, -1.600000000000001, -2.0000000000000013, -1.700000000000001, -1.8000000000000012, -1.8000000000000012, -1.9000000000000012, -2.0000000000000013, -1.600000000000001, -1.9000000000000012, -2.2000000000000015, -1.9000000000000012, -1.8000000000000012, -1.4000000000000008, -1.8000000000000012, -1.600000000000001, -1.600000000000001, -2.2000000000000015, -3.6999999999999993, -2.0000000000000013, -1.9000000000000012, -1.700000000000001, -2.1000000000000014, -1.4000000000000008, -5.399999999999995, -2.2000000000000015, -1.8000000000000012, -2.1000000000000014, -1.700000000000001, -1.8000000000000012, -1.9000000000000012, -1.9000000000000012, -1.4000000000000008, -2.4000000000000017, -1.8000000000000012, -1.600000000000001, -1.600000000000001, -2.1000000000000014, -1.700000000000001, -2.3000000000000016, -2.900000000000002, -1.8000000000000012, -2.2000000000000015, -1.700000000000001, -1.9000000000000012, -2.5000000000000018, -2.1000000000000014, -1.700000000000001, -2.0000000000000013, -2.3000000000000016, -1.5000000000000009, -2.3000000000000016, -1.9000000000000012, -1.9000000000000012, -1.700000000000001, -1.8000000000000012, -1.700000000000001, -1.4000000000000008, -2.0000000000000013, -2.0000000000000013, -1.700000000000001, -1.9000000000000012, -1.9000000000000012, -2.0000000000000013, -1.8000000000000012, -1.700000000000001, -1.5000000000000009, -1.700000000000001, -1.9000000000000012, -1.8000000000000012, -1.700000000000001, -1.8000000000000012, -1.600000000000001, -1.700000000000001, -1.9000000000000012, -2.1000000000000014, -1.700000000000001, -1.9000000000000012, -1.600000000000001, -1.8000000000000012, -1.5000000000000009, -2.0000000000000013, -1.700000000000001, -1.9000000000000012, -1.700000000000001, -1.8000000000000012, -2.1000000000000014, -1.700000000000001, -2.0000000000000013, -1.5000000000000009, -1.9000000000000012, -1.9000000000000012, -1.8000000000000012, -1.5000000000000009, -1.4000000000000008, -1.600000000000001, -1.600000000000001], "episode_lengths": [28, 32, 29, 29, 32, 32, 27, 27, 32, 31, 36, 26, 28, 32, 35, 31, 33, 26, 35, 27, 27, 28, 40, 27, 31, 27, 29, 31, 29, 35, 30, 31, 29, 34, 27, 31, 28, 29, 29, 30, 31, 27, 30, 33, 30, 29, 25, 29, 27, 27, 33, 48, 31, 30, 28, 32, 25, 63, 33, 29, 32, 28, 29, 30, 30, 25, 33, 29, 27, 27, 32, 28, 34, 40, 29, 33, 28, 30, 36, 32, 28, 31, 34, 26, 34, 30, 30, 28, 29, 28, 25, 31, 31, 28, 30, 30, 31, 29, 28, 26, 28, 30, 29, 28, 29, 27, 28, 30, 32, 28, 30, 27, 29, 26, 31, 28, 30, 28, 29, 32, 28, 31, 26, 30, 30, 29, 26, 25, 27, 27]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3396191280065169, "mean_inference_ms": 0.7366548134312195, "mean_action_processing_ms": 0.07645668738093792, "mean_env_wait_ms": 6.992149058506512, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00704343502338116, "StateBufferConnector_ms": 0.003997912773719201, "ViewRequirementAgentConnector_ms": 0.09151000242966872}, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 272000, "num_agent_steps_trained": 272000, "num_env_steps_sampled": 272000, "num_env_steps_trained": 272000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 387.72316529539415, "num_env_steps_trained_throughput_per_sec": 387.72316529539415, "timesteps_total": 272000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 272000, "timers": {"training_iteration_time_ms": 9940.471, "sample_time_ms": 6070.648, "load_time_ms": 1.05, "load_throughput": 3808848.529, "learn_time_ms": 3864.547, "learn_throughput": 1035.05, "synch_weights_time_ms": 3.514}, "counters": {"num_env_steps_sampled": 272000, "num_env_steps_trained": 272000, "num_agent_steps_sampled": 272000, "num_agent_steps_trained": 272000}, "done": false, "episodes_total": 5020, "training_iteration": 68, "trial_id": "ddfb6_00000", "date": "2024-03-07_12-59-05", "timestamp": 1709834345, "time_this_iter_s": 10.319749593734741, "time_total_s": 645.1570925712585, "pid": 112355, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4d85689f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 645.1570925712585, "iterations_since_restore": 68, "perf": {"cpu_util_percent": 29.27692307692308, "ram_util_percent": 51.907692307692315, "gpu_util_percent0": 0.11307692307692309, "vram_util_percent0": 0.11907176482371794}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.16875000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 0.46086664746205014, "policy_loss": -0.002944563922061715, "vf_loss": 0.46316677647372406, "vf_explained_var": 0.7818204542641999, "kl": 0.0038188627544364193, "entropy": 0.2951622818426419, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 63705.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 276000, "num_env_steps_trained": 276000, "num_agent_steps_sampled": 276000, "num_agent_steps_trained": 276000}, "sampler_results": {"episode_reward_max": -1.4000000000000008, "episode_reward_min": -76.90000000000055, "episode_reward_mean": -2.603333333333339, "episode_len_mean": 33.78333333333333, "episode_media": {}, "episodes_this_iter": 120, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1.9000000000000012, -1.5000000000000009, -1.5000000000000009, -3.3000000000000016, -1.700000000000001, -1.8000000000000012, -1.8000000000000012, -1.9000000000000012, -1.8000000000000012, -1.600000000000001, -1.600000000000001, -1.700000000000001, -1.8000000000000012, -1.700000000000001, -1.9000000000000012, -2.2000000000000015, -2.4000000000000017, -1.5000000000000009, -1.8000000000000012, -1.8000000000000012, -2.600000000000002, -1.8000000000000012, -2.1000000000000014, -1.8000000000000012, -1.700000000000001, -2.1000000000000014, -2.900000000000002, -1.5000000000000009, -1.9000000000000012, -1.700000000000001, -1.9000000000000012, -2.1000000000000014, -3.1000000000000014, -1.9000000000000012, -1.9000000000000012, -2.2000000000000015, -1.5000000000000009, -1.600000000000001, -2.5000000000000018, -1.600000000000001, -2.0000000000000013, -2.1000000000000014, -1.5000000000000009, -1.600000000000001, -2.0000000000000013, -1.5000000000000009, -1.8000000000000012, -2.0000000000000013, -2.5000000000000018, -1.4000000000000008, -2.3000000000000016, -2.1000000000000014, -2.4000000000000017, -1.600000000000001, -1.700000000000001, -2.0000000000000013, -1.9000000000000012, -1.8000000000000012, -1.4000000000000008, -1.9000000000000012, -2.0000000000000013, -1.5000000000000009, -1.700000000000001, -2.0000000000000013, -2.2000000000000015, -1.600000000000001, -1.700000000000001, -1.5000000000000009, -1.600000000000001, -1.8000000000000012, -2.1000000000000014, -2.0000000000000013, -1.8000000000000012, -1.600000000000001, -1.5000000000000009, -2.3000000000000016, -3.3000000000000007, -2.3000000000000016, -4.600000000000001, -1.9000000000000012, -1.5000000000000009, -2.1000000000000014, -2.2000000000000015, -2.2000000000000015, -2.4000000000000017, -2.2000000000000015, -1.700000000000001, -1.600000000000001, -1.9000000000000012, -2.0000000000000013, -1.9000000000000012, -1.4000000000000008, -1.700000000000001, -1.9000000000000012, -2.3000000000000016, -2.2000000000000015, -2.4000000000000017, -3.3000000000000007, -1.700000000000001, -1.9000000000000012, -2.1000000000000014, -1.5000000000000009, -1.9000000000000012, -2.0000000000000013, -3.200000000000001, -1.4000000000000008, -1.9000000000000012, -76.90000000000055, -2.0000000000000013, -2.1000000000000014, -3.8999999999999986, -2.0000000000000013, -2.1000000000000014, -1.9000000000000012, -1.8000000000000012, -1.8000000000000012, -1.8000000000000012, -2.1000000000000014, -1.8000000000000012, -1.600000000000001], "episode_lengths": [30, 26, 26, 42, 28, 29, 29, 30, 29, 27, 27, 28, 29, 28, 30, 33, 35, 26, 29, 29, 37, 29, 32, 29, 28, 32, 40, 26, 30, 28, 30, 32, 42, 30, 30, 33, 26, 27, 36, 27, 31, 32, 26, 27, 31, 26, 29, 31, 36, 25, 34, 32, 35, 27, 28, 31, 30, 29, 25, 30, 31, 26, 28, 31, 33, 27, 28, 26, 27, 29, 32, 31, 29, 27, 26, 34, 44, 34, 49, 30, 26, 32, 33, 33, 35, 33, 28, 27, 30, 31, 30, 25, 28, 30, 34, 33, 35, 44, 28, 30, 32, 26, 30, 31, 43, 25, 30, 400, 31, 32, 50, 31, 32, 30, 29, 29, 29, 32, 29, 27]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3410377416747387, "mean_inference_ms": 0.7369638776733096, "mean_action_processing_ms": 0.07649761927791679, "mean_env_wait_ms": 7.00158236239692, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007201631863911946, "StateBufferConnector_ms": 0.00404973824818929, "ViewRequirementAgentConnector_ms": 0.09389857451121013}}, "episode_reward_max": -1.4000000000000008, "episode_reward_min": -76.90000000000055, "episode_reward_mean": -2.603333333333339, "episode_len_mean": 33.78333333333333, "episodes_this_iter": 120, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1.9000000000000012, -1.5000000000000009, -1.5000000000000009, -3.3000000000000016, -1.700000000000001, -1.8000000000000012, -1.8000000000000012, -1.9000000000000012, -1.8000000000000012, -1.600000000000001, -1.600000000000001, -1.700000000000001, -1.8000000000000012, -1.700000000000001, -1.9000000000000012, -2.2000000000000015, -2.4000000000000017, -1.5000000000000009, -1.8000000000000012, -1.8000000000000012, -2.600000000000002, -1.8000000000000012, -2.1000000000000014, -1.8000000000000012, -1.700000000000001, -2.1000000000000014, -2.900000000000002, -1.5000000000000009, -1.9000000000000012, -1.700000000000001, -1.9000000000000012, -2.1000000000000014, -3.1000000000000014, -1.9000000000000012, -1.9000000000000012, -2.2000000000000015, -1.5000000000000009, -1.600000000000001, -2.5000000000000018, -1.600000000000001, -2.0000000000000013, -2.1000000000000014, -1.5000000000000009, -1.600000000000001, -2.0000000000000013, -1.5000000000000009, -1.8000000000000012, -2.0000000000000013, -2.5000000000000018, -1.4000000000000008, -2.3000000000000016, -2.1000000000000014, -2.4000000000000017, -1.600000000000001, -1.700000000000001, -2.0000000000000013, -1.9000000000000012, -1.8000000000000012, -1.4000000000000008, -1.9000000000000012, -2.0000000000000013, -1.5000000000000009, -1.700000000000001, -2.0000000000000013, -2.2000000000000015, -1.600000000000001, -1.700000000000001, -1.5000000000000009, -1.600000000000001, -1.8000000000000012, -2.1000000000000014, -2.0000000000000013, -1.8000000000000012, -1.600000000000001, -1.5000000000000009, -2.3000000000000016, -3.3000000000000007, -2.3000000000000016, -4.600000000000001, -1.9000000000000012, -1.5000000000000009, -2.1000000000000014, -2.2000000000000015, -2.2000000000000015, -2.4000000000000017, -2.2000000000000015, -1.700000000000001, -1.600000000000001, -1.9000000000000012, -2.0000000000000013, -1.9000000000000012, -1.4000000000000008, -1.700000000000001, -1.9000000000000012, -2.3000000000000016, -2.2000000000000015, -2.4000000000000017, -3.3000000000000007, -1.700000000000001, -1.9000000000000012, -2.1000000000000014, -1.5000000000000009, -1.9000000000000012, -2.0000000000000013, -3.200000000000001, -1.4000000000000008, -1.9000000000000012, -76.90000000000055, -2.0000000000000013, -2.1000000000000014, -3.8999999999999986, -2.0000000000000013, -2.1000000000000014, -1.9000000000000012, -1.8000000000000012, -1.8000000000000012, -1.8000000000000012, -2.1000000000000014, -1.8000000000000012, -1.600000000000001], "episode_lengths": [30, 26, 26, 42, 28, 29, 29, 30, 29, 27, 27, 28, 29, 28, 30, 33, 35, 26, 29, 29, 37, 29, 32, 29, 28, 32, 40, 26, 30, 28, 30, 32, 42, 30, 30, 33, 26, 27, 36, 27, 31, 32, 26, 27, 31, 26, 29, 31, 36, 25, 34, 32, 35, 27, 28, 31, 30, 29, 25, 30, 31, 26, 28, 31, 33, 27, 28, 26, 27, 29, 32, 31, 29, 27, 26, 34, 44, 34, 49, 30, 26, 32, 33, 33, 35, 33, 28, 27, 30, 31, 30, 25, 28, 30, 34, 33, 35, 44, 28, 30, 32, 26, 30, 31, 43, 25, 30, 400, 31, 32, 50, 31, 32, 30, 29, 29, 29, 32, 29, 27]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3410377416747387, "mean_inference_ms": 0.7369638776733096, "mean_action_processing_ms": 0.07649761927791679, "mean_env_wait_ms": 7.00158236239692, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007201631863911946, "StateBufferConnector_ms": 0.00404973824818929, "ViewRequirementAgentConnector_ms": 0.09389857451121013}, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 276000, "num_agent_steps_trained": 276000, "num_env_steps_sampled": 276000, "num_env_steps_trained": 276000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 400.399549549743, "num_env_steps_trained_throughput_per_sec": 400.399549549743, "timesteps_total": 276000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 276000, "timers": {"training_iteration_time_ms": 9994.908, "sample_time_ms": 6110.422, "load_time_ms": 1.063, "load_throughput": 3764324.082, "learn_time_ms": 3879.197, "learn_throughput": 1031.141, "synch_weights_time_ms": 3.508}, "counters": {"num_env_steps_sampled": 276000, "num_env_steps_trained": 276000, "num_agent_steps_sampled": 276000, "num_agent_steps_trained": 276000}, "done": false, "episodes_total": 5140, "training_iteration": 69, "trial_id": "ddfb6_00000", "date": "2024-03-07_12-59-15", "timestamp": 1709834355, "time_this_iter_s": 9.992622375488281, "time_total_s": 655.1497149467468, "pid": 112355, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4d85689f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 655.1497149467468, "iterations_since_restore": 69, "perf": {"cpu_util_percent": 29.892307692307693, "ram_util_percent": 49.407692307692294, "gpu_util_percent0": 0.09538461538461539, "vram_util_percent0": 0.1166366185897436}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.08437500000000002, "cur_lr": 0.0010000000000000005, "total_loss": 0.8340390667294262, "policy_loss": -0.010932414353855195, "vf_loss": 0.8433849445419005, "vf_explained_var": 0.7191591667231693, "kl": 0.01880338759509275, "entropy": 0.31505281869121776, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 64635.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 280000, "num_env_steps_trained": 280000, "num_agent_steps_sampled": 280000, "num_agent_steps_trained": 280000}, "sampler_results": {"episode_reward_max": -1.4000000000000008, "episode_reward_min": -77.30000000000057, "episode_reward_mean": -2.553333333333339, "episode_len_mean": 33.15833333333333, "episode_media": {}, "episodes_this_iter": 120, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2.600000000000002, -1.8000000000000012, -1.700000000000001, -1.600000000000001, -1.700000000000001, -2.700000000000002, -1.8000000000000012, -1.4000000000000008, -2.1000000000000014, -1.9000000000000012, -1.5000000000000009, -2.1000000000000014, -1.600000000000001, -2.0000000000000013, -1.4000000000000008, -1.8000000000000012, -1.8000000000000012, -1.600000000000001, -1.9000000000000012, -2.4000000000000017, -2.1000000000000014, -1.8000000000000012, -1.700000000000001, -1.600000000000001, -1.700000000000001, -1.700000000000001, -1.600000000000001, -1.700000000000001, -1.8000000000000012, -1.600000000000001, -2.1000000000000014, -2.2000000000000015, -2.1000000000000014, -10.799999999999986, -2.0000000000000013, -1.9000000000000012, -2.5000000000000018, -1.9000000000000012, -1.8000000000000012, -2.3000000000000016, -2.0000000000000013, -1.9000000000000012, -1.8000000000000012, -1.5000000000000009, -1.600000000000001, -1.9000000000000012, -1.8000000000000012, -1.8000000000000012, -1.600000000000001, -1.8000000000000012, -1.5000000000000009, -1.600000000000001, -2.0000000000000013, -2.1000000000000014, -2.5000000000000018, -1.5000000000000009, -2.0000000000000013, -1.600000000000001, -1.5000000000000009, -1.700000000000001, -2.2000000000000015, -2.1000000000000014, -1.5000000000000009, -1.8000000000000012, -1.700000000000001, -1.9000000000000012, -1.600000000000001, -2.5000000000000018, -2.0000000000000013, -2.5000000000000018, -1.5000000000000009, -1.8000000000000012, -1.700000000000001, -2.0000000000000013, -2.700000000000002, -1.5000000000000009, -1.8000000000000012, -2.2000000000000015, -1.600000000000001, -2.3000000000000016, -2.0000000000000013, -1.9000000000000012, -1.8000000000000012, -1.8000000000000012, -1.9000000000000012, -1.9000000000000012, -1.600000000000001, -1.600000000000001, -1.700000000000001, -1.600000000000001, -1.700000000000001, -1.600000000000001, -2.2000000000000015, -1.5000000000000009, -2.0000000000000013, -1.8000000000000012, -2.4000000000000017, -2.5000000000000018, -1.700000000000001, -2.2000000000000015, -1.700000000000001, -1.600000000000001, -1.700000000000001, -1.700000000000001, -1.9000000000000012, -1.5000000000000009, -2.0000000000000013, -2.0000000000000013, -1.5000000000000009, -1.5000000000000009, -77.30000000000057, -1.700000000000001, -1.700000000000001, -1.5000000000000009, -1.600000000000001, -1.5000000000000009, -2.0000000000000013, -2.2000000000000015, -1.8000000000000012, -1.700000000000001], "episode_lengths": [37, 29, 28, 27, 28, 38, 29, 25, 32, 30, 26, 32, 27, 31, 25, 29, 29, 27, 30, 35, 32, 29, 28, 27, 28, 28, 27, 28, 29, 27, 32, 33, 32, 98, 31, 30, 36, 30, 29, 34, 31, 30, 29, 26, 27, 30, 29, 29, 27, 29, 26, 27, 31, 32, 36, 26, 31, 27, 26, 28, 33, 32, 26, 29, 28, 30, 27, 36, 31, 36, 26, 29, 28, 31, 38, 26, 29, 33, 27, 34, 31, 30, 29, 29, 30, 30, 27, 27, 28, 27, 28, 27, 33, 26, 31, 29, 35, 36, 28, 33, 28, 27, 28, 28, 30, 26, 31, 31, 26, 26, 400, 28, 28, 26, 27, 26, 31, 33, 29, 28]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.34219933757997817, "mean_inference_ms": 0.7366743247369603, "mean_action_processing_ms": 0.07647183379581436, "mean_env_wait_ms": 7.007419365195394, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007108052571614583, "StateBufferConnector_ms": 0.0038536389668782554, "ViewRequirementAgentConnector_ms": 0.08903225262959798}}, "episode_reward_max": -1.4000000000000008, "episode_reward_min": -77.30000000000057, "episode_reward_mean": -2.553333333333339, "episode_len_mean": 33.15833333333333, "episodes_this_iter": 120, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-2.600000000000002, -1.8000000000000012, -1.700000000000001, -1.600000000000001, -1.700000000000001, -2.700000000000002, -1.8000000000000012, -1.4000000000000008, -2.1000000000000014, -1.9000000000000012, -1.5000000000000009, -2.1000000000000014, -1.600000000000001, -2.0000000000000013, -1.4000000000000008, -1.8000000000000012, -1.8000000000000012, -1.600000000000001, -1.9000000000000012, -2.4000000000000017, -2.1000000000000014, -1.8000000000000012, -1.700000000000001, -1.600000000000001, -1.700000000000001, -1.700000000000001, -1.600000000000001, -1.700000000000001, -1.8000000000000012, -1.600000000000001, -2.1000000000000014, -2.2000000000000015, -2.1000000000000014, -10.799999999999986, -2.0000000000000013, -1.9000000000000012, -2.5000000000000018, -1.9000000000000012, -1.8000000000000012, -2.3000000000000016, -2.0000000000000013, -1.9000000000000012, -1.8000000000000012, -1.5000000000000009, -1.600000000000001, -1.9000000000000012, -1.8000000000000012, -1.8000000000000012, -1.600000000000001, -1.8000000000000012, -1.5000000000000009, -1.600000000000001, -2.0000000000000013, -2.1000000000000014, -2.5000000000000018, -1.5000000000000009, -2.0000000000000013, -1.600000000000001, -1.5000000000000009, -1.700000000000001, -2.2000000000000015, -2.1000000000000014, -1.5000000000000009, -1.8000000000000012, -1.700000000000001, -1.9000000000000012, -1.600000000000001, -2.5000000000000018, -2.0000000000000013, -2.5000000000000018, -1.5000000000000009, -1.8000000000000012, -1.700000000000001, -2.0000000000000013, -2.700000000000002, -1.5000000000000009, -1.8000000000000012, -2.2000000000000015, -1.600000000000001, -2.3000000000000016, -2.0000000000000013, -1.9000000000000012, -1.8000000000000012, -1.8000000000000012, -1.9000000000000012, -1.9000000000000012, -1.600000000000001, -1.600000000000001, -1.700000000000001, -1.600000000000001, -1.700000000000001, -1.600000000000001, -2.2000000000000015, -1.5000000000000009, -2.0000000000000013, -1.8000000000000012, -2.4000000000000017, -2.5000000000000018, -1.700000000000001, -2.2000000000000015, -1.700000000000001, -1.600000000000001, -1.700000000000001, -1.700000000000001, -1.9000000000000012, -1.5000000000000009, -2.0000000000000013, -2.0000000000000013, -1.5000000000000009, -1.5000000000000009, -77.30000000000057, -1.700000000000001, -1.700000000000001, -1.5000000000000009, -1.600000000000001, -1.5000000000000009, -2.0000000000000013, -2.2000000000000015, -1.8000000000000012, -1.700000000000001], "episode_lengths": [37, 29, 28, 27, 28, 38, 29, 25, 32, 30, 26, 32, 27, 31, 25, 29, 29, 27, 30, 35, 32, 29, 28, 27, 28, 28, 27, 28, 29, 27, 32, 33, 32, 98, 31, 30, 36, 30, 29, 34, 31, 30, 29, 26, 27, 30, 29, 29, 27, 29, 26, 27, 31, 32, 36, 26, 31, 27, 26, 28, 33, 32, 26, 29, 28, 30, 27, 36, 31, 36, 26, 29, 28, 31, 38, 26, 29, 33, 27, 34, 31, 30, 29, 29, 30, 30, 27, 27, 28, 27, 28, 27, 33, 26, 31, 29, 35, 36, 28, 33, 28, 27, 28, 28, 30, 26, 31, 31, 26, 26, 400, 28, 28, 26, 27, 26, 31, 33, 29, 28]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.34219933757997817, "mean_inference_ms": 0.7366743247369603, "mean_action_processing_ms": 0.07647183379581436, "mean_env_wait_ms": 7.007419365195394, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007108052571614583, "StateBufferConnector_ms": 0.0038536389668782554, "ViewRequirementAgentConnector_ms": 0.08903225262959798}, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 280000, "num_agent_steps_trained": 280000, "num_env_steps_sampled": 280000, "num_env_steps_trained": 280000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 411.0708629314265, "num_env_steps_trained_throughput_per_sec": 411.0708629314265, "timesteps_total": 280000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 280000, "timers": {"training_iteration_time_ms": 9967.965, "sample_time_ms": 6104.193, "load_time_ms": 1.064, "load_throughput": 3758000.179, "learn_time_ms": 3858.501, "learn_throughput": 1036.672, "synch_weights_time_ms": 3.494}, "counters": {"num_env_steps_sampled": 280000, "num_env_steps_trained": 280000, "num_agent_steps_sampled": 280000, "num_agent_steps_trained": 280000}, "done": false, "episodes_total": 5260, "training_iteration": 70, "trial_id": "ddfb6_00000", "date": "2024-03-07_12-59-25", "timestamp": 1709834365, "time_this_iter_s": 9.733614444732666, "time_total_s": 664.8833293914795, "pid": 112355, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4d85689f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 664.8833293914795, "iterations_since_restore": 70, "perf": {"cpu_util_percent": 26.73846153846154, "ram_util_percent": 48.72307692307693, "gpu_util_percent0": 0.09307692307692307, "vram_util_percent0": 0.11399489182692311}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.08437500000000002, "cur_lr": 0.0010000000000000005, "total_loss": 0.9417187404618549, "policy_loss": -0.01285571386957521, "vf_loss": 0.9531525392280591, "vf_explained_var": 0.5112099890426923, "kl": 0.016852338608162102, "entropy": 0.35289826548548153, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 65565.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 284000, "num_env_steps_trained": 284000, "num_agent_steps_sampled": 284000, "num_agent_steps_trained": 284000}, "sampler_results": {"episode_reward_max": -1.4000000000000008, "episode_reward_min": -77.40000000000056, "episode_reward_mean": -2.757000000000007, "episode_len_mean": 34.48, "episode_media": {}, "episodes_this_iter": 100, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1.5000000000000009, -2.0000000000000013, -1.4000000000000008, -1.8000000000000012, -2.1000000000000014, -2.0000000000000013, -2.1000000000000014, -2.0000000000000013, -1.8000000000000012, -1.8000000000000012, -3.0000000000000018, -1.4000000000000008, -2.2000000000000015, -1.8000000000000012, -2.0000000000000013, -1.5000000000000009, -1.9000000000000012, -1.9000000000000012, -1.9000000000000012, -1.600000000000001, -2.0000000000000013, -1.5000000000000009, -1.5000000000000009, -2.700000000000002, -1.9000000000000012, -2.0000000000000013, -2.5000000000000018, -1.5000000000000009, -1.8000000000000012, -1.4000000000000008, -7.100000000000005, -2.3000000000000016, -1.8000000000000012, -1.4000000000000008, -1.8000000000000012, -1.700000000000001, -1.4000000000000008, -1.700000000000001, -2.0000000000000013, -2.600000000000002, -1.700000000000001, -2.2000000000000015, -2.0000000000000013, -1.9000000000000012, -2.2000000000000015, -2.0000000000000013, -1.8000000000000012, -1.700000000000001, -1.700000000000001, -2.4000000000000017, -1.9000000000000012, -2.2000000000000015, -2.700000000000002, -1.600000000000001, -1.700000000000001, -1.600000000000001, -1.5000000000000009, -1.600000000000001, -1.8000000000000012, -3.1000000000000014, -2.2000000000000015, -1.8000000000000012, -2.600000000000002, -1.600000000000001, -77.40000000000056, -1.700000000000001, -1.600000000000001, -1.700000000000001, -2.2000000000000015, -1.700000000000001, -2.0000000000000013, -2.2000000000000015, -2.0000000000000013, -1.700000000000001, -1.700000000000001, -1.9000000000000012, -6.19999999999999, -1.700000000000001, -2.2000000000000015, -1.8000000000000012, -1.700000000000001, -2.2000000000000015, -1.8000000000000012, -2.1000000000000014, -1.700000000000001, -1.9000000000000012, -2.1000000000000014, -2.1000000000000014, -1.5000000000000009, -1.8000000000000012, -2.0000000000000013, -1.8000000000000012, -1.8000000000000012, -1.9000000000000012, -1.700000000000001, -1.700000000000001, -2.0000000000000013, -2.3000000000000016, -1.700000000000001, -2.4000000000000017], "episode_lengths": [26, 31, 25, 29, 32, 31, 32, 31, 29, 29, 41, 25, 33, 29, 31, 26, 30, 30, 30, 27, 31, 26, 26, 38, 30, 31, 36, 26, 29, 25, 60, 34, 29, 25, 29, 28, 25, 28, 31, 37, 28, 33, 31, 30, 33, 31, 29, 28, 28, 35, 30, 33, 38, 27, 28, 27, 26, 27, 29, 42, 33, 29, 37, 27, 400, 28, 27, 28, 33, 28, 31, 33, 31, 28, 28, 30, 71, 28, 33, 29, 28, 33, 29, 32, 28, 30, 32, 32, 26, 29, 31, 29, 29, 30, 28, 28, 31, 34, 28, 35]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3429317976710179, "mean_inference_ms": 0.7361540859931598, "mean_action_processing_ms": 0.07638069306692724, "mean_env_wait_ms": 7.019445002809565, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0069196224212646484, "StateBufferConnector_ms": 0.003871917724609375, "ViewRequirementAgentConnector_ms": 0.08850359916687012}}, "episode_reward_max": -1.4000000000000008, "episode_reward_min": -77.40000000000056, "episode_reward_mean": -2.757000000000007, "episode_len_mean": 34.48, "episodes_this_iter": 100, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1.5000000000000009, -2.0000000000000013, -1.4000000000000008, -1.8000000000000012, -2.1000000000000014, -2.0000000000000013, -2.1000000000000014, -2.0000000000000013, -1.8000000000000012, -1.8000000000000012, -3.0000000000000018, -1.4000000000000008, -2.2000000000000015, -1.8000000000000012, -2.0000000000000013, -1.5000000000000009, -1.9000000000000012, -1.9000000000000012, -1.9000000000000012, -1.600000000000001, -2.0000000000000013, -1.5000000000000009, -1.5000000000000009, -2.700000000000002, -1.9000000000000012, -2.0000000000000013, -2.5000000000000018, -1.5000000000000009, -1.8000000000000012, -1.4000000000000008, -7.100000000000005, -2.3000000000000016, -1.8000000000000012, -1.4000000000000008, -1.8000000000000012, -1.700000000000001, -1.4000000000000008, -1.700000000000001, -2.0000000000000013, -2.600000000000002, -1.700000000000001, -2.2000000000000015, -2.0000000000000013, -1.9000000000000012, -2.2000000000000015, -2.0000000000000013, -1.8000000000000012, -1.700000000000001, -1.700000000000001, -2.4000000000000017, -1.9000000000000012, -2.2000000000000015, -2.700000000000002, -1.600000000000001, -1.700000000000001, -1.600000000000001, -1.5000000000000009, -1.600000000000001, -1.8000000000000012, -3.1000000000000014, -2.2000000000000015, -1.8000000000000012, -2.600000000000002, -1.600000000000001, -77.40000000000056, -1.700000000000001, -1.600000000000001, -1.700000000000001, -2.2000000000000015, -1.700000000000001, -2.0000000000000013, -2.2000000000000015, -2.0000000000000013, -1.700000000000001, -1.700000000000001, -1.9000000000000012, -6.19999999999999, -1.700000000000001, -2.2000000000000015, -1.8000000000000012, -1.700000000000001, -2.2000000000000015, -1.8000000000000012, -2.1000000000000014, -1.700000000000001, -1.9000000000000012, -2.1000000000000014, -2.1000000000000014, -1.5000000000000009, -1.8000000000000012, -2.0000000000000013, -1.8000000000000012, -1.8000000000000012, -1.9000000000000012, -1.700000000000001, -1.700000000000001, -2.0000000000000013, -2.3000000000000016, -1.700000000000001, -2.4000000000000017], "episode_lengths": [26, 31, 25, 29, 32, 31, 32, 31, 29, 29, 41, 25, 33, 29, 31, 26, 30, 30, 30, 27, 31, 26, 26, 38, 30, 31, 36, 26, 29, 25, 60, 34, 29, 25, 29, 28, 25, 28, 31, 37, 28, 33, 31, 30, 33, 31, 29, 28, 28, 35, 30, 33, 38, 27, 28, 27, 26, 27, 29, 42, 33, 29, 37, 27, 400, 28, 27, 28, 33, 28, 31, 33, 31, 28, 28, 30, 71, 28, 33, 29, 28, 33, 29, 32, 28, 30, 32, 32, 26, 29, 31, 29, 29, 30, 28, 28, 31, 34, 28, 35]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3429317976710179, "mean_inference_ms": 0.7361540859931598, "mean_action_processing_ms": 0.07638069306692724, "mean_env_wait_ms": 7.019445002809565, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0069196224212646484, "StateBufferConnector_ms": 0.003871917724609375, "ViewRequirementAgentConnector_ms": 0.08850359916687012}, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 284000, "num_agent_steps_trained": 284000, "num_env_steps_sampled": 284000, "num_env_steps_trained": 284000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 411.0900609616879, "num_env_steps_trained_throughput_per_sec": 411.0900609616879, "timesteps_total": 284000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 284000, "timers": {"training_iteration_time_ms": 9849.991, "sample_time_ms": 6042.975, "load_time_ms": 1.047, "load_throughput": 3818905.581, "learn_time_ms": 3801.773, "learn_throughput": 1052.141, "synch_weights_time_ms": 3.483}, "counters": {"num_env_steps_sampled": 284000, "num_env_steps_trained": 284000, "num_agent_steps_sampled": 284000, "num_agent_steps_trained": 284000}, "done": false, "episodes_total": 5360, "training_iteration": 71, "trial_id": "ddfb6_00000", "date": "2024-03-07_12-59-34", "timestamp": 1709834374, "time_this_iter_s": 9.732940912246704, "time_total_s": 674.6162703037262, "pid": 112355, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4d85689f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 674.6162703037262, "iterations_since_restore": 71, "perf": {"cpu_util_percent": 29.966666666666665, "ram_util_percent": 48.666666666666664, "gpu_util_percent0": 0.10833333333333332, "vram_util_percent0": 0.1139797634548611}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.08437500000000002, "cur_lr": 0.0010000000000000005, "total_loss": 0.8353364535397099, "policy_loss": -0.010757537362396076, "vf_loss": 0.8448887446805113, "vf_explained_var": 0.7200620907609181, "kl": 0.014284411908121606, "entropy": 0.3909280384420067, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 66495.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 288000, "num_env_steps_trained": 288000, "num_agent_steps_sampled": 288000, "num_agent_steps_trained": 288000}, "sampler_results": {"episode_reward_max": -1.4000000000000008, "episode_reward_min": -76.80000000000052, "episode_reward_mean": -3.4457627118644165, "episode_len_mean": 38.559322033898304, "episode_media": {}, "episodes_this_iter": 118, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2.0000000000000013, -1.700000000000001, -1.4000000000000008, -2.0000000000000013, -1.8000000000000012, -2.4000000000000017, -2.0000000000000013, -2.4000000000000017, -2.600000000000002, -1.4000000000000008, -2.2000000000000015, -1.8000000000000012, -2.4000000000000017, -1.700000000000001, -3.200000000000001, -2.0000000000000013, -2.0000000000000013, -1.700000000000001, -2.1000000000000014, -1.5000000000000009, -2.0000000000000013, -2.700000000000002, -1.9000000000000012, -1.9000000000000012, -1.8000000000000012, -2.1000000000000014, -1.8000000000000012, -2.4000000000000017, -1.4000000000000008, -2.2000000000000015, -2.2000000000000015, -2.2000000000000015, -1.4000000000000008, -2.2000000000000015, -5.8999999999999915, -1.5000000000000009, -2.2000000000000015, -2.3000000000000016, -2.0000000000000013, -2.1000000000000014, -10.299999999999994, -1.9000000000000012, -2.0000000000000013, -2.4000000000000017, -2.2000000000000015, -2.1000000000000014, -1.9000000000000012, -1.600000000000001, -2.1000000000000014, -2.1000000000000014, -1.8000000000000012, -1.600000000000001, -2.0000000000000013, -1.8000000000000012, -3.1000000000000014, -1.8000000000000012, -2.0000000000000013, -2.2000000000000015, -2.0000000000000013, -2.1000000000000014, -2.0000000000000013, -76.80000000000052, -2.2000000000000015, -2.0000000000000013, -2.800000000000002, -1.8000000000000012, -1.9000000000000012, -1.8000000000000012, -2.3000000000000016, -1.600000000000001, -1.9000000000000012, -2.0000000000000013, -1.600000000000001, -2.700000000000002, -1.4000000000000008, -2.600000000000002, -2.3000000000000016, -3.3000000000000007, -1.600000000000001, -2.1000000000000014, -2.2000000000000015, -2.0000000000000013, -1.9000000000000012, -2.0000000000000013, -1.8000000000000012, -2.4000000000000017, -2.2000000000000015, -2.0000000000000013, -3.999999999999999, -2.0000000000000013, -2.2000000000000015, -2.4000000000000017, -1.4000000000000008, -2.0000000000000013, -6.499999999999996, -2.1000000000000014, -1.600000000000001, -1.700000000000001, -76.10000000000055, -1.700000000000001, -1.600000000000001, -2.0000000000000013, -1.9000000000000012, -2.5000000000000018, -2.1000000000000014, -1.700000000000001, -1.8000000000000012, -1.5000000000000009, -1.8000000000000012, -2.1000000000000014, -1.8000000000000012, -2.800000000000002, -1.700000000000001, -1.9000000000000012, -1.8000000000000012, -3.200000000000001, -2.3000000000000016, -1.700000000000001], "episode_lengths": [31, 28, 25, 31, 29, 35, 31, 35, 37, 25, 33, 29, 35, 28, 43, 31, 31, 28, 32, 26, 31, 38, 30, 30, 29, 32, 29, 35, 25, 33, 33, 33, 25, 33, 67, 26, 33, 34, 31, 32, 72, 30, 31, 35, 33, 32, 30, 27, 32, 32, 29, 27, 31, 29, 42, 29, 31, 33, 31, 32, 31, 400, 33, 31, 39, 29, 30, 29, 34, 27, 30, 30, 27, 38, 25, 37, 34, 44, 27, 32, 33, 31, 30, 31, 29, 35, 33, 31, 45, 31, 33, 35, 25, 31, 67, 32, 27, 28, 400, 28, 27, 31, 30, 34, 32, 28, 29, 26, 29, 32, 29, 39, 28, 30, 29, 43, 34, 28]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3431188834329324, "mean_inference_ms": 0.7360877852621518, "mean_action_processing_ms": 0.07639017947146248, "mean_env_wait_ms": 7.022695193341662, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006711280952065678, "StateBufferConnector_ms": 0.0038074234784659694, "ViewRequirementAgentConnector_ms": 0.08664797928373692}}, "episode_reward_max": -1.4000000000000008, "episode_reward_min": -76.80000000000052, "episode_reward_mean": -3.4457627118644165, "episode_len_mean": 38.559322033898304, "episodes_this_iter": 118, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-2.0000000000000013, -1.700000000000001, -1.4000000000000008, -2.0000000000000013, -1.8000000000000012, -2.4000000000000017, -2.0000000000000013, -2.4000000000000017, -2.600000000000002, -1.4000000000000008, -2.2000000000000015, -1.8000000000000012, -2.4000000000000017, -1.700000000000001, -3.200000000000001, -2.0000000000000013, -2.0000000000000013, -1.700000000000001, -2.1000000000000014, -1.5000000000000009, -2.0000000000000013, -2.700000000000002, -1.9000000000000012, -1.9000000000000012, -1.8000000000000012, -2.1000000000000014, -1.8000000000000012, -2.4000000000000017, -1.4000000000000008, -2.2000000000000015, -2.2000000000000015, -2.2000000000000015, -1.4000000000000008, -2.2000000000000015, -5.8999999999999915, -1.5000000000000009, -2.2000000000000015, -2.3000000000000016, -2.0000000000000013, -2.1000000000000014, -10.299999999999994, -1.9000000000000012, -2.0000000000000013, -2.4000000000000017, -2.2000000000000015, -2.1000000000000014, -1.9000000000000012, -1.600000000000001, -2.1000000000000014, -2.1000000000000014, -1.8000000000000012, -1.600000000000001, -2.0000000000000013, -1.8000000000000012, -3.1000000000000014, -1.8000000000000012, -2.0000000000000013, -2.2000000000000015, -2.0000000000000013, -2.1000000000000014, -2.0000000000000013, -76.80000000000052, -2.2000000000000015, -2.0000000000000013, -2.800000000000002, -1.8000000000000012, -1.9000000000000012, -1.8000000000000012, -2.3000000000000016, -1.600000000000001, -1.9000000000000012, -2.0000000000000013, -1.600000000000001, -2.700000000000002, -1.4000000000000008, -2.600000000000002, -2.3000000000000016, -3.3000000000000007, -1.600000000000001, -2.1000000000000014, -2.2000000000000015, -2.0000000000000013, -1.9000000000000012, -2.0000000000000013, -1.8000000000000012, -2.4000000000000017, -2.2000000000000015, -2.0000000000000013, -3.999999999999999, -2.0000000000000013, -2.2000000000000015, -2.4000000000000017, -1.4000000000000008, -2.0000000000000013, -6.499999999999996, -2.1000000000000014, -1.600000000000001, -1.700000000000001, -76.10000000000055, -1.700000000000001, -1.600000000000001, -2.0000000000000013, -1.9000000000000012, -2.5000000000000018, -2.1000000000000014, -1.700000000000001, -1.8000000000000012, -1.5000000000000009, -1.8000000000000012, -2.1000000000000014, -1.8000000000000012, -2.800000000000002, -1.700000000000001, -1.9000000000000012, -1.8000000000000012, -3.200000000000001, -2.3000000000000016, -1.700000000000001], "episode_lengths": [31, 28, 25, 31, 29, 35, 31, 35, 37, 25, 33, 29, 35, 28, 43, 31, 31, 28, 32, 26, 31, 38, 30, 30, 29, 32, 29, 35, 25, 33, 33, 33, 25, 33, 67, 26, 33, 34, 31, 32, 72, 30, 31, 35, 33, 32, 30, 27, 32, 32, 29, 27, 31, 29, 42, 29, 31, 33, 31, 32, 31, 400, 33, 31, 39, 29, 30, 29, 34, 27, 30, 30, 27, 38, 25, 37, 34, 44, 27, 32, 33, 31, 30, 31, 29, 35, 33, 31, 45, 31, 33, 35, 25, 31, 67, 32, 27, 28, 400, 28, 27, 31, 30, 34, 32, 28, 29, 26, 29, 32, 29, 39, 28, 30, 29, 43, 34, 28]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3431188834329324, "mean_inference_ms": 0.7360877852621518, "mean_action_processing_ms": 0.07639017947146248, "mean_env_wait_ms": 7.022695193341662, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006711280952065678, "StateBufferConnector_ms": 0.0038074234784659694, "ViewRequirementAgentConnector_ms": 0.08664797928373692}, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 288000, "num_agent_steps_trained": 288000, "num_env_steps_sampled": 288000, "num_env_steps_trained": 288000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 427.7925464642459, "num_env_steps_trained_throughput_per_sec": 427.7925464642459, "timesteps_total": 288000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 288000, "timers": {"training_iteration_time_ms": 9750.112, "sample_time_ms": 6010.921, "load_time_ms": 1.044, "load_throughput": 3829715.121, "learn_time_ms": 3733.988, "learn_throughput": 1071.241, "synch_weights_time_ms": 3.468}, "counters": {"num_env_steps_sampled": 288000, "num_env_steps_trained": 288000, "num_agent_steps_sampled": 288000, "num_agent_steps_trained": 288000}, "done": false, "episodes_total": 5478, "training_iteration": 72, "trial_id": "ddfb6_00000", "date": "2024-03-07_12-59-44", "timestamp": 1709834384, "time_this_iter_s": 9.353433609008789, "time_total_s": 683.969703912735, "pid": 112355, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4d85689f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 683.969703912735, "iterations_since_restore": 72, "perf": {"cpu_util_percent": 27.099999999999998, "ram_util_percent": 48.68333333333334, "gpu_util_percent0": 0.06333333333333334, "vram_util_percent0": 0.11126030815972221}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.08437500000000002, "cur_lr": 0.0010000000000000005, "total_loss": 1.1024817523937072, "policy_loss": -0.012969714647499464, "vf_loss": 1.1125572915995112, "vf_explained_var": 0.7073780345660384, "kl": 0.03430139904126713, "entropy": 0.4891546049746134, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 67425.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 292000, "num_env_steps_trained": 292000, "num_agent_steps_sampled": 292000, "num_agent_steps_trained": 292000}, "sampler_results": {"episode_reward_max": -1.600000000000001, "episode_reward_min": -77.00000000000055, "episode_reward_mean": -3.346666666666677, "episode_len_mean": 38.714285714285715, "episode_media": {}, "episodes_this_iter": 105, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2.2000000000000015, -2.3000000000000016, -2.800000000000002, -2.900000000000002, -2.0000000000000013, -1.8000000000000012, -1.9000000000000012, -2.4000000000000017, -2.0000000000000013, -2.1000000000000014, -1.700000000000001, -2.2000000000000015, -2.2000000000000015, -3.3000000000000007, -1.700000000000001, -1.8000000000000012, -2.0000000000000013, -2.0000000000000013, -2.3000000000000016, -2.600000000000002, -77.00000000000055, -1.8000000000000012, -2.5000000000000018, -2.0000000000000013, -2.1000000000000014, -2.0000000000000013, -2.1000000000000014, -1.9000000000000012, -2.1000000000000014, -1.700000000000001, -2.3000000000000016, -3.3000000000000007, -3.5999999999999996, -2.2000000000000015, -2.4000000000000017, -2.0000000000000013, -2.0000000000000013, -2.3000000000000016, -2.2000000000000015, -1.700000000000001, -2.600000000000002, -2.1000000000000014, -2.3000000000000016, -2.0000000000000013, -2.0000000000000013, -1.8000000000000012, -1.600000000000001, -2.1000000000000014, -1.8000000000000012, -1.9000000000000012, -1.600000000000001, -2.1000000000000014, -2.2000000000000015, -1.9000000000000012, -1.700000000000001, -2.900000000000002, -2.2000000000000015, -1.9000000000000012, -1.8000000000000012, -1.700000000000001, -2.2000000000000015, -3.0000000000000018, -1.9000000000000012, -1.9000000000000012, -2.2000000000000015, -2.1000000000000014, -1.9000000000000012, -1.700000000000001, -1.8000000000000012, -2.2000000000000015, -2.800000000000002, -1.9000000000000012, -1.8000000000000012, -1.9000000000000012, -1.700000000000001, -2.2000000000000015, -1.8000000000000012, -2.1000000000000014, -2.0000000000000013, -1.9000000000000012, -1.9000000000000012, -1.9000000000000012, -2.4000000000000017, -1.700000000000001, -1.8000000000000012, -1.700000000000001, -1.700000000000001, -1.600000000000001, -2.5000000000000018, -2.1000000000000014, -1.9000000000000012, -1.9000000000000012, -1.700000000000001, -2.2000000000000015, -2.1000000000000014, -1.9000000000000012, -2.0000000000000013, -2.1000000000000014, -2.1000000000000014, -2.1000000000000014, -1.700000000000001, -2.3000000000000016, -1.700000000000001, -1.9000000000000012, -59.90000000000036], "episode_lengths": [33, 34, 39, 40, 31, 29, 30, 35, 31, 32, 28, 33, 33, 44, 28, 29, 31, 31, 34, 37, 400, 29, 36, 31, 32, 31, 32, 30, 32, 28, 34, 37, 44, 33, 35, 31, 31, 34, 33, 28, 37, 32, 34, 31, 31, 29, 27, 32, 29, 30, 27, 32, 33, 30, 28, 40, 33, 30, 29, 28, 33, 41, 30, 30, 33, 32, 30, 28, 29, 33, 39, 30, 29, 30, 28, 33, 29, 32, 31, 30, 30, 30, 35, 28, 29, 28, 28, 27, 33, 32, 30, 30, 28, 33, 32, 30, 31, 32, 32, 32, 28, 34, 28, 30, 400]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.34427792929686507, "mean_inference_ms": 0.7355944182197052, "mean_action_processing_ms": 0.07639779898094606, "mean_env_wait_ms": 7.021858024047056, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006949333917526971, "StateBufferConnector_ms": 0.003836949666341146, "ViewRequirementAgentConnector_ms": 0.08742037273588635}}, "episode_reward_max": -1.600000000000001, "episode_reward_min": -77.00000000000055, "episode_reward_mean": -3.346666666666677, "episode_len_mean": 38.714285714285715, "episodes_this_iter": 105, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-2.2000000000000015, -2.3000000000000016, -2.800000000000002, -2.900000000000002, -2.0000000000000013, -1.8000000000000012, -1.9000000000000012, -2.4000000000000017, -2.0000000000000013, -2.1000000000000014, -1.700000000000001, -2.2000000000000015, -2.2000000000000015, -3.3000000000000007, -1.700000000000001, -1.8000000000000012, -2.0000000000000013, -2.0000000000000013, -2.3000000000000016, -2.600000000000002, -77.00000000000055, -1.8000000000000012, -2.5000000000000018, -2.0000000000000013, -2.1000000000000014, -2.0000000000000013, -2.1000000000000014, -1.9000000000000012, -2.1000000000000014, -1.700000000000001, -2.3000000000000016, -3.3000000000000007, -3.5999999999999996, -2.2000000000000015, -2.4000000000000017, -2.0000000000000013, -2.0000000000000013, -2.3000000000000016, -2.2000000000000015, -1.700000000000001, -2.600000000000002, -2.1000000000000014, -2.3000000000000016, -2.0000000000000013, -2.0000000000000013, -1.8000000000000012, -1.600000000000001, -2.1000000000000014, -1.8000000000000012, -1.9000000000000012, -1.600000000000001, -2.1000000000000014, -2.2000000000000015, -1.9000000000000012, -1.700000000000001, -2.900000000000002, -2.2000000000000015, -1.9000000000000012, -1.8000000000000012, -1.700000000000001, -2.2000000000000015, -3.0000000000000018, -1.9000000000000012, -1.9000000000000012, -2.2000000000000015, -2.1000000000000014, -1.9000000000000012, -1.700000000000001, -1.8000000000000012, -2.2000000000000015, -2.800000000000002, -1.9000000000000012, -1.8000000000000012, -1.9000000000000012, -1.700000000000001, -2.2000000000000015, -1.8000000000000012, -2.1000000000000014, -2.0000000000000013, -1.9000000000000012, -1.9000000000000012, -1.9000000000000012, -2.4000000000000017, -1.700000000000001, -1.8000000000000012, -1.700000000000001, -1.700000000000001, -1.600000000000001, -2.5000000000000018, -2.1000000000000014, -1.9000000000000012, -1.9000000000000012, -1.700000000000001, -2.2000000000000015, -2.1000000000000014, -1.9000000000000012, -2.0000000000000013, -2.1000000000000014, -2.1000000000000014, -2.1000000000000014, -1.700000000000001, -2.3000000000000016, -1.700000000000001, -1.9000000000000012, -59.90000000000036], "episode_lengths": [33, 34, 39, 40, 31, 29, 30, 35, 31, 32, 28, 33, 33, 44, 28, 29, 31, 31, 34, 37, 400, 29, 36, 31, 32, 31, 32, 30, 32, 28, 34, 37, 44, 33, 35, 31, 31, 34, 33, 28, 37, 32, 34, 31, 31, 29, 27, 32, 29, 30, 27, 32, 33, 30, 28, 40, 33, 30, 29, 28, 33, 41, 30, 30, 33, 32, 30, 28, 29, 33, 39, 30, 29, 30, 28, 33, 29, 32, 31, 30, 30, 30, 35, 28, 29, 28, 28, 27, 33, 32, 30, 30, 28, 33, 32, 30, 31, 32, 32, 32, 28, 34, 28, 30, 400]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.34427792929686507, "mean_inference_ms": 0.7355944182197052, "mean_action_processing_ms": 0.07639779898094606, "mean_env_wait_ms": 7.021858024047056, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006949333917526971, "StateBufferConnector_ms": 0.003836949666341146, "ViewRequirementAgentConnector_ms": 0.08742037273588635}, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 292000, "num_agent_steps_trained": 292000, "num_env_steps_sampled": 292000, "num_env_steps_trained": 292000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 432.04620313738707, "num_env_steps_trained_throughput_per_sec": 432.04620313738707, "timesteps_total": 292000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 292000, "timers": {"training_iteration_time_ms": 9660.348, "sample_time_ms": 5958.212, "load_time_ms": 1.046, "load_throughput": 3825000.228, "learn_time_ms": 3698.297, "learn_throughput": 1081.579, "synch_weights_time_ms": 2.118}, "counters": {"num_env_steps_sampled": 292000, "num_env_steps_trained": 292000, "num_agent_steps_sampled": 292000, "num_agent_steps_trained": 292000}, "done": false, "episodes_total": 5583, "training_iteration": 73, "trial_id": "ddfb6_00000", "date": "2024-03-07_12-59-53", "timestamp": 1709834393, "time_this_iter_s": 9.260964155197144, "time_total_s": 693.2306680679321, "pid": 112355, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4d85689f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 693.2306680679321, "iterations_since_restore": 73, "perf": {"cpu_util_percent": 26.615384615384617, "ram_util_percent": 48.54615384615385, "gpu_util_percent0": 0.08230769230769229, "vram_util_percent0": 0.10719651442307693}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.12656249999999997, "cur_lr": 0.0010000000000000005, "total_loss": 0.47716953878075646, "policy_loss": -0.00877201928887316, "vf_loss": 0.48431285617833014, "vf_explained_var": 0.7578150863929461, "kl": 0.012868739409434487, "entropy": 0.4874829580706935, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 68355.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 296000, "num_env_steps_trained": 296000, "num_agent_steps_sampled": 296000, "num_agent_steps_trained": 296000}, "sampler_results": {"episode_reward_max": -1.700000000000001, "episode_reward_min": -7.9999999999999964, "episode_reward_mean": -2.5180000000000007, "episode_len_mean": 35.77, "episode_media": {}, "episodes_this_iter": 100, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2.600000000000002, -2.4000000000000017, -2.2000000000000015, -1.8000000000000012, -3.0000000000000018, -2.600000000000002, -1.9000000000000012, -3.1000000000000014, -3.9999999999999982, -2.2000000000000015, -7.9999999999999964, -4.0, -2.600000000000002, -2.800000000000002, -2.0000000000000013, -2.600000000000002, -3.4000000000000004, -2.2000000000000015, -1.700000000000001, -1.9000000000000012, -2.3000000000000016, -2.800000000000002, -1.700000000000001, -2.1000000000000014, -2.600000000000002, -3.200000000000001, -1.700000000000001, -2.5000000000000018, -3.9999999999999982, -2.700000000000002, -1.9000000000000012, -2.2000000000000015, -2.0000000000000013, -2.5000000000000018, -7.499999999999986, -2.0000000000000013, -2.0000000000000013, -2.4000000000000017, -1.9000000000000012, -1.700000000000001, -2.2000000000000015, -2.5000000000000018, -1.700000000000001, -1.700000000000001, -2.900000000000002, -2.600000000000002, -2.3000000000000016, -3.1000000000000014, -1.9000000000000012, -2.4000000000000017, -2.2000000000000015, -2.0000000000000013, -2.3000000000000016, -2.1000000000000014, -1.8000000000000012, -2.4000000000000017, -2.0000000000000013, -3.200000000000001, -2.2000000000000015, -2.5000000000000018, -2.4000000000000017, -2.1000000000000014, -1.9000000000000012, -2.5000000000000018, -2.800000000000002, -2.700000000000002, -2.1000000000000014, -2.4000000000000017, -2.1000000000000014, -2.4000000000000017, -3.0000000000000018, -2.3000000000000016, -2.5000000000000018, -2.600000000000002, -1.9000000000000012, -1.8000000000000012, -2.700000000000002, -2.4000000000000017, -1.8000000000000012, -2.600000000000002, -1.8000000000000012, -2.4000000000000017, -2.2000000000000015, -3.1000000000000014, -2.1000000000000014, -2.0000000000000013, -1.8000000000000012, -2.5000000000000018, -4.6000000000000005, -2.800000000000002, -1.8000000000000012, -2.0000000000000013, -1.9000000000000012, -3.200000000000002, -3.1000000000000014, -1.9000000000000012, -2.600000000000002, -2.2000000000000015, -2.0000000000000013, -4.1000000000000005], "episode_lengths": [37, 35, 33, 29, 41, 37, 30, 42, 51, 33, 75, 49, 37, 39, 31, 37, 45, 33, 28, 30, 34, 39, 28, 32, 37, 43, 28, 36, 50, 38, 30, 33, 31, 36, 86, 31, 31, 35, 30, 28, 33, 36, 28, 28, 38, 37, 34, 42, 30, 35, 33, 31, 34, 32, 29, 35, 31, 43, 33, 36, 35, 32, 30, 36, 39, 38, 32, 35, 32, 35, 41, 34, 36, 37, 30, 29, 38, 35, 29, 37, 29, 35, 33, 42, 32, 31, 29, 36, 50, 39, 29, 31, 30, 35, 42, 30, 37, 33, 31, 47]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3440879449129517, "mean_inference_ms": 0.735351981552091, "mean_action_processing_ms": 0.07633140950203944, "mean_env_wait_ms": 7.038945075597477, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006741762161254883, "StateBufferConnector_ms": 0.0037996768951416016, "ViewRequirementAgentConnector_ms": 0.0866079330444336}}, "episode_reward_max": -1.700000000000001, "episode_reward_min": -7.9999999999999964, "episode_reward_mean": -2.5180000000000007, "episode_len_mean": 35.77, "episodes_this_iter": 100, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-2.600000000000002, -2.4000000000000017, -2.2000000000000015, -1.8000000000000012, -3.0000000000000018, -2.600000000000002, -1.9000000000000012, -3.1000000000000014, -3.9999999999999982, -2.2000000000000015, -7.9999999999999964, -4.0, -2.600000000000002, -2.800000000000002, -2.0000000000000013, -2.600000000000002, -3.4000000000000004, -2.2000000000000015, -1.700000000000001, -1.9000000000000012, -2.3000000000000016, -2.800000000000002, -1.700000000000001, -2.1000000000000014, -2.600000000000002, -3.200000000000001, -1.700000000000001, -2.5000000000000018, -3.9999999999999982, -2.700000000000002, -1.9000000000000012, -2.2000000000000015, -2.0000000000000013, -2.5000000000000018, -7.499999999999986, -2.0000000000000013, -2.0000000000000013, -2.4000000000000017, -1.9000000000000012, -1.700000000000001, -2.2000000000000015, -2.5000000000000018, -1.700000000000001, -1.700000000000001, -2.900000000000002, -2.600000000000002, -2.3000000000000016, -3.1000000000000014, -1.9000000000000012, -2.4000000000000017, -2.2000000000000015, -2.0000000000000013, -2.3000000000000016, -2.1000000000000014, -1.8000000000000012, -2.4000000000000017, -2.0000000000000013, -3.200000000000001, -2.2000000000000015, -2.5000000000000018, -2.4000000000000017, -2.1000000000000014, -1.9000000000000012, -2.5000000000000018, -2.800000000000002, -2.700000000000002, -2.1000000000000014, -2.4000000000000017, -2.1000000000000014, -2.4000000000000017, -3.0000000000000018, -2.3000000000000016, -2.5000000000000018, -2.600000000000002, -1.9000000000000012, -1.8000000000000012, -2.700000000000002, -2.4000000000000017, -1.8000000000000012, -2.600000000000002, -1.8000000000000012, -2.4000000000000017, -2.2000000000000015, -3.1000000000000014, -2.1000000000000014, -2.0000000000000013, -1.8000000000000012, -2.5000000000000018, -4.6000000000000005, -2.800000000000002, -1.8000000000000012, -2.0000000000000013, -1.9000000000000012, -3.200000000000002, -3.1000000000000014, -1.9000000000000012, -2.600000000000002, -2.2000000000000015, -2.0000000000000013, -4.1000000000000005], "episode_lengths": [37, 35, 33, 29, 41, 37, 30, 42, 51, 33, 75, 49, 37, 39, 31, 37, 45, 33, 28, 30, 34, 39, 28, 32, 37, 43, 28, 36, 50, 38, 30, 33, 31, 36, 86, 31, 31, 35, 30, 28, 33, 36, 28, 28, 38, 37, 34, 42, 30, 35, 33, 31, 34, 32, 29, 35, 31, 43, 33, 36, 35, 32, 30, 36, 39, 38, 32, 35, 32, 35, 41, 34, 36, 37, 30, 29, 38, 35, 29, 37, 29, 35, 33, 42, 32, 31, 29, 36, 50, 39, 29, 31, 30, 35, 42, 30, 37, 33, 31, 47]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3440879449129517, "mean_inference_ms": 0.735351981552091, "mean_action_processing_ms": 0.07633140950203944, "mean_env_wait_ms": 7.038945075597477, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006741762161254883, "StateBufferConnector_ms": 0.0037996768951416016, "ViewRequirementAgentConnector_ms": 0.0866079330444336}, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 296000, "num_agent_steps_trained": 296000, "num_env_steps_sampled": 296000, "num_env_steps_trained": 296000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 431.11223752233684, "num_env_steps_trained_throughput_per_sec": 431.11223752233684, "timesteps_total": 296000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 296000, "timers": {"training_iteration_time_ms": 9619.199, "sample_time_ms": 5932.801, "load_time_ms": 1.044, "load_throughput": 3832602.17, "learn_time_ms": 3682.575, "learn_throughput": 1086.197, "synch_weights_time_ms": 2.112}, "counters": {"num_env_steps_sampled": 296000, "num_env_steps_trained": 296000, "num_agent_steps_sampled": 296000, "num_agent_steps_trained": 296000}, "done": false, "episodes_total": 5683, "training_iteration": 74, "trial_id": "ddfb6_00000", "date": "2024-03-07_13-00-02", "timestamp": 1709834402, "time_this_iter_s": 9.281169176101685, "time_total_s": 702.5118372440338, "pid": 112355, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4d85689f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 702.5118372440338, "iterations_since_restore": 74, "perf": {"cpu_util_percent": 26.708333333333332, "ram_util_percent": 48.525, "gpu_util_percent0": 0.0775, "vram_util_percent0": 0.10719807942708333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.12656249999999997, "cur_lr": 0.0010000000000000005, "total_loss": 1.4079971344448046, "policy_loss": -0.012423674082283372, "vf_loss": 1.4183627305972961, "vf_explained_var": 0.540422664534661, "kl": 0.01626135454109998, "entropy": 0.4927039602110463, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 69285.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 300000, "num_env_steps_trained": 300000, "num_agent_steps_sampled": 300000, "num_agent_steps_trained": 300000}, "sampler_results": {"episode_reward_max": -1.5000000000000009, "episode_reward_min": -75.00000000000053, "episode_reward_mean": -4.120388349514573, "episode_len_mean": 43.14563106796116, "episode_media": {}, "episodes_this_iter": 103, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-75.00000000000053, -2.4000000000000017, -3.4000000000000004, -1.8000000000000012, -1.9000000000000012, -2.800000000000002, -1.8000000000000012, -1.600000000000001, -2.0000000000000013, -1.8000000000000012, -1.8000000000000012, -3.3000000000000016, -2.1000000000000014, -3.6999999999999993, -2.1000000000000014, -2.5000000000000018, -1.9000000000000012, -2.3000000000000016, -2.0000000000000013, -2.1000000000000014, -1.600000000000001, -2.3000000000000016, -2.1000000000000014, -1.8000000000000012, -2.4000000000000017, -2.0000000000000013, -1.8000000000000012, -2.4000000000000017, -3.0000000000000018, -1.700000000000001, -2.1000000000000014, -1.8000000000000012, -2.3000000000000016, -1.8000000000000012, -3.9000000000000012, -1.8000000000000012, -1.8000000000000012, -2.1000000000000014, -1.8000000000000012, -1.9000000000000012, -1.9000000000000012, -1.8000000000000012, -3.0000000000000018, -3.799999999999999, -3.5, -2.3000000000000016, -2.900000000000002, -1.600000000000001, -2.5000000000000018, -2.1000000000000014, -1.8000000000000012, -2.2000000000000015, -3.200000000000001, -74.3000000000005, -1.9000000000000012, -3.8, -2.2000000000000015, -17.099999999999973, -2.1000000000000014, -2.1000000000000014, -1.5000000000000009, -4.700000000000004, -2.4000000000000017, -2.1000000000000014, -1.8000000000000012, -2.1000000000000014, -1.9000000000000012, -4.899999999999995, -2.700000000000002, -15.599999999999977, -2.900000000000002, -1.600000000000001, -3.0000000000000018, -3.5, -2.600000000000002, -1.8000000000000012, -9.499999999999996, -1.8000000000000012, -2.0000000000000013, -2.1000000000000014, -2.700000000000002, -3.0000000000000018, -2.0000000000000013, -2.3000000000000016, -1.8000000000000012, -3.5999999999999996, -4.300000000000002, -1.9000000000000012, -2.2000000000000015, -2.3000000000000016, -2.1000000000000014, -2.4000000000000017, -2.8000000000000016, -3.200000000000001, -1.9000000000000012, -2.3000000000000016, -1.9000000000000012, -2.0000000000000013, -3.8000000000000025, -2.4000000000000017, -2.1000000000000014, -1.700000000000001, -2.4000000000000017], "episode_lengths": [400, 35, 45, 29, 30, 39, 29, 27, 31, 29, 29, 43, 32, 48, 32, 36, 30, 33, 31, 32, 27, 34, 32, 29, 35, 31, 29, 35, 41, 28, 32, 29, 34, 29, 41, 29, 29, 32, 29, 30, 30, 29, 41, 49, 46, 32, 40, 27, 36, 32, 29, 33, 43, 400, 30, 45, 33, 113, 32, 32, 26, 46, 35, 32, 29, 32, 30, 60, 37, 109, 40, 27, 41, 39, 37, 29, 73, 29, 31, 32, 38, 41, 31, 34, 29, 45, 49, 30, 33, 34, 32, 35, 37, 38, 30, 34, 30, 31, 42, 35, 32, 28, 35]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3446006527803265, "mean_inference_ms": 0.7350676887806735, "mean_action_processing_ms": 0.07632932619627682, "mean_env_wait_ms": 7.04659992407865, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006691691944900068, "StateBufferConnector_ms": 0.003788540664228421, "ViewRequirementAgentConnector_ms": 0.0862285928818786}}, "episode_reward_max": -1.5000000000000009, "episode_reward_min": -75.00000000000053, "episode_reward_mean": -4.120388349514573, "episode_len_mean": 43.14563106796116, "episodes_this_iter": 103, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-75.00000000000053, -2.4000000000000017, -3.4000000000000004, -1.8000000000000012, -1.9000000000000012, -2.800000000000002, -1.8000000000000012, -1.600000000000001, -2.0000000000000013, -1.8000000000000012, -1.8000000000000012, -3.3000000000000016, -2.1000000000000014, -3.6999999999999993, -2.1000000000000014, -2.5000000000000018, -1.9000000000000012, -2.3000000000000016, -2.0000000000000013, -2.1000000000000014, -1.600000000000001, -2.3000000000000016, -2.1000000000000014, -1.8000000000000012, -2.4000000000000017, -2.0000000000000013, -1.8000000000000012, -2.4000000000000017, -3.0000000000000018, -1.700000000000001, -2.1000000000000014, -1.8000000000000012, -2.3000000000000016, -1.8000000000000012, -3.9000000000000012, -1.8000000000000012, -1.8000000000000012, -2.1000000000000014, -1.8000000000000012, -1.9000000000000012, -1.9000000000000012, -1.8000000000000012, -3.0000000000000018, -3.799999999999999, -3.5, -2.3000000000000016, -2.900000000000002, -1.600000000000001, -2.5000000000000018, -2.1000000000000014, -1.8000000000000012, -2.2000000000000015, -3.200000000000001, -74.3000000000005, -1.9000000000000012, -3.8, -2.2000000000000015, -17.099999999999973, -2.1000000000000014, -2.1000000000000014, -1.5000000000000009, -4.700000000000004, -2.4000000000000017, -2.1000000000000014, -1.8000000000000012, -2.1000000000000014, -1.9000000000000012, -4.899999999999995, -2.700000000000002, -15.599999999999977, -2.900000000000002, -1.600000000000001, -3.0000000000000018, -3.5, -2.600000000000002, -1.8000000000000012, -9.499999999999996, -1.8000000000000012, -2.0000000000000013, -2.1000000000000014, -2.700000000000002, -3.0000000000000018, -2.0000000000000013, -2.3000000000000016, -1.8000000000000012, -3.5999999999999996, -4.300000000000002, -1.9000000000000012, -2.2000000000000015, -2.3000000000000016, -2.1000000000000014, -2.4000000000000017, -2.8000000000000016, -3.200000000000001, -1.9000000000000012, -2.3000000000000016, -1.9000000000000012, -2.0000000000000013, -3.8000000000000025, -2.4000000000000017, -2.1000000000000014, -1.700000000000001, -2.4000000000000017], "episode_lengths": [400, 35, 45, 29, 30, 39, 29, 27, 31, 29, 29, 43, 32, 48, 32, 36, 30, 33, 31, 32, 27, 34, 32, 29, 35, 31, 29, 35, 41, 28, 32, 29, 34, 29, 41, 29, 29, 32, 29, 30, 30, 29, 41, 49, 46, 32, 40, 27, 36, 32, 29, 33, 43, 400, 30, 45, 33, 113, 32, 32, 26, 46, 35, 32, 29, 32, 30, 60, 37, 109, 40, 27, 41, 39, 37, 29, 73, 29, 31, 32, 38, 41, 31, 34, 29, 45, 49, 30, 33, 34, 32, 35, 37, 38, 30, 34, 30, 31, 42, 35, 32, 28, 35]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3446006527803265, "mean_inference_ms": 0.7350676887806735, "mean_action_processing_ms": 0.07632932619627682, "mean_env_wait_ms": 7.04659992407865, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006691691944900068, "StateBufferConnector_ms": 0.003788540664228421, "ViewRequirementAgentConnector_ms": 0.0862285928818786}, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 300000, "num_agent_steps_trained": 300000, "num_env_steps_sampled": 300000, "num_env_steps_trained": 300000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 428.8165401179584, "num_env_steps_trained_throughput_per_sec": 428.8165401179584, "timesteps_total": 300000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 300000, "timers": {"training_iteration_time_ms": 9604.277, "sample_time_ms": 5924.743, "load_time_ms": 1.045, "load_throughput": 3827268.911, "learn_time_ms": 3675.713, "learn_throughput": 1088.224, "synch_weights_time_ms": 2.11}, "counters": {"num_env_steps_sampled": 300000, "num_env_steps_trained": 300000, "num_agent_steps_sampled": 300000, "num_agent_steps_trained": 300000}, "done": false, "episodes_total": 5786, "training_iteration": 75, "trial_id": "ddfb6_00000", "date": "2024-03-07_13-00-12", "timestamp": 1709834412, "time_this_iter_s": 9.330908298492432, "time_total_s": 711.8427455425262, "pid": 112355, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4d85689f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 711.8427455425262, "iterations_since_restore": 75, "perf": {"cpu_util_percent": 27.100000000000005, "ram_util_percent": 48.333333333333336, "gpu_util_percent0": 0.07583333333333332, "vram_util_percent0": 0.10719129774305554}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.12656249999999997, "cur_lr": 0.0010000000000000005, "total_loss": 0.6094718816056748, "policy_loss": -0.00961256146190628, "vf_loss": 0.6169489452294925, "vf_explained_var": 0.7794014166119279, "kl": 0.016873052760355986, "entropy": 0.48295351561679634, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 70215.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 304000, "num_env_steps_trained": 304000, "num_agent_steps_sampled": 304000, "num_agent_steps_trained": 304000}, "sampler_results": {"episode_reward_max": -1.700000000000001, "episode_reward_min": -13.799999999999972, "episode_reward_mean": -2.6472222222222226, "episode_len_mean": 36.71296296296296, "episode_media": {}, "episodes_this_iter": 108, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.200000000000001, -1.8000000000000012, -2.5000000000000018, -2.4000000000000017, -2.5000000000000018, -13.799999999999972, -2.4000000000000017, -2.0000000000000013, -2.3000000000000016, -3.0000000000000018, -2.4000000000000017, -2.600000000000002, -2.3000000000000016, -1.8000000000000012, -2.1000000000000014, -3.4000000000000012, -2.3000000000000016, -2.2000000000000015, -1.9000000000000012, -5.399999999999993, -1.8000000000000012, -2.900000000000002, -2.800000000000002, -2.4000000000000017, -2.1000000000000014, -1.9000000000000012, -5.199999999999994, -2.3000000000000016, -1.9000000000000012, -2.2000000000000015, -1.700000000000001, -2.700000000000002, -2.3000000000000016, -2.2000000000000015, -7.399999999999986, -2.2000000000000015, -2.1000000000000014, -5.499999999999993, -2.0000000000000013, -3.1000000000000014, -2.2000000000000015, -2.1000000000000014, -1.9000000000000012, -2.4000000000000017, -2.0000000000000013, -2.800000000000002, -2.3000000000000016, -2.600000000000002, -2.4000000000000017, -2.700000000000002, -2.800000000000002, -1.9000000000000012, -3.200000000000001, -2.700000000000002, -3.5999999999999996, -3.3000000000000007, -1.9000000000000012, -2.3000000000000016, -2.2000000000000015, -2.0000000000000013, -5.400000000000004, -3.5, -2.900000000000002, -2.2000000000000015, -1.9000000000000012, -2.1000000000000014, -2.900000000000002, -2.800000000000002, -2.3000000000000016, -2.2000000000000015, -1.9000000000000012, -2.2000000000000015, -2.2000000000000015, -1.9000000000000012, -1.8000000000000012, -2.0000000000000013, -4.300000000000002, -2.0000000000000013, -2.2000000000000015, -1.9000000000000012, -2.1000000000000014, -1.8000000000000012, -1.8000000000000012, -2.4000000000000017, -2.5000000000000018, -6.199999999999996, -1.9000000000000012, -2.700000000000002, -2.1000000000000014, -2.0000000000000013, -1.8000000000000012, -1.700000000000001, -3.0000000000000018, -1.8000000000000012, -1.8000000000000012, -2.1000000000000014, -2.4000000000000017, -2.0000000000000013, -2.1000000000000014, -2.1000000000000014, -2.0000000000000013, -3.5999999999999996, -2.1000000000000014, -2.4000000000000017, -2.700000000000002, -2.0000000000000013, -3.6999999999999993, -2.2000000000000015], "episode_lengths": [43, 29, 36, 35, 36, 128, 35, 31, 34, 41, 35, 37, 34, 29, 32, 37, 34, 33, 30, 60, 29, 38, 39, 35, 32, 30, 63, 34, 30, 33, 28, 38, 34, 33, 85, 33, 32, 54, 31, 40, 33, 32, 30, 35, 31, 39, 34, 37, 35, 38, 37, 30, 43, 38, 47, 44, 30, 34, 33, 31, 49, 46, 39, 33, 30, 32, 40, 39, 34, 33, 30, 33, 33, 30, 29, 31, 49, 31, 33, 30, 32, 29, 29, 35, 36, 65, 30, 38, 32, 31, 29, 28, 41, 29, 29, 32, 35, 31, 32, 32, 31, 47, 32, 35, 38, 31, 48, 33]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3448585822423911, "mean_inference_ms": 0.7345277683738735, "mean_action_processing_ms": 0.0762554359552546, "mean_env_wait_ms": 7.040347879057845, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00661964769716616, "StateBufferConnector_ms": 0.0038085160432038486, "ViewRequirementAgentConnector_ms": 0.08686869232742875}}, "episode_reward_max": -1.700000000000001, "episode_reward_min": -13.799999999999972, "episode_reward_mean": -2.6472222222222226, "episode_len_mean": 36.71296296296296, "episodes_this_iter": 108, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3.200000000000001, -1.8000000000000012, -2.5000000000000018, -2.4000000000000017, -2.5000000000000018, -13.799999999999972, -2.4000000000000017, -2.0000000000000013, -2.3000000000000016, -3.0000000000000018, -2.4000000000000017, -2.600000000000002, -2.3000000000000016, -1.8000000000000012, -2.1000000000000014, -3.4000000000000012, -2.3000000000000016, -2.2000000000000015, -1.9000000000000012, -5.399999999999993, -1.8000000000000012, -2.900000000000002, -2.800000000000002, -2.4000000000000017, -2.1000000000000014, -1.9000000000000012, -5.199999999999994, -2.3000000000000016, -1.9000000000000012, -2.2000000000000015, -1.700000000000001, -2.700000000000002, -2.3000000000000016, -2.2000000000000015, -7.399999999999986, -2.2000000000000015, -2.1000000000000014, -5.499999999999993, -2.0000000000000013, -3.1000000000000014, -2.2000000000000015, -2.1000000000000014, -1.9000000000000012, -2.4000000000000017, -2.0000000000000013, -2.800000000000002, -2.3000000000000016, -2.600000000000002, -2.4000000000000017, -2.700000000000002, -2.800000000000002, -1.9000000000000012, -3.200000000000001, -2.700000000000002, -3.5999999999999996, -3.3000000000000007, -1.9000000000000012, -2.3000000000000016, -2.2000000000000015, -2.0000000000000013, -5.400000000000004, -3.5, -2.900000000000002, -2.2000000000000015, -1.9000000000000012, -2.1000000000000014, -2.900000000000002, -2.800000000000002, -2.3000000000000016, -2.2000000000000015, -1.9000000000000012, -2.2000000000000015, -2.2000000000000015, -1.9000000000000012, -1.8000000000000012, -2.0000000000000013, -4.300000000000002, -2.0000000000000013, -2.2000000000000015, -1.9000000000000012, -2.1000000000000014, -1.8000000000000012, -1.8000000000000012, -2.4000000000000017, -2.5000000000000018, -6.199999999999996, -1.9000000000000012, -2.700000000000002, -2.1000000000000014, -2.0000000000000013, -1.8000000000000012, -1.700000000000001, -3.0000000000000018, -1.8000000000000012, -1.8000000000000012, -2.1000000000000014, -2.4000000000000017, -2.0000000000000013, -2.1000000000000014, -2.1000000000000014, -2.0000000000000013, -3.5999999999999996, -2.1000000000000014, -2.4000000000000017, -2.700000000000002, -2.0000000000000013, -3.6999999999999993, -2.2000000000000015], "episode_lengths": [43, 29, 36, 35, 36, 128, 35, 31, 34, 41, 35, 37, 34, 29, 32, 37, 34, 33, 30, 60, 29, 38, 39, 35, 32, 30, 63, 34, 30, 33, 28, 38, 34, 33, 85, 33, 32, 54, 31, 40, 33, 32, 30, 35, 31, 39, 34, 37, 35, 38, 37, 30, 43, 38, 47, 44, 30, 34, 33, 31, 49, 46, 39, 33, 30, 32, 40, 39, 34, 33, 30, 33, 33, 30, 29, 31, 49, 31, 33, 30, 32, 29, 29, 35, 36, 65, 30, 38, 32, 31, 29, 28, 41, 29, 29, 32, 35, 31, 32, 32, 31, 47, 32, 35, 38, 31, 48, 33]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3448585822423911, "mean_inference_ms": 0.7345277683738735, "mean_action_processing_ms": 0.0762554359552546, "mean_env_wait_ms": 7.040347879057845, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00661964769716616, "StateBufferConnector_ms": 0.0038085160432038486, "ViewRequirementAgentConnector_ms": 0.08686869232742875}, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 304000, "num_agent_steps_trained": 304000, "num_env_steps_sampled": 304000, "num_env_steps_trained": 304000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 423.7765249064834, "num_env_steps_trained_throughput_per_sec": 423.7765249064834, "timesteps_total": 304000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 304000, "timers": {"training_iteration_time_ms": 9595.051, "sample_time_ms": 5913.582, "load_time_ms": 1.046, "load_throughput": 3825436.304, "learn_time_ms": 3677.697, "learn_throughput": 1087.637, "synch_weights_time_ms": 2.073}, "counters": {"num_env_steps_sampled": 304000, "num_env_steps_trained": 304000, "num_agent_steps_sampled": 304000, "num_agent_steps_trained": 304000}, "done": false, "episodes_total": 5894, "training_iteration": 76, "trial_id": "ddfb6_00000", "date": "2024-03-07_13-00-21", "timestamp": 1709834421, "time_this_iter_s": 9.441447496414185, "time_total_s": 721.2841930389404, "pid": 112355, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4d85689f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 721.2841930389404, "iterations_since_restore": 76, "perf": {"cpu_util_percent": 26.949999999999992, "ram_util_percent": 48.08333333333334, "gpu_util_percent0": 0.06666666666666667, "vram_util_percent0": 0.10719129774305554}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.12656249999999997, "cur_lr": 0.0010000000000000005, "total_loss": 0.3712162822779138, "policy_loss": -0.011943229532209776, "vf_loss": 0.3816705079178416, "vf_explained_var": 0.7495558035630052, "kl": 0.011764961677672115, "entropy": 0.4458086618172225, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 71145.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 308000, "num_env_steps_trained": 308000, "num_agent_steps_sampled": 308000, "num_agent_steps_trained": 308000}, "sampler_results": {"episode_reward_max": -1.4000000000000008, "episode_reward_min": -9.099999999999998, "episode_reward_mean": -2.2727272727272747, "episode_len_mean": 33.19090909090909, "episode_media": {}, "episodes_this_iter": 110, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1.8000000000000012, -2.4000000000000017, -1.8000000000000012, -1.9000000000000012, -2.0000000000000013, -2.4000000000000017, -1.9000000000000012, -1.700000000000001, -2.5000000000000018, -2.0000000000000013, -2.1000000000000014, -1.700000000000001, -3.5, -2.5000000000000018, -2.5000000000000018, -2.700000000000002, -3.700000000000002, -2.0000000000000013, -2.600000000000002, -1.8000000000000012, -2.0000000000000013, -3.9000000000000012, -2.0000000000000013, -2.700000000000002, -2.3000000000000016, -2.800000000000002, -2.1000000000000014, -2.5000000000000018, -2.1000000000000014, -2.2000000000000015, -2.0000000000000013, -2.3000000000000016, -9.099999999999998, -2.4000000000000017, -1.9000000000000012, -1.4000000000000008, -1.9000000000000012, -2.4000000000000017, -2.900000000000002, -2.5000000000000018, -2.700000000000002, -1.9000000000000012, -1.700000000000001, -1.700000000000001, -2.2000000000000015, -2.0000000000000013, -1.9000000000000012, -2.0000000000000013, -2.3000000000000016, -1.9000000000000012, -1.700000000000001, -1.9000000000000012, -2.1000000000000014, -2.2000000000000015, -1.9000000000000012, -2.0000000000000013, -1.700000000000001, -2.700000000000002, -2.700000000000002, -2.800000000000002, -1.600000000000001, -2.4000000000000017, -2.4000000000000017, -1.600000000000001, -2.1000000000000014, -2.3000000000000016, -2.0000000000000013, -2.900000000000002, -2.0000000000000013, -1.8000000000000012, -2.2000000000000015, -2.2000000000000015, -1.5000000000000009, -2.1000000000000014, -2.1000000000000014, -2.2000000000000015, -2.4000000000000017, -1.600000000000001, -1.700000000000001, -3.5999999999999996, -1.8000000000000012, -1.8000000000000012, -1.700000000000001, -3.700000000000003, -2.0000000000000013, -1.8000000000000012, -2.4000000000000017, -2.1000000000000014, -2.600000000000002, -2.2000000000000015, -1.600000000000001, -2.4000000000000017, -2.900000000000002, -2.0000000000000013, -1.9000000000000012, -2.3000000000000016, -2.1000000000000014, -2.4000000000000017, -1.9000000000000012, -2.2000000000000015, -1.600000000000001, -2.1000000000000014, -2.1000000000000014, -2.800000000000002, -1.9000000000000012, -4.3000000000000025, -2.3000000000000016, -2.3000000000000016, -1.700000000000001, -1.5000000000000009], "episode_lengths": [29, 35, 29, 30, 31, 35, 30, 28, 36, 31, 32, 28, 44, 36, 36, 38, 44, 31, 37, 29, 31, 46, 31, 38, 34, 39, 32, 36, 32, 33, 31, 34, 71, 35, 29, 25, 30, 35, 38, 36, 38, 30, 28, 28, 33, 31, 30, 31, 34, 30, 28, 30, 32, 33, 30, 31, 28, 38, 38, 39, 27, 34, 35, 27, 32, 34, 31, 40, 31, 29, 32, 33, 26, 32, 32, 33, 35, 27, 28, 47, 29, 29, 28, 44, 31, 29, 35, 32, 37, 33, 27, 35, 40, 31, 30, 34, 32, 35, 30, 33, 27, 32, 32, 39, 30, 45, 34, 34, 28, 26]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.34567834303458367, "mean_inference_ms": 0.7339626583400556, "mean_action_processing_ms": 0.07619582971334053, "mean_env_wait_ms": 7.044652611956427, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006714517419988459, "StateBufferConnector_ms": 0.0037553093650124288, "ViewRequirementAgentConnector_ms": 0.08555325594815341}}, "episode_reward_max": -1.4000000000000008, "episode_reward_min": -9.099999999999998, "episode_reward_mean": -2.2727272727272747, "episode_len_mean": 33.19090909090909, "episodes_this_iter": 110, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1.8000000000000012, -2.4000000000000017, -1.8000000000000012, -1.9000000000000012, -2.0000000000000013, -2.4000000000000017, -1.9000000000000012, -1.700000000000001, -2.5000000000000018, -2.0000000000000013, -2.1000000000000014, -1.700000000000001, -3.5, -2.5000000000000018, -2.5000000000000018, -2.700000000000002, -3.700000000000002, -2.0000000000000013, -2.600000000000002, -1.8000000000000012, -2.0000000000000013, -3.9000000000000012, -2.0000000000000013, -2.700000000000002, -2.3000000000000016, -2.800000000000002, -2.1000000000000014, -2.5000000000000018, -2.1000000000000014, -2.2000000000000015, -2.0000000000000013, -2.3000000000000016, -9.099999999999998, -2.4000000000000017, -1.9000000000000012, -1.4000000000000008, -1.9000000000000012, -2.4000000000000017, -2.900000000000002, -2.5000000000000018, -2.700000000000002, -1.9000000000000012, -1.700000000000001, -1.700000000000001, -2.2000000000000015, -2.0000000000000013, -1.9000000000000012, -2.0000000000000013, -2.3000000000000016, -1.9000000000000012, -1.700000000000001, -1.9000000000000012, -2.1000000000000014, -2.2000000000000015, -1.9000000000000012, -2.0000000000000013, -1.700000000000001, -2.700000000000002, -2.700000000000002, -2.800000000000002, -1.600000000000001, -2.4000000000000017, -2.4000000000000017, -1.600000000000001, -2.1000000000000014, -2.3000000000000016, -2.0000000000000013, -2.900000000000002, -2.0000000000000013, -1.8000000000000012, -2.2000000000000015, -2.2000000000000015, -1.5000000000000009, -2.1000000000000014, -2.1000000000000014, -2.2000000000000015, -2.4000000000000017, -1.600000000000001, -1.700000000000001, -3.5999999999999996, -1.8000000000000012, -1.8000000000000012, -1.700000000000001, -3.700000000000003, -2.0000000000000013, -1.8000000000000012, -2.4000000000000017, -2.1000000000000014, -2.600000000000002, -2.2000000000000015, -1.600000000000001, -2.4000000000000017, -2.900000000000002, -2.0000000000000013, -1.9000000000000012, -2.3000000000000016, -2.1000000000000014, -2.4000000000000017, -1.9000000000000012, -2.2000000000000015, -1.600000000000001, -2.1000000000000014, -2.1000000000000014, -2.800000000000002, -1.9000000000000012, -4.3000000000000025, -2.3000000000000016, -2.3000000000000016, -1.700000000000001, -1.5000000000000009], "episode_lengths": [29, 35, 29, 30, 31, 35, 30, 28, 36, 31, 32, 28, 44, 36, 36, 38, 44, 31, 37, 29, 31, 46, 31, 38, 34, 39, 32, 36, 32, 33, 31, 34, 71, 35, 29, 25, 30, 35, 38, 36, 38, 30, 28, 28, 33, 31, 30, 31, 34, 30, 28, 30, 32, 33, 30, 31, 28, 38, 38, 39, 27, 34, 35, 27, 32, 34, 31, 40, 31, 29, 32, 33, 26, 32, 32, 33, 35, 27, 28, 47, 29, 29, 28, 44, 31, 29, 35, 32, 37, 33, 27, 35, 40, 31, 30, 34, 32, 35, 30, 33, 27, 32, 32, 39, 30, 45, 34, 34, 28, 26]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.34567834303458367, "mean_inference_ms": 0.7339626583400556, "mean_action_processing_ms": 0.07619582971334053, "mean_env_wait_ms": 7.044652611956427, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006714517419988459, "StateBufferConnector_ms": 0.0037553093650124288, "ViewRequirementAgentConnector_ms": 0.08555325594815341}, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 308000, "num_agent_steps_trained": 308000, "num_env_steps_sampled": 308000, "num_env_steps_trained": 308000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 429.3714108555478, "num_env_steps_trained_throughput_per_sec": 429.3714108555478, "timesteps_total": 308000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 308000, "timers": {"training_iteration_time_ms": 9573.697, "sample_time_ms": 5903.557, "load_time_ms": 1.042, "load_throughput": 3839179.863, "learn_time_ms": 3666.353, "learn_throughput": 1091.003, "synch_weights_time_ms": 2.092}, "counters": {"num_env_steps_sampled": 308000, "num_env_steps_trained": 308000, "num_agent_steps_sampled": 308000, "num_agent_steps_trained": 308000}, "done": false, "episodes_total": 6004, "training_iteration": 77, "trial_id": "ddfb6_00000", "date": "2024-03-07_13-00-30", "timestamp": 1709834430, "time_this_iter_s": 9.318637371063232, "time_total_s": 730.6028304100037, "pid": 112355, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4d85689f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 730.6028304100037, "iterations_since_restore": 77, "perf": {"cpu_util_percent": 26.766666666666666, "ram_util_percent": 48.025, "gpu_util_percent0": 0.059166666666666666, "vram_util_percent0": 0.10719129774305557}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.12656249999999997, "cur_lr": 0.0010000000000000005, "total_loss": 0.19567820356328852, "policy_loss": -0.015543861825880344, "vf_loss": 0.21012968664628365, "vf_explained_var": 0.8498590813529107, "kl": 0.008631100388230067, "entropy": 0.4372124252460336, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 72075.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 312000, "num_env_steps_trained": 312000, "num_agent_steps_sampled": 312000, "num_agent_steps_trained": 312000}, "sampler_results": {"episode_reward_max": -1.600000000000001, "episode_reward_min": -77.40000000000056, "episode_reward_mean": -2.9324786324786376, "episode_len_mean": 36.957264957264954, "episode_media": {}, "episodes_this_iter": 117, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2.600000000000002, -2.2000000000000015, -2.3000000000000016, -2.3000000000000016, -2.2000000000000015, -1.700000000000001, -3.200000000000001, -2.0000000000000013, -2.0000000000000013, -2.0000000000000013, -2.1000000000000014, -3.200000000000001, -2.600000000000002, -1.8000000000000012, -2.3000000000000016, -2.3000000000000016, -2.1000000000000014, -1.9000000000000012, -2.3000000000000016, -2.0000000000000013, -1.9000000000000012, -2.2000000000000015, -2.5000000000000018, -2.5000000000000018, -1.9000000000000012, -2.5000000000000018, -1.9000000000000012, -2.800000000000002, -2.0000000000000013, -1.9000000000000012, -1.9000000000000012, -2.900000000000002, -2.3000000000000016, -2.600000000000002, -1.8000000000000012, -2.5000000000000018, -2.2000000000000015, -2.2000000000000015, -1.700000000000001, -2.1000000000000014, -1.9000000000000012, -2.4000000000000017, -2.2000000000000015, -2.0000000000000013, -1.8000000000000012, -2.4000000000000017, -2.1000000000000014, -1.8000000000000012, -1.8000000000000012, -2.3000000000000016, -2.0000000000000013, -1.600000000000001, -2.5000000000000018, -1.600000000000001, -1.600000000000001, -2.3000000000000016, -2.1000000000000014, -2.0000000000000013, -1.700000000000001, -2.2000000000000015, -2.1000000000000014, -77.40000000000056, -2.5000000000000018, -2.5000000000000018, -2.700000000000002, -2.600000000000002, -2.2000000000000015, -1.9000000000000012, -2.4000000000000017, -1.9000000000000012, -2.5000000000000018, -3.0000000000000018, -2.3000000000000016, -1.600000000000001, -2.1000000000000014, -1.8000000000000012, -2.2000000000000015, -2.0000000000000013, -2.1000000000000014, -2.600000000000002, -2.0000000000000013, -2.3000000000000016, -4.899999999999995, -1.8000000000000012, -2.3000000000000016, -2.3000000000000016, -2.4000000000000017, -1.9000000000000012, -3.9999999999999982, -2.3000000000000016, -1.8000000000000012, -2.1000000000000014, -2.4000000000000017, -2.1000000000000014, -6.999999999999993, -2.600000000000002, -3.200000000000001, -2.3000000000000016, -2.0000000000000013, -3.3000000000000007, -2.600000000000002, -1.700000000000001, -2.1000000000000014, -2.1000000000000014, -2.1000000000000014, -2.700000000000002, -2.800000000000002, -2.2000000000000015, -2.1000000000000014, -1.9000000000000012, -1.8000000000000012, -2.2000000000000015, -2.700000000000002, -1.8000000000000012, -2.900000000000002, -1.9000000000000012, -2.4000000000000017], "episode_lengths": [37, 33, 34, 34, 33, 28, 43, 31, 31, 31, 32, 43, 37, 29, 34, 34, 32, 30, 34, 31, 30, 33, 36, 36, 30, 36, 30, 39, 31, 30, 30, 40, 34, 37, 29, 36, 33, 33, 28, 32, 30, 35, 33, 31, 29, 35, 32, 29, 29, 34, 31, 27, 36, 27, 27, 34, 32, 31, 28, 33, 32, 400, 36, 36, 38, 37, 33, 30, 35, 30, 36, 41, 34, 27, 32, 29, 33, 31, 32, 37, 31, 34, 60, 29, 34, 34, 35, 30, 51, 34, 29, 32, 35, 32, 75, 37, 43, 34, 31, 41, 37, 28, 32, 32, 32, 38, 39, 33, 32, 30, 29, 33, 38, 29, 40, 30, 35]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3459529502088464, "mean_inference_ms": 0.733715082809461, "mean_action_processing_ms": 0.07620605607033375, "mean_env_wait_ms": 7.046630178988398, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006470924768692408, "StateBufferConnector_ms": 0.0038057310968382745, "ViewRequirementAgentConnector_ms": 0.08610558306050096}}, "episode_reward_max": -1.600000000000001, "episode_reward_min": -77.40000000000056, "episode_reward_mean": -2.9324786324786376, "episode_len_mean": 36.957264957264954, "episodes_this_iter": 117, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-2.600000000000002, -2.2000000000000015, -2.3000000000000016, -2.3000000000000016, -2.2000000000000015, -1.700000000000001, -3.200000000000001, -2.0000000000000013, -2.0000000000000013, -2.0000000000000013, -2.1000000000000014, -3.200000000000001, -2.600000000000002, -1.8000000000000012, -2.3000000000000016, -2.3000000000000016, -2.1000000000000014, -1.9000000000000012, -2.3000000000000016, -2.0000000000000013, -1.9000000000000012, -2.2000000000000015, -2.5000000000000018, -2.5000000000000018, -1.9000000000000012, -2.5000000000000018, -1.9000000000000012, -2.800000000000002, -2.0000000000000013, -1.9000000000000012, -1.9000000000000012, -2.900000000000002, -2.3000000000000016, -2.600000000000002, -1.8000000000000012, -2.5000000000000018, -2.2000000000000015, -2.2000000000000015, -1.700000000000001, -2.1000000000000014, -1.9000000000000012, -2.4000000000000017, -2.2000000000000015, -2.0000000000000013, -1.8000000000000012, -2.4000000000000017, -2.1000000000000014, -1.8000000000000012, -1.8000000000000012, -2.3000000000000016, -2.0000000000000013, -1.600000000000001, -2.5000000000000018, -1.600000000000001, -1.600000000000001, -2.3000000000000016, -2.1000000000000014, -2.0000000000000013, -1.700000000000001, -2.2000000000000015, -2.1000000000000014, -77.40000000000056, -2.5000000000000018, -2.5000000000000018, -2.700000000000002, -2.600000000000002, -2.2000000000000015, -1.9000000000000012, -2.4000000000000017, -1.9000000000000012, -2.5000000000000018, -3.0000000000000018, -2.3000000000000016, -1.600000000000001, -2.1000000000000014, -1.8000000000000012, -2.2000000000000015, -2.0000000000000013, -2.1000000000000014, -2.600000000000002, -2.0000000000000013, -2.3000000000000016, -4.899999999999995, -1.8000000000000012, -2.3000000000000016, -2.3000000000000016, -2.4000000000000017, -1.9000000000000012, -3.9999999999999982, -2.3000000000000016, -1.8000000000000012, -2.1000000000000014, -2.4000000000000017, -2.1000000000000014, -6.999999999999993, -2.600000000000002, -3.200000000000001, -2.3000000000000016, -2.0000000000000013, -3.3000000000000007, -2.600000000000002, -1.700000000000001, -2.1000000000000014, -2.1000000000000014, -2.1000000000000014, -2.700000000000002, -2.800000000000002, -2.2000000000000015, -2.1000000000000014, -1.9000000000000012, -1.8000000000000012, -2.2000000000000015, -2.700000000000002, -1.8000000000000012, -2.900000000000002, -1.9000000000000012, -2.4000000000000017], "episode_lengths": [37, 33, 34, 34, 33, 28, 43, 31, 31, 31, 32, 43, 37, 29, 34, 34, 32, 30, 34, 31, 30, 33, 36, 36, 30, 36, 30, 39, 31, 30, 30, 40, 34, 37, 29, 36, 33, 33, 28, 32, 30, 35, 33, 31, 29, 35, 32, 29, 29, 34, 31, 27, 36, 27, 27, 34, 32, 31, 28, 33, 32, 400, 36, 36, 38, 37, 33, 30, 35, 30, 36, 41, 34, 27, 32, 29, 33, 31, 32, 37, 31, 34, 60, 29, 34, 34, 35, 30, 51, 34, 29, 32, 35, 32, 75, 37, 43, 34, 31, 41, 37, 28, 32, 32, 32, 38, 39, 33, 32, 30, 29, 33, 38, 29, 40, 30, 35]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3459529502088464, "mean_inference_ms": 0.733715082809461, "mean_action_processing_ms": 0.07620605607033375, "mean_env_wait_ms": 7.046630178988398, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006470924768692408, "StateBufferConnector_ms": 0.0038057310968382745, "ViewRequirementAgentConnector_ms": 0.08610558306050096}, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 312000, "num_agent_steps_trained": 312000, "num_env_steps_sampled": 312000, "num_env_steps_trained": 312000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 428.58716477542697, "num_env_steps_trained_throughput_per_sec": 428.58716477542697, "timesteps_total": 312000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 312000, "timers": {"training_iteration_time_ms": 9475.33, "sample_time_ms": 5874.448, "load_time_ms": 1.038, "load_throughput": 3852845.562, "learn_time_ms": 3597.069, "learn_throughput": 1112.017, "synch_weights_time_ms": 2.132}, "counters": {"num_env_steps_sampled": 312000, "num_env_steps_trained": 312000, "num_agent_steps_sampled": 312000, "num_agent_steps_trained": 312000}, "done": false, "episodes_total": 6121, "training_iteration": 78, "trial_id": "ddfb6_00000", "date": "2024-03-07_13-00-40", "timestamp": 1709834440, "time_this_iter_s": 9.335712194442749, "time_total_s": 739.9385426044464, "pid": 112355, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4d85689f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 739.9385426044464, "iterations_since_restore": 78, "perf": {"cpu_util_percent": 26.675000000000008, "ram_util_percent": 48.050000000000004, "gpu_util_percent0": 0.06333333333333334, "vram_util_percent0": 0.10719129774305554}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.12656249999999997, "cur_lr": 0.0010000000000000005, "total_loss": 0.36762108285961453, "policy_loss": -0.009413332912710405, "vf_loss": 0.3755303173330963, "vf_explained_var": 0.8239415330271567, "kl": 0.011884190788771296, "entropy": 0.39959112843198163, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 73005.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 316000, "num_env_steps_trained": 316000, "num_agent_steps_sampled": 316000, "num_agent_steps_trained": 316000}, "sampler_results": {"episode_reward_max": -1.5000000000000009, "episode_reward_min": -12.599999999999975, "episode_reward_mean": -2.2893805309734523, "episode_len_mean": 33.39823008849557, "episode_media": {}, "episodes_this_iter": 113, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1.8000000000000012, -2.3000000000000016, -2.2000000000000015, -1.9000000000000012, -2.600000000000002, -1.700000000000001, -2.2000000000000015, -2.0000000000000013, -1.9000000000000012, -1.8000000000000012, -1.9000000000000012, -1.9000000000000012, -2.2000000000000015, -2.1000000000000014, -2.5000000000000018, -2.5000000000000018, -2.1000000000000014, -2.0000000000000013, -2.0000000000000013, -2.1000000000000014, -2.600000000000002, -2.0000000000000013, -3.4000000000000004, -2.1000000000000014, -2.600000000000002, -3.0000000000000018, -2.1000000000000014, -2.1000000000000014, -3.200000000000001, -2.3000000000000016, -2.0000000000000013, -2.1000000000000014, -1.8000000000000012, -2.2000000000000015, -2.600000000000002, -1.600000000000001, -1.700000000000001, -1.9000000000000012, -2.3000000000000016, -2.0000000000000013, -2.0000000000000013, -2.0000000000000013, -2.900000000000002, -2.4000000000000017, -2.600000000000002, -1.700000000000001, -1.9000000000000012, -2.2000000000000015, -2.0000000000000013, -2.3000000000000016, -2.3000000000000016, -3.4000000000000004, -2.5000000000000018, -2.5000000000000018, -2.0000000000000013, -1.600000000000001, -1.600000000000001, -3.5, -2.0000000000000013, -1.8000000000000012, -1.700000000000001, -2.4000000000000017, -1.700000000000001, -2.2000000000000015, -2.2000000000000015, -3.3000000000000007, -1.5000000000000009, -12.599999999999975, -3.799999999999999, -1.600000000000001, -2.600000000000002, -2.700000000000002, -2.1000000000000014, -1.8000000000000012, -1.8000000000000012, -3.0000000000000018, -2.4000000000000017, -2.3000000000000016, -2.1000000000000014, -2.2000000000000015, -2.5000000000000018, -2.2000000000000015, -2.0000000000000013, -2.2000000000000015, -1.700000000000001, -1.700000000000001, -1.700000000000001, -1.600000000000001, -3.200000000000001, -2.1000000000000014, -2.0000000000000013, -1.9000000000000012, -2.1000000000000014, -2.1000000000000014, -3.0000000000000018, -2.0000000000000013, -2.1000000000000014, -2.700000000000002, -1.9000000000000012, -1.700000000000001, -2.4000000000000017, -2.0000000000000013, -1.600000000000001, -2.1000000000000014, -1.9000000000000012, -2.0000000000000013, -2.2000000000000015, -2.600000000000002, -3.3000000000000025, -2.3000000000000016, -1.700000000000001, -1.5000000000000009, -2.2000000000000015], "episode_lengths": [29, 34, 33, 30, 34, 28, 33, 31, 30, 29, 30, 30, 33, 32, 36, 36, 32, 31, 31, 32, 37, 31, 45, 32, 37, 41, 32, 32, 43, 34, 31, 32, 29, 33, 37, 27, 28, 30, 34, 31, 31, 31, 40, 35, 37, 28, 30, 33, 31, 34, 32, 45, 36, 36, 31, 27, 27, 45, 31, 29, 28, 33, 28, 33, 33, 41, 26, 101, 45, 27, 37, 38, 32, 29, 29, 41, 35, 34, 32, 33, 36, 33, 31, 33, 28, 28, 28, 27, 43, 32, 31, 30, 32, 32, 41, 31, 32, 38, 30, 28, 35, 31, 27, 32, 30, 31, 33, 37, 39, 34, 28, 26, 33]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.34616844728436386, "mean_inference_ms": 0.7331944804059445, "mean_action_processing_ms": 0.07609262157605319, "mean_env_wait_ms": 7.045351127626269, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006785645949102081, "StateBufferConnector_ms": 0.0038632249410173536, "ViewRequirementAgentConnector_ms": 0.08791294773068048}}, "episode_reward_max": -1.5000000000000009, "episode_reward_min": -12.599999999999975, "episode_reward_mean": -2.2893805309734523, "episode_len_mean": 33.39823008849557, "episodes_this_iter": 113, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1.8000000000000012, -2.3000000000000016, -2.2000000000000015, -1.9000000000000012, -2.600000000000002, -1.700000000000001, -2.2000000000000015, -2.0000000000000013, -1.9000000000000012, -1.8000000000000012, -1.9000000000000012, -1.9000000000000012, -2.2000000000000015, -2.1000000000000014, -2.5000000000000018, -2.5000000000000018, -2.1000000000000014, -2.0000000000000013, -2.0000000000000013, -2.1000000000000014, -2.600000000000002, -2.0000000000000013, -3.4000000000000004, -2.1000000000000014, -2.600000000000002, -3.0000000000000018, -2.1000000000000014, -2.1000000000000014, -3.200000000000001, -2.3000000000000016, -2.0000000000000013, -2.1000000000000014, -1.8000000000000012, -2.2000000000000015, -2.600000000000002, -1.600000000000001, -1.700000000000001, -1.9000000000000012, -2.3000000000000016, -2.0000000000000013, -2.0000000000000013, -2.0000000000000013, -2.900000000000002, -2.4000000000000017, -2.600000000000002, -1.700000000000001, -1.9000000000000012, -2.2000000000000015, -2.0000000000000013, -2.3000000000000016, -2.3000000000000016, -3.4000000000000004, -2.5000000000000018, -2.5000000000000018, -2.0000000000000013, -1.600000000000001, -1.600000000000001, -3.5, -2.0000000000000013, -1.8000000000000012, -1.700000000000001, -2.4000000000000017, -1.700000000000001, -2.2000000000000015, -2.2000000000000015, -3.3000000000000007, -1.5000000000000009, -12.599999999999975, -3.799999999999999, -1.600000000000001, -2.600000000000002, -2.700000000000002, -2.1000000000000014, -1.8000000000000012, -1.8000000000000012, -3.0000000000000018, -2.4000000000000017, -2.3000000000000016, -2.1000000000000014, -2.2000000000000015, -2.5000000000000018, -2.2000000000000015, -2.0000000000000013, -2.2000000000000015, -1.700000000000001, -1.700000000000001, -1.700000000000001, -1.600000000000001, -3.200000000000001, -2.1000000000000014, -2.0000000000000013, -1.9000000000000012, -2.1000000000000014, -2.1000000000000014, -3.0000000000000018, -2.0000000000000013, -2.1000000000000014, -2.700000000000002, -1.9000000000000012, -1.700000000000001, -2.4000000000000017, -2.0000000000000013, -1.600000000000001, -2.1000000000000014, -1.9000000000000012, -2.0000000000000013, -2.2000000000000015, -2.600000000000002, -3.3000000000000025, -2.3000000000000016, -1.700000000000001, -1.5000000000000009, -2.2000000000000015], "episode_lengths": [29, 34, 33, 30, 34, 28, 33, 31, 30, 29, 30, 30, 33, 32, 36, 36, 32, 31, 31, 32, 37, 31, 45, 32, 37, 41, 32, 32, 43, 34, 31, 32, 29, 33, 37, 27, 28, 30, 34, 31, 31, 31, 40, 35, 37, 28, 30, 33, 31, 34, 32, 45, 36, 36, 31, 27, 27, 45, 31, 29, 28, 33, 28, 33, 33, 41, 26, 101, 45, 27, 37, 38, 32, 29, 29, 41, 35, 34, 32, 33, 36, 33, 31, 33, 28, 28, 28, 27, 43, 32, 31, 30, 32, 32, 41, 31, 32, 38, 30, 28, 35, 31, 27, 32, 30, 31, 33, 37, 39, 34, 28, 26, 33]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.34616844728436386, "mean_inference_ms": 0.7331944804059445, "mean_action_processing_ms": 0.07609262157605319, "mean_env_wait_ms": 7.045351127626269, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006785645949102081, "StateBufferConnector_ms": 0.0038632249410173536, "ViewRequirementAgentConnector_ms": 0.08791294773068048}, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 316000, "num_agent_steps_trained": 316000, "num_env_steps_sampled": 316000, "num_env_steps_trained": 316000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 427.0123566780124, "num_env_steps_trained_throughput_per_sec": 427.0123566780124, "timesteps_total": 316000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 316000, "timers": {"training_iteration_time_ms": 9413.069, "sample_time_ms": 5831.101, "load_time_ms": 1.006, "load_throughput": 3975926.251, "learn_time_ms": 3578.182, "learn_throughput": 1117.886, "synch_weights_time_ms": 2.135}, "counters": {"num_env_steps_sampled": 316000, "num_env_steps_trained": 316000, "num_agent_steps_sampled": 316000, "num_agent_steps_trained": 316000}, "done": false, "episodes_total": 6234, "training_iteration": 79, "trial_id": "ddfb6_00000", "date": "2024-03-07_13-00-49", "timestamp": 1709834449, "time_this_iter_s": 9.370126247406006, "time_total_s": 749.3086688518524, "pid": 112355, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4d85689f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 749.3086688518524, "iterations_since_restore": 79, "perf": {"cpu_util_percent": 26.584615384615386, "ram_util_percent": 48.02307692307692, "gpu_util_percent0": 0.08384615384615385, "vram_util_percent0": 0.10719025440705127}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.12656249999999997, "cur_lr": 0.0010000000000000005, "total_loss": 0.5429602871534742, "policy_loss": -0.007895379755095208, "vf_loss": 0.5500564709506047, "vf_explained_var": 0.8178501081082129, "kl": 0.006314676624587417, "entropy": 0.3902055609771, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 73935.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 320000, "num_env_steps_trained": 320000, "num_agent_steps_sampled": 320000, "num_agent_steps_trained": 320000}, "sampler_results": {"episode_reward_max": -1.5000000000000009, "episode_reward_min": -76.10000000000055, "episode_reward_mean": -2.820535714285721, "episode_len_mean": 35.598214285714285, "episode_media": {}, "episodes_this_iter": 112, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1.600000000000001, -2.1000000000000014, -2.600000000000002, -2.5000000000000018, -1.700000000000001, -2.2000000000000015, -1.5000000000000009, -2.3000000000000016, -2.4000000000000017, -1.600000000000001, -2.0000000000000013, -1.600000000000001, -1.9000000000000012, -2.2000000000000015, -1.8000000000000012, -2.3000000000000016, -6.5999999999999925, -2.0000000000000013, -1.600000000000001, -2.5000000000000018, -2.2000000000000015, -2.2000000000000015, -2.1000000000000014, -2.0000000000000013, -2.0000000000000013, -2.0000000000000013, -1.700000000000001, -2.600000000000002, -2.0000000000000013, -2.5000000000000018, -1.700000000000001, -1.9000000000000012, -2.4000000000000017, -2.4000000000000017, -2.600000000000002, -1.600000000000001, -1.9000000000000012, -2.1000000000000014, -1.9000000000000012, -1.8000000000000012, -2.2000000000000015, -76.10000000000055, -3.3000000000000007, -1.700000000000001, -2.3000000000000016, -1.8000000000000012, -2.1000000000000014, -1.700000000000001, -2.1000000000000014, -1.8000000000000012, -4.200000000000003, -2.0000000000000013, -1.8000000000000012, -1.8000000000000012, -2.0000000000000013, -1.8000000000000012, -1.8000000000000012, -2.1000000000000014, -2.3000000000000016, -1.700000000000001, -1.9000000000000012, -1.600000000000001, -2.2000000000000015, -2.1000000000000014, -2.600000000000002, -2.0000000000000013, -2.3000000000000016, -3.1000000000000014, -1.9000000000000012, -1.9000000000000012, -1.700000000000001, -2.2000000000000015, -2.700000000000002, -2.2000000000000015, -2.3000000000000016, -2.700000000000002, -1.8000000000000012, -2.0000000000000013, -3.5999999999999996, -2.700000000000002, -1.9000000000000012, -1.8000000000000012, -2.2000000000000015, -3.200000000000001, -2.2000000000000015, -2.0000000000000013, -2.3000000000000016, -1.9000000000000012, -1.700000000000001, -2.2000000000000015, -2.0000000000000013, -3.200000000000001, -1.9000000000000012, -1.600000000000001, -2.1000000000000014, -1.9000000000000012, -1.9000000000000012, -2.0000000000000013, -2.1000000000000014, -1.700000000000001, -2.2000000000000015, -1.9000000000000012, -2.0000000000000013, -1.5000000000000009, -1.8000000000000012, -2.4000000000000017, -3.1000000000000014, -2.3000000000000016, -2.2000000000000015, -2.3000000000000016, -1.8000000000000012, -1.9000000000000012], "episode_lengths": [27, 32, 37, 36, 28, 33, 26, 34, 35, 27, 31, 27, 30, 33, 29, 34, 64, 31, 27, 36, 33, 33, 32, 31, 31, 31, 28, 37, 31, 36, 28, 30, 35, 35, 37, 27, 30, 32, 30, 29, 33, 400, 44, 28, 34, 29, 32, 28, 32, 29, 45, 31, 29, 29, 31, 29, 29, 32, 34, 28, 30, 27, 33, 32, 37, 31, 34, 40, 30, 30, 28, 33, 38, 33, 34, 38, 29, 31, 43, 38, 30, 29, 33, 42, 33, 31, 34, 30, 28, 33, 31, 40, 30, 27, 32, 30, 30, 31, 32, 28, 33, 30, 31, 26, 29, 35, 41, 34, 33, 34, 29, 30]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3465396839475055, "mean_inference_ms": 0.7328355910524129, "mean_action_processing_ms": 0.07605058546462744, "mean_env_wait_ms": 7.048342210949442, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0066065362521580285, "StateBufferConnector_ms": 0.0038255538259233746, "ViewRequirementAgentConnector_ms": 0.0856480428150722}}, "episode_reward_max": -1.5000000000000009, "episode_reward_min": -76.10000000000055, "episode_reward_mean": -2.820535714285721, "episode_len_mean": 35.598214285714285, "episodes_this_iter": 112, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1.600000000000001, -2.1000000000000014, -2.600000000000002, -2.5000000000000018, -1.700000000000001, -2.2000000000000015, -1.5000000000000009, -2.3000000000000016, -2.4000000000000017, -1.600000000000001, -2.0000000000000013, -1.600000000000001, -1.9000000000000012, -2.2000000000000015, -1.8000000000000012, -2.3000000000000016, -6.5999999999999925, -2.0000000000000013, -1.600000000000001, -2.5000000000000018, -2.2000000000000015, -2.2000000000000015, -2.1000000000000014, -2.0000000000000013, -2.0000000000000013, -2.0000000000000013, -1.700000000000001, -2.600000000000002, -2.0000000000000013, -2.5000000000000018, -1.700000000000001, -1.9000000000000012, -2.4000000000000017, -2.4000000000000017, -2.600000000000002, -1.600000000000001, -1.9000000000000012, -2.1000000000000014, -1.9000000000000012, -1.8000000000000012, -2.2000000000000015, -76.10000000000055, -3.3000000000000007, -1.700000000000001, -2.3000000000000016, -1.8000000000000012, -2.1000000000000014, -1.700000000000001, -2.1000000000000014, -1.8000000000000012, -4.200000000000003, -2.0000000000000013, -1.8000000000000012, -1.8000000000000012, -2.0000000000000013, -1.8000000000000012, -1.8000000000000012, -2.1000000000000014, -2.3000000000000016, -1.700000000000001, -1.9000000000000012, -1.600000000000001, -2.2000000000000015, -2.1000000000000014, -2.600000000000002, -2.0000000000000013, -2.3000000000000016, -3.1000000000000014, -1.9000000000000012, -1.9000000000000012, -1.700000000000001, -2.2000000000000015, -2.700000000000002, -2.2000000000000015, -2.3000000000000016, -2.700000000000002, -1.8000000000000012, -2.0000000000000013, -3.5999999999999996, -2.700000000000002, -1.9000000000000012, -1.8000000000000012, -2.2000000000000015, -3.200000000000001, -2.2000000000000015, -2.0000000000000013, -2.3000000000000016, -1.9000000000000012, -1.700000000000001, -2.2000000000000015, -2.0000000000000013, -3.200000000000001, -1.9000000000000012, -1.600000000000001, -2.1000000000000014, -1.9000000000000012, -1.9000000000000012, -2.0000000000000013, -2.1000000000000014, -1.700000000000001, -2.2000000000000015, -1.9000000000000012, -2.0000000000000013, -1.5000000000000009, -1.8000000000000012, -2.4000000000000017, -3.1000000000000014, -2.3000000000000016, -2.2000000000000015, -2.3000000000000016, -1.8000000000000012, -1.9000000000000012], "episode_lengths": [27, 32, 37, 36, 28, 33, 26, 34, 35, 27, 31, 27, 30, 33, 29, 34, 64, 31, 27, 36, 33, 33, 32, 31, 31, 31, 28, 37, 31, 36, 28, 30, 35, 35, 37, 27, 30, 32, 30, 29, 33, 400, 44, 28, 34, 29, 32, 28, 32, 29, 45, 31, 29, 29, 31, 29, 29, 32, 34, 28, 30, 27, 33, 32, 37, 31, 34, 40, 30, 30, 28, 33, 38, 33, 34, 38, 29, 31, 43, 38, 30, 29, 33, 42, 33, 31, 34, 30, 28, 33, 31, 40, 30, 27, 32, 30, 30, 31, 32, 28, 33, 30, 31, 26, 29, 35, 41, 34, 33, 34, 29, 30]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3465396839475055, "mean_inference_ms": 0.7328355910524129, "mean_action_processing_ms": 0.07605058546462744, "mean_env_wait_ms": 7.048342210949442, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0066065362521580285, "StateBufferConnector_ms": 0.0038255538259233746, "ViewRequirementAgentConnector_ms": 0.0856480428150722}, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 320000, "num_agent_steps_trained": 320000, "num_env_steps_sampled": 320000, "num_env_steps_trained": 320000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 432.4856273912458, "num_env_steps_trained_throughput_per_sec": 432.4856273912458, "timesteps_total": 320000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 320000, "timers": {"training_iteration_time_ms": 9364.887, "sample_time_ms": 5815.729, "load_time_ms": 1.006, "load_throughput": 3977434.39, "learn_time_ms": 3545.386, "learn_throughput": 1128.227, "synch_weights_time_ms": 2.123}, "counters": {"num_env_steps_sampled": 320000, "num_env_steps_trained": 320000, "num_agent_steps_sampled": 320000, "num_agent_steps_trained": 320000}, "done": false, "episodes_total": 6346, "training_iteration": 80, "trial_id": "ddfb6_00000", "date": "2024-03-07_13-00-58", "timestamp": 1709834458, "time_this_iter_s": 9.251811742782593, "time_total_s": 758.560480594635, "pid": 112355, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4d85689f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 758.560480594635, "iterations_since_restore": 80, "perf": {"cpu_util_percent": 26.88333333333333, "ram_util_percent": 48.0, "gpu_util_percent0": 0.07333333333333332, "vram_util_percent0": 0.10719129774305554}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.12656249999999997, "cur_lr": 0.0010000000000000005, "total_loss": 0.3861450179690315, "policy_loss": -0.0044788967056940965, "vf_loss": 0.39006669125069054, "vf_explained_var": 0.8553382134565743, "kl": 0.0044027730748881794, "entropy": 0.37764238362671226, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 74865.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 324000, "num_env_steps_trained": 324000, "num_agent_steps_sampled": 324000, "num_agent_steps_trained": 324000}, "sampler_results": {"episode_reward_max": -1.4000000000000008, "episode_reward_min": -75.40000000000053, "episode_reward_mean": -2.757851239669427, "episode_len_mean": 35.43801652892562, "episode_media": {}, "episodes_this_iter": 121, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2.1000000000000014, -1.8000000000000012, -2.0000000000000013, -1.8000000000000012, -1.8000000000000012, -1.8000000000000012, -1.700000000000001, -1.8000000000000012, -1.9000000000000012, -1.600000000000001, -1.8000000000000012, -2.3000000000000016, -2.5000000000000018, -2.0000000000000013, -1.700000000000001, -1.8000000000000012, -2.2000000000000015, -2.2000000000000015, -2.5000000000000018, -2.0000000000000013, -2.5000000000000018, -2.1000000000000014, -2.2000000000000015, -2.3000000000000016, -1.700000000000001, -2.2000000000000015, -2.1000000000000014, -1.700000000000001, -3.1000000000000014, -2.2000000000000015, -2.2000000000000015, -2.4000000000000017, -2.1000000000000014, -1.600000000000001, -2.2000000000000015, -1.9000000000000012, -2.0000000000000013, -2.0000000000000013, -2.0000000000000013, -2.0000000000000013, -2.0000000000000013, -5.0000000000000036, -75.40000000000053, -1.9000000000000012, -1.8000000000000012, -2.2000000000000015, -2.900000000000002, -2.3000000000000016, -2.600000000000002, -2.2000000000000015, -2.3000000000000016, -2.0000000000000013, -2.0000000000000013, -2.3000000000000016, -2.2000000000000015, -1.9000000000000012, -1.8000000000000012, -2.1000000000000014, -1.5000000000000009, -1.9000000000000012, -1.8000000000000012, -1.8000000000000012, -2.2000000000000015, -1.700000000000001, -2.900000000000002, -1.9000000000000012, -2.0000000000000013, -2.600000000000002, -2.4000000000000017, -1.9000000000000012, -2.0000000000000013, -2.700000000000002, -4.099999999999998, -2.0000000000000013, -1.9000000000000012, -2.1000000000000014, -2.0000000000000013, -2.1000000000000014, -1.9000000000000012, -1.9000000000000012, -1.9000000000000012, -3.200000000000001, -2.3000000000000016, -2.1000000000000014, -1.8000000000000012, -2.5000000000000018, -1.9000000000000012, -2.3000000000000016, -1.9000000000000012, -2.2000000000000015, -1.600000000000001, -2.4000000000000017, -2.1000000000000014, -2.2000000000000015, -1.4000000000000008, -2.700000000000002, -2.2000000000000015, -2.0000000000000013, -2.1000000000000014, -1.700000000000001, -1.8000000000000012, -1.8000000000000012, -3.5, -3.6999999999999993, -2.0000000000000013, -2.3000000000000016, -1.8000000000000012, -2.5000000000000018, -2.700000000000002, -1.700000000000001, -2.2000000000000015, -2.1000000000000014, -2.3000000000000016, -2.5000000000000018, -2.700000000000002, -2.0000000000000013, -2.1000000000000014, -2.0000000000000013, -1.700000000000001, -2.0000000000000013, -1.8000000000000012], "episode_lengths": [32, 29, 31, 29, 29, 29, 28, 29, 30, 27, 29, 34, 36, 31, 28, 29, 33, 33, 36, 31, 36, 32, 33, 34, 28, 33, 32, 28, 42, 33, 33, 35, 32, 27, 33, 30, 31, 31, 31, 31, 31, 48, 400, 30, 29, 33, 39, 34, 37, 33, 34, 31, 31, 34, 33, 30, 29, 32, 26, 30, 29, 29, 33, 28, 40, 30, 31, 37, 35, 30, 31, 38, 52, 31, 30, 32, 31, 32, 30, 30, 30, 43, 34, 32, 29, 36, 30, 34, 30, 33, 27, 35, 32, 33, 25, 38, 33, 31, 32, 28, 29, 29, 45, 48, 31, 34, 29, 36, 38, 28, 33, 32, 34, 36, 38, 31, 32, 31, 28, 31, 29]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.34758790447872845, "mean_inference_ms": 0.7325489431258122, "mean_action_processing_ms": 0.07607310216427568, "mean_env_wait_ms": 7.054084357200799, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006750398430942504, "StateBufferConnector_ms": 0.003832036798650568, "ViewRequirementAgentConnector_ms": 0.08704622914968443}}, "episode_reward_max": -1.4000000000000008, "episode_reward_min": -75.40000000000053, "episode_reward_mean": -2.757851239669427, "episode_len_mean": 35.43801652892562, "episodes_this_iter": 121, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-2.1000000000000014, -1.8000000000000012, -2.0000000000000013, -1.8000000000000012, -1.8000000000000012, -1.8000000000000012, -1.700000000000001, -1.8000000000000012, -1.9000000000000012, -1.600000000000001, -1.8000000000000012, -2.3000000000000016, -2.5000000000000018, -2.0000000000000013, -1.700000000000001, -1.8000000000000012, -2.2000000000000015, -2.2000000000000015, -2.5000000000000018, -2.0000000000000013, -2.5000000000000018, -2.1000000000000014, -2.2000000000000015, -2.3000000000000016, -1.700000000000001, -2.2000000000000015, -2.1000000000000014, -1.700000000000001, -3.1000000000000014, -2.2000000000000015, -2.2000000000000015, -2.4000000000000017, -2.1000000000000014, -1.600000000000001, -2.2000000000000015, -1.9000000000000012, -2.0000000000000013, -2.0000000000000013, -2.0000000000000013, -2.0000000000000013, -2.0000000000000013, -5.0000000000000036, -75.40000000000053, -1.9000000000000012, -1.8000000000000012, -2.2000000000000015, -2.900000000000002, -2.3000000000000016, -2.600000000000002, -2.2000000000000015, -2.3000000000000016, -2.0000000000000013, -2.0000000000000013, -2.3000000000000016, -2.2000000000000015, -1.9000000000000012, -1.8000000000000012, -2.1000000000000014, -1.5000000000000009, -1.9000000000000012, -1.8000000000000012, -1.8000000000000012, -2.2000000000000015, -1.700000000000001, -2.900000000000002, -1.9000000000000012, -2.0000000000000013, -2.600000000000002, -2.4000000000000017, -1.9000000000000012, -2.0000000000000013, -2.700000000000002, -4.099999999999998, -2.0000000000000013, -1.9000000000000012, -2.1000000000000014, -2.0000000000000013, -2.1000000000000014, -1.9000000000000012, -1.9000000000000012, -1.9000000000000012, -3.200000000000001, -2.3000000000000016, -2.1000000000000014, -1.8000000000000012, -2.5000000000000018, -1.9000000000000012, -2.3000000000000016, -1.9000000000000012, -2.2000000000000015, -1.600000000000001, -2.4000000000000017, -2.1000000000000014, -2.2000000000000015, -1.4000000000000008, -2.700000000000002, -2.2000000000000015, -2.0000000000000013, -2.1000000000000014, -1.700000000000001, -1.8000000000000012, -1.8000000000000012, -3.5, -3.6999999999999993, -2.0000000000000013, -2.3000000000000016, -1.8000000000000012, -2.5000000000000018, -2.700000000000002, -1.700000000000001, -2.2000000000000015, -2.1000000000000014, -2.3000000000000016, -2.5000000000000018, -2.700000000000002, -2.0000000000000013, -2.1000000000000014, -2.0000000000000013, -1.700000000000001, -2.0000000000000013, -1.8000000000000012], "episode_lengths": [32, 29, 31, 29, 29, 29, 28, 29, 30, 27, 29, 34, 36, 31, 28, 29, 33, 33, 36, 31, 36, 32, 33, 34, 28, 33, 32, 28, 42, 33, 33, 35, 32, 27, 33, 30, 31, 31, 31, 31, 31, 48, 400, 30, 29, 33, 39, 34, 37, 33, 34, 31, 31, 34, 33, 30, 29, 32, 26, 30, 29, 29, 33, 28, 40, 30, 31, 37, 35, 30, 31, 38, 52, 31, 30, 32, 31, 32, 30, 30, 30, 43, 34, 32, 29, 36, 30, 34, 30, 33, 27, 35, 32, 33, 25, 38, 33, 31, 32, 28, 29, 29, 45, 48, 31, 34, 29, 36, 38, 28, 33, 32, 34, 36, 38, 31, 32, 31, 28, 31, 29]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.34758790447872845, "mean_inference_ms": 0.7325489431258122, "mean_action_processing_ms": 0.07607310216427568, "mean_env_wait_ms": 7.054084357200799, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006750398430942504, "StateBufferConnector_ms": 0.003832036798650568, "ViewRequirementAgentConnector_ms": 0.08704622914968443}, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 324000, "num_agent_steps_trained": 324000, "num_env_steps_sampled": 324000, "num_env_steps_trained": 324000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 430.4532752923771, "num_env_steps_trained_throughput_per_sec": 430.4532752923771, "timesteps_total": 324000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 324000, "timers": {"training_iteration_time_ms": 9321.118, "sample_time_ms": 5798.51, "load_time_ms": 1.001, "load_throughput": 3995145.973, "learn_time_ms": 3518.828, "learn_throughput": 1136.742, "synch_weights_time_ms": 2.136}, "counters": {"num_env_steps_sampled": 324000, "num_env_steps_trained": 324000, "num_agent_steps_sampled": 324000, "num_agent_steps_trained": 324000}, "done": false, "episodes_total": 6467, "training_iteration": 81, "trial_id": "ddfb6_00000", "date": "2024-03-07_13-01-08", "timestamp": 1709834468, "time_this_iter_s": 9.295508861541748, "time_total_s": 767.8559894561768, "pid": 112355, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4d85689f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 767.8559894561768, "iterations_since_restore": 81, "perf": {"cpu_util_percent": 27.150000000000002, "ram_util_percent": 48.0, "gpu_util_percent0": 0.07083333333333335, "vram_util_percent0": 0.10681830512152778}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.06328124999999998, "cur_lr": 0.0010000000000000005, "total_loss": 0.5763532980715715, "policy_loss": -0.008104069787327962, "vf_loss": 0.5836753104327708, "vf_explained_var": 0.7568046557006015, "kl": 0.012358495494441239, "entropy": 0.3791621077685587, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 75795.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 328000, "num_env_steps_trained": 328000, "num_agent_steps_sampled": 328000, "num_agent_steps_trained": 328000}, "sampler_results": {"episode_reward_max": -1.5000000000000009, "episode_reward_min": -75.40000000000055, "episode_reward_mean": -2.7350877192982517, "episode_len_mean": 34.94736842105263, "episode_media": {}, "episodes_this_iter": 114, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1.700000000000001, -2.1000000000000014, -1.700000000000001, -1.700000000000001, -3.0000000000000018, -1.8000000000000012, -2.2000000000000015, -2.0000000000000013, -2.0000000000000013, -2.800000000000002, -2.1000000000000014, -2.600000000000002, -1.700000000000001, -1.8000000000000012, -3.6000000000000014, -1.8000000000000012, -2.1000000000000014, -2.5000000000000018, -2.0000000000000013, -1.9000000000000012, -1.8000000000000012, -1.9000000000000012, -1.8000000000000012, -2.2000000000000015, -2.1000000000000014, -2.1000000000000014, -2.600000000000002, -2.1000000000000014, -4.099999999999998, -1.700000000000001, -1.8000000000000012, -1.8000000000000012, -1.9000000000000012, -1.8000000000000012, -1.700000000000001, -1.700000000000001, -1.9000000000000012, -2.2000000000000015, -1.5000000000000009, -1.8000000000000012, -1.700000000000001, -2.4000000000000017, -2.5000000000000018, -1.9000000000000012, -1.8000000000000012, -2.3000000000000016, -2.0000000000000013, -2.3000000000000016, -2.1000000000000014, -2.1000000000000014, -1.9000000000000012, -1.8000000000000012, -2.0000000000000013, -2.0000000000000013, -1.9000000000000012, -2.4000000000000017, -2.1000000000000014, -1.9000000000000012, -1.700000000000001, -2.0000000000000013, -1.8000000000000012, -1.5000000000000009, -2.1000000000000014, -2.1000000000000014, -2.600000000000002, -5.099999999999994, -2.0000000000000013, -2.1000000000000014, -2.5000000000000018, -1.700000000000001, -3.5, -2.4000000000000017, -1.700000000000001, -1.5000000000000009, -2.3000000000000016, -3.5999999999999996, -1.9000000000000012, -2.2000000000000015, -2.900000000000002, -1.8000000000000012, -1.8000000000000012, -2.0000000000000013, -1.9000000000000012, -1.700000000000001, -75.40000000000055, -3.0000000000000018, -1.9000000000000012, -2.2000000000000015, -2.2000000000000015, -1.700000000000001, -3.0000000000000018, -1.700000000000001, -1.600000000000001, -1.600000000000001, -2.2000000000000015, -1.5000000000000009, -1.8000000000000012, -1.600000000000001, -2.2000000000000015, -2.1000000000000014, -1.9000000000000012, -1.9000000000000012, -2.0000000000000013, -1.8000000000000012, -2.0000000000000013, -2.0000000000000013, -1.9000000000000012, -1.9000000000000012, -2.0000000000000013, -1.5000000000000009, -2.1000000000000014, -1.700000000000001, -2.2000000000000015, -2.1000000000000014], "episode_lengths": [28, 32, 28, 28, 41, 29, 33, 31, 31, 39, 32, 37, 28, 29, 41, 29, 32, 36, 31, 30, 29, 30, 29, 33, 32, 32, 37, 32, 51, 28, 29, 29, 30, 29, 28, 28, 30, 33, 26, 29, 28, 35, 36, 30, 29, 34, 31, 34, 32, 32, 30, 29, 31, 31, 30, 35, 32, 30, 28, 31, 29, 26, 32, 32, 37, 58, 31, 32, 36, 28, 46, 35, 28, 26, 34, 41, 30, 33, 40, 29, 29, 31, 30, 28, 396, 41, 30, 33, 33, 28, 39, 28, 27, 27, 33, 26, 29, 27, 33, 32, 30, 30, 31, 29, 31, 31, 30, 30, 31, 26, 32, 28, 33, 32]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.34807532102187183, "mean_inference_ms": 0.732544246297891, "mean_action_processing_ms": 0.076107100880405, "mean_env_wait_ms": 7.064982978888133, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006404885074548554, "StateBufferConnector_ms": 0.0037523738124914338, "ViewRequirementAgentConnector_ms": 0.08541889357985112}}, "episode_reward_max": -1.5000000000000009, "episode_reward_min": -75.40000000000055, "episode_reward_mean": -2.7350877192982517, "episode_len_mean": 34.94736842105263, "episodes_this_iter": 114, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1.700000000000001, -2.1000000000000014, -1.700000000000001, -1.700000000000001, -3.0000000000000018, -1.8000000000000012, -2.2000000000000015, -2.0000000000000013, -2.0000000000000013, -2.800000000000002, -2.1000000000000014, -2.600000000000002, -1.700000000000001, -1.8000000000000012, -3.6000000000000014, -1.8000000000000012, -2.1000000000000014, -2.5000000000000018, -2.0000000000000013, -1.9000000000000012, -1.8000000000000012, -1.9000000000000012, -1.8000000000000012, -2.2000000000000015, -2.1000000000000014, -2.1000000000000014, -2.600000000000002, -2.1000000000000014, -4.099999999999998, -1.700000000000001, -1.8000000000000012, -1.8000000000000012, -1.9000000000000012, -1.8000000000000012, -1.700000000000001, -1.700000000000001, -1.9000000000000012, -2.2000000000000015, -1.5000000000000009, -1.8000000000000012, -1.700000000000001, -2.4000000000000017, -2.5000000000000018, -1.9000000000000012, -1.8000000000000012, -2.3000000000000016, -2.0000000000000013, -2.3000000000000016, -2.1000000000000014, -2.1000000000000014, -1.9000000000000012, -1.8000000000000012, -2.0000000000000013, -2.0000000000000013, -1.9000000000000012, -2.4000000000000017, -2.1000000000000014, -1.9000000000000012, -1.700000000000001, -2.0000000000000013, -1.8000000000000012, -1.5000000000000009, -2.1000000000000014, -2.1000000000000014, -2.600000000000002, -5.099999999999994, -2.0000000000000013, -2.1000000000000014, -2.5000000000000018, -1.700000000000001, -3.5, -2.4000000000000017, -1.700000000000001, -1.5000000000000009, -2.3000000000000016, -3.5999999999999996, -1.9000000000000012, -2.2000000000000015, -2.900000000000002, -1.8000000000000012, -1.8000000000000012, -2.0000000000000013, -1.9000000000000012, -1.700000000000001, -75.40000000000055, -3.0000000000000018, -1.9000000000000012, -2.2000000000000015, -2.2000000000000015, -1.700000000000001, -3.0000000000000018, -1.700000000000001, -1.600000000000001, -1.600000000000001, -2.2000000000000015, -1.5000000000000009, -1.8000000000000012, -1.600000000000001, -2.2000000000000015, -2.1000000000000014, -1.9000000000000012, -1.9000000000000012, -2.0000000000000013, -1.8000000000000012, -2.0000000000000013, -2.0000000000000013, -1.9000000000000012, -1.9000000000000012, -2.0000000000000013, -1.5000000000000009, -2.1000000000000014, -1.700000000000001, -2.2000000000000015, -2.1000000000000014], "episode_lengths": [28, 32, 28, 28, 41, 29, 33, 31, 31, 39, 32, 37, 28, 29, 41, 29, 32, 36, 31, 30, 29, 30, 29, 33, 32, 32, 37, 32, 51, 28, 29, 29, 30, 29, 28, 28, 30, 33, 26, 29, 28, 35, 36, 30, 29, 34, 31, 34, 32, 32, 30, 29, 31, 31, 30, 35, 32, 30, 28, 31, 29, 26, 32, 32, 37, 58, 31, 32, 36, 28, 46, 35, 28, 26, 34, 41, 30, 33, 40, 29, 29, 31, 30, 28, 396, 41, 30, 33, 33, 28, 39, 28, 27, 27, 33, 26, 29, 27, 33, 32, 30, 30, 31, 29, 31, 31, 30, 30, 31, 26, 32, 28, 33, 32]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.34807532102187183, "mean_inference_ms": 0.732544246297891, "mean_action_processing_ms": 0.076107100880405, "mean_env_wait_ms": 7.064982978888133, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006404885074548554, "StateBufferConnector_ms": 0.0037523738124914338, "ViewRequirementAgentConnector_ms": 0.08541889357985112}, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 328000, "num_agent_steps_trained": 328000, "num_env_steps_sampled": 328000, "num_env_steps_trained": 328000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 424.33080552413577, "num_env_steps_trained_throughput_per_sec": 424.33080552413577, "timesteps_total": 328000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 328000, "timers": {"training_iteration_time_ms": 9328.746, "sample_time_ms": 5795.764, "load_time_ms": 1.005, "load_throughput": 3978943.674, "learn_time_ms": 3529.199, "learn_throughput": 1133.402, "synch_weights_time_ms": 2.132}, "counters": {"num_env_steps_sampled": 328000, "num_env_steps_trained": 328000, "num_agent_steps_sampled": 328000, "num_agent_steps_trained": 328000}, "done": false, "episodes_total": 6581, "training_iteration": 82, "trial_id": "ddfb6_00000", "date": "2024-03-07_13-01-17", "timestamp": 1709834477, "time_this_iter_s": 9.429352283477783, "time_total_s": 777.2853417396545, "pid": 112355, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4d85689f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 777.2853417396545, "iterations_since_restore": 82, "perf": {"cpu_util_percent": 27.224999999999998, "ram_util_percent": 47.96666666666666, "gpu_util_percent0": 0.0575, "vram_util_percent0": 0.10670301649305554}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.06328124999999998, "cur_lr": 0.0010000000000000005, "total_loss": 0.19615676651029065, "policy_loss": -0.007832951929860858, "vf_loss": 0.20264636920364473, "vf_explained_var": 0.8870588337221453, "kl": 0.021228214321588407, "entropy": 0.37773575936594317, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 76725.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 332000, "num_env_steps_trained": 332000, "num_agent_steps_sampled": 332000, "num_agent_steps_trained": 332000}, "sampler_results": {"episode_reward_max": -1.5000000000000009, "episode_reward_min": -6.000000000000004, "episode_reward_mean": -2.1182539682539696, "episode_len_mean": 31.833333333333332, "episode_media": {}, "episodes_this_iter": 126, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2.4000000000000017, -1.9000000000000012, -2.3000000000000016, -1.8000000000000012, -1.700000000000001, -1.9000000000000012, -1.8000000000000012, -2.0000000000000013, -2.0000000000000013, -1.8000000000000012, -2.5000000000000018, -1.700000000000001, -1.700000000000001, -1.8000000000000012, -2.0000000000000013, -2.700000000000002, -1.8000000000000012, -2.4000000000000017, -2.0000000000000013, -2.1000000000000014, -2.2000000000000015, -2.3000000000000016, -1.8000000000000012, -2.1000000000000014, -1.8000000000000012, -2.2000000000000015, -2.0000000000000013, -1.9000000000000012, -6.000000000000004, -2.700000000000002, -1.9000000000000012, -3.4000000000000004, -1.700000000000001, -2.2000000000000015, -2.3000000000000016, -2.0000000000000013, -2.1000000000000014, -2.4000000000000017, -2.0000000000000013, -2.0000000000000013, -2.1000000000000014, -2.5000000000000018, -1.8000000000000012, -1.700000000000001, -1.8000000000000012, -2.0000000000000013, -1.700000000000001, -3.0000000000000018, -2.4000000000000017, -1.600000000000001, -2.2000000000000015, -1.8000000000000012, -2.0000000000000013, -2.2000000000000015, -1.700000000000001, -2.3000000000000016, -1.600000000000001, -1.700000000000001, -1.5000000000000009, -2.700000000000002, -2.3000000000000016, -1.700000000000001, -1.700000000000001, -1.700000000000001, -2.1000000000000014, -2.600000000000002, -1.600000000000001, -1.8000000000000012, -1.9000000000000012, -2.3000000000000016, -2.2000000000000015, -2.0000000000000013, -1.9000000000000012, -2.2000000000000015, -2.1000000000000014, -2.0000000000000013, -1.8000000000000012, -2.5000000000000018, -3.200000000000001, -1.700000000000001, -2.2000000000000015, -1.600000000000001, -2.0000000000000013, -2.4000000000000017, -2.3000000000000016, -2.900000000000002, -1.700000000000001, -2.1000000000000014, -5.700000000000003, -1.600000000000001, -2.4000000000000017, -1.8000000000000012, -2.4000000000000017, -1.5000000000000009, -2.1000000000000014, -2.5000000000000018, -2.0000000000000013, -2.5000000000000018, -2.0000000000000013, -1.9000000000000012, -2.2000000000000015, -2.0000000000000013, -2.0000000000000013, -1.9000000000000012, -1.8000000000000012, -1.8000000000000012, -2.900000000000002, -1.5000000000000009, -2.4000000000000017, -2.2000000000000015, -2.1000000000000014, -2.700000000000002, -1.9000000000000012, -2.3000000000000016, -1.8000000000000012, -1.700000000000001, -1.700000000000001, -2.0000000000000013, -2.2000000000000015, -1.9000000000000012, -1.700000000000001, -2.0000000000000013, -2.1000000000000014, -1.9000000000000012, -1.8000000000000012, -1.9000000000000012], "episode_lengths": [35, 30, 34, 29, 28, 30, 29, 31, 31, 29, 36, 28, 28, 29, 31, 38, 29, 35, 31, 32, 33, 34, 29, 32, 29, 33, 31, 30, 55, 38, 30, 45, 28, 33, 34, 31, 32, 35, 31, 31, 32, 33, 29, 28, 29, 31, 28, 39, 35, 27, 33, 29, 31, 33, 28, 34, 27, 28, 26, 38, 34, 28, 28, 28, 32, 37, 27, 29, 30, 34, 33, 31, 30, 33, 32, 31, 29, 36, 43, 28, 33, 27, 31, 35, 34, 38, 28, 32, 53, 27, 35, 29, 35, 26, 32, 36, 31, 36, 31, 30, 33, 31, 31, 30, 29, 29, 34, 26, 35, 33, 32, 38, 30, 34, 29, 28, 28, 31, 33, 30, 28, 31, 32, 30, 29, 30]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3489750674580455, "mean_inference_ms": 0.7319211864343989, "mean_action_processing_ms": 0.07604536179162606, "mean_env_wait_ms": 7.064618328215875, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006630874815441314, "StateBufferConnector_ms": 0.0038188601297045512, "ViewRequirementAgentConnector_ms": 0.086480284494067}}, "episode_reward_max": -1.5000000000000009, "episode_reward_min": -6.000000000000004, "episode_reward_mean": -2.1182539682539696, "episode_len_mean": 31.833333333333332, "episodes_this_iter": 126, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-2.4000000000000017, -1.9000000000000012, -2.3000000000000016, -1.8000000000000012, -1.700000000000001, -1.9000000000000012, -1.8000000000000012, -2.0000000000000013, -2.0000000000000013, -1.8000000000000012, -2.5000000000000018, -1.700000000000001, -1.700000000000001, -1.8000000000000012, -2.0000000000000013, -2.700000000000002, -1.8000000000000012, -2.4000000000000017, -2.0000000000000013, -2.1000000000000014, -2.2000000000000015, -2.3000000000000016, -1.8000000000000012, -2.1000000000000014, -1.8000000000000012, -2.2000000000000015, -2.0000000000000013, -1.9000000000000012, -6.000000000000004, -2.700000000000002, -1.9000000000000012, -3.4000000000000004, -1.700000000000001, -2.2000000000000015, -2.3000000000000016, -2.0000000000000013, -2.1000000000000014, -2.4000000000000017, -2.0000000000000013, -2.0000000000000013, -2.1000000000000014, -2.5000000000000018, -1.8000000000000012, -1.700000000000001, -1.8000000000000012, -2.0000000000000013, -1.700000000000001, -3.0000000000000018, -2.4000000000000017, -1.600000000000001, -2.2000000000000015, -1.8000000000000012, -2.0000000000000013, -2.2000000000000015, -1.700000000000001, -2.3000000000000016, -1.600000000000001, -1.700000000000001, -1.5000000000000009, -2.700000000000002, -2.3000000000000016, -1.700000000000001, -1.700000000000001, -1.700000000000001, -2.1000000000000014, -2.600000000000002, -1.600000000000001, -1.8000000000000012, -1.9000000000000012, -2.3000000000000016, -2.2000000000000015, -2.0000000000000013, -1.9000000000000012, -2.2000000000000015, -2.1000000000000014, -2.0000000000000013, -1.8000000000000012, -2.5000000000000018, -3.200000000000001, -1.700000000000001, -2.2000000000000015, -1.600000000000001, -2.0000000000000013, -2.4000000000000017, -2.3000000000000016, -2.900000000000002, -1.700000000000001, -2.1000000000000014, -5.700000000000003, -1.600000000000001, -2.4000000000000017, -1.8000000000000012, -2.4000000000000017, -1.5000000000000009, -2.1000000000000014, -2.5000000000000018, -2.0000000000000013, -2.5000000000000018, -2.0000000000000013, -1.9000000000000012, -2.2000000000000015, -2.0000000000000013, -2.0000000000000013, -1.9000000000000012, -1.8000000000000012, -1.8000000000000012, -2.900000000000002, -1.5000000000000009, -2.4000000000000017, -2.2000000000000015, -2.1000000000000014, -2.700000000000002, -1.9000000000000012, -2.3000000000000016, -1.8000000000000012, -1.700000000000001, -1.700000000000001, -2.0000000000000013, -2.2000000000000015, -1.9000000000000012, -1.700000000000001, -2.0000000000000013, -2.1000000000000014, -1.9000000000000012, -1.8000000000000012, -1.9000000000000012], "episode_lengths": [35, 30, 34, 29, 28, 30, 29, 31, 31, 29, 36, 28, 28, 29, 31, 38, 29, 35, 31, 32, 33, 34, 29, 32, 29, 33, 31, 30, 55, 38, 30, 45, 28, 33, 34, 31, 32, 35, 31, 31, 32, 33, 29, 28, 29, 31, 28, 39, 35, 27, 33, 29, 31, 33, 28, 34, 27, 28, 26, 38, 34, 28, 28, 28, 32, 37, 27, 29, 30, 34, 33, 31, 30, 33, 32, 31, 29, 36, 43, 28, 33, 27, 31, 35, 34, 38, 28, 32, 53, 27, 35, 29, 35, 26, 32, 36, 31, 36, 31, 30, 33, 31, 31, 30, 29, 29, 34, 26, 35, 33, 32, 38, 30, 34, 29, 28, 28, 31, 33, 30, 28, 31, 32, 30, 29, 30]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3489750674580455, "mean_inference_ms": 0.7319211864343989, "mean_action_processing_ms": 0.07604536179162606, "mean_env_wait_ms": 7.064618328215875, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006630874815441314, "StateBufferConnector_ms": 0.0038188601297045512, "ViewRequirementAgentConnector_ms": 0.086480284494067}, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 332000, "num_agent_steps_trained": 332000, "num_env_steps_sampled": 332000, "num_env_steps_trained": 332000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 429.5767779677908, "num_env_steps_trained_throughput_per_sec": 429.5767779677908, "timesteps_total": 332000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 332000, "timers": {"training_iteration_time_ms": 9334.072, "sample_time_ms": 5799.811, "load_time_ms": 1.001, "load_throughput": 3994194.839, "learn_time_ms": 3530.494, "learn_throughput": 1132.986, "synch_weights_time_ms": 2.13}, "counters": {"num_env_steps_sampled": 332000, "num_env_steps_trained": 332000, "num_agent_steps_sampled": 332000, "num_agent_steps_trained": 332000}, "done": false, "episodes_total": 6707, "training_iteration": 83, "trial_id": "ddfb6_00000", "date": "2024-03-07_13-01-26", "timestamp": 1709834486, "time_this_iter_s": 9.314306259155273, "time_total_s": 786.5996479988098, "pid": 112355, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4d85689f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 786.5996479988098, "iterations_since_restore": 83, "perf": {"cpu_util_percent": 27.05, "ram_util_percent": 47.791666666666664, "gpu_util_percent0": 0.06083333333333333, "vram_util_percent0": 0.10670979817708333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.09492187500000003, "cur_lr": 0.0010000000000000005, "total_loss": 0.08306124417088745, "policy_loss": -0.012440219538546697, "vf_loss": 0.09477271573337656, "vf_explained_var": 0.952933173025808, "kl": 0.007677348508890951, "entropy": 0.34201378061245846, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 77655.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 336000, "num_env_steps_trained": 336000, "num_agent_steps_sampled": 336000, "num_agent_steps_trained": 336000}, "sampler_results": {"episode_reward_max": -1.4000000000000008, "episode_reward_min": -3.5, "episode_reward_mean": -2.01968503937008, "episode_len_mean": 31.15748031496063, "episode_media": {}, "episodes_this_iter": 127, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1.8000000000000012, -2.1000000000000014, -1.700000000000001, -2.1000000000000014, -1.700000000000001, -1.600000000000001, -2.0000000000000013, -1.8000000000000012, -2.0000000000000013, -1.8000000000000012, -2.600000000000002, -1.700000000000001, -1.600000000000001, -2.3000000000000016, -1.8000000000000012, -1.4000000000000008, -1.8000000000000012, -2.2000000000000015, -2.4000000000000017, -2.1000000000000014, -2.0000000000000013, -2.2000000000000015, -2.4000000000000017, -2.1000000000000014, -1.700000000000001, -1.8000000000000012, -2.3000000000000016, -1.600000000000001, -2.3000000000000016, -1.8000000000000012, -2.1000000000000014, -2.2000000000000015, -1.600000000000001, -1.9000000000000012, -1.5000000000000009, -2.2000000000000015, -1.9000000000000012, -1.8000000000000012, -2.0000000000000013, -1.9000000000000012, -1.8000000000000012, -1.700000000000001, -2.1000000000000014, -2.0000000000000013, -2.1000000000000014, -1.600000000000001, -1.9000000000000012, -3.1000000000000014, -1.8000000000000012, -2.1000000000000014, -2.0000000000000013, -1.8000000000000012, -1.8000000000000012, -1.600000000000001, -2.4000000000000017, -1.5000000000000009, -2.2000000000000015, -1.600000000000001, -2.0000000000000013, -2.3000000000000016, -2.4000000000000017, -2.2000000000000015, -2.2000000000000015, -1.9000000000000012, -2.2000000000000015, -1.9000000000000012, -2.1000000000000014, -3.1000000000000014, -1.700000000000001, -2.3000000000000016, -1.700000000000001, -1.8000000000000012, -1.8000000000000012, -1.8000000000000012, -1.9000000000000012, -1.9000000000000012, -1.9000000000000012, -1.9000000000000012, -2.3000000000000016, -1.700000000000001, -2.5000000000000018, -2.2000000000000015, -2.5000000000000018, -1.5000000000000009, -2.3000000000000016, -2.1000000000000014, -2.5000000000000018, -1.5000000000000009, -1.9000000000000012, -2.3000000000000016, -2.5000000000000018, -3.5, -1.9000000000000012, -1.8000000000000012, -1.700000000000001, -2.0000000000000013, -2.4000000000000017, -1.9000000000000012, -3.0000000000000018, -1.9000000000000012, -1.5000000000000009, -2.3000000000000016, -2.2000000000000015, -2.800000000000002, -3.4000000000000004, -2.1000000000000014, -1.700000000000001, -1.8000000000000012, -1.9000000000000012, -1.700000000000001, -2.0000000000000013, -1.600000000000001, -2.3000000000000016, -2.1000000000000014, -2.1000000000000014, -2.1000000000000014, -2.0000000000000013, -2.0000000000000013, -1.8000000000000012, -1.9000000000000012, -2.0000000000000013, -1.700000000000001, -1.9000000000000012, -2.2000000000000015, -1.9000000000000012, -1.700000000000001, -2.0000000000000013], "episode_lengths": [29, 32, 28, 32, 28, 27, 31, 29, 31, 29, 37, 28, 27, 34, 29, 25, 29, 33, 35, 32, 31, 33, 35, 32, 28, 29, 34, 27, 32, 29, 32, 33, 27, 30, 26, 33, 30, 29, 31, 30, 29, 28, 32, 31, 32, 27, 30, 42, 29, 32, 31, 29, 29, 27, 32, 26, 33, 27, 31, 34, 35, 33, 33, 30, 33, 30, 32, 42, 28, 34, 28, 29, 29, 29, 30, 30, 30, 30, 34, 28, 36, 33, 36, 26, 34, 32, 36, 26, 30, 34, 36, 46, 30, 29, 28, 31, 35, 30, 41, 30, 26, 34, 33, 39, 45, 32, 28, 29, 30, 28, 31, 27, 34, 32, 32, 32, 31, 31, 29, 30, 31, 28, 30, 33, 30, 28, 31]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3497025939618755, "mean_inference_ms": 0.7315755937205485, "mean_action_processing_ms": 0.07600328539263156, "mean_env_wait_ms": 7.068417539070425, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006601566404808225, "StateBufferConnector_ms": 0.0038451097142977978, "ViewRequirementAgentConnector_ms": 0.08678811741626169}}, "episode_reward_max": -1.4000000000000008, "episode_reward_min": -3.5, "episode_reward_mean": -2.01968503937008, "episode_len_mean": 31.15748031496063, "episodes_this_iter": 127, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1.8000000000000012, -2.1000000000000014, -1.700000000000001, -2.1000000000000014, -1.700000000000001, -1.600000000000001, -2.0000000000000013, -1.8000000000000012, -2.0000000000000013, -1.8000000000000012, -2.600000000000002, -1.700000000000001, -1.600000000000001, -2.3000000000000016, -1.8000000000000012, -1.4000000000000008, -1.8000000000000012, -2.2000000000000015, -2.4000000000000017, -2.1000000000000014, -2.0000000000000013, -2.2000000000000015, -2.4000000000000017, -2.1000000000000014, -1.700000000000001, -1.8000000000000012, -2.3000000000000016, -1.600000000000001, -2.3000000000000016, -1.8000000000000012, -2.1000000000000014, -2.2000000000000015, -1.600000000000001, -1.9000000000000012, -1.5000000000000009, -2.2000000000000015, -1.9000000000000012, -1.8000000000000012, -2.0000000000000013, -1.9000000000000012, -1.8000000000000012, -1.700000000000001, -2.1000000000000014, -2.0000000000000013, -2.1000000000000014, -1.600000000000001, -1.9000000000000012, -3.1000000000000014, -1.8000000000000012, -2.1000000000000014, -2.0000000000000013, -1.8000000000000012, -1.8000000000000012, -1.600000000000001, -2.4000000000000017, -1.5000000000000009, -2.2000000000000015, -1.600000000000001, -2.0000000000000013, -2.3000000000000016, -2.4000000000000017, -2.2000000000000015, -2.2000000000000015, -1.9000000000000012, -2.2000000000000015, -1.9000000000000012, -2.1000000000000014, -3.1000000000000014, -1.700000000000001, -2.3000000000000016, -1.700000000000001, -1.8000000000000012, -1.8000000000000012, -1.8000000000000012, -1.9000000000000012, -1.9000000000000012, -1.9000000000000012, -1.9000000000000012, -2.3000000000000016, -1.700000000000001, -2.5000000000000018, -2.2000000000000015, -2.5000000000000018, -1.5000000000000009, -2.3000000000000016, -2.1000000000000014, -2.5000000000000018, -1.5000000000000009, -1.9000000000000012, -2.3000000000000016, -2.5000000000000018, -3.5, -1.9000000000000012, -1.8000000000000012, -1.700000000000001, -2.0000000000000013, -2.4000000000000017, -1.9000000000000012, -3.0000000000000018, -1.9000000000000012, -1.5000000000000009, -2.3000000000000016, -2.2000000000000015, -2.800000000000002, -3.4000000000000004, -2.1000000000000014, -1.700000000000001, -1.8000000000000012, -1.9000000000000012, -1.700000000000001, -2.0000000000000013, -1.600000000000001, -2.3000000000000016, -2.1000000000000014, -2.1000000000000014, -2.1000000000000014, -2.0000000000000013, -2.0000000000000013, -1.8000000000000012, -1.9000000000000012, -2.0000000000000013, -1.700000000000001, -1.9000000000000012, -2.2000000000000015, -1.9000000000000012, -1.700000000000001, -2.0000000000000013], "episode_lengths": [29, 32, 28, 32, 28, 27, 31, 29, 31, 29, 37, 28, 27, 34, 29, 25, 29, 33, 35, 32, 31, 33, 35, 32, 28, 29, 34, 27, 32, 29, 32, 33, 27, 30, 26, 33, 30, 29, 31, 30, 29, 28, 32, 31, 32, 27, 30, 42, 29, 32, 31, 29, 29, 27, 32, 26, 33, 27, 31, 34, 35, 33, 33, 30, 33, 30, 32, 42, 28, 34, 28, 29, 29, 29, 30, 30, 30, 30, 34, 28, 36, 33, 36, 26, 34, 32, 36, 26, 30, 34, 36, 46, 30, 29, 28, 31, 35, 30, 41, 30, 26, 34, 33, 39, 45, 32, 28, 29, 30, 28, 31, 27, 34, 32, 32, 32, 31, 31, 29, 30, 31, 28, 30, 33, 30, 28, 31]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3497025939618755, "mean_inference_ms": 0.7315755937205485, "mean_action_processing_ms": 0.07600328539263156, "mean_env_wait_ms": 7.068417539070425, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006601566404808225, "StateBufferConnector_ms": 0.0038451097142977978, "ViewRequirementAgentConnector_ms": 0.08678811741626169}, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 336000, "num_agent_steps_trained": 336000, "num_env_steps_sampled": 336000, "num_env_steps_trained": 336000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 422.13394630576664, "num_env_steps_trained_throughput_per_sec": 422.13394630576664, "timesteps_total": 336000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 336000, "timers": {"training_iteration_time_ms": 9353.807, "sample_time_ms": 5800.976, "load_time_ms": 1.004, "load_throughput": 3984329.819, "learn_time_ms": 3548.943, "learn_throughput": 1127.096, "synch_weights_time_ms": 2.227}, "counters": {"num_env_steps_sampled": 336000, "num_env_steps_trained": 336000, "num_agent_steps_sampled": 336000, "num_agent_steps_trained": 336000}, "done": false, "episodes_total": 6834, "training_iteration": 84, "trial_id": "ddfb6_00000", "date": "2024-03-07_13-01-36", "timestamp": 1709834496, "time_this_iter_s": 9.47862720489502, "time_total_s": 796.0782752037048, "pid": 112355, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4d85689f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 796.0782752037048, "iterations_since_restore": 84, "perf": {"cpu_util_percent": 25.653846153846157, "ram_util_percent": 47.77692307692307, "gpu_util_percent0": 0.0623076923076923, "vram_util_percent0": 0.10670823317307693}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.09492187500000003, "cur_lr": 0.0010000000000000005, "total_loss": 0.45627479145443567, "policy_loss": -0.004842610657215118, "vf_loss": 0.46063836743549436, "vf_explained_var": 0.8457789937655131, "kl": 0.005046629366347591, "entropy": 0.299689584780204, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 78585.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 340000, "num_env_steps_trained": 340000, "num_agent_steps_sampled": 340000, "num_agent_steps_trained": 340000}, "sampler_results": {"episode_reward_max": -1.4000000000000008, "episode_reward_min": -76.30000000000055, "episode_reward_mean": -2.5806722689075685, "episode_len_mean": 33.63865546218487, "episode_media": {}, "episodes_this_iter": 119, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1.8000000000000012, -2.0000000000000013, -1.9000000000000012, -2.0000000000000013, -2.0000000000000013, -1.9000000000000012, -1.9000000000000012, -1.8000000000000012, -2.2000000000000015, -2.3000000000000016, -1.9000000000000012, -2.0000000000000013, -1.600000000000001, -2.3000000000000016, -2.0000000000000013, -2.4000000000000017, -2.600000000000002, -2.0000000000000013, -2.5000000000000018, -2.2000000000000015, -2.2000000000000015, -2.4000000000000017, -1.600000000000001, -1.9000000000000012, -1.8000000000000012, -1.600000000000001, -2.2000000000000015, -1.8000000000000012, -1.700000000000001, -2.0000000000000013, -1.9000000000000012, -1.5000000000000009, -1.5000000000000009, -1.8000000000000012, -1.4000000000000008, -2.600000000000002, -1.8000000000000012, -1.8000000000000012, -2.4000000000000017, -1.700000000000001, -2.1000000000000014, -2.0000000000000013, -2.4000000000000017, -1.700000000000001, -1.8000000000000012, -1.9000000000000012, -1.9000000000000012, -2.600000000000002, -1.9000000000000012, -1.8000000000000012, -1.700000000000001, -1.600000000000001, -1.4000000000000008, -2.0000000000000013, -1.5000000000000009, -2.3000000000000016, -2.3000000000000016, -2.0000000000000013, -1.700000000000001, -1.5000000000000009, -2.0000000000000013, -1.5000000000000009, -1.700000000000001, -1.5000000000000009, -1.700000000000001, -1.9000000000000012, -2.2000000000000015, -1.9000000000000012, -1.4000000000000008, -1.8000000000000012, -2.0000000000000013, -2.0000000000000013, -1.700000000000001, -1.9000000000000012, -2.1000000000000014, -1.600000000000001, -1.8000000000000012, -1.600000000000001, -1.700000000000001, -3.1000000000000014, -1.700000000000001, -2.3000000000000016, -1.9000000000000012, -2.3000000000000016, -1.700000000000001, -2.0000000000000013, -1.8000000000000012, -1.8000000000000012, -76.30000000000055, -2.0000000000000013, -3.0000000000000018, -1.5000000000000009, -1.9000000000000012, -1.8000000000000012, -2.900000000000002, -2.4000000000000017, -2.0000000000000013, -2.1000000000000014, -3.200000000000001, -1.9000000000000012, -2.0000000000000013, -2.0000000000000013, -1.9000000000000012, -2.1000000000000014, -1.5000000000000009, -1.600000000000001, -1.600000000000001, -1.8000000000000012, -1.700000000000001, -1.9000000000000012, -1.4000000000000008, -2.3000000000000016, -2.600000000000002, -1.600000000000001, -1.9000000000000012, -2.4000000000000017, -2.1000000000000014, -1.4000000000000008, -2.700000000000002], "episode_lengths": [29, 31, 30, 31, 31, 30, 30, 29, 33, 34, 30, 31, 27, 34, 31, 35, 37, 31, 36, 33, 33, 35, 27, 30, 29, 27, 33, 29, 28, 31, 30, 26, 26, 29, 25, 37, 29, 29, 35, 28, 32, 31, 35, 28, 29, 30, 30, 37, 30, 29, 28, 27, 25, 31, 26, 34, 34, 31, 28, 26, 31, 26, 28, 26, 28, 30, 33, 30, 25, 29, 31, 31, 28, 30, 32, 27, 29, 27, 28, 42, 28, 34, 30, 34, 28, 31, 29, 29, 400, 31, 41, 26, 30, 29, 40, 35, 31, 32, 40, 30, 31, 31, 30, 32, 26, 27, 27, 29, 28, 30, 25, 34, 37, 27, 30, 35, 32, 25, 38]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.350355249672439, "mean_inference_ms": 0.7315221080154762, "mean_action_processing_ms": 0.07602637066461128, "mean_env_wait_ms": 7.077657179400543, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006554908111315815, "StateBufferConnector_ms": 0.0038225109837636225, "ViewRequirementAgentConnector_ms": 0.08699994127289588}}, "episode_reward_max": -1.4000000000000008, "episode_reward_min": -76.30000000000055, "episode_reward_mean": -2.5806722689075685, "episode_len_mean": 33.63865546218487, "episodes_this_iter": 119, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1.8000000000000012, -2.0000000000000013, -1.9000000000000012, -2.0000000000000013, -2.0000000000000013, -1.9000000000000012, -1.9000000000000012, -1.8000000000000012, -2.2000000000000015, -2.3000000000000016, -1.9000000000000012, -2.0000000000000013, -1.600000000000001, -2.3000000000000016, -2.0000000000000013, -2.4000000000000017, -2.600000000000002, -2.0000000000000013, -2.5000000000000018, -2.2000000000000015, -2.2000000000000015, -2.4000000000000017, -1.600000000000001, -1.9000000000000012, -1.8000000000000012, -1.600000000000001, -2.2000000000000015, -1.8000000000000012, -1.700000000000001, -2.0000000000000013, -1.9000000000000012, -1.5000000000000009, -1.5000000000000009, -1.8000000000000012, -1.4000000000000008, -2.600000000000002, -1.8000000000000012, -1.8000000000000012, -2.4000000000000017, -1.700000000000001, -2.1000000000000014, -2.0000000000000013, -2.4000000000000017, -1.700000000000001, -1.8000000000000012, -1.9000000000000012, -1.9000000000000012, -2.600000000000002, -1.9000000000000012, -1.8000000000000012, -1.700000000000001, -1.600000000000001, -1.4000000000000008, -2.0000000000000013, -1.5000000000000009, -2.3000000000000016, -2.3000000000000016, -2.0000000000000013, -1.700000000000001, -1.5000000000000009, -2.0000000000000013, -1.5000000000000009, -1.700000000000001, -1.5000000000000009, -1.700000000000001, -1.9000000000000012, -2.2000000000000015, -1.9000000000000012, -1.4000000000000008, -1.8000000000000012, -2.0000000000000013, -2.0000000000000013, -1.700000000000001, -1.9000000000000012, -2.1000000000000014, -1.600000000000001, -1.8000000000000012, -1.600000000000001, -1.700000000000001, -3.1000000000000014, -1.700000000000001, -2.3000000000000016, -1.9000000000000012, -2.3000000000000016, -1.700000000000001, -2.0000000000000013, -1.8000000000000012, -1.8000000000000012, -76.30000000000055, -2.0000000000000013, -3.0000000000000018, -1.5000000000000009, -1.9000000000000012, -1.8000000000000012, -2.900000000000002, -2.4000000000000017, -2.0000000000000013, -2.1000000000000014, -3.200000000000001, -1.9000000000000012, -2.0000000000000013, -2.0000000000000013, -1.9000000000000012, -2.1000000000000014, -1.5000000000000009, -1.600000000000001, -1.600000000000001, -1.8000000000000012, -1.700000000000001, -1.9000000000000012, -1.4000000000000008, -2.3000000000000016, -2.600000000000002, -1.600000000000001, -1.9000000000000012, -2.4000000000000017, -2.1000000000000014, -1.4000000000000008, -2.700000000000002], "episode_lengths": [29, 31, 30, 31, 31, 30, 30, 29, 33, 34, 30, 31, 27, 34, 31, 35, 37, 31, 36, 33, 33, 35, 27, 30, 29, 27, 33, 29, 28, 31, 30, 26, 26, 29, 25, 37, 29, 29, 35, 28, 32, 31, 35, 28, 29, 30, 30, 37, 30, 29, 28, 27, 25, 31, 26, 34, 34, 31, 28, 26, 31, 26, 28, 26, 28, 30, 33, 30, 25, 29, 31, 31, 28, 30, 32, 27, 29, 27, 28, 42, 28, 34, 30, 34, 28, 31, 29, 29, 400, 31, 41, 26, 30, 29, 40, 35, 31, 32, 40, 30, 31, 31, 30, 32, 26, 27, 27, 29, 28, 30, 25, 34, 37, 27, 30, 35, 32, 25, 38]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.350355249672439, "mean_inference_ms": 0.7315221080154762, "mean_action_processing_ms": 0.07602637066461128, "mean_env_wait_ms": 7.077657179400543, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006554908111315815, "StateBufferConnector_ms": 0.0038225109837636225, "ViewRequirementAgentConnector_ms": 0.08699994127289588}, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 340000, "num_agent_steps_trained": 340000, "num_env_steps_sampled": 340000, "num_env_steps_trained": 340000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 418.37524716726296, "num_env_steps_trained_throughput_per_sec": 418.37524716726296, "timesteps_total": 340000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 340000, "timers": {"training_iteration_time_ms": 9377.087, "sample_time_ms": 5816.811, "load_time_ms": 1.003, "load_throughput": 3989730.565, "learn_time_ms": 3556.399, "learn_throughput": 1124.733, "synch_weights_time_ms": 2.218}, "counters": {"num_env_steps_sampled": 340000, "num_env_steps_trained": 340000, "num_agent_steps_sampled": 340000, "num_agent_steps_trained": 340000}, "done": false, "episodes_total": 6953, "training_iteration": 85, "trial_id": "ddfb6_00000", "date": "2024-03-07_13-01-46", "timestamp": 1709834506, "time_this_iter_s": 9.563563585281372, "time_total_s": 805.6418387889862, "pid": 112355, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4d85689f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 805.6418387889862, "iterations_since_restore": 85, "perf": {"cpu_util_percent": 28.008333333333336, "ram_util_percent": 47.79999999999999, "gpu_util_percent0": 0.06916666666666667, "vram_util_percent0": 0.10670979817708333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.09492187500000003, "cur_lr": 0.0010000000000000005, "total_loss": 0.6491223049800097, "policy_loss": -0.008174662473261035, "vf_loss": 0.6562448291478539, "vf_explained_var": 0.7348897248186091, "kl": 0.011084276184765315, "entropy": 0.273303811125938, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 79515.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 344000, "num_env_steps_trained": 344000, "num_agent_steps_sampled": 344000, "num_agent_steps_trained": 344000}, "sampler_results": {"episode_reward_max": -1.4000000000000008, "episode_reward_min": -77.20000000000056, "episode_reward_mean": -2.5482758620689716, "episode_len_mean": 33.14655172413793, "episode_media": {}, "episodes_this_iter": 116, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2.1000000000000014, -2.0000000000000013, -1.600000000000001, -1.8000000000000012, -2.0000000000000013, -1.4000000000000008, -2.0000000000000013, -1.700000000000001, -1.5000000000000009, -2.1000000000000014, -2.1000000000000014, -1.8000000000000012, -1.9000000000000012, -1.5000000000000009, -2.1000000000000014, -1.9000000000000012, -2.2000000000000015, -1.4000000000000008, -1.5000000000000009, -2.3000000000000016, -2.0000000000000013, -2.0000000000000013, -1.700000000000001, -2.0000000000000013, -2.0000000000000013, -1.600000000000001, -77.20000000000056, -2.4000000000000017, -1.5000000000000009, -2.1000000000000014, -1.600000000000001, -2.1000000000000014, -2.1000000000000014, -1.8000000000000012, -1.700000000000001, -2.0000000000000013, -1.700000000000001, -2.1000000000000014, -1.8000000000000012, -2.0000000000000013, -1.8000000000000012, -1.8000000000000012, -1.700000000000001, -1.9000000000000012, -1.4000000000000008, -2.1000000000000014, -1.8000000000000012, -2.600000000000002, -1.4000000000000008, -1.600000000000001, -2.2000000000000015, -1.700000000000001, -2.1000000000000014, -1.9000000000000012, -2.800000000000002, -1.8000000000000012, -1.8000000000000012, -2.0000000000000013, -2.700000000000002, -2.0000000000000013, -2.3000000000000016, -2.1000000000000014, -1.4000000000000008, -1.9000000000000012, -1.4000000000000008, -1.8000000000000012, -1.9000000000000012, -1.700000000000001, -2.900000000000002, -1.700000000000001, -1.9000000000000012, -2.1000000000000014, -2.600000000000002, -1.8000000000000012, -1.9000000000000012, -1.5000000000000009, -1.700000000000001, -2.0000000000000013, -1.9000000000000012, -1.700000000000001, -1.9000000000000012, -1.5000000000000009, -1.9000000000000012, -1.700000000000001, -1.8000000000000012, -2.0000000000000013, -1.700000000000001, -1.700000000000001, -2.0000000000000013, -1.8000000000000012, -1.700000000000001, -1.700000000000001, -1.700000000000001, -1.5000000000000009, -1.8000000000000012, -2.0000000000000013, -2.1000000000000014, -2.3000000000000016, -1.8000000000000012, -2.3000000000000016, -1.600000000000001, -1.9000000000000012, -1.8000000000000012, -1.700000000000001, -2.2000000000000015, -2.2000000000000015, -1.8000000000000012, -1.4000000000000008, -2.800000000000002, -1.5000000000000009, -1.8000000000000012, -1.700000000000001, -2.2000000000000015, -2.5000000000000018, -1.9000000000000012, -2.1000000000000014], "episode_lengths": [32, 31, 27, 29, 31, 25, 31, 28, 26, 32, 32, 29, 30, 26, 32, 30, 33, 25, 26, 34, 31, 31, 28, 31, 31, 27, 400, 35, 26, 32, 27, 32, 32, 29, 28, 31, 28, 32, 29, 31, 29, 29, 28, 30, 25, 32, 29, 37, 25, 27, 33, 28, 32, 30, 39, 29, 29, 31, 38, 31, 34, 32, 25, 30, 25, 29, 30, 28, 38, 28, 30, 32, 35, 29, 30, 26, 28, 31, 30, 28, 30, 26, 30, 28, 29, 31, 28, 28, 31, 29, 28, 28, 28, 26, 29, 31, 32, 34, 29, 34, 27, 30, 29, 28, 33, 33, 29, 25, 39, 26, 29, 28, 33, 36, 30, 32]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3505773731915599, "mean_inference_ms": 0.7307733374619763, "mean_action_processing_ms": 0.07592062186497614, "mean_env_wait_ms": 7.069063441780295, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006624953500155745, "StateBufferConnector_ms": 0.003790238807941305, "ViewRequirementAgentConnector_ms": 0.08609171571402714}}, "episode_reward_max": -1.4000000000000008, "episode_reward_min": -77.20000000000056, "episode_reward_mean": -2.5482758620689716, "episode_len_mean": 33.14655172413793, "episodes_this_iter": 116, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-2.1000000000000014, -2.0000000000000013, -1.600000000000001, -1.8000000000000012, -2.0000000000000013, -1.4000000000000008, -2.0000000000000013, -1.700000000000001, -1.5000000000000009, -2.1000000000000014, -2.1000000000000014, -1.8000000000000012, -1.9000000000000012, -1.5000000000000009, -2.1000000000000014, -1.9000000000000012, -2.2000000000000015, -1.4000000000000008, -1.5000000000000009, -2.3000000000000016, -2.0000000000000013, -2.0000000000000013, -1.700000000000001, -2.0000000000000013, -2.0000000000000013, -1.600000000000001, -77.20000000000056, -2.4000000000000017, -1.5000000000000009, -2.1000000000000014, -1.600000000000001, -2.1000000000000014, -2.1000000000000014, -1.8000000000000012, -1.700000000000001, -2.0000000000000013, -1.700000000000001, -2.1000000000000014, -1.8000000000000012, -2.0000000000000013, -1.8000000000000012, -1.8000000000000012, -1.700000000000001, -1.9000000000000012, -1.4000000000000008, -2.1000000000000014, -1.8000000000000012, -2.600000000000002, -1.4000000000000008, -1.600000000000001, -2.2000000000000015, -1.700000000000001, -2.1000000000000014, -1.9000000000000012, -2.800000000000002, -1.8000000000000012, -1.8000000000000012, -2.0000000000000013, -2.700000000000002, -2.0000000000000013, -2.3000000000000016, -2.1000000000000014, -1.4000000000000008, -1.9000000000000012, -1.4000000000000008, -1.8000000000000012, -1.9000000000000012, -1.700000000000001, -2.900000000000002, -1.700000000000001, -1.9000000000000012, -2.1000000000000014, -2.600000000000002, -1.8000000000000012, -1.9000000000000012, -1.5000000000000009, -1.700000000000001, -2.0000000000000013, -1.9000000000000012, -1.700000000000001, -1.9000000000000012, -1.5000000000000009, -1.9000000000000012, -1.700000000000001, -1.8000000000000012, -2.0000000000000013, -1.700000000000001, -1.700000000000001, -2.0000000000000013, -1.8000000000000012, -1.700000000000001, -1.700000000000001, -1.700000000000001, -1.5000000000000009, -1.8000000000000012, -2.0000000000000013, -2.1000000000000014, -2.3000000000000016, -1.8000000000000012, -2.3000000000000016, -1.600000000000001, -1.9000000000000012, -1.8000000000000012, -1.700000000000001, -2.2000000000000015, -2.2000000000000015, -1.8000000000000012, -1.4000000000000008, -2.800000000000002, -1.5000000000000009, -1.8000000000000012, -1.700000000000001, -2.2000000000000015, -2.5000000000000018, -1.9000000000000012, -2.1000000000000014], "episode_lengths": [32, 31, 27, 29, 31, 25, 31, 28, 26, 32, 32, 29, 30, 26, 32, 30, 33, 25, 26, 34, 31, 31, 28, 31, 31, 27, 400, 35, 26, 32, 27, 32, 32, 29, 28, 31, 28, 32, 29, 31, 29, 29, 28, 30, 25, 32, 29, 37, 25, 27, 33, 28, 32, 30, 39, 29, 29, 31, 38, 31, 34, 32, 25, 30, 25, 29, 30, 28, 38, 28, 30, 32, 35, 29, 30, 26, 28, 31, 30, 28, 30, 26, 30, 28, 29, 31, 28, 28, 31, 29, 28, 28, 28, 26, 29, 31, 32, 34, 29, 34, 27, 30, 29, 28, 33, 33, 29, 25, 39, 26, 29, 28, 33, 36, 30, 32]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3505773731915599, "mean_inference_ms": 0.7307733374619763, "mean_action_processing_ms": 0.07592062186497614, "mean_env_wait_ms": 7.069063441780295, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006624953500155745, "StateBufferConnector_ms": 0.003790238807941305, "ViewRequirementAgentConnector_ms": 0.08609171571402714}, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 344000, "num_agent_steps_trained": 344000, "num_env_steps_sampled": 344000, "num_env_steps_trained": 344000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 393.1229189351237, "num_env_steps_trained_throughput_per_sec": 393.1229189351237, "timesteps_total": 344000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 344000, "timers": {"training_iteration_time_ms": 9450.686, "sample_time_ms": 5902.354, "load_time_ms": 1.001, "load_throughput": 3996859.158, "learn_time_ms": 3544.453, "learn_throughput": 1128.524, "synch_weights_time_ms": 2.219}, "counters": {"num_env_steps_sampled": 344000, "num_env_steps_trained": 344000, "num_agent_steps_sampled": 344000, "num_agent_steps_trained": 344000}, "done": false, "episodes_total": 7069, "training_iteration": 86, "trial_id": "ddfb6_00000", "date": "2024-03-07_13-01-56", "timestamp": 1709834516, "time_this_iter_s": 10.177727460861206, "time_total_s": 815.8195662498474, "pid": 112355, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4d85689f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 815.8195662498474, "iterations_since_restore": 86, "perf": {"cpu_util_percent": 27.107692307692307, "ram_util_percent": 47.83076923076922, "gpu_util_percent0": 0.05384615384615384, "vram_util_percent0": 0.10670823317307693}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.09492187500000003, "cur_lr": 0.0010000000000000005, "total_loss": 0.5530038789417895, "policy_loss": -0.004370118236990385, "vf_loss": 0.5561703752653714, "vf_explained_var": 0.7970225046398819, "kl": 0.012680125551052092, "entropy": 0.3127864829715221, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 80445.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 348000, "num_env_steps_trained": 348000, "num_agent_steps_sampled": 348000, "num_agent_steps_trained": 348000}, "sampler_results": {"episode_reward_max": -1.4000000000000008, "episode_reward_min": -76.00000000000054, "episode_reward_mean": -2.512820512820519, "episode_len_mean": 32.888888888888886, "episode_media": {}, "episodes_this_iter": 117, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2.1000000000000014, -1.8000000000000012, -2.0000000000000013, -1.9000000000000012, -3.0000000000000018, -1.9000000000000012, -1.700000000000001, -2.2000000000000015, -2.5000000000000018, -2.0000000000000013, -1.700000000000001, -1.700000000000001, -1.700000000000001, -1.700000000000001, -1.600000000000001, -1.600000000000001, -2.0000000000000013, -1.600000000000001, -2.4000000000000017, -1.700000000000001, -1.700000000000001, -1.700000000000001, -2.2000000000000015, -1.8000000000000012, -2.2000000000000015, -2.0000000000000013, -2.1000000000000014, -1.600000000000001, -1.9000000000000012, -1.8000000000000012, -1.600000000000001, -2.0000000000000013, -1.700000000000001, -1.700000000000001, -1.700000000000001, -1.700000000000001, -1.8000000000000012, -1.700000000000001, -1.8000000000000012, -2.4000000000000017, -1.4000000000000008, -1.9000000000000012, -1.9000000000000012, -1.5000000000000009, -2.0000000000000013, -2.0000000000000013, -76.00000000000054, -1.4000000000000008, -1.700000000000001, -2.1000000000000014, -2.2000000000000015, -1.9000000000000012, -1.700000000000001, -1.8000000000000012, -2.0000000000000013, -1.5000000000000009, -1.8000000000000012, -2.3000000000000016, -2.1000000000000014, -1.8000000000000012, -2.1000000000000014, -1.9000000000000012, -1.8000000000000012, -2.5000000000000018, -2.1000000000000014, -1.8000000000000012, -2.0000000000000013, -2.3000000000000016, -1.9000000000000012, -1.8000000000000012, -1.5000000000000009, -1.700000000000001, -1.8000000000000012, -2.0000000000000013, -1.8000000000000012, -1.8000000000000012, -1.5000000000000009, -1.9000000000000012, -1.9000000000000012, -1.8000000000000012, -1.8000000000000012, -2.1000000000000014, -1.8000000000000012, -1.9000000000000012, -2.4000000000000017, -1.9000000000000012, -2.1000000000000014, -2.3000000000000016, -1.9000000000000012, -1.700000000000001, -2.2000000000000015, -1.700000000000001, -1.5000000000000009, -1.5000000000000009, -2.2000000000000015, -1.700000000000001, -1.8000000000000012, -1.8000000000000012, -1.700000000000001, -1.9000000000000012, -2.0000000000000013, -2.2000000000000015, -1.5000000000000009, -1.700000000000001, -1.9000000000000012, -1.700000000000001, -2.2000000000000015, -1.9000000000000012, -1.700000000000001, -1.600000000000001, -1.9000000000000012, -2.0000000000000013, -2.0000000000000013, -2.0000000000000013, -1.8000000000000012, -1.600000000000001, -1.600000000000001], "episode_lengths": [32, 29, 31, 30, 33, 30, 28, 33, 36, 31, 28, 28, 28, 28, 27, 27, 31, 27, 35, 28, 28, 28, 33, 29, 33, 31, 32, 27, 30, 29, 27, 31, 28, 28, 28, 28, 29, 28, 29, 35, 25, 30, 30, 26, 31, 31, 400, 25, 28, 32, 33, 30, 28, 29, 31, 26, 29, 34, 32, 29, 32, 30, 29, 36, 32, 29, 31, 34, 30, 29, 26, 28, 29, 31, 29, 29, 26, 30, 30, 29, 29, 32, 29, 30, 35, 30, 32, 34, 30, 28, 33, 28, 26, 26, 33, 28, 29, 29, 28, 30, 31, 33, 26, 28, 30, 28, 33, 30, 28, 27, 30, 31, 31, 31, 29, 27, 27]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.35133884104503943, "mean_inference_ms": 0.730291871756291, "mean_action_processing_ms": 0.07587682533489533, "mean_env_wait_ms": 7.079081924936166, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00655569581903963, "StateBufferConnector_ms": 0.0037953384921082063, "ViewRequirementAgentConnector_ms": 0.08597210941151676}}, "episode_reward_max": -1.4000000000000008, "episode_reward_min": -76.00000000000054, "episode_reward_mean": -2.512820512820519, "episode_len_mean": 32.888888888888886, "episodes_this_iter": 117, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-2.1000000000000014, -1.8000000000000012, -2.0000000000000013, -1.9000000000000012, -3.0000000000000018, -1.9000000000000012, -1.700000000000001, -2.2000000000000015, -2.5000000000000018, -2.0000000000000013, -1.700000000000001, -1.700000000000001, -1.700000000000001, -1.700000000000001, -1.600000000000001, -1.600000000000001, -2.0000000000000013, -1.600000000000001, -2.4000000000000017, -1.700000000000001, -1.700000000000001, -1.700000000000001, -2.2000000000000015, -1.8000000000000012, -2.2000000000000015, -2.0000000000000013, -2.1000000000000014, -1.600000000000001, -1.9000000000000012, -1.8000000000000012, -1.600000000000001, -2.0000000000000013, -1.700000000000001, -1.700000000000001, -1.700000000000001, -1.700000000000001, -1.8000000000000012, -1.700000000000001, -1.8000000000000012, -2.4000000000000017, -1.4000000000000008, -1.9000000000000012, -1.9000000000000012, -1.5000000000000009, -2.0000000000000013, -2.0000000000000013, -76.00000000000054, -1.4000000000000008, -1.700000000000001, -2.1000000000000014, -2.2000000000000015, -1.9000000000000012, -1.700000000000001, -1.8000000000000012, -2.0000000000000013, -1.5000000000000009, -1.8000000000000012, -2.3000000000000016, -2.1000000000000014, -1.8000000000000012, -2.1000000000000014, -1.9000000000000012, -1.8000000000000012, -2.5000000000000018, -2.1000000000000014, -1.8000000000000012, -2.0000000000000013, -2.3000000000000016, -1.9000000000000012, -1.8000000000000012, -1.5000000000000009, -1.700000000000001, -1.8000000000000012, -2.0000000000000013, -1.8000000000000012, -1.8000000000000012, -1.5000000000000009, -1.9000000000000012, -1.9000000000000012, -1.8000000000000012, -1.8000000000000012, -2.1000000000000014, -1.8000000000000012, -1.9000000000000012, -2.4000000000000017, -1.9000000000000012, -2.1000000000000014, -2.3000000000000016, -1.9000000000000012, -1.700000000000001, -2.2000000000000015, -1.700000000000001, -1.5000000000000009, -1.5000000000000009, -2.2000000000000015, -1.700000000000001, -1.8000000000000012, -1.8000000000000012, -1.700000000000001, -1.9000000000000012, -2.0000000000000013, -2.2000000000000015, -1.5000000000000009, -1.700000000000001, -1.9000000000000012, -1.700000000000001, -2.2000000000000015, -1.9000000000000012, -1.700000000000001, -1.600000000000001, -1.9000000000000012, -2.0000000000000013, -2.0000000000000013, -2.0000000000000013, -1.8000000000000012, -1.600000000000001, -1.600000000000001], "episode_lengths": [32, 29, 31, 30, 33, 30, 28, 33, 36, 31, 28, 28, 28, 28, 27, 27, 31, 27, 35, 28, 28, 28, 33, 29, 33, 31, 32, 27, 30, 29, 27, 31, 28, 28, 28, 28, 29, 28, 29, 35, 25, 30, 30, 26, 31, 31, 400, 25, 28, 32, 33, 30, 28, 29, 31, 26, 29, 34, 32, 29, 32, 30, 29, 36, 32, 29, 31, 34, 30, 29, 26, 28, 29, 31, 29, 29, 26, 30, 30, 29, 29, 32, 29, 30, 35, 30, 32, 34, 30, 28, 33, 28, 26, 26, 33, 28, 29, 29, 28, 30, 31, 33, 26, 28, 30, 28, 33, 30, 28, 27, 30, 31, 31, 31, 29, 27, 27]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.35133884104503943, "mean_inference_ms": 0.730291871756291, "mean_action_processing_ms": 0.07587682533489533, "mean_env_wait_ms": 7.079081924936166, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00655569581903963, "StateBufferConnector_ms": 0.0037953384921082063, "ViewRequirementAgentConnector_ms": 0.08597210941151676}, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 348000, "num_agent_steps_trained": 348000, "num_env_steps_sampled": 348000, "num_env_steps_trained": 348000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 406.56134108215656, "num_env_steps_trained_throughput_per_sec": 406.56134108215656, "timesteps_total": 348000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 348000, "timers": {"training_iteration_time_ms": 9502.953, "sample_time_ms": 5959.072, "load_time_ms": 1.002, "load_throughput": 3992768.985, "learn_time_ms": 3540.052, "learn_throughput": 1129.927, "synch_weights_time_ms": 2.172}, "counters": {"num_env_steps_sampled": 348000, "num_env_steps_trained": 348000, "num_agent_steps_sampled": 348000, "num_agent_steps_trained": 348000}, "done": false, "episodes_total": 7186, "training_iteration": 87, "trial_id": "ddfb6_00000", "date": "2024-03-07_13-02-06", "timestamp": 1709834526, "time_this_iter_s": 9.841074228286743, "time_total_s": 825.6606404781342, "pid": 112355, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4d85689f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 825.6606404781342, "iterations_since_restore": 87, "perf": {"cpu_util_percent": 25.484615384615388, "ram_util_percent": 47.85384615384615, "gpu_util_percent0": 0.0576923076923077, "vram_util_percent0": 0.10670823317307693}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.09492187500000003, "cur_lr": 0.0010000000000000005, "total_loss": 0.7734292589768927, "policy_loss": -0.012879855357991752, "vf_loss": 0.7846227337966764, "vf_explained_var": 0.5948016095545984, "kl": 0.01776596963134533, "entropy": 0.348287621925595, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 81375.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 352000, "num_env_steps_trained": 352000, "num_agent_steps_sampled": 352000, "num_agent_steps_trained": 352000}, "sampler_results": {"episode_reward_max": -1.4000000000000008, "episode_reward_min": -71.30000000000034, "episode_reward_mean": -3.2192660550458765, "episode_len_mean": 37.43119266055046, "episode_media": {}, "episodes_this_iter": 109, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1.9000000000000012, -1.9000000000000012, -2.3000000000000016, -1.700000000000001, -1.5000000000000009, -2.0000000000000013, -1.8000000000000012, -1.4000000000000008, -1.9000000000000012, -1.5000000000000009, -2.0000000000000013, -1.700000000000001, -1.8000000000000012, -2.3000000000000016, -2.700000000000002, -1.9000000000000012, -2.3000000000000016, -1.8000000000000012, -2.900000000000002, -1.9000000000000012, -2.3000000000000016, -1.8000000000000012, -2.0000000000000013, -1.700000000000001, -2.0000000000000013, -2.0000000000000013, -2.700000000000002, -1.5000000000000009, -2.1000000000000014, -2.2000000000000015, -1.8000000000000012, -1.600000000000001, -1.8000000000000012, -1.5000000000000009, -1.5000000000000009, -1.600000000000001, -3.5, -2.3000000000000016, -1.8000000000000012, -2.1000000000000014, -2.0000000000000013, -1.600000000000001, -1.5000000000000009, -2.3000000000000016, -2.2000000000000015, -1.8000000000000012, -68.7000000000001, -2.600000000000002, -1.8000000000000012, -2.3000000000000016, -1.8000000000000012, -1.9000000000000012, -2.4000000000000017, -1.700000000000001, -1.9000000000000012, -1.700000000000001, -1.9000000000000012, -2.1000000000000014, -2.1000000000000014, -2.0000000000000013, -2.1000000000000014, -1.600000000000001, -2.5000000000000018, -2.1000000000000014, -2.4000000000000017, -1.8000000000000012, -1.600000000000001, -1.8000000000000012, -1.8000000000000012, -2.1000000000000014, -2.1000000000000014, -3.3000000000000007, -2.2000000000000015, -1.9000000000000012, -1.9000000000000012, -2.1000000000000014, -2.0000000000000013, -1.700000000000001, -2.0000000000000013, -1.8000000000000012, -1.9000000000000012, -1.700000000000001, -2.4000000000000017, -1.700000000000001, -1.9000000000000012, -1.8000000000000012, -2.1000000000000014, -1.700000000000001, -1.700000000000001, -2.2000000000000015, -1.700000000000001, -1.9000000000000012, -2.1000000000000014, -1.8000000000000012, -2.0000000000000013, -2.2000000000000015, -1.5000000000000009, -1.8000000000000012, -1.700000000000001, -71.30000000000034, -2.2000000000000015, -1.700000000000001, -1.600000000000001, -2.700000000000002, -1.700000000000001, -1.600000000000001, -1.9000000000000012, -2.3000000000000016, -2.0000000000000013], "episode_lengths": [30, 30, 34, 28, 26, 31, 29, 25, 30, 26, 31, 28, 29, 34, 38, 30, 34, 29, 35, 30, 34, 29, 31, 28, 31, 31, 38, 26, 32, 33, 29, 27, 29, 26, 26, 27, 46, 34, 29, 32, 31, 27, 26, 34, 33, 29, 400, 37, 29, 34, 29, 30, 35, 28, 30, 28, 30, 32, 32, 31, 32, 27, 36, 32, 35, 29, 27, 29, 29, 32, 32, 43, 33, 30, 30, 32, 31, 28, 31, 29, 30, 28, 35, 28, 30, 29, 32, 28, 28, 33, 28, 30, 32, 29, 31, 33, 26, 29, 28, 400, 33, 28, 27, 38, 28, 27, 30, 34, 31]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3517653764102321, "mean_inference_ms": 0.7297959548358329, "mean_action_processing_ms": 0.07580656579760872, "mean_env_wait_ms": 7.0792420685338655, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006594570404892668, "StateBufferConnector_ms": 0.003761545233770248, "ViewRequirementAgentConnector_ms": 0.08548202864620663}}, "episode_reward_max": -1.4000000000000008, "episode_reward_min": -71.30000000000034, "episode_reward_mean": -3.2192660550458765, "episode_len_mean": 37.43119266055046, "episodes_this_iter": 109, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1.9000000000000012, -1.9000000000000012, -2.3000000000000016, -1.700000000000001, -1.5000000000000009, -2.0000000000000013, -1.8000000000000012, -1.4000000000000008, -1.9000000000000012, -1.5000000000000009, -2.0000000000000013, -1.700000000000001, -1.8000000000000012, -2.3000000000000016, -2.700000000000002, -1.9000000000000012, -2.3000000000000016, -1.8000000000000012, -2.900000000000002, -1.9000000000000012, -2.3000000000000016, -1.8000000000000012, -2.0000000000000013, -1.700000000000001, -2.0000000000000013, -2.0000000000000013, -2.700000000000002, -1.5000000000000009, -2.1000000000000014, -2.2000000000000015, -1.8000000000000012, -1.600000000000001, -1.8000000000000012, -1.5000000000000009, -1.5000000000000009, -1.600000000000001, -3.5, -2.3000000000000016, -1.8000000000000012, -2.1000000000000014, -2.0000000000000013, -1.600000000000001, -1.5000000000000009, -2.3000000000000016, -2.2000000000000015, -1.8000000000000012, -68.7000000000001, -2.600000000000002, -1.8000000000000012, -2.3000000000000016, -1.8000000000000012, -1.9000000000000012, -2.4000000000000017, -1.700000000000001, -1.9000000000000012, -1.700000000000001, -1.9000000000000012, -2.1000000000000014, -2.1000000000000014, -2.0000000000000013, -2.1000000000000014, -1.600000000000001, -2.5000000000000018, -2.1000000000000014, -2.4000000000000017, -1.8000000000000012, -1.600000000000001, -1.8000000000000012, -1.8000000000000012, -2.1000000000000014, -2.1000000000000014, -3.3000000000000007, -2.2000000000000015, -1.9000000000000012, -1.9000000000000012, -2.1000000000000014, -2.0000000000000013, -1.700000000000001, -2.0000000000000013, -1.8000000000000012, -1.9000000000000012, -1.700000000000001, -2.4000000000000017, -1.700000000000001, -1.9000000000000012, -1.8000000000000012, -2.1000000000000014, -1.700000000000001, -1.700000000000001, -2.2000000000000015, -1.700000000000001, -1.9000000000000012, -2.1000000000000014, -1.8000000000000012, -2.0000000000000013, -2.2000000000000015, -1.5000000000000009, -1.8000000000000012, -1.700000000000001, -71.30000000000034, -2.2000000000000015, -1.700000000000001, -1.600000000000001, -2.700000000000002, -1.700000000000001, -1.600000000000001, -1.9000000000000012, -2.3000000000000016, -2.0000000000000013], "episode_lengths": [30, 30, 34, 28, 26, 31, 29, 25, 30, 26, 31, 28, 29, 34, 38, 30, 34, 29, 35, 30, 34, 29, 31, 28, 31, 31, 38, 26, 32, 33, 29, 27, 29, 26, 26, 27, 46, 34, 29, 32, 31, 27, 26, 34, 33, 29, 400, 37, 29, 34, 29, 30, 35, 28, 30, 28, 30, 32, 32, 31, 32, 27, 36, 32, 35, 29, 27, 29, 29, 32, 32, 43, 33, 30, 30, 32, 31, 28, 31, 29, 30, 28, 35, 28, 30, 29, 32, 28, 28, 33, 28, 30, 32, 29, 31, 33, 26, 29, 28, 400, 33, 28, 27, 38, 28, 27, 30, 34, 31]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3517653764102321, "mean_inference_ms": 0.7297959548358329, "mean_action_processing_ms": 0.07580656579760872, "mean_env_wait_ms": 7.0792420685338655, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006594570404892668, "StateBufferConnector_ms": 0.003761545233770248, "ViewRequirementAgentConnector_ms": 0.08548202864620663}, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 352000, "num_agent_steps_trained": 352000, "num_env_steps_sampled": 352000, "num_env_steps_trained": 352000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 417.24669768300623, "num_env_steps_trained_throughput_per_sec": 417.24669768300623, "timesteps_total": 352000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 352000, "timers": {"training_iteration_time_ms": 9528.312, "sample_time_ms": 5985.525, "load_time_ms": 1.001, "load_throughput": 3996954.378, "learn_time_ms": 3537.669, "learn_throughput": 1130.688, "synch_weights_time_ms": 3.435}, "counters": {"num_env_steps_sampled": 352000, "num_env_steps_trained": 352000, "num_agent_steps_sampled": 352000, "num_agent_steps_trained": 352000}, "done": false, "episodes_total": 7295, "training_iteration": 88, "trial_id": "ddfb6_00000", "date": "2024-03-07_13-02-15", "timestamp": 1709834535, "time_this_iter_s": 9.590272903442383, "time_total_s": 835.2509133815765, "pid": 112355, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4d85689f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 835.2509133815765, "iterations_since_restore": 88, "perf": {"cpu_util_percent": 25.746153846153845, "ram_util_percent": 47.79999999999999, "gpu_util_percent0": 0.06769230769230769, "vram_util_percent0": 0.10670823317307693}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.09492187500000003, "cur_lr": 0.0010000000000000005, "total_loss": 0.2903669360424242, "policy_loss": -0.005756977693207803, "vf_loss": 0.2954254510942646, "vf_explained_var": 0.8703381506345605, "kl": 0.007358332533852668, "entropy": 0.3703995165004525, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 82305.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 356000, "num_env_steps_trained": 356000, "num_agent_steps_sampled": 356000, "num_agent_steps_trained": 356000}, "sampler_results": {"episode_reward_max": -1.5000000000000009, "episode_reward_min": -74.50000000000053, "episode_reward_mean": -2.6827868852459074, "episode_len_mean": 34.71311475409836, "episode_media": {}, "episodes_this_iter": 122, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2.0000000000000013, -1.9000000000000012, -1.5000000000000009, -2.4000000000000017, -2.700000000000002, -2.3000000000000016, -2.2000000000000015, -1.9000000000000012, -2.3000000000000016, -2.700000000000002, -1.9000000000000012, -2.1000000000000014, -2.0000000000000013, -1.8000000000000012, -2.3000000000000016, -1.8000000000000012, -2.600000000000002, -1.700000000000001, -2.5000000000000018, -2.4000000000000017, -2.1000000000000014, -1.8000000000000012, -1.700000000000001, -1.9000000000000012, -2.0000000000000013, -2.4000000000000017, -2.5000000000000018, -1.600000000000001, -2.0000000000000013, -1.9000000000000012, -1.600000000000001, -1.8000000000000012, -2.1000000000000014, -1.600000000000001, -2.2000000000000015, -2.4000000000000017, -2.2000000000000015, -1.9000000000000012, -1.9000000000000012, -1.600000000000001, -2.3000000000000016, -2.5000000000000018, -2.4000000000000017, -1.9000000000000012, -2.2000000000000015, -1.8000000000000012, -2.2000000000000015, -2.4000000000000017, -1.700000000000001, -2.3000000000000016, -1.700000000000001, -2.4000000000000017, -2.1000000000000014, -2.4000000000000017, -1.8000000000000012, -2.0000000000000013, -1.700000000000001, -1.700000000000001, -2.600000000000002, -2.3000000000000016, -2.1000000000000014, -1.9000000000000012, -1.8000000000000012, -1.700000000000001, -1.9000000000000012, -1.8000000000000012, -2.0000000000000013, -1.5000000000000009, -2.3000000000000016, -2.1000000000000014, -2.1000000000000014, -2.2000000000000015, -1.5000000000000009, -2.5000000000000018, -2.0000000000000013, -1.600000000000001, -1.5000000000000009, -2.0000000000000013, -2.3000000000000016, -1.600000000000001, -1.700000000000001, -2.1000000000000014, -1.9000000000000012, -2.0000000000000013, -1.8000000000000012, -2.700000000000002, -2.3000000000000016, -2.2000000000000015, -2.4000000000000017, -1.8000000000000012, -1.9000000000000012, -1.8000000000000012, -2.0000000000000013, -1.600000000000001, -2.1000000000000014, -2.600000000000002, -2.2000000000000015, -1.700000000000001, -2.800000000000002, -1.700000000000001, -5.200000000000003, -1.8000000000000012, -1.600000000000001, -2.2000000000000015, -74.50000000000053, -2.4000000000000017, -1.8000000000000012, -2.1000000000000014, -2.4000000000000017, -1.8000000000000012, -2.1000000000000014, -2.3000000000000016, -2.700000000000002, -2.2000000000000015, -2.800000000000002, -2.0000000000000013, -2.2000000000000015, -2.1000000000000014, -2.2000000000000015, -3.1000000000000014, -1.700000000000001, -1.8000000000000012], "episode_lengths": [31, 30, 26, 35, 38, 34, 33, 30, 34, 38, 30, 32, 31, 29, 34, 29, 37, 28, 36, 35, 32, 29, 28, 30, 31, 35, 36, 27, 31, 30, 27, 29, 32, 27, 33, 35, 33, 30, 30, 27, 34, 36, 35, 30, 33, 29, 33, 35, 28, 34, 28, 35, 32, 35, 29, 31, 28, 28, 37, 34, 32, 30, 29, 28, 30, 29, 31, 26, 34, 32, 32, 33, 26, 36, 31, 27, 26, 31, 34, 27, 28, 32, 30, 31, 29, 38, 34, 33, 35, 29, 30, 29, 31, 27, 32, 37, 33, 28, 37, 28, 46, 29, 27, 33, 400, 35, 29, 32, 35, 29, 32, 34, 38, 33, 39, 31, 33, 32, 33, 37, 28, 29]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3523094357109219, "mean_inference_ms": 0.7298817049491146, "mean_action_processing_ms": 0.07587367165951737, "mean_env_wait_ms": 7.094007911258119, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0064994468063604635, "StateBufferConnector_ms": 0.0037476664683857904, "ViewRequirementAgentConnector_ms": 0.0857898446380115}}, "episode_reward_max": -1.5000000000000009, "episode_reward_min": -74.50000000000053, "episode_reward_mean": -2.6827868852459074, "episode_len_mean": 34.71311475409836, "episodes_this_iter": 122, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-2.0000000000000013, -1.9000000000000012, -1.5000000000000009, -2.4000000000000017, -2.700000000000002, -2.3000000000000016, -2.2000000000000015, -1.9000000000000012, -2.3000000000000016, -2.700000000000002, -1.9000000000000012, -2.1000000000000014, -2.0000000000000013, -1.8000000000000012, -2.3000000000000016, -1.8000000000000012, -2.600000000000002, -1.700000000000001, -2.5000000000000018, -2.4000000000000017, -2.1000000000000014, -1.8000000000000012, -1.700000000000001, -1.9000000000000012, -2.0000000000000013, -2.4000000000000017, -2.5000000000000018, -1.600000000000001, -2.0000000000000013, -1.9000000000000012, -1.600000000000001, -1.8000000000000012, -2.1000000000000014, -1.600000000000001, -2.2000000000000015, -2.4000000000000017, -2.2000000000000015, -1.9000000000000012, -1.9000000000000012, -1.600000000000001, -2.3000000000000016, -2.5000000000000018, -2.4000000000000017, -1.9000000000000012, -2.2000000000000015, -1.8000000000000012, -2.2000000000000015, -2.4000000000000017, -1.700000000000001, -2.3000000000000016, -1.700000000000001, -2.4000000000000017, -2.1000000000000014, -2.4000000000000017, -1.8000000000000012, -2.0000000000000013, -1.700000000000001, -1.700000000000001, -2.600000000000002, -2.3000000000000016, -2.1000000000000014, -1.9000000000000012, -1.8000000000000012, -1.700000000000001, -1.9000000000000012, -1.8000000000000012, -2.0000000000000013, -1.5000000000000009, -2.3000000000000016, -2.1000000000000014, -2.1000000000000014, -2.2000000000000015, -1.5000000000000009, -2.5000000000000018, -2.0000000000000013, -1.600000000000001, -1.5000000000000009, -2.0000000000000013, -2.3000000000000016, -1.600000000000001, -1.700000000000001, -2.1000000000000014, -1.9000000000000012, -2.0000000000000013, -1.8000000000000012, -2.700000000000002, -2.3000000000000016, -2.2000000000000015, -2.4000000000000017, -1.8000000000000012, -1.9000000000000012, -1.8000000000000012, -2.0000000000000013, -1.600000000000001, -2.1000000000000014, -2.600000000000002, -2.2000000000000015, -1.700000000000001, -2.800000000000002, -1.700000000000001, -5.200000000000003, -1.8000000000000012, -1.600000000000001, -2.2000000000000015, -74.50000000000053, -2.4000000000000017, -1.8000000000000012, -2.1000000000000014, -2.4000000000000017, -1.8000000000000012, -2.1000000000000014, -2.3000000000000016, -2.700000000000002, -2.2000000000000015, -2.800000000000002, -2.0000000000000013, -2.2000000000000015, -2.1000000000000014, -2.2000000000000015, -3.1000000000000014, -1.700000000000001, -1.8000000000000012], "episode_lengths": [31, 30, 26, 35, 38, 34, 33, 30, 34, 38, 30, 32, 31, 29, 34, 29, 37, 28, 36, 35, 32, 29, 28, 30, 31, 35, 36, 27, 31, 30, 27, 29, 32, 27, 33, 35, 33, 30, 30, 27, 34, 36, 35, 30, 33, 29, 33, 35, 28, 34, 28, 35, 32, 35, 29, 31, 28, 28, 37, 34, 32, 30, 29, 28, 30, 29, 31, 26, 34, 32, 32, 33, 26, 36, 31, 27, 26, 31, 34, 27, 28, 32, 30, 31, 29, 38, 34, 33, 35, 29, 30, 29, 31, 27, 32, 37, 33, 28, 37, 28, 46, 29, 27, 33, 400, 35, 29, 32, 35, 29, 32, 34, 38, 33, 39, 31, 33, 32, 33, 37, 28, 29]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3523094357109219, "mean_inference_ms": 0.7298817049491146, "mean_action_processing_ms": 0.07587367165951737, "mean_env_wait_ms": 7.094007911258119, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0064994468063604635, "StateBufferConnector_ms": 0.0037476664683857904, "ViewRequirementAgentConnector_ms": 0.0857898446380115}, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 356000, "num_agent_steps_trained": 356000, "num_env_steps_sampled": 356000, "num_env_steps_trained": 356000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 422.64935028292354, "num_env_steps_trained_throughput_per_sec": 422.64935028292354, "timesteps_total": 356000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 356000, "timers": {"training_iteration_time_ms": 9537.983, "sample_time_ms": 5994.464, "load_time_ms": 1.002, "load_throughput": 3993149.113, "learn_time_ms": 3538.393, "learn_throughput": 1130.457, "synch_weights_time_ms": 3.449}, "counters": {"num_env_steps_sampled": 356000, "num_env_steps_trained": 356000, "num_agent_steps_sampled": 356000, "num_agent_steps_trained": 356000}, "done": false, "episodes_total": 7417, "training_iteration": 89, "trial_id": "ddfb6_00000", "date": "2024-03-07_13-02-25", "timestamp": 1709834545, "time_this_iter_s": 9.466906070709229, "time_total_s": 844.7178194522858, "pid": 112355, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4d85689f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 844.7178194522858, "iterations_since_restore": 89, "perf": {"cpu_util_percent": 26.78333333333333, "ram_util_percent": 47.775000000000006, "gpu_util_percent0": 0.065, "vram_util_percent0": 0.10670301649305554}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.09492187500000003, "cur_lr": 0.0010000000000000005, "total_loss": 0.016432253323290097, "policy_loss": -0.008424023382606045, "vf_loss": 0.02339478677178743, "vf_explained_var": 0.9746190303115434, "kl": 0.015396773255345551, "entropy": 0.3066533100220465, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 83235.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 360000, "num_env_steps_trained": 360000, "num_agent_steps_sampled": 360000, "num_agent_steps_trained": 360000}, "sampler_results": {"episode_reward_max": -1.4000000000000008, "episode_reward_min": -2.800000000000002, "episode_reward_mean": -2.0030769230769248, "episode_len_mean": 31.023076923076925, "episode_media": {}, "episodes_this_iter": 130, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2.4000000000000017, -1.600000000000001, -1.9000000000000012, -1.9000000000000012, -2.3000000000000016, -1.9000000000000012, -1.9000000000000012, -2.4000000000000017, -1.9000000000000012, -2.1000000000000014, -1.5000000000000009, -1.9000000000000012, -2.3000000000000016, -2.2000000000000015, -1.9000000000000012, -1.9000000000000012, -2.2000000000000015, -2.700000000000002, -2.2000000000000015, -2.2000000000000015, -2.1000000000000014, -1.600000000000001, -2.3000000000000016, -2.2000000000000015, -1.9000000000000012, -2.1000000000000014, -1.8000000000000012, -2.3000000000000016, -2.700000000000002, -2.4000000000000017, -1.700000000000001, -2.5000000000000018, -1.9000000000000012, -1.9000000000000012, -1.8000000000000012, -2.0000000000000013, -1.700000000000001, -1.5000000000000009, -2.1000000000000014, -2.0000000000000013, -1.700000000000001, -2.5000000000000018, -2.1000000000000014, -2.0000000000000013, -2.0000000000000013, -2.1000000000000014, -1.700000000000001, -1.9000000000000012, -2.3000000000000016, -2.3000000000000016, -2.0000000000000013, -1.600000000000001, -2.0000000000000013, -2.0000000000000013, -1.9000000000000012, -1.600000000000001, -1.700000000000001, -2.1000000000000014, -2.3000000000000016, -2.0000000000000013, -1.9000000000000012, -2.4000000000000017, -2.600000000000002, -1.700000000000001, -1.9000000000000012, -2.1000000000000014, -2.1000000000000014, -2.3000000000000016, -1.8000000000000012, -1.8000000000000012, -1.8000000000000012, -2.1000000000000014, -1.8000000000000012, -1.9000000000000012, -1.8000000000000012, -1.9000000000000012, -1.9000000000000012, -1.700000000000001, -1.9000000000000012, -2.2000000000000015, -1.600000000000001, -1.9000000000000012, -2.3000000000000016, -1.5000000000000009, -1.700000000000001, -1.4000000000000008, -2.0000000000000013, -2.5000000000000018, -1.600000000000001, -1.700000000000001, -1.700000000000001, -1.700000000000001, -2.1000000000000014, -1.700000000000001, -2.4000000000000017, -2.1000000000000014, -2.2000000000000015, -1.5000000000000009, -1.9000000000000012, -2.0000000000000013, -2.0000000000000013, -1.700000000000001, -2.700000000000002, -2.2000000000000015, -2.4000000000000017, -2.0000000000000013, -2.2000000000000015, -2.4000000000000017, -2.1000000000000014, -2.0000000000000013, -2.0000000000000013, -2.2000000000000015, -1.9000000000000012, -2.1000000000000014, -2.0000000000000013, -2.0000000000000013, -1.9000000000000012, -2.0000000000000013, -2.1000000000000014, -1.8000000000000012, -1.8000000000000012, -1.700000000000001, -1.5000000000000009, -1.8000000000000012, -2.1000000000000014, -2.800000000000002, -1.9000000000000012, -2.5000000000000018, -2.1000000000000014, -1.8000000000000012], "episode_lengths": [35, 27, 30, 30, 34, 30, 30, 35, 30, 32, 26, 30, 34, 33, 30, 30, 33, 38, 33, 33, 32, 27, 34, 33, 30, 32, 29, 34, 38, 35, 28, 36, 30, 30, 29, 31, 28, 26, 32, 31, 28, 36, 32, 31, 31, 32, 28, 30, 34, 34, 31, 27, 31, 31, 30, 27, 28, 32, 34, 31, 30, 35, 37, 28, 30, 32, 32, 34, 29, 29, 29, 32, 29, 30, 29, 30, 30, 28, 30, 33, 27, 30, 34, 26, 28, 25, 31, 36, 27, 28, 28, 28, 32, 28, 35, 32, 33, 26, 30, 31, 31, 28, 38, 33, 34, 31, 33, 35, 32, 31, 31, 33, 30, 32, 31, 31, 30, 31, 32, 29, 29, 28, 26, 29, 32, 39, 30, 36, 32, 29]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.35290809514640376, "mean_inference_ms": 0.7295652767946168, "mean_action_processing_ms": 0.07583036506859028, "mean_env_wait_ms": 7.097263370169025, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006600343264066256, "StateBufferConnector_ms": 0.003780218271108774, "ViewRequirementAgentConnector_ms": 0.08667285625751202}}, "episode_reward_max": -1.4000000000000008, "episode_reward_min": -2.800000000000002, "episode_reward_mean": -2.0030769230769248, "episode_len_mean": 31.023076923076925, "episodes_this_iter": 130, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-2.4000000000000017, -1.600000000000001, -1.9000000000000012, -1.9000000000000012, -2.3000000000000016, -1.9000000000000012, -1.9000000000000012, -2.4000000000000017, -1.9000000000000012, -2.1000000000000014, -1.5000000000000009, -1.9000000000000012, -2.3000000000000016, -2.2000000000000015, -1.9000000000000012, -1.9000000000000012, -2.2000000000000015, -2.700000000000002, -2.2000000000000015, -2.2000000000000015, -2.1000000000000014, -1.600000000000001, -2.3000000000000016, -2.2000000000000015, -1.9000000000000012, -2.1000000000000014, -1.8000000000000012, -2.3000000000000016, -2.700000000000002, -2.4000000000000017, -1.700000000000001, -2.5000000000000018, -1.9000000000000012, -1.9000000000000012, -1.8000000000000012, -2.0000000000000013, -1.700000000000001, -1.5000000000000009, -2.1000000000000014, -2.0000000000000013, -1.700000000000001, -2.5000000000000018, -2.1000000000000014, -2.0000000000000013, -2.0000000000000013, -2.1000000000000014, -1.700000000000001, -1.9000000000000012, -2.3000000000000016, -2.3000000000000016, -2.0000000000000013, -1.600000000000001, -2.0000000000000013, -2.0000000000000013, -1.9000000000000012, -1.600000000000001, -1.700000000000001, -2.1000000000000014, -2.3000000000000016, -2.0000000000000013, -1.9000000000000012, -2.4000000000000017, -2.600000000000002, -1.700000000000001, -1.9000000000000012, -2.1000000000000014, -2.1000000000000014, -2.3000000000000016, -1.8000000000000012, -1.8000000000000012, -1.8000000000000012, -2.1000000000000014, -1.8000000000000012, -1.9000000000000012, -1.8000000000000012, -1.9000000000000012, -1.9000000000000012, -1.700000000000001, -1.9000000000000012, -2.2000000000000015, -1.600000000000001, -1.9000000000000012, -2.3000000000000016, -1.5000000000000009, -1.700000000000001, -1.4000000000000008, -2.0000000000000013, -2.5000000000000018, -1.600000000000001, -1.700000000000001, -1.700000000000001, -1.700000000000001, -2.1000000000000014, -1.700000000000001, -2.4000000000000017, -2.1000000000000014, -2.2000000000000015, -1.5000000000000009, -1.9000000000000012, -2.0000000000000013, -2.0000000000000013, -1.700000000000001, -2.700000000000002, -2.2000000000000015, -2.4000000000000017, -2.0000000000000013, -2.2000000000000015, -2.4000000000000017, -2.1000000000000014, -2.0000000000000013, -2.0000000000000013, -2.2000000000000015, -1.9000000000000012, -2.1000000000000014, -2.0000000000000013, -2.0000000000000013, -1.9000000000000012, -2.0000000000000013, -2.1000000000000014, -1.8000000000000012, -1.8000000000000012, -1.700000000000001, -1.5000000000000009, -1.8000000000000012, -2.1000000000000014, -2.800000000000002, -1.9000000000000012, -2.5000000000000018, -2.1000000000000014, -1.8000000000000012], "episode_lengths": [35, 27, 30, 30, 34, 30, 30, 35, 30, 32, 26, 30, 34, 33, 30, 30, 33, 38, 33, 33, 32, 27, 34, 33, 30, 32, 29, 34, 38, 35, 28, 36, 30, 30, 29, 31, 28, 26, 32, 31, 28, 36, 32, 31, 31, 32, 28, 30, 34, 34, 31, 27, 31, 31, 30, 27, 28, 32, 34, 31, 30, 35, 37, 28, 30, 32, 32, 34, 29, 29, 29, 32, 29, 30, 29, 30, 30, 28, 30, 33, 27, 30, 34, 26, 28, 25, 31, 36, 27, 28, 28, 28, 32, 28, 35, 32, 33, 26, 30, 31, 31, 28, 38, 33, 34, 31, 33, 35, 32, 31, 31, 33, 30, 32, 31, 31, 30, 31, 32, 29, 29, 28, 26, 29, 32, 39, 30, 36, 32, 29]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.35290809514640376, "mean_inference_ms": 0.7295652767946168, "mean_action_processing_ms": 0.07583036506859028, "mean_env_wait_ms": 7.097263370169025, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006600343264066256, "StateBufferConnector_ms": 0.003780218271108774, "ViewRequirementAgentConnector_ms": 0.08667285625751202}, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 360000, "num_agent_steps_trained": 360000, "num_env_steps_sampled": 360000, "num_env_steps_trained": 360000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 427.314436822258, "num_env_steps_trained_throughput_per_sec": 427.314436822258, "timesteps_total": 360000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 360000, "timers": {"training_iteration_time_ms": 9549.175, "sample_time_ms": 5995.02, "load_time_ms": 1.038, "load_throughput": 3855413.181, "learn_time_ms": 3548.976, "learn_throughput": 1127.086, "synch_weights_time_ms": 3.456}, "counters": {"num_env_steps_sampled": 360000, "num_env_steps_trained": 360000, "num_agent_steps_sampled": 360000, "num_agent_steps_trained": 360000}, "done": false, "episodes_total": 7547, "training_iteration": 90, "trial_id": "ddfb6_00000", "date": "2024-03-07_13-02-34", "timestamp": 1709834554, "time_this_iter_s": 9.363664388656616, "time_total_s": 854.0814838409424, "pid": 112355, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4d85689f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 854.0814838409424, "iterations_since_restore": 90, "perf": {"cpu_util_percent": 27.174999999999997, "ram_util_percent": 47.73333333333334, "gpu_util_percent0": 0.05833333333333333, "vram_util_percent0": 0.10670301649305554}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.09492187500000003, "cur_lr": 0.0010000000000000005, "total_loss": 0.5200087441672241, "policy_loss": -0.009789704006686006, "vf_loss": 0.5288470736221581, "vf_explained_var": 0.817429232148714, "kl": 0.010022666035161762, "entropy": 0.29039904361851115, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 84165.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 364000, "num_env_steps_trained": 364000, "num_agent_steps_sampled": 364000, "num_agent_steps_trained": 364000}, "sampler_results": {"episode_reward_max": -1.4000000000000008, "episode_reward_min": -77.40000000000056, "episode_reward_mean": -2.452419354838715, "episode_len_mean": 32.41129032258065, "episode_media": {}, "episodes_this_iter": 124, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1.8000000000000012, -1.9000000000000012, -1.9000000000000012, -1.700000000000001, -2.0000000000000013, -2.1000000000000014, -2.1000000000000014, -1.8000000000000012, -1.600000000000001, -2.3000000000000016, -1.8000000000000012, -2.0000000000000013, -1.5000000000000009, -1.700000000000001, -1.9000000000000012, -1.600000000000001, -1.9000000000000012, -1.9000000000000012, -2.0000000000000013, -1.5000000000000009, -2.0000000000000013, -1.8000000000000012, -1.600000000000001, -2.1000000000000014, -1.5000000000000009, -1.4000000000000008, -2.2000000000000015, -1.600000000000001, -1.5000000000000009, -2.2000000000000015, -1.9000000000000012, -1.700000000000001, -1.8000000000000012, -2.2000000000000015, -1.5000000000000009, -1.8000000000000012, -1.600000000000001, -1.600000000000001, -1.700000000000001, -1.8000000000000012, -1.4000000000000008, -2.1000000000000014, -2.0000000000000013, -1.4000000000000008, -1.8000000000000012, -2.1000000000000014, -1.600000000000001, -2.3000000000000016, -1.9000000000000012, -2.1000000000000014, -2.4000000000000017, -1.700000000000001, -1.9000000000000012, -2.700000000000002, -1.700000000000001, -1.4000000000000008, -1.9000000000000012, -1.5000000000000009, -2.0000000000000013, -2.0000000000000013, -1.9000000000000012, -1.9000000000000012, -1.9000000000000012, -1.700000000000001, -1.4000000000000008, -1.700000000000001, -1.9000000000000012, -1.8000000000000012, -2.1000000000000014, -1.700000000000001, -1.600000000000001, -1.700000000000001, -1.5000000000000009, -2.3000000000000016, -1.600000000000001, -2.0000000000000013, -1.700000000000001, -1.600000000000001, -2.2000000000000015, -1.600000000000001, -2.1000000000000014, -2.1000000000000014, -1.5000000000000009, -1.700000000000001, -2.0000000000000013, -1.700000000000001, -2.0000000000000013, -1.8000000000000012, -1.8000000000000012, -1.9000000000000012, -2.0000000000000013, -1.8000000000000012, -77.40000000000056, -2.2000000000000015, -2.0000000000000013, -2.0000000000000013, -1.8000000000000012, -1.600000000000001, -1.8000000000000012, -1.700000000000001, -1.9000000000000012, -1.700000000000001, -1.700000000000001, -1.5000000000000009, -1.4000000000000008, -2.0000000000000013, -2.0000000000000013, -2.0000000000000013, -2.5000000000000018, -1.8000000000000012, -2.0000000000000013, -1.700000000000001, -1.700000000000001, -1.8000000000000012, -2.4000000000000017, -2.0000000000000013, -1.700000000000001, -2.1000000000000014, -1.700000000000001, -1.9000000000000012, -2.3000000000000016, -1.8000000000000012, -1.9000000000000012, -1.5000000000000009], "episode_lengths": [29, 30, 30, 28, 31, 32, 32, 29, 27, 34, 29, 31, 26, 28, 30, 27, 30, 30, 31, 26, 31, 29, 27, 32, 26, 25, 33, 27, 26, 33, 30, 28, 29, 33, 26, 29, 27, 27, 28, 29, 25, 32, 31, 25, 29, 32, 27, 34, 30, 32, 35, 28, 30, 37, 28, 25, 30, 26, 31, 31, 30, 30, 30, 28, 25, 28, 30, 29, 32, 28, 27, 28, 26, 34, 27, 31, 28, 27, 33, 27, 32, 32, 26, 28, 31, 28, 31, 29, 29, 30, 31, 29, 400, 33, 31, 31, 29, 27, 29, 28, 30, 28, 28, 26, 25, 31, 31, 31, 36, 29, 31, 28, 28, 29, 35, 31, 28, 32, 28, 30, 34, 29, 30, 26]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3534733571453211, "mean_inference_ms": 0.7295861285807445, "mean_action_processing_ms": 0.07584514048427739, "mean_env_wait_ms": 7.10613436730886, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0065247858724286475, "StateBufferConnector_ms": 0.0037275975750338647, "ViewRequirementAgentConnector_ms": 0.08659555066016413}}, "episode_reward_max": -1.4000000000000008, "episode_reward_min": -77.40000000000056, "episode_reward_mean": -2.452419354838715, "episode_len_mean": 32.41129032258065, "episodes_this_iter": 124, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1.8000000000000012, -1.9000000000000012, -1.9000000000000012, -1.700000000000001, -2.0000000000000013, -2.1000000000000014, -2.1000000000000014, -1.8000000000000012, -1.600000000000001, -2.3000000000000016, -1.8000000000000012, -2.0000000000000013, -1.5000000000000009, -1.700000000000001, -1.9000000000000012, -1.600000000000001, -1.9000000000000012, -1.9000000000000012, -2.0000000000000013, -1.5000000000000009, -2.0000000000000013, -1.8000000000000012, -1.600000000000001, -2.1000000000000014, -1.5000000000000009, -1.4000000000000008, -2.2000000000000015, -1.600000000000001, -1.5000000000000009, -2.2000000000000015, -1.9000000000000012, -1.700000000000001, -1.8000000000000012, -2.2000000000000015, -1.5000000000000009, -1.8000000000000012, -1.600000000000001, -1.600000000000001, -1.700000000000001, -1.8000000000000012, -1.4000000000000008, -2.1000000000000014, -2.0000000000000013, -1.4000000000000008, -1.8000000000000012, -2.1000000000000014, -1.600000000000001, -2.3000000000000016, -1.9000000000000012, -2.1000000000000014, -2.4000000000000017, -1.700000000000001, -1.9000000000000012, -2.700000000000002, -1.700000000000001, -1.4000000000000008, -1.9000000000000012, -1.5000000000000009, -2.0000000000000013, -2.0000000000000013, -1.9000000000000012, -1.9000000000000012, -1.9000000000000012, -1.700000000000001, -1.4000000000000008, -1.700000000000001, -1.9000000000000012, -1.8000000000000012, -2.1000000000000014, -1.700000000000001, -1.600000000000001, -1.700000000000001, -1.5000000000000009, -2.3000000000000016, -1.600000000000001, -2.0000000000000013, -1.700000000000001, -1.600000000000001, -2.2000000000000015, -1.600000000000001, -2.1000000000000014, -2.1000000000000014, -1.5000000000000009, -1.700000000000001, -2.0000000000000013, -1.700000000000001, -2.0000000000000013, -1.8000000000000012, -1.8000000000000012, -1.9000000000000012, -2.0000000000000013, -1.8000000000000012, -77.40000000000056, -2.2000000000000015, -2.0000000000000013, -2.0000000000000013, -1.8000000000000012, -1.600000000000001, -1.8000000000000012, -1.700000000000001, -1.9000000000000012, -1.700000000000001, -1.700000000000001, -1.5000000000000009, -1.4000000000000008, -2.0000000000000013, -2.0000000000000013, -2.0000000000000013, -2.5000000000000018, -1.8000000000000012, -2.0000000000000013, -1.700000000000001, -1.700000000000001, -1.8000000000000012, -2.4000000000000017, -2.0000000000000013, -1.700000000000001, -2.1000000000000014, -1.700000000000001, -1.9000000000000012, -2.3000000000000016, -1.8000000000000012, -1.9000000000000012, -1.5000000000000009], "episode_lengths": [29, 30, 30, 28, 31, 32, 32, 29, 27, 34, 29, 31, 26, 28, 30, 27, 30, 30, 31, 26, 31, 29, 27, 32, 26, 25, 33, 27, 26, 33, 30, 28, 29, 33, 26, 29, 27, 27, 28, 29, 25, 32, 31, 25, 29, 32, 27, 34, 30, 32, 35, 28, 30, 37, 28, 25, 30, 26, 31, 31, 30, 30, 30, 28, 25, 28, 30, 29, 32, 28, 27, 28, 26, 34, 27, 31, 28, 27, 33, 27, 32, 32, 26, 28, 31, 28, 31, 29, 29, 30, 31, 29, 400, 33, 31, 31, 29, 27, 29, 28, 30, 28, 28, 26, 25, 31, 31, 31, 36, 29, 31, 28, 28, 29, 35, 31, 28, 32, 28, 30, 34, 29, 30, 26]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3534733571453211, "mean_inference_ms": 0.7295861285807445, "mean_action_processing_ms": 0.07584514048427739, "mean_env_wait_ms": 7.10613436730886, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0065247858724286475, "StateBufferConnector_ms": 0.0037275975750338647, "ViewRequirementAgentConnector_ms": 0.08659555066016413}, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 364000, "num_agent_steps_trained": 364000, "num_env_steps_sampled": 364000, "num_env_steps_trained": 364000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 426.6452159222443, "num_env_steps_trained_throughput_per_sec": 426.6452159222443, "timesteps_total": 364000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 364000, "timers": {"training_iteration_time_ms": 9557.469, "sample_time_ms": 6015.626, "load_time_ms": 1.039, "load_throughput": 3848161.842, "learn_time_ms": 3536.675, "learn_throughput": 1131.006, "synch_weights_time_ms": 3.445}, "counters": {"num_env_steps_sampled": 364000, "num_env_steps_trained": 364000, "num_agent_steps_sampled": 364000, "num_agent_steps_trained": 364000}, "done": false, "episodes_total": 7671, "training_iteration": 91, "trial_id": "ddfb6_00000", "date": "2024-03-07_13-02-43", "timestamp": 1709834563, "time_this_iter_s": 9.378323078155518, "time_total_s": 863.4598069190979, "pid": 112355, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4d85689f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 863.4598069190979, "iterations_since_restore": 91, "perf": {"cpu_util_percent": 27.341666666666672, "ram_util_percent": 47.78333333333333, "gpu_util_percent0": 0.06333333333333334, "vram_util_percent0": 0.10670301649305554}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.09492187500000003, "cur_lr": 0.0010000000000000005, "total_loss": 0.5531705037875962, "policy_loss": -0.007690433364722036, "vf_loss": 0.5597678551380272, "vf_explained_var": 0.8219878563316919, "kl": 0.01151559044877688, "entropy": 0.2686883203334786, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 85095.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 368000, "num_env_steps_trained": 368000, "num_agent_steps_sampled": 368000, "num_agent_steps_trained": 368000}, "sampler_results": {"episode_reward_max": -1.4000000000000008, "episode_reward_min": -77.00000000000055, "episode_reward_mean": -2.537500000000006, "episode_len_mean": 33.15833333333333, "episode_media": {}, "episodes_this_iter": 120, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2.4000000000000017, -1.8000000000000012, -2.1000000000000014, -1.8000000000000012, -1.9000000000000012, -1.9000000000000012, -2.1000000000000014, -77.00000000000055, -1.700000000000001, -2.1000000000000014, -1.9000000000000012, -1.8000000000000012, -1.700000000000001, -1.8000000000000012, -2.2000000000000015, -2.1000000000000014, -1.8000000000000012, -1.4000000000000008, -1.8000000000000012, -1.600000000000001, -2.0000000000000013, -1.700000000000001, -1.4000000000000008, -2.0000000000000013, -1.600000000000001, -2.2000000000000015, -2.1000000000000014, -2.0000000000000013, -2.1000000000000014, -1.8000000000000012, -1.8000000000000012, -1.9000000000000012, -1.9000000000000012, -2.0000000000000013, -1.8000000000000012, -1.700000000000001, -2.1000000000000014, -2.3000000000000016, -1.9000000000000012, -1.9000000000000012, -2.0000000000000013, -1.9000000000000012, -1.700000000000001, -2.600000000000002, -2.3000000000000016, -1.600000000000001, -1.9000000000000012, -1.8000000000000012, -1.700000000000001, -1.600000000000001, -1.9000000000000012, -1.4000000000000008, -1.700000000000001, -2.4000000000000017, -1.9000000000000012, -1.8000000000000012, -1.600000000000001, -2.2000000000000015, -2.4000000000000017, -1.8000000000000012, -1.4000000000000008, -2.0000000000000013, -1.700000000000001, -1.600000000000001, -2.1000000000000014, -1.700000000000001, -2.1000000000000014, -2.600000000000002, -2.1000000000000014, -2.1000000000000014, -2.0000000000000013, -1.5000000000000009, -1.700000000000001, -2.2000000000000015, -2.2000000000000015, -1.8000000000000012, -1.700000000000001, -1.600000000000001, -1.600000000000001, -1.600000000000001, -1.700000000000001, -2.1000000000000014, -2.600000000000002, -2.3000000000000016, -1.700000000000001, -1.8000000000000012, -1.600000000000001, -2.0000000000000013, -2.1000000000000014, -1.8000000000000012, -1.9000000000000012, -3.400000000000002, -2.3000000000000016, -2.4000000000000017, -1.8000000000000012, -2.1000000000000014, -1.5000000000000009, -1.600000000000001, -1.700000000000001, -1.700000000000001, -2.0000000000000013, -2.0000000000000013, -2.0000000000000013, -1.8000000000000012, -1.600000000000001, -2.2000000000000015, -2.4000000000000017, -1.9000000000000012, -1.8000000000000012, -2.0000000000000013, -1.9000000000000012, -1.8000000000000012, -1.9000000000000012, -1.9000000000000012, -1.700000000000001, -1.5000000000000009, -1.700000000000001, -2.3000000000000016, -1.600000000000001, -1.8000000000000012], "episode_lengths": [35, 29, 32, 29, 30, 30, 32, 400, 28, 32, 30, 29, 28, 29, 33, 32, 29, 25, 29, 27, 31, 28, 25, 31, 27, 33, 32, 31, 32, 29, 29, 30, 30, 31, 29, 28, 32, 34, 30, 30, 31, 30, 28, 37, 34, 27, 30, 29, 28, 27, 30, 25, 28, 35, 30, 29, 27, 33, 35, 29, 25, 31, 28, 27, 32, 28, 32, 37, 32, 32, 31, 26, 28, 33, 33, 29, 28, 27, 27, 27, 28, 32, 37, 34, 28, 29, 27, 31, 32, 29, 30, 40, 34, 35, 29, 32, 26, 27, 28, 28, 31, 31, 31, 29, 27, 33, 35, 30, 29, 31, 30, 29, 30, 30, 28, 26, 28, 34, 27, 29]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.35421230300166895, "mean_inference_ms": 0.7292547352226194, "mean_action_processing_ms": 0.07584604949036884, "mean_env_wait_ms": 7.118914285013712, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006734927495320638, "StateBufferConnector_ms": 0.0038874149322509766, "ViewRequirementAgentConnector_ms": 0.08752663930257161}}, "episode_reward_max": -1.4000000000000008, "episode_reward_min": -77.00000000000055, "episode_reward_mean": -2.537500000000006, "episode_len_mean": 33.15833333333333, "episodes_this_iter": 120, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-2.4000000000000017, -1.8000000000000012, -2.1000000000000014, -1.8000000000000012, -1.9000000000000012, -1.9000000000000012, -2.1000000000000014, -77.00000000000055, -1.700000000000001, -2.1000000000000014, -1.9000000000000012, -1.8000000000000012, -1.700000000000001, -1.8000000000000012, -2.2000000000000015, -2.1000000000000014, -1.8000000000000012, -1.4000000000000008, -1.8000000000000012, -1.600000000000001, -2.0000000000000013, -1.700000000000001, -1.4000000000000008, -2.0000000000000013, -1.600000000000001, -2.2000000000000015, -2.1000000000000014, -2.0000000000000013, -2.1000000000000014, -1.8000000000000012, -1.8000000000000012, -1.9000000000000012, -1.9000000000000012, -2.0000000000000013, -1.8000000000000012, -1.700000000000001, -2.1000000000000014, -2.3000000000000016, -1.9000000000000012, -1.9000000000000012, -2.0000000000000013, -1.9000000000000012, -1.700000000000001, -2.600000000000002, -2.3000000000000016, -1.600000000000001, -1.9000000000000012, -1.8000000000000012, -1.700000000000001, -1.600000000000001, -1.9000000000000012, -1.4000000000000008, -1.700000000000001, -2.4000000000000017, -1.9000000000000012, -1.8000000000000012, -1.600000000000001, -2.2000000000000015, -2.4000000000000017, -1.8000000000000012, -1.4000000000000008, -2.0000000000000013, -1.700000000000001, -1.600000000000001, -2.1000000000000014, -1.700000000000001, -2.1000000000000014, -2.600000000000002, -2.1000000000000014, -2.1000000000000014, -2.0000000000000013, -1.5000000000000009, -1.700000000000001, -2.2000000000000015, -2.2000000000000015, -1.8000000000000012, -1.700000000000001, -1.600000000000001, -1.600000000000001, -1.600000000000001, -1.700000000000001, -2.1000000000000014, -2.600000000000002, -2.3000000000000016, -1.700000000000001, -1.8000000000000012, -1.600000000000001, -2.0000000000000013, -2.1000000000000014, -1.8000000000000012, -1.9000000000000012, -3.400000000000002, -2.3000000000000016, -2.4000000000000017, -1.8000000000000012, -2.1000000000000014, -1.5000000000000009, -1.600000000000001, -1.700000000000001, -1.700000000000001, -2.0000000000000013, -2.0000000000000013, -2.0000000000000013, -1.8000000000000012, -1.600000000000001, -2.2000000000000015, -2.4000000000000017, -1.9000000000000012, -1.8000000000000012, -2.0000000000000013, -1.9000000000000012, -1.8000000000000012, -1.9000000000000012, -1.9000000000000012, -1.700000000000001, -1.5000000000000009, -1.700000000000001, -2.3000000000000016, -1.600000000000001, -1.8000000000000012], "episode_lengths": [35, 29, 32, 29, 30, 30, 32, 400, 28, 32, 30, 29, 28, 29, 33, 32, 29, 25, 29, 27, 31, 28, 25, 31, 27, 33, 32, 31, 32, 29, 29, 30, 30, 31, 29, 28, 32, 34, 30, 30, 31, 30, 28, 37, 34, 27, 30, 29, 28, 27, 30, 25, 28, 35, 30, 29, 27, 33, 35, 29, 25, 31, 28, 27, 32, 28, 32, 37, 32, 32, 31, 26, 28, 33, 33, 29, 28, 27, 27, 27, 28, 32, 37, 34, 28, 29, 27, 31, 32, 29, 30, 40, 34, 35, 29, 32, 26, 27, 28, 28, 31, 31, 31, 29, 27, 33, 35, 30, 29, 31, 30, 29, 30, 30, 28, 26, 28, 34, 27, 29]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.35421230300166895, "mean_inference_ms": 0.7292547352226194, "mean_action_processing_ms": 0.07584604949036884, "mean_env_wait_ms": 7.118914285013712, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006734927495320638, "StateBufferConnector_ms": 0.0038874149322509766, "ViewRequirementAgentConnector_ms": 0.08752663930257161}, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 368000, "num_agent_steps_trained": 368000, "num_env_steps_sampled": 368000, "num_env_steps_trained": 368000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 406.1778425951721, "num_env_steps_trained_throughput_per_sec": 406.1778425951721, "timesteps_total": 368000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 368000, "timers": {"training_iteration_time_ms": 9599.599, "sample_time_ms": 6068.349, "load_time_ms": 1.034, "load_throughput": 3869551.86, "learn_time_ms": 3526.08, "learn_throughput": 1134.404, "synch_weights_time_ms": 3.455}, "counters": {"num_env_steps_sampled": 368000, "num_env_steps_trained": 368000, "num_agent_steps_sampled": 368000, "num_agent_steps_trained": 368000}, "done": false, "episodes_total": 7791, "training_iteration": 92, "trial_id": "ddfb6_00000", "date": "2024-03-07_13-02-53", "timestamp": 1709834573, "time_this_iter_s": 9.850555896759033, "time_total_s": 873.3103628158569, "pid": 112355, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4d85689f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 873.3103628158569, "iterations_since_restore": 92, "perf": {"cpu_util_percent": 26.94615384615384, "ram_util_percent": 47.784615384615385, "gpu_util_percent0": 0.05538461538461539, "vram_util_percent0": 0.10670197315705127}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.09492187500000003, "cur_lr": 0.0010000000000000005, "total_loss": 0.8126844533317927, "policy_loss": -0.012234160127819225, "vf_loss": 0.8230931654041733, "vf_explained_var": 0.7350150668492881, "kl": 0.01923106960181839, "entropy": 0.274560748614491, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 86025.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 372000, "num_env_steps_trained": 372000, "num_agent_steps_sampled": 372000, "num_agent_steps_trained": 372000}, "sampler_results": {"episode_reward_max": -1.4000000000000008, "episode_reward_min": -77.00000000000055, "episode_reward_mean": -2.549541284403676, "episode_len_mean": 33.0, "episode_media": {}, "episodes_this_iter": 109, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1.8000000000000012, -2.1000000000000014, -1.700000000000001, -2.1000000000000014, -1.700000000000001, -1.5000000000000009, -2.0000000000000013, -1.5000000000000009, -2.4000000000000017, -2.5000000000000018, -1.600000000000001, -1.8000000000000012, -2.4000000000000017, -1.8000000000000012, -1.4000000000000008, -1.9000000000000012, -1.5000000000000009, -2.2000000000000015, -1.600000000000001, -1.5000000000000009, -1.4000000000000008, -1.4000000000000008, -2.2000000000000015, -1.9000000000000012, -2.1000000000000014, -1.4000000000000008, -1.9000000000000012, -1.9000000000000012, -2.1000000000000014, -1.9000000000000012, -1.8000000000000012, -2.3000000000000016, -1.4000000000000008, -1.5000000000000009, -1.700000000000001, -1.5000000000000009, -1.8000000000000012, -1.9000000000000012, -1.8000000000000012, -1.8000000000000012, -2.4000000000000017, -2.800000000000002, -1.9000000000000012, -1.8000000000000012, -2.1000000000000014, -1.4000000000000008, -2.1000000000000014, -1.8000000000000012, -1.4000000000000008, -1.5000000000000009, -2.3000000000000016, -1.600000000000001, -2.0000000000000013, -2.0000000000000013, -1.9000000000000012, -1.700000000000001, -1.700000000000001, -1.9000000000000012, -1.8000000000000012, -1.700000000000001, -2.1000000000000014, -1.9000000000000012, -2.0000000000000013, -1.8000000000000012, -1.9000000000000012, -1.4000000000000008, -1.4000000000000008, -1.9000000000000012, -1.9000000000000012, -2.0000000000000013, -2.1000000000000014, -2.0000000000000013, -1.700000000000001, -1.9000000000000012, -2.0000000000000013, -2.2000000000000015, -2.1000000000000014, -1.9000000000000012, -1.600000000000001, -2.1000000000000014, -2.0000000000000013, -1.600000000000001, -2.0000000000000013, -2.2000000000000015, -2.0000000000000013, -1.9000000000000012, -2.1000000000000014, -1.700000000000001, -1.8000000000000012, -2.0000000000000013, -1.700000000000001, -1.700000000000001, -2.0000000000000013, -2.1000000000000014, -1.600000000000001, -2.1000000000000014, -1.600000000000001, -1.5000000000000009, -2.1000000000000014, -2.1000000000000014, -1.600000000000001, -2.2000000000000015, -2.0000000000000013, -1.700000000000001, -1.600000000000001, -77.00000000000055, -2.1000000000000014, -1.700000000000001, -1.8000000000000012], "episode_lengths": [29, 32, 28, 32, 28, 26, 31, 26, 35, 36, 27, 29, 35, 29, 25, 30, 26, 33, 27, 26, 25, 25, 33, 30, 32, 25, 30, 30, 32, 30, 29, 34, 25, 26, 28, 26, 29, 30, 29, 29, 35, 39, 30, 29, 32, 25, 32, 29, 25, 26, 34, 27, 31, 31, 30, 28, 28, 30, 29, 28, 32, 30, 31, 29, 30, 25, 25, 30, 30, 31, 32, 31, 28, 30, 31, 33, 32, 30, 27, 32, 31, 27, 31, 33, 31, 30, 32, 28, 29, 31, 28, 28, 31, 32, 27, 32, 27, 26, 32, 32, 27, 33, 31, 28, 27, 400, 32, 28, 29]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3550654405248981, "mean_inference_ms": 0.7287951825036623, "mean_action_processing_ms": 0.07581734126625646, "mean_env_wait_ms": 7.123029523181351, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006667845839754157, "StateBufferConnector_ms": 0.0037455777509496847, "ViewRequirementAgentConnector_ms": 0.08581428352845918}}, "episode_reward_max": -1.4000000000000008, "episode_reward_min": -77.00000000000055, "episode_reward_mean": -2.549541284403676, "episode_len_mean": 33.0, "episodes_this_iter": 109, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1.8000000000000012, -2.1000000000000014, -1.700000000000001, -2.1000000000000014, -1.700000000000001, -1.5000000000000009, -2.0000000000000013, -1.5000000000000009, -2.4000000000000017, -2.5000000000000018, -1.600000000000001, -1.8000000000000012, -2.4000000000000017, -1.8000000000000012, -1.4000000000000008, -1.9000000000000012, -1.5000000000000009, -2.2000000000000015, -1.600000000000001, -1.5000000000000009, -1.4000000000000008, -1.4000000000000008, -2.2000000000000015, -1.9000000000000012, -2.1000000000000014, -1.4000000000000008, -1.9000000000000012, -1.9000000000000012, -2.1000000000000014, -1.9000000000000012, -1.8000000000000012, -2.3000000000000016, -1.4000000000000008, -1.5000000000000009, -1.700000000000001, -1.5000000000000009, -1.8000000000000012, -1.9000000000000012, -1.8000000000000012, -1.8000000000000012, -2.4000000000000017, -2.800000000000002, -1.9000000000000012, -1.8000000000000012, -2.1000000000000014, -1.4000000000000008, -2.1000000000000014, -1.8000000000000012, -1.4000000000000008, -1.5000000000000009, -2.3000000000000016, -1.600000000000001, -2.0000000000000013, -2.0000000000000013, -1.9000000000000012, -1.700000000000001, -1.700000000000001, -1.9000000000000012, -1.8000000000000012, -1.700000000000001, -2.1000000000000014, -1.9000000000000012, -2.0000000000000013, -1.8000000000000012, -1.9000000000000012, -1.4000000000000008, -1.4000000000000008, -1.9000000000000012, -1.9000000000000012, -2.0000000000000013, -2.1000000000000014, -2.0000000000000013, -1.700000000000001, -1.9000000000000012, -2.0000000000000013, -2.2000000000000015, -2.1000000000000014, -1.9000000000000012, -1.600000000000001, -2.1000000000000014, -2.0000000000000013, -1.600000000000001, -2.0000000000000013, -2.2000000000000015, -2.0000000000000013, -1.9000000000000012, -2.1000000000000014, -1.700000000000001, -1.8000000000000012, -2.0000000000000013, -1.700000000000001, -1.700000000000001, -2.0000000000000013, -2.1000000000000014, -1.600000000000001, -2.1000000000000014, -1.600000000000001, -1.5000000000000009, -2.1000000000000014, -2.1000000000000014, -1.600000000000001, -2.2000000000000015, -2.0000000000000013, -1.700000000000001, -1.600000000000001, -77.00000000000055, -2.1000000000000014, -1.700000000000001, -1.8000000000000012], "episode_lengths": [29, 32, 28, 32, 28, 26, 31, 26, 35, 36, 27, 29, 35, 29, 25, 30, 26, 33, 27, 26, 25, 25, 33, 30, 32, 25, 30, 30, 32, 30, 29, 34, 25, 26, 28, 26, 29, 30, 29, 29, 35, 39, 30, 29, 32, 25, 32, 29, 25, 26, 34, 27, 31, 31, 30, 28, 28, 30, 29, 28, 32, 30, 31, 29, 30, 25, 25, 30, 30, 31, 32, 31, 28, 30, 31, 33, 32, 30, 27, 32, 31, 27, 31, 33, 31, 30, 32, 28, 29, 31, 28, 28, 31, 32, 27, 32, 27, 26, 32, 32, 27, 33, 31, 28, 27, 400, 32, 28, 29]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3550654405248981, "mean_inference_ms": 0.7287951825036623, "mean_action_processing_ms": 0.07581734126625646, "mean_env_wait_ms": 7.123029523181351, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006667845839754157, "StateBufferConnector_ms": 0.0037455777509496847, "ViewRequirementAgentConnector_ms": 0.08581428352845918}, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 372000, "num_agent_steps_trained": 372000, "num_env_steps_sampled": 372000, "num_env_steps_trained": 372000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 382.9268891122873, "num_env_steps_trained_throughput_per_sec": 382.9268891122873, "timesteps_total": 372000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 372000, "timers": {"training_iteration_time_ms": 9713.036, "sample_time_ms": 6162.966, "load_time_ms": 1.036, "load_throughput": 3859581.771, "learn_time_ms": 3544.917, "learn_throughput": 1128.376, "synch_weights_time_ms": 3.429}, "counters": {"num_env_steps_sampled": 372000, "num_env_steps_trained": 372000, "num_agent_steps_sampled": 372000, "num_agent_steps_trained": 372000}, "done": false, "episodes_total": 7900, "training_iteration": 93, "trial_id": "ddfb6_00000", "date": "2024-03-07_13-03-04", "timestamp": 1709834584, "time_this_iter_s": 10.448535919189453, "time_total_s": 883.7588987350464, "pid": 112355, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4d85689f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 883.7588987350464, "iterations_since_restore": 93, "perf": {"cpu_util_percent": 24.971428571428568, "ram_util_percent": 47.80714285714286, "gpu_util_percent0": 0.06571428571428571, "vram_util_percent0": 0.10670689174107142}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.09492187500000003, "cur_lr": 0.0010000000000000005, "total_loss": 1.133934050606143, "policy_loss": -0.0040537141543883146, "vf_loss": 1.1371435737152213, "vf_explained_var": 0.6584979417503521, "kl": 0.008893566286802055, "entropy": 0.3104007294161185, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 86955.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 376000, "num_env_steps_trained": 376000, "num_agent_steps_sampled": 376000, "num_agent_steps_trained": 376000}, "sampler_results": {"episode_reward_max": -1.4000000000000008, "episode_reward_min": -77.10000000000056, "episode_reward_mean": -4.092452830188696, "episode_len_mean": 41.18867924528302, "episode_media": {}, "episodes_this_iter": 106, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-76.70000000000056, -2.1000000000000014, -2.0000000000000013, -2.5000000000000018, -1.700000000000001, -3.0000000000000018, -1.8000000000000012, -2.5000000000000018, -2.2000000000000015, -2.4000000000000017, -2.0000000000000013, -2.1000000000000014, -2.1000000000000014, -1.8000000000000012, -2.2000000000000015, -2.0000000000000013, -1.5000000000000009, -2.3000000000000016, -2.3000000000000016, -2.5000000000000018, -1.9000000000000012, -1.8000000000000012, -2.2000000000000015, -2.0000000000000013, -1.600000000000001, -1.4000000000000008, -2.0000000000000013, -1.9000000000000012, -2.1000000000000014, -1.8000000000000012, -2.1000000000000014, -2.1000000000000014, -1.700000000000001, -1.8000000000000012, -2.5000000000000018, -1.700000000000001, -2.2000000000000015, -1.8000000000000012, -2.2000000000000015, -2.0000000000000013, -2.4000000000000017, -1.5000000000000009, -2.600000000000002, -1.700000000000001, -2.3000000000000016, -2.2000000000000015, -1.700000000000001, -1.5000000000000009, -1.700000000000001, -2.2000000000000015, -1.600000000000001, -1.700000000000001, -2.4000000000000017, -2.0000000000000013, -2.2000000000000015, -1.9000000000000012, -2.700000000000002, -1.700000000000001, -76.70000000000056, -2.0000000000000013, -1.4000000000000008, -1.5000000000000009, -1.9000000000000012, -2.3000000000000016, -1.600000000000001, -1.9000000000000012, -1.9000000000000012, -2.3000000000000016, -2.0000000000000013, -1.4000000000000008, -1.600000000000001, -2.1000000000000014, -77.10000000000056, -2.3000000000000016, -2.0000000000000013, -1.9000000000000012, -1.9000000000000012, -2.3000000000000016, -2.1000000000000014, -2.700000000000002, -1.700000000000001, -2.1000000000000014, -1.5000000000000009, -1.4000000000000008, -2.0000000000000013, -2.3000000000000016, -1.8000000000000012, -1.5000000000000009, -1.700000000000001, -1.700000000000001, -1.9000000000000012, -2.1000000000000014, -2.1000000000000014, -1.700000000000001, -3.0000000000000018, -2.0000000000000013, -2.0000000000000013, -1.600000000000001, -1.700000000000001, -1.9000000000000012, -1.700000000000001, -1.8000000000000012, -1.5000000000000009, -1.8000000000000012, -1.700000000000001, -2.2000000000000015], "episode_lengths": [400, 32, 31, 36, 28, 41, 29, 36, 33, 35, 31, 32, 32, 29, 33, 31, 26, 34, 34, 36, 30, 29, 33, 31, 27, 25, 31, 30, 32, 29, 32, 32, 28, 29, 36, 28, 33, 29, 33, 31, 35, 26, 37, 28, 34, 33, 28, 26, 28, 33, 27, 28, 35, 31, 33, 30, 38, 28, 400, 31, 25, 26, 30, 34, 27, 30, 30, 34, 31, 25, 27, 32, 400, 34, 31, 30, 30, 34, 32, 38, 28, 32, 26, 25, 31, 34, 29, 26, 28, 28, 30, 32, 32, 28, 41, 31, 31, 27, 28, 30, 28, 29, 26, 29, 28, 33]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3546736579224274, "mean_inference_ms": 0.7286840148478461, "mean_action_processing_ms": 0.07576677168853824, "mean_env_wait_ms": 7.130369761767289, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00657427985713167, "StateBufferConnector_ms": 0.003738448304950066, "ViewRequirementAgentConnector_ms": 0.08585295587215784}}, "episode_reward_max": -1.4000000000000008, "episode_reward_min": -77.10000000000056, "episode_reward_mean": -4.092452830188696, "episode_len_mean": 41.18867924528302, "episodes_this_iter": 106, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-76.70000000000056, -2.1000000000000014, -2.0000000000000013, -2.5000000000000018, -1.700000000000001, -3.0000000000000018, -1.8000000000000012, -2.5000000000000018, -2.2000000000000015, -2.4000000000000017, -2.0000000000000013, -2.1000000000000014, -2.1000000000000014, -1.8000000000000012, -2.2000000000000015, -2.0000000000000013, -1.5000000000000009, -2.3000000000000016, -2.3000000000000016, -2.5000000000000018, -1.9000000000000012, -1.8000000000000012, -2.2000000000000015, -2.0000000000000013, -1.600000000000001, -1.4000000000000008, -2.0000000000000013, -1.9000000000000012, -2.1000000000000014, -1.8000000000000012, -2.1000000000000014, -2.1000000000000014, -1.700000000000001, -1.8000000000000012, -2.5000000000000018, -1.700000000000001, -2.2000000000000015, -1.8000000000000012, -2.2000000000000015, -2.0000000000000013, -2.4000000000000017, -1.5000000000000009, -2.600000000000002, -1.700000000000001, -2.3000000000000016, -2.2000000000000015, -1.700000000000001, -1.5000000000000009, -1.700000000000001, -2.2000000000000015, -1.600000000000001, -1.700000000000001, -2.4000000000000017, -2.0000000000000013, -2.2000000000000015, -1.9000000000000012, -2.700000000000002, -1.700000000000001, -76.70000000000056, -2.0000000000000013, -1.4000000000000008, -1.5000000000000009, -1.9000000000000012, -2.3000000000000016, -1.600000000000001, -1.9000000000000012, -1.9000000000000012, -2.3000000000000016, -2.0000000000000013, -1.4000000000000008, -1.600000000000001, -2.1000000000000014, -77.10000000000056, -2.3000000000000016, -2.0000000000000013, -1.9000000000000012, -1.9000000000000012, -2.3000000000000016, -2.1000000000000014, -2.700000000000002, -1.700000000000001, -2.1000000000000014, -1.5000000000000009, -1.4000000000000008, -2.0000000000000013, -2.3000000000000016, -1.8000000000000012, -1.5000000000000009, -1.700000000000001, -1.700000000000001, -1.9000000000000012, -2.1000000000000014, -2.1000000000000014, -1.700000000000001, -3.0000000000000018, -2.0000000000000013, -2.0000000000000013, -1.600000000000001, -1.700000000000001, -1.9000000000000012, -1.700000000000001, -1.8000000000000012, -1.5000000000000009, -1.8000000000000012, -1.700000000000001, -2.2000000000000015], "episode_lengths": [400, 32, 31, 36, 28, 41, 29, 36, 33, 35, 31, 32, 32, 29, 33, 31, 26, 34, 34, 36, 30, 29, 33, 31, 27, 25, 31, 30, 32, 29, 32, 32, 28, 29, 36, 28, 33, 29, 33, 31, 35, 26, 37, 28, 34, 33, 28, 26, 28, 33, 27, 28, 35, 31, 33, 30, 38, 28, 400, 31, 25, 26, 30, 34, 27, 30, 30, 34, 31, 25, 27, 32, 400, 34, 31, 30, 30, 34, 32, 38, 28, 32, 26, 25, 31, 34, 29, 26, 28, 28, 30, 32, 32, 28, 41, 31, 31, 27, 28, 30, 28, 29, 26, 29, 28, 33]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3546736579224274, "mean_inference_ms": 0.7286840148478461, "mean_action_processing_ms": 0.07576677168853824, "mean_env_wait_ms": 7.130369761767289, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00657427985713167, "StateBufferConnector_ms": 0.003738448304950066, "ViewRequirementAgentConnector_ms": 0.08585295587215784}, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 376000, "num_agent_steps_trained": 376000, "num_env_steps_sampled": 376000, "num_env_steps_trained": 376000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 411.13087028670697, "num_env_steps_trained_throughput_per_sec": 411.13087028670697, "timesteps_total": 376000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 376000, "timers": {"training_iteration_time_ms": 9738.396, "sample_time_ms": 6205.504, "load_time_ms": 1.035, "load_throughput": 3863136.614, "learn_time_ms": 3527.85, "learn_throughput": 1133.835, "synch_weights_time_ms": 3.345}, "counters": {"num_env_steps_sampled": 376000, "num_env_steps_trained": 376000, "num_agent_steps_sampled": 376000, "num_agent_steps_trained": 376000}, "done": false, "episodes_total": 8006, "training_iteration": 94, "trial_id": "ddfb6_00000", "date": "2024-03-07_13-03-14", "timestamp": 1709834594, "time_this_iter_s": 9.732258081436157, "time_total_s": 893.4911568164825, "pid": 112355, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4d85689f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 893.4911568164825, "iterations_since_restore": 94, "perf": {"cpu_util_percent": 25.53846153846154, "ram_util_percent": 47.869230769230754, "gpu_util_percent0": 0.07076923076923076, "vram_util_percent0": 0.10670823317307693}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.09492187500000003, "cur_lr": 0.0010000000000000005, "total_loss": 0.5989391650463785, "policy_loss": -0.0072162143130015625, "vf_loss": 0.6052339214731448, "vf_explained_var": 0.7980208834012349, "kl": 0.009707581052814359, "entropy": 0.35297534793354973, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 87885.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 380000, "num_env_steps_trained": 380000, "num_agent_steps_sampled": 380000, "num_agent_steps_trained": 380000}, "sampler_results": {"episode_reward_max": -1.4000000000000008, "episode_reward_min": -76.30000000000055, "episode_reward_mean": -2.7339130434782666, "episode_len_mean": 34.96521739130435, "episode_media": {}, "episodes_this_iter": 115, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2.0000000000000013, -2.1000000000000014, -4.700000000000003, -2.2000000000000015, -2.3000000000000016, -2.600000000000002, -2.0000000000000013, -1.9000000000000012, -2.3000000000000016, -2.3000000000000016, -1.600000000000001, -2.2000000000000015, -1.700000000000001, -1.8000000000000012, -1.700000000000001, -1.600000000000001, -1.8000000000000012, -2.5000000000000018, -2.5000000000000018, -1.8000000000000012, -2.700000000000002, -2.0000000000000013, -2.2000000000000015, -2.4000000000000017, -2.2000000000000015, -2.4000000000000017, -2.0000000000000013, -1.9000000000000012, -2.4000000000000017, -1.9000000000000012, -2.0000000000000013, -2.600000000000002, -2.600000000000002, -1.600000000000001, -2.800000000000002, -2.1000000000000014, -2.2000000000000015, -2.0000000000000013, -1.5000000000000009, -2.0000000000000013, -1.5000000000000009, -2.0000000000000013, -1.8000000000000012, -2.1000000000000014, -1.9000000000000012, -2.1000000000000014, -2.1000000000000014, -2.2000000000000015, -1.9000000000000012, -2.1000000000000014, -2.900000000000002, -2.1000000000000014, -1.9000000000000012, -1.8000000000000012, -1.700000000000001, -2.0000000000000013, -1.700000000000001, -1.9000000000000012, -2.3000000000000016, -2.0000000000000013, -1.8000000000000012, -1.9000000000000012, -2.3000000000000016, -2.1000000000000014, -2.4000000000000017, -2.4000000000000017, -2.2000000000000015, -1.9000000000000012, -1.8000000000000012, -2.5000000000000018, -1.8000000000000012, -2.600000000000002, -1.5000000000000009, -1.8000000000000012, -2.4000000000000017, -2.0000000000000013, -2.3000000000000016, -2.0000000000000013, -2.2000000000000015, -2.1000000000000014, -1.700000000000001, -2.5000000000000018, -2.0000000000000013, -2.600000000000002, -2.4000000000000017, -2.700000000000002, -2.3000000000000016, -2.1000000000000014, -1.700000000000001, -1.8000000000000012, -1.8000000000000012, -2.3000000000000016, -2.800000000000002, -1.8000000000000012, -1.9000000000000012, -1.700000000000001, -1.700000000000001, -2.4000000000000017, -1.600000000000001, -2.1000000000000014, -1.9000000000000012, -2.3000000000000016, -1.8000000000000012, -1.8000000000000012, -1.9000000000000012, -1.5000000000000009, -2.3000000000000016, -1.4000000000000008, -76.30000000000055, -1.700000000000001, -2.4000000000000017, -2.1000000000000014, -1.9000000000000012, -1.700000000000001, -2.4000000000000017], "episode_lengths": [31, 32, 45, 33, 34, 37, 31, 30, 34, 33, 27, 33, 28, 29, 28, 27, 29, 36, 36, 29, 38, 31, 33, 35, 33, 35, 31, 30, 35, 30, 31, 37, 37, 27, 39, 32, 33, 31, 26, 31, 26, 31, 29, 32, 30, 32, 32, 33, 30, 32, 40, 32, 30, 29, 28, 31, 28, 30, 34, 31, 29, 30, 34, 32, 35, 35, 33, 30, 29, 36, 29, 37, 26, 29, 35, 31, 34, 31, 33, 32, 28, 36, 31, 37, 35, 38, 34, 32, 28, 29, 29, 34, 39, 29, 30, 28, 28, 35, 27, 32, 30, 34, 29, 29, 30, 26, 34, 25, 400, 28, 35, 32, 30, 28, 35]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.35555756622464263, "mean_inference_ms": 0.7281191859165681, "mean_action_processing_ms": 0.0757468856957901, "mean_env_wait_ms": 7.122576092282622, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006445387135381284, "StateBufferConnector_ms": 0.003711451654848845, "ViewRequirementAgentConnector_ms": 0.08569199105967647}}, "episode_reward_max": -1.4000000000000008, "episode_reward_min": -76.30000000000055, "episode_reward_mean": -2.7339130434782666, "episode_len_mean": 34.96521739130435, "episodes_this_iter": 115, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-2.0000000000000013, -2.1000000000000014, -4.700000000000003, -2.2000000000000015, -2.3000000000000016, -2.600000000000002, -2.0000000000000013, -1.9000000000000012, -2.3000000000000016, -2.3000000000000016, -1.600000000000001, -2.2000000000000015, -1.700000000000001, -1.8000000000000012, -1.700000000000001, -1.600000000000001, -1.8000000000000012, -2.5000000000000018, -2.5000000000000018, -1.8000000000000012, -2.700000000000002, -2.0000000000000013, -2.2000000000000015, -2.4000000000000017, -2.2000000000000015, -2.4000000000000017, -2.0000000000000013, -1.9000000000000012, -2.4000000000000017, -1.9000000000000012, -2.0000000000000013, -2.600000000000002, -2.600000000000002, -1.600000000000001, -2.800000000000002, -2.1000000000000014, -2.2000000000000015, -2.0000000000000013, -1.5000000000000009, -2.0000000000000013, -1.5000000000000009, -2.0000000000000013, -1.8000000000000012, -2.1000000000000014, -1.9000000000000012, -2.1000000000000014, -2.1000000000000014, -2.2000000000000015, -1.9000000000000012, -2.1000000000000014, -2.900000000000002, -2.1000000000000014, -1.9000000000000012, -1.8000000000000012, -1.700000000000001, -2.0000000000000013, -1.700000000000001, -1.9000000000000012, -2.3000000000000016, -2.0000000000000013, -1.8000000000000012, -1.9000000000000012, -2.3000000000000016, -2.1000000000000014, -2.4000000000000017, -2.4000000000000017, -2.2000000000000015, -1.9000000000000012, -1.8000000000000012, -2.5000000000000018, -1.8000000000000012, -2.600000000000002, -1.5000000000000009, -1.8000000000000012, -2.4000000000000017, -2.0000000000000013, -2.3000000000000016, -2.0000000000000013, -2.2000000000000015, -2.1000000000000014, -1.700000000000001, -2.5000000000000018, -2.0000000000000013, -2.600000000000002, -2.4000000000000017, -2.700000000000002, -2.3000000000000016, -2.1000000000000014, -1.700000000000001, -1.8000000000000012, -1.8000000000000012, -2.3000000000000016, -2.800000000000002, -1.8000000000000012, -1.9000000000000012, -1.700000000000001, -1.700000000000001, -2.4000000000000017, -1.600000000000001, -2.1000000000000014, -1.9000000000000012, -2.3000000000000016, -1.8000000000000012, -1.8000000000000012, -1.9000000000000012, -1.5000000000000009, -2.3000000000000016, -1.4000000000000008, -76.30000000000055, -1.700000000000001, -2.4000000000000017, -2.1000000000000014, -1.9000000000000012, -1.700000000000001, -2.4000000000000017], "episode_lengths": [31, 32, 45, 33, 34, 37, 31, 30, 34, 33, 27, 33, 28, 29, 28, 27, 29, 36, 36, 29, 38, 31, 33, 35, 33, 35, 31, 30, 35, 30, 31, 37, 37, 27, 39, 32, 33, 31, 26, 31, 26, 31, 29, 32, 30, 32, 32, 33, 30, 32, 40, 32, 30, 29, 28, 31, 28, 30, 34, 31, 29, 30, 34, 32, 35, 35, 33, 30, 29, 36, 29, 37, 26, 29, 35, 31, 34, 31, 33, 32, 28, 36, 31, 37, 35, 38, 34, 32, 28, 29, 29, 34, 39, 29, 30, 28, 28, 35, 27, 32, 30, 34, 29, 29, 30, 26, 34, 25, 400, 28, 35, 32, 30, 28, 35]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.35555756622464263, "mean_inference_ms": 0.7281191859165681, "mean_action_processing_ms": 0.0757468856957901, "mean_env_wait_ms": 7.122576092282622, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006445387135381284, "StateBufferConnector_ms": 0.003711451654848845, "ViewRequirementAgentConnector_ms": 0.08569199105967647}, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 380000, "num_agent_steps_trained": 380000, "num_env_steps_sampled": 380000, "num_env_steps_trained": 380000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 396.5580799659934, "num_env_steps_trained_throughput_per_sec": 396.5580799659934, "timesteps_total": 380000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 380000, "timers": {"training_iteration_time_ms": 9790.996, "sample_time_ms": 6267.441, "load_time_ms": 1.037, "load_throughput": 3857452.004, "learn_time_ms": 3518.493, "learn_throughput": 1136.85, "synch_weights_time_ms": 3.361}, "counters": {"num_env_steps_sampled": 380000, "num_env_steps_trained": 380000, "num_agent_steps_sampled": 380000, "num_agent_steps_trained": 380000}, "done": false, "episodes_total": 8121, "training_iteration": 95, "trial_id": "ddfb6_00000", "date": "2024-03-07_13-03-24", "timestamp": 1709834604, "time_this_iter_s": 10.089597940444946, "time_total_s": 903.5807547569275, "pid": 112355, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4d85689f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 903.5807547569275, "iterations_since_restore": 95, "perf": {"cpu_util_percent": 25.638461538461538, "ram_util_percent": 47.8076923076923, "gpu_util_percent0": 0.06461538461538462, "vram_util_percent0": 0.10670823317307693}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.09492187500000003, "cur_lr": 0.0010000000000000005, "total_loss": 0.4197888568624534, "policy_loss": -0.028659127516451704, "vf_loss": 0.44478352078366823, "vf_explained_var": 0.8957969597590867, "kl": 0.03860506486739615, "entropy": 0.35614668766977964, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 88815.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 384000, "num_env_steps_trained": 384000, "num_agent_steps_sampled": 384000, "num_agent_steps_trained": 384000}, "sampler_results": {"episode_reward_max": -1.4000000000000008, "episode_reward_min": -3.200000000000001, "episode_reward_mean": -2.0459016393442635, "episode_len_mean": 31.34426229508197, "episode_media": {}, "episodes_this_iter": 122, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2.4000000000000017, -1.700000000000001, -1.8000000000000012, -2.800000000000002, -1.600000000000001, -1.600000000000001, -2.2000000000000015, -1.9000000000000012, -3.200000000000001, -1.700000000000001, -2.0000000000000013, -2.2000000000000015, -2.1000000000000014, -2.600000000000002, -2.700000000000002, -2.0000000000000013, -2.1000000000000014, -1.9000000000000012, -1.5000000000000009, -1.700000000000001, -2.2000000000000015, -1.700000000000001, -2.4000000000000017, -2.900000000000002, -2.800000000000002, -2.4000000000000017, -2.2000000000000015, -1.5000000000000009, -2.700000000000002, -1.700000000000001, -1.8000000000000012, -2.5000000000000018, -2.3000000000000016, -1.700000000000001, -2.2000000000000015, -1.600000000000001, -1.9000000000000012, -2.5000000000000018, -1.600000000000001, -1.8000000000000012, -2.3000000000000016, -1.8000000000000012, -1.600000000000001, -2.2000000000000015, -2.0000000000000013, -1.5000000000000009, -2.1000000000000014, -2.0000000000000013, -1.700000000000001, -1.8000000000000012, -2.600000000000002, -1.700000000000001, -1.8000000000000012, -2.0000000000000013, -1.9000000000000012, -2.600000000000002, -1.600000000000001, -2.600000000000002, -1.8000000000000012, -2.1000000000000014, -1.8000000000000012, -1.8000000000000012, -2.1000000000000014, -2.0000000000000013, -1.4000000000000008, -1.8000000000000012, -2.2000000000000015, -2.2000000000000015, -2.800000000000002, -2.0000000000000013, -2.5000000000000018, -2.5000000000000018, -1.700000000000001, -2.3000000000000016, -1.9000000000000012, -2.0000000000000013, -2.1000000000000014, -2.3000000000000016, -1.600000000000001, -2.3000000000000016, -2.2000000000000015, -1.700000000000001, -3.200000000000001, -1.700000000000001, -2.900000000000002, -1.700000000000001, -1.600000000000001, -2.600000000000002, -1.9000000000000012, -1.600000000000001, -1.700000000000001, -2.1000000000000014, -2.2000000000000015, -1.600000000000001, -2.600000000000002, -1.600000000000001, -1.4000000000000008, -1.700000000000001, -2.2000000000000015, -2.2000000000000015, -2.4000000000000017, -2.3000000000000016, -1.9000000000000012, -2.3000000000000016, -1.700000000000001, -1.600000000000001, -2.700000000000002, -2.0000000000000013, -1.8000000000000012, -1.5000000000000009, -2.900000000000002, -1.8000000000000012, -1.8000000000000012, -2.1000000000000014, -1.600000000000001, -2.5000000000000018, -2.2000000000000015, -1.8000000000000012, -1.8000000000000012, -1.5000000000000009, -2.0000000000000013, -1.9000000000000012], "episode_lengths": [35, 28, 29, 39, 27, 27, 33, 30, 43, 28, 31, 33, 32, 35, 38, 31, 32, 30, 26, 28, 33, 28, 35, 40, 39, 35, 33, 26, 38, 28, 29, 36, 34, 28, 33, 27, 30, 36, 27, 29, 34, 29, 27, 33, 31, 26, 32, 31, 28, 29, 37, 28, 29, 31, 30, 37, 27, 37, 29, 32, 29, 29, 32, 31, 25, 29, 33, 33, 35, 31, 36, 36, 28, 34, 30, 31, 32, 34, 27, 34, 33, 28, 35, 28, 40, 28, 27, 37, 30, 27, 28, 32, 33, 27, 37, 27, 25, 28, 33, 33, 35, 34, 30, 34, 28, 27, 38, 31, 29, 26, 40, 29, 29, 32, 27, 36, 33, 29, 29, 26, 31, 30]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.35546278497302136, "mean_inference_ms": 0.7278965489573199, "mean_action_processing_ms": 0.07568598669344638, "mean_env_wait_ms": 7.129989347554477, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006699562072753906, "StateBufferConnector_ms": 0.0038053168625128073, "ViewRequirementAgentConnector_ms": 0.08695301462392338}}, "episode_reward_max": -1.4000000000000008, "episode_reward_min": -3.200000000000001, "episode_reward_mean": -2.0459016393442635, "episode_len_mean": 31.34426229508197, "episodes_this_iter": 122, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-2.4000000000000017, -1.700000000000001, -1.8000000000000012, -2.800000000000002, -1.600000000000001, -1.600000000000001, -2.2000000000000015, -1.9000000000000012, -3.200000000000001, -1.700000000000001, -2.0000000000000013, -2.2000000000000015, -2.1000000000000014, -2.600000000000002, -2.700000000000002, -2.0000000000000013, -2.1000000000000014, -1.9000000000000012, -1.5000000000000009, -1.700000000000001, -2.2000000000000015, -1.700000000000001, -2.4000000000000017, -2.900000000000002, -2.800000000000002, -2.4000000000000017, -2.2000000000000015, -1.5000000000000009, -2.700000000000002, -1.700000000000001, -1.8000000000000012, -2.5000000000000018, -2.3000000000000016, -1.700000000000001, -2.2000000000000015, -1.600000000000001, -1.9000000000000012, -2.5000000000000018, -1.600000000000001, -1.8000000000000012, -2.3000000000000016, -1.8000000000000012, -1.600000000000001, -2.2000000000000015, -2.0000000000000013, -1.5000000000000009, -2.1000000000000014, -2.0000000000000013, -1.700000000000001, -1.8000000000000012, -2.600000000000002, -1.700000000000001, -1.8000000000000012, -2.0000000000000013, -1.9000000000000012, -2.600000000000002, -1.600000000000001, -2.600000000000002, -1.8000000000000012, -2.1000000000000014, -1.8000000000000012, -1.8000000000000012, -2.1000000000000014, -2.0000000000000013, -1.4000000000000008, -1.8000000000000012, -2.2000000000000015, -2.2000000000000015, -2.800000000000002, -2.0000000000000013, -2.5000000000000018, -2.5000000000000018, -1.700000000000001, -2.3000000000000016, -1.9000000000000012, -2.0000000000000013, -2.1000000000000014, -2.3000000000000016, -1.600000000000001, -2.3000000000000016, -2.2000000000000015, -1.700000000000001, -3.200000000000001, -1.700000000000001, -2.900000000000002, -1.700000000000001, -1.600000000000001, -2.600000000000002, -1.9000000000000012, -1.600000000000001, -1.700000000000001, -2.1000000000000014, -2.2000000000000015, -1.600000000000001, -2.600000000000002, -1.600000000000001, -1.4000000000000008, -1.700000000000001, -2.2000000000000015, -2.2000000000000015, -2.4000000000000017, -2.3000000000000016, -1.9000000000000012, -2.3000000000000016, -1.700000000000001, -1.600000000000001, -2.700000000000002, -2.0000000000000013, -1.8000000000000012, -1.5000000000000009, -2.900000000000002, -1.8000000000000012, -1.8000000000000012, -2.1000000000000014, -1.600000000000001, -2.5000000000000018, -2.2000000000000015, -1.8000000000000012, -1.8000000000000012, -1.5000000000000009, -2.0000000000000013, -1.9000000000000012], "episode_lengths": [35, 28, 29, 39, 27, 27, 33, 30, 43, 28, 31, 33, 32, 35, 38, 31, 32, 30, 26, 28, 33, 28, 35, 40, 39, 35, 33, 26, 38, 28, 29, 36, 34, 28, 33, 27, 30, 36, 27, 29, 34, 29, 27, 33, 31, 26, 32, 31, 28, 29, 37, 28, 29, 31, 30, 37, 27, 37, 29, 32, 29, 29, 32, 31, 25, 29, 33, 33, 35, 31, 36, 36, 28, 34, 30, 31, 32, 34, 27, 34, 33, 28, 35, 28, 40, 28, 27, 37, 30, 27, 28, 32, 33, 27, 37, 27, 25, 28, 33, 33, 35, 34, 30, 34, 28, 27, 38, 31, 29, 26, 40, 29, 29, 32, 27, 36, 33, 29, 29, 26, 31, 30]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.35546278497302136, "mean_inference_ms": 0.7278965489573199, "mean_action_processing_ms": 0.07568598669344638, "mean_env_wait_ms": 7.129989347554477, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006699562072753906, "StateBufferConnector_ms": 0.0038053168625128073, "ViewRequirementAgentConnector_ms": 0.08695301462392338}, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 384000, "num_agent_steps_trained": 384000, "num_env_steps_sampled": 384000, "num_env_steps_trained": 384000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 426.77028340392195, "num_env_steps_trained_throughput_per_sec": 426.77028340392195, "timesteps_total": 384000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 384000, "timers": {"training_iteration_time_ms": 9710.775, "sample_time_ms": 6191.714, "load_time_ms": 1.036, "load_throughput": 3860736.377, "learn_time_ms": 3513.991, "learn_throughput": 1138.307, "synch_weights_time_ms": 3.365}, "counters": {"num_env_steps_sampled": 384000, "num_env_steps_trained": 384000, "num_agent_steps_sampled": 384000, "num_agent_steps_trained": 384000}, "done": false, "episodes_total": 8243, "training_iteration": 96, "trial_id": "ddfb6_00000", "date": "2024-03-07_13-03-33", "timestamp": 1709834613, "time_this_iter_s": 9.375699281692505, "time_total_s": 912.95645403862, "pid": 112355, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4d85689f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 912.95645403862, "iterations_since_restore": 96, "perf": {"cpu_util_percent": 26.899999999999995, "ram_util_percent": 47.791666666666664, "gpu_util_percent0": 0.06833333333333334, "vram_util_percent0": 0.10670979817708333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.14238281249999996, "cur_lr": 0.0010000000000000005, "total_loss": 0.06583685192645036, "policy_loss": -0.00860468882326317, "vf_loss": 0.0729524652723984, "vf_explained_var": 0.942993575334549, "kl": 0.010458254503591596, "entropy": 0.3357152567916019, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 89745.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 388000, "num_env_steps_trained": 388000, "num_agent_steps_sampled": 388000, "num_agent_steps_trained": 388000}, "sampler_results": {"episode_reward_max": -1.4000000000000008, "episode_reward_min": -33.19999999999995, "episode_reward_mean": -2.3598425196850403, "episode_len_mean": 33.20472440944882, "episode_media": {}, "episodes_this_iter": 127, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2.1000000000000014, -2.0000000000000013, -1.8000000000000012, -2.3000000000000016, -2.3000000000000016, -1.700000000000001, -2.0000000000000013, -2.800000000000002, -1.600000000000001, -1.700000000000001, -2.800000000000002, -1.8000000000000012, -1.8000000000000012, -1.700000000000001, -2.1000000000000014, -1.700000000000001, -1.700000000000001, -1.8000000000000012, -2.3000000000000016, -3.5000000000000027, -1.8000000000000012, -2.600000000000002, -2.900000000000002, -1.600000000000001, -2.1000000000000014, -2.0000000000000013, -1.600000000000001, -1.8000000000000012, -1.8000000000000012, -2.900000000000002, -2.1000000000000014, -1.8000000000000012, -1.8000000000000012, -2.3000000000000016, -2.1000000000000014, -2.800000000000002, -2.0000000000000013, -1.8000000000000012, -1.5000000000000009, -1.9000000000000012, -2.1000000000000014, -2.1000000000000014, -2.4000000000000017, -2.3000000000000016, -2.1000000000000014, -1.700000000000001, -2.1000000000000014, -1.8000000000000012, -3.5999999999999996, -1.5000000000000009, -2.2000000000000015, -1.600000000000001, -2.600000000000002, -2.2000000000000015, -1.8000000000000012, -2.1000000000000014, -2.4000000000000017, -1.9000000000000012, -1.8000000000000012, -1.5000000000000009, -2.2000000000000015, -2.0000000000000013, -2.1000000000000014, -2.3000000000000016, -1.4000000000000008, -33.19999999999995, -1.4000000000000008, -2.5000000000000018, -1.8000000000000012, -2.0000000000000013, -2.5000000000000018, -3.200000000000001, -1.600000000000001, -2.600000000000002, -2.4000000000000017, -1.700000000000001, -1.8000000000000012, -2.5000000000000018, -1.5000000000000009, -1.700000000000001, -2.0000000000000013, -2.1000000000000014, -2.700000000000002, -2.3000000000000016, -1.8000000000000012, -2.5000000000000018, -2.3000000000000016, -2.1000000000000014, -2.0000000000000013, -2.1000000000000014, -2.800000000000002, -2.2000000000000015, -1.700000000000001, -2.600000000000002, -2.700000000000002, -2.0000000000000013, -2.0000000000000013, -1.8000000000000012, -1.700000000000001, -2.800000000000002, -1.8000000000000012, -1.8000000000000012, -2.5000000000000018, -2.800000000000002, -2.1000000000000014, -2.700000000000002, -1.8000000000000012, -2.3000000000000016, -2.1000000000000014, -2.2000000000000015, -2.1000000000000014, -2.0000000000000013, -2.3000000000000016, -1.700000000000001, -2.1000000000000014, -2.0000000000000013, -1.600000000000001, -4.3, -1.600000000000001, -2.4000000000000017, -2.2000000000000015, -1.700000000000001, -2.3000000000000016, -1.9000000000000012, -2.700000000000002, -1.8000000000000012, -1.8000000000000012], "episode_lengths": [32, 31, 29, 34, 34, 28, 31, 39, 27, 28, 37, 29, 29, 28, 32, 28, 28, 29, 34, 39, 29, 37, 40, 27, 32, 31, 27, 29, 29, 40, 32, 29, 29, 34, 32, 39, 31, 29, 26, 30, 32, 32, 35, 34, 32, 28, 32, 29, 46, 26, 33, 27, 37, 33, 29, 32, 35, 30, 29, 26, 33, 31, 32, 34, 25, 190, 25, 36, 29, 31, 36, 43, 27, 37, 34, 28, 29, 36, 26, 28, 31, 32, 38, 34, 29, 36, 34, 32, 31, 32, 39, 33, 28, 37, 38, 31, 31, 29, 28, 39, 29, 29, 35, 36, 32, 38, 29, 34, 32, 33, 32, 31, 34, 28, 32, 31, 27, 45, 27, 35, 33, 28, 34, 30, 38, 29, 29]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3560333827454058, "mean_inference_ms": 0.7277155609022657, "mean_action_processing_ms": 0.07567097290787834, "mean_env_wait_ms": 7.131721772905788, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006786293870820774, "StateBufferConnector_ms": 0.0038062493632158895, "ViewRequirementAgentConnector_ms": 0.08710369350403313}}, "episode_reward_max": -1.4000000000000008, "episode_reward_min": -33.19999999999995, "episode_reward_mean": -2.3598425196850403, "episode_len_mean": 33.20472440944882, "episodes_this_iter": 127, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-2.1000000000000014, -2.0000000000000013, -1.8000000000000012, -2.3000000000000016, -2.3000000000000016, -1.700000000000001, -2.0000000000000013, -2.800000000000002, -1.600000000000001, -1.700000000000001, -2.800000000000002, -1.8000000000000012, -1.8000000000000012, -1.700000000000001, -2.1000000000000014, -1.700000000000001, -1.700000000000001, -1.8000000000000012, -2.3000000000000016, -3.5000000000000027, -1.8000000000000012, -2.600000000000002, -2.900000000000002, -1.600000000000001, -2.1000000000000014, -2.0000000000000013, -1.600000000000001, -1.8000000000000012, -1.8000000000000012, -2.900000000000002, -2.1000000000000014, -1.8000000000000012, -1.8000000000000012, -2.3000000000000016, -2.1000000000000014, -2.800000000000002, -2.0000000000000013, -1.8000000000000012, -1.5000000000000009, -1.9000000000000012, -2.1000000000000014, -2.1000000000000014, -2.4000000000000017, -2.3000000000000016, -2.1000000000000014, -1.700000000000001, -2.1000000000000014, -1.8000000000000012, -3.5999999999999996, -1.5000000000000009, -2.2000000000000015, -1.600000000000001, -2.600000000000002, -2.2000000000000015, -1.8000000000000012, -2.1000000000000014, -2.4000000000000017, -1.9000000000000012, -1.8000000000000012, -1.5000000000000009, -2.2000000000000015, -2.0000000000000013, -2.1000000000000014, -2.3000000000000016, -1.4000000000000008, -33.19999999999995, -1.4000000000000008, -2.5000000000000018, -1.8000000000000012, -2.0000000000000013, -2.5000000000000018, -3.200000000000001, -1.600000000000001, -2.600000000000002, -2.4000000000000017, -1.700000000000001, -1.8000000000000012, -2.5000000000000018, -1.5000000000000009, -1.700000000000001, -2.0000000000000013, -2.1000000000000014, -2.700000000000002, -2.3000000000000016, -1.8000000000000012, -2.5000000000000018, -2.3000000000000016, -2.1000000000000014, -2.0000000000000013, -2.1000000000000014, -2.800000000000002, -2.2000000000000015, -1.700000000000001, -2.600000000000002, -2.700000000000002, -2.0000000000000013, -2.0000000000000013, -1.8000000000000012, -1.700000000000001, -2.800000000000002, -1.8000000000000012, -1.8000000000000012, -2.5000000000000018, -2.800000000000002, -2.1000000000000014, -2.700000000000002, -1.8000000000000012, -2.3000000000000016, -2.1000000000000014, -2.2000000000000015, -2.1000000000000014, -2.0000000000000013, -2.3000000000000016, -1.700000000000001, -2.1000000000000014, -2.0000000000000013, -1.600000000000001, -4.3, -1.600000000000001, -2.4000000000000017, -2.2000000000000015, -1.700000000000001, -2.3000000000000016, -1.9000000000000012, -2.700000000000002, -1.8000000000000012, -1.8000000000000012], "episode_lengths": [32, 31, 29, 34, 34, 28, 31, 39, 27, 28, 37, 29, 29, 28, 32, 28, 28, 29, 34, 39, 29, 37, 40, 27, 32, 31, 27, 29, 29, 40, 32, 29, 29, 34, 32, 39, 31, 29, 26, 30, 32, 32, 35, 34, 32, 28, 32, 29, 46, 26, 33, 27, 37, 33, 29, 32, 35, 30, 29, 26, 33, 31, 32, 34, 25, 190, 25, 36, 29, 31, 36, 43, 27, 37, 34, 28, 29, 36, 26, 28, 31, 32, 38, 34, 29, 36, 34, 32, 31, 32, 39, 33, 28, 37, 38, 31, 31, 29, 28, 39, 29, 29, 35, 36, 32, 38, 29, 34, 32, 33, 32, 31, 34, 28, 32, 31, 27, 45, 27, 35, 33, 28, 34, 30, 38, 29, 29]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3560333827454058, "mean_inference_ms": 0.7277155609022657, "mean_action_processing_ms": 0.07567097290787834, "mean_env_wait_ms": 7.131721772905788, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006786293870820774, "StateBufferConnector_ms": 0.0038062493632158895, "ViewRequirementAgentConnector_ms": 0.08710369350403313}, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 388000, "num_agent_steps_trained": 388000, "num_env_steps_sampled": 388000, "num_env_steps_trained": 388000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 427.3538828715447, "num_env_steps_trained_throughput_per_sec": 427.3538828715447, "timesteps_total": 388000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 388000, "timers": {"training_iteration_time_ms": 9662.904, "sample_time_ms": 6139.456, "load_time_ms": 1.034, "load_throughput": 3867411.079, "learn_time_ms": 3518.364, "learn_throughput": 1136.892, "synch_weights_time_ms": 3.38}, "counters": {"num_env_steps_sampled": 388000, "num_env_steps_trained": 388000, "num_agent_steps_sampled": 388000, "num_agent_steps_trained": 388000}, "done": false, "episodes_total": 8370, "training_iteration": 97, "trial_id": "ddfb6_00000", "date": "2024-03-07_13-03-42", "timestamp": 1709834622, "time_this_iter_s": 9.362776517868042, "time_total_s": 922.319230556488, "pid": 112355, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4d85689f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 922.319230556488, "iterations_since_restore": 97, "perf": {"cpu_util_percent": 27.05, "ram_util_percent": 47.79999999999999, "gpu_util_percent0": 0.05916666666666667, "vram_util_percent0": 0.10670979817708333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.14238281249999996, "cur_lr": 0.0010000000000000005, "total_loss": 0.25982179463470495, "policy_loss": -0.010554499852080498, "vf_loss": 0.26859568127541134, "vf_explained_var": 0.8816341882751834, "kl": 0.012505779421467538, "entropy": 0.3117176527938535, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 90675.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 392000, "num_env_steps_trained": 392000, "num_agent_steps_sampled": 392000, "num_agent_steps_trained": 392000}, "sampler_results": {"episode_reward_max": -1.4000000000000008, "episode_reward_min": -10.699999999999992, "episode_reward_mean": -2.0640625000000012, "episode_len_mean": 31.0859375, "episode_media": {}, "episodes_this_iter": 128, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2.2000000000000015, -1.600000000000001, -1.9000000000000012, -2.0000000000000013, -4.1, -1.600000000000001, -2.0000000000000013, -2.3000000000000016, -1.600000000000001, -2.0000000000000013, -1.9000000000000012, -1.8000000000000012, -1.8000000000000012, -1.8000000000000012, -1.700000000000001, -1.4000000000000008, -1.600000000000001, -1.700000000000001, -2.1000000000000014, -1.700000000000001, -1.8000000000000012, -2.1000000000000014, -1.5000000000000009, -1.8000000000000012, -2.1000000000000014, -5.699999999999998, -2.2000000000000015, -2.4000000000000017, -1.9000000000000012, -3.200000000000001, -2.2000000000000015, -1.600000000000001, -1.8000000000000012, -1.8000000000000012, -1.700000000000001, -2.0000000000000013, -2.700000000000002, -2.2000000000000015, -3.200000000000001, -2.2000000000000015, -3.1000000000000014, -2.1000000000000014, -2.0000000000000013, -1.700000000000001, -2.4000000000000017, -1.8000000000000012, -1.700000000000001, -2.3000000000000016, -2.0000000000000013, -1.9000000000000012, -1.5000000000000009, -1.700000000000001, -1.9000000000000012, -2.4000000000000017, -2.0000000000000013, -2.1000000000000014, -2.2000000000000015, -2.2000000000000015, -2.4000000000000017, -1.8000000000000012, -1.600000000000001, -1.8000000000000012, -1.600000000000001, -2.1000000000000014, -1.8000000000000012, -2.0000000000000013, -1.9000000000000012, -1.5000000000000009, -1.9000000000000012, -2.3000000000000016, -10.699999999999992, -3.200000000000002, -2.1000000000000014, -1.700000000000001, -2.5000000000000018, -1.9000000000000012, -2.3000000000000016, -2.0000000000000013, -1.9000000000000012, -1.9000000000000012, -2.1000000000000014, -1.9000000000000012, -2.0000000000000013, -1.8000000000000012, -1.9000000000000012, -1.8000000000000012, -2.3000000000000016, -1.8000000000000012, -1.8000000000000012, -1.8000000000000012, -1.600000000000001, -1.8000000000000012, -2.1000000000000014, -1.5000000000000009, -2.0000000000000013, -1.5000000000000009, -1.700000000000001, -1.9000000000000012, -2.3000000000000016, -2.4000000000000017, -1.5000000000000009, -1.5000000000000009, -1.4000000000000008, -1.700000000000001, -1.5000000000000009, -1.9000000000000012, -2.0000000000000013, -2.0000000000000013, -2.900000000000002, -2.3000000000000016, -1.5000000000000009, -1.4000000000000008, -1.8000000000000012, -2.1000000000000014, -1.9000000000000012, -2.0000000000000013, -2.1000000000000014, -2.1000000000000014, -1.5000000000000009, -1.8000000000000012, -1.4000000000000008, -2.600000000000002, -2.1000000000000014, -1.600000000000001, -1.700000000000001, -1.700000000000001, -1.4000000000000008, -2.0000000000000013], "episode_lengths": [33, 27, 30, 31, 45, 27, 31, 34, 27, 31, 30, 29, 29, 29, 28, 25, 27, 28, 32, 28, 29, 32, 26, 29, 32, 56, 33, 35, 30, 43, 33, 27, 29, 29, 28, 31, 38, 33, 43, 33, 41, 32, 31, 28, 35, 29, 28, 34, 31, 30, 26, 28, 30, 35, 31, 32, 33, 33, 35, 29, 27, 29, 27, 32, 29, 31, 30, 26, 30, 34, 75, 35, 32, 28, 36, 30, 34, 31, 30, 30, 32, 30, 31, 29, 30, 29, 34, 29, 29, 29, 27, 29, 32, 26, 31, 26, 28, 30, 34, 35, 26, 26, 25, 28, 26, 30, 31, 31, 40, 34, 26, 25, 29, 32, 30, 31, 32, 32, 26, 29, 25, 37, 32, 27, 28, 28, 25, 31]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.35659084611168357, "mean_inference_ms": 0.7274729978373811, "mean_action_processing_ms": 0.0756525243440164, "mean_env_wait_ms": 7.134346487338481, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006798282265663147, "StateBufferConnector_ms": 0.003857165575027466, "ViewRequirementAgentConnector_ms": 0.0873170793056488}}, "episode_reward_max": -1.4000000000000008, "episode_reward_min": -10.699999999999992, "episode_reward_mean": -2.0640625000000012, "episode_len_mean": 31.0859375, "episodes_this_iter": 128, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-2.2000000000000015, -1.600000000000001, -1.9000000000000012, -2.0000000000000013, -4.1, -1.600000000000001, -2.0000000000000013, -2.3000000000000016, -1.600000000000001, -2.0000000000000013, -1.9000000000000012, -1.8000000000000012, -1.8000000000000012, -1.8000000000000012, -1.700000000000001, -1.4000000000000008, -1.600000000000001, -1.700000000000001, -2.1000000000000014, -1.700000000000001, -1.8000000000000012, -2.1000000000000014, -1.5000000000000009, -1.8000000000000012, -2.1000000000000014, -5.699999999999998, -2.2000000000000015, -2.4000000000000017, -1.9000000000000012, -3.200000000000001, -2.2000000000000015, -1.600000000000001, -1.8000000000000012, -1.8000000000000012, -1.700000000000001, -2.0000000000000013, -2.700000000000002, -2.2000000000000015, -3.200000000000001, -2.2000000000000015, -3.1000000000000014, -2.1000000000000014, -2.0000000000000013, -1.700000000000001, -2.4000000000000017, -1.8000000000000012, -1.700000000000001, -2.3000000000000016, -2.0000000000000013, -1.9000000000000012, -1.5000000000000009, -1.700000000000001, -1.9000000000000012, -2.4000000000000017, -2.0000000000000013, -2.1000000000000014, -2.2000000000000015, -2.2000000000000015, -2.4000000000000017, -1.8000000000000012, -1.600000000000001, -1.8000000000000012, -1.600000000000001, -2.1000000000000014, -1.8000000000000012, -2.0000000000000013, -1.9000000000000012, -1.5000000000000009, -1.9000000000000012, -2.3000000000000016, -10.699999999999992, -3.200000000000002, -2.1000000000000014, -1.700000000000001, -2.5000000000000018, -1.9000000000000012, -2.3000000000000016, -2.0000000000000013, -1.9000000000000012, -1.9000000000000012, -2.1000000000000014, -1.9000000000000012, -2.0000000000000013, -1.8000000000000012, -1.9000000000000012, -1.8000000000000012, -2.3000000000000016, -1.8000000000000012, -1.8000000000000012, -1.8000000000000012, -1.600000000000001, -1.8000000000000012, -2.1000000000000014, -1.5000000000000009, -2.0000000000000013, -1.5000000000000009, -1.700000000000001, -1.9000000000000012, -2.3000000000000016, -2.4000000000000017, -1.5000000000000009, -1.5000000000000009, -1.4000000000000008, -1.700000000000001, -1.5000000000000009, -1.9000000000000012, -2.0000000000000013, -2.0000000000000013, -2.900000000000002, -2.3000000000000016, -1.5000000000000009, -1.4000000000000008, -1.8000000000000012, -2.1000000000000014, -1.9000000000000012, -2.0000000000000013, -2.1000000000000014, -2.1000000000000014, -1.5000000000000009, -1.8000000000000012, -1.4000000000000008, -2.600000000000002, -2.1000000000000014, -1.600000000000001, -1.700000000000001, -1.700000000000001, -1.4000000000000008, -2.0000000000000013], "episode_lengths": [33, 27, 30, 31, 45, 27, 31, 34, 27, 31, 30, 29, 29, 29, 28, 25, 27, 28, 32, 28, 29, 32, 26, 29, 32, 56, 33, 35, 30, 43, 33, 27, 29, 29, 28, 31, 38, 33, 43, 33, 41, 32, 31, 28, 35, 29, 28, 34, 31, 30, 26, 28, 30, 35, 31, 32, 33, 33, 35, 29, 27, 29, 27, 32, 29, 31, 30, 26, 30, 34, 75, 35, 32, 28, 36, 30, 34, 31, 30, 30, 32, 30, 31, 29, 30, 29, 34, 29, 29, 29, 27, 29, 32, 26, 31, 26, 28, 30, 34, 35, 26, 26, 25, 28, 26, 30, 31, 31, 40, 34, 26, 25, 29, 32, 30, 31, 32, 32, 26, 29, 25, 37, 32, 27, 28, 28, 25, 31]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.35659084611168357, "mean_inference_ms": 0.7274729978373811, "mean_action_processing_ms": 0.0756525243440164, "mean_env_wait_ms": 7.134346487338481, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006798282265663147, "StateBufferConnector_ms": 0.003857165575027466, "ViewRequirementAgentConnector_ms": 0.0873170793056488}, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 392000, "num_agent_steps_trained": 392000, "num_env_steps_sampled": 392000, "num_env_steps_trained": 392000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 425.09267696646094, "num_env_steps_trained_throughput_per_sec": 425.09267696646094, "timesteps_total": 392000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 392000, "timers": {"training_iteration_time_ms": 9645.218, "sample_time_ms": 6125.792, "load_time_ms": 1.037, "load_throughput": 3855944.84, "learn_time_ms": 3515.649, "learn_throughput": 1137.77, "synch_weights_time_ms": 2.095}, "counters": {"num_env_steps_sampled": 392000, "num_env_steps_trained": 392000, "num_agent_steps_sampled": 392000, "num_agent_steps_trained": 392000}, "done": false, "episodes_total": 8498, "training_iteration": 98, "trial_id": "ddfb6_00000", "date": "2024-03-07_13-03-52", "timestamp": 1709834632, "time_this_iter_s": 9.412622690200806, "time_total_s": 931.7318532466888, "pid": 112355, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4d85689f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 931.7318532466888, "iterations_since_restore": 98, "perf": {"cpu_util_percent": 28.441666666666666, "ram_util_percent": 47.81666666666666, "gpu_util_percent0": 0.05916666666666667, "vram_util_percent0": 0.10670301649305557}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.14238281249999996, "cur_lr": 0.0010000000000000005, "total_loss": 0.7932815850020751, "policy_loss": -0.003274190776808668, "vf_loss": 0.7954558384739944, "vf_explained_var": 0.7706285486298222, "kl": 0.007725232299017864, "entropy": 0.2949438274357348, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 91605.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 396000, "num_env_steps_trained": 396000, "num_agent_steps_sampled": 396000, "num_agent_steps_trained": 396000}, "sampler_results": {"episode_reward_max": -1.4000000000000008, "episode_reward_min": -77.00000000000055, "episode_reward_mean": -2.602521008403367, "episode_len_mean": 33.66386554621849, "episode_media": {}, "episodes_this_iter": 119, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2.700000000000002, -1.600000000000001, -1.8000000000000012, -77.00000000000055, -1.8000000000000012, -1.9000000000000012, -1.9000000000000012, -1.700000000000001, -1.8000000000000012, -2.0000000000000013, -2.1000000000000014, -2.2000000000000015, -1.700000000000001, -2.0000000000000013, -2.2000000000000015, -2.0000000000000013, -2.4000000000000017, -1.9000000000000012, -1.8000000000000012, -1.4000000000000008, -1.8000000000000012, -1.700000000000001, -1.600000000000001, -1.5000000000000009, -2.3000000000000016, -2.1000000000000014, -2.900000000000002, -1.600000000000001, -1.600000000000001, -1.9000000000000012, -1.9000000000000012, -1.9000000000000012, -2.5000000000000018, -2.2000000000000015, -1.700000000000001, -2.700000000000002, -1.700000000000001, -2.2000000000000015, -2.4000000000000017, -2.2000000000000015, -1.9000000000000012, -1.5000000000000009, -1.8000000000000012, -1.8000000000000012, -1.4000000000000008, -1.8000000000000012, -2.0000000000000013, -1.8000000000000012, -2.2000000000000015, -1.4000000000000008, -2.2000000000000015, -1.8000000000000012, -2.0000000000000013, -1.9000000000000012, -2.1000000000000014, -2.3000000000000016, -2.2000000000000015, -2.1000000000000014, -1.8000000000000012, -1.8000000000000012, -2.2000000000000015, -2.0000000000000013, -1.9000000000000012, -1.700000000000001, -1.700000000000001, -1.700000000000001, -1.8000000000000012, -2.2000000000000015, -2.3000000000000016, -1.8000000000000012, -2.0000000000000013, -1.8000000000000012, -2.0000000000000013, -3.500000000000001, -1.9000000000000012, -2.1000000000000014, -1.5000000000000009, -1.9000000000000012, -1.600000000000001, -2.600000000000002, -2.700000000000002, -2.0000000000000013, -2.0000000000000013, -2.2000000000000015, -2.0000000000000013, -1.8000000000000012, -1.8000000000000012, -2.1000000000000014, -2.1000000000000014, -1.8000000000000012, -1.9000000000000012, -2.0000000000000013, -1.600000000000001, -2.900000000000002, -2.0000000000000013, -2.0000000000000013, -1.5000000000000009, -1.5000000000000009, -2.600000000000002, -1.8000000000000012, -1.700000000000001, -1.8000000000000012, -1.700000000000001, -2.900000000000002, -1.8000000000000012, -1.700000000000001, -2.4000000000000017, -1.8000000000000012, -1.8000000000000012, -1.9000000000000012, -1.600000000000001, -2.0000000000000013, -2.0000000000000013, -2.2000000000000015, -1.600000000000001, -1.9000000000000012, -1.8000000000000012, -2.700000000000002, -1.8000000000000012], "episode_lengths": [38, 27, 29, 400, 29, 30, 30, 28, 29, 31, 32, 33, 28, 31, 33, 31, 35, 30, 29, 25, 29, 28, 27, 26, 34, 32, 34, 27, 27, 30, 30, 30, 36, 33, 28, 38, 28, 33, 35, 33, 30, 26, 29, 29, 25, 29, 31, 29, 33, 25, 33, 29, 31, 30, 32, 34, 33, 32, 29, 29, 33, 30, 30, 28, 28, 28, 29, 33, 34, 29, 31, 29, 31, 38, 30, 32, 26, 30, 27, 37, 38, 31, 31, 33, 31, 29, 29, 32, 32, 29, 30, 31, 27, 36, 31, 31, 26, 26, 37, 29, 28, 29, 28, 40, 29, 28, 35, 29, 29, 30, 27, 31, 31, 33, 27, 30, 29, 38, 29]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.35733862398890576, "mean_inference_ms": 0.7274030605142828, "mean_action_processing_ms": 0.07568323648352461, "mean_env_wait_ms": 7.147966747644466, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006528060977198496, "StateBufferConnector_ms": 0.003811090934176405, "ViewRequirementAgentConnector_ms": 0.08613241820776162}}, "episode_reward_max": -1.4000000000000008, "episode_reward_min": -77.00000000000055, "episode_reward_mean": -2.602521008403367, "episode_len_mean": 33.66386554621849, "episodes_this_iter": 119, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-2.700000000000002, -1.600000000000001, -1.8000000000000012, -77.00000000000055, -1.8000000000000012, -1.9000000000000012, -1.9000000000000012, -1.700000000000001, -1.8000000000000012, -2.0000000000000013, -2.1000000000000014, -2.2000000000000015, -1.700000000000001, -2.0000000000000013, -2.2000000000000015, -2.0000000000000013, -2.4000000000000017, -1.9000000000000012, -1.8000000000000012, -1.4000000000000008, -1.8000000000000012, -1.700000000000001, -1.600000000000001, -1.5000000000000009, -2.3000000000000016, -2.1000000000000014, -2.900000000000002, -1.600000000000001, -1.600000000000001, -1.9000000000000012, -1.9000000000000012, -1.9000000000000012, -2.5000000000000018, -2.2000000000000015, -1.700000000000001, -2.700000000000002, -1.700000000000001, -2.2000000000000015, -2.4000000000000017, -2.2000000000000015, -1.9000000000000012, -1.5000000000000009, -1.8000000000000012, -1.8000000000000012, -1.4000000000000008, -1.8000000000000012, -2.0000000000000013, -1.8000000000000012, -2.2000000000000015, -1.4000000000000008, -2.2000000000000015, -1.8000000000000012, -2.0000000000000013, -1.9000000000000012, -2.1000000000000014, -2.3000000000000016, -2.2000000000000015, -2.1000000000000014, -1.8000000000000012, -1.8000000000000012, -2.2000000000000015, -2.0000000000000013, -1.9000000000000012, -1.700000000000001, -1.700000000000001, -1.700000000000001, -1.8000000000000012, -2.2000000000000015, -2.3000000000000016, -1.8000000000000012, -2.0000000000000013, -1.8000000000000012, -2.0000000000000013, -3.500000000000001, -1.9000000000000012, -2.1000000000000014, -1.5000000000000009, -1.9000000000000012, -1.600000000000001, -2.600000000000002, -2.700000000000002, -2.0000000000000013, -2.0000000000000013, -2.2000000000000015, -2.0000000000000013, -1.8000000000000012, -1.8000000000000012, -2.1000000000000014, -2.1000000000000014, -1.8000000000000012, -1.9000000000000012, -2.0000000000000013, -1.600000000000001, -2.900000000000002, -2.0000000000000013, -2.0000000000000013, -1.5000000000000009, -1.5000000000000009, -2.600000000000002, -1.8000000000000012, -1.700000000000001, -1.8000000000000012, -1.700000000000001, -2.900000000000002, -1.8000000000000012, -1.700000000000001, -2.4000000000000017, -1.8000000000000012, -1.8000000000000012, -1.9000000000000012, -1.600000000000001, -2.0000000000000013, -2.0000000000000013, -2.2000000000000015, -1.600000000000001, -1.9000000000000012, -1.8000000000000012, -2.700000000000002, -1.8000000000000012], "episode_lengths": [38, 27, 29, 400, 29, 30, 30, 28, 29, 31, 32, 33, 28, 31, 33, 31, 35, 30, 29, 25, 29, 28, 27, 26, 34, 32, 34, 27, 27, 30, 30, 30, 36, 33, 28, 38, 28, 33, 35, 33, 30, 26, 29, 29, 25, 29, 31, 29, 33, 25, 33, 29, 31, 30, 32, 34, 33, 32, 29, 29, 33, 30, 30, 28, 28, 28, 29, 33, 34, 29, 31, 29, 31, 38, 30, 32, 26, 30, 27, 37, 38, 31, 31, 33, 31, 29, 29, 32, 32, 29, 30, 31, 27, 36, 31, 31, 26, 26, 37, 29, 28, 29, 28, 40, 29, 28, 35, 29, 29, 30, 27, 31, 31, 33, 27, 30, 29, 38, 29]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.35733862398890576, "mean_inference_ms": 0.7274030605142828, "mean_action_processing_ms": 0.07568323648352461, "mean_env_wait_ms": 7.147966747644466, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006528060977198496, "StateBufferConnector_ms": 0.003811090934176405, "ViewRequirementAgentConnector_ms": 0.08613241820776162}, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 396000, "num_agent_steps_trained": 396000, "num_env_steps_sampled": 396000, "num_env_steps_trained": 396000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 430.9996592020107, "num_env_steps_trained_throughput_per_sec": 430.9996592020107, "timesteps_total": 396000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 396000, "timers": {"training_iteration_time_ms": 9626.882, "sample_time_ms": 6114.033, "load_time_ms": 1.034, "load_throughput": 3867589.387, "learn_time_ms": 3509.075, "learn_throughput": 1139.901, "synch_weights_time_ms": 2.092}, "counters": {"num_env_steps_sampled": 396000, "num_env_steps_trained": 396000, "num_agent_steps_sampled": 396000, "num_agent_steps_trained": 396000}, "done": false, "episodes_total": 8617, "training_iteration": 99, "trial_id": "ddfb6_00000", "date": "2024-03-07_13-04-01", "timestamp": 1709834641, "time_this_iter_s": 9.283497333526611, "time_total_s": 941.0153505802155, "pid": 112355, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4d85689f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 941.0153505802155, "iterations_since_restore": 99, "perf": {"cpu_util_percent": 27.299999999999997, "ram_util_percent": 47.824999999999996, "gpu_util_percent0": 0.07583333333333332, "vram_util_percent0": 0.10670301649305554}}
{"evaluation": {"sampler_results": {"episode_reward_max": -1.5000000000000009, "episode_reward_min": -2.600000000000002, "episode_reward_mean": -2.0050000000000017, "episode_len_mean": 31.05, "episode_media": {}, "episodes_this_iter": 20, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2.4000000000000017, -1.8000000000000012, -2.3000000000000016, -1.9000000000000012, -1.8000000000000012, -2.0000000000000013, -1.8000000000000012, -1.600000000000001, -1.5000000000000009, -1.8000000000000012, -2.3000000000000016, -2.5000000000000018, -2.2000000000000015, -2.1000000000000014, -2.600000000000002, -2.0000000000000013, -2.3000000000000016, -1.5000000000000009, -1.8000000000000012, -1.9000000000000012], "episode_lengths": [35, 29, 34, 30, 29, 31, 29, 27, 26, 29, 34, 36, 33, 32, 37, 31, 34, 26, 29, 30]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3571695309777983, "mean_inference_ms": 1.172696273338976, "mean_action_processing_ms": 0.06833052272118895, "mean_env_wait_ms": 6.864987394790705, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004156827926635742, "StateBufferConnector_ms": 0.002644062042236328, "ViewRequirementAgentConnector_ms": 0.06306767463684082}}, "episode_reward_max": -1.5000000000000009, "episode_reward_min": -2.600000000000002, "episode_reward_mean": -2.0050000000000017, "episode_len_mean": 31.05, "episode_media": {}, "episodes_this_iter": 20, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2.4000000000000017, -1.8000000000000012, -2.3000000000000016, -1.9000000000000012, -1.8000000000000012, -2.0000000000000013, -1.8000000000000012, -1.600000000000001, -1.5000000000000009, -1.8000000000000012, -2.3000000000000016, -2.5000000000000018, -2.2000000000000015, -2.1000000000000014, -2.600000000000002, -2.0000000000000013, -2.3000000000000016, -1.5000000000000009, -1.8000000000000012, -1.9000000000000012], "episode_lengths": [35, 29, 34, 30, 29, 31, 29, 27, 26, 29, 34, 36, 33, 32, 37, 31, 34, 26, 29, 30]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3571695309777983, "mean_inference_ms": 1.172696273338976, "mean_action_processing_ms": 0.06833052272118895, "mean_env_wait_ms": 6.864987394790705, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004156827926635742, "StateBufferConnector_ms": 0.002644062042236328, "ViewRequirementAgentConnector_ms": 0.06306767463684082}, "num_agent_steps_sampled_this_iter": 621, "num_env_steps_sampled_this_iter": 621, "timesteps_this_iter": 621, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.14238281249999996, "cur_lr": 0.0010000000000000005, "total_loss": 1.117262323376953, "policy_loss": -0.008327528507879345, "vf_loss": 1.1240954911521566, "vf_explained_var": 0.5763406858008395, "kl": 0.010495346421453857, "entropy": 0.2698493557311194, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 92535.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 400000, "num_env_steps_trained": 400000, "num_agent_steps_sampled": 400000, "num_agent_steps_trained": 400000}, "sampler_results": {"episode_reward_max": -1.4000000000000008, "episode_reward_min": -77.20000000000056, "episode_reward_mean": -3.336893203883506, "episode_len_mean": 36.970873786407765, "episode_media": {}, "episodes_this_iter": 103, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1.8000000000000012, -1.4000000000000008, -76.80000000000055, -2.5000000000000018, -1.700000000000001, -2.2000000000000015, -2.3000000000000016, -2.1000000000000014, -1.9000000000000012, -1.5000000000000009, -2.0000000000000013, -2.4000000000000017, -1.8000000000000012, -1.700000000000001, -1.700000000000001, -1.8000000000000012, -1.600000000000001, -1.700000000000001, -2.1000000000000014, -1.5000000000000009, -1.9000000000000012, -1.9000000000000012, -1.700000000000001, -1.700000000000001, -1.600000000000001, -2.2000000000000015, -1.600000000000001, -2.3000000000000016, -1.5000000000000009, -1.9000000000000012, -1.5000000000000009, -2.3000000000000016, -2.1000000000000014, -2.0000000000000013, -1.700000000000001, -2.2000000000000015, -1.9000000000000012, -1.8000000000000012, -2.0000000000000013, -1.9000000000000012, -2.0000000000000013, -1.8000000000000012, -1.9000000000000012, -1.4000000000000008, -1.9000000000000012, -1.4000000000000008, -1.8000000000000012, -1.9000000000000012, -1.9000000000000012, -1.600000000000001, -1.600000000000001, -1.5000000000000009, -1.8000000000000012, -1.600000000000001, -2.4000000000000017, -2.0000000000000013, -2.0000000000000013, -1.700000000000001, -1.700000000000001, -1.5000000000000009, -2.3000000000000016, -2.0000000000000013, -1.8000000000000012, -2.1000000000000014, -1.600000000000001, -2.2000000000000015, -1.600000000000001, -1.8000000000000012, -1.9000000000000012, -1.8000000000000012, -1.8000000000000012, -1.700000000000001, -1.8000000000000012, -2.3000000000000016, -1.5000000000000009, -2.800000000000002, -1.9000000000000012, -2.0000000000000013, -1.8000000000000012, -1.600000000000001, -2.1000000000000014, -1.600000000000001, -1.9000000000000012, -1.8000000000000012, -1.600000000000001, -1.700000000000001, -2.3000000000000016, -1.8000000000000012, -1.600000000000001, -1.9000000000000012, -1.8000000000000012, -1.700000000000001, -2.1000000000000014, -2.1000000000000014, -77.20000000000056, -1.600000000000001, -2.4000000000000017, -1.9000000000000012, -2.800000000000002, -1.9000000000000012, -2.1000000000000014, -2.2000000000000015, -1.700000000000001], "episode_lengths": [29, 25, 400, 36, 28, 33, 34, 32, 30, 26, 31, 35, 29, 28, 28, 29, 27, 28, 32, 26, 30, 30, 28, 28, 27, 33, 27, 34, 26, 30, 26, 34, 32, 31, 28, 33, 30, 29, 31, 30, 31, 29, 30, 25, 30, 25, 29, 30, 30, 27, 27, 26, 29, 27, 35, 31, 31, 28, 28, 26, 34, 31, 29, 32, 27, 33, 27, 29, 30, 29, 29, 28, 29, 34, 26, 39, 30, 31, 29, 27, 32, 27, 30, 29, 27, 28, 34, 29, 27, 30, 29, 28, 32, 32, 400, 27, 35, 30, 39, 30, 32, 33, 28]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.35839801180322606, "mean_inference_ms": 0.7272145645447868, "mean_action_processing_ms": 0.07573255838306475, "mean_env_wait_ms": 7.152624686991839, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006545863105255423, "StateBufferConnector_ms": 0.0037197927826816595, "ViewRequirementAgentConnector_ms": 0.08630173877604956}}, "episode_reward_max": -1.4000000000000008, "episode_reward_min": -77.20000000000056, "episode_reward_mean": -3.336893203883506, "episode_len_mean": 36.970873786407765, "episodes_this_iter": 103, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1.8000000000000012, -1.4000000000000008, -76.80000000000055, -2.5000000000000018, -1.700000000000001, -2.2000000000000015, -2.3000000000000016, -2.1000000000000014, -1.9000000000000012, -1.5000000000000009, -2.0000000000000013, -2.4000000000000017, -1.8000000000000012, -1.700000000000001, -1.700000000000001, -1.8000000000000012, -1.600000000000001, -1.700000000000001, -2.1000000000000014, -1.5000000000000009, -1.9000000000000012, -1.9000000000000012, -1.700000000000001, -1.700000000000001, -1.600000000000001, -2.2000000000000015, -1.600000000000001, -2.3000000000000016, -1.5000000000000009, -1.9000000000000012, -1.5000000000000009, -2.3000000000000016, -2.1000000000000014, -2.0000000000000013, -1.700000000000001, -2.2000000000000015, -1.9000000000000012, -1.8000000000000012, -2.0000000000000013, -1.9000000000000012, -2.0000000000000013, -1.8000000000000012, -1.9000000000000012, -1.4000000000000008, -1.9000000000000012, -1.4000000000000008, -1.8000000000000012, -1.9000000000000012, -1.9000000000000012, -1.600000000000001, -1.600000000000001, -1.5000000000000009, -1.8000000000000012, -1.600000000000001, -2.4000000000000017, -2.0000000000000013, -2.0000000000000013, -1.700000000000001, -1.700000000000001, -1.5000000000000009, -2.3000000000000016, -2.0000000000000013, -1.8000000000000012, -2.1000000000000014, -1.600000000000001, -2.2000000000000015, -1.600000000000001, -1.8000000000000012, -1.9000000000000012, -1.8000000000000012, -1.8000000000000012, -1.700000000000001, -1.8000000000000012, -2.3000000000000016, -1.5000000000000009, -2.800000000000002, -1.9000000000000012, -2.0000000000000013, -1.8000000000000012, -1.600000000000001, -2.1000000000000014, -1.600000000000001, -1.9000000000000012, -1.8000000000000012, -1.600000000000001, -1.700000000000001, -2.3000000000000016, -1.8000000000000012, -1.600000000000001, -1.9000000000000012, -1.8000000000000012, -1.700000000000001, -2.1000000000000014, -2.1000000000000014, -77.20000000000056, -1.600000000000001, -2.4000000000000017, -1.9000000000000012, -2.800000000000002, -1.9000000000000012, -2.1000000000000014, -2.2000000000000015, -1.700000000000001], "episode_lengths": [29, 25, 400, 36, 28, 33, 34, 32, 30, 26, 31, 35, 29, 28, 28, 29, 27, 28, 32, 26, 30, 30, 28, 28, 27, 33, 27, 34, 26, 30, 26, 34, 32, 31, 28, 33, 30, 29, 31, 30, 31, 29, 30, 25, 30, 25, 29, 30, 30, 27, 27, 26, 29, 27, 35, 31, 31, 28, 28, 26, 34, 31, 29, 32, 27, 33, 27, 29, 30, 29, 29, 28, 29, 34, 26, 39, 30, 31, 29, 27, 32, 27, 30, 29, 27, 28, 34, 29, 27, 30, 29, 28, 32, 32, 400, 27, 35, 30, 39, 30, 32, 33, 28]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.35839801180322606, "mean_inference_ms": 0.7272145645447868, "mean_action_processing_ms": 0.07573255838306475, "mean_env_wait_ms": 7.152624686991839, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006545863105255423, "StateBufferConnector_ms": 0.0037197927826816595, "ViewRequirementAgentConnector_ms": 0.08630173877604956}, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 400000, "num_agent_steps_trained": 400000, "num_env_steps_sampled": 400000, "num_env_steps_trained": 400000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 417.2367050070023, "num_env_steps_trained_throughput_per_sec": 417.2367050070023, "timesteps_total": 400000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 400000, "timers": {"training_iteration_time_ms": 9649.492, "sample_time_ms": 6130.994, "load_time_ms": 0.994, "load_throughput": 4023120.234, "learn_time_ms": 3514.751, "learn_throughput": 1138.061, "synch_weights_time_ms": 2.117}, "counters": {"num_env_steps_sampled": 400000, "num_env_steps_trained": 400000, "num_agent_steps_sampled": 400000, "num_agent_steps_trained": 400000}, "done": true, "episodes_total": 8720, "training_iteration": 100, "trial_id": "ddfb6_00000", "date": "2024-03-07_13-04-16", "timestamp": 1709834656, "time_this_iter_s": 14.751010179519653, "time_total_s": 955.7663607597351, "pid": 112355, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4d85689f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 955.7663607597351, "iterations_since_restore": 100, "perf": {"cpu_util_percent": 19.259999999999998, "ram_util_percent": 47.84499999999999, "gpu_util_percent0": 0.05600000000000001, "vram_util_percent0": 0.10385335286458335}}
