{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 7.941806040784364, "policy_loss": 0.006274922260193414, "vf_loss": 7.934350919210782, "vf_explained_var": 0.003615628711638912, "kl": 0.005901066748621007, "entropy": 1.092781432597868, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 465.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000}, "sampler_results": {"episode_reward_max": -9.499999999999979, "episode_reward_min": -62.30000000000043, "episode_reward_mean": -35.30000000000017, "episode_len_mean": 272.0, "episode_media": {}, "episodes_this_iter": 9, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-43.400000000000205, -9.499999999999979, -11.599999999999971, -62.30000000000043, -22.499999999999957, -11.09999999999999, -54.00000000000034, -49.00000000000034, -54.30000000000028], "episode_lengths": [348, 105, 127, 400, 169, 99, 400, 400, 400]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.22948166303027623, "mean_inference_ms": 0.7224772451827572, "mean_action_processing_ms": 0.07729134820839549, "mean_env_wait_ms": 6.29183917702315, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007703569200303819, "StateBufferConnector_ms": 0.0038279427422417533, "ViewRequirementAgentConnector_ms": 0.08753670586480035}}, "episode_reward_max": -9.499999999999979, "episode_reward_min": -62.30000000000043, "episode_reward_mean": -35.30000000000017, "episode_len_mean": 272.0, "episodes_this_iter": 9, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-43.400000000000205, -9.499999999999979, -11.599999999999971, -62.30000000000043, -22.499999999999957, -11.09999999999999, -54.00000000000034, -49.00000000000034, -54.30000000000028], "episode_lengths": [348, 105, 127, 400, 169, 99, 400, 400, 400]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.22948166303027623, "mean_inference_ms": 0.7224772451827572, "mean_action_processing_ms": 0.07729134820839549, "mean_env_wait_ms": 6.29183917702315, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007703569200303819, "StateBufferConnector_ms": 0.0038279427422417533, "ViewRequirementAgentConnector_ms": 0.08753670586480035}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 542.4614941202516, "num_env_steps_trained_throughput_per_sec": 542.4614941202516, "timesteps_total": 4000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 4000, "timers": {"training_iteration_time_ms": 7373.731, "sample_time_ms": 3741.298, "load_time_ms": 0.916, "load_throughput": 4366792.296, "learn_time_ms": 3628.228, "learn_throughput": 1102.467, "synch_weights_time_ms": 2.42}, "counters": {"num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000}, "done": false, "episodes_total": 9, "training_iteration": 1, "trial_id": "04cbf_00000", "date": "2024-03-07_13-18-10", "timestamp": 1709835490, "time_this_iter_s": 7.376254081726074, "time_total_s": 7.376254081726074, "pid": 119109, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7efea6399f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 7.376254081726074, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 27.899999999999995, "ram_util_percent": 50.510000000000005, "gpu_util_percent0": 0.07100000000000001, "vram_util_percent0": 0.09124348958333335}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 5.071330275362538, "policy_loss": -0.008988235209898282, "vf_loss": 5.07869179697447, "vf_explained_var": 4.646733242978332e-05, "kl": 0.008133550767670776, "entropy": 1.0771682176538693, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 1395.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000}, "sampler_results": {"episode_reward_max": -6.599999999999989, "episode_reward_min": -70.30000000000045, "episode_reward_mean": -38.19130434782629, "episode_len_mean": 286.04347826086956, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-43.400000000000205, -9.499999999999979, -11.599999999999971, -62.30000000000043, -22.499999999999957, -11.09999999999999, -54.00000000000034, -49.00000000000034, -54.30000000000028, -56.0000000000003, -70.30000000000045, -9.499999999999979, -38.10000000000024, -65.10000000000046, -24.60000000000001, -53.800000000000374, -15.599999999999966, -54.6000000000003, -6.899999999999988, -63.0000000000004, -48.90000000000029, -6.599999999999989, -47.70000000000033], "episode_lengths": [348, 105, 127, 400, 169, 99, 400, 400, 400, 400, 400, 106, 314, 400, 189, 400, 165, 400, 80, 400, 400, 77, 400]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23177117498708574, "mean_inference_ms": 0.724210858404117, "mean_action_processing_ms": 0.07724772680285118, "mean_env_wait_ms": 6.27985445100491, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007707139720087466, "StateBufferConnector_ms": 0.0038613443789274797, "ViewRequirementAgentConnector_ms": 0.08875701738440472}}, "episode_reward_max": -6.599999999999989, "episode_reward_min": -70.30000000000045, "episode_reward_mean": -38.19130434782629, "episode_len_mean": 286.04347826086956, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-43.400000000000205, -9.499999999999979, -11.599999999999971, -62.30000000000043, -22.499999999999957, -11.09999999999999, -54.00000000000034, -49.00000000000034, -54.30000000000028, -56.0000000000003, -70.30000000000045, -9.499999999999979, -38.10000000000024, -65.10000000000046, -24.60000000000001, -53.800000000000374, -15.599999999999966, -54.6000000000003, -6.899999999999988, -63.0000000000004, -48.90000000000029, -6.599999999999989, -47.70000000000033], "episode_lengths": [348, 105, 127, 400, 169, 99, 400, 400, 400, 400, 400, 106, 314, 400, 189, 400, 165, 400, 80, 400, 400, 77, 400]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23177117498708574, "mean_inference_ms": 0.724210858404117, "mean_action_processing_ms": 0.07724772680285118, "mean_env_wait_ms": 6.27985445100491, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007707139720087466, "StateBufferConnector_ms": 0.0038613443789274797, "ViewRequirementAgentConnector_ms": 0.08875701738440472}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 554.0157950422218, "num_env_steps_trained_throughput_per_sec": 554.0157950422218, "timesteps_total": 8000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 8000, "timers": {"training_iteration_time_ms": 7296.857, "sample_time_ms": 3737.449, "load_time_ms": 0.869, "load_throughput": 4602171.444, "learn_time_ms": 3555.275, "learn_throughput": 1125.089, "synch_weights_time_ms": 2.482}, "counters": {"num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000}, "done": false, "episodes_total": 23, "training_iteration": 2, "trial_id": "04cbf_00000", "date": "2024-03-07_13-18-17", "timestamp": 1709835497, "time_this_iter_s": 7.222295045852661, "time_total_s": 14.598549127578735, "pid": 119109, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7efea6399f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 14.598549127578735, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 28.250000000000007, "ram_util_percent": 50.8, "gpu_util_percent0": 0.093, "vram_util_percent0": 0.091650390625}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 5.0379758742227345, "policy_loss": -0.008159560121355517, "vf_loss": 5.044616064950023, "vf_explained_var": 0.0002828673649859685, "kl": 0.007596790215417508, "entropy": 1.0677783682141253, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 2325.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000}, "sampler_results": {"episode_reward_max": -6.599999999999989, "episode_reward_min": -70.30000000000045, "episode_reward_mean": -37.32500000000019, "episode_len_mean": 289.4166666666667, "episode_media": {}, "episodes_this_iter": 13, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-43.400000000000205, -9.499999999999979, -11.599999999999971, -62.30000000000043, -22.499999999999957, -11.09999999999999, -54.00000000000034, -49.00000000000034, -54.30000000000028, -56.0000000000003, -70.30000000000045, -9.499999999999979, -38.10000000000024, -65.10000000000046, -24.60000000000001, -53.800000000000374, -15.599999999999966, -54.6000000000003, -6.899999999999988, -63.0000000000004, -48.90000000000029, -6.599999999999989, -47.70000000000033, -54.30000000000024, -16.099999999999984, -58.00000000000036, -46.00000000000031, -49.40000000000031, -46.70000000000031, -53.20000000000034, -20.400000000000002, -10.299999999999978, -7.799999999999992, -23.800000000000047, -47.90000000000035, -31.400000000000063], "episode_lengths": [348, 105, 127, 400, 169, 99, 400, 400, 400, 400, 400, 106, 314, 400, 189, 400, 165, 400, 80, 400, 400, 77, 400, 400, 157, 400, 400, 400, 400, 400, 186, 112, 81, 226, 400, 278]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2321275432230168, "mean_inference_ms": 0.7235475563442442, "mean_action_processing_ms": 0.07706700338664761, "mean_env_wait_ms": 6.284734855025084, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00752409299214681, "StateBufferConnector_ms": 0.003889534208509657, "ViewRequirementAgentConnector_ms": 0.08867383003234863}}, "episode_reward_max": -6.599999999999989, "episode_reward_min": -70.30000000000045, "episode_reward_mean": -37.32500000000019, "episode_len_mean": 289.4166666666667, "episodes_this_iter": 13, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-43.400000000000205, -9.499999999999979, -11.599999999999971, -62.30000000000043, -22.499999999999957, -11.09999999999999, -54.00000000000034, -49.00000000000034, -54.30000000000028, -56.0000000000003, -70.30000000000045, -9.499999999999979, -38.10000000000024, -65.10000000000046, -24.60000000000001, -53.800000000000374, -15.599999999999966, -54.6000000000003, -6.899999999999988, -63.0000000000004, -48.90000000000029, -6.599999999999989, -47.70000000000033, -54.30000000000024, -16.099999999999984, -58.00000000000036, -46.00000000000031, -49.40000000000031, -46.70000000000031, -53.20000000000034, -20.400000000000002, -10.299999999999978, -7.799999999999992, -23.800000000000047, -47.90000000000035, -31.400000000000063], "episode_lengths": [348, 105, 127, 400, 169, 99, 400, 400, 400, 400, 400, 106, 314, 400, 189, 400, 165, 400, 80, 400, 400, 77, 400, 400, 157, 400, 400, 400, 400, 400, 186, 112, 81, 226, 400, 278]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2321275432230168, "mean_inference_ms": 0.7235475563442442, "mean_action_processing_ms": 0.07706700338664761, "mean_env_wait_ms": 6.284734855025084, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00752409299214681, "StateBufferConnector_ms": 0.003889534208509657, "ViewRequirementAgentConnector_ms": 0.08867383003234863}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 545.6011235914863, "num_env_steps_trained_throughput_per_sec": 545.6011235914863, "timesteps_total": 12000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 12000, "timers": {"training_iteration_time_ms": 7308.348, "sample_time_ms": 3777.965, "load_time_ms": 0.951, "load_throughput": 4204464.79, "learn_time_ms": 3526.077, "learn_throughput": 1134.405, "synch_weights_time_ms": 2.59}, "counters": {"num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000}, "done": false, "episodes_total": 36, "training_iteration": 3, "trial_id": "04cbf_00000", "date": "2024-03-07_13-18-24", "timestamp": 1709835504, "time_this_iter_s": 7.333782911300659, "time_total_s": 21.932332038879395, "pid": 119109, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7efea6399f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 21.932332038879395, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 30.533333333333335, "ram_util_percent": 50.8, "gpu_util_percent0": 0.08666666666666667, "vram_util_percent0": 0.09163411458333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 3.9770433038152673, "policy_loss": -0.010210431351136137, "vf_loss": 3.9860334165153963, "vf_explained_var": -0.23438548996884337, "kl": 0.0061016536291930365, "entropy": 1.0567098224034874, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 3255.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000}, "sampler_results": {"episode_reward_max": -6.599999999999989, "episode_reward_min": -70.30000000000045, "episode_reward_mean": -37.78125000000019, "episode_len_mean": 294.2708333333333, "episode_media": {}, "episodes_this_iter": 12, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-43.400000000000205, -9.499999999999979, -11.599999999999971, -62.30000000000043, -22.499999999999957, -11.09999999999999, -54.00000000000034, -49.00000000000034, -54.30000000000028, -56.0000000000003, -70.30000000000045, -9.499999999999979, -38.10000000000024, -65.10000000000046, -24.60000000000001, -53.800000000000374, -15.599999999999966, -54.6000000000003, -6.899999999999988, -63.0000000000004, -48.90000000000029, -6.599999999999989, -47.70000000000033, -54.30000000000024, -16.099999999999984, -58.00000000000036, -46.00000000000031, -49.40000000000031, -46.70000000000031, -53.20000000000034, -20.400000000000002, -10.299999999999978, -7.799999999999992, -23.800000000000047, -47.90000000000035, -31.400000000000063, -49.20000000000016, -64.10000000000039, -50.20000000000024, -14.799999999999972, -6.799999999999988, -40.70000000000029, -30.700000000000003, -15.299999999999969, -39.50000000000032, -46.8000000000003, -50.300000000000246, -61.400000000000325], "episode_lengths": [348, 105, 127, 400, 169, 99, 400, 400, 400, 400, 400, 106, 314, 400, 189, 400, 165, 400, 80, 400, 400, 77, 400, 400, 157, 400, 400, 400, 400, 400, 186, 112, 81, 226, 400, 278, 345, 400, 400, 125, 79, 400, 250, 146, 361, 400, 400, 400]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23223373055334898, "mean_inference_ms": 0.7235135932759036, "mean_action_processing_ms": 0.07687967897784533, "mean_env_wait_ms": 6.2882003615737005, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007437666257222493, "StateBufferConnector_ms": 0.003890693187713623, "ViewRequirementAgentConnector_ms": 0.08874287207921346}}, "episode_reward_max": -6.599999999999989, "episode_reward_min": -70.30000000000045, "episode_reward_mean": -37.78125000000019, "episode_len_mean": 294.2708333333333, "episodes_this_iter": 12, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-43.400000000000205, -9.499999999999979, -11.599999999999971, -62.30000000000043, -22.499999999999957, -11.09999999999999, -54.00000000000034, -49.00000000000034, -54.30000000000028, -56.0000000000003, -70.30000000000045, -9.499999999999979, -38.10000000000024, -65.10000000000046, -24.60000000000001, -53.800000000000374, -15.599999999999966, -54.6000000000003, -6.899999999999988, -63.0000000000004, -48.90000000000029, -6.599999999999989, -47.70000000000033, -54.30000000000024, -16.099999999999984, -58.00000000000036, -46.00000000000031, -49.40000000000031, -46.70000000000031, -53.20000000000034, -20.400000000000002, -10.299999999999978, -7.799999999999992, -23.800000000000047, -47.90000000000035, -31.400000000000063, -49.20000000000016, -64.10000000000039, -50.20000000000024, -14.799999999999972, -6.799999999999988, -40.70000000000029, -30.700000000000003, -15.299999999999969, -39.50000000000032, -46.8000000000003, -50.300000000000246, -61.400000000000325], "episode_lengths": [348, 105, 127, 400, 169, 99, 400, 400, 400, 400, 400, 106, 314, 400, 189, 400, 165, 400, 80, 400, 400, 77, 400, 400, 157, 400, 400, 400, 400, 400, 186, 112, 81, 226, 400, 278, 345, 400, 400, 125, 79, 400, 250, 146, 361, 400, 400, 400]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23223373055334898, "mean_inference_ms": 0.7235135932759036, "mean_action_processing_ms": 0.07687967897784533, "mean_env_wait_ms": 6.2882003615737005, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007437666257222493, "StateBufferConnector_ms": 0.003890693187713623, "ViewRequirementAgentConnector_ms": 0.08874287207921346}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 540.1624632713894, "num_env_steps_trained_throughput_per_sec": 540.1624632713894, "timesteps_total": 16000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 16000, "timers": {"training_iteration_time_ms": 7332.548, "sample_time_ms": 3814.914, "load_time_ms": 0.948, "load_throughput": 4217500.251, "learn_time_ms": 3513.378, "learn_throughput": 1138.506, "synch_weights_time_ms": 2.587}, "counters": {"num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000}, "done": false, "episodes_total": 48, "training_iteration": 4, "trial_id": "04cbf_00000", "date": "2024-03-07_13-18-32", "timestamp": 1709835512, "time_this_iter_s": 7.4074671268463135, "time_total_s": 29.339799165725708, "pid": 119109, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7efea6399f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 29.339799165725708, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 28.310000000000002, "ram_util_percent": 50.78, "gpu_util_percent0": 0.093, "vram_util_percent0": 0.09165852864583333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 5.379659227786526, "policy_loss": -0.014611996714306134, "vf_loss": 5.392925416606088, "vf_explained_var": -0.1856032677876052, "kl": 0.0067290328264888125, "entropy": 1.03520202399582, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 4185.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 20000}, "sampler_results": {"episode_reward_max": -4.699999999999996, "episode_reward_min": -70.30000000000045, "episode_reward_mean": -35.5104477611942, "episode_len_mean": 282.25373134328356, "episode_media": {}, "episodes_this_iter": 19, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-43.400000000000205, -9.499999999999979, -11.599999999999971, -62.30000000000043, -22.499999999999957, -11.09999999999999, -54.00000000000034, -49.00000000000034, -54.30000000000028, -56.0000000000003, -70.30000000000045, -9.499999999999979, -38.10000000000024, -65.10000000000046, -24.60000000000001, -53.800000000000374, -15.599999999999966, -54.6000000000003, -6.899999999999988, -63.0000000000004, -48.90000000000029, -6.599999999999989, -47.70000000000033, -54.30000000000024, -16.099999999999984, -58.00000000000036, -46.00000000000031, -49.40000000000031, -46.70000000000031, -53.20000000000034, -20.400000000000002, -10.299999999999978, -7.799999999999992, -23.800000000000047, -47.90000000000035, -31.400000000000063, -49.20000000000016, -64.10000000000039, -50.20000000000024, -14.799999999999972, -6.799999999999988, -40.70000000000029, -30.700000000000003, -15.299999999999969, -39.50000000000032, -46.8000000000003, -50.300000000000246, -61.400000000000325, -49.0000000000004, -4.699999999999996, -7.799999999999985, -23.69999999999999, -46.100000000000286, -43.50000000000029, -23.400000000000027, -53.70000000000041, -17.399999999999988, -10.699999999999976, -36.00000000000006, -19.49999999999998, -49.50000000000032, -45.40000000000024, -15.099999999999959, -61.1000000000004, -27.600000000000065, -12.599999999999973, -18.899999999999988], "episode_lengths": [348, 105, 127, 400, 169, 99, 400, 400, 400, 400, 400, 106, 314, 400, 189, 400, 165, 400, 80, 400, 400, 77, 400, 400, 157, 400, 400, 400, 400, 400, 186, 112, 81, 226, 400, 278, 345, 400, 400, 125, 79, 400, 250, 146, 361, 400, 400, 400, 400, 58, 89, 200, 400, 400, 218, 400, 153, 106, 299, 194, 400, 400, 125, 400, 257, 111, 176]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2328022613999872, "mean_inference_ms": 0.7232139830981216, "mean_action_processing_ms": 0.07668491116116229, "mean_env_wait_ms": 6.2891423552069465, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007251127442317222, "StateBufferConnector_ms": 0.00390365942200618, "ViewRequirementAgentConnector_ms": 0.0890336819549105}}, "episode_reward_max": -4.699999999999996, "episode_reward_min": -70.30000000000045, "episode_reward_mean": -35.5104477611942, "episode_len_mean": 282.25373134328356, "episodes_this_iter": 19, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-43.400000000000205, -9.499999999999979, -11.599999999999971, -62.30000000000043, -22.499999999999957, -11.09999999999999, -54.00000000000034, -49.00000000000034, -54.30000000000028, -56.0000000000003, -70.30000000000045, -9.499999999999979, -38.10000000000024, -65.10000000000046, -24.60000000000001, -53.800000000000374, -15.599999999999966, -54.6000000000003, -6.899999999999988, -63.0000000000004, -48.90000000000029, -6.599999999999989, -47.70000000000033, -54.30000000000024, -16.099999999999984, -58.00000000000036, -46.00000000000031, -49.40000000000031, -46.70000000000031, -53.20000000000034, -20.400000000000002, -10.299999999999978, -7.799999999999992, -23.800000000000047, -47.90000000000035, -31.400000000000063, -49.20000000000016, -64.10000000000039, -50.20000000000024, -14.799999999999972, -6.799999999999988, -40.70000000000029, -30.700000000000003, -15.299999999999969, -39.50000000000032, -46.8000000000003, -50.300000000000246, -61.400000000000325, -49.0000000000004, -4.699999999999996, -7.799999999999985, -23.69999999999999, -46.100000000000286, -43.50000000000029, -23.400000000000027, -53.70000000000041, -17.399999999999988, -10.699999999999976, -36.00000000000006, -19.49999999999998, -49.50000000000032, -45.40000000000024, -15.099999999999959, -61.1000000000004, -27.600000000000065, -12.599999999999973, -18.899999999999988], "episode_lengths": [348, 105, 127, 400, 169, 99, 400, 400, 400, 400, 400, 106, 314, 400, 189, 400, 165, 400, 80, 400, 400, 77, 400, 400, 157, 400, 400, 400, 400, 400, 186, 112, 81, 226, 400, 278, 345, 400, 400, 125, 79, 400, 250, 146, 361, 400, 400, 400, 400, 58, 89, 200, 400, 400, 218, 400, 153, 106, 299, 194, 400, 400, 125, 400, 257, 111, 176]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2328022613999872, "mean_inference_ms": 0.7232139830981216, "mean_action_processing_ms": 0.07668491116116229, "mean_env_wait_ms": 6.2891423552069465, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007251127442317222, "StateBufferConnector_ms": 0.00390365942200618, "ViewRequirementAgentConnector_ms": 0.0890336819549105}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 20000, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 547.7965520835265, "num_env_steps_trained_throughput_per_sec": 547.7965520835265, "timesteps_total": 20000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 20000, "timers": {"training_iteration_time_ms": 7326.429, "sample_time_ms": 3820.529, "load_time_ms": 0.931, "load_throughput": 4298103.192, "learn_time_ms": 3501.711, "learn_throughput": 1142.299, "synch_weights_time_ms": 2.558}, "counters": {"num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 20000}, "done": false, "episodes_total": 67, "training_iteration": 5, "trial_id": "04cbf_00000", "date": "2024-03-07_13-18-39", "timestamp": 1709835519, "time_this_iter_s": 7.304318428039551, "time_total_s": 36.64411759376526, "pid": 119109, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7efea6399f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 36.64411759376526, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 31.077777777777783, "ram_util_percent": 50.8, "gpu_util_percent0": 0.08333333333333333, "vram_util_percent0": 0.09166124131944446}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 4.515451132001416, "policy_loss": -0.009896283084025946, "vf_loss": 4.523967960356704, "vf_explained_var": -0.14277336712806454, "kl": 0.006897210510598654, "entropy": 1.0325002249210111, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 5115.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000}, "sampler_results": {"episode_reward_max": -4.699999999999996, "episode_reward_min": -70.30000000000045, "episode_reward_mean": -33.91566265060257, "episode_len_mean": 274.67469879518075, "episode_media": {}, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-43.400000000000205, -9.499999999999979, -11.599999999999971, -62.30000000000043, -22.499999999999957, -11.09999999999999, -54.00000000000034, -49.00000000000034, -54.30000000000028, -56.0000000000003, -70.30000000000045, -9.499999999999979, -38.10000000000024, -65.10000000000046, -24.60000000000001, -53.800000000000374, -15.599999999999966, -54.6000000000003, -6.899999999999988, -63.0000000000004, -48.90000000000029, -6.599999999999989, -47.70000000000033, -54.30000000000024, -16.099999999999984, -58.00000000000036, -46.00000000000031, -49.40000000000031, -46.70000000000031, -53.20000000000034, -20.400000000000002, -10.299999999999978, -7.799999999999992, -23.800000000000047, -47.90000000000035, -31.400000000000063, -49.20000000000016, -64.10000000000039, -50.20000000000024, -14.799999999999972, -6.799999999999988, -40.70000000000029, -30.700000000000003, -15.299999999999969, -39.50000000000032, -46.8000000000003, -50.300000000000246, -61.400000000000325, -49.0000000000004, -4.699999999999996, -7.799999999999985, -23.69999999999999, -46.100000000000286, -43.50000000000029, -23.400000000000027, -53.70000000000041, -17.399999999999988, -10.699999999999976, -36.00000000000006, -19.49999999999998, -49.50000000000032, -45.40000000000024, -15.099999999999959, -61.1000000000004, -27.600000000000065, -12.599999999999973, -18.899999999999988, -18.09999999999998, -46.80000000000039, -42.00000000000029, -9.899999999999977, -33.600000000000136, -45.100000000000286, -62.600000000000335, -6.999999999999988, -21.800000000000026, -5.299999999999995, -7.39999999999999, -6.599999999999992, -44.30000000000025, -32.900000000000205, -11.69999999999997, -40.7000000000003], "episode_lengths": [348, 105, 127, 400, 169, 99, 400, 400, 400, 400, 400, 106, 314, 400, 189, 400, 165, 400, 80, 400, 400, 77, 400, 400, 157, 400, 400, 400, 400, 400, 186, 112, 81, 226, 400, 278, 345, 400, 400, 125, 79, 400, 250, 146, 361, 400, 400, 400, 400, 58, 89, 200, 400, 400, 218, 400, 153, 106, 299, 194, 400, 400, 125, 400, 257, 111, 176, 167, 369, 392, 110, 304, 400, 400, 81, 197, 62, 71, 74, 400, 338, 122, 400]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2332961326341328, "mean_inference_ms": 0.7230961808013096, "mean_action_processing_ms": 0.07663294647329152, "mean_env_wait_ms": 6.291033133837376, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007147674100944795, "StateBufferConnector_ms": 0.003889669854956937, "ViewRequirementAgentConnector_ms": 0.08901228387671781}}, "episode_reward_max": -4.699999999999996, "episode_reward_min": -70.30000000000045, "episode_reward_mean": -33.91566265060257, "episode_len_mean": 274.67469879518075, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-43.400000000000205, -9.499999999999979, -11.599999999999971, -62.30000000000043, -22.499999999999957, -11.09999999999999, -54.00000000000034, -49.00000000000034, -54.30000000000028, -56.0000000000003, -70.30000000000045, -9.499999999999979, -38.10000000000024, -65.10000000000046, -24.60000000000001, -53.800000000000374, -15.599999999999966, -54.6000000000003, -6.899999999999988, -63.0000000000004, -48.90000000000029, -6.599999999999989, -47.70000000000033, -54.30000000000024, -16.099999999999984, -58.00000000000036, -46.00000000000031, -49.40000000000031, -46.70000000000031, -53.20000000000034, -20.400000000000002, -10.299999999999978, -7.799999999999992, -23.800000000000047, -47.90000000000035, -31.400000000000063, -49.20000000000016, -64.10000000000039, -50.20000000000024, -14.799999999999972, -6.799999999999988, -40.70000000000029, -30.700000000000003, -15.299999999999969, -39.50000000000032, -46.8000000000003, -50.300000000000246, -61.400000000000325, -49.0000000000004, -4.699999999999996, -7.799999999999985, -23.69999999999999, -46.100000000000286, -43.50000000000029, -23.400000000000027, -53.70000000000041, -17.399999999999988, -10.699999999999976, -36.00000000000006, -19.49999999999998, -49.50000000000032, -45.40000000000024, -15.099999999999959, -61.1000000000004, -27.600000000000065, -12.599999999999973, -18.899999999999988, -18.09999999999998, -46.80000000000039, -42.00000000000029, -9.899999999999977, -33.600000000000136, -45.100000000000286, -62.600000000000335, -6.999999999999988, -21.800000000000026, -5.299999999999995, -7.39999999999999, -6.599999999999992, -44.30000000000025, -32.900000000000205, -11.69999999999997, -40.7000000000003], "episode_lengths": [348, 105, 127, 400, 169, 99, 400, 400, 400, 400, 400, 106, 314, 400, 189, 400, 165, 400, 80, 400, 400, 77, 400, 400, 157, 400, 400, 400, 400, 400, 186, 112, 81, 226, 400, 278, 345, 400, 400, 125, 79, 400, 250, 146, 361, 400, 400, 400, 400, 58, 89, 200, 400, 400, 218, 400, 153, 106, 299, 194, 400, 400, 125, 400, 257, 111, 176, 167, 369, 392, 110, 304, 400, 400, 81, 197, 62, 71, 74, 400, 338, 122, 400]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2332961326341328, "mean_inference_ms": 0.7230961808013096, "mean_action_processing_ms": 0.07663294647329152, "mean_env_wait_ms": 6.291033133837376, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007147674100944795, "StateBufferConnector_ms": 0.003889669854956937, "ViewRequirementAgentConnector_ms": 0.08901228387671781}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 533.5534219488528, "num_env_steps_trained_throughput_per_sec": 533.5534219488528, "timesteps_total": 24000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 24000, "timers": {"training_iteration_time_ms": 7354.837, "sample_time_ms": 3815.384, "load_time_ms": 0.917, "load_throughput": 4362628.76, "learn_time_ms": 3535.317, "learn_throughput": 1131.44, "synch_weights_time_ms": 2.527}, "counters": {"num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000}, "done": false, "episodes_total": 83, "training_iteration": 6, "trial_id": "04cbf_00000", "date": "2024-03-07_13-18-46", "timestamp": 1709835526, "time_this_iter_s": 7.499426364898682, "time_total_s": 44.14354395866394, "pid": 119109, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7efea6399f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 44.14354395866394, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 29.160000000000004, "ram_util_percent": 50.849999999999994, "gpu_util_percent0": 0.092, "vram_util_percent0": 0.09164225260416667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 5.44098575627932, "policy_loss": -0.014739987959143936, "vf_loss": 5.454657117814146, "vf_explained_var": -0.12823669045202193, "kl": 0.005343152530143041, "entropy": 1.0167095040121386, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 6045.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 28000}, "sampler_results": {"episode_reward_max": -3.6999999999999993, "episode_reward_min": -70.30000000000045, "episode_reward_mean": -30.379000000000136, "episode_len_mean": 252.46, "episode_media": {}, "episodes_this_iter": 24, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-49.00000000000034, -54.30000000000028, -56.0000000000003, -70.30000000000045, -9.499999999999979, -38.10000000000024, -65.10000000000046, -24.60000000000001, -53.800000000000374, -15.599999999999966, -54.6000000000003, -6.899999999999988, -63.0000000000004, -48.90000000000029, -6.599999999999989, -47.70000000000033, -54.30000000000024, -16.099999999999984, -58.00000000000036, -46.00000000000031, -49.40000000000031, -46.70000000000031, -53.20000000000034, -20.400000000000002, -10.299999999999978, -7.799999999999992, -23.800000000000047, -47.90000000000035, -31.400000000000063, -49.20000000000016, -64.10000000000039, -50.20000000000024, -14.799999999999972, -6.799999999999988, -40.70000000000029, -30.700000000000003, -15.299999999999969, -39.50000000000032, -46.8000000000003, -50.300000000000246, -61.400000000000325, -49.0000000000004, -4.699999999999996, -7.799999999999985, -23.69999999999999, -46.100000000000286, -43.50000000000029, -23.400000000000027, -53.70000000000041, -17.399999999999988, -10.699999999999976, -36.00000000000006, -19.49999999999998, -49.50000000000032, -45.40000000000024, -15.099999999999959, -61.1000000000004, -27.600000000000065, -12.599999999999973, -18.899999999999988, -18.09999999999998, -46.80000000000039, -42.00000000000029, -9.899999999999977, -33.600000000000136, -45.100000000000286, -62.600000000000335, -6.999999999999988, -21.800000000000026, -5.299999999999995, -7.39999999999999, -6.599999999999992, -44.30000000000025, -32.900000000000205, -11.69999999999997, -40.7000000000003, -37.70000000000022, -4.999999999999995, -14.699999999999962, -4.899999999999995, -8.299999999999983, -47.800000000000374, -8.599999999999989, -15.399999999999963, -45.300000000000274, -3.6999999999999993, -43.20000000000033, -7.099999999999987, -19.100000000000016, -46.900000000000276, -6.599999999999989, -26.200000000000056, -16.899999999999974, -8.099999999999989, -4.799999999999995, -16.299999999999972, -9.399999999999979, -13.399999999999975, -10.599999999999985, -17.29999999999999], "episode_lengths": [400, 400, 400, 400, 106, 314, 400, 189, 400, 165, 400, 80, 400, 400, 77, 400, 400, 157, 400, 400, 400, 400, 400, 186, 112, 81, 226, 400, 278, 345, 400, 400, 125, 79, 400, 250, 146, 361, 400, 400, 400, 400, 58, 89, 200, 400, 400, 218, 400, 153, 106, 299, 194, 400, 400, 125, 400, 257, 111, 176, 167, 369, 392, 110, 304, 400, 400, 81, 197, 62, 71, 74, 400, 338, 122, 400, 361, 61, 129, 60, 89, 400, 88, 122, 400, 48, 400, 82, 193, 400, 77, 238, 140, 84, 59, 157, 99, 126, 100, 183]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23460055440778205, "mean_inference_ms": 0.7230136513388759, "mean_action_processing_ms": 0.07653765153382665, "mean_env_wait_ms": 6.293190669256435, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007069587707519531, "StateBufferConnector_ms": 0.003915309906005859, "ViewRequirementAgentConnector_ms": 0.08938837051391602}}, "episode_reward_max": -3.6999999999999993, "episode_reward_min": -70.30000000000045, "episode_reward_mean": -30.379000000000136, "episode_len_mean": 252.46, "episodes_this_iter": 24, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-49.00000000000034, -54.30000000000028, -56.0000000000003, -70.30000000000045, -9.499999999999979, -38.10000000000024, -65.10000000000046, -24.60000000000001, -53.800000000000374, -15.599999999999966, -54.6000000000003, -6.899999999999988, -63.0000000000004, -48.90000000000029, -6.599999999999989, -47.70000000000033, -54.30000000000024, -16.099999999999984, -58.00000000000036, -46.00000000000031, -49.40000000000031, -46.70000000000031, -53.20000000000034, -20.400000000000002, -10.299999999999978, -7.799999999999992, -23.800000000000047, -47.90000000000035, -31.400000000000063, -49.20000000000016, -64.10000000000039, -50.20000000000024, -14.799999999999972, -6.799999999999988, -40.70000000000029, -30.700000000000003, -15.299999999999969, -39.50000000000032, -46.8000000000003, -50.300000000000246, -61.400000000000325, -49.0000000000004, -4.699999999999996, -7.799999999999985, -23.69999999999999, -46.100000000000286, -43.50000000000029, -23.400000000000027, -53.70000000000041, -17.399999999999988, -10.699999999999976, -36.00000000000006, -19.49999999999998, -49.50000000000032, -45.40000000000024, -15.099999999999959, -61.1000000000004, -27.600000000000065, -12.599999999999973, -18.899999999999988, -18.09999999999998, -46.80000000000039, -42.00000000000029, -9.899999999999977, -33.600000000000136, -45.100000000000286, -62.600000000000335, -6.999999999999988, -21.800000000000026, -5.299999999999995, -7.39999999999999, -6.599999999999992, -44.30000000000025, -32.900000000000205, -11.69999999999997, -40.7000000000003, -37.70000000000022, -4.999999999999995, -14.699999999999962, -4.899999999999995, -8.299999999999983, -47.800000000000374, -8.599999999999989, -15.399999999999963, -45.300000000000274, -3.6999999999999993, -43.20000000000033, -7.099999999999987, -19.100000000000016, -46.900000000000276, -6.599999999999989, -26.200000000000056, -16.899999999999974, -8.099999999999989, -4.799999999999995, -16.299999999999972, -9.399999999999979, -13.399999999999975, -10.599999999999985, -17.29999999999999], "episode_lengths": [400, 400, 400, 400, 106, 314, 400, 189, 400, 165, 400, 80, 400, 400, 77, 400, 400, 157, 400, 400, 400, 400, 400, 186, 112, 81, 226, 400, 278, 345, 400, 400, 125, 79, 400, 250, 146, 361, 400, 400, 400, 400, 58, 89, 200, 400, 400, 218, 400, 153, 106, 299, 194, 400, 400, 125, 400, 257, 111, 176, 167, 369, 392, 110, 304, 400, 400, 81, 197, 62, 71, 74, 400, 338, 122, 400, 361, 61, 129, 60, 89, 400, 88, 122, 400, 48, 400, 82, 193, 400, 77, 238, 140, 84, 59, 157, 99, 126, 100, 183]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23460055440778205, "mean_inference_ms": 0.7230136513388759, "mean_action_processing_ms": 0.07653765153382665, "mean_env_wait_ms": 6.293190669256435, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007069587707519531, "StateBufferConnector_ms": 0.003915309906005859, "ViewRequirementAgentConnector_ms": 0.08938837051391602}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 28000, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 535.3945081044511, "num_env_steps_trained_throughput_per_sec": 535.3945081044511, "timesteps_total": 28000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 28000, "timers": {"training_iteration_time_ms": 7371.445, "sample_time_ms": 3836.099, "load_time_ms": 0.912, "load_throughput": 4385381.329, "learn_time_ms": 3531.18, "learn_throughput": 1132.766, "synch_weights_time_ms": 2.566}, "counters": {"num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 28000}, "done": false, "episodes_total": 107, "training_iteration": 7, "trial_id": "04cbf_00000", "date": "2024-03-07_13-18-54", "timestamp": 1709835534, "time_this_iter_s": 7.473629713058472, "time_total_s": 51.61717367172241, "pid": 119109, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7efea6399f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 51.61717367172241, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 28.71, "ram_util_percent": 50.89, "gpu_util_percent0": 0.09, "vram_util_percent0": 0.091650390625}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 5.842127553878292, "policy_loss": -0.01866453217082126, "vf_loss": 5.8594455931135405, "vf_explained_var": -0.19582362418533653, "kl": 0.006732498606171218, "entropy": 1.0149544561422, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 6975.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000}, "sampler_results": {"episode_reward_max": -3.6999999999999993, "episode_reward_min": -64.10000000000039, "episode_reward_mean": -24.378000000000092, "episode_len_mean": 215.09, "episode_media": {}, "episodes_this_iter": 25, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-7.799999999999992, -23.800000000000047, -47.90000000000035, -31.400000000000063, -49.20000000000016, -64.10000000000039, -50.20000000000024, -14.799999999999972, -6.799999999999988, -40.70000000000029, -30.700000000000003, -15.299999999999969, -39.50000000000032, -46.8000000000003, -50.300000000000246, -61.400000000000325, -49.0000000000004, -4.699999999999996, -7.799999999999985, -23.69999999999999, -46.100000000000286, -43.50000000000029, -23.400000000000027, -53.70000000000041, -17.399999999999988, -10.699999999999976, -36.00000000000006, -19.49999999999998, -49.50000000000032, -45.40000000000024, -15.099999999999959, -61.1000000000004, -27.600000000000065, -12.599999999999973, -18.899999999999988, -18.09999999999998, -46.80000000000039, -42.00000000000029, -9.899999999999977, -33.600000000000136, -45.100000000000286, -62.600000000000335, -6.999999999999988, -21.800000000000026, -5.299999999999995, -7.39999999999999, -6.599999999999992, -44.30000000000025, -32.900000000000205, -11.69999999999997, -40.7000000000003, -37.70000000000022, -4.999999999999995, -14.699999999999962, -4.899999999999995, -8.299999999999983, -47.800000000000374, -8.599999999999989, -15.399999999999963, -45.300000000000274, -3.6999999999999993, -43.20000000000033, -7.099999999999987, -19.100000000000016, -46.900000000000276, -6.599999999999989, -26.200000000000056, -16.899999999999974, -8.099999999999989, -4.799999999999995, -16.299999999999972, -9.399999999999979, -13.399999999999975, -10.599999999999985, -17.29999999999999, -27.599999999999984, -13.499999999999964, -44.00000000000032, -9.09999999999998, -4.699999999999996, -11.299999999999972, -44.500000000000306, -22.000000000000046, -4.099999999999998, -24.100000000000076, -29.000000000000128, -32.40000000000016, -14.799999999999963, -9.09999999999998, -12.099999999999977, -17.699999999999967, -17.299999999999976, -10.39999999999998, -5.299999999999994, -9.099999999999993, -16.59999999999998, -8.899999999999986, -19.700000000000024, -4.099999999999998, -6.899999999999988], "episode_lengths": [81, 226, 400, 278, 345, 400, 400, 125, 79, 400, 250, 146, 361, 400, 400, 400, 400, 58, 89, 200, 400, 400, 218, 400, 153, 106, 299, 194, 400, 400, 125, 400, 257, 111, 176, 167, 369, 392, 110, 304, 400, 400, 81, 197, 62, 71, 74, 400, 338, 122, 400, 361, 61, 129, 60, 89, 400, 88, 122, 400, 48, 400, 82, 193, 400, 77, 238, 140, 84, 59, 157, 99, 126, 100, 183, 237, 141, 400, 99, 58, 118, 400, 214, 52, 221, 286, 313, 136, 99, 125, 158, 149, 108, 64, 85, 163, 93, 198, 52, 80]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23650660665956266, "mean_inference_ms": 0.7229490957605644, "mean_action_processing_ms": 0.07640014906814047, "mean_env_wait_ms": 6.3070787628306775, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006979465484619141, "StateBufferConnector_ms": 0.0038976669311523438, "ViewRequirementAgentConnector_ms": 0.08921933174133301}}, "episode_reward_max": -3.6999999999999993, "episode_reward_min": -64.10000000000039, "episode_reward_mean": -24.378000000000092, "episode_len_mean": 215.09, "episodes_this_iter": 25, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-7.799999999999992, -23.800000000000047, -47.90000000000035, -31.400000000000063, -49.20000000000016, -64.10000000000039, -50.20000000000024, -14.799999999999972, -6.799999999999988, -40.70000000000029, -30.700000000000003, -15.299999999999969, -39.50000000000032, -46.8000000000003, -50.300000000000246, -61.400000000000325, -49.0000000000004, -4.699999999999996, -7.799999999999985, -23.69999999999999, -46.100000000000286, -43.50000000000029, -23.400000000000027, -53.70000000000041, -17.399999999999988, -10.699999999999976, -36.00000000000006, -19.49999999999998, -49.50000000000032, -45.40000000000024, -15.099999999999959, -61.1000000000004, -27.600000000000065, -12.599999999999973, -18.899999999999988, -18.09999999999998, -46.80000000000039, -42.00000000000029, -9.899999999999977, -33.600000000000136, -45.100000000000286, -62.600000000000335, -6.999999999999988, -21.800000000000026, -5.299999999999995, -7.39999999999999, -6.599999999999992, -44.30000000000025, -32.900000000000205, -11.69999999999997, -40.7000000000003, -37.70000000000022, -4.999999999999995, -14.699999999999962, -4.899999999999995, -8.299999999999983, -47.800000000000374, -8.599999999999989, -15.399999999999963, -45.300000000000274, -3.6999999999999993, -43.20000000000033, -7.099999999999987, -19.100000000000016, -46.900000000000276, -6.599999999999989, -26.200000000000056, -16.899999999999974, -8.099999999999989, -4.799999999999995, -16.299999999999972, -9.399999999999979, -13.399999999999975, -10.599999999999985, -17.29999999999999, -27.599999999999984, -13.499999999999964, -44.00000000000032, -9.09999999999998, -4.699999999999996, -11.299999999999972, -44.500000000000306, -22.000000000000046, -4.099999999999998, -24.100000000000076, -29.000000000000128, -32.40000000000016, -14.799999999999963, -9.09999999999998, -12.099999999999977, -17.699999999999967, -17.299999999999976, -10.39999999999998, -5.299999999999994, -9.099999999999993, -16.59999999999998, -8.899999999999986, -19.700000000000024, -4.099999999999998, -6.899999999999988], "episode_lengths": [81, 226, 400, 278, 345, 400, 400, 125, 79, 400, 250, 146, 361, 400, 400, 400, 400, 58, 89, 200, 400, 400, 218, 400, 153, 106, 299, 194, 400, 400, 125, 400, 257, 111, 176, 167, 369, 392, 110, 304, 400, 400, 81, 197, 62, 71, 74, 400, 338, 122, 400, 361, 61, 129, 60, 89, 400, 88, 122, 400, 48, 400, 82, 193, 400, 77, 238, 140, 84, 59, 157, 99, 126, 100, 183, 237, 141, 400, 99, 58, 118, 400, 214, 52, 221, 286, 313, 136, 99, 125, 158, 149, 108, 64, 85, 163, 93, 198, 52, 80]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23650660665956266, "mean_inference_ms": 0.7229490957605644, "mean_action_processing_ms": 0.07640014906814047, "mean_env_wait_ms": 6.3070787628306775, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006979465484619141, "StateBufferConnector_ms": 0.0038976669311523438, "ViewRequirementAgentConnector_ms": 0.08921933174133301}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 533.4279037290922, "num_env_steps_trained_throughput_per_sec": 533.4279037290922, "timesteps_total": 32000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 32000, "timers": {"training_iteration_time_ms": 7387.344, "sample_time_ms": 3860.928, "load_time_ms": 0.922, "load_throughput": 4339683.394, "learn_time_ms": 3522.269, "learn_throughput": 1135.632, "synch_weights_time_ms": 2.549}, "counters": {"num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000}, "done": false, "episodes_total": 132, "training_iteration": 8, "trial_id": "04cbf_00000", "date": "2024-03-07_13-19-01", "timestamp": 1709835541, "time_this_iter_s": 7.501222372055054, "time_total_s": 59.118396043777466, "pid": 119109, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7efea6399f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 59.118396043777466, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 31.15555555555555, "ram_util_percent": 50.888888888888886, "gpu_util_percent0": 0.08333333333333333, "vram_util_percent0": 0.09166124131944445}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 5.337569564068189, "policy_loss": 0.003639615160883755, "vf_loss": 5.33282596768551, "vf_explained_var": -0.21708254871829863, "kl": 0.00551989326348864, "entropy": 1.0150248186562651, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 7905.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000}, "sampler_results": {"episode_reward_max": -3.6999999999999993, "episode_reward_min": -62.600000000000335, "episode_reward_mean": -21.099000000000068, "episode_len_mean": 193.0, "episode_media": {}, "episodes_this_iter": 22, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-23.400000000000027, -53.70000000000041, -17.399999999999988, -10.699999999999976, -36.00000000000006, -19.49999999999998, -49.50000000000032, -45.40000000000024, -15.099999999999959, -61.1000000000004, -27.600000000000065, -12.599999999999973, -18.899999999999988, -18.09999999999998, -46.80000000000039, -42.00000000000029, -9.899999999999977, -33.600000000000136, -45.100000000000286, -62.600000000000335, -6.999999999999988, -21.800000000000026, -5.299999999999995, -7.39999999999999, -6.599999999999992, -44.30000000000025, -32.900000000000205, -11.69999999999997, -40.7000000000003, -37.70000000000022, -4.999999999999995, -14.699999999999962, -4.899999999999995, -8.299999999999983, -47.800000000000374, -8.599999999999989, -15.399999999999963, -45.300000000000274, -3.6999999999999993, -43.20000000000033, -7.099999999999987, -19.100000000000016, -46.900000000000276, -6.599999999999989, -26.200000000000056, -16.899999999999974, -8.099999999999989, -4.799999999999995, -16.299999999999972, -9.399999999999979, -13.399999999999975, -10.599999999999985, -17.29999999999999, -27.599999999999984, -13.499999999999964, -44.00000000000032, -9.09999999999998, -4.699999999999996, -11.299999999999972, -44.500000000000306, -22.000000000000046, -4.099999999999998, -24.100000000000076, -29.000000000000128, -32.40000000000016, -14.799999999999963, -9.09999999999998, -12.099999999999977, -17.699999999999967, -17.299999999999976, -10.39999999999998, -5.299999999999994, -9.099999999999993, -16.59999999999998, -8.899999999999986, -19.700000000000024, -4.099999999999998, -6.899999999999988, -39.50000000000028, -9.999999999999993, -17.199999999999985, -24.700000000000077, -14.199999999999967, -14.999999999999966, -20.30000000000002, -38.000000000000185, -34.90000000000016, -7.29999999999999, -17.399999999999977, -12.899999999999968, -5.99999999999999, -33.30000000000014, -6.599999999999989, -11.699999999999974, -10.199999999999985, -26.5000000000001, -5.199999999999994, -31.600000000000172, -36.60000000000018, -8.499999999999993], "episode_lengths": [218, 400, 153, 106, 299, 194, 400, 400, 125, 400, 257, 111, 176, 167, 369, 392, 110, 304, 400, 400, 81, 197, 62, 71, 74, 400, 338, 122, 400, 361, 61, 129, 60, 89, 400, 88, 122, 400, 48, 400, 82, 193, 400, 77, 238, 140, 84, 59, 157, 99, 126, 100, 183, 237, 141, 400, 99, 58, 118, 400, 214, 52, 221, 286, 313, 136, 99, 125, 158, 149, 108, 64, 85, 163, 93, 198, 52, 80, 341, 82, 182, 253, 144, 132, 209, 330, 322, 81, 140, 132, 64, 301, 65, 113, 102, 262, 63, 311, 332, 68]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23832003332423543, "mean_inference_ms": 0.7229123724183567, "mean_action_processing_ms": 0.07641895735723682, "mean_env_wait_ms": 6.31069853083613, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006918430328369141, "StateBufferConnector_ms": 0.003916263580322266, "ViewRequirementAgentConnector_ms": 0.08972311019897461}}, "episode_reward_max": -3.6999999999999993, "episode_reward_min": -62.600000000000335, "episode_reward_mean": -21.099000000000068, "episode_len_mean": 193.0, "episodes_this_iter": 22, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-23.400000000000027, -53.70000000000041, -17.399999999999988, -10.699999999999976, -36.00000000000006, -19.49999999999998, -49.50000000000032, -45.40000000000024, -15.099999999999959, -61.1000000000004, -27.600000000000065, -12.599999999999973, -18.899999999999988, -18.09999999999998, -46.80000000000039, -42.00000000000029, -9.899999999999977, -33.600000000000136, -45.100000000000286, -62.600000000000335, -6.999999999999988, -21.800000000000026, -5.299999999999995, -7.39999999999999, -6.599999999999992, -44.30000000000025, -32.900000000000205, -11.69999999999997, -40.7000000000003, -37.70000000000022, -4.999999999999995, -14.699999999999962, -4.899999999999995, -8.299999999999983, -47.800000000000374, -8.599999999999989, -15.399999999999963, -45.300000000000274, -3.6999999999999993, -43.20000000000033, -7.099999999999987, -19.100000000000016, -46.900000000000276, -6.599999999999989, -26.200000000000056, -16.899999999999974, -8.099999999999989, -4.799999999999995, -16.299999999999972, -9.399999999999979, -13.399999999999975, -10.599999999999985, -17.29999999999999, -27.599999999999984, -13.499999999999964, -44.00000000000032, -9.09999999999998, -4.699999999999996, -11.299999999999972, -44.500000000000306, -22.000000000000046, -4.099999999999998, -24.100000000000076, -29.000000000000128, -32.40000000000016, -14.799999999999963, -9.09999999999998, -12.099999999999977, -17.699999999999967, -17.299999999999976, -10.39999999999998, -5.299999999999994, -9.099999999999993, -16.59999999999998, -8.899999999999986, -19.700000000000024, -4.099999999999998, -6.899999999999988, -39.50000000000028, -9.999999999999993, -17.199999999999985, -24.700000000000077, -14.199999999999967, -14.999999999999966, -20.30000000000002, -38.000000000000185, -34.90000000000016, -7.29999999999999, -17.399999999999977, -12.899999999999968, -5.99999999999999, -33.30000000000014, -6.599999999999989, -11.699999999999974, -10.199999999999985, -26.5000000000001, -5.199999999999994, -31.600000000000172, -36.60000000000018, -8.499999999999993], "episode_lengths": [218, 400, 153, 106, 299, 194, 400, 400, 125, 400, 257, 111, 176, 167, 369, 392, 110, 304, 400, 400, 81, 197, 62, 71, 74, 400, 338, 122, 400, 361, 61, 129, 60, 89, 400, 88, 122, 400, 48, 400, 82, 193, 400, 77, 238, 140, 84, 59, 157, 99, 126, 100, 183, 237, 141, 400, 99, 58, 118, 400, 214, 52, 221, 286, 313, 136, 99, 125, 158, 149, 108, 64, 85, 163, 93, 198, 52, 80, 341, 82, 182, 253, 144, 132, 209, 330, 322, 81, 140, 132, 64, 301, 65, 113, 102, 262, 63, 311, 332, 68]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23832003332423543, "mean_inference_ms": 0.7229123724183567, "mean_action_processing_ms": 0.07641895735723682, "mean_env_wait_ms": 6.31069853083613, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006918430328369141, "StateBufferConnector_ms": 0.003916263580322266, "ViewRequirementAgentConnector_ms": 0.08972311019897461}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 535.1862655178733, "num_env_steps_trained_throughput_per_sec": 535.1862655178733, "timesteps_total": 36000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 36000, "timers": {"training_iteration_time_ms": 7396.972, "sample_time_ms": 3871.816, "load_time_ms": 0.921, "load_throughput": 4345303.289, "learn_time_ms": 3520.957, "learn_throughput": 1136.055, "synch_weights_time_ms": 2.608}, "counters": {"num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000}, "done": false, "episodes_total": 154, "training_iteration": 9, "trial_id": "04cbf_00000", "date": "2024-03-07_13-19-09", "timestamp": 1709835549, "time_this_iter_s": 7.476639032363892, "time_total_s": 66.59503507614136, "pid": 119109, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7efea6399f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 66.59503507614136, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 28.8, "ram_util_percent": 50.84999999999999, "gpu_util_percent0": 0.08, "vram_util_percent0": 0.09165852864583332}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 5.6287876543178355, "policy_loss": -0.013683415500707523, "vf_loss": 5.641325793182978, "vf_explained_var": -0.24489606932927205, "kl": 0.005726407574815776, "entropy": 1.002448332566087, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 8835.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000}, "sampler_results": {"episode_reward_max": -3.6999999999999993, "episode_reward_min": -47.800000000000374, "episode_reward_mean": -18.257000000000048, "episode_len_mean": 174.57, "episode_media": {}, "episodes_this_iter": 24, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-6.599999999999992, -44.30000000000025, -32.900000000000205, -11.69999999999997, -40.7000000000003, -37.70000000000022, -4.999999999999995, -14.699999999999962, -4.899999999999995, -8.299999999999983, -47.800000000000374, -8.599999999999989, -15.399999999999963, -45.300000000000274, -3.6999999999999993, -43.20000000000033, -7.099999999999987, -19.100000000000016, -46.900000000000276, -6.599999999999989, -26.200000000000056, -16.899999999999974, -8.099999999999989, -4.799999999999995, -16.299999999999972, -9.399999999999979, -13.399999999999975, -10.599999999999985, -17.29999999999999, -27.599999999999984, -13.499999999999964, -44.00000000000032, -9.09999999999998, -4.699999999999996, -11.299999999999972, -44.500000000000306, -22.000000000000046, -4.099999999999998, -24.100000000000076, -29.000000000000128, -32.40000000000016, -14.799999999999963, -9.09999999999998, -12.099999999999977, -17.699999999999967, -17.299999999999976, -10.39999999999998, -5.299999999999994, -9.099999999999993, -16.59999999999998, -8.899999999999986, -19.700000000000024, -4.099999999999998, -6.899999999999988, -39.50000000000028, -9.999999999999993, -17.199999999999985, -24.700000000000077, -14.199999999999967, -14.999999999999966, -20.30000000000002, -38.000000000000185, -34.90000000000016, -7.29999999999999, -17.399999999999977, -12.899999999999968, -5.99999999999999, -33.30000000000014, -6.599999999999989, -11.699999999999974, -10.199999999999985, -26.5000000000001, -5.199999999999994, -31.600000000000172, -36.60000000000018, -8.499999999999993, -44.10000000000024, -6.89999999999999, -22.500000000000032, -7.2999999999999865, -6.899999999999988, -10.599999999999975, -16.299999999999976, -6.299999999999992, -43.50000000000024, -20.000000000000014, -46.000000000000256, -5.899999999999992, -13.499999999999972, -7.199999999999987, -8.799999999999981, -6.999999999999988, -3.6999999999999993, -12.29999999999998, -9.29999999999998, -42.400000000000304, -10.499999999999979, -12.699999999999967, -33.40000000000018, -9.199999999999994], "episode_lengths": [74, 400, 338, 122, 400, 361, 61, 129, 60, 89, 400, 88, 122, 400, 48, 400, 82, 193, 400, 77, 238, 140, 84, 59, 157, 99, 126, 100, 183, 237, 141, 400, 99, 58, 118, 400, 214, 52, 221, 286, 313, 136, 99, 125, 158, 149, 108, 64, 85, 163, 93, 198, 52, 80, 341, 82, 182, 253, 144, 132, 209, 330, 322, 81, 140, 132, 64, 301, 65, 113, 102, 262, 63, 311, 332, 68, 400, 78, 208, 84, 80, 117, 173, 72, 383, 207, 400, 69, 126, 83, 99, 81, 48, 107, 104, 400, 97, 138, 320, 75]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24025563609098483, "mean_inference_ms": 0.7231931581055094, "mean_action_processing_ms": 0.07634908859170776, "mean_env_wait_ms": 6.318132822423545, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007035017013549805, "StateBufferConnector_ms": 0.003916025161743164, "ViewRequirementAgentConnector_ms": 0.08964323997497559}}, "episode_reward_max": -3.6999999999999993, "episode_reward_min": -47.800000000000374, "episode_reward_mean": -18.257000000000048, "episode_len_mean": 174.57, "episodes_this_iter": 24, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-6.599999999999992, -44.30000000000025, -32.900000000000205, -11.69999999999997, -40.7000000000003, -37.70000000000022, -4.999999999999995, -14.699999999999962, -4.899999999999995, -8.299999999999983, -47.800000000000374, -8.599999999999989, -15.399999999999963, -45.300000000000274, -3.6999999999999993, -43.20000000000033, -7.099999999999987, -19.100000000000016, -46.900000000000276, -6.599999999999989, -26.200000000000056, -16.899999999999974, -8.099999999999989, -4.799999999999995, -16.299999999999972, -9.399999999999979, -13.399999999999975, -10.599999999999985, -17.29999999999999, -27.599999999999984, -13.499999999999964, -44.00000000000032, -9.09999999999998, -4.699999999999996, -11.299999999999972, -44.500000000000306, -22.000000000000046, -4.099999999999998, -24.100000000000076, -29.000000000000128, -32.40000000000016, -14.799999999999963, -9.09999999999998, -12.099999999999977, -17.699999999999967, -17.299999999999976, -10.39999999999998, -5.299999999999994, -9.099999999999993, -16.59999999999998, -8.899999999999986, -19.700000000000024, -4.099999999999998, -6.899999999999988, -39.50000000000028, -9.999999999999993, -17.199999999999985, -24.700000000000077, -14.199999999999967, -14.999999999999966, -20.30000000000002, -38.000000000000185, -34.90000000000016, -7.29999999999999, -17.399999999999977, -12.899999999999968, -5.99999999999999, -33.30000000000014, -6.599999999999989, -11.699999999999974, -10.199999999999985, -26.5000000000001, -5.199999999999994, -31.600000000000172, -36.60000000000018, -8.499999999999993, -44.10000000000024, -6.89999999999999, -22.500000000000032, -7.2999999999999865, -6.899999999999988, -10.599999999999975, -16.299999999999976, -6.299999999999992, -43.50000000000024, -20.000000000000014, -46.000000000000256, -5.899999999999992, -13.499999999999972, -7.199999999999987, -8.799999999999981, -6.999999999999988, -3.6999999999999993, -12.29999999999998, -9.29999999999998, -42.400000000000304, -10.499999999999979, -12.699999999999967, -33.40000000000018, -9.199999999999994], "episode_lengths": [74, 400, 338, 122, 400, 361, 61, 129, 60, 89, 400, 88, 122, 400, 48, 400, 82, 193, 400, 77, 238, 140, 84, 59, 157, 99, 126, 100, 183, 237, 141, 400, 99, 58, 118, 400, 214, 52, 221, 286, 313, 136, 99, 125, 158, 149, 108, 64, 85, 163, 93, 198, 52, 80, 341, 82, 182, 253, 144, 132, 209, 330, 322, 81, 140, 132, 64, 301, 65, 113, 102, 262, 63, 311, 332, 68, 400, 78, 208, 84, 80, 117, 173, 72, 383, 207, 400, 69, 126, 83, 99, 81, 48, 107, 104, 400, 97, 138, 320, 75]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24025563609098483, "mean_inference_ms": 0.7231931581055094, "mean_action_processing_ms": 0.07634908859170776, "mean_env_wait_ms": 6.318132822423545, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007035017013549805, "StateBufferConnector_ms": 0.003916025161743164, "ViewRequirementAgentConnector_ms": 0.08964323997497559}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 550.5152158221883, "num_env_steps_trained_throughput_per_sec": 550.5152158221883, "timesteps_total": 40000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 40000, "timers": {"training_iteration_time_ms": 7383.858, "sample_time_ms": 3859.713, "load_time_ms": 0.915, "load_throughput": 4372026.893, "learn_time_ms": 3518.646, "learn_throughput": 1136.801, "synch_weights_time_ms": 3.893}, "counters": {"num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000}, "done": false, "episodes_total": 178, "training_iteration": 10, "trial_id": "04cbf_00000", "date": "2024-03-07_13-19-16", "timestamp": 1709835556, "time_this_iter_s": 7.2689208984375, "time_total_s": 73.86395597457886, "pid": 119109, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7efea6399f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 73.86395597457886, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 28.110000000000003, "ram_util_percent": 50.89999999999999, "gpu_util_percent0": 0.092, "vram_util_percent0": 0.09164225260416667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 5.161964628773351, "policy_loss": -0.017645423444769076, "vf_loss": 5.178308248487852, "vf_explained_var": -0.3018454422873835, "kl": 0.006509032619987937, "entropy": 1.009185787362437, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 9765.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_agent_steps_sampled": 44000, "num_agent_steps_trained": 44000}, "sampler_results": {"episode_reward_max": -3.1000000000000014, "episode_reward_min": -46.000000000000256, "episode_reward_mean": -15.503000000000027, "episode_len_mean": 150.37, "episode_media": {}, "episodes_this_iter": 35, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-44.500000000000306, -22.000000000000046, -4.099999999999998, -24.100000000000076, -29.000000000000128, -32.40000000000016, -14.799999999999963, -9.09999999999998, -12.099999999999977, -17.699999999999967, -17.299999999999976, -10.39999999999998, -5.299999999999994, -9.099999999999993, -16.59999999999998, -8.899999999999986, -19.700000000000024, -4.099999999999998, -6.899999999999988, -39.50000000000028, -9.999999999999993, -17.199999999999985, -24.700000000000077, -14.199999999999967, -14.999999999999966, -20.30000000000002, -38.000000000000185, -34.90000000000016, -7.29999999999999, -17.399999999999977, -12.899999999999968, -5.99999999999999, -33.30000000000014, -6.599999999999989, -11.699999999999974, -10.199999999999985, -26.5000000000001, -5.199999999999994, -31.600000000000172, -36.60000000000018, -8.499999999999993, -44.10000000000024, -6.89999999999999, -22.500000000000032, -7.2999999999999865, -6.899999999999988, -10.599999999999975, -16.299999999999976, -6.299999999999992, -43.50000000000024, -20.000000000000014, -46.000000000000256, -5.899999999999992, -13.499999999999972, -7.199999999999987, -8.799999999999981, -6.999999999999988, -3.6999999999999993, -12.29999999999998, -9.29999999999998, -42.400000000000304, -10.499999999999979, -12.699999999999967, -33.40000000000018, -9.199999999999994, -20.39999999999998, -24.700000000000095, -9.19999999999999, -5.8999999999999915, -3.3000000000000007, -42.80000000000028, -17.599999999999977, -7.199999999999987, -4.599999999999996, -11.099999999999989, -3.5, -15.299999999999969, -5.399999999999993, -7.799999999999985, -6.999999999999997, -11.69999999999997, -3.8999999999999986, -8.599999999999998, -3.9999999999999982, -9.39999999999998, -7.39999999999999, -20.599999999999962, -3.1000000000000014, -4.999999999999995, -6.999999999999997, -21.30000000000003, -19.60000000000001, -11.699999999999974, -5.099999999999997, -4.699999999999996, -19.399999999999984, -7.599999999999991, -26.100000000000115, -3.5999999999999996, -22.700000000000045], "episode_lengths": [400, 214, 52, 221, 286, 313, 136, 99, 125, 158, 149, 108, 64, 85, 163, 93, 198, 52, 80, 341, 82, 182, 253, 144, 132, 209, 330, 322, 81, 140, 132, 64, 301, 65, 113, 102, 262, 63, 311, 332, 68, 400, 78, 208, 84, 80, 117, 173, 72, 383, 207, 400, 69, 126, 83, 99, 81, 48, 107, 104, 400, 97, 138, 320, 75, 188, 258, 81, 70, 44, 400, 166, 83, 57, 96, 46, 126, 65, 89, 70, 123, 50, 70, 51, 101, 81, 160, 42, 61, 70, 205, 182, 109, 59, 58, 190, 80, 262, 47, 223]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24249030268009386, "mean_inference_ms": 0.7229841774291137, "mean_action_processing_ms": 0.0761527173853529, "mean_env_wait_ms": 6.317076904055681, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0069692134857177734, "StateBufferConnector_ms": 0.0038945674896240234, "ViewRequirementAgentConnector_ms": 0.08940005302429199}}, "episode_reward_max": -3.1000000000000014, "episode_reward_min": -46.000000000000256, "episode_reward_mean": -15.503000000000027, "episode_len_mean": 150.37, "episodes_this_iter": 35, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-44.500000000000306, -22.000000000000046, -4.099999999999998, -24.100000000000076, -29.000000000000128, -32.40000000000016, -14.799999999999963, -9.09999999999998, -12.099999999999977, -17.699999999999967, -17.299999999999976, -10.39999999999998, -5.299999999999994, -9.099999999999993, -16.59999999999998, -8.899999999999986, -19.700000000000024, -4.099999999999998, -6.899999999999988, -39.50000000000028, -9.999999999999993, -17.199999999999985, -24.700000000000077, -14.199999999999967, -14.999999999999966, -20.30000000000002, -38.000000000000185, -34.90000000000016, -7.29999999999999, -17.399999999999977, -12.899999999999968, -5.99999999999999, -33.30000000000014, -6.599999999999989, -11.699999999999974, -10.199999999999985, -26.5000000000001, -5.199999999999994, -31.600000000000172, -36.60000000000018, -8.499999999999993, -44.10000000000024, -6.89999999999999, -22.500000000000032, -7.2999999999999865, -6.899999999999988, -10.599999999999975, -16.299999999999976, -6.299999999999992, -43.50000000000024, -20.000000000000014, -46.000000000000256, -5.899999999999992, -13.499999999999972, -7.199999999999987, -8.799999999999981, -6.999999999999988, -3.6999999999999993, -12.29999999999998, -9.29999999999998, -42.400000000000304, -10.499999999999979, -12.699999999999967, -33.40000000000018, -9.199999999999994, -20.39999999999998, -24.700000000000095, -9.19999999999999, -5.8999999999999915, -3.3000000000000007, -42.80000000000028, -17.599999999999977, -7.199999999999987, -4.599999999999996, -11.099999999999989, -3.5, -15.299999999999969, -5.399999999999993, -7.799999999999985, -6.999999999999997, -11.69999999999997, -3.8999999999999986, -8.599999999999998, -3.9999999999999982, -9.39999999999998, -7.39999999999999, -20.599999999999962, -3.1000000000000014, -4.999999999999995, -6.999999999999997, -21.30000000000003, -19.60000000000001, -11.699999999999974, -5.099999999999997, -4.699999999999996, -19.399999999999984, -7.599999999999991, -26.100000000000115, -3.5999999999999996, -22.700000000000045], "episode_lengths": [400, 214, 52, 221, 286, 313, 136, 99, 125, 158, 149, 108, 64, 85, 163, 93, 198, 52, 80, 341, 82, 182, 253, 144, 132, 209, 330, 322, 81, 140, 132, 64, 301, 65, 113, 102, 262, 63, 311, 332, 68, 400, 78, 208, 84, 80, 117, 173, 72, 383, 207, 400, 69, 126, 83, 99, 81, 48, 107, 104, 400, 97, 138, 320, 75, 188, 258, 81, 70, 44, 400, 166, 83, 57, 96, 46, 126, 65, 89, 70, 123, 50, 70, 51, 101, 81, 160, 42, 61, 70, 205, 182, 109, 59, 58, 190, 80, 262, 47, 223]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24249030268009386, "mean_inference_ms": 0.7229841774291137, "mean_action_processing_ms": 0.0761527173853529, "mean_env_wait_ms": 6.317076904055681, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0069692134857177734, "StateBufferConnector_ms": 0.0038945674896240234, "ViewRequirementAgentConnector_ms": 0.08940005302429199}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 44000, "num_agent_steps_trained": 44000, "num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 535.6355735342157, "num_env_steps_trained_throughput_per_sec": 535.6355735342157, "timesteps_total": 44000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 44000, "timers": {"training_iteration_time_ms": 7393.258, "sample_time_ms": 3880.057, "load_time_ms": 0.912, "load_throughput": 4386773.696, "learn_time_ms": 3507.734, "learn_throughput": 1140.337, "synch_weights_time_ms": 3.888}, "counters": {"num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_agent_steps_sampled": 44000, "num_agent_steps_trained": 44000}, "done": false, "episodes_total": 213, "training_iteration": 11, "trial_id": "04cbf_00000", "date": "2024-03-07_13-19-24", "timestamp": 1709835564, "time_this_iter_s": 7.470229148864746, "time_total_s": 81.3341851234436, "pid": 119109, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7efea6399f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 81.3341851234436, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 31.522222222222222, "ram_util_percent": 50.92222222222222, "gpu_util_percent0": 0.08111111111111112, "vram_util_percent0": 0.09165219907407407}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 4.183929725872573, "policy_loss": -0.024515767375467925, "vf_loss": 4.20705891693792, "vf_explained_var": -0.06897082559524044, "kl": 0.0069328528716148105, "entropy": 1.0012054351709223, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 10695.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000}, "sampler_results": {"episode_reward_max": -3.1000000000000014, "episode_reward_min": -46.000000000000256, "episode_reward_mean": -13.984000000000023, "episode_len_mean": 137.88, "episode_media": {}, "episodes_this_iter": 33, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-6.599999999999989, -11.699999999999974, -10.199999999999985, -26.5000000000001, -5.199999999999994, -31.600000000000172, -36.60000000000018, -8.499999999999993, -44.10000000000024, -6.89999999999999, -22.500000000000032, -7.2999999999999865, -6.899999999999988, -10.599999999999975, -16.299999999999976, -6.299999999999992, -43.50000000000024, -20.000000000000014, -46.000000000000256, -5.899999999999992, -13.499999999999972, -7.199999999999987, -8.799999999999981, -6.999999999999988, -3.6999999999999993, -12.29999999999998, -9.29999999999998, -42.400000000000304, -10.499999999999979, -12.699999999999967, -33.40000000000018, -9.199999999999994, -20.39999999999998, -24.700000000000095, -9.19999999999999, -5.8999999999999915, -3.3000000000000007, -42.80000000000028, -17.599999999999977, -7.199999999999987, -4.599999999999996, -11.099999999999989, -3.5, -15.299999999999969, -5.399999999999993, -7.799999999999985, -6.999999999999997, -11.69999999999997, -3.8999999999999986, -8.599999999999998, -3.9999999999999982, -9.39999999999998, -7.39999999999999, -20.599999999999962, -3.1000000000000014, -4.999999999999995, -6.999999999999997, -21.30000000000003, -19.60000000000001, -11.699999999999974, -5.099999999999997, -4.699999999999996, -19.399999999999984, -7.599999999999991, -26.100000000000115, -3.5999999999999996, -22.700000000000045, -8.499999999999982, -30.30000000000015, -9.999999999999986, -5.499999999999993, -42.20000000000031, -19.800000000000026, -7.199999999999992, -4.299999999999997, -23.600000000000055, -5.599999999999992, -10.599999999999978, -6.699999999999989, -4.999999999999997, -14.299999999999976, -9.799999999999978, -10.299999999999983, -4.799999999999995, -4.999999999999995, -16.599999999999977, -8.699999999999982, -41.10000000000029, -7.999999999999984, -20.70000000000004, -44.40000000000033, -9.199999999999987, -12.69999999999997, -4.6999999999999975, -5.5999999999999925, -5.299999999999994, -7.599999999999985, -9.599999999999985, -5.299999999999995, -23.900000000000084], "episode_lengths": [65, 113, 102, 262, 63, 311, 332, 68, 400, 78, 208, 84, 80, 117, 173, 72, 383, 207, 400, 69, 126, 83, 99, 81, 48, 107, 104, 400, 97, 138, 320, 75, 188, 258, 81, 70, 44, 400, 166, 83, 57, 96, 46, 126, 65, 89, 70, 123, 50, 70, 51, 101, 81, 160, 42, 61, 70, 205, 182, 109, 59, 58, 190, 80, 262, 47, 223, 93, 275, 95, 66, 400, 198, 78, 54, 231, 58, 113, 78, 58, 129, 107, 94, 59, 61, 131, 93, 400, 91, 213, 400, 90, 135, 56, 67, 64, 87, 88, 62, 236]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2445145497600528, "mean_inference_ms": 0.7229009834823675, "mean_action_processing_ms": 0.07610105742417943, "mean_env_wait_ms": 6.322922468858079, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006899356842041016, "StateBufferConnector_ms": 0.00392913818359375, "ViewRequirementAgentConnector_ms": 0.08916378021240234}}, "episode_reward_max": -3.1000000000000014, "episode_reward_min": -46.000000000000256, "episode_reward_mean": -13.984000000000023, "episode_len_mean": 137.88, "episodes_this_iter": 33, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-6.599999999999989, -11.699999999999974, -10.199999999999985, -26.5000000000001, -5.199999999999994, -31.600000000000172, -36.60000000000018, -8.499999999999993, -44.10000000000024, -6.89999999999999, -22.500000000000032, -7.2999999999999865, -6.899999999999988, -10.599999999999975, -16.299999999999976, -6.299999999999992, -43.50000000000024, -20.000000000000014, -46.000000000000256, -5.899999999999992, -13.499999999999972, -7.199999999999987, -8.799999999999981, -6.999999999999988, -3.6999999999999993, -12.29999999999998, -9.29999999999998, -42.400000000000304, -10.499999999999979, -12.699999999999967, -33.40000000000018, -9.199999999999994, -20.39999999999998, -24.700000000000095, -9.19999999999999, -5.8999999999999915, -3.3000000000000007, -42.80000000000028, -17.599999999999977, -7.199999999999987, -4.599999999999996, -11.099999999999989, -3.5, -15.299999999999969, -5.399999999999993, -7.799999999999985, -6.999999999999997, -11.69999999999997, -3.8999999999999986, -8.599999999999998, -3.9999999999999982, -9.39999999999998, -7.39999999999999, -20.599999999999962, -3.1000000000000014, -4.999999999999995, -6.999999999999997, -21.30000000000003, -19.60000000000001, -11.699999999999974, -5.099999999999997, -4.699999999999996, -19.399999999999984, -7.599999999999991, -26.100000000000115, -3.5999999999999996, -22.700000000000045, -8.499999999999982, -30.30000000000015, -9.999999999999986, -5.499999999999993, -42.20000000000031, -19.800000000000026, -7.199999999999992, -4.299999999999997, -23.600000000000055, -5.599999999999992, -10.599999999999978, -6.699999999999989, -4.999999999999997, -14.299999999999976, -9.799999999999978, -10.299999999999983, -4.799999999999995, -4.999999999999995, -16.599999999999977, -8.699999999999982, -41.10000000000029, -7.999999999999984, -20.70000000000004, -44.40000000000033, -9.199999999999987, -12.69999999999997, -4.6999999999999975, -5.5999999999999925, -5.299999999999994, -7.599999999999985, -9.599999999999985, -5.299999999999995, -23.900000000000084], "episode_lengths": [65, 113, 102, 262, 63, 311, 332, 68, 400, 78, 208, 84, 80, 117, 173, 72, 383, 207, 400, 69, 126, 83, 99, 81, 48, 107, 104, 400, 97, 138, 320, 75, 188, 258, 81, 70, 44, 400, 166, 83, 57, 96, 46, 126, 65, 89, 70, 123, 50, 70, 51, 101, 81, 160, 42, 61, 70, 205, 182, 109, 59, 58, 190, 80, 262, 47, 223, 93, 275, 95, 66, 400, 198, 78, 54, 231, 58, 113, 78, 58, 129, 107, 94, 59, 61, 131, 93, 400, 91, 213, 400, 90, 135, 56, 67, 64, 87, 88, 62, 236]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2445145497600528, "mean_inference_ms": 0.7229009834823675, "mean_action_processing_ms": 0.07610105742417943, "mean_env_wait_ms": 6.322922468858079, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006899356842041016, "StateBufferConnector_ms": 0.00392913818359375, "ViewRequirementAgentConnector_ms": 0.08916378021240234}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000, "num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 550.180743705452, "num_env_steps_trained_throughput_per_sec": 550.180743705452, "timesteps_total": 48000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 48000, "timers": {"training_iteration_time_ms": 7398.29, "sample_time_ms": 3882.783, "load_time_ms": 0.924, "load_throughput": 4327705.523, "learn_time_ms": 3509.983, "learn_throughput": 1139.607, "synch_weights_time_ms": 3.939}, "counters": {"num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000}, "done": false, "episodes_total": 246, "training_iteration": 12, "trial_id": "04cbf_00000", "date": "2024-03-07_13-19-31", "timestamp": 1709835571, "time_this_iter_s": 7.272902250289917, "time_total_s": 88.60708737373352, "pid": 119109, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7efea6399f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 88.60708737373352, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 28.680000000000007, "ram_util_percent": 50.89999999999999, "gpu_util_percent0": 0.09100000000000001, "vram_util_percent0": 0.09165852864583333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 4.143198288015781, "policy_loss": -0.004114337652040425, "vf_loss": 4.146383896758479, "vf_explained_var": -0.18629935793979194, "kl": 0.004643647821585025, "entropy": 0.9883960212430646, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 11625.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_agent_steps_sampled": 52000, "num_agent_steps_trained": 52000}, "sampler_results": {"episode_reward_max": -3.1000000000000014, "episode_reward_min": -48.40000000000025, "episode_reward_mean": -11.409000000000015, "episode_len_mean": 114.0, "episode_media": {}, "episodes_this_iter": 36, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.3000000000000007, -42.80000000000028, -17.599999999999977, -7.199999999999987, -4.599999999999996, -11.099999999999989, -3.5, -15.299999999999969, -5.399999999999993, -7.799999999999985, -6.999999999999997, -11.69999999999997, -3.8999999999999986, -8.599999999999998, -3.9999999999999982, -9.39999999999998, -7.39999999999999, -20.599999999999962, -3.1000000000000014, -4.999999999999995, -6.999999999999997, -21.30000000000003, -19.60000000000001, -11.699999999999974, -5.099999999999997, -4.699999999999996, -19.399999999999984, -7.599999999999991, -26.100000000000115, -3.5999999999999996, -22.700000000000045, -8.499999999999982, -30.30000000000015, -9.999999999999986, -5.499999999999993, -42.20000000000031, -19.800000000000026, -7.199999999999992, -4.299999999999997, -23.600000000000055, -5.599999999999992, -10.599999999999978, -6.699999999999989, -4.999999999999997, -14.299999999999976, -9.799999999999978, -10.299999999999983, -4.799999999999995, -4.999999999999995, -16.599999999999977, -8.699999999999982, -41.10000000000029, -7.999999999999984, -20.70000000000004, -44.40000000000033, -9.199999999999987, -12.69999999999997, -4.6999999999999975, -5.5999999999999925, -5.299999999999994, -7.599999999999985, -9.599999999999985, -5.299999999999995, -23.900000000000084, -15.099999999999973, -5.799999999999992, -5.399999999999993, -8.499999999999982, -3.1000000000000014, -7.799999999999988, -7.199999999999989, -5.799999999999992, -8.199999999999983, -5.799999999999992, -3.799999999999999, -3.5, -4.199999999999999, -6.999999999999989, -4.599999999999996, -5.299999999999999, -27.000000000000007, -5.299999999999994, -5.199999999999997, -3.8999999999999986, -3.3000000000000007, -48.40000000000025, -7.199999999999992, -9.899999999999993, -4.799999999999995, -7.79999999999999, -6.8999999999999915, -6.899999999999994, -10.999999999999986, -4.399999999999997, -42.1000000000003, -10.499999999999975, -5.099999999999995, -4.799999999999995, -13.899999999999967, -16.399999999999977], "episode_lengths": [44, 400, 166, 83, 57, 96, 46, 126, 65, 89, 70, 123, 50, 70, 51, 101, 81, 160, 42, 61, 70, 205, 182, 109, 59, 58, 190, 80, 262, 47, 223, 93, 275, 95, 66, 400, 198, 78, 54, 231, 58, 113, 78, 58, 129, 107, 94, 59, 61, 131, 93, 400, 91, 213, 400, 90, 135, 56, 67, 64, 87, 88, 62, 236, 122, 69, 65, 92, 42, 84, 78, 69, 93, 69, 49, 46, 50, 79, 57, 57, 224, 64, 60, 50, 44, 400, 77, 89, 59, 80, 75, 73, 93, 55, 400, 111, 61, 59, 125, 154]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24669068424044066, "mean_inference_ms": 0.7226156146478132, "mean_action_processing_ms": 0.07612424640494778, "mean_env_wait_ms": 6.328485730318608, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006808042526245117, "StateBufferConnector_ms": 0.003941535949707031, "ViewRequirementAgentConnector_ms": 0.08967781066894531}}, "episode_reward_max": -3.1000000000000014, "episode_reward_min": -48.40000000000025, "episode_reward_mean": -11.409000000000015, "episode_len_mean": 114.0, "episodes_this_iter": 36, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3.3000000000000007, -42.80000000000028, -17.599999999999977, -7.199999999999987, -4.599999999999996, -11.099999999999989, -3.5, -15.299999999999969, -5.399999999999993, -7.799999999999985, -6.999999999999997, -11.69999999999997, -3.8999999999999986, -8.599999999999998, -3.9999999999999982, -9.39999999999998, -7.39999999999999, -20.599999999999962, -3.1000000000000014, -4.999999999999995, -6.999999999999997, -21.30000000000003, -19.60000000000001, -11.699999999999974, -5.099999999999997, -4.699999999999996, -19.399999999999984, -7.599999999999991, -26.100000000000115, -3.5999999999999996, -22.700000000000045, -8.499999999999982, -30.30000000000015, -9.999999999999986, -5.499999999999993, -42.20000000000031, -19.800000000000026, -7.199999999999992, -4.299999999999997, -23.600000000000055, -5.599999999999992, -10.599999999999978, -6.699999999999989, -4.999999999999997, -14.299999999999976, -9.799999999999978, -10.299999999999983, -4.799999999999995, -4.999999999999995, -16.599999999999977, -8.699999999999982, -41.10000000000029, -7.999999999999984, -20.70000000000004, -44.40000000000033, -9.199999999999987, -12.69999999999997, -4.6999999999999975, -5.5999999999999925, -5.299999999999994, -7.599999999999985, -9.599999999999985, -5.299999999999995, -23.900000000000084, -15.099999999999973, -5.799999999999992, -5.399999999999993, -8.499999999999982, -3.1000000000000014, -7.799999999999988, -7.199999999999989, -5.799999999999992, -8.199999999999983, -5.799999999999992, -3.799999999999999, -3.5, -4.199999999999999, -6.999999999999989, -4.599999999999996, -5.299999999999999, -27.000000000000007, -5.299999999999994, -5.199999999999997, -3.8999999999999986, -3.3000000000000007, -48.40000000000025, -7.199999999999992, -9.899999999999993, -4.799999999999995, -7.79999999999999, -6.8999999999999915, -6.899999999999994, -10.999999999999986, -4.399999999999997, -42.1000000000003, -10.499999999999975, -5.099999999999995, -4.799999999999995, -13.899999999999967, -16.399999999999977], "episode_lengths": [44, 400, 166, 83, 57, 96, 46, 126, 65, 89, 70, 123, 50, 70, 51, 101, 81, 160, 42, 61, 70, 205, 182, 109, 59, 58, 190, 80, 262, 47, 223, 93, 275, 95, 66, 400, 198, 78, 54, 231, 58, 113, 78, 58, 129, 107, 94, 59, 61, 131, 93, 400, 91, 213, 400, 90, 135, 56, 67, 64, 87, 88, 62, 236, 122, 69, 65, 92, 42, 84, 78, 69, 93, 69, 49, 46, 50, 79, 57, 57, 224, 64, 60, 50, 44, 400, 77, 89, 59, 80, 75, 73, 93, 55, 400, 111, 61, 59, 125, 154]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24669068424044066, "mean_inference_ms": 0.7226156146478132, "mean_action_processing_ms": 0.07612424640494778, "mean_env_wait_ms": 6.328485730318608, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006808042526245117, "StateBufferConnector_ms": 0.003941535949707031, "ViewRequirementAgentConnector_ms": 0.08967781066894531}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 52000, "num_agent_steps_trained": 52000, "num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 535.9566985019633, "num_env_steps_trained_throughput_per_sec": 535.9566985019633, "timesteps_total": 52000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 52000, "timers": {"training_iteration_time_ms": 7411.483, "sample_time_ms": 3893.552, "load_time_ms": 0.899, "load_throughput": 4449717.802, "learn_time_ms": 3512.431, "learn_throughput": 1138.812, "synch_weights_time_ms": 3.953}, "counters": {"num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_agent_steps_sampled": 52000, "num_agent_steps_trained": 52000}, "done": false, "episodes_total": 282, "training_iteration": 13, "trial_id": "04cbf_00000", "date": "2024-03-07_13-19-38", "timestamp": 1709835578, "time_this_iter_s": 7.465865612030029, "time_total_s": 96.07295298576355, "pid": 119109, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7efea6399f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 96.07295298576355, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 31.188888888888886, "ram_util_percent": 50.9, "gpu_util_percent0": 0.0811111111111111, "vram_util_percent0": 0.09166124131944443}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.10000000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 3.9957126157017804, "policy_loss": -0.014595547091135735, "vf_loss": 4.0093933476876185, "vf_explained_var": -0.16493394310756396, "kl": 0.009148220262581596, "entropy": 0.9961275387194849, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 12555.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 56000}, "sampler_results": {"episode_reward_max": -3.1000000000000014, "episode_reward_min": -48.90000000000031, "episode_reward_mean": -12.087000000000023, "episode_len_mean": 120.02, "episode_media": {}, "episodes_this_iter": 31, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8.499999999999982, -30.30000000000015, -9.999999999999986, -5.499999999999993, -42.20000000000031, -19.800000000000026, -7.199999999999992, -4.299999999999997, -23.600000000000055, -5.599999999999992, -10.599999999999978, -6.699999999999989, -4.999999999999997, -14.299999999999976, -9.799999999999978, -10.299999999999983, -4.799999999999995, -4.999999999999995, -16.599999999999977, -8.699999999999982, -41.10000000000029, -7.999999999999984, -20.70000000000004, -44.40000000000033, -9.199999999999987, -12.69999999999997, -4.6999999999999975, -5.5999999999999925, -5.299999999999994, -7.599999999999985, -9.599999999999985, -5.299999999999995, -23.900000000000084, -15.099999999999973, -5.799999999999992, -5.399999999999993, -8.499999999999982, -3.1000000000000014, -7.799999999999988, -7.199999999999989, -5.799999999999992, -8.199999999999983, -5.799999999999992, -3.799999999999999, -3.5, -4.199999999999999, -6.999999999999989, -4.599999999999996, -5.299999999999999, -27.000000000000007, -5.299999999999994, -5.199999999999997, -3.8999999999999986, -3.3000000000000007, -48.40000000000025, -7.199999999999992, -9.899999999999993, -4.799999999999995, -7.79999999999999, -6.8999999999999915, -6.899999999999994, -10.999999999999986, -4.399999999999997, -42.1000000000003, -10.499999999999975, -5.099999999999995, -4.799999999999995, -13.899999999999967, -16.399999999999977, -11.999999999999972, -3.3000000000000007, -31.000000000000135, -3.6999999999999993, -7.499999999999986, -37.40000000000027, -12.09999999999997, -42.20000000000027, -7.5999999999999925, -7.89999999999999, -10.499999999999986, -16.699999999999978, -14.399999999999963, -4.399999999999997, -5.799999999999992, -4.799999999999995, -6.499999999999989, -3.799999999999999, -43.700000000000294, -7.199999999999989, -11.999999999999977, -8.499999999999982, -7.099999999999996, -3.4000000000000004, -9.499999999999979, -48.90000000000031, -15.59999999999998, -5.999999999999991, -9.19999999999998, -7.499999999999989, -5.699999999999994], "episode_lengths": [93, 275, 95, 66, 400, 198, 78, 54, 231, 58, 113, 78, 58, 129, 107, 94, 59, 61, 131, 93, 400, 91, 213, 400, 90, 135, 56, 67, 64, 87, 88, 62, 236, 122, 69, 65, 92, 42, 84, 78, 69, 93, 69, 49, 46, 50, 79, 57, 57, 224, 64, 60, 50, 44, 400, 77, 89, 59, 80, 75, 73, 93, 55, 400, 111, 61, 59, 125, 154, 130, 44, 292, 48, 86, 378, 132, 400, 76, 78, 94, 149, 130, 55, 69, 52, 76, 49, 400, 67, 104, 85, 70, 45, 104, 400, 151, 71, 103, 64, 66]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2484465450424878, "mean_inference_ms": 0.7223488939183598, "mean_action_processing_ms": 0.07602919350548891, "mean_env_wait_ms": 6.3349665648416025, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0068395137786865234, "StateBufferConnector_ms": 0.0039768218994140625, "ViewRequirementAgentConnector_ms": 0.09027743339538574}}, "episode_reward_max": -3.1000000000000014, "episode_reward_min": -48.90000000000031, "episode_reward_mean": -12.087000000000023, "episode_len_mean": 120.02, "episodes_this_iter": 31, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-8.499999999999982, -30.30000000000015, -9.999999999999986, -5.499999999999993, -42.20000000000031, -19.800000000000026, -7.199999999999992, -4.299999999999997, -23.600000000000055, -5.599999999999992, -10.599999999999978, -6.699999999999989, -4.999999999999997, -14.299999999999976, -9.799999999999978, -10.299999999999983, -4.799999999999995, -4.999999999999995, -16.599999999999977, -8.699999999999982, -41.10000000000029, -7.999999999999984, -20.70000000000004, -44.40000000000033, -9.199999999999987, -12.69999999999997, -4.6999999999999975, -5.5999999999999925, -5.299999999999994, -7.599999999999985, -9.599999999999985, -5.299999999999995, -23.900000000000084, -15.099999999999973, -5.799999999999992, -5.399999999999993, -8.499999999999982, -3.1000000000000014, -7.799999999999988, -7.199999999999989, -5.799999999999992, -8.199999999999983, -5.799999999999992, -3.799999999999999, -3.5, -4.199999999999999, -6.999999999999989, -4.599999999999996, -5.299999999999999, -27.000000000000007, -5.299999999999994, -5.199999999999997, -3.8999999999999986, -3.3000000000000007, -48.40000000000025, -7.199999999999992, -9.899999999999993, -4.799999999999995, -7.79999999999999, -6.8999999999999915, -6.899999999999994, -10.999999999999986, -4.399999999999997, -42.1000000000003, -10.499999999999975, -5.099999999999995, -4.799999999999995, -13.899999999999967, -16.399999999999977, -11.999999999999972, -3.3000000000000007, -31.000000000000135, -3.6999999999999993, -7.499999999999986, -37.40000000000027, -12.09999999999997, -42.20000000000027, -7.5999999999999925, -7.89999999999999, -10.499999999999986, -16.699999999999978, -14.399999999999963, -4.399999999999997, -5.799999999999992, -4.799999999999995, -6.499999999999989, -3.799999999999999, -43.700000000000294, -7.199999999999989, -11.999999999999977, -8.499999999999982, -7.099999999999996, -3.4000000000000004, -9.499999999999979, -48.90000000000031, -15.59999999999998, -5.999999999999991, -9.19999999999998, -7.499999999999989, -5.699999999999994], "episode_lengths": [93, 275, 95, 66, 400, 198, 78, 54, 231, 58, 113, 78, 58, 129, 107, 94, 59, 61, 131, 93, 400, 91, 213, 400, 90, 135, 56, 67, 64, 87, 88, 62, 236, 122, 69, 65, 92, 42, 84, 78, 69, 93, 69, 49, 46, 50, 79, 57, 57, 224, 64, 60, 50, 44, 400, 77, 89, 59, 80, 75, 73, 93, 55, 400, 111, 61, 59, 125, 154, 130, 44, 292, 48, 86, 378, 132, 400, 76, 78, 94, 149, 130, 55, 69, 52, 76, 49, 400, 67, 104, 85, 70, 45, 104, 400, 151, 71, 103, 64, 66]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2484465450424878, "mean_inference_ms": 0.7223488939183598, "mean_action_processing_ms": 0.07602919350548891, "mean_env_wait_ms": 6.3349665648416025, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0068395137786865234, "StateBufferConnector_ms": 0.0039768218994140625, "ViewRequirementAgentConnector_ms": 0.09027743339538574}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 56000, "num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 527.3087706848637, "num_env_steps_trained_throughput_per_sec": 527.3087706848637, "timesteps_total": 56000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 56000, "timers": {"training_iteration_time_ms": 7429.535, "sample_time_ms": 3888.161, "load_time_ms": 0.899, "load_throughput": 4448891.835, "learn_time_ms": 3535.836, "learn_throughput": 1131.274, "synch_weights_time_ms": 3.99}, "counters": {"num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 56000}, "done": false, "episodes_total": 313, "training_iteration": 14, "trial_id": "04cbf_00000", "date": "2024-03-07_13-19-46", "timestamp": 1709835586, "time_this_iter_s": 7.588277816772461, "time_total_s": 103.66123080253601, "pid": 119109, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7efea6399f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 103.66123080253601, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 30.139999999999997, "ram_util_percent": 50.92999999999999, "gpu_util_percent0": 0.08199999999999999, "vram_util_percent0": 0.09163411458333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.10000000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 5.026873672713515, "policy_loss": -0.0101937940324186, "vf_loss": 5.036346353638557, "vf_explained_var": -0.5423113780636941, "kl": 0.007211094730419318, "entropy": 0.9631818478466362, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 13485.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000}, "sampler_results": {"episode_reward_max": -3.1000000000000014, "episode_reward_min": -48.90000000000031, "episode_reward_mean": -12.112000000000021, "episode_len_mean": 119.73, "episode_media": {}, "episodes_this_iter": 30, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-9.599999999999985, -5.299999999999995, -23.900000000000084, -15.099999999999973, -5.799999999999992, -5.399999999999993, -8.499999999999982, -3.1000000000000014, -7.799999999999988, -7.199999999999989, -5.799999999999992, -8.199999999999983, -5.799999999999992, -3.799999999999999, -3.5, -4.199999999999999, -6.999999999999989, -4.599999999999996, -5.299999999999999, -27.000000000000007, -5.299999999999994, -5.199999999999997, -3.8999999999999986, -3.3000000000000007, -48.40000000000025, -7.199999999999992, -9.899999999999993, -4.799999999999995, -7.79999999999999, -6.8999999999999915, -6.899999999999994, -10.999999999999986, -4.399999999999997, -42.1000000000003, -10.499999999999975, -5.099999999999995, -4.799999999999995, -13.899999999999967, -16.399999999999977, -11.999999999999972, -3.3000000000000007, -31.000000000000135, -3.6999999999999993, -7.499999999999986, -37.40000000000027, -12.09999999999997, -42.20000000000027, -7.5999999999999925, -7.89999999999999, -10.499999999999986, -16.699999999999978, -14.399999999999963, -4.399999999999997, -5.799999999999992, -4.799999999999995, -6.499999999999989, -3.799999999999999, -43.700000000000294, -7.199999999999989, -11.999999999999977, -8.499999999999982, -7.099999999999996, -3.4000000000000004, -9.499999999999979, -48.90000000000031, -15.59999999999998, -5.999999999999991, -9.19999999999998, -7.499999999999989, -5.699999999999994, -45.70000000000034, -5.299999999999994, -20.09999999999997, -6.699999999999991, -5.999999999999991, -8.699999999999985, -3.1000000000000014, -5.199999999999995, -4.1999999999999975, -17.699999999999996, -3.3000000000000007, -7.899999999999984, -12.699999999999974, -4.199999999999998, -21.700000000000063, -10.799999999999976, -37.10000000000007, -7.499999999999988, -28.60000000000011, -7.499999999999993, -35.90000000000021, -30.40000000000015, -11.099999999999975, -15.099999999999959, -4.299999999999997, -10.199999999999978, -7.999999999999984, -22.50000000000005, -4.399999999999997, -4.700000000000002], "episode_lengths": [88, 62, 236, 122, 69, 65, 92, 42, 84, 78, 69, 93, 69, 49, 46, 50, 79, 57, 57, 224, 64, 60, 50, 44, 400, 77, 89, 59, 80, 75, 73, 93, 55, 400, 111, 61, 59, 125, 154, 130, 44, 292, 48, 86, 378, 132, 400, 76, 78, 94, 149, 130, 55, 69, 52, 76, 49, 400, 67, 104, 85, 70, 45, 104, 400, 151, 71, 103, 64, 66, 400, 64, 194, 75, 69, 94, 42, 62, 53, 188, 44, 90, 110, 52, 216, 99, 270, 85, 276, 78, 359, 297, 110, 162, 54, 97, 91, 208, 55, 51]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24975437320740634, "mean_inference_ms": 0.7223442293778057, "mean_action_processing_ms": 0.0760179449280348, "mean_env_wait_ms": 6.340375430810691, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0069217681884765625, "StateBufferConnector_ms": 0.003955364227294922, "ViewRequirementAgentConnector_ms": 0.09017705917358398}}, "episode_reward_max": -3.1000000000000014, "episode_reward_min": -48.90000000000031, "episode_reward_mean": -12.112000000000021, "episode_len_mean": 119.73, "episodes_this_iter": 30, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-9.599999999999985, -5.299999999999995, -23.900000000000084, -15.099999999999973, -5.799999999999992, -5.399999999999993, -8.499999999999982, -3.1000000000000014, -7.799999999999988, -7.199999999999989, -5.799999999999992, -8.199999999999983, -5.799999999999992, -3.799999999999999, -3.5, -4.199999999999999, -6.999999999999989, -4.599999999999996, -5.299999999999999, -27.000000000000007, -5.299999999999994, -5.199999999999997, -3.8999999999999986, -3.3000000000000007, -48.40000000000025, -7.199999999999992, -9.899999999999993, -4.799999999999995, -7.79999999999999, -6.8999999999999915, -6.899999999999994, -10.999999999999986, -4.399999999999997, -42.1000000000003, -10.499999999999975, -5.099999999999995, -4.799999999999995, -13.899999999999967, -16.399999999999977, -11.999999999999972, -3.3000000000000007, -31.000000000000135, -3.6999999999999993, -7.499999999999986, -37.40000000000027, -12.09999999999997, -42.20000000000027, -7.5999999999999925, -7.89999999999999, -10.499999999999986, -16.699999999999978, -14.399999999999963, -4.399999999999997, -5.799999999999992, -4.799999999999995, -6.499999999999989, -3.799999999999999, -43.700000000000294, -7.199999999999989, -11.999999999999977, -8.499999999999982, -7.099999999999996, -3.4000000000000004, -9.499999999999979, -48.90000000000031, -15.59999999999998, -5.999999999999991, -9.19999999999998, -7.499999999999989, -5.699999999999994, -45.70000000000034, -5.299999999999994, -20.09999999999997, -6.699999999999991, -5.999999999999991, -8.699999999999985, -3.1000000000000014, -5.199999999999995, -4.1999999999999975, -17.699999999999996, -3.3000000000000007, -7.899999999999984, -12.699999999999974, -4.199999999999998, -21.700000000000063, -10.799999999999976, -37.10000000000007, -7.499999999999988, -28.60000000000011, -7.499999999999993, -35.90000000000021, -30.40000000000015, -11.099999999999975, -15.099999999999959, -4.299999999999997, -10.199999999999978, -7.999999999999984, -22.50000000000005, -4.399999999999997, -4.700000000000002], "episode_lengths": [88, 62, 236, 122, 69, 65, 92, 42, 84, 78, 69, 93, 69, 49, 46, 50, 79, 57, 57, 224, 64, 60, 50, 44, 400, 77, 89, 59, 80, 75, 73, 93, 55, 400, 111, 61, 59, 125, 154, 130, 44, 292, 48, 86, 378, 132, 400, 76, 78, 94, 149, 130, 55, 69, 52, 76, 49, 400, 67, 104, 85, 70, 45, 104, 400, 151, 71, 103, 64, 66, 400, 64, 194, 75, 69, 94, 42, 62, 53, 188, 44, 90, 110, 52, 216, 99, 270, 85, 276, 78, 359, 297, 110, 162, 54, 97, 91, 208, 55, 51]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24975437320740634, "mean_inference_ms": 0.7223442293778057, "mean_action_processing_ms": 0.0760179449280348, "mean_env_wait_ms": 6.340375430810691, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0069217681884765625, "StateBufferConnector_ms": 0.003955364227294922, "ViewRequirementAgentConnector_ms": 0.09017705917358398}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000, "num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 546.1928953840995, "num_env_steps_trained_throughput_per_sec": 546.1928953840995, "timesteps_total": 60000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 60000, "timers": {"training_iteration_time_ms": 7431.679, "sample_time_ms": 3882.287, "load_time_ms": 0.913, "load_throughput": 4381274.907, "learn_time_ms": 3543.78, "learn_throughput": 1128.738, "synch_weights_time_ms": 4.05}, "counters": {"num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000}, "done": false, "episodes_total": 343, "training_iteration": 15, "trial_id": "04cbf_00000", "date": "2024-03-07_13-19-53", "timestamp": 1709835593, "time_this_iter_s": 7.326297044754028, "time_total_s": 110.98752784729004, "pid": 119109, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7efea6399f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 110.98752784729004, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 28.78, "ram_util_percent": 50.97, "gpu_util_percent0": 0.09100000000000001, "vram_util_percent0": 0.09165852864583335}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.10000000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 2.3070132836338972, "policy_loss": -0.018583211368851122, "vf_loss": 2.3247866844938647, "vf_explained_var": 0.4541929639795775, "kl": 0.00809806590031556, "entropy": 0.9703777368991605, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 14415.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000}, "sampler_results": {"episode_reward_max": -2.5000000000000018, "episode_reward_min": -49.20000000000029, "episode_reward_mean": -11.058000000000016, "episode_len_mean": 110.63, "episode_media": {}, "episodes_this_iter": 48, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-7.89999999999999, -10.499999999999986, -16.699999999999978, -14.399999999999963, -4.399999999999997, -5.799999999999992, -4.799999999999995, -6.499999999999989, -3.799999999999999, -43.700000000000294, -7.199999999999989, -11.999999999999977, -8.499999999999982, -7.099999999999996, -3.4000000000000004, -9.499999999999979, -48.90000000000031, -15.59999999999998, -5.999999999999991, -9.19999999999998, -7.499999999999989, -5.699999999999994, -45.70000000000034, -5.299999999999994, -20.09999999999997, -6.699999999999991, -5.999999999999991, -8.699999999999985, -3.1000000000000014, -5.199999999999995, -4.1999999999999975, -17.699999999999996, -3.3000000000000007, -7.899999999999984, -12.699999999999974, -4.199999999999998, -21.700000000000063, -10.799999999999976, -37.10000000000007, -7.499999999999988, -28.60000000000011, -7.499999999999993, -35.90000000000021, -30.40000000000015, -11.099999999999975, -15.099999999999959, -4.299999999999997, -10.199999999999978, -7.999999999999984, -22.50000000000005, -4.399999999999997, -4.700000000000002, -9.899999999999977, -11.09999999999998, -3.5, -2.5000000000000018, -8.299999999999983, -8.399999999999988, -8.299999999999983, -38.700000000000266, -7.8999999999999915, -4.599999999999996, -16.49999999999998, -9.699999999999978, -3.6999999999999993, -4.999999999999995, -6.199999999999994, -8.99999999999998, -6.599999999999999, -4.099999999999998, -3.200000000000001, -11.099999999999973, -2.700000000000002, -4.599999999999996, -10.899999999999974, -4.899999999999996, -4.599999999999996, -3.4000000000000004, -10.899999999999974, -5.199999999999995, -4.1999999999999975, -11.79999999999997, -4.1999999999999975, -5.999999999999991, -9.199999999999983, -10.499999999999975, -4.799999999999998, -9.69999999999998, -5.5999999999999925, -3.9999999999999982, -23.100000000000076, -7.999999999999989, -23.70000000000005, -13.399999999999965, -3.3000000000000007, -49.20000000000029, -6.8999999999999915, -3.6999999999999993, -3.5, -5.799999999999991], "episode_lengths": [78, 94, 149, 130, 55, 69, 52, 76, 49, 400, 67, 104, 85, 70, 45, 104, 400, 151, 71, 103, 64, 66, 400, 64, 194, 75, 69, 94, 42, 62, 53, 188, 44, 90, 110, 52, 216, 99, 270, 85, 276, 78, 359, 297, 110, 162, 54, 97, 91, 208, 55, 51, 104, 100, 46, 36, 94, 82, 94, 382, 83, 57, 166, 108, 48, 61, 69, 101, 66, 52, 43, 116, 38, 57, 107, 59, 57, 45, 114, 62, 53, 113, 53, 71, 99, 116, 56, 99, 67, 51, 232, 85, 200, 127, 44, 400, 76, 48, 46, 53]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.25218459131816096, "mean_inference_ms": 0.7223468171782683, "mean_action_processing_ms": 0.07597560636374227, "mean_env_wait_ms": 6.344564660442035, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006855487823486328, "StateBufferConnector_ms": 0.0038928985595703125, "ViewRequirementAgentConnector_ms": 0.08949637413024902}}, "episode_reward_max": -2.5000000000000018, "episode_reward_min": -49.20000000000029, "episode_reward_mean": -11.058000000000016, "episode_len_mean": 110.63, "episodes_this_iter": 48, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-7.89999999999999, -10.499999999999986, -16.699999999999978, -14.399999999999963, -4.399999999999997, -5.799999999999992, -4.799999999999995, -6.499999999999989, -3.799999999999999, -43.700000000000294, -7.199999999999989, -11.999999999999977, -8.499999999999982, -7.099999999999996, -3.4000000000000004, -9.499999999999979, -48.90000000000031, -15.59999999999998, -5.999999999999991, -9.19999999999998, -7.499999999999989, -5.699999999999994, -45.70000000000034, -5.299999999999994, -20.09999999999997, -6.699999999999991, -5.999999999999991, -8.699999999999985, -3.1000000000000014, -5.199999999999995, -4.1999999999999975, -17.699999999999996, -3.3000000000000007, -7.899999999999984, -12.699999999999974, -4.199999999999998, -21.700000000000063, -10.799999999999976, -37.10000000000007, -7.499999999999988, -28.60000000000011, -7.499999999999993, -35.90000000000021, -30.40000000000015, -11.099999999999975, -15.099999999999959, -4.299999999999997, -10.199999999999978, -7.999999999999984, -22.50000000000005, -4.399999999999997, -4.700000000000002, -9.899999999999977, -11.09999999999998, -3.5, -2.5000000000000018, -8.299999999999983, -8.399999999999988, -8.299999999999983, -38.700000000000266, -7.8999999999999915, -4.599999999999996, -16.49999999999998, -9.699999999999978, -3.6999999999999993, -4.999999999999995, -6.199999999999994, -8.99999999999998, -6.599999999999999, -4.099999999999998, -3.200000000000001, -11.099999999999973, -2.700000000000002, -4.599999999999996, -10.899999999999974, -4.899999999999996, -4.599999999999996, -3.4000000000000004, -10.899999999999974, -5.199999999999995, -4.1999999999999975, -11.79999999999997, -4.1999999999999975, -5.999999999999991, -9.199999999999983, -10.499999999999975, -4.799999999999998, -9.69999999999998, -5.5999999999999925, -3.9999999999999982, -23.100000000000076, -7.999999999999989, -23.70000000000005, -13.399999999999965, -3.3000000000000007, -49.20000000000029, -6.8999999999999915, -3.6999999999999993, -3.5, -5.799999999999991], "episode_lengths": [78, 94, 149, 130, 55, 69, 52, 76, 49, 400, 67, 104, 85, 70, 45, 104, 400, 151, 71, 103, 64, 66, 400, 64, 194, 75, 69, 94, 42, 62, 53, 188, 44, 90, 110, 52, 216, 99, 270, 85, 276, 78, 359, 297, 110, 162, 54, 97, 91, 208, 55, 51, 104, 100, 46, 36, 94, 82, 94, 382, 83, 57, 166, 108, 48, 61, 69, 101, 66, 52, 43, 116, 38, 57, 107, 59, 57, 45, 114, 62, 53, 113, 53, 71, 99, 116, 56, 99, 67, 51, 232, 85, 200, 127, 44, 400, 76, 48, 46, 53]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.25218459131816096, "mean_inference_ms": 0.7223468171782683, "mean_action_processing_ms": 0.07597560636374227, "mean_env_wait_ms": 6.344564660442035, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006855487823486328, "StateBufferConnector_ms": 0.0038928985595703125, "ViewRequirementAgentConnector_ms": 0.08949637413024902}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000, "num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 525.4116255995713, "num_env_steps_trained_throughput_per_sec": 525.4116255995713, "timesteps_total": 64000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 64000, "timers": {"training_iteration_time_ms": 7443.296, "sample_time_ms": 3913.25, "load_time_ms": 0.924, "load_throughput": 4331168.938, "learn_time_ms": 3524.411, "learn_throughput": 1134.942, "synch_weights_time_ms": 4.063}, "counters": {"num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000}, "done": false, "episodes_total": 391, "training_iteration": 16, "trial_id": "04cbf_00000", "date": "2024-03-07_13-20-01", "timestamp": 1709835601, "time_this_iter_s": 7.615536212921143, "time_total_s": 118.60306406021118, "pid": 119109, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7efea6399f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 118.60306406021118, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 29.01, "ram_util_percent": 51.0, "gpu_util_percent0": 0.093, "vram_util_percent0": 0.09165852864583333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.10000000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 2.9854035722106818, "policy_loss": -0.0073877816999791774, "vf_loss": 2.9919656301057467, "vf_explained_var": 0.2975260849921934, "kl": 0.00825733965330978, "entropy": 0.9320003110875366, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 15345.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_agent_steps_sampled": 68000, "num_agent_steps_trained": 68000}, "sampler_results": {"episode_reward_max": -2.4000000000000017, "episode_reward_min": -70.00000000000047, "episode_reward_mean": -8.329000000000006, "episode_len_mean": 86.37, "episode_media": {}, "episodes_this_iter": 51, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4.700000000000002, -9.899999999999977, -11.09999999999998, -3.5, -2.5000000000000018, -8.299999999999983, -8.399999999999988, -8.299999999999983, -38.700000000000266, -7.8999999999999915, -4.599999999999996, -16.49999999999998, -9.699999999999978, -3.6999999999999993, -4.999999999999995, -6.199999999999994, -8.99999999999998, -6.599999999999999, -4.099999999999998, -3.200000000000001, -11.099999999999973, -2.700000000000002, -4.599999999999996, -10.899999999999974, -4.899999999999996, -4.599999999999996, -3.4000000000000004, -10.899999999999974, -5.199999999999995, -4.1999999999999975, -11.79999999999997, -4.1999999999999975, -5.999999999999991, -9.199999999999983, -10.499999999999975, -4.799999999999998, -9.69999999999998, -5.5999999999999925, -3.9999999999999982, -23.100000000000076, -7.999999999999989, -23.70000000000005, -13.399999999999965, -3.3000000000000007, -49.20000000000029, -6.8999999999999915, -3.6999999999999993, -3.5, -5.799999999999991, -3.5, -5.699999999999995, -16.099999999999973, -3.9999999999999982, -3.9999999999999982, -13.199999999999966, -3.1000000000000014, -16.79999999999998, -3.4000000000000004, -3.1000000000000014, -3.799999999999999, -8.799999999999981, -3.5999999999999996, -4.100000000000001, -10.499999999999975, -5.499999999999993, -2.800000000000002, -6.599999999999998, -3.5, -4.099999999999998, -3.200000000000001, -4.099999999999998, -3.3000000000000007, -7.299999999999988, -8.299999999999983, -4.799999999999995, -6.299999999999998, -5.599999999999994, -5.799999999999992, -6.599999999999989, -5.099999999999994, -6.3999999999999915, -3.3000000000000007, -8.699999999999982, -7.699999999999989, -3.799999999999999, -29.00000000000014, -4.599999999999996, -6.599999999999989, -2.4000000000000017, -7.599999999999998, -4.4999999999999964, -5.399999999999995, -3.200000000000001, -14.299999999999965, -3.1000000000000014, -70.00000000000047, -9.199999999999998, -3.5, -6.699999999999989, -5.499999999999993], "episode_lengths": [51, 104, 100, 46, 36, 94, 82, 94, 382, 83, 57, 166, 108, 48, 61, 69, 101, 66, 52, 43, 116, 38, 57, 107, 59, 57, 45, 114, 62, 53, 113, 53, 71, 99, 116, 56, 99, 67, 51, 232, 85, 200, 127, 44, 400, 76, 48, 46, 53, 46, 65, 167, 51, 51, 139, 42, 172, 45, 42, 49, 99, 47, 48, 116, 66, 39, 67, 46, 52, 43, 52, 44, 83, 93, 59, 56, 65, 69, 77, 62, 73, 44, 98, 85, 49, 293, 57, 77, 35, 72, 56, 63, 43, 144, 42, 400, 77, 46, 78, 66]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2549904744396338, "mean_inference_ms": 0.7230684064536013, "mean_action_processing_ms": 0.0760402033540959, "mean_env_wait_ms": 6.36297126671421, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00673222541809082, "StateBufferConnector_ms": 0.003904581069946289, "ViewRequirementAgentConnector_ms": 0.08961033821105957}}, "episode_reward_max": -2.4000000000000017, "episode_reward_min": -70.00000000000047, "episode_reward_mean": -8.329000000000006, "episode_len_mean": 86.37, "episodes_this_iter": 51, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-4.700000000000002, -9.899999999999977, -11.09999999999998, -3.5, -2.5000000000000018, -8.299999999999983, -8.399999999999988, -8.299999999999983, -38.700000000000266, -7.8999999999999915, -4.599999999999996, -16.49999999999998, -9.699999999999978, -3.6999999999999993, -4.999999999999995, -6.199999999999994, -8.99999999999998, -6.599999999999999, -4.099999999999998, -3.200000000000001, -11.099999999999973, -2.700000000000002, -4.599999999999996, -10.899999999999974, -4.899999999999996, -4.599999999999996, -3.4000000000000004, -10.899999999999974, -5.199999999999995, -4.1999999999999975, -11.79999999999997, -4.1999999999999975, -5.999999999999991, -9.199999999999983, -10.499999999999975, -4.799999999999998, -9.69999999999998, -5.5999999999999925, -3.9999999999999982, -23.100000000000076, -7.999999999999989, -23.70000000000005, -13.399999999999965, -3.3000000000000007, -49.20000000000029, -6.8999999999999915, -3.6999999999999993, -3.5, -5.799999999999991, -3.5, -5.699999999999995, -16.099999999999973, -3.9999999999999982, -3.9999999999999982, -13.199999999999966, -3.1000000000000014, -16.79999999999998, -3.4000000000000004, -3.1000000000000014, -3.799999999999999, -8.799999999999981, -3.5999999999999996, -4.100000000000001, -10.499999999999975, -5.499999999999993, -2.800000000000002, -6.599999999999998, -3.5, -4.099999999999998, -3.200000000000001, -4.099999999999998, -3.3000000000000007, -7.299999999999988, -8.299999999999983, -4.799999999999995, -6.299999999999998, -5.599999999999994, -5.799999999999992, -6.599999999999989, -5.099999999999994, -6.3999999999999915, -3.3000000000000007, -8.699999999999982, -7.699999999999989, -3.799999999999999, -29.00000000000014, -4.599999999999996, -6.599999999999989, -2.4000000000000017, -7.599999999999998, -4.4999999999999964, -5.399999999999995, -3.200000000000001, -14.299999999999965, -3.1000000000000014, -70.00000000000047, -9.199999999999998, -3.5, -6.699999999999989, -5.499999999999993], "episode_lengths": [51, 104, 100, 46, 36, 94, 82, 94, 382, 83, 57, 166, 108, 48, 61, 69, 101, 66, 52, 43, 116, 38, 57, 107, 59, 57, 45, 114, 62, 53, 113, 53, 71, 99, 116, 56, 99, 67, 51, 232, 85, 200, 127, 44, 400, 76, 48, 46, 53, 46, 65, 167, 51, 51, 139, 42, 172, 45, 42, 49, 99, 47, 48, 116, 66, 39, 67, 46, 52, 43, 52, 44, 83, 93, 59, 56, 65, 69, 77, 62, 73, 44, 98, 85, 49, 293, 57, 77, 35, 72, 56, 63, 43, 144, 42, 400, 77, 46, 78, 66]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2549904744396338, "mean_inference_ms": 0.7230684064536013, "mean_action_processing_ms": 0.0760402033540959, "mean_env_wait_ms": 6.36297126671421, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00673222541809082, "StateBufferConnector_ms": 0.003904581069946289, "ViewRequirementAgentConnector_ms": 0.08961033821105957}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 68000, "num_agent_steps_trained": 68000, "num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 519.5047734402184, "num_env_steps_trained_throughput_per_sec": 519.5047734402184, "timesteps_total": 68000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 68000, "timers": {"training_iteration_time_ms": 7466.147, "sample_time_ms": 3934.468, "load_time_ms": 0.933, "load_throughput": 4289531.602, "learn_time_ms": 3526.064, "learn_throughput": 1134.409, "synch_weights_time_ms": 4.032}, "counters": {"num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_agent_steps_sampled": 68000, "num_agent_steps_trained": 68000}, "done": false, "episodes_total": 442, "training_iteration": 17, "trial_id": "04cbf_00000", "date": "2024-03-07_13-20-09", "timestamp": 1709835609, "time_this_iter_s": 7.702367067337036, "time_total_s": 126.30543112754822, "pid": 119109, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7efea6399f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 126.30543112754822, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 29.28, "ram_util_percent": 50.90999999999999, "gpu_util_percent0": 0.09000000000000001, "vram_util_percent0": 0.09165852864583332}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.10000000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 3.141754052618779, "policy_loss": -0.010186579477001903, "vf_loss": 3.151030254027536, "vf_explained_var": 0.4880532942792421, "kl": 0.009103745613420176, "entropy": 0.9384615107890099, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 16275.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000}, "sampler_results": {"episode_reward_max": -2.4000000000000017, "episode_reward_min": -70.00000000000047, "episode_reward_mean": -8.540000000000001, "episode_len_mean": 86.95, "episode_media": {}, "episodes_this_iter": 42, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-13.399999999999965, -3.3000000000000007, -49.20000000000029, -6.8999999999999915, -3.6999999999999993, -3.5, -5.799999999999991, -3.5, -5.699999999999995, -16.099999999999973, -3.9999999999999982, -3.9999999999999982, -13.199999999999966, -3.1000000000000014, -16.79999999999998, -3.4000000000000004, -3.1000000000000014, -3.799999999999999, -8.799999999999981, -3.5999999999999996, -4.100000000000001, -10.499999999999975, -5.499999999999993, -2.800000000000002, -6.599999999999998, -3.5, -4.099999999999998, -3.200000000000001, -4.099999999999998, -3.3000000000000007, -7.299999999999988, -8.299999999999983, -4.799999999999995, -6.299999999999998, -5.599999999999994, -5.799999999999992, -6.599999999999989, -5.099999999999994, -6.3999999999999915, -3.3000000000000007, -8.699999999999982, -7.699999999999989, -3.799999999999999, -29.00000000000014, -4.599999999999996, -6.599999999999989, -2.4000000000000017, -7.599999999999998, -4.4999999999999964, -5.399999999999995, -3.200000000000001, -14.299999999999965, -3.1000000000000014, -70.00000000000047, -9.199999999999998, -3.5, -6.699999999999989, -5.499999999999993, -23.700000000000077, -15.799999999999969, -3.4000000000000004, -3.3000000000000007, -5.699999999999992, -4.999999999999997, -10.599999999999975, -3.0000000000000018, -4.799999999999999, -12.599999999999968, -11.599999999999971, -8.399999999999993, -4.099999999999998, -9.399999999999984, -6.999999999999988, -4.699999999999996, -17.199999999999978, -2.600000000000002, -14.399999999999961, -2.700000000000002, -3.1000000000000014, -3.3000000000000007, -7.999999999999984, -3.6999999999999993, -7.699999999999985, -5.099999999999994, -10.299999999999976, -3.3000000000000007, -5.2999999999999945, -7.2999999999999865, -29.6000000000001, -8.499999999999982, -3.0000000000000018, -32.29999999999997, -13.499999999999968, -5.299999999999994, -4.599999999999996, -7.899999999999984, -10.299999999999983, -15.099999999999966, -9.999999999999979, -8.899999999999986], "episode_lengths": [127, 44, 400, 76, 48, 46, 53, 46, 65, 167, 51, 51, 139, 42, 172, 45, 42, 49, 99, 47, 48, 116, 66, 39, 67, 46, 52, 43, 52, 44, 83, 93, 59, 56, 65, 69, 77, 62, 73, 44, 98, 85, 49, 293, 57, 77, 35, 72, 56, 63, 43, 144, 42, 400, 77, 46, 78, 66, 247, 169, 45, 44, 68, 58, 105, 41, 55, 135, 125, 76, 52, 91, 81, 58, 122, 37, 155, 38, 42, 44, 91, 48, 88, 62, 105, 39, 63, 84, 243, 96, 41, 233, 119, 64, 57, 90, 93, 156, 97, 94]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.25657612233146176, "mean_inference_ms": 0.7231259129352978, "mean_action_processing_ms": 0.07604596752839438, "mean_env_wait_ms": 6.370740626903134, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006856441497802734, "StateBufferConnector_ms": 0.003901243209838867, "ViewRequirementAgentConnector_ms": 0.08906817436218262}}, "episode_reward_max": -2.4000000000000017, "episode_reward_min": -70.00000000000047, "episode_reward_mean": -8.540000000000001, "episode_len_mean": 86.95, "episodes_this_iter": 42, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-13.399999999999965, -3.3000000000000007, -49.20000000000029, -6.8999999999999915, -3.6999999999999993, -3.5, -5.799999999999991, -3.5, -5.699999999999995, -16.099999999999973, -3.9999999999999982, -3.9999999999999982, -13.199999999999966, -3.1000000000000014, -16.79999999999998, -3.4000000000000004, -3.1000000000000014, -3.799999999999999, -8.799999999999981, -3.5999999999999996, -4.100000000000001, -10.499999999999975, -5.499999999999993, -2.800000000000002, -6.599999999999998, -3.5, -4.099999999999998, -3.200000000000001, -4.099999999999998, -3.3000000000000007, -7.299999999999988, -8.299999999999983, -4.799999999999995, -6.299999999999998, -5.599999999999994, -5.799999999999992, -6.599999999999989, -5.099999999999994, -6.3999999999999915, -3.3000000000000007, -8.699999999999982, -7.699999999999989, -3.799999999999999, -29.00000000000014, -4.599999999999996, -6.599999999999989, -2.4000000000000017, -7.599999999999998, -4.4999999999999964, -5.399999999999995, -3.200000000000001, -14.299999999999965, -3.1000000000000014, -70.00000000000047, -9.199999999999998, -3.5, -6.699999999999989, -5.499999999999993, -23.700000000000077, -15.799999999999969, -3.4000000000000004, -3.3000000000000007, -5.699999999999992, -4.999999999999997, -10.599999999999975, -3.0000000000000018, -4.799999999999999, -12.599999999999968, -11.599999999999971, -8.399999999999993, -4.099999999999998, -9.399999999999984, -6.999999999999988, -4.699999999999996, -17.199999999999978, -2.600000000000002, -14.399999999999961, -2.700000000000002, -3.1000000000000014, -3.3000000000000007, -7.999999999999984, -3.6999999999999993, -7.699999999999985, -5.099999999999994, -10.299999999999976, -3.3000000000000007, -5.2999999999999945, -7.2999999999999865, -29.6000000000001, -8.499999999999982, -3.0000000000000018, -32.29999999999997, -13.499999999999968, -5.299999999999994, -4.599999999999996, -7.899999999999984, -10.299999999999983, -15.099999999999966, -9.999999999999979, -8.899999999999986], "episode_lengths": [127, 44, 400, 76, 48, 46, 53, 46, 65, 167, 51, 51, 139, 42, 172, 45, 42, 49, 99, 47, 48, 116, 66, 39, 67, 46, 52, 43, 52, 44, 83, 93, 59, 56, 65, 69, 77, 62, 73, 44, 98, 85, 49, 293, 57, 77, 35, 72, 56, 63, 43, 144, 42, 400, 77, 46, 78, 66, 247, 169, 45, 44, 68, 58, 105, 41, 55, 135, 125, 76, 52, 91, 81, 58, 122, 37, 155, 38, 42, 44, 91, 48, 88, 62, 105, 39, 63, 84, 243, 96, 41, 233, 119, 64, 57, 90, 93, 156, 97, 94]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.25657612233146176, "mean_inference_ms": 0.7231259129352978, "mean_action_processing_ms": 0.07604596752839438, "mean_env_wait_ms": 6.370740626903134, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006856441497802734, "StateBufferConnector_ms": 0.003901243209838867, "ViewRequirementAgentConnector_ms": 0.08906817436218262}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000, "num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 540.9921294510395, "num_env_steps_trained_throughput_per_sec": 540.9921294510395, "timesteps_total": 72000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 72000, "timers": {"training_iteration_time_ms": 7455.662, "sample_time_ms": 3921.743, "load_time_ms": 0.931, "load_throughput": 4297993.083, "learn_time_ms": 3528.217, "learn_throughput": 1133.717, "synch_weights_time_ms": 4.12}, "counters": {"num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000}, "done": false, "episodes_total": 484, "training_iteration": 18, "trial_id": "04cbf_00000", "date": "2024-03-07_13-20-16", "timestamp": 1709835616, "time_this_iter_s": 7.396703243255615, "time_total_s": 133.70213437080383, "pid": 119109, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7efea6399f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 133.70213437080383, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 31.255555555555556, "ram_util_percent": 50.9, "gpu_util_percent0": 0.08, "vram_util_percent0": 0.09163411458333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.10000000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 2.545727992397658, "policy_loss": -0.009310829597375085, "vf_loss": 2.5539276414180314, "vf_explained_var": 0.4842766358006385, "kl": 0.01111185041527337, "entropy": 0.8959729600337244, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 17205.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_agent_steps_sampled": 76000, "num_agent_steps_trained": 76000}, "sampler_results": {"episode_reward_max": -2.2000000000000015, "episode_reward_min": -55.50000000000027, "episode_reward_mean": -7.8919999999999995, "episode_len_mean": 82.4, "episode_media": {}, "episodes_this_iter": 57, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-5.499999999999993, -23.700000000000077, -15.799999999999969, -3.4000000000000004, -3.3000000000000007, -5.699999999999992, -4.999999999999997, -10.599999999999975, -3.0000000000000018, -4.799999999999999, -12.599999999999968, -11.599999999999971, -8.399999999999993, -4.099999999999998, -9.399999999999984, -6.999999999999988, -4.699999999999996, -17.199999999999978, -2.600000000000002, -14.399999999999961, -2.700000000000002, -3.1000000000000014, -3.3000000000000007, -7.999999999999984, -3.6999999999999993, -7.699999999999985, -5.099999999999994, -10.299999999999976, -3.3000000000000007, -5.2999999999999945, -7.2999999999999865, -29.6000000000001, -8.499999999999982, -3.0000000000000018, -32.29999999999997, -13.499999999999968, -5.299999999999994, -4.599999999999996, -7.899999999999984, -10.299999999999983, -15.099999999999966, -9.999999999999979, -8.899999999999986, -4.299999999999997, -2.600000000000002, -3.9000000000000004, -3.9999999999999982, -6.099999999999991, -10.099999999999977, -6.299999999999991, -4.6, -55.50000000000027, -3.8, -4.1999999999999975, -5.399999999999993, -3.1000000000000014, -4.1999999999999975, -10.899999999999974, -3.4000000000000004, -2.900000000000002, -13.199999999999966, -2.900000000000002, -5.699999999999992, -12.799999999999969, -4.099999999999998, -3.200000000000001, -3.799999999999999, -2.800000000000002, -5.999999999999998, -2.3000000000000016, -3.8999999999999986, -6.799999999999991, -24.80000000000009, -4.099999999999998, -3.200000000000001, -4.1999999999999975, -4.099999999999998, -2.800000000000002, -3.9000000000000012, -13.099999999999966, -28.800000000000075, -2.800000000000002, -8.89999999999998, -10.199999999999994, -21.299999999999944, -3.799999999999999, -3.6999999999999993, -11.899999999999972, -3.8999999999999986, -5.299999999999996, -3.9999999999999982, -2.2000000000000015, -4.100000000000001, -3.0000000000000018, -2.700000000000002, -3.5, -5.699999999999996, -6.19999999999999, -3.5999999999999996, -8.999999999999993], "episode_lengths": [66, 247, 169, 45, 44, 68, 58, 105, 41, 55, 135, 125, 76, 52, 91, 81, 58, 122, 37, 155, 38, 42, 44, 91, 48, 88, 62, 105, 39, 63, 84, 243, 96, 41, 233, 119, 64, 57, 90, 93, 156, 97, 94, 54, 37, 48, 51, 72, 106, 73, 52, 400, 48, 53, 65, 42, 53, 118, 45, 40, 143, 40, 68, 136, 52, 43, 49, 39, 63, 34, 50, 76, 257, 52, 43, 53, 49, 39, 45, 142, 263, 39, 100, 78, 176, 49, 48, 112, 50, 61, 51, 33, 47, 41, 38, 42, 64, 71, 47, 83]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.25922969161503756, "mean_inference_ms": 0.7224954869080428, "mean_action_processing_ms": 0.07588050686158616, "mean_env_wait_ms": 6.380937396398196, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0069811344146728516, "StateBufferConnector_ms": 0.003913164138793945, "ViewRequirementAgentConnector_ms": 0.08918237686157227}}, "episode_reward_max": -2.2000000000000015, "episode_reward_min": -55.50000000000027, "episode_reward_mean": -7.8919999999999995, "episode_len_mean": 82.4, "episodes_this_iter": 57, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-5.499999999999993, -23.700000000000077, -15.799999999999969, -3.4000000000000004, -3.3000000000000007, -5.699999999999992, -4.999999999999997, -10.599999999999975, -3.0000000000000018, -4.799999999999999, -12.599999999999968, -11.599999999999971, -8.399999999999993, -4.099999999999998, -9.399999999999984, -6.999999999999988, -4.699999999999996, -17.199999999999978, -2.600000000000002, -14.399999999999961, -2.700000000000002, -3.1000000000000014, -3.3000000000000007, -7.999999999999984, -3.6999999999999993, -7.699999999999985, -5.099999999999994, -10.299999999999976, -3.3000000000000007, -5.2999999999999945, -7.2999999999999865, -29.6000000000001, -8.499999999999982, -3.0000000000000018, -32.29999999999997, -13.499999999999968, -5.299999999999994, -4.599999999999996, -7.899999999999984, -10.299999999999983, -15.099999999999966, -9.999999999999979, -8.899999999999986, -4.299999999999997, -2.600000000000002, -3.9000000000000004, -3.9999999999999982, -6.099999999999991, -10.099999999999977, -6.299999999999991, -4.6, -55.50000000000027, -3.8, -4.1999999999999975, -5.399999999999993, -3.1000000000000014, -4.1999999999999975, -10.899999999999974, -3.4000000000000004, -2.900000000000002, -13.199999999999966, -2.900000000000002, -5.699999999999992, -12.799999999999969, -4.099999999999998, -3.200000000000001, -3.799999999999999, -2.800000000000002, -5.999999999999998, -2.3000000000000016, -3.8999999999999986, -6.799999999999991, -24.80000000000009, -4.099999999999998, -3.200000000000001, -4.1999999999999975, -4.099999999999998, -2.800000000000002, -3.9000000000000012, -13.099999999999966, -28.800000000000075, -2.800000000000002, -8.89999999999998, -10.199999999999994, -21.299999999999944, -3.799999999999999, -3.6999999999999993, -11.899999999999972, -3.8999999999999986, -5.299999999999996, -3.9999999999999982, -2.2000000000000015, -4.100000000000001, -3.0000000000000018, -2.700000000000002, -3.5, -5.699999999999996, -6.19999999999999, -3.5999999999999996, -8.999999999999993], "episode_lengths": [66, 247, 169, 45, 44, 68, 58, 105, 41, 55, 135, 125, 76, 52, 91, 81, 58, 122, 37, 155, 38, 42, 44, 91, 48, 88, 62, 105, 39, 63, 84, 243, 96, 41, 233, 119, 64, 57, 90, 93, 156, 97, 94, 54, 37, 48, 51, 72, 106, 73, 52, 400, 48, 53, 65, 42, 53, 118, 45, 40, 143, 40, 68, 136, 52, 43, 49, 39, 63, 34, 50, 76, 257, 52, 43, 53, 49, 39, 45, 142, 263, 39, 100, 78, 176, 49, 48, 112, 50, 61, 51, 33, 47, 41, 38, 42, 64, 71, 47, 83]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.25922969161503756, "mean_inference_ms": 0.7224954869080428, "mean_action_processing_ms": 0.07588050686158616, "mean_env_wait_ms": 6.380937396398196, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0069811344146728516, "StateBufferConnector_ms": 0.003913164138793945, "ViewRequirementAgentConnector_ms": 0.08918237686157227}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 76000, "num_agent_steps_trained": 76000, "num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 528.4524197514369, "num_env_steps_trained_throughput_per_sec": 528.4524197514369, "timesteps_total": 76000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 76000, "timers": {"training_iteration_time_ms": 7465.187, "sample_time_ms": 3929.432, "load_time_ms": 0.941, "load_throughput": 4252133.009, "learn_time_ms": 3530.067, "learn_throughput": 1133.123, "synch_weights_time_ms": 4.094}, "counters": {"num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_agent_steps_sampled": 76000, "num_agent_steps_trained": 76000}, "done": false, "episodes_total": 541, "training_iteration": 19, "trial_id": "04cbf_00000", "date": "2024-03-07_13-20-24", "timestamp": 1709835624, "time_this_iter_s": 7.571875095367432, "time_total_s": 141.27400946617126, "pid": 119109, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7efea6399f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 141.27400946617126, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 29.660000000000004, "ram_util_percent": 50.92999999999999, "gpu_util_percent0": 0.08299999999999999, "vram_util_percent0": 0.09165852864583335}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.10000000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 2.8969724900326415, "policy_loss": -0.0026174214578443956, "vf_loss": 2.8990446526677376, "vf_explained_var": 0.4376624885425773, "kl": 0.005452654271988804, "entropy": 0.8868451146669285, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 18135.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000}, "sampler_results": {"episode_reward_max": -2.1000000000000014, "episode_reward_min": -68.90000000000047, "episode_reward_mean": -7.088000000000005, "episode_len_mean": 72.77, "episode_media": {}, "episodes_this_iter": 55, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.1000000000000014, -4.1999999999999975, -10.899999999999974, -3.4000000000000004, -2.900000000000002, -13.199999999999966, -2.900000000000002, -5.699999999999992, -12.799999999999969, -4.099999999999998, -3.200000000000001, -3.799999999999999, -2.800000000000002, -5.999999999999998, -2.3000000000000016, -3.8999999999999986, -6.799999999999991, -24.80000000000009, -4.099999999999998, -3.200000000000001, -4.1999999999999975, -4.099999999999998, -2.800000000000002, -3.9000000000000012, -13.099999999999966, -28.800000000000075, -2.800000000000002, -8.89999999999998, -10.199999999999994, -21.299999999999944, -3.799999999999999, -3.6999999999999993, -11.899999999999972, -3.8999999999999986, -5.299999999999996, -3.9999999999999982, -2.2000000000000015, -4.100000000000001, -3.0000000000000018, -2.700000000000002, -3.5, -5.699999999999996, -6.19999999999999, -3.5999999999999996, -8.999999999999993, -5.399999999999993, -68.90000000000047, -4.099999999999998, -4.4999999999999964, -4.799999999999995, -3.200000000000001, -6.999999999999989, -9.79999999999998, -9.399999999999979, -5.499999999999993, -5.699999999999992, -3.5999999999999996, -6.499999999999989, -3.5999999999999996, -6.699999999999994, -3.5999999999999996, -3.6999999999999993, -2.800000000000002, -3.3000000000000007, -3.8999999999999986, -9.499999999999979, -3.1000000000000014, -3.8999999999999986, -5.699999999999993, -2.700000000000002, -2.5000000000000018, -5.999999999999991, -3.7, -4.1999999999999975, -4.399999999999997, -4.699999999999996, -2.4000000000000017, -6.1, -2.600000000000002, -2.2000000000000015, -3.799999999999999, -4.999999999999995, -4.999999999999997, -16.399999999999974, -3.0000000000000018, -4.699999999999996, -5.099999999999994, -5.399999999999993, -3.3999999999999995, -4.799999999999995, -5.699999999999996, -3.1000000000000014, -62.400000000000375, -29.499999999999975, -4.099999999999998, -6.19999999999999, -3.0000000000000018, -4.1999999999999975, -5.399999999999993, -2.1000000000000014], "episode_lengths": [42, 53, 118, 45, 40, 143, 40, 68, 136, 52, 43, 49, 39, 63, 34, 50, 76, 257, 52, 43, 53, 49, 39, 45, 142, 263, 39, 100, 78, 176, 49, 48, 112, 50, 61, 51, 33, 47, 41, 38, 42, 64, 71, 47, 83, 65, 400, 52, 56, 59, 43, 70, 105, 100, 66, 68, 47, 76, 47, 72, 47, 48, 39, 44, 50, 100, 42, 50, 67, 38, 36, 71, 47, 53, 55, 58, 35, 53, 37, 33, 49, 61, 58, 172, 41, 58, 62, 65, 38, 59, 64, 42, 400, 199, 52, 73, 41, 53, 65, 32]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2622742997531216, "mean_inference_ms": 0.7222321244524976, "mean_action_processing_ms": 0.07598193042426842, "mean_env_wait_ms": 6.392508040855269, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006814479827880859, "StateBufferConnector_ms": 0.0038597583770751953, "ViewRequirementAgentConnector_ms": 0.08889651298522949}}, "episode_reward_max": -2.1000000000000014, "episode_reward_min": -68.90000000000047, "episode_reward_mean": -7.088000000000005, "episode_len_mean": 72.77, "episodes_this_iter": 55, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3.1000000000000014, -4.1999999999999975, -10.899999999999974, -3.4000000000000004, -2.900000000000002, -13.199999999999966, -2.900000000000002, -5.699999999999992, -12.799999999999969, -4.099999999999998, -3.200000000000001, -3.799999999999999, -2.800000000000002, -5.999999999999998, -2.3000000000000016, -3.8999999999999986, -6.799999999999991, -24.80000000000009, -4.099999999999998, -3.200000000000001, -4.1999999999999975, -4.099999999999998, -2.800000000000002, -3.9000000000000012, -13.099999999999966, -28.800000000000075, -2.800000000000002, -8.89999999999998, -10.199999999999994, -21.299999999999944, -3.799999999999999, -3.6999999999999993, -11.899999999999972, -3.8999999999999986, -5.299999999999996, -3.9999999999999982, -2.2000000000000015, -4.100000000000001, -3.0000000000000018, -2.700000000000002, -3.5, -5.699999999999996, -6.19999999999999, -3.5999999999999996, -8.999999999999993, -5.399999999999993, -68.90000000000047, -4.099999999999998, -4.4999999999999964, -4.799999999999995, -3.200000000000001, -6.999999999999989, -9.79999999999998, -9.399999999999979, -5.499999999999993, -5.699999999999992, -3.5999999999999996, -6.499999999999989, -3.5999999999999996, -6.699999999999994, -3.5999999999999996, -3.6999999999999993, -2.800000000000002, -3.3000000000000007, -3.8999999999999986, -9.499999999999979, -3.1000000000000014, -3.8999999999999986, -5.699999999999993, -2.700000000000002, -2.5000000000000018, -5.999999999999991, -3.7, -4.1999999999999975, -4.399999999999997, -4.699999999999996, -2.4000000000000017, -6.1, -2.600000000000002, -2.2000000000000015, -3.799999999999999, -4.999999999999995, -4.999999999999997, -16.399999999999974, -3.0000000000000018, -4.699999999999996, -5.099999999999994, -5.399999999999993, -3.3999999999999995, -4.799999999999995, -5.699999999999996, -3.1000000000000014, -62.400000000000375, -29.499999999999975, -4.099999999999998, -6.19999999999999, -3.0000000000000018, -4.1999999999999975, -5.399999999999993, -2.1000000000000014], "episode_lengths": [42, 53, 118, 45, 40, 143, 40, 68, 136, 52, 43, 49, 39, 63, 34, 50, 76, 257, 52, 43, 53, 49, 39, 45, 142, 263, 39, 100, 78, 176, 49, 48, 112, 50, 61, 51, 33, 47, 41, 38, 42, 64, 71, 47, 83, 65, 400, 52, 56, 59, 43, 70, 105, 100, 66, 68, 47, 76, 47, 72, 47, 48, 39, 44, 50, 100, 42, 50, 67, 38, 36, 71, 47, 53, 55, 58, 35, 53, 37, 33, 49, 61, 58, 172, 41, 58, 62, 65, 38, 59, 64, 42, 400, 199, 52, 73, 41, 53, 65, 32]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2622742997531216, "mean_inference_ms": 0.7222321244524976, "mean_action_processing_ms": 0.07598193042426842, "mean_env_wait_ms": 6.392508040855269, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006814479827880859, "StateBufferConnector_ms": 0.0038597583770751953, "ViewRequirementAgentConnector_ms": 0.08889651298522949}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000, "num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 518.550257604304, "num_env_steps_trained_throughput_per_sec": 518.550257604304, "timesteps_total": 80000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 80000, "timers": {"training_iteration_time_ms": 7509.982, "sample_time_ms": 3976.466, "load_time_ms": 0.959, "load_throughput": 4170013.67, "learn_time_ms": 3529.136, "learn_throughput": 1133.422, "synch_weights_time_ms": 2.795}, "counters": {"num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000}, "done": false, "episodes_total": 596, "training_iteration": 20, "trial_id": "04cbf_00000", "date": "2024-03-07_13-20-31", "timestamp": 1709835631, "time_this_iter_s": 7.716486692428589, "time_total_s": 148.99049615859985, "pid": 119109, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7efea6399f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 148.99049615859985, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 30.670000000000005, "ram_util_percent": 50.980000000000004, "gpu_util_percent0": 0.086, "vram_util_percent0": 0.09165852864583333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.10000000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 3.1959614094236604, "policy_loss": -0.009435796933949634, "vf_loss": 3.2045481822984194, "vf_explained_var": 0.3744592969776482, "kl": 0.008490259658401974, "entropy": 0.8579857055858899, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 19065.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 84000}, "sampler_results": {"episode_reward_max": -1.9000000000000012, "episode_reward_min": -62.400000000000375, "episode_reward_mean": -5.8520000000000065, "episode_len_mean": 62.63, "episode_media": {}, "episodes_this_iter": 57, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-6.499999999999989, -3.5999999999999996, -6.699999999999994, -3.5999999999999996, -3.6999999999999993, -2.800000000000002, -3.3000000000000007, -3.8999999999999986, -9.499999999999979, -3.1000000000000014, -3.8999999999999986, -5.699999999999993, -2.700000000000002, -2.5000000000000018, -5.999999999999991, -3.7, -4.1999999999999975, -4.399999999999997, -4.699999999999996, -2.4000000000000017, -6.1, -2.600000000000002, -2.2000000000000015, -3.799999999999999, -4.999999999999995, -4.999999999999997, -16.399999999999974, -3.0000000000000018, -4.699999999999996, -5.099999999999994, -5.399999999999993, -3.3999999999999995, -4.799999999999995, -5.699999999999996, -3.1000000000000014, -62.400000000000375, -29.499999999999975, -4.099999999999998, -6.19999999999999, -3.0000000000000018, -4.1999999999999975, -5.399999999999993, -2.1000000000000014, -3.200000000000001, -5.5999999999999925, -53.400000000000254, -3.0000000000000018, -3.6999999999999993, -4.400000000000001, -2.5000000000000018, -3.6999999999999993, -3.5999999999999996, -1.9000000000000012, -5.199999999999999, -2.4000000000000017, -2.800000000000002, -4.699999999999996, -6.699999999999989, -3.0000000000000018, -4.799999999999995, -3.1000000000000014, -5.299999999999994, -3.5, -5.7, -3.0000000000000018, -3.8999999999999986, -3.8999999999999986, -5.199999999999994, -3.200000000000001, -3.4000000000000004, -3.6999999999999993, -2.900000000000002, -2.2000000000000015, -6.699999999999994, -2.800000000000002, -3.200000000000001, -3.3000000000000007, -4.099999999999998, -7.6, -4.899999999999998, -7.300000000000001, -4.699999999999996, -4.4999999999999964, -6.799999999999995, -3.5, -22.90000000000005, -2.3000000000000016, -6.899999999999992, -2.5000000000000018, -4.699999999999996, -10.899999999999975, -2.700000000000002, -3.799999999999999, -2.4000000000000017, -2.1000000000000014, -3.200000000000001, -3.200000000000001, -4.199999999999999, -5.099999999999999, -5.2], "episode_lengths": [76, 47, 72, 47, 48, 39, 44, 50, 100, 42, 50, 67, 38, 36, 71, 47, 53, 55, 58, 35, 53, 37, 33, 49, 61, 58, 172, 41, 58, 62, 65, 38, 59, 64, 42, 400, 199, 52, 73, 41, 53, 65, 32, 43, 67, 379, 41, 48, 49, 36, 48, 47, 30, 53, 35, 39, 58, 78, 41, 59, 42, 64, 46, 59, 41, 50, 47, 63, 43, 45, 48, 40, 33, 72, 39, 43, 44, 52, 70, 57, 68, 58, 56, 71, 46, 226, 34, 75, 36, 58, 104, 38, 49, 35, 32, 43, 43, 48, 56, 56]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2650890577687789, "mean_inference_ms": 0.7221401792252352, "mean_action_processing_ms": 0.07597111906087631, "mean_env_wait_ms": 6.409918670109907, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0067596435546875, "StateBufferConnector_ms": 0.003813028335571289, "ViewRequirementAgentConnector_ms": 0.08858871459960938}}, "episode_reward_max": -1.9000000000000012, "episode_reward_min": -62.400000000000375, "episode_reward_mean": -5.8520000000000065, "episode_len_mean": 62.63, "episodes_this_iter": 57, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-6.499999999999989, -3.5999999999999996, -6.699999999999994, -3.5999999999999996, -3.6999999999999993, -2.800000000000002, -3.3000000000000007, -3.8999999999999986, -9.499999999999979, -3.1000000000000014, -3.8999999999999986, -5.699999999999993, -2.700000000000002, -2.5000000000000018, -5.999999999999991, -3.7, -4.1999999999999975, -4.399999999999997, -4.699999999999996, -2.4000000000000017, -6.1, -2.600000000000002, -2.2000000000000015, -3.799999999999999, -4.999999999999995, -4.999999999999997, -16.399999999999974, -3.0000000000000018, -4.699999999999996, -5.099999999999994, -5.399999999999993, -3.3999999999999995, -4.799999999999995, -5.699999999999996, -3.1000000000000014, -62.400000000000375, -29.499999999999975, -4.099999999999998, -6.19999999999999, -3.0000000000000018, -4.1999999999999975, -5.399999999999993, -2.1000000000000014, -3.200000000000001, -5.5999999999999925, -53.400000000000254, -3.0000000000000018, -3.6999999999999993, -4.400000000000001, -2.5000000000000018, -3.6999999999999993, -3.5999999999999996, -1.9000000000000012, -5.199999999999999, -2.4000000000000017, -2.800000000000002, -4.699999999999996, -6.699999999999989, -3.0000000000000018, -4.799999999999995, -3.1000000000000014, -5.299999999999994, -3.5, -5.7, -3.0000000000000018, -3.8999999999999986, -3.8999999999999986, -5.199999999999994, -3.200000000000001, -3.4000000000000004, -3.6999999999999993, -2.900000000000002, -2.2000000000000015, -6.699999999999994, -2.800000000000002, -3.200000000000001, -3.3000000000000007, -4.099999999999998, -7.6, -4.899999999999998, -7.300000000000001, -4.699999999999996, -4.4999999999999964, -6.799999999999995, -3.5, -22.90000000000005, -2.3000000000000016, -6.899999999999992, -2.5000000000000018, -4.699999999999996, -10.899999999999975, -2.700000000000002, -3.799999999999999, -2.4000000000000017, -2.1000000000000014, -3.200000000000001, -3.200000000000001, -4.199999999999999, -5.099999999999999, -5.2], "episode_lengths": [76, 47, 72, 47, 48, 39, 44, 50, 100, 42, 50, 67, 38, 36, 71, 47, 53, 55, 58, 35, 53, 37, 33, 49, 61, 58, 172, 41, 58, 62, 65, 38, 59, 64, 42, 400, 199, 52, 73, 41, 53, 65, 32, 43, 67, 379, 41, 48, 49, 36, 48, 47, 30, 53, 35, 39, 58, 78, 41, 59, 42, 64, 46, 59, 41, 50, 47, 63, 43, 45, 48, 40, 33, 72, 39, 43, 44, 52, 70, 57, 68, 58, 56, 71, 46, 226, 34, 75, 36, 58, 104, 38, 49, 35, 32, 43, 43, 48, 56, 56]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2650890577687789, "mean_inference_ms": 0.7221401792252352, "mean_action_processing_ms": 0.07597111906087631, "mean_env_wait_ms": 6.409918670109907, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0067596435546875, "StateBufferConnector_ms": 0.003813028335571289, "ViewRequirementAgentConnector_ms": 0.08858871459960938}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 84000, "num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 527.3137758816755, "num_env_steps_trained_throughput_per_sec": 527.3137758816755, "timesteps_total": 84000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 84000, "timers": {"training_iteration_time_ms": 7521.767, "sample_time_ms": 3989.528, "load_time_ms": 0.968, "load_throughput": 4132929.99, "learn_time_ms": 3527.799, "learn_throughput": 1133.851, "synch_weights_time_ms": 2.842}, "counters": {"num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 84000}, "done": false, "episodes_total": 653, "training_iteration": 21, "trial_id": "04cbf_00000", "date": "2024-03-07_13-20-39", "timestamp": 1709835639, "time_this_iter_s": 7.5883400440216064, "time_total_s": 156.57883620262146, "pid": 119109, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7efea6399f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 156.57883620262146, "iterations_since_restore": 21, "perf": {"cpu_util_percent": 29.860000000000007, "ram_util_percent": 50.98, "gpu_util_percent0": 0.092, "vram_util_percent0": 0.09165852864583332}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.10000000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 3.03319024846849, "policy_loss": -0.011037211386506917, "vf_loss": 3.0431363767673894, "vf_explained_var": 0.4096542500680493, "kl": 0.010910840674388123, "entropy": 0.8390479278820817, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 19995.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_agent_steps_sampled": 88000, "num_agent_steps_trained": 88000}, "sampler_results": {"episode_reward_max": -2.0000000000000013, "episode_reward_min": -71.10000000000046, "episode_reward_mean": -6.275000000000013, "episode_len_mean": 63.53, "episode_media": {}, "episodes_this_iter": 59, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4.799999999999995, -3.1000000000000014, -5.299999999999994, -3.5, -5.7, -3.0000000000000018, -3.8999999999999986, -3.8999999999999986, -5.199999999999994, -3.200000000000001, -3.4000000000000004, -3.6999999999999993, -2.900000000000002, -2.2000000000000015, -6.699999999999994, -2.800000000000002, -3.200000000000001, -3.3000000000000007, -4.099999999999998, -7.6, -4.899999999999998, -7.300000000000001, -4.699999999999996, -4.4999999999999964, -6.799999999999995, -3.5, -22.90000000000005, -2.3000000000000016, -6.899999999999992, -2.5000000000000018, -4.699999999999996, -10.899999999999975, -2.700000000000002, -3.799999999999999, -2.4000000000000017, -2.1000000000000014, -3.200000000000001, -3.200000000000001, -4.199999999999999, -5.099999999999999, -5.2, -4.899999999999997, -2.600000000000002, -2.600000000000002, -28.599999999999998, -3.799999999999999, -2.1000000000000014, -2.0000000000000013, -6.300000000000001, -5.800000000000003, -2.700000000000002, -5.3, -4.799999999999995, -4.299999999999998, -3.5, -4.1999999999999975, -2.800000000000002, -3.0000000000000018, -3.4000000000000004, -6.099999999999998, -2.3000000000000016, -2.800000000000002, -2.5000000000000018, -2.800000000000002, -5.499999999999993, -3.8999999999999986, -9.599999999999985, -2.900000000000002, -2.4000000000000017, -2.700000000000002, -5.5999999999999925, -2.700000000000002, -2.700000000000002, -3.799999999999999, -4.4999999999999964, -5.899999999999997, -6.099999999999991, -3.5, -4.899999999999995, -6.7, -3.3000000000000007, -3.0000000000000018, -49.00000000000024, -2.1000000000000014, -71.10000000000046, -4.799999999999997, -2.800000000000002, -3.5999999999999996, -2.2000000000000015, -3.200000000000001, -4.899999999999995, -6.499999999999996, -66.30000000000045, -3.1000000000000014, -4.4999999999999964, -4.899999999999995, -6.3999999999999995, -2.700000000000002, -3.0000000000000018, -2.2000000000000015], "episode_lengths": [59, 42, 64, 46, 59, 41, 50, 47, 63, 43, 45, 48, 40, 33, 72, 39, 43, 44, 52, 70, 57, 68, 58, 56, 71, 46, 226, 34, 75, 36, 58, 104, 38, 49, 35, 32, 43, 43, 48, 56, 56, 58, 37, 37, 194, 49, 32, 31, 62, 55, 38, 57, 59, 53, 46, 53, 39, 41, 45, 64, 34, 39, 36, 39, 66, 50, 100, 40, 35, 38, 67, 38, 38, 49, 56, 64, 72, 46, 60, 65, 44, 41, 386, 32, 400, 57, 39, 44, 33, 43, 60, 69, 400, 42, 56, 60, 64, 38, 41, 33]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.26735971467673897, "mean_inference_ms": 0.722305139206124, "mean_action_processing_ms": 0.07589699809711571, "mean_env_wait_ms": 6.438365425442294, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006939888000488281, "StateBufferConnector_ms": 0.0038802623748779297, "ViewRequirementAgentConnector_ms": 0.08926558494567871}}, "episode_reward_max": -2.0000000000000013, "episode_reward_min": -71.10000000000046, "episode_reward_mean": -6.275000000000013, "episode_len_mean": 63.53, "episodes_this_iter": 59, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-4.799999999999995, -3.1000000000000014, -5.299999999999994, -3.5, -5.7, -3.0000000000000018, -3.8999999999999986, -3.8999999999999986, -5.199999999999994, -3.200000000000001, -3.4000000000000004, -3.6999999999999993, -2.900000000000002, -2.2000000000000015, -6.699999999999994, -2.800000000000002, -3.200000000000001, -3.3000000000000007, -4.099999999999998, -7.6, -4.899999999999998, -7.300000000000001, -4.699999999999996, -4.4999999999999964, -6.799999999999995, -3.5, -22.90000000000005, -2.3000000000000016, -6.899999999999992, -2.5000000000000018, -4.699999999999996, -10.899999999999975, -2.700000000000002, -3.799999999999999, -2.4000000000000017, -2.1000000000000014, -3.200000000000001, -3.200000000000001, -4.199999999999999, -5.099999999999999, -5.2, -4.899999999999997, -2.600000000000002, -2.600000000000002, -28.599999999999998, -3.799999999999999, -2.1000000000000014, -2.0000000000000013, -6.300000000000001, -5.800000000000003, -2.700000000000002, -5.3, -4.799999999999995, -4.299999999999998, -3.5, -4.1999999999999975, -2.800000000000002, -3.0000000000000018, -3.4000000000000004, -6.099999999999998, -2.3000000000000016, -2.800000000000002, -2.5000000000000018, -2.800000000000002, -5.499999999999993, -3.8999999999999986, -9.599999999999985, -2.900000000000002, -2.4000000000000017, -2.700000000000002, -5.5999999999999925, -2.700000000000002, -2.700000000000002, -3.799999999999999, -4.4999999999999964, -5.899999999999997, -6.099999999999991, -3.5, -4.899999999999995, -6.7, -3.3000000000000007, -3.0000000000000018, -49.00000000000024, -2.1000000000000014, -71.10000000000046, -4.799999999999997, -2.800000000000002, -3.5999999999999996, -2.2000000000000015, -3.200000000000001, -4.899999999999995, -6.499999999999996, -66.30000000000045, -3.1000000000000014, -4.4999999999999964, -4.899999999999995, -6.3999999999999995, -2.700000000000002, -3.0000000000000018, -2.2000000000000015], "episode_lengths": [59, 42, 64, 46, 59, 41, 50, 47, 63, 43, 45, 48, 40, 33, 72, 39, 43, 44, 52, 70, 57, 68, 58, 56, 71, 46, 226, 34, 75, 36, 58, 104, 38, 49, 35, 32, 43, 43, 48, 56, 56, 58, 37, 37, 194, 49, 32, 31, 62, 55, 38, 57, 59, 53, 46, 53, 39, 41, 45, 64, 34, 39, 36, 39, 66, 50, 100, 40, 35, 38, 67, 38, 38, 49, 56, 64, 72, 46, 60, 65, 44, 41, 386, 32, 400, 57, 39, 44, 33, 43, 60, 69, 400, 42, 56, 60, 64, 38, 41, 33]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.26735971467673897, "mean_inference_ms": 0.722305139206124, "mean_action_processing_ms": 0.07589699809711571, "mean_env_wait_ms": 6.438365425442294, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006939888000488281, "StateBufferConnector_ms": 0.0038802623748779297, "ViewRequirementAgentConnector_ms": 0.08926558494567871}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 88000, "num_agent_steps_trained": 88000, "num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 506.5683193407601, "num_env_steps_trained_throughput_per_sec": 506.5683193407601, "timesteps_total": 88000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 88000, "timers": {"training_iteration_time_ms": 7584.361, "sample_time_ms": 4033.959, "load_time_ms": 0.969, "load_throughput": 4126728.816, "learn_time_ms": 3545.988, "learn_throughput": 1128.035, "synch_weights_time_ms": 2.81}, "counters": {"num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_agent_steps_sampled": 88000, "num_agent_steps_trained": 88000}, "done": false, "episodes_total": 712, "training_iteration": 22, "trial_id": "04cbf_00000", "date": "2024-03-07_13-20-47", "timestamp": 1709835647, "time_this_iter_s": 7.8990159034729, "time_total_s": 164.47785210609436, "pid": 119109, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7efea6399f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 164.47785210609436, "iterations_since_restore": 22, "perf": {"cpu_util_percent": 31.420000000000005, "ram_util_percent": 51.0, "gpu_util_percent0": 0.08900000000000001, "vram_util_percent0": 0.09164225260416667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.10000000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 2.5864978671788053, "policy_loss": -0.009997525218353476, "vf_loss": 2.5955827250756243, "vf_explained_var": 0.4610826185313604, "kl": 0.009126618185991066, "entropy": 0.8352703052182351, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 20925.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_agent_steps_sampled": 92000, "num_agent_steps_trained": 92000}, "sampler_results": {"episode_reward_max": -2.1000000000000014, "episode_reward_min": -73.50000000000037, "episode_reward_mean": -7.618000000000019, "episode_len_mean": 70.0, "episode_media": {}, "episodes_this_iter": 66, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-9.599999999999985, -2.900000000000002, -2.4000000000000017, -2.700000000000002, -5.5999999999999925, -2.700000000000002, -2.700000000000002, -3.799999999999999, -4.4999999999999964, -5.899999999999997, -6.099999999999991, -3.5, -4.899999999999995, -6.7, -3.3000000000000007, -3.0000000000000018, -49.00000000000024, -2.1000000000000014, -71.10000000000046, -4.799999999999997, -2.800000000000002, -3.5999999999999996, -2.2000000000000015, -3.200000000000001, -4.899999999999995, -6.499999999999996, -66.30000000000045, -3.1000000000000014, -4.4999999999999964, -4.899999999999995, -6.3999999999999995, -2.700000000000002, -3.0000000000000018, -2.2000000000000015, -54.60000000000026, -4.799999999999995, -3.4000000000000004, -3.799999999999999, -2.600000000000002, -3.4000000000000004, -3.3000000000000007, -3.8999999999999986, -2.800000000000002, -3.9999999999999982, -2.700000000000002, -4.599999999999996, -5.699999999999992, -5.299999999999994, -3.3000000000000007, -73.50000000000037, -3.0000000000000018, -4.099999999999998, -3.5, -3.200000000000001, -4.1999999999999975, -9.09999999999998, -3.200000000000001, -2.800000000000002, -3.5, -2.800000000000002, -4.799999999999999, -5.399999999999995, -2.5000000000000018, -3.0000000000000018, -4.799999999999997, -3.0000000000000018, -2.1000000000000014, -5.099999999999997, -3.1000000000000014, -2.5000000000000018, -2.5000000000000018, -14.69999999999996, -3.6999999999999993, -70.10000000000034, -2.5000000000000018, -2.900000000000002, -4.4999999999999964, -2.800000000000002, -8.200000000000001, -4.799999999999997, -4.499999999999997, -4.899999999999995, -2.900000000000002, -2.5000000000000018, -3.200000000000001, -4.7999999999999945, -2.2000000000000015, -2.900000000000002, -3.0000000000000018, -3.0000000000000018, -4.999999999999999, -2.800000000000002, -4.099999999999998, -2.700000000000002, -3.6999999999999993, -2.700000000000002, -3.799999999999999, -3.0000000000000018, -9.19999999999998, -3.200000000000001], "episode_lengths": [100, 40, 35, 38, 67, 38, 38, 49, 56, 64, 72, 46, 60, 65, 44, 41, 386, 32, 400, 57, 39, 44, 33, 43, 60, 69, 400, 42, 56, 60, 64, 38, 41, 33, 332, 59, 45, 49, 37, 45, 44, 50, 39, 51, 38, 57, 68, 64, 44, 400, 41, 52, 46, 43, 53, 102, 43, 39, 46, 39, 53, 63, 36, 41, 57, 41, 32, 59, 42, 36, 36, 136, 48, 400, 36, 40, 56, 39, 69, 57, 55, 60, 40, 36, 43, 51, 33, 40, 41, 41, 56, 39, 52, 38, 48, 38, 49, 41, 103, 43]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2685247169550816, "mean_inference_ms": 0.7226865592191646, "mean_action_processing_ms": 0.07595457356801504, "mean_env_wait_ms": 6.470248423842639, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006775379180908203, "StateBufferConnector_ms": 0.0039033889770507812, "ViewRequirementAgentConnector_ms": 0.08942437171936035}}, "episode_reward_max": -2.1000000000000014, "episode_reward_min": -73.50000000000037, "episode_reward_mean": -7.618000000000019, "episode_len_mean": 70.0, "episodes_this_iter": 66, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-9.599999999999985, -2.900000000000002, -2.4000000000000017, -2.700000000000002, -5.5999999999999925, -2.700000000000002, -2.700000000000002, -3.799999999999999, -4.4999999999999964, -5.899999999999997, -6.099999999999991, -3.5, -4.899999999999995, -6.7, -3.3000000000000007, -3.0000000000000018, -49.00000000000024, -2.1000000000000014, -71.10000000000046, -4.799999999999997, -2.800000000000002, -3.5999999999999996, -2.2000000000000015, -3.200000000000001, -4.899999999999995, -6.499999999999996, -66.30000000000045, -3.1000000000000014, -4.4999999999999964, -4.899999999999995, -6.3999999999999995, -2.700000000000002, -3.0000000000000018, -2.2000000000000015, -54.60000000000026, -4.799999999999995, -3.4000000000000004, -3.799999999999999, -2.600000000000002, -3.4000000000000004, -3.3000000000000007, -3.8999999999999986, -2.800000000000002, -3.9999999999999982, -2.700000000000002, -4.599999999999996, -5.699999999999992, -5.299999999999994, -3.3000000000000007, -73.50000000000037, -3.0000000000000018, -4.099999999999998, -3.5, -3.200000000000001, -4.1999999999999975, -9.09999999999998, -3.200000000000001, -2.800000000000002, -3.5, -2.800000000000002, -4.799999999999999, -5.399999999999995, -2.5000000000000018, -3.0000000000000018, -4.799999999999997, -3.0000000000000018, -2.1000000000000014, -5.099999999999997, -3.1000000000000014, -2.5000000000000018, -2.5000000000000018, -14.69999999999996, -3.6999999999999993, -70.10000000000034, -2.5000000000000018, -2.900000000000002, -4.4999999999999964, -2.800000000000002, -8.200000000000001, -4.799999999999997, -4.499999999999997, -4.899999999999995, -2.900000000000002, -2.5000000000000018, -3.200000000000001, -4.7999999999999945, -2.2000000000000015, -2.900000000000002, -3.0000000000000018, -3.0000000000000018, -4.999999999999999, -2.800000000000002, -4.099999999999998, -2.700000000000002, -3.6999999999999993, -2.700000000000002, -3.799999999999999, -3.0000000000000018, -9.19999999999998, -3.200000000000001], "episode_lengths": [100, 40, 35, 38, 67, 38, 38, 49, 56, 64, 72, 46, 60, 65, 44, 41, 386, 32, 400, 57, 39, 44, 33, 43, 60, 69, 400, 42, 56, 60, 64, 38, 41, 33, 332, 59, 45, 49, 37, 45, 44, 50, 39, 51, 38, 57, 68, 64, 44, 400, 41, 52, 46, 43, 53, 102, 43, 39, 46, 39, 53, 63, 36, 41, 57, 41, 32, 59, 42, 36, 36, 136, 48, 400, 36, 40, 56, 39, 69, 57, 55, 60, 40, 36, 43, 51, 33, 40, 41, 41, 56, 39, 52, 38, 48, 38, 49, 41, 103, 43]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2685247169550816, "mean_inference_ms": 0.7226865592191646, "mean_action_processing_ms": 0.07595457356801504, "mean_env_wait_ms": 6.470248423842639, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006775379180908203, "StateBufferConnector_ms": 0.0039033889770507812, "ViewRequirementAgentConnector_ms": 0.08942437171936035}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 92000, "num_agent_steps_trained": 92000, "num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 532.0072253369293, "num_env_steps_trained_throughput_per_sec": 532.0072253369293, "timesteps_total": 92000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 92000, "timers": {"training_iteration_time_ms": 7589.901, "sample_time_ms": 4040.153, "load_time_ms": 0.972, "load_throughput": 4116603.116, "learn_time_ms": 3545.369, "learn_throughput": 1128.232, "synch_weights_time_ms": 2.767}, "counters": {"num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_agent_steps_sampled": 92000, "num_agent_steps_trained": 92000}, "done": false, "episodes_total": 778, "training_iteration": 23, "trial_id": "04cbf_00000", "date": "2024-03-07_13-20-54", "timestamp": 1709835654, "time_this_iter_s": 7.521541595458984, "time_total_s": 171.99939370155334, "pid": 119109, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7efea6399f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 171.99939370155334, "iterations_since_restore": 23, "perf": {"cpu_util_percent": 30.480000000000008, "ram_util_percent": 51.0, "gpu_util_percent0": 0.093, "vram_util_percent0": 0.091650390625}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.10000000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 1.8198570188870955, "policy_loss": -0.010559431022854261, "vf_loss": 1.8295139114943242, "vf_explained_var": 0.4759547202176945, "kl": 0.009025432646513733, "entropy": 0.7983291982963521, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 21855.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000}, "sampler_results": {"episode_reward_max": -1.700000000000001, "episode_reward_min": -70.10000000000034, "episode_reward_mean": -5.586000000000004, "episode_len_mean": 59.12, "episode_media": {}, "episodes_this_iter": 70, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2.5000000000000018, -14.69999999999996, -3.6999999999999993, -70.10000000000034, -2.5000000000000018, -2.900000000000002, -4.4999999999999964, -2.800000000000002, -8.200000000000001, -4.799999999999997, -4.499999999999997, -4.899999999999995, -2.900000000000002, -2.5000000000000018, -3.200000000000001, -4.7999999999999945, -2.2000000000000015, -2.900000000000002, -3.0000000000000018, -3.0000000000000018, -4.999999999999999, -2.800000000000002, -4.099999999999998, -2.700000000000002, -3.6999999999999993, -2.700000000000002, -3.799999999999999, -3.0000000000000018, -9.19999999999998, -3.200000000000001, -2.2000000000000015, -2.900000000000002, -2.900000000000002, -3.5, -2.4000000000000017, -2.700000000000002, -55.00000000000024, -3.5, -4.4999999999999964, -3.3000000000000007, -3.6999999999999993, -4.099999999999998, -3.1000000000000014, -20.79999999999997, -7.599999999999991, -3.0000000000000018, -5.7999999999999945, -9.099999999999985, -3.5999999999999996, -25.300000000000043, -3.5, -5.399999999999996, -2.700000000000002, -2.4000000000000017, -3.5999999999999996, -3.5999999999999996, -2.700000000000002, -4.099999999999998, -3.1000000000000014, -2.700000000000002, -4.399999999999997, -3.1000000000000014, -3.3000000000000007, -2.5000000000000018, -3.8999999999999986, -2.600000000000002, -3.0000000000000018, -2.4000000000000017, -13.299999999999965, -4.799999999999995, -4.700000000000002, -2.5000000000000018, -4.4999999999999964, -4.999999999999995, -13.399999999999983, -5.299999999999994, -3.3000000000000007, -2.800000000000002, -3.5999999999999996, -3.799999999999999, -2.600000000000002, -7.099999999999989, -3.1000000000000014, -1.700000000000001, -2.600000000000002, -3.9000000000000004, -3.5999999999999996, -3.4000000000000004, -2.800000000000002, -5.199999999999994, -6.1, -2.3000000000000016, -2.900000000000002, -4.1, -2.600000000000002, -3.5, -4.1999999999999975, -3.9999999999999982, -3.3000000000000007, -3.799999999999999], "episode_lengths": [36, 136, 48, 400, 36, 40, 56, 39, 69, 57, 55, 60, 40, 36, 43, 51, 33, 40, 41, 41, 56, 39, 52, 38, 48, 38, 49, 41, 103, 43, 33, 40, 40, 46, 35, 38, 400, 46, 56, 44, 48, 52, 42, 160, 79, 41, 66, 92, 47, 192, 46, 62, 38, 35, 47, 47, 38, 52, 42, 38, 55, 42, 44, 36, 50, 37, 41, 35, 144, 59, 50, 36, 56, 61, 93, 64, 44, 39, 47, 49, 37, 80, 42, 28, 37, 48, 47, 45, 39, 63, 62, 34, 40, 48, 37, 46, 53, 51, 38, 49]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2702592383222282, "mean_inference_ms": 0.7230299151732911, "mean_action_processing_ms": 0.07612648935534011, "mean_env_wait_ms": 6.492066599953639, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006755828857421875, "StateBufferConnector_ms": 0.003884553909301758, "ViewRequirementAgentConnector_ms": 0.08901047706604004}}, "episode_reward_max": -1.700000000000001, "episode_reward_min": -70.10000000000034, "episode_reward_mean": -5.586000000000004, "episode_len_mean": 59.12, "episodes_this_iter": 70, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-2.5000000000000018, -14.69999999999996, -3.6999999999999993, -70.10000000000034, -2.5000000000000018, -2.900000000000002, -4.4999999999999964, -2.800000000000002, -8.200000000000001, -4.799999999999997, -4.499999999999997, -4.899999999999995, -2.900000000000002, -2.5000000000000018, -3.200000000000001, -4.7999999999999945, -2.2000000000000015, -2.900000000000002, -3.0000000000000018, -3.0000000000000018, -4.999999999999999, -2.800000000000002, -4.099999999999998, -2.700000000000002, -3.6999999999999993, -2.700000000000002, -3.799999999999999, -3.0000000000000018, -9.19999999999998, -3.200000000000001, -2.2000000000000015, -2.900000000000002, -2.900000000000002, -3.5, -2.4000000000000017, -2.700000000000002, -55.00000000000024, -3.5, -4.4999999999999964, -3.3000000000000007, -3.6999999999999993, -4.099999999999998, -3.1000000000000014, -20.79999999999997, -7.599999999999991, -3.0000000000000018, -5.7999999999999945, -9.099999999999985, -3.5999999999999996, -25.300000000000043, -3.5, -5.399999999999996, -2.700000000000002, -2.4000000000000017, -3.5999999999999996, -3.5999999999999996, -2.700000000000002, -4.099999999999998, -3.1000000000000014, -2.700000000000002, -4.399999999999997, -3.1000000000000014, -3.3000000000000007, -2.5000000000000018, -3.8999999999999986, -2.600000000000002, -3.0000000000000018, -2.4000000000000017, -13.299999999999965, -4.799999999999995, -4.700000000000002, -2.5000000000000018, -4.4999999999999964, -4.999999999999995, -13.399999999999983, -5.299999999999994, -3.3000000000000007, -2.800000000000002, -3.5999999999999996, -3.799999999999999, -2.600000000000002, -7.099999999999989, -3.1000000000000014, -1.700000000000001, -2.600000000000002, -3.9000000000000004, -3.5999999999999996, -3.4000000000000004, -2.800000000000002, -5.199999999999994, -6.1, -2.3000000000000016, -2.900000000000002, -4.1, -2.600000000000002, -3.5, -4.1999999999999975, -3.9999999999999982, -3.3000000000000007, -3.799999999999999], "episode_lengths": [36, 136, 48, 400, 36, 40, 56, 39, 69, 57, 55, 60, 40, 36, 43, 51, 33, 40, 41, 41, 56, 39, 52, 38, 48, 38, 49, 41, 103, 43, 33, 40, 40, 46, 35, 38, 400, 46, 56, 44, 48, 52, 42, 160, 79, 41, 66, 92, 47, 192, 46, 62, 38, 35, 47, 47, 38, 52, 42, 38, 55, 42, 44, 36, 50, 37, 41, 35, 144, 59, 50, 36, 56, 61, 93, 64, 44, 39, 47, 49, 37, 80, 42, 28, 37, 48, 47, 45, 39, 63, 62, 34, 40, 48, 37, 46, 53, 51, 38, 49]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2702592383222282, "mean_inference_ms": 0.7230299151732911, "mean_action_processing_ms": 0.07612648935534011, "mean_env_wait_ms": 6.492066599953639, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006755828857421875, "StateBufferConnector_ms": 0.003884553909301758, "ViewRequirementAgentConnector_ms": 0.08901047706604004}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000, "num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 532.5308621578577, "num_env_steps_trained_throughput_per_sec": 532.5308621578577, "timesteps_total": 96000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 96000, "timers": {"training_iteration_time_ms": 7582.462, "sample_time_ms": 4058.385, "load_time_ms": 0.977, "load_throughput": 4096100.002, "learn_time_ms": 3519.68, "learn_throughput": 1136.467, "synch_weights_time_ms": 2.779}, "counters": {"num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000}, "done": false, "episodes_total": 848, "training_iteration": 24, "trial_id": "04cbf_00000", "date": "2024-03-07_13-21-02", "timestamp": 1709835662, "time_this_iter_s": 7.514096021652222, "time_total_s": 179.51348972320557, "pid": 119109, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7efea6399f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 179.51348972320557, "iterations_since_restore": 24, "perf": {"cpu_util_percent": 32.422222222222224, "ram_util_percent": 50.98888888888889, "gpu_util_percent0": 0.08111111111111112, "vram_util_percent0": 0.09166124131944445}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.10000000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 0.9550612959173328, "policy_loss": -0.010753253932481492, "vf_loss": 0.9648905737145294, "vf_explained_var": 0.6667736460444748, "kl": 0.00923973688700087, "entropy": 0.73961471280744, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 22785.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_agent_steps_sampled": 100000, "num_agent_steps_trained": 100000}, "sampler_results": {"episode_reward_max": -1.9000000000000012, "episode_reward_min": -32.40000000000017, "episode_reward_mean": -3.9160000000000013, "episode_len_mean": 48.39, "episode_media": {}, "episodes_this_iter": 88, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2.800000000000002, -5.199999999999994, -6.1, -2.3000000000000016, -2.900000000000002, -4.1, -2.600000000000002, -3.5, -4.1999999999999975, -3.9999999999999982, -3.3000000000000007, -3.799999999999999, -32.40000000000017, -3.200000000000001, -3.200000000000001, -10.299999999999992, -2.800000000000002, -3.1000000000000014, -3.0000000000000018, -4.1999999999999975, -2.900000000000002, -2.600000000000002, -3.799999999999999, -2.700000000000002, -3.4000000000000004, -3.3000000000000007, -7.999999999999986, -2.3000000000000016, -3.1000000000000014, -4.399999999999997, -5.0, -8.89999999999999, -2.5000000000000018, -2.600000000000002, -1.9000000000000012, -3.1000000000000014, -2.5000000000000018, -2.3000000000000016, -3.0000000000000018, -3.1000000000000014, -2.700000000000002, -1.9000000000000012, -3.799999999999999, -2.3000000000000016, -2.2000000000000015, -2.2000000000000015, -2.600000000000002, -3.1000000000000014, -2.3000000000000016, -6.39999999999999, -2.600000000000002, -1.9000000000000012, -3.1000000000000014, -3.5, -3.5, -2.5000000000000018, -2.900000000000002, -2.4000000000000017, -2.700000000000002, -4.599999999999998, -2.4000000000000017, -2.3000000000000016, -2.900000000000002, -3.4000000000000004, -3.5, -10.099999999999977, -3.1000000000000014, -4.2, -3.0000000000000018, -3.5999999999999996, -2.800000000000002, -2.900000000000002, -2.900000000000002, -2.700000000000002, -3.1000000000000014, -3.5, -2.600000000000002, -3.799999999999999, -5.699999999999996, -3.200000000000001, -4.899999999999995, -13.199999999999966, -2.600000000000002, -6.699999999999999, -2.800000000000002, -2.5000000000000018, -4.1999999999999975, -4.299999999999997, -2.900000000000002, -3.200000000000001, -3.3000000000000007, -3.200000000000001, -3.5999999999999996, -3.0000000000000018, -2.3000000000000016, -5.099999999999994, -2.900000000000002, -4.800000000000001, -2.700000000000002, -4.100000000000001], "episode_lengths": [39, 63, 62, 34, 40, 48, 37, 46, 53, 51, 38, 49, 298, 43, 43, 80, 39, 42, 41, 48, 40, 37, 49, 38, 45, 44, 90, 34, 42, 55, 55, 89, 36, 37, 30, 40, 36, 34, 41, 42, 38, 30, 49, 34, 33, 33, 37, 42, 34, 75, 37, 30, 42, 46, 46, 36, 40, 35, 38, 55, 35, 34, 40, 45, 46, 109, 42, 46, 41, 47, 39, 40, 40, 38, 42, 46, 37, 49, 64, 43, 60, 129, 37, 66, 39, 36, 46, 54, 40, 43, 44, 42, 47, 41, 34, 62, 40, 53, 38, 47]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2748038004392847, "mean_inference_ms": 0.7226351202866672, "mean_action_processing_ms": 0.0759118407001715, "mean_env_wait_ms": 6.5058313918386395, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006945133209228516, "StateBufferConnector_ms": 0.003926753997802734, "ViewRequirementAgentConnector_ms": 0.09004592895507812}}, "episode_reward_max": -1.9000000000000012, "episode_reward_min": -32.40000000000017, "episode_reward_mean": -3.9160000000000013, "episode_len_mean": 48.39, "episodes_this_iter": 88, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-2.800000000000002, -5.199999999999994, -6.1, -2.3000000000000016, -2.900000000000002, -4.1, -2.600000000000002, -3.5, -4.1999999999999975, -3.9999999999999982, -3.3000000000000007, -3.799999999999999, -32.40000000000017, -3.200000000000001, -3.200000000000001, -10.299999999999992, -2.800000000000002, -3.1000000000000014, -3.0000000000000018, -4.1999999999999975, -2.900000000000002, -2.600000000000002, -3.799999999999999, -2.700000000000002, -3.4000000000000004, -3.3000000000000007, -7.999999999999986, -2.3000000000000016, -3.1000000000000014, -4.399999999999997, -5.0, -8.89999999999999, -2.5000000000000018, -2.600000000000002, -1.9000000000000012, -3.1000000000000014, -2.5000000000000018, -2.3000000000000016, -3.0000000000000018, -3.1000000000000014, -2.700000000000002, -1.9000000000000012, -3.799999999999999, -2.3000000000000016, -2.2000000000000015, -2.2000000000000015, -2.600000000000002, -3.1000000000000014, -2.3000000000000016, -6.39999999999999, -2.600000000000002, -1.9000000000000012, -3.1000000000000014, -3.5, -3.5, -2.5000000000000018, -2.900000000000002, -2.4000000000000017, -2.700000000000002, -4.599999999999998, -2.4000000000000017, -2.3000000000000016, -2.900000000000002, -3.4000000000000004, -3.5, -10.099999999999977, -3.1000000000000014, -4.2, -3.0000000000000018, -3.5999999999999996, -2.800000000000002, -2.900000000000002, -2.900000000000002, -2.700000000000002, -3.1000000000000014, -3.5, -2.600000000000002, -3.799999999999999, -5.699999999999996, -3.200000000000001, -4.899999999999995, -13.199999999999966, -2.600000000000002, -6.699999999999999, -2.800000000000002, -2.5000000000000018, -4.1999999999999975, -4.299999999999997, -2.900000000000002, -3.200000000000001, -3.3000000000000007, -3.200000000000001, -3.5999999999999996, -3.0000000000000018, -2.3000000000000016, -5.099999999999994, -2.900000000000002, -4.800000000000001, -2.700000000000002, -4.100000000000001], "episode_lengths": [39, 63, 62, 34, 40, 48, 37, 46, 53, 51, 38, 49, 298, 43, 43, 80, 39, 42, 41, 48, 40, 37, 49, 38, 45, 44, 90, 34, 42, 55, 55, 89, 36, 37, 30, 40, 36, 34, 41, 42, 38, 30, 49, 34, 33, 33, 37, 42, 34, 75, 37, 30, 42, 46, 46, 36, 40, 35, 38, 55, 35, 34, 40, 45, 46, 109, 42, 46, 41, 47, 39, 40, 40, 38, 42, 46, 37, 49, 64, 43, 60, 129, 37, 66, 39, 36, 46, 54, 40, 43, 44, 42, 47, 41, 34, 62, 40, 53, 38, 47]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2748038004392847, "mean_inference_ms": 0.7226351202866672, "mean_action_processing_ms": 0.0759118407001715, "mean_env_wait_ms": 6.5058313918386395, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006945133209228516, "StateBufferConnector_ms": 0.003926753997802734, "ViewRequirementAgentConnector_ms": 0.09004592895507812}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 100000, "num_agent_steps_trained": 100000, "num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 504.7749160695013, "num_env_steps_trained_throughput_per_sec": 504.7749160695013, "timesteps_total": 100000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 100000, "timers": {"training_iteration_time_ms": 7642.549, "sample_time_ms": 4123.629, "load_time_ms": 0.966, "load_throughput": 4141704.355, "learn_time_ms": 3514.543, "learn_throughput": 1138.128, "synch_weights_time_ms": 2.769}, "counters": {"num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_agent_steps_sampled": 100000, "num_agent_steps_trained": 100000}, "done": false, "episodes_total": 936, "training_iteration": 25, "trial_id": "04cbf_00000", "date": "2024-03-07_13-21-10", "timestamp": 1709835670, "time_this_iter_s": 7.927180051803589, "time_total_s": 187.44066977500916, "pid": 119109, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7efea6399f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 187.44066977500916, "iterations_since_restore": 25, "perf": {"cpu_util_percent": 29.5, "ram_util_percent": 50.92727272727272, "gpu_util_percent0": 0.10181818181818181, "vram_util_percent0": 0.09165630918560605}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.10000000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 0.5593409071115637, "policy_loss": -0.0390603794465943, "vf_loss": 0.596978222590781, "vf_explained_var": 0.7418486900227044, "kl": 0.014230645337099774, "entropy": 0.6930466177002076, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 23715.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 104000, "num_env_steps_trained": 104000, "num_agent_steps_sampled": 104000, "num_agent_steps_trained": 104000}, "sampler_results": {"episode_reward_max": -1.700000000000001, "episode_reward_min": -10.899999999999983, "episode_reward_mean": -3.263000000000001, "episode_len_mean": 42.62, "episode_media": {}, "episodes_this_iter": 94, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2.3000000000000016, -5.099999999999994, -2.900000000000002, -4.800000000000001, -2.700000000000002, -4.100000000000001, -3.0000000000000018, -3.6999999999999993, -2.5000000000000018, -10.899999999999983, -3.5999999999999996, -5.099999999999996, -1.8000000000000012, -2.4000000000000017, -2.4000000000000017, -3.4000000000000004, -2.0000000000000013, -2.700000000000002, -3.0000000000000018, -2.5000000000000018, -3.200000000000001, -5.099999999999996, -3.6999999999999993, -2.800000000000002, -3.4000000000000004, -2.4000000000000017, -3.5999999999999996, -2.0000000000000013, -2.1000000000000014, -2.3000000000000016, -2.700000000000002, -4.899999999999998, -3.5, -3.200000000000001, -2.1000000000000014, -2.4000000000000017, -5.100000000000001, -3.200000000000001, -2.600000000000002, -2.800000000000002, -3.5999999999999996, -2.4000000000000017, -3.200000000000001, -3.200000000000001, -3.200000000000001, -2.5000000000000018, -2.3000000000000016, -5.3, -4.899999999999995, -2.600000000000002, -2.2000000000000015, -1.700000000000001, -2.5000000000000018, -3.1000000000000014, -3.5, -2.900000000000002, -2.1000000000000014, -3.5, -3.9999999999999982, -4.9, -3.9999999999999982, -3.3000000000000007, -3.0000000000000018, -2.1000000000000014, -2.5000000000000018, -9.09999999999999, -3.0000000000000018, -3.9999999999999982, -3.5, -5.100000000000002, -3.0000000000000018, -3.3000000000000007, -2.800000000000002, -2.1000000000000014, -2.600000000000002, -3.5999999999999996, -3.1000000000000014, -2.0000000000000013, -5.000000000000003, -3.4000000000000004, -2.800000000000002, -3.6999999999999993, -2.5000000000000018, -2.3000000000000016, -3.6999999999999993, -2.1000000000000014, -2.700000000000002, -4.1999999999999975, -2.1000000000000014, -4.3999999999999995, -2.800000000000002, -2.600000000000002, -2.3000000000000016, -2.0000000000000013, -2.2000000000000015, -5.099999999999994, -2.600000000000002, -2.600000000000002, -3.1000000000000014, -2.4000000000000017], "episode_lengths": [34, 62, 40, 53, 38, 47, 41, 48, 36, 107, 47, 60, 29, 35, 35, 45, 31, 38, 41, 36, 43, 55, 47, 39, 45, 35, 47, 31, 32, 34, 38, 57, 46, 43, 32, 35, 52, 43, 37, 39, 47, 35, 43, 43, 43, 36, 34, 57, 60, 37, 33, 28, 36, 42, 46, 40, 32, 46, 51, 51, 51, 44, 41, 32, 36, 85, 41, 51, 46, 53, 41, 44, 39, 32, 37, 47, 42, 31, 52, 45, 39, 48, 36, 34, 48, 32, 38, 53, 32, 52, 39, 37, 34, 31, 33, 62, 37, 37, 42, 35]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2786926504312328, "mean_inference_ms": 0.7229789292860085, "mean_action_processing_ms": 0.07595421743855905, "mean_env_wait_ms": 6.530384645396156, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007025957107543945, "StateBufferConnector_ms": 0.0039293766021728516, "ViewRequirementAgentConnector_ms": 0.08968496322631836}}, "episode_reward_max": -1.700000000000001, "episode_reward_min": -10.899999999999983, "episode_reward_mean": -3.263000000000001, "episode_len_mean": 42.62, "episodes_this_iter": 94, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-2.3000000000000016, -5.099999999999994, -2.900000000000002, -4.800000000000001, -2.700000000000002, -4.100000000000001, -3.0000000000000018, -3.6999999999999993, -2.5000000000000018, -10.899999999999983, -3.5999999999999996, -5.099999999999996, -1.8000000000000012, -2.4000000000000017, -2.4000000000000017, -3.4000000000000004, -2.0000000000000013, -2.700000000000002, -3.0000000000000018, -2.5000000000000018, -3.200000000000001, -5.099999999999996, -3.6999999999999993, -2.800000000000002, -3.4000000000000004, -2.4000000000000017, -3.5999999999999996, -2.0000000000000013, -2.1000000000000014, -2.3000000000000016, -2.700000000000002, -4.899999999999998, -3.5, -3.200000000000001, -2.1000000000000014, -2.4000000000000017, -5.100000000000001, -3.200000000000001, -2.600000000000002, -2.800000000000002, -3.5999999999999996, -2.4000000000000017, -3.200000000000001, -3.200000000000001, -3.200000000000001, -2.5000000000000018, -2.3000000000000016, -5.3, -4.899999999999995, -2.600000000000002, -2.2000000000000015, -1.700000000000001, -2.5000000000000018, -3.1000000000000014, -3.5, -2.900000000000002, -2.1000000000000014, -3.5, -3.9999999999999982, -4.9, -3.9999999999999982, -3.3000000000000007, -3.0000000000000018, -2.1000000000000014, -2.5000000000000018, -9.09999999999999, -3.0000000000000018, -3.9999999999999982, -3.5, -5.100000000000002, -3.0000000000000018, -3.3000000000000007, -2.800000000000002, -2.1000000000000014, -2.600000000000002, -3.5999999999999996, -3.1000000000000014, -2.0000000000000013, -5.000000000000003, -3.4000000000000004, -2.800000000000002, -3.6999999999999993, -2.5000000000000018, -2.3000000000000016, -3.6999999999999993, -2.1000000000000014, -2.700000000000002, -4.1999999999999975, -2.1000000000000014, -4.3999999999999995, -2.800000000000002, -2.600000000000002, -2.3000000000000016, -2.0000000000000013, -2.2000000000000015, -5.099999999999994, -2.600000000000002, -2.600000000000002, -3.1000000000000014, -2.4000000000000017], "episode_lengths": [34, 62, 40, 53, 38, 47, 41, 48, 36, 107, 47, 60, 29, 35, 35, 45, 31, 38, 41, 36, 43, 55, 47, 39, 45, 35, 47, 31, 32, 34, 38, 57, 46, 43, 32, 35, 52, 43, 37, 39, 47, 35, 43, 43, 43, 36, 34, 57, 60, 37, 33, 28, 36, 42, 46, 40, 32, 46, 51, 51, 51, 44, 41, 32, 36, 85, 41, 51, 46, 53, 41, 44, 39, 32, 37, 47, 42, 31, 52, 45, 39, 48, 36, 34, 48, 32, 38, 53, 32, 52, 39, 37, 34, 31, 33, 62, 37, 37, 42, 35]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2786926504312328, "mean_inference_ms": 0.7229789292860085, "mean_action_processing_ms": 0.07595421743855905, "mean_env_wait_ms": 6.530384645396156, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007025957107543945, "StateBufferConnector_ms": 0.0039293766021728516, "ViewRequirementAgentConnector_ms": 0.08968496322631836}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 104000, "num_agent_steps_trained": 104000, "num_env_steps_sampled": 104000, "num_env_steps_trained": 104000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 509.83599762288264, "num_env_steps_trained_throughput_per_sec": 509.83599762288264, "timesteps_total": 104000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 104000, "timers": {"training_iteration_time_ms": 7665.807, "sample_time_ms": 4144.925, "load_time_ms": 0.959, "load_throughput": 4171672.676, "learn_time_ms": 3516.462, "learn_throughput": 1137.507, "synch_weights_time_ms": 2.817}, "counters": {"num_env_steps_sampled": 104000, "num_env_steps_trained": 104000, "num_agent_steps_sampled": 104000, "num_agent_steps_trained": 104000}, "done": false, "episodes_total": 1030, "training_iteration": 26, "trial_id": "04cbf_00000", "date": "2024-03-07_13-21-18", "timestamp": 1709835678, "time_this_iter_s": 7.848340034484863, "time_total_s": 195.28900980949402, "pid": 119109, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7efea6399f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 195.28900980949402, "iterations_since_restore": 26, "perf": {"cpu_util_percent": 30.649999999999995, "ram_util_percent": 50.92999999999999, "gpu_util_percent0": 0.092, "vram_util_percent0": 0.091650390625}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.10000000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 0.9307977049523258, "policy_loss": 0.0031827859941028777, "vf_loss": 0.9268628019278728, "vf_explained_var": 0.7444155451431069, "kl": 0.007521244488720438, "entropy": 0.662937892060126, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 24645.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_agent_steps_sampled": 108000, "num_agent_steps_trained": 108000}, "sampler_results": {"episode_reward_max": -2.0000000000000013, "episode_reward_min": -9.399999999999997, "episode_reward_mean": -3.089000000000001, "episode_len_mean": 40.92, "episode_media": {}, "episodes_this_iter": 93, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2.0000000000000013, -2.2000000000000015, -5.099999999999994, -2.600000000000002, -2.600000000000002, -3.1000000000000014, -2.4000000000000017, -2.600000000000002, -2.900000000000002, -2.900000000000002, -3.9999999999999982, -3.799999999999999, -6.999999999999994, -2.5000000000000018, -3.8000000000000007, -3.3000000000000007, -2.2000000000000015, -3.9000000000000012, -2.2000000000000015, -2.900000000000002, -2.4000000000000017, -2.1000000000000014, -2.600000000000002, -3.3000000000000007, -3.0000000000000018, -3.0000000000000018, -2.2000000000000015, -2.4000000000000017, -2.4000000000000017, -2.700000000000002, -2.900000000000002, -3.0000000000000018, -2.3000000000000016, -4.600000000000002, -2.4000000000000017, -2.4000000000000017, -3.5999999999999996, -2.700000000000002, -2.800000000000002, -2.5000000000000018, -2.800000000000002, -2.4000000000000017, -3.3000000000000007, -2.600000000000002, -3.4000000000000004, -2.3000000000000016, -2.2000000000000015, -2.2000000000000015, -2.3000000000000016, -2.700000000000002, -2.900000000000002, -4.200000000000002, -4.200000000000003, -3.3000000000000007, -2.5000000000000018, -2.3000000000000016, -3.200000000000001, -2.700000000000002, -2.700000000000002, -7.899999999999984, -3.799999999999999, -2.5000000000000018, -3.0000000000000018, -2.3000000000000016, -2.600000000000002, -2.700000000000002, -3.1000000000000014, -2.4000000000000017, -2.5000000000000018, -2.600000000000002, -2.3000000000000016, -2.600000000000002, -8.199999999999998, -3.0000000000000018, -3.1000000000000014, -2.4000000000000017, -2.1000000000000014, -4.299999999999997, -3.6999999999999993, -3.1000000000000014, -3.3000000000000007, -2.600000000000002, -2.800000000000002, -2.5000000000000018, -3.5000000000000018, -2.700000000000002, -2.700000000000002, -2.700000000000002, -2.600000000000002, -2.3000000000000016, -3.0000000000000018, -3.0000000000000018, -2.900000000000002, -9.399999999999997, -3.200000000000001, -4.6, -4.199999999999999, -2.900000000000002, -2.1000000000000014, -2.2000000000000015], "episode_lengths": [31, 33, 62, 37, 37, 42, 35, 37, 40, 40, 51, 49, 74, 36, 47, 43, 33, 47, 33, 40, 35, 32, 37, 44, 41, 41, 33, 35, 35, 38, 40, 41, 34, 50, 35, 35, 47, 38, 39, 36, 39, 35, 44, 37, 45, 34, 33, 33, 34, 38, 40, 44, 47, 44, 36, 34, 43, 38, 37, 90, 49, 36, 41, 34, 37, 38, 42, 35, 36, 37, 34, 37, 72, 41, 42, 35, 32, 54, 48, 42, 44, 37, 39, 36, 43, 38, 38, 38, 37, 34, 41, 41, 40, 78, 43, 52, 48, 40, 32, 33]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.28198813639191533, "mean_inference_ms": 0.7228764263289, "mean_action_processing_ms": 0.07593240992905131, "mean_env_wait_ms": 6.548508679939268, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006759166717529297, "StateBufferConnector_ms": 0.003888368606567383, "ViewRequirementAgentConnector_ms": 0.08909058570861816}}, "episode_reward_max": -2.0000000000000013, "episode_reward_min": -9.399999999999997, "episode_reward_mean": -3.089000000000001, "episode_len_mean": 40.92, "episodes_this_iter": 93, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-2.0000000000000013, -2.2000000000000015, -5.099999999999994, -2.600000000000002, -2.600000000000002, -3.1000000000000014, -2.4000000000000017, -2.600000000000002, -2.900000000000002, -2.900000000000002, -3.9999999999999982, -3.799999999999999, -6.999999999999994, -2.5000000000000018, -3.8000000000000007, -3.3000000000000007, -2.2000000000000015, -3.9000000000000012, -2.2000000000000015, -2.900000000000002, -2.4000000000000017, -2.1000000000000014, -2.600000000000002, -3.3000000000000007, -3.0000000000000018, -3.0000000000000018, -2.2000000000000015, -2.4000000000000017, -2.4000000000000017, -2.700000000000002, -2.900000000000002, -3.0000000000000018, -2.3000000000000016, -4.600000000000002, -2.4000000000000017, -2.4000000000000017, -3.5999999999999996, -2.700000000000002, -2.800000000000002, -2.5000000000000018, -2.800000000000002, -2.4000000000000017, -3.3000000000000007, -2.600000000000002, -3.4000000000000004, -2.3000000000000016, -2.2000000000000015, -2.2000000000000015, -2.3000000000000016, -2.700000000000002, -2.900000000000002, -4.200000000000002, -4.200000000000003, -3.3000000000000007, -2.5000000000000018, -2.3000000000000016, -3.200000000000001, -2.700000000000002, -2.700000000000002, -7.899999999999984, -3.799999999999999, -2.5000000000000018, -3.0000000000000018, -2.3000000000000016, -2.600000000000002, -2.700000000000002, -3.1000000000000014, -2.4000000000000017, -2.5000000000000018, -2.600000000000002, -2.3000000000000016, -2.600000000000002, -8.199999999999998, -3.0000000000000018, -3.1000000000000014, -2.4000000000000017, -2.1000000000000014, -4.299999999999997, -3.6999999999999993, -3.1000000000000014, -3.3000000000000007, -2.600000000000002, -2.800000000000002, -2.5000000000000018, -3.5000000000000018, -2.700000000000002, -2.700000000000002, -2.700000000000002, -2.600000000000002, -2.3000000000000016, -3.0000000000000018, -3.0000000000000018, -2.900000000000002, -9.399999999999997, -3.200000000000001, -4.6, -4.199999999999999, -2.900000000000002, -2.1000000000000014, -2.2000000000000015], "episode_lengths": [31, 33, 62, 37, 37, 42, 35, 37, 40, 40, 51, 49, 74, 36, 47, 43, 33, 47, 33, 40, 35, 32, 37, 44, 41, 41, 33, 35, 35, 38, 40, 41, 34, 50, 35, 35, 47, 38, 39, 36, 39, 35, 44, 37, 45, 34, 33, 33, 34, 38, 40, 44, 47, 44, 36, 34, 43, 38, 37, 90, 49, 36, 41, 34, 37, 38, 42, 35, 36, 37, 34, 37, 72, 41, 42, 35, 32, 54, 48, 42, 44, 37, 39, 36, 43, 38, 38, 38, 37, 34, 41, 41, 40, 78, 43, 52, 48, 40, 32, 33]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.28198813639191533, "mean_inference_ms": 0.7228764263289, "mean_action_processing_ms": 0.07593240992905131, "mean_env_wait_ms": 6.548508679939268, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006759166717529297, "StateBufferConnector_ms": 0.003888368606567383, "ViewRequirementAgentConnector_ms": 0.08909058570861816}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 108000, "num_agent_steps_trained": 108000, "num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 518.6762151079034, "num_env_steps_trained_throughput_per_sec": 518.6762151079034, "timesteps_total": 108000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 108000, "timers": {"training_iteration_time_ms": 7667.037, "sample_time_ms": 4144.129, "load_time_ms": 0.952, "load_throughput": 4199553.442, "learn_time_ms": 3518.476, "learn_throughput": 1136.856, "synch_weights_time_ms": 2.842}, "counters": {"num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_agent_steps_sampled": 108000, "num_agent_steps_trained": 108000}, "done": false, "episodes_total": 1123, "training_iteration": 27, "trial_id": "04cbf_00000", "date": "2024-03-07_13-21-26", "timestamp": 1709835686, "time_this_iter_s": 7.714832782745361, "time_total_s": 203.00384259223938, "pid": 119109, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7efea6399f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 203.00384259223938, "iterations_since_restore": 27, "perf": {"cpu_util_percent": 30.650000000000006, "ram_util_percent": 50.92999999999999, "gpu_util_percent0": 0.082, "vram_util_percent0": 0.09164225260416667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.10000000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 0.6293140188202522, "policy_loss": -0.008432329201730348, "vf_loss": 0.6367188000310493, "vf_explained_var": 0.7598159893866508, "kl": 0.01027552528008536, "entropy": 0.6205584573489363, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 25575.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_agent_steps_sampled": 112000, "num_agent_steps_trained": 112000}, "sampler_results": {"episode_reward_max": -1.600000000000001, "episode_reward_min": -34.20000000000001, "episode_reward_mean": -3.326000000000001, "episode_len_mean": 42.17, "episode_media": {}, "episodes_this_iter": 99, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2.2000000000000015, -2.5000000000000018, -2.900000000000002, -3.200000000000001, -3.8999999999999986, -3.3000000000000007, -3.3000000000000007, -2.4000000000000017, -2.900000000000002, -3.3000000000000007, -1.9000000000000012, -2.900000000000002, -2.900000000000002, -2.800000000000002, -2.5000000000000018, -2.1000000000000014, -2.1000000000000014, -2.5000000000000018, -5.4, -2.3000000000000016, -2.4000000000000017, -3.1000000000000014, -2.5000000000000018, -2.5000000000000018, -1.700000000000001, -3.5, -2.3000000000000016, -2.2000000000000015, -2.1000000000000014, -2.3000000000000016, -3.6999999999999993, -5.7, -2.2000000000000015, -2.2000000000000015, -4.2, -2.2000000000000015, -2.900000000000002, -3.1000000000000014, -3.700000000000001, -3.200000000000001, -3.6999999999999993, -2.2000000000000015, -4.699999999999996, -3.5999999999999996, -3.200000000000001, -2.700000000000002, -2.1000000000000014, -1.9000000000000012, -3.3000000000000007, -2.3000000000000016, -2.900000000000002, -2.700000000000002, -3.8000000000000007, -2.0000000000000013, -2.3000000000000016, -2.5000000000000018, -2.0000000000000013, -1.8000000000000012, -3.1000000000000014, -3.6999999999999993, -1.600000000000001, -3.200000000000001, -2.800000000000002, -6.599999999999998, -2.3000000000000016, -2.4000000000000017, -2.5000000000000018, -2.700000000000002, -2.700000000000002, -5.199999999999994, -2.900000000000002, -2.5000000000000018, -6.499999999999991, -3.0000000000000018, -2.3000000000000016, -3.4000000000000004, -2.3000000000000016, -3.799999999999999, -1.9000000000000012, -2.1000000000000014, -2.0000000000000013, -3.200000000000001, -10.699999999999992, -2.800000000000002, -2.900000000000002, -2.2000000000000015, -3.0000000000000018, -2.1000000000000014, -34.20000000000001, -2.600000000000002, -6.699999999999989, -2.1000000000000014, -2.2000000000000015, -4.500000000000002, -3.5, -3.0000000000000018, -3.200000000000001, -3.1000000000000014, -2.2000000000000015, -2.2000000000000015], "episode_lengths": [33, 36, 40, 43, 50, 44, 44, 35, 40, 44, 30, 40, 40, 39, 36, 32, 32, 36, 55, 34, 35, 42, 36, 36, 28, 46, 34, 33, 32, 34, 48, 59, 33, 33, 45, 33, 40, 41, 43, 43, 48, 33, 58, 47, 43, 38, 32, 30, 44, 34, 40, 38, 47, 31, 34, 36, 31, 29, 42, 48, 27, 43, 39, 67, 34, 35, 36, 38, 38, 63, 40, 36, 74, 41, 34, 45, 34, 49, 30, 32, 31, 43, 80, 39, 40, 33, 41, 32, 238, 37, 78, 32, 33, 50, 46, 41, 43, 42, 33, 30]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2856090740534502, "mean_inference_ms": 0.7230502600338802, "mean_action_processing_ms": 0.07591788280228563, "mean_env_wait_ms": 6.569463618801713, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007037162780761719, "StateBufferConnector_ms": 0.0039844512939453125, "ViewRequirementAgentConnector_ms": 0.09089851379394531}}, "episode_reward_max": -1.600000000000001, "episode_reward_min": -34.20000000000001, "episode_reward_mean": -3.326000000000001, "episode_len_mean": 42.17, "episodes_this_iter": 99, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-2.2000000000000015, -2.5000000000000018, -2.900000000000002, -3.200000000000001, -3.8999999999999986, -3.3000000000000007, -3.3000000000000007, -2.4000000000000017, -2.900000000000002, -3.3000000000000007, -1.9000000000000012, -2.900000000000002, -2.900000000000002, -2.800000000000002, -2.5000000000000018, -2.1000000000000014, -2.1000000000000014, -2.5000000000000018, -5.4, -2.3000000000000016, -2.4000000000000017, -3.1000000000000014, -2.5000000000000018, -2.5000000000000018, -1.700000000000001, -3.5, -2.3000000000000016, -2.2000000000000015, -2.1000000000000014, -2.3000000000000016, -3.6999999999999993, -5.7, -2.2000000000000015, -2.2000000000000015, -4.2, -2.2000000000000015, -2.900000000000002, -3.1000000000000014, -3.700000000000001, -3.200000000000001, -3.6999999999999993, -2.2000000000000015, -4.699999999999996, -3.5999999999999996, -3.200000000000001, -2.700000000000002, -2.1000000000000014, -1.9000000000000012, -3.3000000000000007, -2.3000000000000016, -2.900000000000002, -2.700000000000002, -3.8000000000000007, -2.0000000000000013, -2.3000000000000016, -2.5000000000000018, -2.0000000000000013, -1.8000000000000012, -3.1000000000000014, -3.6999999999999993, -1.600000000000001, -3.200000000000001, -2.800000000000002, -6.599999999999998, -2.3000000000000016, -2.4000000000000017, -2.5000000000000018, -2.700000000000002, -2.700000000000002, -5.199999999999994, -2.900000000000002, -2.5000000000000018, -6.499999999999991, -3.0000000000000018, -2.3000000000000016, -3.4000000000000004, -2.3000000000000016, -3.799999999999999, -1.9000000000000012, -2.1000000000000014, -2.0000000000000013, -3.200000000000001, -10.699999999999992, -2.800000000000002, -2.900000000000002, -2.2000000000000015, -3.0000000000000018, -2.1000000000000014, -34.20000000000001, -2.600000000000002, -6.699999999999989, -2.1000000000000014, -2.2000000000000015, -4.500000000000002, -3.5, -3.0000000000000018, -3.200000000000001, -3.1000000000000014, -2.2000000000000015, -2.2000000000000015], "episode_lengths": [33, 36, 40, 43, 50, 44, 44, 35, 40, 44, 30, 40, 40, 39, 36, 32, 32, 36, 55, 34, 35, 42, 36, 36, 28, 46, 34, 33, 32, 34, 48, 59, 33, 33, 45, 33, 40, 41, 43, 43, 48, 33, 58, 47, 43, 38, 32, 30, 44, 34, 40, 38, 47, 31, 34, 36, 31, 29, 42, 48, 27, 43, 39, 67, 34, 35, 36, 38, 38, 63, 40, 36, 74, 41, 34, 45, 34, 49, 30, 32, 31, 43, 80, 39, 40, 33, 41, 32, 238, 37, 78, 32, 33, 50, 46, 41, 43, 42, 33, 30]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2856090740534502, "mean_inference_ms": 0.7230502600338802, "mean_action_processing_ms": 0.07591788280228563, "mean_env_wait_ms": 6.569463618801713, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007037162780761719, "StateBufferConnector_ms": 0.0039844512939453125, "ViewRequirementAgentConnector_ms": 0.09089851379394531}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 112000, "num_agent_steps_trained": 112000, "num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 513.8007644284296, "num_env_steps_trained_throughput_per_sec": 513.8007644284296, "timesteps_total": 112000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 112000, "timers": {"training_iteration_time_ms": 7706.166, "sample_time_ms": 4182.857, "load_time_ms": 0.962, "load_throughput": 4156274.092, "learn_time_ms": 3518.954, "learn_throughput": 1136.701, "synch_weights_time_ms": 2.752}, "counters": {"num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_agent_steps_sampled": 112000, "num_agent_steps_trained": 112000}, "done": false, "episodes_total": 1222, "training_iteration": 28, "trial_id": "04cbf_00000", "date": "2024-03-07_13-21-33", "timestamp": 1709835693, "time_this_iter_s": 7.7882890701293945, "time_total_s": 210.79213166236877, "pid": 119109, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7efea6399f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 210.79213166236877, "iterations_since_restore": 28, "perf": {"cpu_util_percent": 31.209999999999997, "ram_util_percent": 50.90999999999999, "gpu_util_percent0": 0.076, "vram_util_percent0": 0.09165852864583335}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.10000000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 0.5272920310678478, "policy_loss": -0.012036864227184686, "vf_loss": 0.5384855208718168, "vf_explained_var": 0.7547147029189654, "kl": 0.00843379169060055, "entropy": 0.6046834282657152, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 26505.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 116000, "num_env_steps_trained": 116000, "num_agent_steps_sampled": 116000, "num_agent_steps_trained": 116000}, "sampler_results": {"episode_reward_max": -1.5000000000000009, "episode_reward_min": -16.699999999999985, "episode_reward_mean": -2.966336633663367, "episode_len_mean": 40.21782178217822, "episode_media": {}, "episodes_this_iter": 101, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2.900000000000002, -3.8999999999999986, -3.0000000000000018, -1.8000000000000012, -4.500000000000003, -3.0000000000000018, -2.600000000000002, -8.499999999999982, -3.4000000000000004, -1.9000000000000012, -2.3000000000000016, -3.3000000000000007, -3.9000000000000004, -2.800000000000002, -2.700000000000002, -2.2000000000000015, -2.2000000000000015, -3.5, -3.5, -2.3000000000000016, -2.2000000000000015, -2.900000000000002, -3.0000000000000018, -3.4000000000000004, -3.400000000000002, -2.5000000000000018, -2.600000000000002, -2.2000000000000015, -3.0000000000000018, -2.0000000000000013, -3.5, -1.5000000000000009, -2.0000000000000013, -2.5000000000000018, -3.3000000000000007, -3.200000000000001, -2.900000000000002, -2.1000000000000014, -2.4000000000000017, -4.899999999999995, -2.700000000000002, -2.4000000000000017, -2.0000000000000013, -2.4000000000000017, -3.8999999999999986, -16.699999999999985, -2.600000000000002, -3.200000000000001, -2.700000000000002, -2.3000000000000016, -3.0000000000000018, -3.3000000000000007, -2.0000000000000013, -3.6999999999999993, -2.5000000000000018, -2.700000000000002, -3.5999999999999996, -2.5000000000000018, -2.4000000000000017, -2.3000000000000016, -2.1000000000000014, -5.799999999999997, -2.3000000000000016, -2.5000000000000018, -2.900000000000002, -2.600000000000002, -2.1000000000000014, -1.9000000000000012, -1.8000000000000012, -4.599999999999996, -2.2000000000000015, -3.799999999999999, -1.8000000000000012, -2.2000000000000015, -2.4000000000000017, -2.900000000000002, -2.600000000000002, -2.600000000000002, -2.4000000000000017, -2.700000000000002, -2.2000000000000015, -2.0000000000000013, -3.4000000000000004, -3.4000000000000004, -2.1000000000000014, -3.4000000000000004, -2.600000000000002, -2.5000000000000018, -3.200000000000001, -2.4000000000000017, -2.3000000000000016, -1.8000000000000012, -1.700000000000001, -2.5000000000000018, -3.3000000000000007, -2.2000000000000015, -3.200000000000001, -2.0000000000000013, -4.499999999999997, -2.5000000000000018, -3.5999999999999996], "episode_lengths": [40, 50, 41, 29, 49, 39, 37, 96, 41, 30, 34, 44, 45, 39, 38, 33, 33, 46, 46, 34, 33, 40, 41, 45, 43, 36, 37, 33, 41, 31, 46, 26, 31, 36, 44, 43, 40, 32, 35, 60, 38, 35, 31, 35, 50, 167, 37, 43, 38, 34, 41, 44, 31, 48, 36, 38, 47, 36, 35, 34, 32, 63, 34, 36, 40, 37, 32, 30, 29, 57, 33, 49, 29, 33, 35, 40, 37, 37, 35, 38, 33, 31, 45, 45, 32, 45, 37, 36, 43, 35, 34, 29, 28, 36, 44, 33, 43, 31, 52, 36, 43]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2886062718859789, "mean_inference_ms": 0.7233268982409023, "mean_action_processing_ms": 0.07588035170776655, "mean_env_wait_ms": 6.5905404589450285, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0068839233700591735, "StateBufferConnector_ms": 0.003938863773157101, "ViewRequirementAgentConnector_ms": 0.08979410228162708}}, "episode_reward_max": -1.5000000000000009, "episode_reward_min": -16.699999999999985, "episode_reward_mean": -2.966336633663367, "episode_len_mean": 40.21782178217822, "episodes_this_iter": 101, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-2.900000000000002, -3.8999999999999986, -3.0000000000000018, -1.8000000000000012, -4.500000000000003, -3.0000000000000018, -2.600000000000002, -8.499999999999982, -3.4000000000000004, -1.9000000000000012, -2.3000000000000016, -3.3000000000000007, -3.9000000000000004, -2.800000000000002, -2.700000000000002, -2.2000000000000015, -2.2000000000000015, -3.5, -3.5, -2.3000000000000016, -2.2000000000000015, -2.900000000000002, -3.0000000000000018, -3.4000000000000004, -3.400000000000002, -2.5000000000000018, -2.600000000000002, -2.2000000000000015, -3.0000000000000018, -2.0000000000000013, -3.5, -1.5000000000000009, -2.0000000000000013, -2.5000000000000018, -3.3000000000000007, -3.200000000000001, -2.900000000000002, -2.1000000000000014, -2.4000000000000017, -4.899999999999995, -2.700000000000002, -2.4000000000000017, -2.0000000000000013, -2.4000000000000017, -3.8999999999999986, -16.699999999999985, -2.600000000000002, -3.200000000000001, -2.700000000000002, -2.3000000000000016, -3.0000000000000018, -3.3000000000000007, -2.0000000000000013, -3.6999999999999993, -2.5000000000000018, -2.700000000000002, -3.5999999999999996, -2.5000000000000018, -2.4000000000000017, -2.3000000000000016, -2.1000000000000014, -5.799999999999997, -2.3000000000000016, -2.5000000000000018, -2.900000000000002, -2.600000000000002, -2.1000000000000014, -1.9000000000000012, -1.8000000000000012, -4.599999999999996, -2.2000000000000015, -3.799999999999999, -1.8000000000000012, -2.2000000000000015, -2.4000000000000017, -2.900000000000002, -2.600000000000002, -2.600000000000002, -2.4000000000000017, -2.700000000000002, -2.2000000000000015, -2.0000000000000013, -3.4000000000000004, -3.4000000000000004, -2.1000000000000014, -3.4000000000000004, -2.600000000000002, -2.5000000000000018, -3.200000000000001, -2.4000000000000017, -2.3000000000000016, -1.8000000000000012, -1.700000000000001, -2.5000000000000018, -3.3000000000000007, -2.2000000000000015, -3.200000000000001, -2.0000000000000013, -4.499999999999997, -2.5000000000000018, -3.5999999999999996], "episode_lengths": [40, 50, 41, 29, 49, 39, 37, 96, 41, 30, 34, 44, 45, 39, 38, 33, 33, 46, 46, 34, 33, 40, 41, 45, 43, 36, 37, 33, 41, 31, 46, 26, 31, 36, 44, 43, 40, 32, 35, 60, 38, 35, 31, 35, 50, 167, 37, 43, 38, 34, 41, 44, 31, 48, 36, 38, 47, 36, 35, 34, 32, 63, 34, 36, 40, 37, 32, 30, 29, 57, 33, 49, 29, 33, 35, 40, 37, 37, 35, 38, 33, 31, 45, 45, 32, 45, 37, 36, 43, 35, 34, 29, 28, 36, 44, 33, 43, 31, 52, 36, 43]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2886062718859789, "mean_inference_ms": 0.7233268982409023, "mean_action_processing_ms": 0.07588035170776655, "mean_env_wait_ms": 6.5905404589450285, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0068839233700591735, "StateBufferConnector_ms": 0.003938863773157101, "ViewRequirementAgentConnector_ms": 0.08979410228162708}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 116000, "num_agent_steps_trained": 116000, "num_env_steps_sampled": 116000, "num_env_steps_trained": 116000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 508.8496140214425, "num_env_steps_trained_throughput_per_sec": 508.8496140214425, "timesteps_total": 116000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 116000, "timers": {"training_iteration_time_ms": 7735.327, "sample_time_ms": 4202.75, "load_time_ms": 0.96, "load_throughput": 4167527.635, "learn_time_ms": 3528.21, "learn_throughput": 1133.719, "synch_weights_time_ms": 2.77}, "counters": {"num_env_steps_sampled": 116000, "num_env_steps_trained": 116000, "num_agent_steps_sampled": 116000, "num_agent_steps_trained": 116000}, "done": false, "episodes_total": 1323, "training_iteration": 29, "trial_id": "04cbf_00000", "date": "2024-03-07_13-21-41", "timestamp": 1709835701, "time_this_iter_s": 7.863697052001953, "time_total_s": 218.65582871437073, "pid": 119109, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7efea6399f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 218.65582871437073, "iterations_since_restore": 29, "perf": {"cpu_util_percent": 31.299999999999994, "ram_util_percent": 50.88, "gpu_util_percent0": 0.074, "vram_util_percent0": 0.09165852864583335}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.10000000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 0.09587921655451458, "policy_loss": -0.009455396937987496, "vf_loss": 0.10435315329100817, "vf_explained_var": 0.927684106621691, "kl": 0.009814609647591357, "entropy": 0.5357831115684202, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 27435.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 120000, "num_env_steps_trained": 120000, "num_agent_steps_sampled": 120000, "num_agent_steps_trained": 120000}, "sampler_results": {"episode_reward_max": -1.600000000000001, "episode_reward_min": -4.999999999999995, "episode_reward_mean": -2.5897196261682263, "episode_len_mean": 36.74766355140187, "episode_media": {}, "episodes_this_iter": 107, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.1000000000000014, -3.4000000000000004, -3.3000000000000007, -2.3000000000000016, -2.900000000000002, -2.4000000000000017, -2.600000000000002, -3.3000000000000007, -1.9000000000000012, -2.3000000000000016, -2.4000000000000017, -2.700000000000002, -1.700000000000001, -3.9999999999999982, -2.3000000000000016, -2.0000000000000013, -2.1000000000000014, -3.0000000000000018, -2.4000000000000017, -1.9000000000000012, -1.8000000000000012, -1.600000000000001, -2.3000000000000016, -1.9000000000000012, -2.1000000000000014, -3.9999999999999982, -2.900000000000002, -2.2000000000000015, -2.3000000000000016, -2.600000000000002, -2.1000000000000014, -2.0000000000000013, -2.4000000000000017, -2.700000000000002, -2.4000000000000017, -2.900000000000002, -2.0000000000000013, -2.600000000000002, -2.5000000000000018, -2.900000000000002, -2.700000000000002, -2.600000000000002, -2.600000000000002, -2.3000000000000016, -1.8000000000000012, -2.1000000000000014, -3.0000000000000018, -2.600000000000002, -3.0000000000000018, -2.4000000000000017, -2.4000000000000017, -2.4000000000000017, -3.200000000000001, -2.0000000000000013, -2.800000000000002, -4.3, -3.500000000000001, -2.3000000000000016, -4.999999999999995, -2.5000000000000018, -3.0000000000000018, -3.4000000000000004, -2.2000000000000015, -2.600000000000002, -4.099999999999998, -2.800000000000002, -2.5000000000000018, -1.9000000000000012, -2.2000000000000015, -3.1000000000000014, -2.600000000000002, -3.5, -2.5000000000000018, -2.5000000000000018, -2.3000000000000016, -2.4000000000000017, -1.700000000000001, -2.4000000000000017, -1.8000000000000012, -2.4000000000000017, -2.4000000000000017, -2.800000000000002, -1.9000000000000012, -1.8000000000000012, -2.3000000000000016, -2.700000000000002, -2.800000000000002, -3.0000000000000018, -2.4000000000000017, -3.4000000000000004, -2.800000000000002, -1.700000000000001, -2.600000000000002, -2.5000000000000018, -2.700000000000002, -2.700000000000002, -1.9000000000000012, -2.0000000000000013, -3.5, -2.700000000000002, -2.700000000000002, -4.000000000000003, -3.1000000000000014, -2.2000000000000015, -2.0000000000000013, -2.1000000000000014, -2.800000000000002], "episode_lengths": [42, 45, 44, 34, 40, 35, 37, 44, 30, 34, 35, 38, 28, 51, 34, 31, 32, 41, 35, 30, 29, 27, 34, 30, 32, 51, 40, 33, 34, 37, 32, 31, 35, 38, 35, 40, 31, 37, 36, 40, 38, 37, 37, 34, 29, 32, 41, 37, 41, 35, 35, 35, 43, 31, 37, 51, 42, 34, 61, 36, 41, 45, 33, 37, 52, 39, 36, 30, 33, 42, 37, 46, 36, 36, 34, 35, 28, 35, 29, 35, 35, 39, 30, 29, 34, 38, 39, 41, 35, 45, 39, 28, 37, 36, 38, 38, 30, 31, 46, 38, 38, 44, 42, 33, 31, 32, 39]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2924856772970119, "mean_inference_ms": 0.7235142239409326, "mean_action_processing_ms": 0.07595005738529377, "mean_env_wait_ms": 6.612939207356518, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006938649115161361, "StateBufferConnector_ms": 0.004033507587753724, "ViewRequirementAgentConnector_ms": 0.09181744584413333}}, "episode_reward_max": -1.600000000000001, "episode_reward_min": -4.999999999999995, "episode_reward_mean": -2.5897196261682263, "episode_len_mean": 36.74766355140187, "episodes_this_iter": 107, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3.1000000000000014, -3.4000000000000004, -3.3000000000000007, -2.3000000000000016, -2.900000000000002, -2.4000000000000017, -2.600000000000002, -3.3000000000000007, -1.9000000000000012, -2.3000000000000016, -2.4000000000000017, -2.700000000000002, -1.700000000000001, -3.9999999999999982, -2.3000000000000016, -2.0000000000000013, -2.1000000000000014, -3.0000000000000018, -2.4000000000000017, -1.9000000000000012, -1.8000000000000012, -1.600000000000001, -2.3000000000000016, -1.9000000000000012, -2.1000000000000014, -3.9999999999999982, -2.900000000000002, -2.2000000000000015, -2.3000000000000016, -2.600000000000002, -2.1000000000000014, -2.0000000000000013, -2.4000000000000017, -2.700000000000002, -2.4000000000000017, -2.900000000000002, -2.0000000000000013, -2.600000000000002, -2.5000000000000018, -2.900000000000002, -2.700000000000002, -2.600000000000002, -2.600000000000002, -2.3000000000000016, -1.8000000000000012, -2.1000000000000014, -3.0000000000000018, -2.600000000000002, -3.0000000000000018, -2.4000000000000017, -2.4000000000000017, -2.4000000000000017, -3.200000000000001, -2.0000000000000013, -2.800000000000002, -4.3, -3.500000000000001, -2.3000000000000016, -4.999999999999995, -2.5000000000000018, -3.0000000000000018, -3.4000000000000004, -2.2000000000000015, -2.600000000000002, -4.099999999999998, -2.800000000000002, -2.5000000000000018, -1.9000000000000012, -2.2000000000000015, -3.1000000000000014, -2.600000000000002, -3.5, -2.5000000000000018, -2.5000000000000018, -2.3000000000000016, -2.4000000000000017, -1.700000000000001, -2.4000000000000017, -1.8000000000000012, -2.4000000000000017, -2.4000000000000017, -2.800000000000002, -1.9000000000000012, -1.8000000000000012, -2.3000000000000016, -2.700000000000002, -2.800000000000002, -3.0000000000000018, -2.4000000000000017, -3.4000000000000004, -2.800000000000002, -1.700000000000001, -2.600000000000002, -2.5000000000000018, -2.700000000000002, -2.700000000000002, -1.9000000000000012, -2.0000000000000013, -3.5, -2.700000000000002, -2.700000000000002, -4.000000000000003, -3.1000000000000014, -2.2000000000000015, -2.0000000000000013, -2.1000000000000014, -2.800000000000002], "episode_lengths": [42, 45, 44, 34, 40, 35, 37, 44, 30, 34, 35, 38, 28, 51, 34, 31, 32, 41, 35, 30, 29, 27, 34, 30, 32, 51, 40, 33, 34, 37, 32, 31, 35, 38, 35, 40, 31, 37, 36, 40, 38, 37, 37, 34, 29, 32, 41, 37, 41, 35, 35, 35, 43, 31, 37, 51, 42, 34, 61, 36, 41, 45, 33, 37, 52, 39, 36, 30, 33, 42, 37, 46, 36, 36, 34, 35, 28, 35, 29, 35, 35, 39, 30, 29, 34, 38, 39, 41, 35, 45, 39, 28, 37, 36, 38, 38, 30, 31, 46, 38, 38, 44, 42, 33, 31, 32, 39]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2924856772970119, "mean_inference_ms": 0.7235142239409326, "mean_action_processing_ms": 0.07595005738529377, "mean_env_wait_ms": 6.612939207356518, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006938649115161361, "StateBufferConnector_ms": 0.004033507587753724, "ViewRequirementAgentConnector_ms": 0.09181744584413333}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 120000, "num_agent_steps_trained": 120000, "num_env_steps_sampled": 120000, "num_env_steps_trained": 120000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 509.1874108470667, "num_env_steps_trained_throughput_per_sec": 509.1874108470667, "timesteps_total": 120000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 120000, "timers": {"training_iteration_time_ms": 7749.51, "sample_time_ms": 4218.473, "load_time_ms": 0.956, "load_throughput": 4185723.267, "learn_time_ms": 3526.671, "learn_throughput": 1134.214, "synch_weights_time_ms": 2.771}, "counters": {"num_env_steps_sampled": 120000, "num_env_steps_trained": 120000, "num_agent_steps_sampled": 120000, "num_agent_steps_trained": 120000}, "done": false, "episodes_total": 1430, "training_iteration": 30, "trial_id": "04cbf_00000", "date": "2024-03-07_13-21-49", "timestamp": 1709835709, "time_this_iter_s": 7.858524322509766, "time_total_s": 226.5143530368805, "pid": 119109, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7efea6399f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 226.5143530368805, "iterations_since_restore": 30, "perf": {"cpu_util_percent": 33.3, "ram_util_percent": 50.8, "gpu_util_percent0": 0.074, "vram_util_percent0": 0.09165852864583332}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.10000000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 0.2267419044687588, "policy_loss": -0.008102795716014601, "vf_loss": 0.2338880420992932, "vf_explained_var": 0.8998187972012387, "kl": 0.009566586313686917, "entropy": 0.4907249320899287, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 28365.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 124000, "num_env_steps_trained": 124000, "num_agent_steps_sampled": 124000, "num_agent_steps_trained": 124000}, "sampler_results": {"episode_reward_max": -1.5000000000000009, "episode_reward_min": -7.200000000000005, "episode_reward_mean": -2.486956521739132, "episode_len_mean": 35.426086956521736, "episode_media": {}, "episodes_this_iter": 115, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.0000000000000018, -2.700000000000002, -2.0000000000000013, -2.5000000000000018, -2.1000000000000014, -2.3000000000000016, -2.0000000000000013, -2.800000000000002, -7.200000000000005, -1.9000000000000012, -2.3000000000000016, -2.5000000000000018, -2.0000000000000013, -2.1000000000000014, -3.0000000000000018, -2.2000000000000015, -3.0000000000000018, -3.3000000000000016, -1.700000000000001, -3.9999999999999982, -1.700000000000001, -2.2000000000000015, -2.0000000000000013, -2.600000000000002, -2.2000000000000015, -2.0000000000000013, -2.700000000000002, -3.0000000000000018, -2.0000000000000013, -2.1000000000000014, -4.000000000000002, -2.2000000000000015, -3.400000000000002, -2.3000000000000016, -2.2000000000000015, -2.4000000000000017, -2.700000000000002, -2.5000000000000018, -3.0000000000000018, -2.1000000000000014, -2.5000000000000018, -2.3000000000000016, -2.700000000000002, -3.200000000000002, -2.600000000000002, -2.0000000000000013, -2.2000000000000015, -2.5000000000000018, -2.3000000000000016, -2.1000000000000014, -2.2000000000000015, -2.700000000000002, -3.6999999999999993, -3.5, -1.8000000000000012, -1.700000000000001, -2.3000000000000016, -1.8000000000000012, -2.2000000000000015, -2.3000000000000016, -2.4000000000000017, -2.4000000000000017, -2.2000000000000015, -3.3000000000000016, -2.4000000000000017, -2.2000000000000015, -2.0000000000000013, -1.8000000000000012, -3.0000000000000018, -2.2000000000000015, -1.9000000000000012, -3.1000000000000014, -1.9000000000000012, -2.1000000000000014, -3.1000000000000014, -2.4000000000000017, -2.3000000000000016, -1.700000000000001, -2.600000000000002, -2.800000000000002, -2.4000000000000017, -1.8000000000000012, -2.2000000000000015, -1.700000000000001, -2.2000000000000015, -1.700000000000001, -4.799999999999999, -3.4000000000000004, -2.800000000000002, -1.9000000000000012, -2.4000000000000017, -2.600000000000002, -5.200000000000003, -1.700000000000001, -2.1000000000000014, -2.800000000000002, -2.0000000000000013, -2.4000000000000017, -1.600000000000001, -3.1000000000000014, -1.5000000000000009, -2.800000000000002, -2.600000000000002, -2.900000000000002, -2.600000000000002, -1.8000000000000012, -2.600000000000002, -2.5000000000000018, -2.2000000000000015, -2.1000000000000014, -2.0000000000000013, -3.1000000000000014, -2.0000000000000013, -2.3000000000000016, -1.9000000000000012], "episode_lengths": [41, 38, 31, 36, 32, 34, 31, 39, 62, 30, 34, 36, 31, 32, 41, 33, 41, 43, 28, 51, 28, 33, 31, 37, 33, 31, 38, 39, 31, 32, 46, 33, 43, 34, 33, 35, 38, 36, 41, 32, 36, 34, 38, 40, 37, 31, 33, 36, 34, 32, 33, 38, 48, 46, 29, 28, 34, 29, 33, 34, 35, 35, 33, 42, 35, 33, 31, 29, 41, 33, 30, 42, 30, 32, 42, 35, 34, 28, 37, 39, 35, 29, 33, 28, 33, 28, 55, 45, 39, 30, 35, 37, 52, 28, 32, 39, 31, 35, 27, 42, 26, 39, 37, 40, 37, 29, 37, 36, 33, 32, 31, 42, 31, 34, 30]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2961113554137442, "mean_inference_ms": 0.7237041930737621, "mean_action_processing_ms": 0.07596447837860555, "mean_env_wait_ms": 6.635789111695999, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006850491399350373, "StateBufferConnector_ms": 0.003938467606254246, "ViewRequirementAgentConnector_ms": 0.08935803952424423}}, "episode_reward_max": -1.5000000000000009, "episode_reward_min": -7.200000000000005, "episode_reward_mean": -2.486956521739132, "episode_len_mean": 35.426086956521736, "episodes_this_iter": 115, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3.0000000000000018, -2.700000000000002, -2.0000000000000013, -2.5000000000000018, -2.1000000000000014, -2.3000000000000016, -2.0000000000000013, -2.800000000000002, -7.200000000000005, -1.9000000000000012, -2.3000000000000016, -2.5000000000000018, -2.0000000000000013, -2.1000000000000014, -3.0000000000000018, -2.2000000000000015, -3.0000000000000018, -3.3000000000000016, -1.700000000000001, -3.9999999999999982, -1.700000000000001, -2.2000000000000015, -2.0000000000000013, -2.600000000000002, -2.2000000000000015, -2.0000000000000013, -2.700000000000002, -3.0000000000000018, -2.0000000000000013, -2.1000000000000014, -4.000000000000002, -2.2000000000000015, -3.400000000000002, -2.3000000000000016, -2.2000000000000015, -2.4000000000000017, -2.700000000000002, -2.5000000000000018, -3.0000000000000018, -2.1000000000000014, -2.5000000000000018, -2.3000000000000016, -2.700000000000002, -3.200000000000002, -2.600000000000002, -2.0000000000000013, -2.2000000000000015, -2.5000000000000018, -2.3000000000000016, -2.1000000000000014, -2.2000000000000015, -2.700000000000002, -3.6999999999999993, -3.5, -1.8000000000000012, -1.700000000000001, -2.3000000000000016, -1.8000000000000012, -2.2000000000000015, -2.3000000000000016, -2.4000000000000017, -2.4000000000000017, -2.2000000000000015, -3.3000000000000016, -2.4000000000000017, -2.2000000000000015, -2.0000000000000013, -1.8000000000000012, -3.0000000000000018, -2.2000000000000015, -1.9000000000000012, -3.1000000000000014, -1.9000000000000012, -2.1000000000000014, -3.1000000000000014, -2.4000000000000017, -2.3000000000000016, -1.700000000000001, -2.600000000000002, -2.800000000000002, -2.4000000000000017, -1.8000000000000012, -2.2000000000000015, -1.700000000000001, -2.2000000000000015, -1.700000000000001, -4.799999999999999, -3.4000000000000004, -2.800000000000002, -1.9000000000000012, -2.4000000000000017, -2.600000000000002, -5.200000000000003, -1.700000000000001, -2.1000000000000014, -2.800000000000002, -2.0000000000000013, -2.4000000000000017, -1.600000000000001, -3.1000000000000014, -1.5000000000000009, -2.800000000000002, -2.600000000000002, -2.900000000000002, -2.600000000000002, -1.8000000000000012, -2.600000000000002, -2.5000000000000018, -2.2000000000000015, -2.1000000000000014, -2.0000000000000013, -3.1000000000000014, -2.0000000000000013, -2.3000000000000016, -1.9000000000000012], "episode_lengths": [41, 38, 31, 36, 32, 34, 31, 39, 62, 30, 34, 36, 31, 32, 41, 33, 41, 43, 28, 51, 28, 33, 31, 37, 33, 31, 38, 39, 31, 32, 46, 33, 43, 34, 33, 35, 38, 36, 41, 32, 36, 34, 38, 40, 37, 31, 33, 36, 34, 32, 33, 38, 48, 46, 29, 28, 34, 29, 33, 34, 35, 35, 33, 42, 35, 33, 31, 29, 41, 33, 30, 42, 30, 32, 42, 35, 34, 28, 37, 39, 35, 29, 33, 28, 33, 28, 55, 45, 39, 30, 35, 37, 52, 28, 32, 39, 31, 35, 27, 42, 26, 39, 37, 40, 37, 29, 37, 36, 33, 32, 31, 42, 31, 34, 30]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2961113554137442, "mean_inference_ms": 0.7237041930737621, "mean_action_processing_ms": 0.07596447837860555, "mean_env_wait_ms": 6.635789111695999, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006850491399350373, "StateBufferConnector_ms": 0.003938467606254246, "ViewRequirementAgentConnector_ms": 0.08935803952424423}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 124000, "num_agent_steps_trained": 124000, "num_env_steps_sampled": 124000, "num_env_steps_trained": 124000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 505.7831795086318, "num_env_steps_trained_throughput_per_sec": 505.7831795086318, "timesteps_total": 124000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 124000, "timers": {"training_iteration_time_ms": 7781.801, "sample_time_ms": 4251.429, "load_time_ms": 0.96, "load_throughput": 4167320.599, "learn_time_ms": 3525.993, "learn_throughput": 1134.432, "synch_weights_time_ms": 2.782}, "counters": {"num_env_steps_sampled": 124000, "num_env_steps_trained": 124000, "num_agent_steps_sampled": 124000, "num_agent_steps_trained": 124000}, "done": false, "episodes_total": 1545, "training_iteration": 31, "trial_id": "04cbf_00000", "date": "2024-03-07_13-21-57", "timestamp": 1709835717, "time_this_iter_s": 7.911562442779541, "time_total_s": 234.42591547966003, "pid": 119109, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7efea6399f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 234.42591547966003, "iterations_since_restore": 31, "perf": {"cpu_util_percent": 29.409090909090914, "ram_util_percent": 50.8, "gpu_util_percent0": 0.09909090909090908, "vram_util_percent0": 0.09163411458333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.10000000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 0.04769777590940927, "policy_loss": -0.021293719649635334, "vf_loss": 0.06744720185956647, "vf_explained_var": 0.9452872392310891, "kl": 0.015442937301073077, "entropy": 0.4535576156070156, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 29295.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 128000, "num_env_steps_trained": 128000, "num_agent_steps_sampled": 128000, "num_agent_steps_trained": 128000}, "sampler_results": {"episode_reward_max": -1.5000000000000009, "episode_reward_min": -4.599999999999996, "episode_reward_mean": -2.2870689655172423, "episode_len_mean": 33.810344827586206, "episode_media": {}, "episodes_this_iter": 116, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1.5000000000000009, -2.0000000000000013, -3.3000000000000007, -2.2000000000000015, -1.8000000000000012, -2.2000000000000015, -2.4000000000000017, -3.200000000000001, -2.0000000000000013, -1.8000000000000012, -3.0000000000000018, -2.2000000000000015, -2.3000000000000016, -2.0000000000000013, -2.3000000000000016, -2.4000000000000017, -2.0000000000000013, -1.5000000000000009, -3.1000000000000014, -2.0000000000000013, -2.800000000000002, -2.3000000000000016, -2.5000000000000018, -2.1000000000000014, -1.600000000000001, -1.700000000000001, -2.4000000000000017, -2.800000000000002, -2.0000000000000013, -2.5000000000000018, -2.1000000000000014, -1.9000000000000012, -2.600000000000002, -2.800000000000002, -2.2000000000000015, -2.3000000000000016, -2.1000000000000014, -2.4000000000000017, -3.200000000000001, -2.1000000000000014, -3.5, -3.0000000000000018, -2.4000000000000017, -2.5000000000000018, -2.2000000000000015, -2.700000000000002, -2.0000000000000013, -2.5000000000000018, -2.1000000000000014, -1.8000000000000012, -2.3000000000000016, -2.0000000000000013, -1.9000000000000012, -2.2000000000000015, -2.1000000000000014, -1.8000000000000012, -1.9000000000000012, -2.3000000000000016, -2.4000000000000017, -1.8000000000000012, -2.600000000000002, -1.8000000000000012, -2.3000000000000016, -1.700000000000001, -1.8000000000000012, -2.700000000000002, -1.700000000000001, -2.2000000000000015, -1.9000000000000012, -3.6999999999999993, -2.800000000000002, -2.1000000000000014, -4.599999999999996, -1.8000000000000012, -2.900000000000002, -2.2000000000000015, -1.9000000000000012, -2.0000000000000013, -2.2000000000000015, -1.9000000000000012, -1.700000000000001, -1.600000000000001, -1.8000000000000012, -2.1000000000000014, -3.0000000000000018, -2.4000000000000017, -2.3000000000000016, -2.3000000000000016, -2.1000000000000014, -1.700000000000001, -2.1000000000000014, -2.5000000000000018, -2.0000000000000013, -2.2000000000000015, -1.600000000000001, -1.600000000000001, -2.0000000000000013, -2.4000000000000017, -2.2000000000000015, -2.2000000000000015, -1.9000000000000012, -2.800000000000002, -2.1000000000000014, -2.4000000000000017, -1.8000000000000012, -2.2000000000000015, -2.5000000000000018, -1.9000000000000012, -2.0000000000000013, -2.900000000000002, -2.800000000000001, -2.5000000000000018, -3.200000000000001, -4.499999999999997, -1.8000000000000012, -2.4000000000000017], "episode_lengths": [26, 31, 44, 33, 29, 33, 35, 43, 31, 29, 40, 33, 34, 31, 34, 35, 31, 26, 42, 31, 39, 34, 36, 32, 27, 28, 35, 39, 31, 36, 32, 30, 37, 39, 33, 34, 32, 35, 43, 32, 46, 41, 35, 36, 33, 38, 31, 36, 32, 29, 34, 31, 30, 33, 32, 29, 30, 34, 35, 29, 37, 29, 34, 28, 29, 38, 28, 33, 30, 48, 39, 32, 57, 29, 40, 33, 30, 31, 33, 30, 28, 27, 29, 32, 41, 35, 34, 34, 32, 28, 32, 36, 31, 33, 27, 27, 31, 35, 33, 33, 30, 39, 32, 35, 29, 33, 36, 30, 31, 40, 34, 36, 43, 55, 29, 35]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2996688814413676, "mean_inference_ms": 0.723787134980854, "mean_action_processing_ms": 0.07594860679383278, "mean_env_wait_ms": 6.657669069899411, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006960178243702856, "StateBufferConnector_ms": 0.003933289955402243, "ViewRequirementAgentConnector_ms": 0.09006570125448293}}, "episode_reward_max": -1.5000000000000009, "episode_reward_min": -4.599999999999996, "episode_reward_mean": -2.2870689655172423, "episode_len_mean": 33.810344827586206, "episodes_this_iter": 116, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1.5000000000000009, -2.0000000000000013, -3.3000000000000007, -2.2000000000000015, -1.8000000000000012, -2.2000000000000015, -2.4000000000000017, -3.200000000000001, -2.0000000000000013, -1.8000000000000012, -3.0000000000000018, -2.2000000000000015, -2.3000000000000016, -2.0000000000000013, -2.3000000000000016, -2.4000000000000017, -2.0000000000000013, -1.5000000000000009, -3.1000000000000014, -2.0000000000000013, -2.800000000000002, -2.3000000000000016, -2.5000000000000018, -2.1000000000000014, -1.600000000000001, -1.700000000000001, -2.4000000000000017, -2.800000000000002, -2.0000000000000013, -2.5000000000000018, -2.1000000000000014, -1.9000000000000012, -2.600000000000002, -2.800000000000002, -2.2000000000000015, -2.3000000000000016, -2.1000000000000014, -2.4000000000000017, -3.200000000000001, -2.1000000000000014, -3.5, -3.0000000000000018, -2.4000000000000017, -2.5000000000000018, -2.2000000000000015, -2.700000000000002, -2.0000000000000013, -2.5000000000000018, -2.1000000000000014, -1.8000000000000012, -2.3000000000000016, -2.0000000000000013, -1.9000000000000012, -2.2000000000000015, -2.1000000000000014, -1.8000000000000012, -1.9000000000000012, -2.3000000000000016, -2.4000000000000017, -1.8000000000000012, -2.600000000000002, -1.8000000000000012, -2.3000000000000016, -1.700000000000001, -1.8000000000000012, -2.700000000000002, -1.700000000000001, -2.2000000000000015, -1.9000000000000012, -3.6999999999999993, -2.800000000000002, -2.1000000000000014, -4.599999999999996, -1.8000000000000012, -2.900000000000002, -2.2000000000000015, -1.9000000000000012, -2.0000000000000013, -2.2000000000000015, -1.9000000000000012, -1.700000000000001, -1.600000000000001, -1.8000000000000012, -2.1000000000000014, -3.0000000000000018, -2.4000000000000017, -2.3000000000000016, -2.3000000000000016, -2.1000000000000014, -1.700000000000001, -2.1000000000000014, -2.5000000000000018, -2.0000000000000013, -2.2000000000000015, -1.600000000000001, -1.600000000000001, -2.0000000000000013, -2.4000000000000017, -2.2000000000000015, -2.2000000000000015, -1.9000000000000012, -2.800000000000002, -2.1000000000000014, -2.4000000000000017, -1.8000000000000012, -2.2000000000000015, -2.5000000000000018, -1.9000000000000012, -2.0000000000000013, -2.900000000000002, -2.800000000000001, -2.5000000000000018, -3.200000000000001, -4.499999999999997, -1.8000000000000012, -2.4000000000000017], "episode_lengths": [26, 31, 44, 33, 29, 33, 35, 43, 31, 29, 40, 33, 34, 31, 34, 35, 31, 26, 42, 31, 39, 34, 36, 32, 27, 28, 35, 39, 31, 36, 32, 30, 37, 39, 33, 34, 32, 35, 43, 32, 46, 41, 35, 36, 33, 38, 31, 36, 32, 29, 34, 31, 30, 33, 32, 29, 30, 34, 35, 29, 37, 29, 34, 28, 29, 38, 28, 33, 30, 48, 39, 32, 57, 29, 40, 33, 30, 31, 33, 30, 28, 27, 29, 32, 41, 35, 34, 34, 32, 28, 32, 36, 31, 33, 27, 27, 31, 35, 33, 33, 30, 39, 32, 35, 29, 33, 36, 30, 31, 40, 34, 36, 43, 55, 29, 35]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2996688814413676, "mean_inference_ms": 0.723787134980854, "mean_action_processing_ms": 0.07594860679383278, "mean_env_wait_ms": 6.657669069899411, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006960178243702856, "StateBufferConnector_ms": 0.003933289955402243, "ViewRequirementAgentConnector_ms": 0.09006570125448293}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 128000, "num_agent_steps_trained": 128000, "num_env_steps_sampled": 128000, "num_env_steps_trained": 128000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 505.42953938389303, "num_env_steps_trained_throughput_per_sec": 505.42953938389303, "timesteps_total": 128000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 128000, "timers": {"training_iteration_time_ms": 7783.58, "sample_time_ms": 4272.452, "load_time_ms": 0.962, "load_throughput": 4156891.972, "learn_time_ms": 3506.768, "learn_throughput": 1140.652, "synch_weights_time_ms": 2.764}, "counters": {"num_env_steps_sampled": 128000, "num_env_steps_trained": 128000, "num_agent_steps_sampled": 128000, "num_agent_steps_trained": 128000}, "done": false, "episodes_total": 1661, "training_iteration": 32, "trial_id": "04cbf_00000", "date": "2024-03-07_13-22-05", "timestamp": 1709835725, "time_this_iter_s": 7.91675329208374, "time_total_s": 242.34266877174377, "pid": 119109, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7efea6399f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 242.34266877174377, "iterations_since_restore": 32, "perf": {"cpu_util_percent": 32.239999999999995, "ram_util_percent": 50.8, "gpu_util_percent0": 0.075, "vram_util_percent0": 0.091650390625}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.10000000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 0.07952771776115462, "policy_loss": -0.01952061055488484, "vf_loss": 0.09751932620201059, "vf_explained_var": 0.9253170137123395, "kl": 0.015290019500256945, "entropy": 0.4068415361386473, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 30225.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 132000, "num_env_steps_trained": 132000, "num_agent_steps_sampled": 132000, "num_agent_steps_trained": 132000}, "sampler_results": {"episode_reward_max": -1.5000000000000009, "episode_reward_min": -4.900000000000001, "episode_reward_mean": -2.176800000000002, "episode_len_mean": 32.592, "episode_media": {}, "episodes_this_iter": 125, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4.4999999999999964, -1.700000000000001, -2.2000000000000015, -1.9000000000000012, -2.1000000000000014, -2.0000000000000013, -1.8000000000000012, -1.700000000000001, -1.9000000000000012, -1.8000000000000012, -2.600000000000002, -2.3000000000000016, -3.1000000000000014, -2.0000000000000013, -2.4000000000000017, -2.4000000000000017, -2.800000000000002, -2.1000000000000014, -3.200000000000001, -2.800000000000002, -2.4000000000000017, -2.1000000000000014, -1.8000000000000012, -1.9000000000000012, -2.5000000000000018, -1.8000000000000012, -2.600000000000002, -2.1000000000000014, -2.4000000000000017, -2.0000000000000013, -2.4000000000000017, -1.5000000000000009, -2.800000000000002, -2.4000000000000017, -4.900000000000001, -2.600000000000002, -2.800000000000002, -1.8000000000000012, -3.200000000000001, -2.700000000000002, -1.600000000000001, -1.700000000000001, -1.9000000000000012, -3.0000000000000018, -2.3000000000000016, -2.700000000000002, -1.9000000000000012, -1.9000000000000012, -1.600000000000001, -2.800000000000002, -2.1000000000000014, -2.3000000000000016, -2.1000000000000014, -2.1000000000000014, -2.0000000000000013, -1.700000000000001, -2.0000000000000013, -2.0000000000000013, -2.2000000000000015, -1.9000000000000012, -2.0000000000000013, -2.2000000000000015, -2.4000000000000017, -1.8000000000000012, -3.3000000000000007, -1.8000000000000012, -2.4000000000000017, -2.4000000000000017, -1.8000000000000012, -2.800000000000002, -1.600000000000001, -2.3000000000000016, -2.700000000000002, -2.3000000000000016, -1.8000000000000012, -2.2000000000000015, -2.5000000000000018, -1.700000000000001, -1.9000000000000012, -2.1000000000000014, -2.5000000000000018, -1.8000000000000012, -1.700000000000001, -1.700000000000001, -1.8000000000000012, -1.700000000000001, -2.2000000000000015, -2.0000000000000013, -2.4000000000000017, -2.2000000000000015, -1.600000000000001, -2.2000000000000015, -1.700000000000001, -2.700000000000002, -2.1000000000000014, -1.5000000000000009, -2.1000000000000014, -2.1000000000000014, -2.800000000000002, -1.8000000000000012, -2.2000000000000015, -2.600000000000002, -1.600000000000001, -2.1000000000000014, -1.8000000000000012, -1.700000000000001, -1.700000000000001, -2.0000000000000013, -2.1000000000000014, -1.600000000000001, -2.5000000000000018, -1.9000000000000012, -2.4000000000000017, -2.1000000000000014, -2.4000000000000017, -2.0000000000000013, -1.600000000000001, -2.2000000000000015, -1.9000000000000012, -1.600000000000001, -2.0000000000000013, -2.4000000000000017, -1.600000000000001, -2.1000000000000014, -1.600000000000001], "episode_lengths": [52, 28, 33, 30, 32, 31, 29, 28, 30, 29, 37, 34, 42, 31, 35, 35, 39, 32, 43, 39, 35, 32, 29, 30, 33, 29, 37, 32, 35, 31, 35, 26, 39, 35, 53, 37, 39, 29, 43, 38, 27, 28, 30, 40, 34, 38, 30, 30, 27, 39, 32, 34, 32, 32, 31, 28, 31, 31, 33, 30, 31, 33, 35, 29, 44, 29, 35, 35, 29, 39, 27, 34, 38, 32, 29, 33, 36, 28, 30, 32, 36, 29, 28, 28, 29, 28, 33, 31, 35, 33, 27, 33, 28, 38, 32, 26, 32, 32, 34, 29, 33, 37, 27, 32, 29, 28, 28, 31, 32, 27, 36, 30, 35, 32, 35, 31, 27, 33, 30, 27, 31, 35, 27, 32, 27]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3032260428023451, "mean_inference_ms": 0.7238712449498875, "mean_action_processing_ms": 0.07596211727875869, "mean_env_wait_ms": 6.681983165094819, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006866455078125, "StateBufferConnector_ms": 0.003942108154296875, "ViewRequirementAgentConnector_ms": 0.09043846130371094}}, "episode_reward_max": -1.5000000000000009, "episode_reward_min": -4.900000000000001, "episode_reward_mean": -2.176800000000002, "episode_len_mean": 32.592, "episodes_this_iter": 125, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-4.4999999999999964, -1.700000000000001, -2.2000000000000015, -1.9000000000000012, -2.1000000000000014, -2.0000000000000013, -1.8000000000000012, -1.700000000000001, -1.9000000000000012, -1.8000000000000012, -2.600000000000002, -2.3000000000000016, -3.1000000000000014, -2.0000000000000013, -2.4000000000000017, -2.4000000000000017, -2.800000000000002, -2.1000000000000014, -3.200000000000001, -2.800000000000002, -2.4000000000000017, -2.1000000000000014, -1.8000000000000012, -1.9000000000000012, -2.5000000000000018, -1.8000000000000012, -2.600000000000002, -2.1000000000000014, -2.4000000000000017, -2.0000000000000013, -2.4000000000000017, -1.5000000000000009, -2.800000000000002, -2.4000000000000017, -4.900000000000001, -2.600000000000002, -2.800000000000002, -1.8000000000000012, -3.200000000000001, -2.700000000000002, -1.600000000000001, -1.700000000000001, -1.9000000000000012, -3.0000000000000018, -2.3000000000000016, -2.700000000000002, -1.9000000000000012, -1.9000000000000012, -1.600000000000001, -2.800000000000002, -2.1000000000000014, -2.3000000000000016, -2.1000000000000014, -2.1000000000000014, -2.0000000000000013, -1.700000000000001, -2.0000000000000013, -2.0000000000000013, -2.2000000000000015, -1.9000000000000012, -2.0000000000000013, -2.2000000000000015, -2.4000000000000017, -1.8000000000000012, -3.3000000000000007, -1.8000000000000012, -2.4000000000000017, -2.4000000000000017, -1.8000000000000012, -2.800000000000002, -1.600000000000001, -2.3000000000000016, -2.700000000000002, -2.3000000000000016, -1.8000000000000012, -2.2000000000000015, -2.5000000000000018, -1.700000000000001, -1.9000000000000012, -2.1000000000000014, -2.5000000000000018, -1.8000000000000012, -1.700000000000001, -1.700000000000001, -1.8000000000000012, -1.700000000000001, -2.2000000000000015, -2.0000000000000013, -2.4000000000000017, -2.2000000000000015, -1.600000000000001, -2.2000000000000015, -1.700000000000001, -2.700000000000002, -2.1000000000000014, -1.5000000000000009, -2.1000000000000014, -2.1000000000000014, -2.800000000000002, -1.8000000000000012, -2.2000000000000015, -2.600000000000002, -1.600000000000001, -2.1000000000000014, -1.8000000000000012, -1.700000000000001, -1.700000000000001, -2.0000000000000013, -2.1000000000000014, -1.600000000000001, -2.5000000000000018, -1.9000000000000012, -2.4000000000000017, -2.1000000000000014, -2.4000000000000017, -2.0000000000000013, -1.600000000000001, -2.2000000000000015, -1.9000000000000012, -1.600000000000001, -2.0000000000000013, -2.4000000000000017, -1.600000000000001, -2.1000000000000014, -1.600000000000001], "episode_lengths": [52, 28, 33, 30, 32, 31, 29, 28, 30, 29, 37, 34, 42, 31, 35, 35, 39, 32, 43, 39, 35, 32, 29, 30, 33, 29, 37, 32, 35, 31, 35, 26, 39, 35, 53, 37, 39, 29, 43, 38, 27, 28, 30, 40, 34, 38, 30, 30, 27, 39, 32, 34, 32, 32, 31, 28, 31, 31, 33, 30, 31, 33, 35, 29, 44, 29, 35, 35, 29, 39, 27, 34, 38, 32, 29, 33, 36, 28, 30, 32, 36, 29, 28, 28, 29, 28, 33, 31, 35, 33, 27, 33, 28, 38, 32, 26, 32, 32, 34, 29, 33, 37, 27, 32, 29, 28, 28, 31, 32, 27, 36, 30, 35, 32, 35, 31, 27, 33, 30, 27, 31, 35, 27, 32, 27]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3032260428023451, "mean_inference_ms": 0.7238712449498875, "mean_action_processing_ms": 0.07596211727875869, "mean_env_wait_ms": 6.681983165094819, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006866455078125, "StateBufferConnector_ms": 0.003942108154296875, "ViewRequirementAgentConnector_ms": 0.09043846130371094}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 132000, "num_agent_steps_trained": 132000, "num_env_steps_sampled": 132000, "num_env_steps_trained": 132000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 505.3576650914944, "num_env_steps_trained_throughput_per_sec": 505.3576650914944, "timesteps_total": 132000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 132000, "timers": {"training_iteration_time_ms": 7823.229, "sample_time_ms": 4309.682, "load_time_ms": 0.972, "load_throughput": 4114886.687, "learn_time_ms": 3509.173, "learn_throughput": 1139.87, "synch_weights_time_ms": 2.767}, "counters": {"num_env_steps_sampled": 132000, "num_env_steps_trained": 132000, "num_agent_steps_sampled": 132000, "num_agent_steps_trained": 132000}, "done": false, "episodes_total": 1786, "training_iteration": 33, "trial_id": "04cbf_00000", "date": "2024-03-07_13-22-13", "timestamp": 1709835733, "time_this_iter_s": 7.918211936950684, "time_total_s": 250.26088070869446, "pid": 119109, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7efea6399f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 250.26088070869446, "iterations_since_restore": 33, "perf": {"cpu_util_percent": 32.06999999999999, "ram_util_percent": 50.839999999999996, "gpu_util_percent0": 0.075, "vram_util_percent0": 0.09165852864583333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.10000000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 0.07639667386169074, "policy_loss": -0.0064071885660611175, "vf_loss": 0.08156028220189675, "vf_explained_var": 0.924194247171443, "kl": 0.012435792485689448, "entropy": 0.36120965642634256, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 31155.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 136000, "num_env_steps_trained": 136000, "num_agent_steps_sampled": 136000, "num_agent_steps_trained": 136000}, "sampler_results": {"episode_reward_max": -1.4000000000000008, "episode_reward_min": -4.4, "episode_reward_mean": -1.9891472868217068, "episode_len_mean": 30.728682170542637, "episode_media": {}, "episodes_this_iter": 129, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1.4000000000000008, -1.8000000000000012, -2.5000000000000018, -2.1000000000000014, -2.1000000000000014, -1.600000000000001, -1.9000000000000012, -1.5000000000000009, -1.9000000000000012, -1.5000000000000009, -1.8000000000000012, -1.5000000000000009, -2.600000000000002, -2.0000000000000013, -2.3000000000000016, -1.9000000000000012, -1.700000000000001, -2.4000000000000017, -1.8000000000000012, -1.9000000000000012, -1.9000000000000012, -2.0000000000000013, -2.0000000000000013, -1.9000000000000012, -1.9000000000000012, -2.0000000000000013, -2.0000000000000013, -1.700000000000001, -1.4000000000000008, -1.700000000000001, -1.700000000000001, -1.5000000000000009, -1.700000000000001, -1.700000000000001, -3.0000000000000018, -2.700000000000002, -1.700000000000001, -2.1000000000000014, -1.700000000000001, -1.600000000000001, -2.1000000000000014, -2.600000000000002, -2.1000000000000014, -2.3000000000000016, -2.3000000000000016, -2.0000000000000013, -1.8000000000000012, -1.4000000000000008, -2.1000000000000014, -3.5999999999999996, -2.2000000000000015, -1.700000000000001, -1.700000000000001, -2.0000000000000013, -1.5000000000000009, -2.1000000000000014, -1.9000000000000012, -2.0000000000000013, -1.700000000000001, -1.8000000000000012, -1.700000000000001, -2.2000000000000015, -2.600000000000002, -1.4000000000000008, -1.700000000000001, -2.1000000000000014, -2.3000000000000016, -2.5000000000000018, -1.600000000000001, -2.1000000000000014, -2.3000000000000016, -2.4000000000000017, -2.2000000000000015, -1.8000000000000012, -3.1000000000000014, -1.700000000000001, -2.800000000000002, -1.600000000000001, -1.8000000000000012, -2.0000000000000013, -2.2000000000000015, -2.2000000000000015, -1.5000000000000009, -2.1000000000000014, -1.9000000000000012, -2.1000000000000014, -1.4000000000000008, -2.2000000000000015, -1.8000000000000012, -1.700000000000001, -2.5000000000000018, -1.700000000000001, -1.4000000000000008, -2.700000000000002, -2.0000000000000013, -2.1000000000000014, -3.3000000000000016, -1.5000000000000009, -2.0000000000000013, -2.2000000000000015, -1.5000000000000009, -2.2000000000000015, -1.9000000000000012, -1.9000000000000012, -1.600000000000001, -1.600000000000001, -1.700000000000001, -2.800000000000002, -1.9000000000000012, -1.600000000000001, -1.8000000000000012, -4.4, -2.4000000000000017, -2.1000000000000014, -1.9000000000000012, -1.8000000000000012, -1.9000000000000012, -1.5000000000000009, -1.700000000000001, -2.4000000000000017, -2.2000000000000015, -1.4000000000000008, -1.8000000000000012, -2.3000000000000016, -1.600000000000001, -1.600000000000001, -1.9000000000000012, -1.8000000000000012, -2.0000000000000013], "episode_lengths": [25, 29, 36, 32, 32, 27, 30, 26, 30, 26, 29, 26, 37, 31, 34, 30, 28, 35, 29, 30, 30, 31, 31, 30, 30, 31, 31, 28, 25, 28, 28, 26, 28, 28, 41, 38, 28, 32, 28, 27, 32, 35, 32, 34, 34, 31, 29, 25, 32, 47, 33, 28, 28, 31, 26, 32, 30, 31, 28, 29, 28, 33, 37, 25, 28, 32, 34, 36, 27, 32, 34, 35, 33, 29, 37, 28, 39, 27, 29, 31, 33, 33, 26, 32, 30, 32, 25, 33, 29, 28, 36, 28, 25, 38, 31, 32, 40, 26, 31, 33, 26, 33, 30, 30, 27, 27, 28, 39, 30, 27, 29, 45, 35, 32, 30, 29, 30, 26, 28, 35, 33, 25, 29, 34, 27, 27, 30, 29, 31]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3070258086438194, "mean_inference_ms": 0.7240801350498903, "mean_action_processing_ms": 0.07596570300669896, "mean_env_wait_ms": 6.708058122960473, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006910257561262264, "StateBufferConnector_ms": 0.003963662672412488, "ViewRequirementAgentConnector_ms": 0.09000079576359239}}, "episode_reward_max": -1.4000000000000008, "episode_reward_min": -4.4, "episode_reward_mean": -1.9891472868217068, "episode_len_mean": 30.728682170542637, "episodes_this_iter": 129, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1.4000000000000008, -1.8000000000000012, -2.5000000000000018, -2.1000000000000014, -2.1000000000000014, -1.600000000000001, -1.9000000000000012, -1.5000000000000009, -1.9000000000000012, -1.5000000000000009, -1.8000000000000012, -1.5000000000000009, -2.600000000000002, -2.0000000000000013, -2.3000000000000016, -1.9000000000000012, -1.700000000000001, -2.4000000000000017, -1.8000000000000012, -1.9000000000000012, -1.9000000000000012, -2.0000000000000013, -2.0000000000000013, -1.9000000000000012, -1.9000000000000012, -2.0000000000000013, -2.0000000000000013, -1.700000000000001, -1.4000000000000008, -1.700000000000001, -1.700000000000001, -1.5000000000000009, -1.700000000000001, -1.700000000000001, -3.0000000000000018, -2.700000000000002, -1.700000000000001, -2.1000000000000014, -1.700000000000001, -1.600000000000001, -2.1000000000000014, -2.600000000000002, -2.1000000000000014, -2.3000000000000016, -2.3000000000000016, -2.0000000000000013, -1.8000000000000012, -1.4000000000000008, -2.1000000000000014, -3.5999999999999996, -2.2000000000000015, -1.700000000000001, -1.700000000000001, -2.0000000000000013, -1.5000000000000009, -2.1000000000000014, -1.9000000000000012, -2.0000000000000013, -1.700000000000001, -1.8000000000000012, -1.700000000000001, -2.2000000000000015, -2.600000000000002, -1.4000000000000008, -1.700000000000001, -2.1000000000000014, -2.3000000000000016, -2.5000000000000018, -1.600000000000001, -2.1000000000000014, -2.3000000000000016, -2.4000000000000017, -2.2000000000000015, -1.8000000000000012, -3.1000000000000014, -1.700000000000001, -2.800000000000002, -1.600000000000001, -1.8000000000000012, -2.0000000000000013, -2.2000000000000015, -2.2000000000000015, -1.5000000000000009, -2.1000000000000014, -1.9000000000000012, -2.1000000000000014, -1.4000000000000008, -2.2000000000000015, -1.8000000000000012, -1.700000000000001, -2.5000000000000018, -1.700000000000001, -1.4000000000000008, -2.700000000000002, -2.0000000000000013, -2.1000000000000014, -3.3000000000000016, -1.5000000000000009, -2.0000000000000013, -2.2000000000000015, -1.5000000000000009, -2.2000000000000015, -1.9000000000000012, -1.9000000000000012, -1.600000000000001, -1.600000000000001, -1.700000000000001, -2.800000000000002, -1.9000000000000012, -1.600000000000001, -1.8000000000000012, -4.4, -2.4000000000000017, -2.1000000000000014, -1.9000000000000012, -1.8000000000000012, -1.9000000000000012, -1.5000000000000009, -1.700000000000001, -2.4000000000000017, -2.2000000000000015, -1.4000000000000008, -1.8000000000000012, -2.3000000000000016, -1.600000000000001, -1.600000000000001, -1.9000000000000012, -1.8000000000000012, -2.0000000000000013], "episode_lengths": [25, 29, 36, 32, 32, 27, 30, 26, 30, 26, 29, 26, 37, 31, 34, 30, 28, 35, 29, 30, 30, 31, 31, 30, 30, 31, 31, 28, 25, 28, 28, 26, 28, 28, 41, 38, 28, 32, 28, 27, 32, 35, 32, 34, 34, 31, 29, 25, 32, 47, 33, 28, 28, 31, 26, 32, 30, 31, 28, 29, 28, 33, 37, 25, 28, 32, 34, 36, 27, 32, 34, 35, 33, 29, 37, 28, 39, 27, 29, 31, 33, 33, 26, 32, 30, 32, 25, 33, 29, 28, 36, 28, 25, 38, 31, 32, 40, 26, 31, 33, 26, 33, 30, 30, 27, 27, 28, 39, 30, 27, 29, 45, 35, 32, 30, 29, 30, 26, 28, 35, 33, 25, 29, 34, 27, 27, 30, 29, 31]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3070258086438194, "mean_inference_ms": 0.7240801350498903, "mean_action_processing_ms": 0.07596570300669896, "mean_env_wait_ms": 6.708058122960473, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006910257561262264, "StateBufferConnector_ms": 0.003963662672412488, "ViewRequirementAgentConnector_ms": 0.09000079576359239}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 136000, "num_agent_steps_trained": 136000, "num_env_steps_sampled": 136000, "num_env_steps_trained": 136000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 490.7182842109995, "num_env_steps_trained_throughput_per_sec": 490.7182842109995, "timesteps_total": 136000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 136000, "timers": {"training_iteration_time_ms": 7887.228, "sample_time_ms": 4363.795, "load_time_ms": 0.972, "load_throughput": 4115795.206, "learn_time_ms": 3519.116, "learn_throughput": 1136.649, "synch_weights_time_ms": 2.707}, "counters": {"num_env_steps_sampled": 136000, "num_env_steps_trained": 136000, "num_agent_steps_sampled": 136000, "num_agent_steps_trained": 136000}, "done": false, "episodes_total": 1915, "training_iteration": 34, "trial_id": "04cbf_00000", "date": "2024-03-07_13-22-21", "timestamp": 1709835741, "time_this_iter_s": 8.154308795928955, "time_total_s": 258.4151895046234, "pid": 119109, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7efea6399f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 258.4151895046234, "iterations_since_restore": 34, "perf": {"cpu_util_percent": 30.181818181818176, "ram_util_percent": 50.87272727272727, "gpu_util_percent0": 0.08363636363636363, "vram_util_percent0": 0.09165630918560606}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.10000000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 0.04138094855613896, "policy_loss": -0.007100865232848352, "vf_loss": 0.047487812280975365, "vf_explained_var": 0.9564924290744207, "kl": 0.009940024931848344, "entropy": 0.32387683726446603, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 32085.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 140000, "num_env_steps_trained": 140000, "num_agent_steps_sampled": 140000, "num_agent_steps_trained": 140000}, "sampler_results": {"episode_reward_max": -1.4000000000000008, "episode_reward_min": -3.6000000000000023, "episode_reward_mean": -1.897037037037038, "episode_len_mean": 29.94814814814815, "episode_media": {}, "episodes_this_iter": 135, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1.700000000000001, -1.700000000000001, -1.700000000000001, -2.0000000000000013, -1.8000000000000012, -2.2000000000000015, -1.8000000000000012, -2.4000000000000017, -2.0000000000000013, -2.2000000000000015, -1.9000000000000012, -1.600000000000001, -1.9000000000000012, -1.4000000000000008, -1.8000000000000012, -1.8000000000000012, -1.9000000000000012, -2.0000000000000013, -1.8000000000000012, -1.5000000000000009, -1.700000000000001, -1.8000000000000012, -1.8000000000000012, -3.5, -1.5000000000000009, -2.0000000000000013, -1.600000000000001, -1.8000000000000012, -1.9000000000000012, -1.5000000000000009, -1.5000000000000009, -1.5000000000000009, -1.9000000000000012, -1.5000000000000009, -2.3000000000000016, -1.700000000000001, -2.2000000000000015, -2.3000000000000016, -2.3000000000000016, -2.3000000000000016, -1.8000000000000012, -1.8000000000000012, -2.0000000000000013, -2.2000000000000015, -1.700000000000001, -1.8000000000000012, -2.0000000000000013, -1.9000000000000012, -1.8000000000000012, -2.1000000000000014, -1.4000000000000008, -1.9000000000000012, -1.8000000000000012, -1.8000000000000012, -2.2000000000000015, -2.3000000000000016, -1.9000000000000012, -1.600000000000001, -1.700000000000001, -2.0000000000000013, -1.600000000000001, -1.700000000000001, -1.700000000000001, -1.8000000000000012, -1.9000000000000012, -1.9000000000000012, -1.8000000000000012, -2.0000000000000013, -2.0000000000000013, -1.600000000000001, -2.3000000000000016, -1.700000000000001, -2.600000000000002, -1.9000000000000012, -2.1000000000000014, -2.1000000000000014, -1.600000000000001, -2.1000000000000014, -2.0000000000000013, -2.3000000000000016, -2.0000000000000013, -1.9000000000000012, -2.2000000000000015, -1.8000000000000012, -1.5000000000000009, -1.9000000000000012, -1.700000000000001, -1.8000000000000012, -1.4000000000000008, -2.5000000000000018, -2.3000000000000016, -2.5000000000000018, -2.0000000000000013, -2.0000000000000013, -1.8000000000000012, -1.8000000000000012, -1.8000000000000012, -2.0000000000000013, -3.6000000000000023, -1.600000000000001, -2.2000000000000015, -1.5000000000000009, -1.9000000000000012, -1.9000000000000012, -1.5000000000000009, -2.0000000000000013, -1.600000000000001, -1.700000000000001, -2.1000000000000014, -2.1000000000000014, -2.0000000000000013, -2.1000000000000014, -1.600000000000001, -1.4000000000000008, -1.9000000000000012, -1.600000000000001, -1.8000000000000012, -1.8000000000000012, -1.9000000000000012, -1.700000000000001, -2.1000000000000014, -1.600000000000001, -2.0000000000000013, -1.8000000000000012, -1.600000000000001, -2.3000000000000016, -2.1000000000000014, -1.5000000000000009, -1.700000000000001, -1.8000000000000012, -2.2000000000000015, -1.700000000000001, -2.0000000000000013, -1.700000000000001, -1.5000000000000009], "episode_lengths": [28, 28, 28, 31, 29, 33, 29, 35, 31, 33, 30, 27, 30, 25, 29, 29, 30, 31, 29, 26, 28, 29, 29, 46, 26, 31, 27, 29, 30, 26, 26, 26, 30, 26, 34, 28, 33, 34, 34, 34, 29, 29, 31, 33, 28, 29, 31, 30, 29, 32, 25, 30, 29, 29, 33, 34, 30, 27, 28, 31, 27, 28, 28, 29, 30, 30, 29, 31, 31, 27, 34, 28, 37, 30, 32, 32, 27, 32, 31, 34, 31, 30, 33, 29, 26, 30, 28, 29, 25, 36, 34, 36, 31, 31, 29, 29, 29, 31, 44, 27, 33, 26, 30, 30, 26, 31, 27, 28, 32, 32, 31, 32, 27, 25, 30, 27, 29, 29, 30, 28, 32, 27, 31, 29, 27, 34, 32, 26, 28, 29, 33, 28, 31, 28, 26]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3107853825553631, "mean_inference_ms": 0.724161811112557, "mean_action_processing_ms": 0.07593527396175365, "mean_env_wait_ms": 6.733746313955069, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006803583215784143, "StateBufferConnector_ms": 0.003943266691984954, "ViewRequirementAgentConnector_ms": 0.09047543561017071}}, "episode_reward_max": -1.4000000000000008, "episode_reward_min": -3.6000000000000023, "episode_reward_mean": -1.897037037037038, "episode_len_mean": 29.94814814814815, "episodes_this_iter": 135, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1.700000000000001, -1.700000000000001, -1.700000000000001, -2.0000000000000013, -1.8000000000000012, -2.2000000000000015, -1.8000000000000012, -2.4000000000000017, -2.0000000000000013, -2.2000000000000015, -1.9000000000000012, -1.600000000000001, -1.9000000000000012, -1.4000000000000008, -1.8000000000000012, -1.8000000000000012, -1.9000000000000012, -2.0000000000000013, -1.8000000000000012, -1.5000000000000009, -1.700000000000001, -1.8000000000000012, -1.8000000000000012, -3.5, -1.5000000000000009, -2.0000000000000013, -1.600000000000001, -1.8000000000000012, -1.9000000000000012, -1.5000000000000009, -1.5000000000000009, -1.5000000000000009, -1.9000000000000012, -1.5000000000000009, -2.3000000000000016, -1.700000000000001, -2.2000000000000015, -2.3000000000000016, -2.3000000000000016, -2.3000000000000016, -1.8000000000000012, -1.8000000000000012, -2.0000000000000013, -2.2000000000000015, -1.700000000000001, -1.8000000000000012, -2.0000000000000013, -1.9000000000000012, -1.8000000000000012, -2.1000000000000014, -1.4000000000000008, -1.9000000000000012, -1.8000000000000012, -1.8000000000000012, -2.2000000000000015, -2.3000000000000016, -1.9000000000000012, -1.600000000000001, -1.700000000000001, -2.0000000000000013, -1.600000000000001, -1.700000000000001, -1.700000000000001, -1.8000000000000012, -1.9000000000000012, -1.9000000000000012, -1.8000000000000012, -2.0000000000000013, -2.0000000000000013, -1.600000000000001, -2.3000000000000016, -1.700000000000001, -2.600000000000002, -1.9000000000000012, -2.1000000000000014, -2.1000000000000014, -1.600000000000001, -2.1000000000000014, -2.0000000000000013, -2.3000000000000016, -2.0000000000000013, -1.9000000000000012, -2.2000000000000015, -1.8000000000000012, -1.5000000000000009, -1.9000000000000012, -1.700000000000001, -1.8000000000000012, -1.4000000000000008, -2.5000000000000018, -2.3000000000000016, -2.5000000000000018, -2.0000000000000013, -2.0000000000000013, -1.8000000000000012, -1.8000000000000012, -1.8000000000000012, -2.0000000000000013, -3.6000000000000023, -1.600000000000001, -2.2000000000000015, -1.5000000000000009, -1.9000000000000012, -1.9000000000000012, -1.5000000000000009, -2.0000000000000013, -1.600000000000001, -1.700000000000001, -2.1000000000000014, -2.1000000000000014, -2.0000000000000013, -2.1000000000000014, -1.600000000000001, -1.4000000000000008, -1.9000000000000012, -1.600000000000001, -1.8000000000000012, -1.8000000000000012, -1.9000000000000012, -1.700000000000001, -2.1000000000000014, -1.600000000000001, -2.0000000000000013, -1.8000000000000012, -1.600000000000001, -2.3000000000000016, -2.1000000000000014, -1.5000000000000009, -1.700000000000001, -1.8000000000000012, -2.2000000000000015, -1.700000000000001, -2.0000000000000013, -1.700000000000001, -1.5000000000000009], "episode_lengths": [28, 28, 28, 31, 29, 33, 29, 35, 31, 33, 30, 27, 30, 25, 29, 29, 30, 31, 29, 26, 28, 29, 29, 46, 26, 31, 27, 29, 30, 26, 26, 26, 30, 26, 34, 28, 33, 34, 34, 34, 29, 29, 31, 33, 28, 29, 31, 30, 29, 32, 25, 30, 29, 29, 33, 34, 30, 27, 28, 31, 27, 28, 28, 29, 30, 30, 29, 31, 31, 27, 34, 28, 37, 30, 32, 32, 27, 32, 31, 34, 31, 30, 33, 29, 26, 30, 28, 29, 25, 36, 34, 36, 31, 31, 29, 29, 29, 31, 44, 27, 33, 26, 30, 30, 26, 31, 27, 28, 32, 32, 31, 32, 27, 25, 30, 27, 29, 29, 30, 28, 32, 27, 31, 29, 27, 34, 32, 26, 28, 29, 33, 28, 31, 28, 26]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3107853825553631, "mean_inference_ms": 0.724161811112557, "mean_action_processing_ms": 0.07593527396175365, "mean_env_wait_ms": 6.733746313955069, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006803583215784143, "StateBufferConnector_ms": 0.003943266691984954, "ViewRequirementAgentConnector_ms": 0.09047543561017071}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 140000, "num_agent_steps_trained": 140000, "num_env_steps_sampled": 140000, "num_env_steps_trained": 140000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 499.83843422956306, "num_env_steps_trained_throughput_per_sec": 499.83843422956306, "timesteps_total": 140000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 140000, "timers": {"training_iteration_time_ms": 7895.056, "sample_time_ms": 4372.195, "load_time_ms": 2.137, "load_throughput": 1871412.828, "learn_time_ms": 3517.42, "learn_throughput": 1137.197, "synch_weights_time_ms": 2.661}, "counters": {"num_env_steps_sampled": 140000, "num_env_steps_trained": 140000, "num_agent_steps_sampled": 140000, "num_agent_steps_trained": 140000}, "done": false, "episodes_total": 2050, "training_iteration": 35, "trial_id": "04cbf_00000", "date": "2024-03-07_13-22-29", "timestamp": 1709835749, "time_this_iter_s": 8.005731582641602, "time_total_s": 266.420921087265, "pid": 119109, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7efea6399f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 266.420921087265, "iterations_since_restore": 35, "perf": {"cpu_util_percent": 32.53, "ram_util_percent": 50.88, "gpu_util_percent0": 0.07200000000000001, "vram_util_percent0": 0.09165852864583332}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.10000000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 0.043159023053463426, "policy_loss": -0.008489394155881739, "vf_loss": 0.05090183968135026, "vf_explained_var": 0.9494348890678856, "kl": 0.007465765543332914, "entropy": 0.29603487621712427, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 33015.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_agent_steps_sampled": 144000, "num_agent_steps_trained": 144000}, "sampler_results": {"episode_reward_max": -1.4000000000000008, "episode_reward_min": -2.900000000000002, "episode_reward_mean": -1.880740740740742, "episode_len_mean": 29.725925925925925, "episode_media": {}, "episodes_this_iter": 135, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1.700000000000001, -1.8000000000000012, -1.5000000000000009, -1.700000000000001, -1.600000000000001, -1.5000000000000009, -2.3000000000000016, -1.8000000000000012, -1.8000000000000012, -1.5000000000000009, -1.700000000000001, -2.0000000000000013, -2.800000000000002, -1.9000000000000012, -2.600000000000002, -2.900000000000002, -1.700000000000001, -1.8000000000000012, -1.8000000000000012, -1.600000000000001, -1.8000000000000012, -1.9000000000000012, -1.9000000000000012, -1.700000000000001, -2.0000000000000013, -2.600000000000002, -1.5000000000000009, -1.5000000000000009, -1.9000000000000012, -1.700000000000001, -2.1000000000000014, -1.9000000000000012, -1.600000000000001, -1.8000000000000012, -1.700000000000001, -2.1000000000000014, -2.1000000000000014, -1.4000000000000008, -2.4000000000000017, -1.9000000000000012, -2.5000000000000018, -1.600000000000001, -2.900000000000002, -1.700000000000001, -1.9000000000000012, -2.1000000000000014, -1.8000000000000012, -1.700000000000001, -2.1000000000000014, -1.5000000000000009, -1.600000000000001, -1.8000000000000012, -1.8000000000000012, -2.1000000000000014, -1.8000000000000012, -2.3000000000000016, -1.8000000000000012, -2.0000000000000013, -2.2000000000000015, -1.4000000000000008, -2.1000000000000014, -1.5000000000000009, -2.1000000000000014, -2.0000000000000013, -2.0000000000000013, -1.4000000000000008, -2.0000000000000013, -2.0000000000000013, -2.0000000000000013, -2.0000000000000013, -1.700000000000001, -1.700000000000001, -1.600000000000001, -2.1000000000000014, -1.9000000000000012, -2.0000000000000013, -1.8000000000000012, -1.9000000000000012, -1.700000000000001, -1.9000000000000012, -1.700000000000001, -1.600000000000001, -2.5000000000000018, -1.600000000000001, -2.2000000000000015, -2.0000000000000013, -1.600000000000001, -2.1000000000000014, -1.4000000000000008, -1.600000000000001, -2.4000000000000017, -1.9000000000000012, -1.5000000000000009, -1.8000000000000012, -2.0000000000000013, -2.0000000000000013, -2.0000000000000013, -2.700000000000002, -1.600000000000001, -2.2000000000000015, -1.700000000000001, -1.700000000000001, -1.8000000000000012, -1.700000000000001, -2.1000000000000014, -2.1000000000000014, -1.700000000000001, -1.700000000000001, -1.4000000000000008, -1.9000000000000012, -1.600000000000001, -1.700000000000001, -1.600000000000001, -1.9000000000000012, -1.9000000000000012, -1.9000000000000012, -1.5000000000000009, -1.8000000000000012, -1.700000000000001, -2.1000000000000014, -2.2000000000000015, -1.5000000000000009, -1.700000000000001, -1.8000000000000012, -2.2000000000000015, -1.9000000000000012, -1.8000000000000012, -1.5000000000000009, -2.4000000000000017, -2.800000000000002, -1.8000000000000012, -2.0000000000000013, -1.5000000000000009, -2.0000000000000013, -1.4000000000000008], "episode_lengths": [28, 29, 26, 28, 27, 26, 34, 29, 29, 26, 28, 31, 39, 30, 37, 36, 28, 29, 29, 27, 29, 30, 30, 28, 31, 37, 26, 26, 30, 28, 32, 30, 27, 29, 28, 32, 32, 25, 35, 30, 36, 27, 40, 28, 30, 29, 29, 28, 32, 26, 27, 29, 29, 32, 29, 34, 29, 31, 33, 25, 32, 26, 32, 31, 31, 25, 31, 31, 31, 31, 28, 28, 27, 32, 30, 31, 29, 30, 28, 30, 28, 27, 36, 27, 33, 31, 27, 32, 25, 27, 35, 30, 26, 29, 31, 31, 31, 38, 27, 33, 28, 28, 29, 28, 32, 32, 28, 28, 25, 30, 27, 28, 27, 30, 30, 30, 26, 29, 28, 32, 33, 26, 28, 29, 33, 30, 29, 26, 31, 39, 29, 31, 26, 31, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3143143949619785, "mean_inference_ms": 0.7242433231014231, "mean_action_processing_ms": 0.0759456971240077, "mean_env_wait_ms": 6.75515472493689, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006868044535319011, "StateBufferConnector_ms": 0.003956335562246817, "ViewRequirementAgentConnector_ms": 0.08991206133807148}}, "episode_reward_max": -1.4000000000000008, "episode_reward_min": -2.900000000000002, "episode_reward_mean": -1.880740740740742, "episode_len_mean": 29.725925925925925, "episodes_this_iter": 135, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1.700000000000001, -1.8000000000000012, -1.5000000000000009, -1.700000000000001, -1.600000000000001, -1.5000000000000009, -2.3000000000000016, -1.8000000000000012, -1.8000000000000012, -1.5000000000000009, -1.700000000000001, -2.0000000000000013, -2.800000000000002, -1.9000000000000012, -2.600000000000002, -2.900000000000002, -1.700000000000001, -1.8000000000000012, -1.8000000000000012, -1.600000000000001, -1.8000000000000012, -1.9000000000000012, -1.9000000000000012, -1.700000000000001, -2.0000000000000013, -2.600000000000002, -1.5000000000000009, -1.5000000000000009, -1.9000000000000012, -1.700000000000001, -2.1000000000000014, -1.9000000000000012, -1.600000000000001, -1.8000000000000012, -1.700000000000001, -2.1000000000000014, -2.1000000000000014, -1.4000000000000008, -2.4000000000000017, -1.9000000000000012, -2.5000000000000018, -1.600000000000001, -2.900000000000002, -1.700000000000001, -1.9000000000000012, -2.1000000000000014, -1.8000000000000012, -1.700000000000001, -2.1000000000000014, -1.5000000000000009, -1.600000000000001, -1.8000000000000012, -1.8000000000000012, -2.1000000000000014, -1.8000000000000012, -2.3000000000000016, -1.8000000000000012, -2.0000000000000013, -2.2000000000000015, -1.4000000000000008, -2.1000000000000014, -1.5000000000000009, -2.1000000000000014, -2.0000000000000013, -2.0000000000000013, -1.4000000000000008, -2.0000000000000013, -2.0000000000000013, -2.0000000000000013, -2.0000000000000013, -1.700000000000001, -1.700000000000001, -1.600000000000001, -2.1000000000000014, -1.9000000000000012, -2.0000000000000013, -1.8000000000000012, -1.9000000000000012, -1.700000000000001, -1.9000000000000012, -1.700000000000001, -1.600000000000001, -2.5000000000000018, -1.600000000000001, -2.2000000000000015, -2.0000000000000013, -1.600000000000001, -2.1000000000000014, -1.4000000000000008, -1.600000000000001, -2.4000000000000017, -1.9000000000000012, -1.5000000000000009, -1.8000000000000012, -2.0000000000000013, -2.0000000000000013, -2.0000000000000013, -2.700000000000002, -1.600000000000001, -2.2000000000000015, -1.700000000000001, -1.700000000000001, -1.8000000000000012, -1.700000000000001, -2.1000000000000014, -2.1000000000000014, -1.700000000000001, -1.700000000000001, -1.4000000000000008, -1.9000000000000012, -1.600000000000001, -1.700000000000001, -1.600000000000001, -1.9000000000000012, -1.9000000000000012, -1.9000000000000012, -1.5000000000000009, -1.8000000000000012, -1.700000000000001, -2.1000000000000014, -2.2000000000000015, -1.5000000000000009, -1.700000000000001, -1.8000000000000012, -2.2000000000000015, -1.9000000000000012, -1.8000000000000012, -1.5000000000000009, -2.4000000000000017, -2.800000000000002, -1.8000000000000012, -2.0000000000000013, -1.5000000000000009, -2.0000000000000013, -1.4000000000000008], "episode_lengths": [28, 29, 26, 28, 27, 26, 34, 29, 29, 26, 28, 31, 39, 30, 37, 36, 28, 29, 29, 27, 29, 30, 30, 28, 31, 37, 26, 26, 30, 28, 32, 30, 27, 29, 28, 32, 32, 25, 35, 30, 36, 27, 40, 28, 30, 29, 29, 28, 32, 26, 27, 29, 29, 32, 29, 34, 29, 31, 33, 25, 32, 26, 32, 31, 31, 25, 31, 31, 31, 31, 28, 28, 27, 32, 30, 31, 29, 30, 28, 30, 28, 27, 36, 27, 33, 31, 27, 32, 25, 27, 35, 30, 26, 29, 31, 31, 31, 38, 27, 33, 28, 28, 29, 28, 32, 32, 28, 28, 25, 30, 27, 28, 27, 30, 30, 30, 26, 29, 28, 32, 33, 26, 28, 29, 33, 30, 29, 26, 31, 39, 29, 31, 26, 31, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3143143949619785, "mean_inference_ms": 0.7242433231014231, "mean_action_processing_ms": 0.0759456971240077, "mean_env_wait_ms": 6.75515472493689, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006868044535319011, "StateBufferConnector_ms": 0.003956335562246817, "ViewRequirementAgentConnector_ms": 0.08991206133807148}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 144000, "num_agent_steps_trained": 144000, "num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 500.53665956450976, "num_env_steps_trained_throughput_per_sec": 500.53665956450976, "timesteps_total": 144000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 144000, "timers": {"training_iteration_time_ms": 7909.634, "sample_time_ms": 4387.572, "load_time_ms": 2.138, "load_throughput": 1871037.159, "learn_time_ms": 3516.638, "learn_throughput": 1137.45, "synch_weights_time_ms": 2.645}, "counters": {"num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_agent_steps_sampled": 144000, "num_agent_steps_trained": 144000}, "done": false, "episodes_total": 2185, "training_iteration": 36, "trial_id": "04cbf_00000", "date": "2024-03-07_13-22-37", "timestamp": 1709835757, "time_this_iter_s": 7.994525671005249, "time_total_s": 274.41544675827026, "pid": 119109, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7efea6399f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 274.41544675827026, "iterations_since_restore": 36, "perf": {"cpu_util_percent": 32.459999999999994, "ram_util_percent": 50.8, "gpu_util_percent0": 0.074, "vram_util_percent0": 0.09163411458333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.10000000000000002, "cur_lr": 0.0010000000000000005, "total_loss": -0.00013045708733981336, "policy_loss": -0.019126099087698484, "vf_loss": 0.017999118372988235, "vf_explained_var": 0.9812582285173478, "kl": 0.009965228013626534, "entropy": 0.2677918965457588, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 33945.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 148000, "num_env_steps_trained": 148000, "num_agent_steps_sampled": 148000, "num_agent_steps_trained": 148000}, "sampler_results": {"episode_reward_max": -1.4000000000000008, "episode_reward_min": -2.600000000000002, "episode_reward_mean": -1.8272058823529425, "episode_len_mean": 29.272058823529413, "episode_media": {}, "episodes_this_iter": 136, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1.8000000000000012, -1.700000000000001, -2.1000000000000014, -1.9000000000000012, -2.1000000000000014, -1.5000000000000009, -1.9000000000000012, -2.4000000000000017, -1.4000000000000008, -1.5000000000000009, -1.4000000000000008, -1.700000000000001, -2.1000000000000014, -1.600000000000001, -1.600000000000001, -1.700000000000001, -1.700000000000001, -1.600000000000001, -1.700000000000001, -1.700000000000001, -1.9000000000000012, -1.8000000000000012, -1.5000000000000009, -1.8000000000000012, -2.600000000000002, -2.0000000000000013, -1.9000000000000012, -2.2000000000000015, -1.8000000000000012, -1.9000000000000012, -2.2000000000000015, -1.9000000000000012, -1.5000000000000009, -2.0000000000000013, -1.700000000000001, -2.1000000000000014, -1.5000000000000009, -1.9000000000000012, -2.3000000000000016, -1.9000000000000012, -1.4000000000000008, -2.0000000000000013, -1.8000000000000012, -1.700000000000001, -1.8000000000000012, -1.5000000000000009, -1.8000000000000012, -1.600000000000001, -1.600000000000001, -1.600000000000001, -1.700000000000001, -1.4000000000000008, -1.700000000000001, -1.600000000000001, -2.1000000000000014, -1.9000000000000012, -1.8000000000000012, -1.600000000000001, -1.9000000000000012, -2.0000000000000013, -1.700000000000001, -1.8000000000000012, -2.2000000000000015, -1.9000000000000012, -1.8000000000000012, -1.700000000000001, -2.2000000000000015, -1.600000000000001, -1.9000000000000012, -1.600000000000001, -1.9000000000000012, -1.8000000000000012, -2.3000000000000016, -2.3000000000000016, -1.5000000000000009, -1.8000000000000012, -2.1000000000000014, -1.8000000000000012, -1.5000000000000009, -2.2000000000000015, -2.0000000000000013, -1.9000000000000012, -2.1000000000000014, -1.5000000000000009, -1.700000000000001, -1.9000000000000012, -1.700000000000001, -1.9000000000000012, -2.3000000000000016, -1.600000000000001, -1.9000000000000012, -1.600000000000001, -1.5000000000000009, -2.1000000000000014, -2.4000000000000017, -2.4000000000000017, -1.9000000000000012, -2.3000000000000016, -1.9000000000000012, -1.9000000000000012, -2.4000000000000017, -1.600000000000001, -1.8000000000000012, -1.700000000000001, -1.8000000000000012, -1.9000000000000012, -1.600000000000001, -1.4000000000000008, -2.2000000000000015, -2.2000000000000015, -1.700000000000001, -1.8000000000000012, -1.5000000000000009, -1.9000000000000012, -1.5000000000000009, -1.600000000000001, -1.8000000000000012, -1.4000000000000008, -2.4000000000000017, -1.5000000000000009, -1.8000000000000012, -2.2000000000000015, -2.2000000000000015, -1.4000000000000008, -1.600000000000001, -2.0000000000000013, -1.700000000000001, -1.5000000000000009, -1.600000000000001, -1.600000000000001, -1.700000000000001, -1.8000000000000012, -1.5000000000000009, -2.1000000000000014, -1.8000000000000012, -2.2000000000000015], "episode_lengths": [29, 28, 32, 30, 32, 26, 30, 35, 25, 26, 25, 28, 32, 27, 27, 28, 28, 27, 28, 28, 30, 29, 26, 29, 37, 31, 30, 33, 29, 30, 33, 30, 26, 31, 28, 32, 26, 30, 34, 30, 25, 31, 29, 28, 29, 26, 29, 27, 27, 27, 28, 25, 28, 27, 32, 30, 29, 27, 30, 31, 28, 29, 33, 30, 29, 28, 33, 27, 30, 27, 30, 29, 34, 34, 26, 29, 32, 29, 26, 33, 31, 30, 32, 26, 28, 30, 28, 30, 34, 27, 30, 27, 26, 32, 35, 35, 30, 34, 30, 30, 35, 27, 29, 28, 29, 30, 27, 25, 33, 33, 28, 29, 26, 30, 26, 27, 29, 25, 35, 26, 29, 33, 33, 25, 27, 31, 28, 26, 27, 27, 28, 29, 26, 32, 29, 33]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3177713802159427, "mean_inference_ms": 0.7243740598118502, "mean_action_processing_ms": 0.07591836661333583, "mean_env_wait_ms": 6.780198119417788, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006912911639494055, "StateBufferConnector_ms": 0.004005081513348748, "ViewRequirementAgentConnector_ms": 0.08998706060297348}}, "episode_reward_max": -1.4000000000000008, "episode_reward_min": -2.600000000000002, "episode_reward_mean": -1.8272058823529425, "episode_len_mean": 29.272058823529413, "episodes_this_iter": 136, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1.8000000000000012, -1.700000000000001, -2.1000000000000014, -1.9000000000000012, -2.1000000000000014, -1.5000000000000009, -1.9000000000000012, -2.4000000000000017, -1.4000000000000008, -1.5000000000000009, -1.4000000000000008, -1.700000000000001, -2.1000000000000014, -1.600000000000001, -1.600000000000001, -1.700000000000001, -1.700000000000001, -1.600000000000001, -1.700000000000001, -1.700000000000001, -1.9000000000000012, -1.8000000000000012, -1.5000000000000009, -1.8000000000000012, -2.600000000000002, -2.0000000000000013, -1.9000000000000012, -2.2000000000000015, -1.8000000000000012, -1.9000000000000012, -2.2000000000000015, -1.9000000000000012, -1.5000000000000009, -2.0000000000000013, -1.700000000000001, -2.1000000000000014, -1.5000000000000009, -1.9000000000000012, -2.3000000000000016, -1.9000000000000012, -1.4000000000000008, -2.0000000000000013, -1.8000000000000012, -1.700000000000001, -1.8000000000000012, -1.5000000000000009, -1.8000000000000012, -1.600000000000001, -1.600000000000001, -1.600000000000001, -1.700000000000001, -1.4000000000000008, -1.700000000000001, -1.600000000000001, -2.1000000000000014, -1.9000000000000012, -1.8000000000000012, -1.600000000000001, -1.9000000000000012, -2.0000000000000013, -1.700000000000001, -1.8000000000000012, -2.2000000000000015, -1.9000000000000012, -1.8000000000000012, -1.700000000000001, -2.2000000000000015, -1.600000000000001, -1.9000000000000012, -1.600000000000001, -1.9000000000000012, -1.8000000000000012, -2.3000000000000016, -2.3000000000000016, -1.5000000000000009, -1.8000000000000012, -2.1000000000000014, -1.8000000000000012, -1.5000000000000009, -2.2000000000000015, -2.0000000000000013, -1.9000000000000012, -2.1000000000000014, -1.5000000000000009, -1.700000000000001, -1.9000000000000012, -1.700000000000001, -1.9000000000000012, -2.3000000000000016, -1.600000000000001, -1.9000000000000012, -1.600000000000001, -1.5000000000000009, -2.1000000000000014, -2.4000000000000017, -2.4000000000000017, -1.9000000000000012, -2.3000000000000016, -1.9000000000000012, -1.9000000000000012, -2.4000000000000017, -1.600000000000001, -1.8000000000000012, -1.700000000000001, -1.8000000000000012, -1.9000000000000012, -1.600000000000001, -1.4000000000000008, -2.2000000000000015, -2.2000000000000015, -1.700000000000001, -1.8000000000000012, -1.5000000000000009, -1.9000000000000012, -1.5000000000000009, -1.600000000000001, -1.8000000000000012, -1.4000000000000008, -2.4000000000000017, -1.5000000000000009, -1.8000000000000012, -2.2000000000000015, -2.2000000000000015, -1.4000000000000008, -1.600000000000001, -2.0000000000000013, -1.700000000000001, -1.5000000000000009, -1.600000000000001, -1.600000000000001, -1.700000000000001, -1.8000000000000012, -1.5000000000000009, -2.1000000000000014, -1.8000000000000012, -2.2000000000000015], "episode_lengths": [29, 28, 32, 30, 32, 26, 30, 35, 25, 26, 25, 28, 32, 27, 27, 28, 28, 27, 28, 28, 30, 29, 26, 29, 37, 31, 30, 33, 29, 30, 33, 30, 26, 31, 28, 32, 26, 30, 34, 30, 25, 31, 29, 28, 29, 26, 29, 27, 27, 27, 28, 25, 28, 27, 32, 30, 29, 27, 30, 31, 28, 29, 33, 30, 29, 28, 33, 27, 30, 27, 30, 29, 34, 34, 26, 29, 32, 29, 26, 33, 31, 30, 32, 26, 28, 30, 28, 30, 34, 27, 30, 27, 26, 32, 35, 35, 30, 34, 30, 30, 35, 27, 29, 28, 29, 30, 27, 25, 33, 33, 28, 29, 26, 30, 26, 27, 29, 25, 35, 26, 29, 33, 33, 25, 27, 31, 28, 26, 27, 27, 28, 29, 26, 32, 29, 33]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3177713802159427, "mean_inference_ms": 0.7243740598118502, "mean_action_processing_ms": 0.07591836661333583, "mean_env_wait_ms": 6.780198119417788, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006912911639494055, "StateBufferConnector_ms": 0.004005081513348748, "ViewRequirementAgentConnector_ms": 0.08998706060297348}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 148000, "num_agent_steps_trained": 148000, "num_env_steps_sampled": 148000, "num_env_steps_trained": 148000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 477.9840699479099, "num_env_steps_trained_throughput_per_sec": 477.9840699479099, "timesteps_total": 148000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 148000, "timers": {"training_iteration_time_ms": 7975.289, "sample_time_ms": 4444.282, "load_time_ms": 2.151, "load_throughput": 1859878.057, "learn_time_ms": 3525.603, "learn_throughput": 1134.558, "synch_weights_time_ms": 2.609}, "counters": {"num_env_steps_sampled": 148000, "num_env_steps_trained": 148000, "num_agent_steps_sampled": 148000, "num_agent_steps_trained": 148000}, "done": false, "episodes_total": 2321, "training_iteration": 37, "trial_id": "04cbf_00000", "date": "2024-03-07_13-22-45", "timestamp": 1709835765, "time_this_iter_s": 8.371439695358276, "time_total_s": 282.78688645362854, "pid": 119109, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7efea6399f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 282.78688645362854, "iterations_since_restore": 37, "perf": {"cpu_util_percent": 31.08181818181818, "ram_util_percent": 50.82727272727272, "gpu_util_percent0": 0.07818181818181819, "vram_util_percent0": 0.09165630918560606}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.10000000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 0.2530991399240735, "policy_loss": -0.011154429446304999, "vf_loss": 0.26240085549877895, "vf_explained_var": 0.9162066833947294, "kl": 0.01852715560022282, "entropy": 0.22515878441032544, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 34875.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 152000, "num_env_steps_trained": 152000, "num_agent_steps_sampled": 152000, "num_agent_steps_trained": 152000}, "sampler_results": {"episode_reward_max": -1.4000000000000008, "episode_reward_min": -21.799999999999976, "episode_reward_mean": -1.9214814814814822, "episode_len_mean": 29.340740740740742, "episode_media": {}, "episodes_this_iter": 135, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2.2000000000000015, -1.600000000000001, -1.5000000000000009, -1.5000000000000009, -1.9000000000000012, -1.9000000000000012, -1.9000000000000012, -1.4000000000000008, -1.8000000000000012, -21.799999999999976, -1.5000000000000009, -2.600000000000002, -1.700000000000001, -1.5000000000000009, -2.3000000000000016, -1.8000000000000012, -1.8000000000000012, -1.8000000000000012, -2.600000000000002, -1.9000000000000012, -1.8000000000000012, -1.8000000000000012, -1.5000000000000009, -1.700000000000001, -2.0000000000000013, -2.5000000000000018, -1.4000000000000008, -2.3000000000000016, -1.8000000000000012, -1.700000000000001, -1.4000000000000008, -1.700000000000001, -1.600000000000001, -1.5000000000000009, -1.5000000000000009, -1.9000000000000012, -1.5000000000000009, -1.4000000000000008, -1.600000000000001, -1.8000000000000012, -1.9000000000000012, -1.600000000000001, -1.5000000000000009, -2.2000000000000015, -1.600000000000001, -2.0000000000000013, -2.1000000000000014, -2.3000000000000016, -1.700000000000001, -1.8000000000000012, -1.4000000000000008, -1.9000000000000012, -1.4000000000000008, -1.9000000000000012, -1.5000000000000009, -1.9000000000000012, -1.5000000000000009, -1.9000000000000012, -1.5000000000000009, -1.9000000000000012, -1.5000000000000009, -1.4000000000000008, -1.5000000000000009, -1.9000000000000012, -2.0000000000000013, -1.8000000000000012, -2.900000000000002, -1.600000000000001, -1.600000000000001, -1.8000000000000012, -1.700000000000001, -1.600000000000001, -1.8000000000000012, -3.0000000000000018, -1.600000000000001, -1.8000000000000012, -1.4000000000000008, -1.5000000000000009, -1.600000000000001, -2.3000000000000016, -1.5000000000000009, -1.9000000000000012, -1.5000000000000009, -1.700000000000001, -2.3000000000000016, -1.700000000000001, -2.0000000000000013, -1.5000000000000009, -1.5000000000000009, -1.8000000000000012, -1.9000000000000012, -1.700000000000001, -1.600000000000001, -1.700000000000001, -1.700000000000001, -1.4000000000000008, -2.2000000000000015, -1.9000000000000012, -1.8000000000000012, -1.600000000000001, -1.700000000000001, -2.0000000000000013, -1.8000000000000012, -1.5000000000000009, -1.5000000000000009, -1.700000000000001, -1.600000000000001, -1.700000000000001, -1.600000000000001, -1.9000000000000012, -2.2000000000000015, -1.4000000000000008, -1.600000000000001, -1.600000000000001, -2.4000000000000017, -2.2000000000000015, -2.3000000000000016, -1.5000000000000009, -2.2000000000000015, -1.5000000000000009, -1.8000000000000012, -1.600000000000001, -1.5000000000000009, -1.5000000000000009, -1.8000000000000012, -1.5000000000000009, -1.5000000000000009, -1.600000000000001, -1.600000000000001, -1.5000000000000009, -2.3000000000000016, -2.0000000000000013, -2.0000000000000013, -1.8000000000000012, -1.4000000000000008], "episode_lengths": [33, 27, 26, 26, 30, 30, 30, 25, 29, 124, 26, 37, 28, 26, 34, 29, 29, 29, 33, 30, 29, 29, 26, 28, 31, 36, 25, 34, 29, 28, 25, 28, 27, 26, 26, 30, 26, 25, 27, 29, 30, 27, 26, 33, 27, 31, 32, 34, 28, 29, 25, 30, 25, 30, 26, 30, 26, 30, 26, 30, 26, 25, 26, 30, 31, 29, 38, 27, 27, 29, 28, 27, 29, 34, 27, 29, 25, 26, 27, 34, 26, 30, 26, 28, 34, 28, 31, 26, 26, 29, 30, 28, 27, 28, 28, 25, 33, 30, 29, 27, 28, 31, 29, 26, 26, 28, 27, 28, 27, 30, 33, 25, 27, 27, 35, 33, 34, 26, 33, 26, 29, 27, 26, 26, 29, 26, 26, 27, 27, 26, 34, 31, 31, 29, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.32127547634534703, "mean_inference_ms": 0.7245598064061286, "mean_action_processing_ms": 0.07599057926074569, "mean_env_wait_ms": 6.8034028139866445, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006944691693341291, "StateBufferConnector_ms": 0.003976115473994502, "ViewRequirementAgentConnector_ms": 0.09079191419813368}}, "episode_reward_max": -1.4000000000000008, "episode_reward_min": -21.799999999999976, "episode_reward_mean": -1.9214814814814822, "episode_len_mean": 29.340740740740742, "episodes_this_iter": 135, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-2.2000000000000015, -1.600000000000001, -1.5000000000000009, -1.5000000000000009, -1.9000000000000012, -1.9000000000000012, -1.9000000000000012, -1.4000000000000008, -1.8000000000000012, -21.799999999999976, -1.5000000000000009, -2.600000000000002, -1.700000000000001, -1.5000000000000009, -2.3000000000000016, -1.8000000000000012, -1.8000000000000012, -1.8000000000000012, -2.600000000000002, -1.9000000000000012, -1.8000000000000012, -1.8000000000000012, -1.5000000000000009, -1.700000000000001, -2.0000000000000013, -2.5000000000000018, -1.4000000000000008, -2.3000000000000016, -1.8000000000000012, -1.700000000000001, -1.4000000000000008, -1.700000000000001, -1.600000000000001, -1.5000000000000009, -1.5000000000000009, -1.9000000000000012, -1.5000000000000009, -1.4000000000000008, -1.600000000000001, -1.8000000000000012, -1.9000000000000012, -1.600000000000001, -1.5000000000000009, -2.2000000000000015, -1.600000000000001, -2.0000000000000013, -2.1000000000000014, -2.3000000000000016, -1.700000000000001, -1.8000000000000012, -1.4000000000000008, -1.9000000000000012, -1.4000000000000008, -1.9000000000000012, -1.5000000000000009, -1.9000000000000012, -1.5000000000000009, -1.9000000000000012, -1.5000000000000009, -1.9000000000000012, -1.5000000000000009, -1.4000000000000008, -1.5000000000000009, -1.9000000000000012, -2.0000000000000013, -1.8000000000000012, -2.900000000000002, -1.600000000000001, -1.600000000000001, -1.8000000000000012, -1.700000000000001, -1.600000000000001, -1.8000000000000012, -3.0000000000000018, -1.600000000000001, -1.8000000000000012, -1.4000000000000008, -1.5000000000000009, -1.600000000000001, -2.3000000000000016, -1.5000000000000009, -1.9000000000000012, -1.5000000000000009, -1.700000000000001, -2.3000000000000016, -1.700000000000001, -2.0000000000000013, -1.5000000000000009, -1.5000000000000009, -1.8000000000000012, -1.9000000000000012, -1.700000000000001, -1.600000000000001, -1.700000000000001, -1.700000000000001, -1.4000000000000008, -2.2000000000000015, -1.9000000000000012, -1.8000000000000012, -1.600000000000001, -1.700000000000001, -2.0000000000000013, -1.8000000000000012, -1.5000000000000009, -1.5000000000000009, -1.700000000000001, -1.600000000000001, -1.700000000000001, -1.600000000000001, -1.9000000000000012, -2.2000000000000015, -1.4000000000000008, -1.600000000000001, -1.600000000000001, -2.4000000000000017, -2.2000000000000015, -2.3000000000000016, -1.5000000000000009, -2.2000000000000015, -1.5000000000000009, -1.8000000000000012, -1.600000000000001, -1.5000000000000009, -1.5000000000000009, -1.8000000000000012, -1.5000000000000009, -1.5000000000000009, -1.600000000000001, -1.600000000000001, -1.5000000000000009, -2.3000000000000016, -2.0000000000000013, -2.0000000000000013, -1.8000000000000012, -1.4000000000000008], "episode_lengths": [33, 27, 26, 26, 30, 30, 30, 25, 29, 124, 26, 37, 28, 26, 34, 29, 29, 29, 33, 30, 29, 29, 26, 28, 31, 36, 25, 34, 29, 28, 25, 28, 27, 26, 26, 30, 26, 25, 27, 29, 30, 27, 26, 33, 27, 31, 32, 34, 28, 29, 25, 30, 25, 30, 26, 30, 26, 30, 26, 30, 26, 25, 26, 30, 31, 29, 38, 27, 27, 29, 28, 27, 29, 34, 27, 29, 25, 26, 27, 34, 26, 30, 26, 28, 34, 28, 31, 26, 26, 29, 30, 28, 27, 28, 28, 25, 33, 30, 29, 27, 28, 31, 29, 26, 26, 28, 27, 28, 27, 30, 33, 25, 27, 27, 35, 33, 34, 26, 33, 26, 29, 27, 26, 26, 29, 26, 26, 27, 27, 26, 34, 31, 31, 29, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.32127547634534703, "mean_inference_ms": 0.7245598064061286, "mean_action_processing_ms": 0.07599057926074569, "mean_env_wait_ms": 6.8034028139866445, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006944691693341291, "StateBufferConnector_ms": 0.003976115473994502, "ViewRequirementAgentConnector_ms": 0.09079191419813368}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 152000, "num_agent_steps_trained": 152000, "num_env_steps_sampled": 152000, "num_env_steps_trained": 152000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 491.0961466177546, "num_env_steps_trained_throughput_per_sec": 491.0961466177546, "timesteps_total": 152000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 152000, "timers": {"training_iteration_time_ms": 8011.282, "sample_time_ms": 4477.587, "load_time_ms": 2.141, "load_throughput": 1868474.123, "learn_time_ms": 3528.288, "learn_throughput": 1133.694, "synch_weights_time_ms": 2.623}, "counters": {"num_env_steps_sampled": 152000, "num_env_steps_trained": 152000, "num_agent_steps_sampled": 152000, "num_agent_steps_trained": 152000}, "done": false, "episodes_total": 2456, "training_iteration": 38, "trial_id": "04cbf_00000", "date": "2024-03-07_13-22-54", "timestamp": 1709835774, "time_this_iter_s": 8.148153066635132, "time_total_s": 290.9350395202637, "pid": 119109, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7efea6399f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 290.9350395202637, "iterations_since_restore": 38, "perf": {"cpu_util_percent": 31.154545454545453, "ram_util_percent": 50.881818181818176, "gpu_util_percent0": 0.08636363636363636, "vram_util_percent0": 0.09165630918560606}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.10000000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 0.26273768133138337, "policy_loss": -0.01123985847037646, "vf_loss": 0.2722312742974409, "vf_explained_var": 0.8465975146780732, "kl": 0.017462668013193055, "entropy": 0.2633407897766559, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 35805.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 156000, "num_env_steps_trained": 156000, "num_agent_steps_sampled": 156000, "num_agent_steps_trained": 156000}, "sampler_results": {"episode_reward_max": -1.4000000000000008, "episode_reward_min": -9.299999999999997, "episode_reward_mean": -1.9649253731343292, "episode_len_mean": 30.05223880597015, "episode_media": {}, "episodes_this_iter": 134, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1.700000000000001, -1.5000000000000009, -4.699999999999996, -1.600000000000001, -3.799999999999999, -3.0000000000000018, -2.4000000000000017, -1.700000000000001, -1.600000000000001, -1.700000000000001, -1.600000000000001, -1.700000000000001, -3.1000000000000014, -1.5000000000000009, -1.600000000000001, -2.3000000000000016, -2.1000000000000014, -1.8000000000000012, -1.4000000000000008, -1.4000000000000008, -2.3000000000000016, -1.5000000000000009, -1.600000000000001, -1.8000000000000012, -1.5000000000000009, -1.600000000000001, -1.700000000000001, -2.1000000000000014, -2.0000000000000013, -1.600000000000001, -1.9000000000000012, -1.700000000000001, -1.5000000000000009, -1.5000000000000009, -1.9000000000000012, -1.700000000000001, -3.5999999999999996, -2.2000000000000015, -1.600000000000001, -1.9000000000000012, -2.0000000000000013, -1.5000000000000009, -1.9000000000000012, -1.5000000000000009, -1.9000000000000012, -2.3000000000000016, -1.700000000000001, -1.5000000000000009, -1.8000000000000012, -1.600000000000001, -1.5000000000000009, -1.5000000000000009, -1.9000000000000012, -1.5000000000000009, -2.1000000000000014, -1.8000000000000012, -1.8000000000000012, -1.4000000000000008, -1.600000000000001, -1.8000000000000012, -1.600000000000001, -1.5000000000000009, -1.8000000000000012, -1.8000000000000012, -1.600000000000001, -2.0000000000000013, -1.4000000000000008, -1.4000000000000008, -1.4000000000000008, -9.299999999999997, -1.700000000000001, -1.5000000000000009, -1.600000000000001, -1.9000000000000012, -2.1000000000000014, -1.700000000000001, -1.700000000000001, -1.600000000000001, -2.0000000000000013, -1.8000000000000012, -1.9000000000000012, -1.8000000000000012, -2.3000000000000016, -1.600000000000001, -2.0000000000000013, -2.5000000000000018, -1.700000000000001, -1.600000000000001, -3.4000000000000004, -1.8000000000000012, -2.700000000000002, -1.8000000000000012, -1.9000000000000012, -1.600000000000001, -1.600000000000001, -1.5000000000000009, -1.5000000000000009, -1.5000000000000009, -1.700000000000001, -1.5000000000000009, -2.1000000000000014, -5.399999999999993, -2.5000000000000018, -1.5000000000000009, -1.4000000000000008, -2.0000000000000013, -2.2000000000000015, -1.8000000000000012, -1.700000000000001, -1.700000000000001, -1.5000000000000009, -1.700000000000001, -1.700000000000001, -2.2000000000000015, -1.600000000000001, -4.800000000000001, -1.700000000000001, -2.1000000000000014, -2.0000000000000013, -1.700000000000001, -1.9000000000000012, -2.0000000000000013, -1.9000000000000012, -2.1000000000000014, -2.1000000000000014, -2.0000000000000013, -2.3000000000000016, -1.700000000000001, -1.600000000000001, -1.4000000000000008, -2.0000000000000013, -2.0000000000000013, -1.8000000000000012, -1.9000000000000012], "episode_lengths": [28, 26, 52, 27, 45, 34, 35, 28, 27, 28, 27, 28, 36, 26, 27, 34, 32, 29, 25, 25, 34, 26, 27, 29, 26, 27, 28, 32, 31, 27, 30, 28, 26, 26, 30, 28, 47, 33, 27, 30, 31, 26, 30, 26, 30, 34, 28, 26, 29, 27, 26, 26, 30, 26, 32, 29, 29, 25, 27, 29, 27, 26, 29, 29, 27, 31, 25, 25, 25, 62, 28, 26, 27, 30, 32, 28, 28, 27, 29, 29, 30, 29, 34, 27, 31, 36, 28, 27, 44, 29, 38, 29, 30, 27, 27, 26, 26, 26, 28, 26, 32, 65, 36, 26, 25, 31, 33, 29, 28, 28, 26, 28, 28, 33, 27, 47, 28, 32, 31, 28, 30, 31, 30, 32, 32, 31, 34, 28, 27, 25, 31, 31, 29, 30]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.324259178092817, "mean_inference_ms": 0.7247692531390261, "mean_action_processing_ms": 0.07598234830019149, "mean_env_wait_ms": 6.831657577051309, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0069680498607123074, "StateBufferConnector_ms": 0.0040095243880997845, "ViewRequirementAgentConnector_ms": 0.09081114583940648}}, "episode_reward_max": -1.4000000000000008, "episode_reward_min": -9.299999999999997, "episode_reward_mean": -1.9649253731343292, "episode_len_mean": 30.05223880597015, "episodes_this_iter": 134, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1.700000000000001, -1.5000000000000009, -4.699999999999996, -1.600000000000001, -3.799999999999999, -3.0000000000000018, -2.4000000000000017, -1.700000000000001, -1.600000000000001, -1.700000000000001, -1.600000000000001, -1.700000000000001, -3.1000000000000014, -1.5000000000000009, -1.600000000000001, -2.3000000000000016, -2.1000000000000014, -1.8000000000000012, -1.4000000000000008, -1.4000000000000008, -2.3000000000000016, -1.5000000000000009, -1.600000000000001, -1.8000000000000012, -1.5000000000000009, -1.600000000000001, -1.700000000000001, -2.1000000000000014, -2.0000000000000013, -1.600000000000001, -1.9000000000000012, -1.700000000000001, -1.5000000000000009, -1.5000000000000009, -1.9000000000000012, -1.700000000000001, -3.5999999999999996, -2.2000000000000015, -1.600000000000001, -1.9000000000000012, -2.0000000000000013, -1.5000000000000009, -1.9000000000000012, -1.5000000000000009, -1.9000000000000012, -2.3000000000000016, -1.700000000000001, -1.5000000000000009, -1.8000000000000012, -1.600000000000001, -1.5000000000000009, -1.5000000000000009, -1.9000000000000012, -1.5000000000000009, -2.1000000000000014, -1.8000000000000012, -1.8000000000000012, -1.4000000000000008, -1.600000000000001, -1.8000000000000012, -1.600000000000001, -1.5000000000000009, -1.8000000000000012, -1.8000000000000012, -1.600000000000001, -2.0000000000000013, -1.4000000000000008, -1.4000000000000008, -1.4000000000000008, -9.299999999999997, -1.700000000000001, -1.5000000000000009, -1.600000000000001, -1.9000000000000012, -2.1000000000000014, -1.700000000000001, -1.700000000000001, -1.600000000000001, -2.0000000000000013, -1.8000000000000012, -1.9000000000000012, -1.8000000000000012, -2.3000000000000016, -1.600000000000001, -2.0000000000000013, -2.5000000000000018, -1.700000000000001, -1.600000000000001, -3.4000000000000004, -1.8000000000000012, -2.700000000000002, -1.8000000000000012, -1.9000000000000012, -1.600000000000001, -1.600000000000001, -1.5000000000000009, -1.5000000000000009, -1.5000000000000009, -1.700000000000001, -1.5000000000000009, -2.1000000000000014, -5.399999999999993, -2.5000000000000018, -1.5000000000000009, -1.4000000000000008, -2.0000000000000013, -2.2000000000000015, -1.8000000000000012, -1.700000000000001, -1.700000000000001, -1.5000000000000009, -1.700000000000001, -1.700000000000001, -2.2000000000000015, -1.600000000000001, -4.800000000000001, -1.700000000000001, -2.1000000000000014, -2.0000000000000013, -1.700000000000001, -1.9000000000000012, -2.0000000000000013, -1.9000000000000012, -2.1000000000000014, -2.1000000000000014, -2.0000000000000013, -2.3000000000000016, -1.700000000000001, -1.600000000000001, -1.4000000000000008, -2.0000000000000013, -2.0000000000000013, -1.8000000000000012, -1.9000000000000012], "episode_lengths": [28, 26, 52, 27, 45, 34, 35, 28, 27, 28, 27, 28, 36, 26, 27, 34, 32, 29, 25, 25, 34, 26, 27, 29, 26, 27, 28, 32, 31, 27, 30, 28, 26, 26, 30, 28, 47, 33, 27, 30, 31, 26, 30, 26, 30, 34, 28, 26, 29, 27, 26, 26, 30, 26, 32, 29, 29, 25, 27, 29, 27, 26, 29, 29, 27, 31, 25, 25, 25, 62, 28, 26, 27, 30, 32, 28, 28, 27, 29, 29, 30, 29, 34, 27, 31, 36, 28, 27, 44, 29, 38, 29, 30, 27, 27, 26, 26, 26, 28, 26, 32, 65, 36, 26, 25, 31, 33, 29, 28, 28, 26, 28, 28, 33, 27, 47, 28, 32, 31, 28, 30, 31, 30, 32, 32, 31, 34, 28, 27, 25, 31, 31, 29, 30]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.324259178092817, "mean_inference_ms": 0.7247692531390261, "mean_action_processing_ms": 0.07598234830019149, "mean_env_wait_ms": 6.831657577051309, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0069680498607123074, "StateBufferConnector_ms": 0.0040095243880997845, "ViewRequirementAgentConnector_ms": 0.09081114583940648}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 156000, "num_agent_steps_trained": 156000, "num_env_steps_sampled": 156000, "num_env_steps_trained": 156000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 478.9563664577389, "num_env_steps_trained_throughput_per_sec": 478.9563664577389, "timesteps_total": 156000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 156000, "timers": {"training_iteration_time_ms": 8060.343, "sample_time_ms": 4535.353, "load_time_ms": 2.141, "load_throughput": 1868578.175, "learn_time_ms": 3519.638, "learn_throughput": 1136.481, "synch_weights_time_ms": 2.566}, "counters": {"num_env_steps_sampled": 156000, "num_env_steps_trained": 156000, "num_agent_steps_sampled": 156000, "num_agent_steps_trained": 156000}, "done": false, "episodes_total": 2590, "training_iteration": 39, "trial_id": "04cbf_00000", "date": "2024-03-07_13-23-02", "timestamp": 1709835782, "time_this_iter_s": 8.354544639587402, "time_total_s": 299.2895841598511, "pid": 119109, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7efea6399f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 299.2895841598511, "iterations_since_restore": 39, "perf": {"cpu_util_percent": 31.00909090909091, "ram_util_percent": 50.881818181818176, "gpu_util_percent0": 0.08363636363636365, "vram_util_percent0": 0.09165630918560606}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.10000000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 0.42710405619945174, "policy_loss": -0.01472557147824636, "vf_loss": 0.4399193893527232, "vf_explained_var": 0.8058497210984589, "kl": 0.019102377188499844, "entropy": 0.2529130637165039, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 36735.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 160000, "num_env_steps_trained": 160000, "num_agent_steps_sampled": 160000, "num_agent_steps_trained": 160000}, "sampler_results": {"episode_reward_max": -1.4000000000000008, "episode_reward_min": -10.299999999999976, "episode_reward_mean": -1.9044776119402993, "episode_len_mean": 29.888059701492537, "episode_media": {}, "episodes_this_iter": 134, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1.9000000000000012, -1.4000000000000008, -1.9000000000000012, -1.9000000000000012, -1.5000000000000009, -1.700000000000001, -1.9000000000000012, -1.700000000000001, -1.700000000000001, -1.600000000000001, -1.700000000000001, -2.0000000000000013, -1.8000000000000012, -1.8000000000000012, -1.5000000000000009, -1.8000000000000012, -1.8000000000000012, -1.8000000000000012, -1.600000000000001, -1.8000000000000012, -1.4000000000000008, -2.2000000000000015, -1.5000000000000009, -2.1000000000000014, -1.700000000000001, -1.8000000000000012, -1.4000000000000008, -1.700000000000001, -1.5000000000000009, -1.5000000000000009, -2.0000000000000013, -1.4000000000000008, -1.8000000000000012, -1.700000000000001, -5.400000000000004, -1.600000000000001, -1.8000000000000012, -1.600000000000001, -1.4000000000000008, -2.700000000000002, -1.8000000000000012, -1.5000000000000009, -1.4000000000000008, -2.1000000000000014, -2.2000000000000015, -1.9000000000000012, -2.3000000000000016, -1.4000000000000008, -1.8000000000000012, -2.3000000000000016, -2.2000000000000015, -1.700000000000001, -1.9000000000000012, -2.600000000000002, -1.600000000000001, -2.0000000000000013, -1.9000000000000012, -1.5000000000000009, -1.8000000000000012, -1.5000000000000009, -1.4000000000000008, -1.4000000000000008, -10.299999999999976, -1.600000000000001, -1.700000000000001, -2.1000000000000014, -1.5000000000000009, -1.5000000000000009, -1.9000000000000012, -1.5000000000000009, -1.5000000000000009, -1.700000000000001, -1.700000000000001, -1.700000000000001, -1.9000000000000012, -1.600000000000001, -1.700000000000001, -1.600000000000001, -2.0000000000000013, -1.600000000000001, -1.600000000000001, -1.5000000000000009, -1.9000000000000012, -1.8000000000000012, -1.4000000000000008, -1.600000000000001, -7.399999999999986, -2.0000000000000013, -1.5000000000000009, -1.4000000000000008, -1.700000000000001, -1.5000000000000009, -1.9000000000000012, -2.0000000000000013, -1.700000000000001, -1.600000000000001, -2.0000000000000013, -1.9000000000000012, -2.700000000000002, -1.8000000000000012, -1.4000000000000008, -1.4000000000000008, -1.700000000000001, -2.1000000000000014, -2.5000000000000018, -2.3000000000000016, -1.4000000000000008, -1.4000000000000008, -2.1000000000000014, -1.8000000000000012, -1.700000000000001, -1.5000000000000009, -1.600000000000001, -1.9000000000000012, -1.8000000000000012, -1.600000000000001, -2.0000000000000013, -1.8000000000000012, -2.0000000000000013, -2.4000000000000017, -1.8000000000000012, -2.0000000000000013, -1.600000000000001, -2.3000000000000016, -1.600000000000001, -1.8000000000000012, -2.0000000000000013, -1.9000000000000012, -2.1000000000000014, -1.5000000000000009, -1.5000000000000009, -1.5000000000000009, -1.700000000000001, -2.3000000000000016], "episode_lengths": [30, 25, 30, 30, 26, 28, 30, 28, 28, 27, 28, 31, 29, 29, 26, 29, 29, 29, 27, 29, 25, 33, 26, 32, 28, 29, 25, 28, 26, 26, 30, 25, 29, 28, 46, 27, 29, 27, 25, 38, 29, 26, 25, 32, 33, 30, 34, 25, 29, 34, 33, 28, 30, 37, 27, 31, 30, 26, 29, 26, 25, 25, 113, 27, 28, 32, 26, 26, 30, 26, 26, 28, 28, 28, 30, 27, 28, 27, 31, 27, 27, 26, 30, 29, 25, 27, 85, 31, 26, 25, 28, 26, 30, 31, 28, 27, 31, 30, 38, 29, 25, 25, 28, 32, 36, 34, 25, 25, 32, 29, 28, 26, 27, 30, 29, 27, 31, 29, 31, 35, 29, 31, 27, 34, 27, 29, 31, 30, 32, 26, 26, 26, 28, 34]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.327118037142515, "mean_inference_ms": 0.7268696603978368, "mean_action_processing_ms": 0.07594575078612967, "mean_env_wait_ms": 6.856706581366, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0069463430945553, "StateBufferConnector_ms": 0.004031231154256792, "ViewRequirementAgentConnector_ms": 0.09107643098973517}}, "episode_reward_max": -1.4000000000000008, "episode_reward_min": -10.299999999999976, "episode_reward_mean": -1.9044776119402993, "episode_len_mean": 29.888059701492537, "episodes_this_iter": 134, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1.9000000000000012, -1.4000000000000008, -1.9000000000000012, -1.9000000000000012, -1.5000000000000009, -1.700000000000001, -1.9000000000000012, -1.700000000000001, -1.700000000000001, -1.600000000000001, -1.700000000000001, -2.0000000000000013, -1.8000000000000012, -1.8000000000000012, -1.5000000000000009, -1.8000000000000012, -1.8000000000000012, -1.8000000000000012, -1.600000000000001, -1.8000000000000012, -1.4000000000000008, -2.2000000000000015, -1.5000000000000009, -2.1000000000000014, -1.700000000000001, -1.8000000000000012, -1.4000000000000008, -1.700000000000001, -1.5000000000000009, -1.5000000000000009, -2.0000000000000013, -1.4000000000000008, -1.8000000000000012, -1.700000000000001, -5.400000000000004, -1.600000000000001, -1.8000000000000012, -1.600000000000001, -1.4000000000000008, -2.700000000000002, -1.8000000000000012, -1.5000000000000009, -1.4000000000000008, -2.1000000000000014, -2.2000000000000015, -1.9000000000000012, -2.3000000000000016, -1.4000000000000008, -1.8000000000000012, -2.3000000000000016, -2.2000000000000015, -1.700000000000001, -1.9000000000000012, -2.600000000000002, -1.600000000000001, -2.0000000000000013, -1.9000000000000012, -1.5000000000000009, -1.8000000000000012, -1.5000000000000009, -1.4000000000000008, -1.4000000000000008, -10.299999999999976, -1.600000000000001, -1.700000000000001, -2.1000000000000014, -1.5000000000000009, -1.5000000000000009, -1.9000000000000012, -1.5000000000000009, -1.5000000000000009, -1.700000000000001, -1.700000000000001, -1.700000000000001, -1.9000000000000012, -1.600000000000001, -1.700000000000001, -1.600000000000001, -2.0000000000000013, -1.600000000000001, -1.600000000000001, -1.5000000000000009, -1.9000000000000012, -1.8000000000000012, -1.4000000000000008, -1.600000000000001, -7.399999999999986, -2.0000000000000013, -1.5000000000000009, -1.4000000000000008, -1.700000000000001, -1.5000000000000009, -1.9000000000000012, -2.0000000000000013, -1.700000000000001, -1.600000000000001, -2.0000000000000013, -1.9000000000000012, -2.700000000000002, -1.8000000000000012, -1.4000000000000008, -1.4000000000000008, -1.700000000000001, -2.1000000000000014, -2.5000000000000018, -2.3000000000000016, -1.4000000000000008, -1.4000000000000008, -2.1000000000000014, -1.8000000000000012, -1.700000000000001, -1.5000000000000009, -1.600000000000001, -1.9000000000000012, -1.8000000000000012, -1.600000000000001, -2.0000000000000013, -1.8000000000000012, -2.0000000000000013, -2.4000000000000017, -1.8000000000000012, -2.0000000000000013, -1.600000000000001, -2.3000000000000016, -1.600000000000001, -1.8000000000000012, -2.0000000000000013, -1.9000000000000012, -2.1000000000000014, -1.5000000000000009, -1.5000000000000009, -1.5000000000000009, -1.700000000000001, -2.3000000000000016], "episode_lengths": [30, 25, 30, 30, 26, 28, 30, 28, 28, 27, 28, 31, 29, 29, 26, 29, 29, 29, 27, 29, 25, 33, 26, 32, 28, 29, 25, 28, 26, 26, 30, 25, 29, 28, 46, 27, 29, 27, 25, 38, 29, 26, 25, 32, 33, 30, 34, 25, 29, 34, 33, 28, 30, 37, 27, 31, 30, 26, 29, 26, 25, 25, 113, 27, 28, 32, 26, 26, 30, 26, 26, 28, 28, 28, 30, 27, 28, 27, 31, 27, 27, 26, 30, 29, 25, 27, 85, 31, 26, 25, 28, 26, 30, 31, 28, 27, 31, 30, 38, 29, 25, 25, 28, 32, 36, 34, 25, 25, 32, 29, 28, 26, 27, 30, 29, 27, 31, 29, 31, 35, 29, 31, 27, 34, 27, 29, 31, 30, 32, 26, 26, 26, 28, 34]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.327118037142515, "mean_inference_ms": 0.7268696603978368, "mean_action_processing_ms": 0.07594575078612967, "mean_env_wait_ms": 6.856706581366, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0069463430945553, "StateBufferConnector_ms": 0.004031231154256792, "ViewRequirementAgentConnector_ms": 0.09107643098973517}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 160000, "num_agent_steps_trained": 160000, "num_env_steps_sampled": 160000, "num_env_steps_trained": 160000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 481.00221945678095, "num_env_steps_trained_throughput_per_sec": 481.00221945678095, "timesteps_total": 160000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 160000, "timers": {"training_iteration_time_ms": 8106.375, "sample_time_ms": 4582.754, "load_time_ms": 2.14, "load_throughput": 1869223.553, "learn_time_ms": 3518.275, "learn_throughput": 1136.921, "synch_weights_time_ms": 2.561}, "counters": {"num_env_steps_sampled": 160000, "num_env_steps_trained": 160000, "num_agent_steps_sampled": 160000, "num_agent_steps_trained": 160000}, "done": false, "episodes_total": 2724, "training_iteration": 40, "trial_id": "04cbf_00000", "date": "2024-03-07_13-23-10", "timestamp": 1709835790, "time_this_iter_s": 8.318816184997559, "time_total_s": 307.60840034484863, "pid": 119109, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7efea6399f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 307.60840034484863, "iterations_since_restore": 40, "perf": {"cpu_util_percent": 33.120000000000005, "ram_util_percent": 50.879999999999995, "gpu_util_percent0": 0.073, "vram_util_percent0": 0.09165852864583332}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.10000000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 0.25239222647149057, "policy_loss": -0.002947932692064393, "vf_loss": 0.25455008495939513, "vf_explained_var": 0.8567878391793979, "kl": 0.007900735533660747, "entropy": 0.23978587237577284, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 37665.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 164000, "num_env_steps_trained": 164000, "num_agent_steps_sampled": 164000, "num_agent_steps_trained": 164000}, "sampler_results": {"episode_reward_max": -1.4000000000000008, "episode_reward_min": -9.199999999999998, "episode_reward_mean": -1.9169117647058835, "episode_len_mean": 29.676470588235293, "episode_media": {}, "episodes_this_iter": 136, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2.1000000000000014, -1.600000000000001, -1.700000000000001, -1.8000000000000012, -1.9000000000000012, -1.5000000000000009, -1.9000000000000012, -1.600000000000001, -2.0000000000000013, -1.4000000000000008, -1.700000000000001, -1.8000000000000012, -1.5000000000000009, -2.900000000000002, -1.4000000000000008, -1.700000000000001, -1.8000000000000012, -2.1000000000000014, -1.8000000000000012, -1.600000000000001, -1.600000000000001, -2.2000000000000015, -1.700000000000001, -1.600000000000001, -1.5000000000000009, -1.8000000000000012, -1.8000000000000012, -1.700000000000001, -1.4000000000000008, -2.0000000000000013, -1.600000000000001, -9.199999999999998, -2.4000000000000017, -1.5000000000000009, -1.700000000000001, -1.8000000000000012, -1.600000000000001, -1.600000000000001, -2.2000000000000015, -1.8000000000000012, -1.4000000000000008, -1.600000000000001, -1.700000000000001, -1.5000000000000009, -2.0000000000000013, -1.4000000000000008, -1.8000000000000012, -1.4000000000000008, -1.700000000000001, -7.100000000000001, -2.4000000000000017, -2.4000000000000017, -1.4000000000000008, -1.600000000000001, -1.700000000000001, -1.4000000000000008, -1.5000000000000009, -1.8000000000000012, -1.700000000000001, -1.4000000000000008, -1.600000000000001, -1.9000000000000012, -2.0000000000000013, -2.1000000000000014, -1.4000000000000008, -1.9000000000000012, -1.4000000000000008, -1.700000000000001, -1.700000000000001, -1.700000000000001, -2.0000000000000013, -1.8000000000000012, -1.700000000000001, -1.5000000000000009, -1.5000000000000009, -2.4000000000000017, -1.8000000000000012, -1.600000000000001, -1.8000000000000012, -1.5000000000000009, -1.8000000000000012, -1.700000000000001, -2.0000000000000013, -2.2000000000000015, -1.600000000000001, -7.2999999999999865, -1.8000000000000012, -2.1000000000000014, -1.5000000000000009, -2.0000000000000013, -2.0000000000000013, -1.4000000000000008, -3.8000000000000025, -1.8000000000000012, -2.3000000000000016, -1.600000000000001, -1.9000000000000012, -1.8000000000000012, -2.0000000000000013, -1.9000000000000012, -1.5000000000000009, -1.9000000000000012, -3.4000000000000004, -1.5000000000000009, -1.9000000000000012, -1.8000000000000012, -1.9000000000000012, -1.5000000000000009, -1.5000000000000009, -1.600000000000001, -1.700000000000001, -2.1000000000000014, -2.4000000000000017, -1.4000000000000008, -1.5000000000000009, -1.700000000000001, -1.5000000000000009, -2.1000000000000014, -1.700000000000001, -1.600000000000001, -1.5000000000000009, -1.9000000000000012, -1.9000000000000012, -1.5000000000000009, -2.1000000000000014, -1.700000000000001, -1.9000000000000012, -1.5000000000000009, -1.4000000000000008, -2.3000000000000016, -1.600000000000001, -1.600000000000001, -2.1000000000000014, -1.600000000000001, -1.4000000000000008, -1.600000000000001], "episode_lengths": [32, 27, 28, 29, 30, 26, 30, 27, 31, 25, 28, 29, 26, 40, 25, 28, 29, 32, 29, 27, 27, 33, 28, 27, 26, 29, 29, 28, 25, 31, 27, 68, 34, 26, 28, 29, 27, 27, 33, 29, 25, 27, 28, 26, 31, 25, 29, 25, 28, 62, 35, 35, 25, 27, 28, 25, 26, 29, 28, 25, 27, 30, 31, 32, 25, 30, 25, 28, 28, 28, 31, 29, 28, 26, 26, 35, 29, 27, 29, 26, 29, 28, 31, 33, 27, 84, 29, 32, 26, 31, 31, 25, 42, 29, 34, 27, 30, 29, 31, 30, 26, 30, 41, 26, 30, 29, 30, 26, 26, 27, 28, 32, 35, 25, 26, 28, 26, 32, 28, 27, 26, 30, 30, 26, 32, 28, 30, 26, 25, 34, 27, 27, 32, 27, 25, 27]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.33001270983332615, "mean_inference_ms": 0.7291614003517854, "mean_action_processing_ms": 0.07597703278449018, "mean_env_wait_ms": 6.87321348185478, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007115918047287885, "StateBufferConnector_ms": 0.004007711130030015, "ViewRequirementAgentConnector_ms": 0.09101506541757022}}, "episode_reward_max": -1.4000000000000008, "episode_reward_min": -9.199999999999998, "episode_reward_mean": -1.9169117647058835, "episode_len_mean": 29.676470588235293, "episodes_this_iter": 136, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-2.1000000000000014, -1.600000000000001, -1.700000000000001, -1.8000000000000012, -1.9000000000000012, -1.5000000000000009, -1.9000000000000012, -1.600000000000001, -2.0000000000000013, -1.4000000000000008, -1.700000000000001, -1.8000000000000012, -1.5000000000000009, -2.900000000000002, -1.4000000000000008, -1.700000000000001, -1.8000000000000012, -2.1000000000000014, -1.8000000000000012, -1.600000000000001, -1.600000000000001, -2.2000000000000015, -1.700000000000001, -1.600000000000001, -1.5000000000000009, -1.8000000000000012, -1.8000000000000012, -1.700000000000001, -1.4000000000000008, -2.0000000000000013, -1.600000000000001, -9.199999999999998, -2.4000000000000017, -1.5000000000000009, -1.700000000000001, -1.8000000000000012, -1.600000000000001, -1.600000000000001, -2.2000000000000015, -1.8000000000000012, -1.4000000000000008, -1.600000000000001, -1.700000000000001, -1.5000000000000009, -2.0000000000000013, -1.4000000000000008, -1.8000000000000012, -1.4000000000000008, -1.700000000000001, -7.100000000000001, -2.4000000000000017, -2.4000000000000017, -1.4000000000000008, -1.600000000000001, -1.700000000000001, -1.4000000000000008, -1.5000000000000009, -1.8000000000000012, -1.700000000000001, -1.4000000000000008, -1.600000000000001, -1.9000000000000012, -2.0000000000000013, -2.1000000000000014, -1.4000000000000008, -1.9000000000000012, -1.4000000000000008, -1.700000000000001, -1.700000000000001, -1.700000000000001, -2.0000000000000013, -1.8000000000000012, -1.700000000000001, -1.5000000000000009, -1.5000000000000009, -2.4000000000000017, -1.8000000000000012, -1.600000000000001, -1.8000000000000012, -1.5000000000000009, -1.8000000000000012, -1.700000000000001, -2.0000000000000013, -2.2000000000000015, -1.600000000000001, -7.2999999999999865, -1.8000000000000012, -2.1000000000000014, -1.5000000000000009, -2.0000000000000013, -2.0000000000000013, -1.4000000000000008, -3.8000000000000025, -1.8000000000000012, -2.3000000000000016, -1.600000000000001, -1.9000000000000012, -1.8000000000000012, -2.0000000000000013, -1.9000000000000012, -1.5000000000000009, -1.9000000000000012, -3.4000000000000004, -1.5000000000000009, -1.9000000000000012, -1.8000000000000012, -1.9000000000000012, -1.5000000000000009, -1.5000000000000009, -1.600000000000001, -1.700000000000001, -2.1000000000000014, -2.4000000000000017, -1.4000000000000008, -1.5000000000000009, -1.700000000000001, -1.5000000000000009, -2.1000000000000014, -1.700000000000001, -1.600000000000001, -1.5000000000000009, -1.9000000000000012, -1.9000000000000012, -1.5000000000000009, -2.1000000000000014, -1.700000000000001, -1.9000000000000012, -1.5000000000000009, -1.4000000000000008, -2.3000000000000016, -1.600000000000001, -1.600000000000001, -2.1000000000000014, -1.600000000000001, -1.4000000000000008, -1.600000000000001], "episode_lengths": [32, 27, 28, 29, 30, 26, 30, 27, 31, 25, 28, 29, 26, 40, 25, 28, 29, 32, 29, 27, 27, 33, 28, 27, 26, 29, 29, 28, 25, 31, 27, 68, 34, 26, 28, 29, 27, 27, 33, 29, 25, 27, 28, 26, 31, 25, 29, 25, 28, 62, 35, 35, 25, 27, 28, 25, 26, 29, 28, 25, 27, 30, 31, 32, 25, 30, 25, 28, 28, 28, 31, 29, 28, 26, 26, 35, 29, 27, 29, 26, 29, 28, 31, 33, 27, 84, 29, 32, 26, 31, 31, 25, 42, 29, 34, 27, 30, 29, 31, 30, 26, 30, 41, 26, 30, 29, 30, 26, 26, 27, 28, 32, 35, 25, 26, 28, 26, 32, 28, 27, 26, 30, 30, 26, 32, 28, 30, 26, 25, 34, 27, 27, 32, 27, 25, 27]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.33001270983332615, "mean_inference_ms": 0.7291614003517854, "mean_action_processing_ms": 0.07597703278449018, "mean_env_wait_ms": 6.87321348185478, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007115918047287885, "StateBufferConnector_ms": 0.004007711130030015, "ViewRequirementAgentConnector_ms": 0.09101506541757022}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 164000, "num_agent_steps_trained": 164000, "num_env_steps_sampled": 164000, "num_env_steps_trained": 164000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 494.0284487464966, "num_env_steps_trained_throughput_per_sec": 494.0284487464966, "timesteps_total": 164000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 164000, "timers": {"training_iteration_time_ms": 8125.192, "sample_time_ms": 4601.654, "load_time_ms": 2.127, "load_throughput": 1880390.038, "learn_time_ms": 3518.226, "learn_throughput": 1136.937, "synch_weights_time_ms": 2.541}, "counters": {"num_env_steps_sampled": 164000, "num_env_steps_trained": 164000, "num_agent_steps_sampled": 164000, "num_agent_steps_trained": 164000}, "done": false, "episodes_total": 2860, "training_iteration": 41, "trial_id": "04cbf_00000", "date": "2024-03-07_13-23-18", "timestamp": 1709835798, "time_this_iter_s": 8.099754333496094, "time_total_s": 315.7081546783447, "pid": 119109, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7efea6399f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 315.7081546783447, "iterations_since_restore": 41, "perf": {"cpu_util_percent": 30.836363636363636, "ram_util_percent": 50.945454545454545, "gpu_util_percent0": 0.08181818181818182, "vram_util_percent0": 0.09164891098484848}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.10000000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 1.002780812274463, "policy_loss": 0.010170054575929078, "vf_loss": 0.9906205472654053, "vf_explained_var": 0.7529796766337528, "kl": 0.019902157071488458, "entropy": 0.2396299713882067, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 38595.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 168000, "num_env_steps_trained": 168000, "num_agent_steps_sampled": 168000, "num_agent_steps_trained": 168000}, "sampler_results": {"episode_reward_max": -1.4000000000000008, "episode_reward_min": -3.3000000000000016, "episode_reward_mean": -1.7468253968253977, "episode_len_mean": 28.357142857142858, "episode_media": {}, "episodes_this_iter": 126, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1.8000000000000012, -1.8000000000000012, -2.0000000000000013, -1.700000000000001, -2.1000000000000014, -1.4000000000000008, -3.0000000000000018, -2.1000000000000014, -1.600000000000001, -1.9000000000000012, -1.5000000000000009, -1.5000000000000009, -1.4000000000000008, -1.4000000000000008, -1.5000000000000009, -1.700000000000001, -1.8000000000000012, -1.600000000000001, -1.700000000000001, -1.4000000000000008, -1.9000000000000012, -1.8000000000000012, -2.2000000000000015, -1.700000000000001, -1.600000000000001, -1.5000000000000009, -1.5000000000000009, -1.700000000000001, -1.600000000000001, -1.4000000000000008, -2.0000000000000013, -1.4000000000000008, -1.5000000000000009, -1.9000000000000012, -1.600000000000001, -2.5000000000000018, -2.1000000000000014, -2.0000000000000013, -1.4000000000000008, -1.700000000000001, -1.9000000000000012, -1.5000000000000009, -1.5000000000000009, -2.800000000000002, -1.700000000000001, -1.4000000000000008, -1.9000000000000012, -1.600000000000001, -1.9000000000000012, -2.3000000000000016, -1.700000000000001, -1.4000000000000008, -2.0000000000000013, -1.5000000000000009, -1.4000000000000008, -1.600000000000001, -1.8000000000000012, -1.5000000000000009, -1.600000000000001, -1.600000000000001, -1.4000000000000008, -1.4000000000000008, -1.700000000000001, -1.5000000000000009, -1.8000000000000012, -1.4000000000000008, -1.8000000000000012, -1.4000000000000008, -1.8000000000000012, -1.4000000000000008, -2.2000000000000015, -1.8000000000000012, -1.4000000000000008, -2.1000000000000014, -2.600000000000002, -1.4000000000000008, -1.5000000000000009, -1.5000000000000009, -2.2000000000000015, -3.1000000000000014, -1.700000000000001, -1.700000000000001, -1.4000000000000008, -1.700000000000001, -1.9000000000000012, -1.8000000000000012, -1.700000000000001, -1.4000000000000008, -1.600000000000001, -1.5000000000000009, -1.8000000000000012, -1.8000000000000012, -2.0000000000000013, -1.5000000000000009, -1.9000000000000012, -3.3000000000000016, -1.700000000000001, -1.9000000000000012, -2.0000000000000013, -1.5000000000000009, -1.8000000000000012, -1.8000000000000012, -1.700000000000001, -1.5000000000000009, -1.5000000000000009, -1.5000000000000009, -1.4000000000000008, -1.8000000000000012, -2.1000000000000014, -1.9000000000000012, -1.5000000000000009, -1.600000000000001, -2.800000000000002, -2.0000000000000013, -1.5000000000000009, -1.4000000000000008, -1.700000000000001, -1.600000000000001, -1.8000000000000012, -1.700000000000001, -1.4000000000000008, -1.700000000000001, -1.4000000000000008, -1.9000000000000012, -1.700000000000001, -1.700000000000001], "episode_lengths": [29, 29, 31, 28, 32, 25, 38, 32, 27, 30, 26, 26, 25, 25, 26, 28, 29, 27, 28, 25, 30, 29, 33, 28, 27, 26, 26, 28, 27, 25, 31, 25, 26, 30, 27, 36, 32, 31, 25, 28, 30, 26, 26, 39, 28, 25, 30, 27, 30, 34, 28, 25, 31, 26, 25, 27, 29, 26, 27, 27, 25, 25, 28, 26, 29, 25, 29, 25, 29, 25, 33, 29, 25, 32, 37, 25, 26, 26, 33, 40, 28, 28, 25, 28, 30, 29, 28, 25, 27, 26, 29, 29, 31, 26, 30, 38, 28, 30, 31, 26, 29, 29, 28, 26, 26, 26, 25, 29, 32, 30, 26, 27, 36, 31, 26, 25, 28, 27, 29, 28, 25, 28, 25, 30, 28, 28]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.33219753763121807, "mean_inference_ms": 0.7302424966940142, "mean_action_processing_ms": 0.07603069850388208, "mean_env_wait_ms": 6.901774289784752, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007011776878720238, "StateBufferConnector_ms": 0.003972696879553417, "ViewRequirementAgentConnector_ms": 0.09084315527053106}}, "episode_reward_max": -1.4000000000000008, "episode_reward_min": -3.3000000000000016, "episode_reward_mean": -1.7468253968253977, "episode_len_mean": 28.357142857142858, "episodes_this_iter": 126, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1.8000000000000012, -1.8000000000000012, -2.0000000000000013, -1.700000000000001, -2.1000000000000014, -1.4000000000000008, -3.0000000000000018, -2.1000000000000014, -1.600000000000001, -1.9000000000000012, -1.5000000000000009, -1.5000000000000009, -1.4000000000000008, -1.4000000000000008, -1.5000000000000009, -1.700000000000001, -1.8000000000000012, -1.600000000000001, -1.700000000000001, -1.4000000000000008, -1.9000000000000012, -1.8000000000000012, -2.2000000000000015, -1.700000000000001, -1.600000000000001, -1.5000000000000009, -1.5000000000000009, -1.700000000000001, -1.600000000000001, -1.4000000000000008, -2.0000000000000013, -1.4000000000000008, -1.5000000000000009, -1.9000000000000012, -1.600000000000001, -2.5000000000000018, -2.1000000000000014, -2.0000000000000013, -1.4000000000000008, -1.700000000000001, -1.9000000000000012, -1.5000000000000009, -1.5000000000000009, -2.800000000000002, -1.700000000000001, -1.4000000000000008, -1.9000000000000012, -1.600000000000001, -1.9000000000000012, -2.3000000000000016, -1.700000000000001, -1.4000000000000008, -2.0000000000000013, -1.5000000000000009, -1.4000000000000008, -1.600000000000001, -1.8000000000000012, -1.5000000000000009, -1.600000000000001, -1.600000000000001, -1.4000000000000008, -1.4000000000000008, -1.700000000000001, -1.5000000000000009, -1.8000000000000012, -1.4000000000000008, -1.8000000000000012, -1.4000000000000008, -1.8000000000000012, -1.4000000000000008, -2.2000000000000015, -1.8000000000000012, -1.4000000000000008, -2.1000000000000014, -2.600000000000002, -1.4000000000000008, -1.5000000000000009, -1.5000000000000009, -2.2000000000000015, -3.1000000000000014, -1.700000000000001, -1.700000000000001, -1.4000000000000008, -1.700000000000001, -1.9000000000000012, -1.8000000000000012, -1.700000000000001, -1.4000000000000008, -1.600000000000001, -1.5000000000000009, -1.8000000000000012, -1.8000000000000012, -2.0000000000000013, -1.5000000000000009, -1.9000000000000012, -3.3000000000000016, -1.700000000000001, -1.9000000000000012, -2.0000000000000013, -1.5000000000000009, -1.8000000000000012, -1.8000000000000012, -1.700000000000001, -1.5000000000000009, -1.5000000000000009, -1.5000000000000009, -1.4000000000000008, -1.8000000000000012, -2.1000000000000014, -1.9000000000000012, -1.5000000000000009, -1.600000000000001, -2.800000000000002, -2.0000000000000013, -1.5000000000000009, -1.4000000000000008, -1.700000000000001, -1.600000000000001, -1.8000000000000012, -1.700000000000001, -1.4000000000000008, -1.700000000000001, -1.4000000000000008, -1.9000000000000012, -1.700000000000001, -1.700000000000001], "episode_lengths": [29, 29, 31, 28, 32, 25, 38, 32, 27, 30, 26, 26, 25, 25, 26, 28, 29, 27, 28, 25, 30, 29, 33, 28, 27, 26, 26, 28, 27, 25, 31, 25, 26, 30, 27, 36, 32, 31, 25, 28, 30, 26, 26, 39, 28, 25, 30, 27, 30, 34, 28, 25, 31, 26, 25, 27, 29, 26, 27, 27, 25, 25, 28, 26, 29, 25, 29, 25, 29, 25, 33, 29, 25, 32, 37, 25, 26, 26, 33, 40, 28, 28, 25, 28, 30, 29, 28, 25, 27, 26, 29, 29, 31, 26, 30, 38, 28, 30, 31, 26, 29, 29, 28, 26, 26, 26, 25, 29, 32, 30, 26, 27, 36, 31, 26, 25, 28, 27, 29, 28, 25, 28, 25, 30, 28, 28]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.33219753763121807, "mean_inference_ms": 0.7302424966940142, "mean_action_processing_ms": 0.07603069850388208, "mean_env_wait_ms": 6.901774289784752, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007011776878720238, "StateBufferConnector_ms": 0.003972696879553417, "ViewRequirementAgentConnector_ms": 0.09084315527053106}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 168000, "num_agent_steps_trained": 168000, "num_env_steps_sampled": 168000, "num_env_steps_trained": 168000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 493.3444639491932, "num_env_steps_trained_throughput_per_sec": 493.3444639491932, "timesteps_total": 168000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 168000, "timers": {"training_iteration_time_ms": 8144.578, "sample_time_ms": 4623.637, "load_time_ms": 2.116, "load_throughput": 1890220.149, "learn_time_ms": 3515.606, "learn_throughput": 1137.784, "synch_weights_time_ms": 2.576}, "counters": {"num_env_steps_sampled": 168000, "num_env_steps_trained": 168000, "num_agent_steps_sampled": 168000, "num_agent_steps_trained": 168000}, "done": false, "episodes_total": 2986, "training_iteration": 42, "trial_id": "04cbf_00000", "date": "2024-03-07_13-23-26", "timestamp": 1709835806, "time_this_iter_s": 8.110780954360962, "time_total_s": 323.8189356327057, "pid": 119109, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7efea6399f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 323.8189356327057, "iterations_since_restore": 42, "perf": {"cpu_util_percent": 33.47, "ram_util_percent": 50.90999999999999, "gpu_util_percent0": 0.072, "vram_util_percent0": 0.09164225260416667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.10000000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 1.3618934932770395, "policy_loss": -0.0008664801917088929, "vf_loss": 1.3619169788114647, "vf_explained_var": 0.6408941329166453, "kl": 0.008429877481905096, "entropy": 0.33701421580007, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 39525.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 172000, "num_env_steps_trained": 172000, "num_agent_steps_sampled": 172000, "num_agent_steps_trained": 172000}, "sampler_results": {"episode_reward_max": -1.4000000000000008, "episode_reward_min": -58.10000000000038, "episode_reward_mean": -3.0000000000000067, "episode_len_mean": 37.41525423728814, "episode_media": {}, "episodes_this_iter": 118, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-16.89999999999999, -1.8000000000000012, -1.9000000000000012, -1.600000000000001, -2.1000000000000014, -1.600000000000001, -1.4000000000000008, -1.600000000000001, -2.0000000000000013, -3.200000000000001, -1.8000000000000012, -1.5000000000000009, -1.8000000000000012, -2.600000000000002, -1.600000000000001, -2.1000000000000014, -1.5000000000000009, -1.4000000000000008, -1.5000000000000009, -2.1000000000000014, -1.9000000000000012, -1.8000000000000012, -1.5000000000000009, -2.2000000000000015, -2.2000000000000015, -1.8000000000000012, -1.5000000000000009, -1.600000000000001, -1.600000000000001, -1.5000000000000009, -3.0000000000000018, -1.600000000000001, -1.700000000000001, -1.8000000000000012, -1.600000000000001, -2.1000000000000014, -49.7000000000003, -58.10000000000038, -1.700000000000001, -1.4000000000000008, -1.700000000000001, -1.4000000000000008, -1.9000000000000012, -1.600000000000001, -1.8000000000000012, -1.5000000000000009, -1.700000000000001, -2.2000000000000015, -2.0000000000000013, -2.0000000000000013, -1.9000000000000012, -8.7, -1.600000000000001, -1.9000000000000012, -2.700000000000002, -1.600000000000001, -2.3000000000000016, -1.600000000000001, -1.600000000000001, -1.8000000000000012, -1.4000000000000008, -1.4000000000000008, -1.8000000000000012, -2.700000000000002, -1.700000000000001, -2.600000000000002, -1.700000000000001, -1.700000000000001, -1.4000000000000008, -1.600000000000001, -2.0000000000000013, -1.700000000000001, -1.700000000000001, -1.9000000000000012, -1.5000000000000009, -1.8000000000000012, -1.600000000000001, -1.600000000000001, -1.600000000000001, -1.8000000000000012, -1.8000000000000012, -1.9000000000000012, -2.1000000000000014, -1.600000000000001, -1.600000000000001, -1.700000000000001, -1.5000000000000009, -1.8000000000000012, -2.600000000000002, -1.8000000000000012, -1.8000000000000012, -1.600000000000001, -1.4000000000000008, -1.4000000000000008, -1.9000000000000012, -3.1000000000000014, -1.600000000000001, -2.4000000000000017, -2.0000000000000013, -13.499999999999982, -1.700000000000001, -1.9000000000000012, -2.1000000000000014, -2.0000000000000013, -1.9000000000000012, -1.5000000000000009, -2.2000000000000015, -1.700000000000001, -1.4000000000000008, -1.600000000000001, -1.4000000000000008, -4.399999999999997, -1.9000000000000012, -1.700000000000001, -1.600000000000001, -1.700000000000001, -1.600000000000001, -1.600000000000001], "episode_lengths": [170, 29, 30, 27, 32, 27, 25, 27, 31, 41, 29, 26, 29, 35, 27, 32, 26, 25, 26, 32, 30, 29, 26, 30, 33, 29, 26, 27, 26, 26, 38, 27, 28, 29, 27, 32, 400, 400, 28, 25, 28, 25, 30, 27, 29, 26, 28, 33, 31, 31, 30, 63, 27, 30, 38, 27, 33, 27, 27, 29, 25, 25, 29, 38, 28, 37, 28, 28, 25, 27, 31, 28, 28, 30, 26, 29, 27, 27, 27, 29, 29, 30, 32, 27, 27, 28, 26, 29, 37, 29, 29, 27, 25, 25, 30, 39, 27, 35, 31, 87, 28, 30, 30, 30, 30, 26, 33, 28, 25, 27, 25, 54, 30, 28, 27, 28, 27, 27]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.33437645992334725, "mean_inference_ms": 0.7299119137993805, "mean_action_processing_ms": 0.07620397951611206, "mean_env_wait_ms": 6.91994692289647, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006866455078125, "StateBufferConnector_ms": 0.003959162760589083, "ViewRequirementAgentConnector_ms": 0.09047217288259733}}, "episode_reward_max": -1.4000000000000008, "episode_reward_min": -58.10000000000038, "episode_reward_mean": -3.0000000000000067, "episode_len_mean": 37.41525423728814, "episodes_this_iter": 118, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-16.89999999999999, -1.8000000000000012, -1.9000000000000012, -1.600000000000001, -2.1000000000000014, -1.600000000000001, -1.4000000000000008, -1.600000000000001, -2.0000000000000013, -3.200000000000001, -1.8000000000000012, -1.5000000000000009, -1.8000000000000012, -2.600000000000002, -1.600000000000001, -2.1000000000000014, -1.5000000000000009, -1.4000000000000008, -1.5000000000000009, -2.1000000000000014, -1.9000000000000012, -1.8000000000000012, -1.5000000000000009, -2.2000000000000015, -2.2000000000000015, -1.8000000000000012, -1.5000000000000009, -1.600000000000001, -1.600000000000001, -1.5000000000000009, -3.0000000000000018, -1.600000000000001, -1.700000000000001, -1.8000000000000012, -1.600000000000001, -2.1000000000000014, -49.7000000000003, -58.10000000000038, -1.700000000000001, -1.4000000000000008, -1.700000000000001, -1.4000000000000008, -1.9000000000000012, -1.600000000000001, -1.8000000000000012, -1.5000000000000009, -1.700000000000001, -2.2000000000000015, -2.0000000000000013, -2.0000000000000013, -1.9000000000000012, -8.7, -1.600000000000001, -1.9000000000000012, -2.700000000000002, -1.600000000000001, -2.3000000000000016, -1.600000000000001, -1.600000000000001, -1.8000000000000012, -1.4000000000000008, -1.4000000000000008, -1.8000000000000012, -2.700000000000002, -1.700000000000001, -2.600000000000002, -1.700000000000001, -1.700000000000001, -1.4000000000000008, -1.600000000000001, -2.0000000000000013, -1.700000000000001, -1.700000000000001, -1.9000000000000012, -1.5000000000000009, -1.8000000000000012, -1.600000000000001, -1.600000000000001, -1.600000000000001, -1.8000000000000012, -1.8000000000000012, -1.9000000000000012, -2.1000000000000014, -1.600000000000001, -1.600000000000001, -1.700000000000001, -1.5000000000000009, -1.8000000000000012, -2.600000000000002, -1.8000000000000012, -1.8000000000000012, -1.600000000000001, -1.4000000000000008, -1.4000000000000008, -1.9000000000000012, -3.1000000000000014, -1.600000000000001, -2.4000000000000017, -2.0000000000000013, -13.499999999999982, -1.700000000000001, -1.9000000000000012, -2.1000000000000014, -2.0000000000000013, -1.9000000000000012, -1.5000000000000009, -2.2000000000000015, -1.700000000000001, -1.4000000000000008, -1.600000000000001, -1.4000000000000008, -4.399999999999997, -1.9000000000000012, -1.700000000000001, -1.600000000000001, -1.700000000000001, -1.600000000000001, -1.600000000000001], "episode_lengths": [170, 29, 30, 27, 32, 27, 25, 27, 31, 41, 29, 26, 29, 35, 27, 32, 26, 25, 26, 32, 30, 29, 26, 30, 33, 29, 26, 27, 26, 26, 38, 27, 28, 29, 27, 32, 400, 400, 28, 25, 28, 25, 30, 27, 29, 26, 28, 33, 31, 31, 30, 63, 27, 30, 38, 27, 33, 27, 27, 29, 25, 25, 29, 38, 28, 37, 28, 28, 25, 27, 31, 28, 28, 30, 26, 29, 27, 27, 27, 29, 29, 30, 32, 27, 27, 28, 26, 29, 37, 29, 29, 27, 25, 25, 30, 39, 27, 35, 31, 87, 28, 30, 30, 30, 30, 26, 33, 28, 25, 27, 25, 54, 30, 28, 27, 28, 27, 27]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.33437645992334725, "mean_inference_ms": 0.7299119137993805, "mean_action_processing_ms": 0.07620397951611206, "mean_env_wait_ms": 6.91994692289647, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006866455078125, "StateBufferConnector_ms": 0.003959162760589083, "ViewRequirementAgentConnector_ms": 0.09047217288259733}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 172000, "num_agent_steps_trained": 172000, "num_env_steps_sampled": 172000, "num_env_steps_trained": 172000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 497.1445153564177, "num_env_steps_trained_throughput_per_sec": 497.1445153564177, "timesteps_total": 172000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 172000, "timers": {"training_iteration_time_ms": 8157.656, "sample_time_ms": 4639.48, "load_time_ms": 2.115, "load_throughput": 1891477.469, "learn_time_ms": 3512.866, "learn_throughput": 1138.672, "synch_weights_time_ms": 2.554}, "counters": {"num_env_steps_sampled": 172000, "num_env_steps_trained": 172000, "num_agent_steps_sampled": 172000, "num_agent_steps_trained": 172000}, "done": false, "episodes_total": 3104, "training_iteration": 43, "trial_id": "04cbf_00000", "date": "2024-03-07_13-23-35", "timestamp": 1709835815, "time_this_iter_s": 8.048975467681885, "time_total_s": 331.8679111003876, "pid": 119109, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7efea6399f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 331.8679111003876, "iterations_since_restore": 43, "perf": {"cpu_util_percent": 30.64545454545455, "ram_util_percent": 50.9, "gpu_util_percent0": 0.09909090909090908, "vram_util_percent0": 0.09165630918560606}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.10000000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 0.3734140642265844, "policy_loss": -0.007808929581635741, "vf_loss": 0.37995113007103404, "vf_explained_var": 0.8166957342496483, "kl": 0.012718598700073861, "entropy": 0.26848618787142536, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 40455.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 176000, "num_env_steps_trained": 176000, "num_agent_steps_sampled": 176000, "num_agent_steps_trained": 176000}, "sampler_results": {"episode_reward_max": -1.4000000000000008, "episode_reward_min": -7.700000000000003, "episode_reward_mean": -2.010606060606062, "episode_len_mean": 30.325757575757574, "episode_media": {}, "episodes_this_iter": 132, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1.4000000000000008, -2.0000000000000013, -1.5000000000000009, -4.999999999999999, -2.5000000000000018, -1.5000000000000009, -4.400000000000003, -2.0000000000000013, -2.700000000000002, -1.4000000000000008, -1.9000000000000012, -3.1000000000000014, -1.4000000000000008, -1.8000000000000012, -1.700000000000001, -1.5000000000000009, -1.600000000000001, -2.2000000000000015, -1.700000000000001, -1.4000000000000008, -1.4000000000000008, -2.2000000000000015, -1.8000000000000012, -2.2000000000000015, -2.2000000000000015, -2.1000000000000014, -2.1000000000000014, -3.6000000000000023, -1.8000000000000012, -2.1000000000000014, -1.600000000000001, -1.5000000000000009, -1.8000000000000012, -1.700000000000001, -2.1000000000000014, -1.700000000000001, -1.9000000000000012, -1.9000000000000012, -1.4000000000000008, -2.800000000000002, -1.9000000000000012, -2.0000000000000013, -1.600000000000001, -2.0000000000000013, -1.600000000000001, -1.5000000000000009, -2.600000000000002, -1.9000000000000012, -1.700000000000001, -3.200000000000001, -2.1000000000000014, -1.8000000000000012, -1.9000000000000012, -2.2000000000000015, -1.700000000000001, -1.9000000000000012, -1.9000000000000012, -1.9000000000000012, -1.9000000000000012, -2.2000000000000015, -1.5000000000000009, -1.8000000000000012, -1.8000000000000012, -1.8000000000000012, -1.600000000000001, -1.9000000000000012, -1.600000000000001, -3.1000000000000014, -2.1000000000000014, -7.700000000000003, -1.9000000000000012, -1.600000000000001, -1.600000000000001, -1.5000000000000009, -2.900000000000002, -2.1000000000000014, -1.600000000000001, -2.3000000000000016, -2.2000000000000015, -1.5000000000000009, -1.700000000000001, -1.5000000000000009, -1.700000000000001, -1.8000000000000012, -1.700000000000001, -1.5000000000000009, -1.9000000000000012, -1.8000000000000012, -1.5000000000000009, -7.600000000000001, -1.600000000000001, -1.700000000000001, -2.0000000000000013, -1.9000000000000012, -1.5000000000000009, -1.700000000000001, -2.3000000000000016, -1.9000000000000012, -1.600000000000001, -1.9000000000000012, -1.600000000000001, -1.4000000000000008, -3.9000000000000012, -1.600000000000001, -1.600000000000001, -2.7000000000000015, -2.3000000000000016, -1.700000000000001, -2.0000000000000013, -2.2000000000000015, -1.600000000000001, -1.600000000000001, -1.700000000000001, -1.5000000000000009, -1.600000000000001, -1.600000000000001, -1.600000000000001, -1.700000000000001, -1.700000000000001, -1.5000000000000009, -1.600000000000001, -2.2000000000000015, -1.700000000000001, -1.9000000000000012, -1.8000000000000012, -1.600000000000001, -2.2000000000000015, -1.600000000000001, -2.0000000000000013, -1.5000000000000009, -1.600000000000001, -1.600000000000001], "episode_lengths": [25, 31, 26, 49, 36, 26, 41, 31, 38, 25, 30, 42, 25, 29, 28, 26, 27, 33, 28, 25, 25, 33, 29, 33, 33, 32, 32, 39, 29, 32, 27, 26, 29, 28, 32, 28, 30, 30, 25, 39, 30, 31, 27, 31, 27, 26, 34, 28, 28, 41, 32, 29, 30, 33, 28, 30, 30, 30, 30, 33, 26, 29, 29, 29, 27, 30, 27, 39, 32, 62, 30, 27, 27, 26, 40, 32, 27, 34, 33, 26, 28, 26, 28, 29, 28, 26, 30, 29, 26, 66, 27, 28, 31, 30, 26, 28, 34, 30, 27, 30, 27, 25, 46, 27, 27, 30, 34, 28, 31, 33, 27, 27, 28, 26, 27, 27, 27, 28, 28, 26, 27, 33, 28, 30, 29, 27, 33, 27, 31, 26, 27, 27]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.336277005664682, "mean_inference_ms": 0.7296370514014185, "mean_action_processing_ms": 0.07602715695092148, "mean_env_wait_ms": 6.929682671872799, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006966879873564749, "StateBufferConnector_ms": 0.003946008104266542, "ViewRequirementAgentConnector_ms": 0.09011987483862674}}, "episode_reward_max": -1.4000000000000008, "episode_reward_min": -7.700000000000003, "episode_reward_mean": -2.010606060606062, "episode_len_mean": 30.325757575757574, "episodes_this_iter": 132, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1.4000000000000008, -2.0000000000000013, -1.5000000000000009, -4.999999999999999, -2.5000000000000018, -1.5000000000000009, -4.400000000000003, -2.0000000000000013, -2.700000000000002, -1.4000000000000008, -1.9000000000000012, -3.1000000000000014, -1.4000000000000008, -1.8000000000000012, -1.700000000000001, -1.5000000000000009, -1.600000000000001, -2.2000000000000015, -1.700000000000001, -1.4000000000000008, -1.4000000000000008, -2.2000000000000015, -1.8000000000000012, -2.2000000000000015, -2.2000000000000015, -2.1000000000000014, -2.1000000000000014, -3.6000000000000023, -1.8000000000000012, -2.1000000000000014, -1.600000000000001, -1.5000000000000009, -1.8000000000000012, -1.700000000000001, -2.1000000000000014, -1.700000000000001, -1.9000000000000012, -1.9000000000000012, -1.4000000000000008, -2.800000000000002, -1.9000000000000012, -2.0000000000000013, -1.600000000000001, -2.0000000000000013, -1.600000000000001, -1.5000000000000009, -2.600000000000002, -1.9000000000000012, -1.700000000000001, -3.200000000000001, -2.1000000000000014, -1.8000000000000012, -1.9000000000000012, -2.2000000000000015, -1.700000000000001, -1.9000000000000012, -1.9000000000000012, -1.9000000000000012, -1.9000000000000012, -2.2000000000000015, -1.5000000000000009, -1.8000000000000012, -1.8000000000000012, -1.8000000000000012, -1.600000000000001, -1.9000000000000012, -1.600000000000001, -3.1000000000000014, -2.1000000000000014, -7.700000000000003, -1.9000000000000012, -1.600000000000001, -1.600000000000001, -1.5000000000000009, -2.900000000000002, -2.1000000000000014, -1.600000000000001, -2.3000000000000016, -2.2000000000000015, -1.5000000000000009, -1.700000000000001, -1.5000000000000009, -1.700000000000001, -1.8000000000000012, -1.700000000000001, -1.5000000000000009, -1.9000000000000012, -1.8000000000000012, -1.5000000000000009, -7.600000000000001, -1.600000000000001, -1.700000000000001, -2.0000000000000013, -1.9000000000000012, -1.5000000000000009, -1.700000000000001, -2.3000000000000016, -1.9000000000000012, -1.600000000000001, -1.9000000000000012, -1.600000000000001, -1.4000000000000008, -3.9000000000000012, -1.600000000000001, -1.600000000000001, -2.7000000000000015, -2.3000000000000016, -1.700000000000001, -2.0000000000000013, -2.2000000000000015, -1.600000000000001, -1.600000000000001, -1.700000000000001, -1.5000000000000009, -1.600000000000001, -1.600000000000001, -1.600000000000001, -1.700000000000001, -1.700000000000001, -1.5000000000000009, -1.600000000000001, -2.2000000000000015, -1.700000000000001, -1.9000000000000012, -1.8000000000000012, -1.600000000000001, -2.2000000000000015, -1.600000000000001, -2.0000000000000013, -1.5000000000000009, -1.600000000000001, -1.600000000000001], "episode_lengths": [25, 31, 26, 49, 36, 26, 41, 31, 38, 25, 30, 42, 25, 29, 28, 26, 27, 33, 28, 25, 25, 33, 29, 33, 33, 32, 32, 39, 29, 32, 27, 26, 29, 28, 32, 28, 30, 30, 25, 39, 30, 31, 27, 31, 27, 26, 34, 28, 28, 41, 32, 29, 30, 33, 28, 30, 30, 30, 30, 33, 26, 29, 29, 29, 27, 30, 27, 39, 32, 62, 30, 27, 27, 26, 40, 32, 27, 34, 33, 26, 28, 26, 28, 29, 28, 26, 30, 29, 26, 66, 27, 28, 31, 30, 26, 28, 34, 30, 27, 30, 27, 25, 46, 27, 27, 30, 34, 28, 31, 33, 27, 27, 28, 26, 27, 27, 27, 28, 28, 26, 27, 33, 28, 30, 29, 27, 33, 27, 31, 26, 27, 27]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.336277005664682, "mean_inference_ms": 0.7296370514014185, "mean_action_processing_ms": 0.07602715695092148, "mean_env_wait_ms": 6.929682671872799, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006966879873564749, "StateBufferConnector_ms": 0.003946008104266542, "ViewRequirementAgentConnector_ms": 0.09011987483862674}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 176000, "num_agent_steps_trained": 176000, "num_env_steps_sampled": 176000, "num_env_steps_trained": 176000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 495.94079884549, "num_env_steps_trained_throughput_per_sec": 495.94079884549, "timesteps_total": 176000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 176000, "timers": {"training_iteration_time_ms": 8149.074, "sample_time_ms": 4629.308, "load_time_ms": 2.116, "load_throughput": 1890369.235, "learn_time_ms": 3514.431, "learn_throughput": 1138.164, "synch_weights_time_ms": 2.582}, "counters": {"num_env_steps_sampled": 176000, "num_env_steps_trained": 176000, "num_agent_steps_sampled": 176000, "num_agent_steps_trained": 176000}, "done": false, "episodes_total": 3236, "training_iteration": 44, "trial_id": "04cbf_00000", "date": "2024-03-07_13-23-43", "timestamp": 1709835823, "time_this_iter_s": 8.068466901779175, "time_total_s": 339.93637800216675, "pid": 119109, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7efea6399f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 339.93637800216675, "iterations_since_restore": 44, "perf": {"cpu_util_percent": 32.54, "ram_util_percent": 50.92999999999999, "gpu_util_percent0": 0.076, "vram_util_percent0": 0.09165852864583333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.10000000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 0.17251254900468774, "policy_loss": -0.004399883949388099, "vf_loss": 0.1758405853022811, "vf_explained_var": 0.900037924320467, "kl": 0.010718482007543313, "entropy": 0.23406837011377016, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 41385.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 180000, "num_env_steps_trained": 180000, "num_agent_steps_sampled": 180000, "num_agent_steps_trained": 180000}, "sampler_results": {"episode_reward_max": -1.4000000000000008, "episode_reward_min": -8.6, "episode_reward_mean": -1.8525547445255486, "episode_len_mean": 29.05109489051095, "episode_media": {}, "episodes_this_iter": 137, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1.600000000000001, -1.9000000000000012, -1.600000000000001, -2.0000000000000013, -1.700000000000001, -2.0000000000000013, -1.700000000000001, -1.9000000000000012, -1.9000000000000012, -1.5000000000000009, -3.200000000000001, -1.600000000000001, -1.4000000000000008, -1.600000000000001, -1.9000000000000012, -1.600000000000001, -1.9000000000000012, -1.4000000000000008, -1.8000000000000012, -2.5000000000000018, -1.5000000000000009, -1.700000000000001, -1.8000000000000012, -1.600000000000001, -2.0000000000000013, -1.5000000000000009, -1.9000000000000012, -1.600000000000001, -2.0000000000000013, -1.700000000000001, -1.9000000000000012, -1.5000000000000009, -8.6, -1.9000000000000012, -1.600000000000001, -2.1000000000000014, -2.0000000000000013, -2.0000000000000013, -1.5000000000000009, -1.5000000000000009, -1.600000000000001, -1.4000000000000008, -1.5000000000000009, -2.0000000000000013, -1.600000000000001, -1.9000000000000012, -2.0000000000000013, -2.1000000000000014, -1.600000000000001, -1.600000000000001, -1.5000000000000009, -1.700000000000001, -1.8000000000000012, -1.8000000000000012, -1.9000000000000012, -1.8000000000000012, -2.0000000000000013, -1.600000000000001, -1.700000000000001, -1.8000000000000012, -1.8000000000000012, -1.600000000000001, -1.5000000000000009, -1.5000000000000009, -1.5000000000000009, -1.700000000000001, -1.5000000000000009, -1.9000000000000012, -1.4000000000000008, -1.600000000000001, -1.8000000000000012, -1.5000000000000009, -1.9000000000000012, -1.9000000000000012, -2.3000000000000016, -1.5000000000000009, -1.4000000000000008, -1.5000000000000009, -1.600000000000001, -1.8000000000000012, -1.9000000000000012, -1.600000000000001, -1.700000000000001, -2.1000000000000014, -1.9000000000000012, -2.0000000000000013, -1.600000000000001, -1.700000000000001, -1.5000000000000009, -2.800000000000002, -1.600000000000001, -2.0000000000000013, -1.8000000000000012, -1.600000000000001, -2.4000000000000017, -1.8000000000000012, -1.5000000000000009, -2.600000000000002, -1.9000000000000012, -1.700000000000001, -1.600000000000001, -1.9000000000000012, -1.700000000000001, -1.5000000000000009, -1.5000000000000009, -1.700000000000001, -1.4000000000000008, -1.9000000000000012, -1.5000000000000009, -1.4000000000000008, -1.600000000000001, -1.700000000000001, -4.5000000000000036, -1.4000000000000008, -1.8000000000000012, -3.4000000000000012, -1.9000000000000012, -1.700000000000001, -2.5000000000000018, -1.4000000000000008, -1.8000000000000012, -1.8000000000000012, -1.4000000000000008, -1.700000000000001, -1.9000000000000012, -1.9000000000000012, -1.4000000000000008, -2.0000000000000013, -1.600000000000001, -1.9000000000000012, -2.2000000000000015, -1.9000000000000012, -2.700000000000002, -1.600000000000001, -1.9000000000000012, -1.8000000000000012, -1.9000000000000012], "episode_lengths": [27, 30, 27, 31, 28, 31, 28, 30, 30, 26, 40, 27, 25, 27, 30, 27, 30, 25, 29, 36, 26, 28, 29, 27, 31, 26, 30, 27, 31, 28, 30, 26, 66, 30, 27, 32, 31, 31, 26, 26, 27, 25, 26, 31, 27, 30, 31, 32, 27, 27, 26, 28, 29, 29, 30, 29, 31, 27, 28, 29, 29, 27, 26, 26, 26, 28, 26, 30, 25, 27, 29, 26, 30, 30, 34, 26, 25, 26, 27, 29, 30, 27, 28, 32, 30, 31, 27, 28, 26, 35, 27, 31, 29, 27, 35, 29, 26, 33, 30, 28, 27, 30, 28, 26, 26, 28, 25, 30, 26, 25, 27, 28, 43, 25, 29, 37, 30, 28, 36, 25, 29, 29, 25, 28, 30, 30, 25, 31, 27, 30, 33, 30, 36, 27, 30, 29, 30]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3387621603922166, "mean_inference_ms": 0.729795524395501, "mean_action_processing_ms": 0.07601210987466812, "mean_env_wait_ms": 6.947451798213425, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007098260587149293, "StateBufferConnector_ms": 0.004057292520564838, "ViewRequirementAgentConnector_ms": 0.09207742927718336}}, "episode_reward_max": -1.4000000000000008, "episode_reward_min": -8.6, "episode_reward_mean": -1.8525547445255486, "episode_len_mean": 29.05109489051095, "episodes_this_iter": 137, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1.600000000000001, -1.9000000000000012, -1.600000000000001, -2.0000000000000013, -1.700000000000001, -2.0000000000000013, -1.700000000000001, -1.9000000000000012, -1.9000000000000012, -1.5000000000000009, -3.200000000000001, -1.600000000000001, -1.4000000000000008, -1.600000000000001, -1.9000000000000012, -1.600000000000001, -1.9000000000000012, -1.4000000000000008, -1.8000000000000012, -2.5000000000000018, -1.5000000000000009, -1.700000000000001, -1.8000000000000012, -1.600000000000001, -2.0000000000000013, -1.5000000000000009, -1.9000000000000012, -1.600000000000001, -2.0000000000000013, -1.700000000000001, -1.9000000000000012, -1.5000000000000009, -8.6, -1.9000000000000012, -1.600000000000001, -2.1000000000000014, -2.0000000000000013, -2.0000000000000013, -1.5000000000000009, -1.5000000000000009, -1.600000000000001, -1.4000000000000008, -1.5000000000000009, -2.0000000000000013, -1.600000000000001, -1.9000000000000012, -2.0000000000000013, -2.1000000000000014, -1.600000000000001, -1.600000000000001, -1.5000000000000009, -1.700000000000001, -1.8000000000000012, -1.8000000000000012, -1.9000000000000012, -1.8000000000000012, -2.0000000000000013, -1.600000000000001, -1.700000000000001, -1.8000000000000012, -1.8000000000000012, -1.600000000000001, -1.5000000000000009, -1.5000000000000009, -1.5000000000000009, -1.700000000000001, -1.5000000000000009, -1.9000000000000012, -1.4000000000000008, -1.600000000000001, -1.8000000000000012, -1.5000000000000009, -1.9000000000000012, -1.9000000000000012, -2.3000000000000016, -1.5000000000000009, -1.4000000000000008, -1.5000000000000009, -1.600000000000001, -1.8000000000000012, -1.9000000000000012, -1.600000000000001, -1.700000000000001, -2.1000000000000014, -1.9000000000000012, -2.0000000000000013, -1.600000000000001, -1.700000000000001, -1.5000000000000009, -2.800000000000002, -1.600000000000001, -2.0000000000000013, -1.8000000000000012, -1.600000000000001, -2.4000000000000017, -1.8000000000000012, -1.5000000000000009, -2.600000000000002, -1.9000000000000012, -1.700000000000001, -1.600000000000001, -1.9000000000000012, -1.700000000000001, -1.5000000000000009, -1.5000000000000009, -1.700000000000001, -1.4000000000000008, -1.9000000000000012, -1.5000000000000009, -1.4000000000000008, -1.600000000000001, -1.700000000000001, -4.5000000000000036, -1.4000000000000008, -1.8000000000000012, -3.4000000000000012, -1.9000000000000012, -1.700000000000001, -2.5000000000000018, -1.4000000000000008, -1.8000000000000012, -1.8000000000000012, -1.4000000000000008, -1.700000000000001, -1.9000000000000012, -1.9000000000000012, -1.4000000000000008, -2.0000000000000013, -1.600000000000001, -1.9000000000000012, -2.2000000000000015, -1.9000000000000012, -2.700000000000002, -1.600000000000001, -1.9000000000000012, -1.8000000000000012, -1.9000000000000012], "episode_lengths": [27, 30, 27, 31, 28, 31, 28, 30, 30, 26, 40, 27, 25, 27, 30, 27, 30, 25, 29, 36, 26, 28, 29, 27, 31, 26, 30, 27, 31, 28, 30, 26, 66, 30, 27, 32, 31, 31, 26, 26, 27, 25, 26, 31, 27, 30, 31, 32, 27, 27, 26, 28, 29, 29, 30, 29, 31, 27, 28, 29, 29, 27, 26, 26, 26, 28, 26, 30, 25, 27, 29, 26, 30, 30, 34, 26, 25, 26, 27, 29, 30, 27, 28, 32, 30, 31, 27, 28, 26, 35, 27, 31, 29, 27, 35, 29, 26, 33, 30, 28, 27, 30, 28, 26, 26, 28, 25, 30, 26, 25, 27, 28, 43, 25, 29, 37, 30, 28, 36, 25, 29, 29, 25, 28, 30, 30, 25, 31, 27, 30, 33, 30, 36, 27, 30, 29, 30]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3387621603922166, "mean_inference_ms": 0.729795524395501, "mean_action_processing_ms": 0.07601210987466812, "mean_env_wait_ms": 6.947451798213425, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007098260587149293, "StateBufferConnector_ms": 0.004057292520564838, "ViewRequirementAgentConnector_ms": 0.09207742927718336}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 180000, "num_agent_steps_trained": 180000, "num_env_steps_sampled": 180000, "num_env_steps_trained": 180000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 484.67652368021817, "num_env_steps_trained_throughput_per_sec": 484.67652368021817, "timesteps_total": 180000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 180000, "timers": {"training_iteration_time_ms": 8174.108, "sample_time_ms": 4649.868, "load_time_ms": 0.964, "load_throughput": 4148053.207, "learn_time_ms": 3520.037, "learn_throughput": 1136.352, "synch_weights_time_ms": 2.602}, "counters": {"num_env_steps_sampled": 180000, "num_env_steps_trained": 180000, "num_agent_steps_sampled": 180000, "num_agent_steps_trained": 180000}, "done": false, "episodes_total": 3373, "training_iteration": 45, "trial_id": "04cbf_00000", "date": "2024-03-07_13-23-51", "timestamp": 1709835831, "time_this_iter_s": 8.256274700164795, "time_total_s": 348.19265270233154, "pid": 119109, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7efea6399f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 348.19265270233154, "iterations_since_restore": 45, "perf": {"cpu_util_percent": 32.309090909090905, "ram_util_percent": 50.945454545454545, "gpu_util_percent0": 0.07272727272727274, "vram_util_percent0": 0.09164891098484848}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.10000000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 0.03471233492438001, "policy_loss": -0.010426827924706603, "vf_loss": 0.044558190799728836, "vf_explained_var": 0.9636497622536074, "kl": 0.0058097229241997365, "entropy": 0.21753427197215378, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 42315.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 184000, "num_env_steps_trained": 184000, "num_agent_steps_sampled": 184000, "num_agent_steps_trained": 184000}, "sampler_results": {"episode_reward_max": -1.4000000000000008, "episode_reward_min": -4.100000000000002, "episode_reward_mean": -1.7805755395683462, "episode_len_mean": 28.74820143884892, "episode_media": {}, "episodes_this_iter": 139, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2.1000000000000014, -1.600000000000001, -1.700000000000001, -1.4000000000000008, -1.700000000000001, -1.600000000000001, -1.4000000000000008, -1.600000000000001, -1.8000000000000012, -2.1000000000000014, -1.5000000000000009, -1.8000000000000012, -1.9000000000000012, -1.600000000000001, -1.5000000000000009, -2.1000000000000014, -1.8000000000000012, -1.8000000000000012, -2.0000000000000013, -1.5000000000000009, -1.4000000000000008, -1.700000000000001, -1.4000000000000008, -1.8000000000000012, -2.0000000000000013, -1.8000000000000012, -1.8000000000000012, -1.4000000000000008, -1.8000000000000012, -1.700000000000001, -1.700000000000001, -2.1000000000000014, -1.700000000000001, -2.1000000000000014, -1.700000000000001, -1.700000000000001, -1.4000000000000008, -1.9000000000000012, -1.8000000000000012, -1.600000000000001, -1.4000000000000008, -1.8000000000000012, -1.5000000000000009, -1.9000000000000012, -2.0000000000000013, -1.700000000000001, -1.5000000000000009, -1.4000000000000008, -2.1000000000000014, -2.0000000000000013, -1.5000000000000009, -1.4000000000000008, -1.4000000000000008, -2.3000000000000016, -2.1000000000000014, -1.700000000000001, -1.4000000000000008, -1.600000000000001, -1.5000000000000009, -1.9000000000000012, -1.4000000000000008, -1.5000000000000009, -1.8000000000000012, -2.0000000000000013, -1.8000000000000012, -2.2000000000000015, -1.600000000000001, -1.5000000000000009, -2.0000000000000013, -1.5000000000000009, -1.8000000000000012, -2.1000000000000014, -2.2000000000000015, -2.2000000000000015, -1.5000000000000009, -1.8000000000000012, -1.700000000000001, -2.5000000000000018, -4.100000000000002, -2.0000000000000013, -2.1000000000000014, -1.5000000000000009, -1.8000000000000012, -1.8000000000000012, -1.8000000000000012, -1.8000000000000012, -2.600000000000002, -1.8000000000000012, -1.600000000000001, -1.9000000000000012, -2.1000000000000014, -2.0000000000000013, -1.600000000000001, -1.5000000000000009, -1.700000000000001, -1.4000000000000008, -2.0000000000000013, -1.8000000000000012, -1.4000000000000008, -2.2000000000000015, -1.600000000000001, -1.600000000000001, -1.5000000000000009, -1.600000000000001, -1.5000000000000009, -1.9000000000000012, -1.700000000000001, -1.600000000000001, -1.8000000000000012, -1.8000000000000012, -1.5000000000000009, -2.3000000000000016, -1.5000000000000009, -1.700000000000001, -1.4000000000000008, -1.600000000000001, -2.1000000000000014, -2.1000000000000014, -2.1000000000000014, -1.700000000000001, -1.5000000000000009, -1.700000000000001, -1.600000000000001, -1.8000000000000012, -2.0000000000000013, -2.1000000000000014, -2.0000000000000013, -1.9000000000000012, -1.600000000000001, -2.0000000000000013, -1.700000000000001, -1.9000000000000012, -1.9000000000000012, -1.5000000000000009, -1.5000000000000009, -2.0000000000000013, -1.600000000000001, -2.0000000000000013, -1.9000000000000012], "episode_lengths": [32, 27, 28, 25, 28, 27, 25, 27, 29, 32, 26, 29, 30, 27, 26, 32, 29, 29, 31, 26, 25, 28, 25, 29, 31, 29, 29, 25, 29, 28, 28, 32, 28, 32, 28, 28, 25, 30, 29, 27, 25, 29, 26, 30, 31, 28, 26, 25, 32, 31, 26, 25, 25, 34, 32, 28, 25, 27, 26, 30, 25, 26, 29, 31, 29, 33, 27, 26, 31, 26, 29, 32, 33, 33, 26, 29, 28, 36, 44, 31, 32, 26, 29, 29, 29, 29, 37, 29, 27, 30, 32, 31, 27, 26, 28, 25, 31, 29, 25, 33, 27, 27, 26, 27, 26, 30, 28, 27, 29, 29, 26, 34, 26, 28, 25, 27, 32, 32, 32, 28, 26, 28, 27, 29, 31, 32, 31, 30, 27, 31, 28, 30, 30, 26, 26, 31, 27, 31, 30]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3410491692425968, "mean_inference_ms": 0.72985211432869, "mean_action_processing_ms": 0.07601832640168073, "mean_env_wait_ms": 6.9650285700272425, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0070230566340384725, "StateBufferConnector_ms": 0.003956547743982549, "ViewRequirementAgentConnector_ms": 0.09028139731866851}}, "episode_reward_max": -1.4000000000000008, "episode_reward_min": -4.100000000000002, "episode_reward_mean": -1.7805755395683462, "episode_len_mean": 28.74820143884892, "episodes_this_iter": 139, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-2.1000000000000014, -1.600000000000001, -1.700000000000001, -1.4000000000000008, -1.700000000000001, -1.600000000000001, -1.4000000000000008, -1.600000000000001, -1.8000000000000012, -2.1000000000000014, -1.5000000000000009, -1.8000000000000012, -1.9000000000000012, -1.600000000000001, -1.5000000000000009, -2.1000000000000014, -1.8000000000000012, -1.8000000000000012, -2.0000000000000013, -1.5000000000000009, -1.4000000000000008, -1.700000000000001, -1.4000000000000008, -1.8000000000000012, -2.0000000000000013, -1.8000000000000012, -1.8000000000000012, -1.4000000000000008, -1.8000000000000012, -1.700000000000001, -1.700000000000001, -2.1000000000000014, -1.700000000000001, -2.1000000000000014, -1.700000000000001, -1.700000000000001, -1.4000000000000008, -1.9000000000000012, -1.8000000000000012, -1.600000000000001, -1.4000000000000008, -1.8000000000000012, -1.5000000000000009, -1.9000000000000012, -2.0000000000000013, -1.700000000000001, -1.5000000000000009, -1.4000000000000008, -2.1000000000000014, -2.0000000000000013, -1.5000000000000009, -1.4000000000000008, -1.4000000000000008, -2.3000000000000016, -2.1000000000000014, -1.700000000000001, -1.4000000000000008, -1.600000000000001, -1.5000000000000009, -1.9000000000000012, -1.4000000000000008, -1.5000000000000009, -1.8000000000000012, -2.0000000000000013, -1.8000000000000012, -2.2000000000000015, -1.600000000000001, -1.5000000000000009, -2.0000000000000013, -1.5000000000000009, -1.8000000000000012, -2.1000000000000014, -2.2000000000000015, -2.2000000000000015, -1.5000000000000009, -1.8000000000000012, -1.700000000000001, -2.5000000000000018, -4.100000000000002, -2.0000000000000013, -2.1000000000000014, -1.5000000000000009, -1.8000000000000012, -1.8000000000000012, -1.8000000000000012, -1.8000000000000012, -2.600000000000002, -1.8000000000000012, -1.600000000000001, -1.9000000000000012, -2.1000000000000014, -2.0000000000000013, -1.600000000000001, -1.5000000000000009, -1.700000000000001, -1.4000000000000008, -2.0000000000000013, -1.8000000000000012, -1.4000000000000008, -2.2000000000000015, -1.600000000000001, -1.600000000000001, -1.5000000000000009, -1.600000000000001, -1.5000000000000009, -1.9000000000000012, -1.700000000000001, -1.600000000000001, -1.8000000000000012, -1.8000000000000012, -1.5000000000000009, -2.3000000000000016, -1.5000000000000009, -1.700000000000001, -1.4000000000000008, -1.600000000000001, -2.1000000000000014, -2.1000000000000014, -2.1000000000000014, -1.700000000000001, -1.5000000000000009, -1.700000000000001, -1.600000000000001, -1.8000000000000012, -2.0000000000000013, -2.1000000000000014, -2.0000000000000013, -1.9000000000000012, -1.600000000000001, -2.0000000000000013, -1.700000000000001, -1.9000000000000012, -1.9000000000000012, -1.5000000000000009, -1.5000000000000009, -2.0000000000000013, -1.600000000000001, -2.0000000000000013, -1.9000000000000012], "episode_lengths": [32, 27, 28, 25, 28, 27, 25, 27, 29, 32, 26, 29, 30, 27, 26, 32, 29, 29, 31, 26, 25, 28, 25, 29, 31, 29, 29, 25, 29, 28, 28, 32, 28, 32, 28, 28, 25, 30, 29, 27, 25, 29, 26, 30, 31, 28, 26, 25, 32, 31, 26, 25, 25, 34, 32, 28, 25, 27, 26, 30, 25, 26, 29, 31, 29, 33, 27, 26, 31, 26, 29, 32, 33, 33, 26, 29, 28, 36, 44, 31, 32, 26, 29, 29, 29, 29, 37, 29, 27, 30, 32, 31, 27, 26, 28, 25, 31, 29, 25, 33, 27, 27, 26, 27, 26, 30, 28, 27, 29, 29, 26, 34, 26, 28, 25, 27, 32, 32, 32, 28, 26, 28, 27, 29, 31, 32, 31, 30, 27, 31, 28, 30, 30, 26, 26, 31, 27, 31, 30]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3410491692425968, "mean_inference_ms": 0.72985211432869, "mean_action_processing_ms": 0.07601832640168073, "mean_env_wait_ms": 6.9650285700272425, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0070230566340384725, "StateBufferConnector_ms": 0.003956547743982549, "ViewRequirementAgentConnector_ms": 0.09028139731866851}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 184000, "num_agent_steps_trained": 184000, "num_env_steps_sampled": 184000, "num_env_steps_trained": 184000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 493.2813226225893, "num_env_steps_trained_throughput_per_sec": 493.2813226225893, "timesteps_total": 184000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 184000, "timers": {"training_iteration_time_ms": 8185.862, "sample_time_ms": 4663.471, "load_time_ms": 0.972, "load_throughput": 4113474.231, "learn_time_ms": 3518.192, "learn_throughput": 1136.948, "synch_weights_time_ms": 2.589}, "counters": {"num_env_steps_sampled": 184000, "num_env_steps_trained": 184000, "num_agent_steps_sampled": 184000, "num_agent_steps_trained": 184000}, "done": false, "episodes_total": 3512, "training_iteration": 46, "trial_id": "04cbf_00000", "date": "2024-03-07_13-23-59", "timestamp": 1709835839, "time_this_iter_s": 8.11191701889038, "time_total_s": 356.3045697212219, "pid": 119109, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7efea6399f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 356.3045697212219, "iterations_since_restore": 46, "perf": {"cpu_util_percent": 32.69, "ram_util_percent": 50.89999999999999, "gpu_util_percent0": 0.074, "vram_util_percent0": 0.09164225260416667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.10000000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 0.5285541437355982, "policy_loss": 0.003054241619763836, "vf_loss": 0.5234383221042233, "vf_explained_var": 0.7771491694834924, "kl": 0.02061585357143265, "entropy": 0.24995479675871068, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 43245.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 188000, "num_env_steps_trained": 188000, "num_agent_steps_sampled": 188000, "num_agent_steps_trained": 188000}, "sampler_results": {"episode_reward_max": -1.4000000000000008, "episode_reward_min": -29.79999999999994, "episode_reward_mean": -2.0533834586466178, "episode_len_mean": 30.112781954887218, "episode_media": {}, "episodes_this_iter": 133, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1.600000000000001, -1.5000000000000009, -1.9000000000000012, -1.700000000000001, -9.999999999999993, -1.9000000000000012, -1.8000000000000012, -1.4000000000000008, -2.1000000000000014, -1.8000000000000012, -1.700000000000001, -1.600000000000001, -1.600000000000001, -1.8000000000000012, -1.700000000000001, -1.700000000000001, -1.600000000000001, -1.9000000000000012, -2.1000000000000014, -2.5000000000000018, -1.8000000000000012, -1.600000000000001, -1.9000000000000012, -1.600000000000001, -2.0000000000000013, -1.600000000000001, -1.5000000000000009, -1.600000000000001, -1.8000000000000012, -1.700000000000001, -1.8000000000000012, -2.0000000000000013, -1.700000000000001, -1.9000000000000012, -1.600000000000001, -1.600000000000001, -1.5000000000000009, -1.4000000000000008, -1.700000000000001, -1.600000000000001, -1.600000000000001, -2.0000000000000013, -1.5000000000000009, -1.700000000000001, -1.700000000000001, -1.5000000000000009, -1.8000000000000012, -1.700000000000001, -2.0000000000000013, -2.2000000000000015, -1.9000000000000012, -1.700000000000001, -2.5000000000000018, -1.5000000000000009, -1.5000000000000009, -1.9000000000000012, -1.8000000000000012, -1.5000000000000009, -1.5000000000000009, -1.600000000000001, -1.8000000000000012, -2.0000000000000013, -1.4000000000000008, -1.8000000000000012, -1.8000000000000012, -2.700000000000002, -1.8000000000000012, -1.8000000000000012, -1.5000000000000009, -1.8000000000000012, -1.700000000000001, -2.2000000000000015, -1.8000000000000012, -1.700000000000001, -1.600000000000001, -1.700000000000001, -1.4000000000000008, -1.600000000000001, -1.600000000000001, -1.700000000000001, -1.9000000000000012, -1.8000000000000012, -1.600000000000001, -1.600000000000001, -1.600000000000001, -2.1000000000000014, -1.9000000000000012, -1.700000000000001, -1.700000000000001, -1.600000000000001, -1.4000000000000008, -1.8000000000000012, -3.5, -2.5000000000000018, -1.5000000000000009, -1.5000000000000009, -1.5000000000000009, -1.600000000000001, -1.700000000000001, -1.9000000000000012, -2.1000000000000014, -1.600000000000001, -4.699999999999995, -1.8000000000000012, -1.5000000000000009, -1.600000000000001, -1.8000000000000012, -2.0000000000000013, -1.600000000000001, -1.5000000000000009, -29.79999999999994, -1.5000000000000009, -1.9000000000000012, -1.5000000000000009, -1.600000000000001, -1.600000000000001, -2.0000000000000013, -2.0000000000000013, -1.5000000000000009, -2.4000000000000017, -1.5000000000000009, -2.0000000000000013, -1.9000000000000012, -1.5000000000000009, -1.4000000000000008, -1.700000000000001, -1.700000000000001, -1.600000000000001, -2.0000000000000013, -1.8000000000000012, -2.4000000000000017, -1.4000000000000008, -1.5000000000000009], "episode_lengths": [27, 26, 30, 28, 74, 30, 29, 25, 32, 29, 28, 27, 27, 29, 28, 28, 27, 30, 32, 36, 29, 27, 30, 27, 31, 27, 26, 27, 29, 28, 29, 31, 28, 30, 27, 27, 26, 25, 28, 27, 27, 31, 26, 28, 28, 26, 29, 28, 31, 33, 30, 28, 36, 26, 26, 30, 29, 26, 26, 27, 29, 31, 25, 29, 29, 36, 29, 29, 26, 29, 28, 33, 29, 28, 27, 28, 25, 27, 27, 28, 30, 29, 27, 27, 27, 32, 30, 28, 28, 27, 25, 29, 46, 36, 26, 26, 26, 27, 28, 30, 32, 27, 42, 29, 26, 27, 29, 31, 27, 26, 177, 26, 30, 26, 27, 27, 29, 31, 26, 35, 26, 31, 30, 26, 25, 28, 28, 27, 31, 29, 35, 25, 26]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3431913749550159, "mean_inference_ms": 0.7297141913517007, "mean_action_processing_ms": 0.07602954902425178, "mean_env_wait_ms": 6.975064883313903, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006998750500212935, "StateBufferConnector_ms": 0.003945737853086084, "ViewRequirementAgentConnector_ms": 0.09046389644307301}}, "episode_reward_max": -1.4000000000000008, "episode_reward_min": -29.79999999999994, "episode_reward_mean": -2.0533834586466178, "episode_len_mean": 30.112781954887218, "episodes_this_iter": 133, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1.600000000000001, -1.5000000000000009, -1.9000000000000012, -1.700000000000001, -9.999999999999993, -1.9000000000000012, -1.8000000000000012, -1.4000000000000008, -2.1000000000000014, -1.8000000000000012, -1.700000000000001, -1.600000000000001, -1.600000000000001, -1.8000000000000012, -1.700000000000001, -1.700000000000001, -1.600000000000001, -1.9000000000000012, -2.1000000000000014, -2.5000000000000018, -1.8000000000000012, -1.600000000000001, -1.9000000000000012, -1.600000000000001, -2.0000000000000013, -1.600000000000001, -1.5000000000000009, -1.600000000000001, -1.8000000000000012, -1.700000000000001, -1.8000000000000012, -2.0000000000000013, -1.700000000000001, -1.9000000000000012, -1.600000000000001, -1.600000000000001, -1.5000000000000009, -1.4000000000000008, -1.700000000000001, -1.600000000000001, -1.600000000000001, -2.0000000000000013, -1.5000000000000009, -1.700000000000001, -1.700000000000001, -1.5000000000000009, -1.8000000000000012, -1.700000000000001, -2.0000000000000013, -2.2000000000000015, -1.9000000000000012, -1.700000000000001, -2.5000000000000018, -1.5000000000000009, -1.5000000000000009, -1.9000000000000012, -1.8000000000000012, -1.5000000000000009, -1.5000000000000009, -1.600000000000001, -1.8000000000000012, -2.0000000000000013, -1.4000000000000008, -1.8000000000000012, -1.8000000000000012, -2.700000000000002, -1.8000000000000012, -1.8000000000000012, -1.5000000000000009, -1.8000000000000012, -1.700000000000001, -2.2000000000000015, -1.8000000000000012, -1.700000000000001, -1.600000000000001, -1.700000000000001, -1.4000000000000008, -1.600000000000001, -1.600000000000001, -1.700000000000001, -1.9000000000000012, -1.8000000000000012, -1.600000000000001, -1.600000000000001, -1.600000000000001, -2.1000000000000014, -1.9000000000000012, -1.700000000000001, -1.700000000000001, -1.600000000000001, -1.4000000000000008, -1.8000000000000012, -3.5, -2.5000000000000018, -1.5000000000000009, -1.5000000000000009, -1.5000000000000009, -1.600000000000001, -1.700000000000001, -1.9000000000000012, -2.1000000000000014, -1.600000000000001, -4.699999999999995, -1.8000000000000012, -1.5000000000000009, -1.600000000000001, -1.8000000000000012, -2.0000000000000013, -1.600000000000001, -1.5000000000000009, -29.79999999999994, -1.5000000000000009, -1.9000000000000012, -1.5000000000000009, -1.600000000000001, -1.600000000000001, -2.0000000000000013, -2.0000000000000013, -1.5000000000000009, -2.4000000000000017, -1.5000000000000009, -2.0000000000000013, -1.9000000000000012, -1.5000000000000009, -1.4000000000000008, -1.700000000000001, -1.700000000000001, -1.600000000000001, -2.0000000000000013, -1.8000000000000012, -2.4000000000000017, -1.4000000000000008, -1.5000000000000009], "episode_lengths": [27, 26, 30, 28, 74, 30, 29, 25, 32, 29, 28, 27, 27, 29, 28, 28, 27, 30, 32, 36, 29, 27, 30, 27, 31, 27, 26, 27, 29, 28, 29, 31, 28, 30, 27, 27, 26, 25, 28, 27, 27, 31, 26, 28, 28, 26, 29, 28, 31, 33, 30, 28, 36, 26, 26, 30, 29, 26, 26, 27, 29, 31, 25, 29, 29, 36, 29, 29, 26, 29, 28, 33, 29, 28, 27, 28, 25, 27, 27, 28, 30, 29, 27, 27, 27, 32, 30, 28, 28, 27, 25, 29, 46, 36, 26, 26, 26, 27, 28, 30, 32, 27, 42, 29, 26, 27, 29, 31, 27, 26, 177, 26, 30, 26, 27, 27, 29, 31, 26, 35, 26, 31, 30, 26, 25, 28, 28, 27, 31, 29, 35, 25, 26]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3431913749550159, "mean_inference_ms": 0.7297141913517007, "mean_action_processing_ms": 0.07602954902425178, "mean_env_wait_ms": 6.975064883313903, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006998750500212935, "StateBufferConnector_ms": 0.003945737853086084, "ViewRequirementAgentConnector_ms": 0.09046389644307301}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 188000, "num_agent_steps_trained": 188000, "num_env_steps_sampled": 188000, "num_env_steps_trained": 188000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 494.43146256436967, "num_env_steps_trained_throughput_per_sec": 494.43146256436967, "timesteps_total": 188000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 188000, "timers": {"training_iteration_time_ms": 8158.023, "sample_time_ms": 4646.072, "load_time_ms": 0.976, "load_throughput": 4099302.661, "learn_time_ms": 3507.751, "learn_throughput": 1140.332, "synch_weights_time_ms": 2.585}, "counters": {"num_env_steps_sampled": 188000, "num_env_steps_trained": 188000, "num_agent_steps_sampled": 188000, "num_agent_steps_trained": 188000}, "done": false, "episodes_total": 3645, "training_iteration": 47, "trial_id": "04cbf_00000", "date": "2024-03-07_13-24-07", "timestamp": 1709835847, "time_this_iter_s": 8.093088150024414, "time_total_s": 364.39765787124634, "pid": 119109, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7efea6399f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 364.39765787124634, "iterations_since_restore": 47, "perf": {"cpu_util_percent": 30.46363636363636, "ram_util_percent": 50.95454545454545, "gpu_util_percent0": 0.08363636363636363, "vram_util_percent0": 0.09164151278409091}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.15, "cur_lr": 0.0010000000000000005, "total_loss": 0.010792650691432608, "policy_loss": -0.0051913895093465365, "vf_loss": 0.015274595753890612, "vf_explained_var": 0.980652117536914, "kl": 0.004729631372208046, "entropy": 0.23968667817372147, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 44175.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 192000, "num_env_steps_trained": 192000, "num_agent_steps_sampled": 192000, "num_agent_steps_trained": 192000}, "sampler_results": {"episode_reward_max": -1.4000000000000008, "episode_reward_min": -3.0000000000000018, "episode_reward_mean": -1.8086330935251809, "episode_len_mean": 29.07913669064748, "episode_media": {}, "episodes_this_iter": 139, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1.700000000000001, -1.600000000000001, -1.5000000000000009, -1.9000000000000012, -1.8000000000000012, -2.0000000000000013, -2.2000000000000015, -2.5000000000000018, -1.5000000000000009, -1.5000000000000009, -1.700000000000001, -2.0000000000000013, -1.700000000000001, -2.0000000000000013, -1.8000000000000012, -1.8000000000000012, -1.8000000000000012, -1.700000000000001, -1.9000000000000012, -1.600000000000001, -1.600000000000001, -1.5000000000000009, -2.1000000000000014, -1.8000000000000012, -1.600000000000001, -1.5000000000000009, -1.8000000000000012, -1.9000000000000012, -1.600000000000001, -1.5000000000000009, -1.9000000000000012, -1.700000000000001, -2.1000000000000014, -1.5000000000000009, -1.8000000000000012, -1.5000000000000009, -1.5000000000000009, -1.8000000000000012, -1.4000000000000008, -1.5000000000000009, -1.8000000000000012, -1.8000000000000012, -1.9000000000000012, -2.2000000000000015, -2.1000000000000014, -1.8000000000000012, -1.8000000000000012, -1.5000000000000009, -1.600000000000001, -2.0000000000000013, -1.8000000000000012, -1.700000000000001, -1.700000000000001, -1.700000000000001, -2.1000000000000014, -1.5000000000000009, -2.1000000000000014, -2.0000000000000013, -1.600000000000001, -1.600000000000001, -1.4000000000000008, -2.1000000000000014, -1.9000000000000012, -1.4000000000000008, -1.700000000000001, -1.8000000000000012, -1.9000000000000012, -2.1000000000000014, -1.9000000000000012, -2.4000000000000017, -1.9000000000000012, -1.9000000000000012, -1.700000000000001, -1.8000000000000012, -2.1000000000000014, -2.3000000000000016, -1.600000000000001, -1.9000000000000012, -1.4000000000000008, -1.9000000000000012, -2.0000000000000013, -3.0000000000000018, -1.8000000000000012, -1.8000000000000012, -1.700000000000001, -2.2000000000000015, -1.5000000000000009, -1.5000000000000009, -1.600000000000001, -1.700000000000001, -1.600000000000001, -1.8000000000000012, -1.700000000000001, -1.600000000000001, -1.8000000000000012, -1.9000000000000012, -1.700000000000001, -1.8000000000000012, -1.8000000000000012, -1.600000000000001, -2.3000000000000016, -2.1000000000000014, -2.3000000000000016, -2.2000000000000015, -1.4000000000000008, -1.600000000000001, -1.5000000000000009, -2.4000000000000017, -2.1000000000000014, -1.8000000000000012, -1.5000000000000009, -2.4000000000000017, -1.8000000000000012, -1.8000000000000012, -1.9000000000000012, -1.600000000000001, -1.600000000000001, -1.9000000000000012, -1.4000000000000008, -2.0000000000000013, -1.700000000000001, -1.9000000000000012, -2.1000000000000014, -1.5000000000000009, -1.8000000000000012, -1.9000000000000012, -1.9000000000000012, -2.5000000000000018, -1.5000000000000009, -1.700000000000001, -1.8000000000000012, -2.2000000000000015, -2.2000000000000015, -1.4000000000000008, -1.600000000000001, -1.4000000000000008, -1.8000000000000012, -1.9000000000000012, -1.700000000000001], "episode_lengths": [28, 27, 26, 30, 29, 31, 33, 36, 26, 26, 28, 31, 28, 31, 29, 29, 29, 28, 30, 27, 27, 26, 32, 29, 27, 26, 29, 30, 27, 26, 30, 28, 32, 26, 29, 26, 26, 29, 25, 26, 29, 29, 30, 33, 32, 29, 29, 26, 27, 31, 29, 28, 28, 28, 32, 26, 32, 31, 27, 27, 25, 32, 30, 25, 28, 29, 30, 32, 30, 35, 30, 30, 28, 29, 32, 34, 27, 30, 25, 30, 31, 41, 29, 29, 28, 33, 26, 26, 27, 28, 27, 29, 28, 27, 29, 30, 28, 29, 29, 27, 34, 32, 34, 32, 25, 27, 26, 35, 32, 29, 26, 35, 29, 29, 30, 27, 27, 30, 25, 31, 28, 30, 32, 26, 29, 30, 30, 36, 26, 28, 29, 33, 33, 25, 27, 25, 29, 30, 28]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3454015600194515, "mean_inference_ms": 0.7300813655155992, "mean_action_processing_ms": 0.07605773279948808, "mean_env_wait_ms": 6.996445120576765, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007183088673104485, "StateBufferConnector_ms": 0.004095653835818064, "ViewRequirementAgentConnector_ms": 0.09243213873115375}}, "episode_reward_max": -1.4000000000000008, "episode_reward_min": -3.0000000000000018, "episode_reward_mean": -1.8086330935251809, "episode_len_mean": 29.07913669064748, "episodes_this_iter": 139, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1.700000000000001, -1.600000000000001, -1.5000000000000009, -1.9000000000000012, -1.8000000000000012, -2.0000000000000013, -2.2000000000000015, -2.5000000000000018, -1.5000000000000009, -1.5000000000000009, -1.700000000000001, -2.0000000000000013, -1.700000000000001, -2.0000000000000013, -1.8000000000000012, -1.8000000000000012, -1.8000000000000012, -1.700000000000001, -1.9000000000000012, -1.600000000000001, -1.600000000000001, -1.5000000000000009, -2.1000000000000014, -1.8000000000000012, -1.600000000000001, -1.5000000000000009, -1.8000000000000012, -1.9000000000000012, -1.600000000000001, -1.5000000000000009, -1.9000000000000012, -1.700000000000001, -2.1000000000000014, -1.5000000000000009, -1.8000000000000012, -1.5000000000000009, -1.5000000000000009, -1.8000000000000012, -1.4000000000000008, -1.5000000000000009, -1.8000000000000012, -1.8000000000000012, -1.9000000000000012, -2.2000000000000015, -2.1000000000000014, -1.8000000000000012, -1.8000000000000012, -1.5000000000000009, -1.600000000000001, -2.0000000000000013, -1.8000000000000012, -1.700000000000001, -1.700000000000001, -1.700000000000001, -2.1000000000000014, -1.5000000000000009, -2.1000000000000014, -2.0000000000000013, -1.600000000000001, -1.600000000000001, -1.4000000000000008, -2.1000000000000014, -1.9000000000000012, -1.4000000000000008, -1.700000000000001, -1.8000000000000012, -1.9000000000000012, -2.1000000000000014, -1.9000000000000012, -2.4000000000000017, -1.9000000000000012, -1.9000000000000012, -1.700000000000001, -1.8000000000000012, -2.1000000000000014, -2.3000000000000016, -1.600000000000001, -1.9000000000000012, -1.4000000000000008, -1.9000000000000012, -2.0000000000000013, -3.0000000000000018, -1.8000000000000012, -1.8000000000000012, -1.700000000000001, -2.2000000000000015, -1.5000000000000009, -1.5000000000000009, -1.600000000000001, -1.700000000000001, -1.600000000000001, -1.8000000000000012, -1.700000000000001, -1.600000000000001, -1.8000000000000012, -1.9000000000000012, -1.700000000000001, -1.8000000000000012, -1.8000000000000012, -1.600000000000001, -2.3000000000000016, -2.1000000000000014, -2.3000000000000016, -2.2000000000000015, -1.4000000000000008, -1.600000000000001, -1.5000000000000009, -2.4000000000000017, -2.1000000000000014, -1.8000000000000012, -1.5000000000000009, -2.4000000000000017, -1.8000000000000012, -1.8000000000000012, -1.9000000000000012, -1.600000000000001, -1.600000000000001, -1.9000000000000012, -1.4000000000000008, -2.0000000000000013, -1.700000000000001, -1.9000000000000012, -2.1000000000000014, -1.5000000000000009, -1.8000000000000012, -1.9000000000000012, -1.9000000000000012, -2.5000000000000018, -1.5000000000000009, -1.700000000000001, -1.8000000000000012, -2.2000000000000015, -2.2000000000000015, -1.4000000000000008, -1.600000000000001, -1.4000000000000008, -1.8000000000000012, -1.9000000000000012, -1.700000000000001], "episode_lengths": [28, 27, 26, 30, 29, 31, 33, 36, 26, 26, 28, 31, 28, 31, 29, 29, 29, 28, 30, 27, 27, 26, 32, 29, 27, 26, 29, 30, 27, 26, 30, 28, 32, 26, 29, 26, 26, 29, 25, 26, 29, 29, 30, 33, 32, 29, 29, 26, 27, 31, 29, 28, 28, 28, 32, 26, 32, 31, 27, 27, 25, 32, 30, 25, 28, 29, 30, 32, 30, 35, 30, 30, 28, 29, 32, 34, 27, 30, 25, 30, 31, 41, 29, 29, 28, 33, 26, 26, 27, 28, 27, 29, 28, 27, 29, 30, 28, 29, 29, 27, 34, 32, 34, 32, 25, 27, 26, 35, 32, 29, 26, 35, 29, 29, 30, 27, 27, 30, 25, 31, 28, 30, 32, 26, 29, 30, 30, 36, 26, 28, 29, 33, 33, 25, 27, 25, 29, 30, 28]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3454015600194515, "mean_inference_ms": 0.7300813655155992, "mean_action_processing_ms": 0.07605773279948808, "mean_env_wait_ms": 6.996445120576765, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007183088673104485, "StateBufferConnector_ms": 0.004095653835818064, "ViewRequirementAgentConnector_ms": 0.09243213873115375}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 192000, "num_agent_steps_trained": 192000, "num_env_steps_sampled": 192000, "num_env_steps_trained": 192000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 484.569433527227, "num_env_steps_trained_throughput_per_sec": 484.569433527227, "timesteps_total": 192000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 192000, "timers": {"training_iteration_time_ms": 8168.992, "sample_time_ms": 4657.201, "load_time_ms": 0.978, "load_throughput": 4089011.942, "learn_time_ms": 3507.58, "learn_throughput": 1140.387, "synch_weights_time_ms": 2.59}, "counters": {"num_env_steps_sampled": 192000, "num_env_steps_trained": 192000, "num_agent_steps_sampled": 192000, "num_agent_steps_trained": 192000}, "done": false, "episodes_total": 3784, "training_iteration": 48, "trial_id": "04cbf_00000", "date": "2024-03-07_13-24-15", "timestamp": 1709835855, "time_this_iter_s": 8.257943868637085, "time_total_s": 372.6556017398834, "pid": 119109, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7efea6399f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 372.6556017398834, "iterations_since_restore": 48, "perf": {"cpu_util_percent": 31.145454545454548, "ram_util_percent": 51.06363636363637, "gpu_util_percent0": 0.08363636363636363, "vram_util_percent0": 0.09164151278409091}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.075, "cur_lr": 0.0010000000000000005, "total_loss": 0.017580656542928428, "policy_loss": -0.011778814412693503, "vf_loss": 0.028429659079855448, "vf_explained_var": 0.9716513010763352, "kl": 0.012397498381925881, "entropy": 0.22937351526912822, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 45105.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 196000, "num_env_steps_trained": 196000, "num_agent_steps_sampled": 196000, "num_agent_steps_trained": 196000}, "sampler_results": {"episode_reward_max": -1.4000000000000008, "episode_reward_min": -3.5999999999999996, "episode_reward_mean": -1.7553956834532387, "episode_len_mean": 28.53956834532374, "episode_media": {}, "episodes_this_iter": 139, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1.5000000000000009, -3.5999999999999996, -1.5000000000000009, -1.600000000000001, -2.0000000000000013, -2.3000000000000016, -1.4000000000000008, -1.9000000000000012, -1.8000000000000012, -1.600000000000001, -1.8000000000000012, -1.8000000000000012, -1.8000000000000012, -1.4000000000000008, -1.700000000000001, -1.8000000000000012, -1.9000000000000012, -1.5000000000000009, -1.600000000000001, -1.8000000000000012, -1.9000000000000012, -1.5000000000000009, -1.8000000000000012, -1.8000000000000012, -1.5000000000000009, -1.9000000000000012, -1.5000000000000009, -1.4000000000000008, -1.600000000000001, -1.8000000000000012, -1.700000000000001, -1.4000000000000008, -2.2000000000000015, -1.9000000000000012, -2.1000000000000014, -2.2000000000000015, -1.4000000000000008, -1.600000000000001, -1.9000000000000012, -1.5000000000000009, -1.9000000000000012, -1.700000000000001, -1.700000000000001, -1.4000000000000008, -1.5000000000000009, -1.8000000000000012, -2.0000000000000013, -1.5000000000000009, -1.600000000000001, -1.9000000000000012, -1.700000000000001, -1.8000000000000012, -1.600000000000001, -1.700000000000001, -1.600000000000001, -2.2000000000000015, -1.9000000000000012, -2.1000000000000014, -2.0000000000000013, -1.5000000000000009, -1.8000000000000012, -1.8000000000000012, -1.700000000000001, -1.5000000000000009, -1.9000000000000012, -1.9000000000000012, -1.700000000000001, -2.1000000000000014, -1.8000000000000012, -1.5000000000000009, -2.1000000000000014, -1.600000000000001, -1.600000000000001, -1.9000000000000012, -1.4000000000000008, -1.8000000000000012, -1.600000000000001, -1.8000000000000012, -1.8000000000000012, -1.700000000000001, -1.5000000000000009, -1.8000000000000012, -1.5000000000000009, -1.5000000000000009, -1.700000000000001, -1.8000000000000012, -2.2000000000000015, -1.4000000000000008, -2.600000000000002, -2.0000000000000013, -1.5000000000000009, -2.600000000000002, -1.8000000000000012, -1.8000000000000012, -2.0000000000000013, -1.5000000000000009, -1.8000000000000012, -1.4000000000000008, -1.5000000000000009, -1.5000000000000009, -1.8000000000000012, -1.600000000000001, -1.700000000000001, -1.600000000000001, -1.600000000000001, -1.600000000000001, -2.2000000000000015, -1.9000000000000012, -1.5000000000000009, -1.8000000000000012, -1.4000000000000008, -1.8000000000000012, -1.8000000000000012, -2.1000000000000014, -1.8000000000000012, -1.8000000000000012, -1.8000000000000012, -2.1000000000000014, -1.5000000000000009, -2.0000000000000013, -1.4000000000000008, -1.8000000000000012, -1.600000000000001, -1.8000000000000012, -2.1000000000000014, -1.600000000000001, -1.9000000000000012, -1.700000000000001, -1.700000000000001, -1.5000000000000009, -1.700000000000001, -2.2000000000000015, -1.9000000000000012, -1.600000000000001, -1.700000000000001, -1.5000000000000009, -1.700000000000001, -1.4000000000000008, -1.4000000000000008], "episode_lengths": [26, 47, 26, 27, 31, 34, 25, 30, 29, 27, 29, 29, 29, 25, 28, 29, 30, 26, 27, 29, 30, 26, 29, 29, 26, 30, 26, 25, 27, 29, 28, 25, 33, 30, 32, 33, 25, 27, 30, 26, 30, 28, 28, 25, 26, 29, 31, 26, 27, 30, 28, 29, 27, 28, 27, 33, 30, 32, 31, 26, 29, 29, 28, 26, 30, 30, 28, 32, 29, 26, 32, 27, 27, 30, 25, 29, 27, 29, 29, 28, 26, 29, 26, 26, 28, 29, 33, 25, 37, 31, 26, 37, 29, 29, 31, 26, 29, 25, 26, 26, 29, 27, 28, 27, 27, 27, 31, 30, 26, 29, 25, 29, 29, 32, 29, 29, 29, 32, 26, 31, 25, 29, 27, 29, 32, 27, 30, 28, 28, 26, 28, 33, 30, 27, 28, 26, 28, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.34762614352595794, "mean_inference_ms": 0.7302146440898487, "mean_action_processing_ms": 0.07609580631258014, "mean_env_wait_ms": 7.013991136993339, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006932491878811404, "StateBufferConnector_ms": 0.004027044172767255, "ViewRequirementAgentConnector_ms": 0.09096131907950203}}, "episode_reward_max": -1.4000000000000008, "episode_reward_min": -3.5999999999999996, "episode_reward_mean": -1.7553956834532387, "episode_len_mean": 28.53956834532374, "episodes_this_iter": 139, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1.5000000000000009, -3.5999999999999996, -1.5000000000000009, -1.600000000000001, -2.0000000000000013, -2.3000000000000016, -1.4000000000000008, -1.9000000000000012, -1.8000000000000012, -1.600000000000001, -1.8000000000000012, -1.8000000000000012, -1.8000000000000012, -1.4000000000000008, -1.700000000000001, -1.8000000000000012, -1.9000000000000012, -1.5000000000000009, -1.600000000000001, -1.8000000000000012, -1.9000000000000012, -1.5000000000000009, -1.8000000000000012, -1.8000000000000012, -1.5000000000000009, -1.9000000000000012, -1.5000000000000009, -1.4000000000000008, -1.600000000000001, -1.8000000000000012, -1.700000000000001, -1.4000000000000008, -2.2000000000000015, -1.9000000000000012, -2.1000000000000014, -2.2000000000000015, -1.4000000000000008, -1.600000000000001, -1.9000000000000012, -1.5000000000000009, -1.9000000000000012, -1.700000000000001, -1.700000000000001, -1.4000000000000008, -1.5000000000000009, -1.8000000000000012, -2.0000000000000013, -1.5000000000000009, -1.600000000000001, -1.9000000000000012, -1.700000000000001, -1.8000000000000012, -1.600000000000001, -1.700000000000001, -1.600000000000001, -2.2000000000000015, -1.9000000000000012, -2.1000000000000014, -2.0000000000000013, -1.5000000000000009, -1.8000000000000012, -1.8000000000000012, -1.700000000000001, -1.5000000000000009, -1.9000000000000012, -1.9000000000000012, -1.700000000000001, -2.1000000000000014, -1.8000000000000012, -1.5000000000000009, -2.1000000000000014, -1.600000000000001, -1.600000000000001, -1.9000000000000012, -1.4000000000000008, -1.8000000000000012, -1.600000000000001, -1.8000000000000012, -1.8000000000000012, -1.700000000000001, -1.5000000000000009, -1.8000000000000012, -1.5000000000000009, -1.5000000000000009, -1.700000000000001, -1.8000000000000012, -2.2000000000000015, -1.4000000000000008, -2.600000000000002, -2.0000000000000013, -1.5000000000000009, -2.600000000000002, -1.8000000000000012, -1.8000000000000012, -2.0000000000000013, -1.5000000000000009, -1.8000000000000012, -1.4000000000000008, -1.5000000000000009, -1.5000000000000009, -1.8000000000000012, -1.600000000000001, -1.700000000000001, -1.600000000000001, -1.600000000000001, -1.600000000000001, -2.2000000000000015, -1.9000000000000012, -1.5000000000000009, -1.8000000000000012, -1.4000000000000008, -1.8000000000000012, -1.8000000000000012, -2.1000000000000014, -1.8000000000000012, -1.8000000000000012, -1.8000000000000012, -2.1000000000000014, -1.5000000000000009, -2.0000000000000013, -1.4000000000000008, -1.8000000000000012, -1.600000000000001, -1.8000000000000012, -2.1000000000000014, -1.600000000000001, -1.9000000000000012, -1.700000000000001, -1.700000000000001, -1.5000000000000009, -1.700000000000001, -2.2000000000000015, -1.9000000000000012, -1.600000000000001, -1.700000000000001, -1.5000000000000009, -1.700000000000001, -1.4000000000000008, -1.4000000000000008], "episode_lengths": [26, 47, 26, 27, 31, 34, 25, 30, 29, 27, 29, 29, 29, 25, 28, 29, 30, 26, 27, 29, 30, 26, 29, 29, 26, 30, 26, 25, 27, 29, 28, 25, 33, 30, 32, 33, 25, 27, 30, 26, 30, 28, 28, 25, 26, 29, 31, 26, 27, 30, 28, 29, 27, 28, 27, 33, 30, 32, 31, 26, 29, 29, 28, 26, 30, 30, 28, 32, 29, 26, 32, 27, 27, 30, 25, 29, 27, 29, 29, 28, 26, 29, 26, 26, 28, 29, 33, 25, 37, 31, 26, 37, 29, 29, 31, 26, 29, 25, 26, 26, 29, 27, 28, 27, 27, 27, 31, 30, 26, 29, 25, 29, 29, 32, 29, 29, 29, 32, 26, 31, 25, 29, 27, 29, 32, 27, 30, 28, 28, 26, 28, 33, 30, 27, 28, 26, 28, 25, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.34762614352595794, "mean_inference_ms": 0.7302146440898487, "mean_action_processing_ms": 0.07609580631258014, "mean_env_wait_ms": 7.013991136993339, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006932491878811404, "StateBufferConnector_ms": 0.004027044172767255, "ViewRequirementAgentConnector_ms": 0.09096131907950203}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 196000, "num_agent_steps_trained": 196000, "num_env_steps_sampled": 196000, "num_env_steps_trained": 196000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 455.76223888001454, "num_env_steps_trained_throughput_per_sec": 455.76223888001454, "timesteps_total": 196000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 196000, "timers": {"training_iteration_time_ms": 8211.491, "sample_time_ms": 4679.123, "load_time_ms": 0.979, "load_throughput": 4087418.019, "learn_time_ms": 3528.114, "learn_throughput": 1133.75, "synch_weights_time_ms": 2.628}, "counters": {"num_env_steps_sampled": 196000, "num_env_steps_trained": 196000, "num_agent_steps_sampled": 196000, "num_agent_steps_trained": 196000}, "done": false, "episodes_total": 3923, "training_iteration": 49, "trial_id": "04cbf_00000", "date": "2024-03-07_13-24-24", "timestamp": 1709835864, "time_this_iter_s": 8.779519081115723, "time_total_s": 381.43512082099915, "pid": 119109, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7efea6399f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 381.43512082099915, "iterations_since_restore": 49, "perf": {"cpu_util_percent": 32.53636363636363, "ram_util_percent": 51.0909090909091, "gpu_util_percent0": 0.08363636363636363, "vram_util_percent0": 0.09163411458333334}}
{"evaluation": {"sampler_results": {"episode_reward_max": -1.4000000000000008, "episode_reward_min": -6.300000000000004, "episode_reward_mean": -1.9700000000000013, "episode_len_mean": 29.65, "episode_media": {}, "episodes_this_iter": 20, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1.8000000000000012, -2.0000000000000013, -1.9000000000000012, -1.700000000000001, -1.9000000000000012, -1.600000000000001, -1.600000000000001, -2.2000000000000015, -2.2000000000000015, -1.9000000000000012, -1.700000000000001, -1.600000000000001, -1.5000000000000009, -1.5000000000000009, -6.300000000000004, -1.600000000000001, -1.8000000000000012, -1.4000000000000008, -1.5000000000000009, -1.700000000000001], "episode_lengths": [29, 31, 30, 28, 30, 27, 27, 33, 33, 30, 28, 27, 26, 26, 53, 27, 29, 25, 26, 28]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.36636426392629085, "mean_inference_ms": 1.090255249228943, "mean_action_processing_ms": 0.0684397790568445, "mean_env_wait_ms": 7.139360864555795, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004290342330932617, "StateBufferConnector_ms": 0.0026655197143554688, "ViewRequirementAgentConnector_ms": 0.06492972373962402}}, "episode_reward_max": -1.4000000000000008, "episode_reward_min": -6.300000000000004, "episode_reward_mean": -1.9700000000000013, "episode_len_mean": 29.65, "episode_media": {}, "episodes_this_iter": 20, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1.8000000000000012, -2.0000000000000013, -1.9000000000000012, -1.700000000000001, -1.9000000000000012, -1.600000000000001, -1.600000000000001, -2.2000000000000015, -2.2000000000000015, -1.9000000000000012, -1.700000000000001, -1.600000000000001, -1.5000000000000009, -1.5000000000000009, -6.300000000000004, -1.600000000000001, -1.8000000000000012, -1.4000000000000008, -1.5000000000000009, -1.700000000000001], "episode_lengths": [29, 31, 30, 28, 30, 27, 27, 33, 33, 30, 28, 27, 26, 26, 53, 27, 29, 25, 26, 28]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.36636426392629085, "mean_inference_ms": 1.090255249228943, "mean_action_processing_ms": 0.0684397790568445, "mean_env_wait_ms": 7.139360864555795, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004290342330932617, "StateBufferConnector_ms": 0.0026655197143554688, "ViewRequirementAgentConnector_ms": 0.06492972373962402}, "num_agent_steps_sampled_this_iter": 593, "num_env_steps_sampled_this_iter": 593, "timesteps_this_iter": 593, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.075, "cur_lr": 0.0010000000000000005, "total_loss": 0.013576223116752351, "policy_loss": -0.008203939456612833, "vf_loss": 0.021240595810275566, "vf_explained_var": 0.9784967282766937, "kl": 0.007194203634549257, "entropy": 0.2063099713415228, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 46035.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 200000, "num_env_steps_trained": 200000, "num_agent_steps_sampled": 200000, "num_agent_steps_trained": 200000}, "sampler_results": {"episode_reward_max": -1.4000000000000008, "episode_reward_min": -2.900000000000002, "episode_reward_mean": -1.7585714285714296, "episode_len_mean": 28.52857142857143, "episode_media": {}, "episodes_this_iter": 140, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1.9000000000000012, -1.8000000000000012, -1.700000000000001, -1.700000000000001, -1.700000000000001, -1.700000000000001, -1.8000000000000012, -1.700000000000001, -1.9000000000000012, -1.8000000000000012, -1.600000000000001, -1.5000000000000009, -2.1000000000000014, -1.700000000000001, -1.4000000000000008, -1.600000000000001, -1.5000000000000009, -1.600000000000001, -1.8000000000000012, -1.5000000000000009, -1.4000000000000008, -1.700000000000001, -1.600000000000001, -1.5000000000000009, -1.600000000000001, -1.8000000000000012, -2.1000000000000014, -1.9000000000000012, -1.8000000000000012, -1.700000000000001, -1.9000000000000012, -2.1000000000000014, -1.8000000000000012, -2.600000000000002, -1.5000000000000009, -1.600000000000001, -1.9000000000000012, -1.600000000000001, -1.9000000000000012, -2.900000000000002, -1.600000000000001, -1.5000000000000009, -2.0000000000000013, -2.0000000000000013, -1.700000000000001, -1.700000000000001, -1.5000000000000009, -1.4000000000000008, -2.3000000000000016, -1.600000000000001, -1.9000000000000012, -1.700000000000001, -1.600000000000001, -1.700000000000001, -2.0000000000000013, -1.600000000000001, -1.4000000000000008, -1.5000000000000009, -1.5000000000000009, -1.600000000000001, -1.9000000000000012, -1.5000000000000009, -1.8000000000000012, -1.600000000000001, -1.8000000000000012, -1.9000000000000012, -1.700000000000001, -1.700000000000001, -2.1000000000000014, -1.8000000000000012, -1.8000000000000012, -2.1000000000000014, -2.0000000000000013, -1.4000000000000008, -2.0000000000000013, -1.600000000000001, -1.600000000000001, -1.9000000000000012, -1.600000000000001, -1.8000000000000012, -1.600000000000001, -1.8000000000000012, -1.5000000000000009, -1.4000000000000008, -2.1000000000000014, -1.5000000000000009, -1.5000000000000009, -1.9000000000000012, -1.9000000000000012, -1.700000000000001, -2.3000000000000016, -1.8000000000000012, -1.4000000000000008, -1.700000000000001, -1.8000000000000012, -1.4000000000000008, -1.9000000000000012, -1.8000000000000012, -1.700000000000001, -1.5000000000000009, -1.5000000000000009, -2.3000000000000016, -1.600000000000001, -2.1000000000000014, -1.5000000000000009, -1.8000000000000012, -1.600000000000001, -1.600000000000001, -1.600000000000001, -1.5000000000000009, -1.600000000000001, -2.2000000000000015, -1.700000000000001, -1.5000000000000009, -1.9000000000000012, -1.9000000000000012, -1.700000000000001, -1.9000000000000012, -2.1000000000000014, -1.5000000000000009, -2.0000000000000013, -1.700000000000001, -2.1000000000000014, -1.9000000000000012, -1.9000000000000012, -1.9000000000000012, -1.700000000000001, -1.700000000000001, -2.0000000000000013, -1.600000000000001, -1.600000000000001, -2.0000000000000013, -1.9000000000000012, -1.700000000000001, -1.600000000000001, -1.700000000000001, -2.2000000000000015, -1.600000000000001, -1.9000000000000012, -1.9000000000000012], "episode_lengths": [30, 29, 28, 28, 28, 28, 29, 28, 30, 29, 27, 26, 32, 28, 25, 27, 26, 27, 29, 26, 25, 28, 27, 26, 27, 29, 32, 30, 29, 28, 30, 32, 29, 29, 26, 27, 30, 27, 30, 40, 27, 26, 31, 31, 28, 28, 26, 25, 34, 27, 30, 28, 27, 28, 31, 27, 25, 26, 26, 27, 30, 26, 29, 27, 29, 30, 28, 28, 32, 29, 29, 32, 31, 25, 31, 27, 27, 30, 27, 29, 27, 29, 26, 25, 32, 26, 26, 30, 30, 28, 34, 29, 25, 28, 29, 25, 30, 29, 28, 26, 26, 34, 27, 32, 26, 29, 27, 27, 27, 26, 27, 33, 28, 26, 30, 30, 28, 30, 32, 26, 31, 28, 32, 30, 30, 30, 28, 28, 31, 27, 27, 31, 30, 28, 27, 28, 33, 27, 30, 30]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3496319822042324, "mean_inference_ms": 0.7302494999765788, "mean_action_processing_ms": 0.07607780558162437, "mean_env_wait_ms": 7.029775137699871, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007010868617466518, "StateBufferConnector_ms": 0.004038981028965541, "ViewRequirementAgentConnector_ms": 0.09094272341047015}}, "episode_reward_max": -1.4000000000000008, "episode_reward_min": -2.900000000000002, "episode_reward_mean": -1.7585714285714296, "episode_len_mean": 28.52857142857143, "episodes_this_iter": 140, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1.9000000000000012, -1.8000000000000012, -1.700000000000001, -1.700000000000001, -1.700000000000001, -1.700000000000001, -1.8000000000000012, -1.700000000000001, -1.9000000000000012, -1.8000000000000012, -1.600000000000001, -1.5000000000000009, -2.1000000000000014, -1.700000000000001, -1.4000000000000008, -1.600000000000001, -1.5000000000000009, -1.600000000000001, -1.8000000000000012, -1.5000000000000009, -1.4000000000000008, -1.700000000000001, -1.600000000000001, -1.5000000000000009, -1.600000000000001, -1.8000000000000012, -2.1000000000000014, -1.9000000000000012, -1.8000000000000012, -1.700000000000001, -1.9000000000000012, -2.1000000000000014, -1.8000000000000012, -2.600000000000002, -1.5000000000000009, -1.600000000000001, -1.9000000000000012, -1.600000000000001, -1.9000000000000012, -2.900000000000002, -1.600000000000001, -1.5000000000000009, -2.0000000000000013, -2.0000000000000013, -1.700000000000001, -1.700000000000001, -1.5000000000000009, -1.4000000000000008, -2.3000000000000016, -1.600000000000001, -1.9000000000000012, -1.700000000000001, -1.600000000000001, -1.700000000000001, -2.0000000000000013, -1.600000000000001, -1.4000000000000008, -1.5000000000000009, -1.5000000000000009, -1.600000000000001, -1.9000000000000012, -1.5000000000000009, -1.8000000000000012, -1.600000000000001, -1.8000000000000012, -1.9000000000000012, -1.700000000000001, -1.700000000000001, -2.1000000000000014, -1.8000000000000012, -1.8000000000000012, -2.1000000000000014, -2.0000000000000013, -1.4000000000000008, -2.0000000000000013, -1.600000000000001, -1.600000000000001, -1.9000000000000012, -1.600000000000001, -1.8000000000000012, -1.600000000000001, -1.8000000000000012, -1.5000000000000009, -1.4000000000000008, -2.1000000000000014, -1.5000000000000009, -1.5000000000000009, -1.9000000000000012, -1.9000000000000012, -1.700000000000001, -2.3000000000000016, -1.8000000000000012, -1.4000000000000008, -1.700000000000001, -1.8000000000000012, -1.4000000000000008, -1.9000000000000012, -1.8000000000000012, -1.700000000000001, -1.5000000000000009, -1.5000000000000009, -2.3000000000000016, -1.600000000000001, -2.1000000000000014, -1.5000000000000009, -1.8000000000000012, -1.600000000000001, -1.600000000000001, -1.600000000000001, -1.5000000000000009, -1.600000000000001, -2.2000000000000015, -1.700000000000001, -1.5000000000000009, -1.9000000000000012, -1.9000000000000012, -1.700000000000001, -1.9000000000000012, -2.1000000000000014, -1.5000000000000009, -2.0000000000000013, -1.700000000000001, -2.1000000000000014, -1.9000000000000012, -1.9000000000000012, -1.9000000000000012, -1.700000000000001, -1.700000000000001, -2.0000000000000013, -1.600000000000001, -1.600000000000001, -2.0000000000000013, -1.9000000000000012, -1.700000000000001, -1.600000000000001, -1.700000000000001, -2.2000000000000015, -1.600000000000001, -1.9000000000000012, -1.9000000000000012], "episode_lengths": [30, 29, 28, 28, 28, 28, 29, 28, 30, 29, 27, 26, 32, 28, 25, 27, 26, 27, 29, 26, 25, 28, 27, 26, 27, 29, 32, 30, 29, 28, 30, 32, 29, 29, 26, 27, 30, 27, 30, 40, 27, 26, 31, 31, 28, 28, 26, 25, 34, 27, 30, 28, 27, 28, 31, 27, 25, 26, 26, 27, 30, 26, 29, 27, 29, 30, 28, 28, 32, 29, 29, 32, 31, 25, 31, 27, 27, 30, 27, 29, 27, 29, 26, 25, 32, 26, 26, 30, 30, 28, 34, 29, 25, 28, 29, 25, 30, 29, 28, 26, 26, 34, 27, 32, 26, 29, 27, 27, 27, 26, 27, 33, 28, 26, 30, 30, 28, 30, 32, 26, 31, 28, 32, 30, 30, 30, 28, 28, 31, 27, 27, 31, 30, 28, 27, 28, 33, 27, 30, 30]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3496319822042324, "mean_inference_ms": 0.7302494999765788, "mean_action_processing_ms": 0.07607780558162437, "mean_env_wait_ms": 7.029775137699871, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007010868617466518, "StateBufferConnector_ms": 0.004038981028965541, "ViewRequirementAgentConnector_ms": 0.09094272341047015}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 200000, "num_agent_steps_trained": 200000, "num_env_steps_sampled": 200000, "num_env_steps_trained": 200000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 487.1979263645693, "num_env_steps_trained_throughput_per_sec": 487.1979263645693, "timesteps_total": 200000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 200000, "timers": {"training_iteration_time_ms": 8200.912, "sample_time_ms": 4670.565, "load_time_ms": 0.979, "load_throughput": 4084532.197, "learn_time_ms": 3524.76, "learn_throughput": 1134.829, "synch_weights_time_ms": 3.941}, "counters": {"num_env_steps_sampled": 200000, "num_env_steps_trained": 200000, "num_agent_steps_sampled": 200000, "num_agent_steps_trained": 200000}, "done": true, "episodes_total": 4063, "training_iteration": 50, "trial_id": "04cbf_00000", "date": "2024-03-07_13-24-38", "timestamp": 1709835878, "time_this_iter_s": 13.372873544692993, "time_total_s": 394.80799436569214, "pid": 119109, "hostname": "aurora", "node_ip": "10.0.20.163", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'ar_bot_sim.environments.tabletop.ar_bot_tabletop_gym.ARBotTabletopGym'>", "env_config": {"discrete_action_mapping": {"0": [0.0, 0.25], "1": [0.5, 0.0], "2": [0.0, -0.25]}, "render_simulation": false, "number_of_obstacles": 0, "actions": "Discrete(3)", "max_timesteps_per_episode": 400}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7efea6399f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 50, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"expore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 394.80799436569214, "iterations_since_restore": 50, "perf": {"cpu_util_percent": 22.647058823529413, "ram_util_percent": 51.08823529411765, "gpu_util_percent0": 0.05941176470588235, "vram_util_percent0": 0.09163411458333333}}
